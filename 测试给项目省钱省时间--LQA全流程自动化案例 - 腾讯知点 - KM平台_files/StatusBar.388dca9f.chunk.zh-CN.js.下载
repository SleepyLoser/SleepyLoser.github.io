(window.webpackJsonp=window.webpackJsonp||[]).push([[195,218],{1034:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(1035),n(142)),h=n.n(d),p=n(155),f=n(183),v=n(962),m=p.default.iconTypes.size16,w=[],g=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){v.d()},n.refBtn=h.a.createRef(),n.state={isFull:!1,visible:v.a()},n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.state.visible&&(window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.public.components.commandbars.FullScreenBtn.full", "全屏显示"),icon:m.full_screen2}),0===w.length&&v.b((function(e){w.forEach((function(t){return t.setState({isFull:e})})),window.collection2("full_screen_"+!e)})),w.push(this))}},{key:"componentWillUnmount",value:function(){var e=this;0===(w=w.filter((function(t){return t!==e}))).length&&v.c()}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.isFull;if(!t)return!1;var i=this.props.showText,o=n?_i18n("applications.public.components.commandbars.FullScreenBtn.exits", "退出全屏"):_i18n("applications.public.components.commandbars.FullScreenBtn.full", "全屏显示");if(i){var a=n?m.exit_full_screen2:m.full_screen2;return h.a.createElement(f.default,{ref:this.refBtn,iconType:a,onClick:this.handleClick},o)}var s=n?m.exit_full_screen:m.full_screen;return h.a.createElement(p.default,{ref:this.refBtn,className:"component-full-screen",title:o,iconType:s,onClick:this.handleClick})}}]),t}(d.PureComponent);t.a=g},1035:function(e,t,n){},1186:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var i=n(160),o=n.n(i),a=n(839),s=n(774);function l(e,t){if("string"!=typeof e){var n=u(e);r([n]),t(n)}else!function(e,t){var n=Object(s.a)(e).map((function(e){return e.el})),i=r(n);i||(i=n.find((function(e){return document.body.contains(e)})))||(i=n[0]);t(i||null)}(e,t)}function r(e){var t=a.b.find((function(e){return e.isVisible()})),n=e.find((function(e){return t.contains(e)}));if(n)return t.location(n),n;for(var i=0;i<a.b.length;i++)for(var o=0;o<e.length;o++)if(a.b[i].contains(e[o]))return a.b[i].location(e[o]),e[o]}function u(e){if(!e)return null;var t=e.left,n=e.top;if(void 0!==t||void 0!==n){var i={left:t,top:n,width:0};return{getBoundingClientRect:function(){return i}}}return o.a.findDOMNode(e)}},1187:function(e,t,n){e.exports=function(){return new Worker(n.p+"workers/public/components/commandbars/CommandBarSearch/helpers/search.61472d40.worker.js")}},1241:function(e,t,n){},1457:function(e,t,n){},1458:function(e,t,n){e.exports=function(e,t){n.e(316).then(n.bind(null,2657)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},1459:function(e,t,n){},1513:function(e,t,n){"use strict";var i,o=n(26),a=n.n(o),s=n(0),l=n.n(s),r=n(3),u=n.n(r),c=n(25),d=n.n(c),h=n(42),p=n.n(h),f=n(150),v=n.n(f),m=(n(1457),n(142)),w=n.n(m),g=n(146),b=n(45),y=n(166),C=n(390),E=n(155),k=n(148),_=n(162),T=n(164),S=n(1458),D=n.n(S),O=E.default.iconTypes.size16,M=function(e){function t(){return l()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.isMin,i=e.onLocation,o=e.onSizeChange;return w.a.createElement("div",{className:"component-helper-panel"},w.a.createElement("div",{className:"search-bar-wrap"},Object(T.default)(D.a,{onLocation:i,onClose:t})),window.officeType!==_.default.outline&&w.a.createElement("div",{className:"other-items-wrap"},w.a.createElement("div",{className:"helper-panel-item",onClick:o},w.a.createElement(k.default,{type:n?O.float_ok:O.float_cancel}),n?_i18n("applications.public.components.commandbars.CommandBarSearch.float_ok", "固定悬浮"):_i18n("applications.public.components.commandbars.CommandBarSearch.float_cancel", "取消悬浮"))))}}]),t}(m.PureComponent),L=n(1186),P=(n(1459),n(160)),N=n.n(P),B=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.getPosition=function(e){var t=e.getBoundingClientRect(),n=t.left,i=t.top;return i=i-24+3,{left:n=n+t.width/2-8,top:i=Math.max(0,i)}},n.showTimer=null,n.closeTimer=null;var i=null;return e.from&&(i=n.getPosition(e.from)),n.state={position:i},n}return p()(t,e),u()(t,[{key:"componentDidMount",value:function(){this.startShow(),window.addEventListener("mousedown",this.props.onClose,!0)}},{key:"componentDidUpdate",value:function(e,t){e.to!==this.props.to&&this.startShow()}},{key:"componentWillUnmount",value:function(){clearInterval(this.showTimer),clearTimeout(this.closeTimer),window.removeEventListener("mousedown",this.props.onClose,!0)}},{key:"startShow",value:function(){var e=this;clearInterval(this.showTimer),clearTimeout(this.closeTimer),this.showTimer=setInterval((function(){var t=e.getPosition(e.props.to);e.setState({position:t})}),300),this.closeTimer=setTimeout(this.props.onClose,5e3)}},{key:"render",value:function(){var e=this.state.position;if(!e)return!1;var t=w.a.createElement("div",{style:e,className:"search-drawing-pin"},w.a.createElement("div",{className:"pin"}),w.a.createElement("div",{className:"pulse"}));return N.a.createPortal(t,document.body)}}]),t}(m.PureComponent),x=function(e){function t(){var e,n,i,o;l()(this,t);for(var a=arguments.length,s=Array(a),r=0;r<a;r++)s[r]=arguments[r];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={from:null,to:null},i.location=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=L.a(t);L.b(e,(function(e){i.setState({from:n,to:e})}))},i.handleClose=function(){i.setState({from:null,to:null})},o=n,d()(i,o)}return p()(t,e),u()(t,[{key:"render",value:function(){var e=this.state,t=e.from,n=e.to;return!!n&&w.a.createElement(B,{from:t,to:n,onClose:this.handleClose})}}]),t}(m.PureComponent),R=n(774),I="weboffice_search_status",W=E.default.iconTypes,A=W.other,V=W.size16,z=(i={},v()(i,window.rightToLeft?"left":"right",36),v()(i,"bottom",66),i),j=window.CommandBarComponent,F=j.cmbIds.$public,H=window.__WPSPLUGIN__.loader,U={pluginType:"FloatQuickHelp"},G=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,F.FloatQuickHelp));return n.handleBtnClick=function(e){e.preventDefault()},n.handleTaskPaneWidthChange=function(e){if(!n.state.isMin){var t=e.detail.width,i=n.refModal.current.element,o=document.body.clientWidth,a=i.getBoundingClientRect();t>0?o-a.right<t+z.right&&(i.style.left="",i.style.right=t+z.right+"px"):(i.style.left="",i.style.right=z.right+"px")}},n.handlePanelClose=function(e,t){n.setState({panelVisible:!1},t),window.collection("search","click",e)},n.handleModalDragMove=function(e,t){if(e)n.setState({showTips:!0});else{var i=n.state.panelVisible&&!t;n.setState({panelVisible:i,showTips:!1})}},n.handlePanelVisibleChange=function(e){n.setState({panelVisible:e})},n.handleSizeChange=function(){var e=n.state.isMin;window.collection("search","click",e?"max":"min"),localStorage.setItem(I,e?"max":"min"),e?n.setState({panelVisible:!1,isMin:!1}):n.setState({panelVisible:!1,showTmpBtn:!0},(function(){var e=n.refTmpBtn.current.getElement().getBoundingClientRect(),t=n.refModal.current.element,i=t.getBoundingClientRect();t.style.left=i.left+"px",t.style.top=i.top+"px",t.style.right="initial",t.style.bottom="initial",t.offsetWidth,t.style.left=e.left+"px",t.style.top=e.top+"px",setTimeout((function(){n.setState({isMin:!0,showTmpBtn:!1})}),500)}))},n.location=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.refLocation.current.location(e,t)},n.refTmpBtn=w.a.createRef(),n.refModal=w.a.createRef(),n.refLocation=w.a.createRef(),n.refBtn=w.a.createRef(),n.init(),n}return p()(t,e),u()(t,[{key:"init",value:function(){var e=[Object(b.hasQuery)("hidecmb"),Object(b.hasQuery)("review"),Object(b.hasQuery)("version"),Object(b.hasQuery)("simple")],t=e[0],n=e[1],i=e[2],o=e[3];if(this._showBtn=!(t||n||i||o),this._showBtn)return H.search(U)?(this._showBtn=!1,void H.loadSingleInstance(U)):void(this.state={panelVisible:!1,position:a()({},z),showTips:!0,isMin:"min"===localStorage.getItem(I),showTmpBtn:!1})}},{key:"componentDidMount",value:function(){this._showBtn&&(window.addEventListener(g.default.names.ON_TASK_PANE_WIDTH_CHANGE,this.handleTaskPaneWidthChange),this.refBtn.current&&this.refBtn.current.getElement().addEventListener("mousedown",this.handleBtnClick,{passive:!1}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener(g.default.names.ON_TASK_PANE_WIDTH_CHANGE,this.handleTaskPaneWidthChange),this.refBtn.current&&this.refBtn.current.getElement().removeEventListener("mousedown",this.handleBtnClick,{passive:!1})}},{key:"search",value:function(e,t){R.b(e,t)}},{key:"getBtnIcon",value:function(){var e=this.state,t=e.isMin,n=e.showTmpBtn;return t||n?V.helper:A.helper}},{key:"renderBtn",value:function(){var e=this.state,t=e.panelVisible,n=e.showTips,i=e.isMin,o=this.getBtnIcon(),a=w.a.createElement(M,{isMin:i,onLocation:this.location,onClose:this.handlePanelClose,onSizeChange:this.handleSizeChange});return w.a.createElement(w.a.Fragment,null,w.a.createElement(y.default,{panel:a,visible:t,placement:y.default.placementTypes.topRight,onVisibleChange:this.handlePanelVisibleChange},w.a.createElement(E.default,{ref:this.refBtn,iconType:o,className:"cmb-search-btn",selected:t&&i,title:n?_i18n("applications.public.components.commandbars.CommandBarSearch.btnTips", "帮助"):""})),w.a.createElement(x,{ref:this.refLocation}))}},{key:"render",value:function(){if(!this._showBtn)return w.a.createElement(w.a.Fragment,null,w.a.createElement("div",{id:F.FloatQuickHelp}),w.a.createElement(x,{ref:this.refLocation}));var e=this.state,t=e.position,n=e.isMin,i=e.showTmpBtn,o=this.renderBtn();return n?o:w.a.createElement(w.a.Fragment,null,w.a.createElement(C.a,{ref:this.refModal,isAllDrag:!0,isExclusive:!1,className:"component-helper"+(i?" tmp":""),position:t,retainSize:42,onDragMove:this.handleModalDragMove,onClose:Function.prototype},o),i&&w.a.createElement(E.default,{ref:this.refTmpBtn,iconType:V.helper,className:"cmb-search-btn visibility0"}))}}]),t}(j);t.a=G},1627:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(1779),n(142)),h=n.n(d),p=n(149),f=n(146),v=n(228),m=n(390),w=n(192),g=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={position:{right:24,top:44}},n.handleClose=n.handleClose.bind(n),n.handleLogin=n.handleLogin.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.collection2("message_center_login_show")}},{key:"handleClose",value:function(){var e=this.props.info,t=e.from,n=e.to;window.session.sendBroadcast({action:"inviteLoginFail",from:t,to:n}),this.props.onClose(),window.collection2("message_center_login_close")}},{key:"handleLogin",value:function(){var e=this.props.info,t=e.from,n=e.to,i=JSON.stringify({from:t,to:n});sessionStorage.setItem("weboffice_invite_login",i),this.props.onClose(),Object(v.gotoLogin)(!1),window.collection2("message_center_login_click")}},{key:"render",value:function(){var e=this.props.info,t=this.state.position,n=_i18n("applications.public.components.commandbars.MessageCenter.loginTips", "「{0}」邀请你登录一起协作").replace("{0}",e.from.shortName);return h.a.createElement(m.a,{className:"component-message-center-login-modal",title:" ",showCloseBtn:!0,position:t,isExclusive:!1,onClose:this.handleClose},h.a.createElement("div",{className:"login-tips"},n),h.a.createElement("div",{className:"login-btn-wrap"},h.a.createElement(w.default,{isAuto:!0,onClick:this.handleLogin},_i18n("applications.public.components.commandbars.MessageCenter.login", "登录"))))}}]),t}(d.PureComponent),b=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=r()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.timer=null,i.state={position:{right:24,bottom:50}},a=n,r()(i,a)}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.startTimer()}},{key:"componentDidUpdate",value:function(e,t){this.props.text!==e.text&&(clearTimeout(this.timer),this.startTimer())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"startTimer",value:function(){this.timer=setTimeout(this.props.onClose,3e3)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.onClose,i=this.state.position;return h.a.createElement(m.a,{className:"component-message-center-notice-modal",showCloseBtn:!0,title:t,isExclusive:!1,position:i,onClose:n})}}]),t}(d.PureComponent),y=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={inviteMeLogin:null,noticeText:null},n.handleMessage=n.handleMessage.bind(n),n.handleLoginClose=n.handleLoginClose.bind(n),n.handleNoticeClose=n.handleNoticeClose.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(f.default.names.cooper.ON_BROADCAST_MSG,this.handleMessage);var e="weboffice_invite_login",t=sessionStorage.getItem(e);if(t){sessionStorage.removeItem(e);var n=JSON.parse(t),i=n.from,o=n.to,a=this.props.me;a.isFake?window.session.sendBroadcast({action:"inviteLoginFail",from:i,to:o}):window.session.sendBroadcast({action:"inviteLoginSuccess",from:i,to:a})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.default.names.cooper.ON_BROADCAST_MSG,this.handleMessage)}},{key:"handleMessage",value:function(e){var t=this.props.me,n=e.detail.message,i=n.action,o=n.from,a=n.to;if("inviteLogin"!==i)if("inviteLoginSuccess"!==i){if("inviteLoginFail"===i){if(a.id===t.id)return void this.setState({inviteMeLogin:null});var s=_i18n("applications.public.components.commandbars.MessageCenter.inviteLoginFail", "「{0}」暂时不登录").replace("{0}",a.shortName);this.setState({noticeText:s})}}else{if(a.id===t.id)return void this.setState({inviteMeLogin:null});var l=_i18n("applications.public.components.commandbars.MessageCenter.inviteLoginSuccess", "「{0}」已登录").replace("{0}",a.shortName);this.setState({noticeText:l})}else{if(a.id===t.id)return void this.setState({inviteMeLogin:{from:o,to:a}});if(o.id!==t.id){var r=_i18n("applications.public.components.commandbars.MessageCenter.inviteOtherLogin", "「{0}」邀请「{1}」登录").replace("{0}",o.shortName);r=r.replace("{1}",a.shortName),this.setState({noticeText:r})}}}},{key:"handleLoginClose",value:function(){this.setState({inviteMeLogin:null})}},{key:"handleNoticeClose",value:function(){this.setState({noticeText:null})}},{key:"render",value:function(){var e=this.state,t=e.inviteMeLogin,n=e.noticeText;return h.a.createElement(h.a.Fragment,null,!!t&&h.a.createElement(g,{info:t,onClose:this.handleLoginClose}),!!n&&h.a.createElement(b,{text:n,onClose:this.handleNoticeClose}))}}]),t}(d.PureComponent);t.a=Object(p.connect)((function(e){return{me:e.public.user}}))(y)},166:function(e,t,n){"use strict";n.r(t);var i=n(26),o=n.n(i),a=n(0),s=n.n(a),l=n(3),r=n.n(l),u=n(25),c=n.n(u),d=n(42),h=n.n(d),p=(n(259),n(142)),f=n.n(p),v=n(160),m=n.n(v),w=n(144),g=n(146),b=n(191),y=n(229),C=n(182),E=n(283),k={click:"click",hover:"hover"},_=function(e){function t(e){s()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.trigger===k.hover&&!w.isTouchScreen},n.refDropDown=f.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return h()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,o=n.destroyOnHide;!i&&e.visible&&!o&&void 0!==o&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||m.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,o=t.trigger;i?i(e):o===k.hover&&!w.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,o=n.right,a=n.top,s=n.bottom,l=e.pageX,r=e.pageY;if(l>=i&&l<=o&&r>=a&&r<=s)return}g.default.dispatchEvent(g.default.names.DROPDOWN_BTN_CONTENT_MOUSE_LEAVE,e),this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,o=t.visible,a=t.placement,s=t.distance,l=t.panelClass,r=t.isAuto,u=t.offsetX;return f.a.createElement(y.default,{ref:this.refDropDown,isAuto:r,className:l,triggerElement:this.btnDom,rect:e,offsetX:u,visible:o,placement:a,distance:s,isSetHeight:n,onClose:this.handleContentClose,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,o=e.destroyOnHide;t=t||n.props.disabled;var a=this.getRect();if(!t){var s=n.props.title;s&&i&&(s=null),n=f.a.cloneElement(n,{title:s,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return f.a.createElement(f.a.Fragment,null,n,!!a&&f.a.createElement(b.default,{visible:i,destroyOnHide:o},this.renderContent()))}}]),t}(p.PureComponent);_.placementTypes=y.default.placementTypes,_.DropdownPanel=C.default,_.triggerTypes=k,_.defaultProps={visible:!1,trigger:k.click,distance:4,offsetX:0},t.default=_;var T=function(e){function t(){return s()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h()(t,e),r()(t,[{key:"componentDidMount",value:function(){var e=this.props.commandBarId;window.__WPSENV__.reduxDispatch(Object(E.altLazyLoad)({id:e}))}},{key:"render",value:function(){return f.a.createElement(C.default,o()({},this.props,{ref:this.forwardRef}),this.props.children)}}]),t}(p.PureComponent);T.Item=C.default.Item,T.Divider=C.default.Divider,_.AltDropdownPanel=T},1767:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(1768),n(142)),h=n.n(d),p=n(162),f=n(182),v=n(378),m=n(264),w=f.default.Item,g=f.default.Divider,b="pagew",y="wordw",C="totalpage",E={PAGE_WIDTH:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.pageW", "页宽"),type:b,track:4},WORD_WIDTH:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.wordW", "文字宽度"),type:y,track:5},TOTAL_PAGE:{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.totalPage", "整页"),type:C,track:6}},k=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={autoIndex:0,readOnly:!1},n.handleItemClick=n.handleItemClick.bind(n),n.handleResize=n.handleResize.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.throttleResize=Object(m.a)(this.handleResize,1e3),window.addEventListener("resize",this.throttleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.throttleResize)}},{key:"handleResize",value:function(){var e=null;switch(this.props.type){case b:e=E.PAGE_WIDTH;break;case y:e=E.WORD_WIDTH;break;case C:e=E.TOTAL_PAGE}null!==e&&this.handleItemClick(e.type,e.text,e.track)}},{key:"handleItemClick",value:function(e,t,n){var i=this.props.officeType;if("number"!=typeof e){if(Object(p.isEtLike)(i)){var o=window.APP.getActiveSheetView().zoomToSelections();return this.setState({autoIndex:o}),this.props.onChange(o),void this.handleItemClick(o)}if(i===p.default.writer){t=window.APP.workspace.getPageFitValue()[e](),this.setState({value:t}),e!==this.props.index&&this.props.onChange(t,e,!0,n)}else{if(i===p.default.presentation){return this.setState({autoIndex:100}),this.props.onChange(100),void this.handleItemClick(100)}if(i===p.default.pdf){var a=Math.round(100*window.APP.getZoom());return window.APP.zoomTo(e,"center","center"),void(e!==this.props.index&&this.props.onChange(a,e,!0))}}}else if(e!==this.props.index){var s=void 0,l=void 0;i!==p.default.writer&&i!==p.default.pdf||(s=l=!1),this.props.onChange(e,l,s,n)}}},{key:"getItemValues",value:function(){var e=this.state.autoIndex,t=this.props.officeType;return Object(p.isEtLike)(t)?[{text:"400%",type:400,value:400},{text:"300%",type:300,value:300},{text:"200%",type:200,value:200},{text:"100%",type:100,value:100},{text:"75%",type:75,value:75},{text:"50%",type:50,value:50},{text:"25%",type:25,value:25},{text:"10%",type:10,value:10},{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.auto", "恰好容纳选定区域"),type:"auto",value:e,disabled:window.APP.getActiveSheet().isDashBoardSheet()}]:t===p.default.writer?window.APP.isWebMode()?[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"10%",type:10,value:10},E.PAGE_WIDTH,E.WORD_WIDTH]:[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"10%",type:10,value:10},E.PAGE_WIDTH,E.WORD_WIDTH,E.TOTAL_PAGE]:t===p.default.presentation?[{text:"400%",type:400,value:400},{text:"200%",type:200,value:200},{text:"100%",type:100,value:100},{text:"66%",type:66,value:66},{text:"50%",type:50,value:50},{text:"33%",type:33,value:33},{text:"10%",type:10,value:10}]:t===p.default.pdf?[{text:"800%",type:800,value:800},{text:"600%",type:600,value:600},{text:"400%",type:400,value:400},{text:"200%",type:200,value:200,track:1},{text:"125%",type:125,value:125},{text:"100%",type:100,value:100,track:2},{text:"75%",type:75,value:75,track:3},{text:"50%",type:50,value:50,track:4},{text:"10%",type:10,value:10},{text:_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.pageW", "页宽"),type:"pagew",track:6}]:void 0}},{key:"renderItems",value:function(){var e=this,t=this.props,n=t.index,i=t.type;return this.getItemValues().map((function(t){var o=!1;return o=i?i===t.type:t.value===n,h.a.createElement(w,{key:t.text,type:t.type,value:t.value,selected:o,disabled:t.disabled,onClick:e.handleItemClick.bind(e,t.type,t.value,t.track)},t.text)}))}},{key:"render",value:function(){var e=this.props,t=e.index,n=e.max,i=e.min,o=e.inputReadOnly,a=this.renderItems();return h.a.createElement(f.default,{className:"component-view-zoom-panel"},h.a.createElement("div",{className:"panel-title"},_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.display", "显示比例")),a,h.a.createElement(g,null),h.a.createElement("div",{className:"panel-input-wrap"},h.a.createElement("span",null,_i18n("applications.public.components.commandbars.ViewZoom.ViewZoomPanel.userDefine", "自定义")),h.a.createElement(v.b,{className:"input-number view-zoom-input",isInt:!0,max:n,min:i,value:t,onChange:this.handleItemClick,readOnly:o}),h.a.createElement("span",null,"%")))}}]),t}(d.PureComponent);t.a=k},1768:function(e,t,n){},1779:function(e,t,n){},1811:function(e,t,n){},182:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(209),n(142)),h=n.n(d),p=n(144),f=n(146),v=n(145),m=n(148),w=n(226),g=n(245),b=n(169),y="right",C="down",E="rightDown",k=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer)}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){f.default.dispatchEvent(f.default.names.DROPDOWN_PANEL_SCROLL);var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var o=n.refPanel.current,a=o.scrollTop;a+o.clientHeight+t>=o.scrollHeight&&i({scrollTop:a})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=h.a.createRef(),n.refContent=h.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(v.getPageOfficeType)(),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){p.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(){p.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(){if(this.props.onItemHover&&!p.isTouchScreen){var e=this.getHoverItem();this.props.onItemHover(e,!0)}}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(v.stopBubble)(e);var i=e.clientX,o=e.clientY,a=e.target,s=e.currentTarget.getAttribute("data-orien");a.setCapture&&a.setCapture();var l=this.state,r=l.width,u=l.height,c=l.minWidth,d=l.minHeight;document.onmousemove=function(e){Object(v.stopBubble)(e);var n=e.clientX,a=e.clientY,l=Math.max(c,r+n-i),h=Math.max(d,u+a-o);s===y?h=u:s===C&&(l=r),t.setState({width:l,height:h},(function(){f.default.dispatchEvent(f.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(v.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,a.releaseCapture&&a.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if(!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad")){var i=Object(b.getKey)(e);switch(i){case b.Keys.Enter:var o=this.getHoverItem();o&&(Object(v.stopBubble)(e),o.click());break;case b.Keys.ArrowUp:case b.Keys.ArrowDown:if(window.__WPSENV__.store.getState().public.alt.isInMode)break;var a=i===b.Keys.ArrowUp;this.setPreSelectItem(a,e),this.props.isPreSelectCloseDropdown&&f.default.dispatchEvent(f.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(v.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);o.classList.add("hover"),this.showPreSelectItem(o)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var a=i-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){i=a;break}}else for(var s=i+1;s<t.length;s++)if(-1===t[s].className.indexOf("disabled")){i=s;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,o=t.maxWidth;if(n||i||o)return{width:n,minWidth:i,maxWidth:o}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,o="dropdown-panel";e.isAuto&&(o+=" "+this.officeType),i&&(o+=" can-resize"),t&&(o+=" "+t);var a=this.getPanelStyle();return h.a.createElement("div",{ref:this.refPanel,className:o,style:a,tabIndex:0,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0},h.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),h.a.createElement("div",{className:"drag-hand rightBottom","data-orien":E,onMouseDown:this.handleDragMouseDown},h.a.createElement(m.default,{type:m.default.types.other.drag_right_bottom})),h.a.createElement("div",{className:"drag-hand right","data-orien":y,onMouseDown:this.handleDragMouseDown}),h.a.createElement("div",{className:"drag-hand bottom","data-orien":C,onMouseDown:this.handleDragMouseDown}))}}]),t}(d.PureComponent);k.Item=w.default,k.Divider=g.a,k.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=k},183:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(353),n(142)),h=n.n(d),p=n(151),f=n.n(p),v=n(148),m=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=i=r()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.refWrap=h.a.createRef(),a=n,r()(i,a)}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.selected,o="component-icon-text-btn";return e.isDropdown&&(o+=" dropdown"),e.isReverse&&(o+=" reverse"),n&&(o+=" disabled"),i&&(o+=" selected"),e.showBorder&&(o+=" show-border"),t&&(o+=" "+t),o}},{key:"getElement",value:function(){return this.refWrap.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.disabled,o=e.title,a=e.iconType,s=e.keepEdit,l=e.onClick,r=e.onMouseEnter,u=e.onMouseLeave;i&&(l=void 0);var c=this.getClassName();return h.a.createElement(f.a,{title:o,onMouseEnter:r,onMouseLeave:u},h.a.createElement("div",{ref:this.refWrap,id:t,onClick:l,className:c,"data-keep-edit":s||void 0},h.a.createElement(v.default,{type:a}),h.a.createElement("div",{className:"btn-text"},n)))}}]),t}(d.PureComponent);m.iconTypes=v.default.types,t.default=m},1830:function(e,t,n){},186:function(e,t,n){"use strict";t.a=function(e){return Object.prototype.toString.call(e)}},1864:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=n(142),h=n.n(d),p=(n(1241),n(191)),f={top:"top",left:"left",right:"right",bottom:"bottom",bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right"},v=n(26),m=n.n(v),w=n(144),g=n(145),b=w.isMobile,y=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rect:null,style:{visibility:"hidden",top:0,left:0},arrowStyle:null},n.arrowSize=6,n.handleWindowClick=n.handleWindowClick.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.getStyle(),this.props.onVisibleChange&&this.props.onVisibleChange(!0),this.props.isClickClosed&&(!b&&window.addEventListener("click",this.handleWindowClick),b&&window.addEventListener("touchstart",this.handleWindowClick,{passive:!1}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.rect;e.rect!==n&&n&&this.getStyle()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleWindowClick),window.removeEventListener("touchstart",this.handleWindowClick,{passive:!1})}},{key:"handleWindowClick",value:function(e){var t=this.popoverContentDom,n=e.target,i=this.props,o=i.onClose,a=i.onVisibleChange;document.body.contains(n)&&!t.contains(n)&&(Object(g.stopBubble)(e),o&&o(),a&&a(!1))}},{key:"getStyle",value:function(){var e=this.props,t=e.rect,n=e.placement,i=e.offsetX,o=e.offsetY;if(!t||!this.popoverContentDom)return this.state.style;var a=document.body.clientWidth,s=this.popoverContentDom,l=s.offsetWidth,r=s.offsetHeight,u=void 0,c=void 0;switch(n){case f.left:u={top:t.top+t.height/2-r/2+o,right:a-t.left+i},c={top:r/2-this.arrowSize-o};break;case f.right:u={top:t.top+t.height/2-r/2+o,left:t.right+i},c={top:r/2-this.arrowSize-o};break;case f.bottomRight:u={top:t.bottom+o,right:a-t.right+i},c={right:this.arrowSize+10-i};break;case f.bottomLeft:u={top:t.bottom+o,left:t.left+i},c={left:this.arrowSize+10};break;case f.bottom:u={top:t.bottom+o,left:t.right-l/2-t.width/2+i},c={left:l/2-this.arrowSize};break;case f.top:u={top:t.top-r+o,left:t.right-l/2-t.width/2+i},c={left:l/2-this.arrowSize};break;case f.topRight:u={top:t.top-r+o,right:a-t.right-i},c={right:this.arrowSize+10};break;case f.topLeft:u={top:t.top-r+o,left:t.left+i},c={left:this.arrowSize+10}}if(this.props.autoAdjustOverflow){if(u.left&&(u.left=Math.max(u.left,0)),u.right&&(u.right=Math.max(u.right,0)),a-(u.left+l)<0){switch(n){case f.top:case f.topLeft:case f.bottom:case f.bottomLeft:c={left:c.left-(a-(u.left+l))+10}}u.left=void 0,u.right=10}a-(u.right+l)<0&&(u.left=0,u.right=void 0)}this.setState({style:u,arrowStyle:c})}},{key:"getPixelRatio",value:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.children,o=t.placement,a=t.autoAdjustOverflow,s=t.drawArrow,l=this.state.arrowStyle,r=m()({},this.state.style,this.props.style);a||(r=m()({},r,{whiteSpace:"nowrap"}));var u="component-popover "+o;return n&&(u+=" "+n),h.a.createElement("div",{ref:function(t){return e.popoverContentDom=t},className:u,style:r},s&&h.a.createElement("div",{className:"popover-arrow "+o,style:l}),h.a.createElement("div",{className:"popover-body"},i))}}]),t}(d.PureComponent);y.defaultProps={offsetX:0,offsetY:0,isClickClosed:!0,drawCanvas:!1,drawArrow:!0};var C=y,E=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,wrap:null},n.saveWrap=function(e){n.wrap=e},n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.setState({visible:!0})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&this.setState({visible:n})}},{key:"getRect",value:function(){var e=this.wrap;return this.state.visible&&e?(e=this.props.children?e.children[0]:e.parentNode).getBoundingClientRect():null}},{key:"handleMouseEnter",value:function(){this.props.proactiveTrigger&&this.setState({visible:!0})}},{key:"handleMouseLeave",value:function(){this.props.proactiveTrigger&&this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.popoverClass,i=e.popoverStyle,o=e.content,a=e.placement,s=e.onClose,l=e.onVisibleChange,r=e.offsetX,u=e.offsetY,c=e.containerClassName,d=e.autoAdjustOverflow,f=e.drawArrow,v=e.isClickClosed,m=e.getContainer,w=this.state.visible,g=this.getRect();return h.a.createElement("popover-container",{className:c,ref:this.saveWrap,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},w&&h.a.createElement(p.default,{visible:!0,className:"wpp-popup",getContainer:m},h.a.createElement(C,{className:n,visible:w,rect:g,style:i,offsetX:r,offsetY:u,placement:a,onClose:s,onVisibleChange:l,isClickClosed:v,autoAdjustOverflow:d,drawArrow:f},o)),t)}}]),t}(d.PureComponent);E.placementTypes=f,E.defaultProps={placement:f.bottomRight,autoAdjustOverflow:!0};var k=E,_=n(148),T=(n(1830),function(e){function t(){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.content,i=e.onClose;return h.a.createElement("div",{className:"wpp-guide-tip-panel"},h.a.createElement("div",{className:"wpp-guide-tip-header"},h.a.createElement(_.default,{className:"tip-icon",type:_.default.types.other.meeting_tips}),h.a.createElement("p",{className:"tip-title"},t),h.a.createElement(_.default,{className:"close-btn",type:_.default.types.other.close,onClick:i})),n&&h.a.createElement("p",{className:"wpp-guide-tip-detail"},n))}}]),t}(d.PureComponent)),S=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowGuideTip=function(e){var t=e.detail,i=!(!t||!t.isClosed);n.setState({visible:!i}),n.props.onShowGuideTip&&n.props.onShowGuideTip()},n.onCloseGuideTiplose=function(e){n.setState({visible:!1}),n.props.onCloseGuideTip&&n.props.onCloseGuideTip()},n.refPopover=h.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.state={visible:e.defaultVisible},n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.props.eventName&&window.addEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.addEventListener("keydown",this.handleWindowKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),this.props.eventName&&window.removeEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.removeEventListener("keydown",this.handleWindowKeyDown)}},{key:"handleWindowKeyDown",value:function(e){var t=e.code,n=e.keyCode;"Escape"!==t&&27!==n||this.state.visible&&(this.stopBubble(e),this.onCloseGuideTiplose())}},{key:"stopBubble",value:function(e){(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0}},{key:"handleVisibleChange",value:function(e){this.setState({visible:e})}},{key:"handleWindowResize",value:function(){this.refPopover.current.forceUpdate()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.content,o=e.popoverClass,a=e.placement,s=e.offsetX,l=e.offsetY,r=e.isClickClosed,u=e.getContainer,c=e.drawArrow;if(!n&&!i)return null;var d=this.state.visible,p=h.a.createElement(T,{onClose:this.onCloseGuideTiplose,title:n,content:i});return h.a.createElement(k,{ref:this.refPopover,placement:a,visible:d,content:p,popoverClass:o,offsetX:s,offsetY:l,autoAdjustOverflow:!0,onVisibleChange:this.handleVisibleChange,isClickClosed:r,getContainer:u,drawArrow:c},t)}}]),t}(d.PureComponent);S.defaultProps={popoverClass:"",placement:k.placementTypes.bottomLeft,offsetX:0,offsetY:0,isClickClosed:!0,isEscClosed:!0,defaultVisible:!1},S.placementTypes=k.placementTypes;t.default=S},1872:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(1811),n(142)),h=n.n(d),p=n(146),f=n(148),v=n(252),m={normal:{icon:v.size16.network_normal,tips:_i18n("applications.public.components.commandbars.NetworkStatus.normal", "网络状态良好")},slow:{icon:v.size16.network_slow,tips:_i18n("applications.public.components.commandbars.NetworkStatus.slow", "网速延迟 {0} ms")},disconnected:{icon:"16 disconnect 1",tips:_i18n("applications.public.components.commandbars.NetworkStatus.disconnected", "当前网络不可用，请检查网络设置")},offLine:{icon:v.size16.network_offline,tips:_i18n("applications.public.components.commandbars.NetworkStatus.offline", "当前网络不可用，请检查网络设置")}},w=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={offLine:!1,speed:0},n.handleOffline=n.handleOffline.bind(n),n.handleOnline=n.handleOnline.bind(n),n.handleNetworkSpeedChange=n.handleNetworkSpeedChange.bind(n),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(p.default.names.network.ON_NETWORK_SPEED_CHANGE,this.handleNetworkSpeedChange),window.addEventListener("offline",this.handleOffline),window.addEventListener("online",this.handleOnline)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(p.default.names.network.ON_NETWORK_SPEED_CHANGE,this.handleNetworkSpeedChange),window.removeEventListener("offline",this.handleOffline),window.removeEventListener("online",this.handleOnline)}},{key:"handleNetworkSpeedChange",value:function(e){this.setState({speed:e.detail})}},{key:"handleOffline",value:function(){console.log("已断网"),this.setState({offLine:!0})}},{key:"handleOnline",value:function(){console.log("已联网"),this.setState({offLine:!1})}},{key:"render",value:function(){var e=this.props,t=e.connected,n=e.className,i=this.state,o=i.offLine,a=i.speed,s=m.normal;t?o?s=m.offLine:a>500&&(s=m.slow):s=m.disconnected;var l=s.tips.replace("{0}",a);return h.a.createElement(f.default,{className:n,type:s.icon,title:l})}}]),t}(d.PureComponent);t.a=w},198:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i={arrayTag:"[object Array]",boolTag:"[object Boolean]",dateTag:"[object Date]",funcTag:"[object Function]",numberTag:"[object Number]",objectTag:"[object Object]",stringTag:"[object String]",symbolTag:"[object Symbol]"},o={FUNC_ERROR_TEXT:"need function",ARRAY_ERROR_TEXT:"need array",ARRAYObj_ERROR_TEXT:"need obj or array"}},209:function(e,t,n){},213:function(e,t,n){"use strict";t.a={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"}},226:function(e,t,n){"use strict";n.r(t);var i=n(26),o=n.n(i),a=n(44),s=n.n(a),l=n(0),r=n.n(l),u=n(3),c=n.n(u),d=n(25),h=n.n(d),p=n(42),f=n.n(p),v=n(142),m=n.n(v),w=n(145),g=n(151),b=n.n(g),y=function(e){function t(e){r()(this,t);var n=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=m.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return f()(t,e),c()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(w.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,o=e.children,a="panel-item",l=this.refDiv.current;l&&-1!==l.className.indexOf(" hover")&&(a+=" hover"),t&&(a+=" disabled"),n&&(a+=" selected");var r=void 0===o?"undefined":s()(o);return"string"!==r&&"number"!==r||(a+=" only-text"),i&&(a+=" "+i),a}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,a=e.children,s=e.getStyle,l=e.visible,r=e.dataKey,u=e.keepEdit,c=e.draggable,d=e.onMouseEnter,h=e.onMouseLeave,p=e.onDragEnter,f=e.onDragStart,v=e.onDragEnd;if(!l)return!1;var w=this.getClassName(),g=s?s(i):null,y={};return d&&(y.onMouseEnter=d),h&&(y.onMouseLeave=h),m.a.createElement(b.a,o()({title:n},y),m.a.createElement("div",o()({ref:this.refDiv,id:t,className:w,style:g,"data-key":r||void 0,"data-keep-edit":u||void 0,draggable:c,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:f,onDragEnter:p,onDragEnd:v},y),a))}}]),t}(v.PureComponent);y.defaultProps={visible:!0},t.default=y},229:function(e,t,n){"use strict";n.r(t);var i=n(150),o=n.n(i),a=n(0),s=n.n(a),l=n(3),r=n.n(l),u=n(25),c=n.n(u),d=n(42),h=n.n(d),p=(n(260),n(142)),f=n.n(p),v=n(144),m=n(145),w=n(169),g=n(146),b=n(213),y=n(286),C=n(26),E=n.n(C);var k=function(e,t,n,i){n=function(e){var t=E()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var o=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case b.a.topCenter:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body.clientHeight,s=t.left+t.width/2-i/2,l=t.top-n,r=a-t.bottom-n,u=t.top-n-o,c=t.bottom+n;return{left:s,top:l>=o?u:r>=o?c:l>=50||l>=r?u:c}}(t,n,i);break;case b.a.topRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=t.right,u=s-t.left,c=t.right-i,d=t.left,h=void 0;h=r>=i?c:u>=i?d:r>=50||r>=u?c:d;var p=l-t.bottom-n,f=t.top-n,v=t.bottom+n,m=t.top-n-o;return{left:h,top:f>=o?m:p>=o||p>=50||p>=f?v:m}}(t,n,i);break;case b.a.topLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=t.right,u=s-t.left,c=t.right-i,d=t.left,h=void 0;h=u>=i?d:r>=i||r>=50||r>=u?c:d;var p=l-t.bottom-n,f=t.top-n,v=t.bottom+n,m=t.top-n-o;return{left:h,top:f>=o?m:p>=o||p>=50||p>=f?v:m}}(t,n,i);break;case b.a.bottomLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=s-t.left,u=t.right,c=t.left,d=t.right-i,h=void 0;h=r>=i?c:u>=i?d:r>=50||r>=u?c:d;var p=l-t.bottom-n,f=t.top-n,v=t.bottom+n,m=t.top-n-o;return{left:h,top:p>=o?v:f>=o?m:p>=50||p>=f?v:m}}(t,n,i);break;case b.a.bottomRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=t.right,u=s-t.left,c=t.right-i,d=t.left,h=void 0;h=r>=i?c:u>=i?d:r>=50||r>=u?c:d;var p=l-t.bottom-n,f=t.top-n,v=t.bottom+n,m=t.top-n-o;return{left:h,top:p>=o?v:f>=o?m:p>=50||p>=f?v:m}}(t,n,i);break;case b.a.rightBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=s-t.right-n,u=t.left-n,c=t.right+n,d=t.left-n-i,h=void 0;h=r>=i?c:u>=i?d:r>=50||r>=u?c:d;var p=l-t.top,f=t.bottom,v=t.top,m=t.bottom-o;return{left:h,top:p>=o?v:f>=o?m:p>=50||p>=f?v:m}}(t,n,i);break;case b.a.leftBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,l=a.clientHeight,r=s-t.right-n,u=t.left-n,c=t.right+n,d=t.left-n-i,h=void 0;h=u>=i?d:r>=i||r>=50||r>=u?c:d;var p=l-t.top,f=t.bottom,v=t.top,m=t.bottom-o;return{left:h,top:p>=o?v:f>=o?m:p>=50||p>=f?v:m}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(o.right=document.body.clientWidth-o.left-t.offsetWidth,delete o.left),o},_=function(e){function t(e){s()(this,t);var n=c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,o=n.props.triggerElement;!i||i.contains(t)||function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,o=i.pageX,a=i.pageY;return o>=n.left&&o<=n.right&&a>=n.top&&a<=n.bottom}return!1}(o,e)||y.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=f.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return h()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})).observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){this.props.onClose()}},{key:"handleWindowKeyDown",value:function(e){w.getKey(e)===w.Keys.Esc&&(y.b(this.level+1)||(Object(m.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){window.performance.now()-this.timestamp>300&&this.handleClose(e)}},{key:"handleWindowResize",value:function(){v.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose()}},{key:"bindEvents",value:function(){this.observerPanel(),g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var o=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(o>=n.top+n.height/2?"bottom":"top")}(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},o()(t,window.rightToLeft?"right":"left",0),o()(t,"top",0),t),i=this.props,a=i.placement,s=i.rect,l=i.distance,r=i.isAuto,u=i.triggerElement;if(u){var c=u.getBoundingClientRect(),d=c.top,h=c.bottom;s=Object.assign({},s,{top:d,bottom:h})}var p=k(a,e,s,l);return r&&(p=function(e,t){var n=e.left,i=e.right,o=e.top,a=t.offsetWidth,s=t.offsetHeight,l=document.body,r=l.clientWidth,u=l.clientHeight;return window.rightToLeft?(i+a+4>r&&(i=r-a-4),i=Math.max(4,i)):(n+a+4>r&&(n=r-a-4),n=Math.max(4,n)),o+s+4>u&&(o=u-s-4),o=Math.max(4,o),window.rightToLeft?{right:i,top:o}:{left:n,top:o}}(p,e)),Object.assign(n,p),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},o()(n,window.rightToLeft?"right":"left",0),o()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var a=this.props,s=a.distance,l=a.isSetHeight;if(!this.style){this.style=this.createStyle(t),l&&(this.style.height=function(e,t,n){var i=document.body.clientHeight,o=i-e-n;return e<0&&(o=i-2*n),t.offsetHeight<o?void 0:o}(this.style.top,t,s));var r=t.getBoundingClientRect().height;Math.abs(r-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return f.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=y.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,o=e.className,a=this.state.visible,s=null;"function"==typeof t.type&&(s={isListenEvent:a});var l=f.a.cloneElement(t,s),r=this.getPanelStyle(),u=this.getAnimationOrigin(r),c=this.calcTransparentPlaceholder(u),d=y.c;return a&&(this.showAnimation&&(d+=" animation-fade-scaleY-in"),d+=" origin-"+u,o&&(d+=" "+o)),f.a.createElement("div",{ref:this.refPanel,className:d,style:r,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},c,l)}}]),t}(p.PureComponent);_.placementTypes=b.a,_.defaultProps={placement:b.a.bottomLeft,distance:0,offsetX:0,isSetHeight:!1};t.default=_},243:function(e,t,n){"use strict";var i=n(186),o=n(198);t.a=function(e,t){if(Object(i.a)(e)!=o.a.arrayTag)throw new TypeError(o.b.ARRAY_ERROR_TEXT);for(var n=e.length,a=-1;++a<n;)if(t(e[a],a,e))return a;return-1}},244:function(e,t,n){"use strict";var i=n(186),o=n(198);t.a=function(e,t){var n=Object(i.a)(e);if(n===o.a.objectTag)for(var a in e)e.hasOwnProperty(a)&&t(e[a],a);else{if(n!==o.a.arrayTag)throw new TypeError(o.b.ARRAYObj_ERROR_TEXT);e.forEach(t)}}},245:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(209),n(142)),h=n.n(d),p=function(e){function t(){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),s()(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"divider-line"})}}]),t}(d.PureComponent);t.a=p},2527:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(2528),n(142)),h=n.n(d),p=n(145),f=n(144),v=n(155),m=n(166),w=n(151),g=n.n(w),b=n(1767),y=n(249),C=n(264),E=n(820),k=n(146),_=n(162),T=v.default.iconTypes.size16,S=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.delayTimeout=0,n.state={index:100,panelVisible:!1,inputReadOnly:!1,firstRender:!0,drag:!1},n.handleTouchStart=function(e){e.preventDefault(),e.target.click()},n.refReduce=h.a.createRef(),n.refIncrease=h.a.createRef(),n.refZoom=h.a.createRef(),n.handlePanelVisibleChange=n.handlePanelVisibleChange.bind(n),n.handleReduceBtnClick=n.handleReduceBtnClick.bind(n),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handlePanelIndexChange=n.handlePanelIndexChange.bind(n),n.handleWheelScroll=n.handleWheelScroll.bind(n),n.addGestureEvent=n.addGestureEvent.bind(n),n.handleGestureStart=n.handleGestureStart.bind(n),n.handleGestureChange=n.handleGestureChange.bind(n),n.handleGestureEnd=n.handleGestureEnd.bind(n),n.handleKeyBoardEvent=n.handleKeyBoardEvent.bind(n),n.wheelHandler=n.wheelHandler.bind(n),n.handleZoomValueWheel=n.handleZoomValueWheel.bind(n);var i=f.isPad?32:f.isSafari||f.isWpsClient?200:16;return n.throttleWheelEvent=Object(C.a)(n.wheelHandler,i,{trailing:!1}),n.debounceCollectZoom=Object(E.default)(n.collectZoom,5e3),n}return c()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.visible,n=e.disableGesture;t&&(window.__WPSENV__.commandbars.push({el:this.refReduce.current.getElement(),text:_i18n("applications.public.components.commandbars.ViewZoom.zoomOut", "缩小"),icon:T.minus}),window.__WPSENV__.commandbars.push({el:this.refIncrease.current.getElement(),text:_i18n("applications.public.components.commandbars.ViewZoom.zoomIn", "放大"),icon:T.add}),window.__WPSENV__.commandbars.push({el:this.refZoom,text:_i18n("applications.public.components.commandbars.ViewZoom.zoom", "缩放级别")}),this.refZoom.current.addEventListener("touchstart",this.handleTouchStart,!0)),this.adjustUI(this.props.index),window.addEventListener("keydown",this.handleKeyBoardEvent),f.isIE||f.isWpsClient?window.addEventListener("wheel",this.handleWheelScroll):window.addEventListener("wheel",this.handleWheelScroll,{passive:!1}),!0!==n?this.addGestureEvent():this.stopGestureEvent()}},{key:"componentDidUpdate",value:function(e,t){e.index!==this.props.index&&this.adjustUI(this.props.index)}},{key:"componentWillUnmount",value:function(){var e=this.props.disableGesture;window.removeEventListener("keydown",this.handleKeyBoardEvent),window.removeEventListener("wheel",this.handleWheelScroll,{passive:!1}),this.props.visible&&this.refZoom.current.removeEventListener("touchstart",this.handleTouchStart,!0),!0!==e?this.removeGestureEvent():this.enableGestureEvent()}},{key:"handleKeyBoardEvent",value:function(e){var t=this;if(!this.props.disabled&&Object(y.isCtrlOrCmd)(e)){var n=this.props.officeType,i=y.COMMON_CTRL_KEYCODE;switch(e.keyCode){case i.ADD:case i.NUMBER_ADD:case i.EQUAL:p.stopBubble(e),this.handleAddBtnClick();break;case i.MINUS:case i.NUMBER_MINUS:case i.CONNECT:p.stopBubble(e),this.handleReduceBtnClick();break;case i.ZERO:case i.NUMBER_ZERO:n===_.default.presentation?setTimeout((function(){return t.props.onBestScale()}),100):setTimeout((function(){return t.handlePanelIndexChange(100,!1,!1,!1)}))}}}},{key:"handleWheelScroll",value:function(e){if(!this.props.disabled){if(f.isSougou&&!0===e.ctrlKey&&e.preventDefault(),Object(y.isCtrlOrCmd)(e))return Date.now()-this.delayTimeout<1e3?void(f.isWindows&&e.preventDefault()):(p.stopBubble(e),void this.throttleWheelEvent(-e.deltaY,null,e));this.delayTimeout=Date.now(),Object(y.isTwoFingerZoom)(e)&&(p.stopBubble(e),this.throttleWheelEvent(e.wheelDeltaY,e.deltaY,e))}}},{key:"handleZoomValueWheel",value:function(e){this.throttleWheelEvent(-e.deltaY,null,e)}},{key:"addGestureEvent",value:function(){this.scale=1,document.documentElement.addEventListener("gesturestart",this.handleGestureStart),document.documentElement.addEventListener("gestureend",this.handleGestureEnd),document.documentElement.addEventListener("gesturechange",this.handleGestureChange)}},{key:"removeGestureEvent",value:function(){this.scale=null,document.documentElement.removeEventListener("gesturestart",this.handleGestureStart),document.documentElement.removeEventListener("gestureend",this.handleGestureEnd),document.documentElement.removeEventListener("gesturechange",this.handleGestureChange)}},{key:"stopGestureEvent",value:function(){document.documentElement.addEventListener("gesturestart",this.stopGesture),document.documentElement.addEventListener("gestureend",this.stopGesture),document.documentElement.addEventListener("gesturechange",this.stopGesture)}},{key:"enableGestureEvent",value:function(){document.documentElement.removeEventListener("gesturestart",this.stopGesture),document.documentElement.removeEventListener("gestureend",this.stopGesture),document.documentElement.removeEventListener("gesturechange",this.stopGesture)}},{key:"stopGesture",value:function(e){p.stopBubble(e)}},{key:"handleGestureStart",value:function(e){this.scale=1,this.startIndex=this.state.index,p.stopBubble(e)}},{key:"handleGestureChange",value:function(e){if(this.props.disabled)p.stopBubble(e);else{var t=e.scale,n=this.scale>t?-1:1;this.throttleWheelEvent(n,5,e),this.scale=t,p.stopBubble(e)}}},{key:"handleGestureEnd",value:function(e){this.scale=1,this.startIndex=this.state.index,p.stopBubble(e)}},{key:"wheelHandler",value:function(e,t,n){t&&Math.abs(t)<3||(e>0?this.handleAddBtnClick(n):e<0&&this.handleReduceBtnClick(n),k.default.dispatchEvent(k.default.names.CLOSE_DROPDOWN_PANEL))}},{key:"collectZoom",value:function(e){e<10?window.collection("zoom",{value:"size0"}):e<20?window.collection("zoom",{value:"size1"}):e<30?window.collection("zoom",{value:"size2"}):e<40?window.collection("zoom",{value:"size3"}):e<50?window.collection("zoom",{value:"size4"}):e<200?window.collection("zoom",{value:"size5"}):e<250?window.collection("zoom",{value:"size6"}):e<300?window.collection("zoom",{value:"size7"}):e<350?window.collection("zoom",{value:"size8"}):e<=400?window.collection("zoom",{value:"size9"}):e<=500&&window.collection("zoom",{value:"size10"})}},{key:"handlePanelVisibleChange",value:function(e){this.props.onShow&&e&&this.props.onShow(),this.setState({panelVisible:e}),k.default.dispatchEvent("viewZoomPanelChange",{visible:e})}},{key:"handleReduceBtnClick",value:function(e){this.btnClick(!1,e)}},{key:"handleAddBtnClick",value:function(e){this.btnClick(!0,e)}},{key:"handlePanelIndexChange",value:function(e,t,n,i){this.adjustUI(e),void 0!==t&&this.setState({type:t}),void 0!==n&&this.setState({inputReadOnly:n}),i&&this.props.doTrack&&this.props.doTrack(i)}},{key:"clearTypeReadOnly",value:function(){this.setState({type:void 0,inputReadOnly:void 0})}},{key:"btnClick",value:function(e,t){var n=t&&void 0!==t.initGestureEvent,i=this.state.index,o=this.props,a=o.outMax,s=o.outMin,l=o.stepLength;if(f.isPad&&n)i=Math.round(this.startIndex*t.scale);else{var r=i%l;0!==r?i=e?i+(l-r):i-r:i+=e?l:-l}i=Math.min(a,Math.max(i,s)),this.adjustUI(i,!0,t),this.clearTypeReadOnly()}},{key:"adjustUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments[1],i=arguments[2],o=this.props,a=o.max,s=o.min,l=o.outMax,r=o.outMin,u=this.state.index;if(!0===n){if(e>l&&e>u)return;if(e<r&&e<u)return}null!==e&&(u=e),u=Math.max(s,u),(u=Math.min(a,u))!==this.state.index&&this.setState({index:u,firstRender:null===this.state.index,inputReadOnly:!1},(function(){t.props.index!==u&&(t.props.onChange(u,i),t.debounceCollectZoom(u))}))}},{key:"getClassName",value:function(){var e=this.state,t=e.drag,n=e.firstRender,i="component-view-zoom";return this.props.disabled&&(i+=" disabled"),t||n||(i+=" transition"),i}},{key:"render",value:function(){var e=this.props,t=e.max,n=e.min,i=e.outMax,o=e.outMin,a=e.officeType,s=e.onBestScale;if(!1===e.visible)return null;var l=this.state,r=l.index,u=l.panelVisible,c=l.inputReadOnly,d=l.type;r=parseInt(r||0);var p=this.getClassName(),f=h.a.createElement(b.a,{officeType:a,max:t,min:n,index:r,type:d,inputReadOnly:c,visible:u,onChange:this.handlePanelIndexChange});return h.a.createElement("div",{className:p},h.a.createElement(v.default,{ref:this.refReduce,iconType:T.minus,title:_i18n("applications.public.components.commandbars.ViewZoom.zoomOut", "缩小"),disabled:r<=o,onClick:this.handleReduceBtnClick}),h.a.createElement(m.default,{panel:f,destroyOnHide:!1,visible:u,onVisibleChange:this.handlePanelVisibleChange},h.a.createElement(g.a,{title:_i18n("applications.public.components.commandbars.ViewZoom.title", "调整显示比例")},h.a.createElement("div",{ref:this.refZoom,className:"zoom-value"+(u?" selected":""),onWheel:this.handleZoomValueWheel},h.a.createElement("i",null,r,"%")))),h.a.createElement(v.default,{ref:this.refIncrease,iconType:T.add,title:_i18n("applications.public.components.commandbars.ViewZoom.zoomIn", "放大"),disabled:r>=i,onClick:this.handleAddBtnClick}),!!s&&h.a.createElement(v.default,{className:"zoom-best",title:_i18n("applications.public.components.commandbars.ViewZoom.zoomBest", "最佳显示比例"),iconType:T.view_zoom_best,onClick:s}))}}]),t}(d.PureComponent);S.defaultProps={max:400,min:10,outMax:300,outMin:50,middleIndex:100,stepLength:10,visible:!0,disableGesture:!1},t.a=S},2528:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},264:function(e,t,n){"use strict";t.a=function(e,t,n){var i=!(n&&!1===n.trailing),o=Date.now(),a=void 0,s=void 0,l=null;return Number(t)||(t=16),function(){for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];a=this;var c=Date.now();if(void 0===s)return s=-1,l=e.apply(this,r),o=c,l;var d=c-o,h=t-d;return h>0?-1===s&&(s=setTimeout((function(){!1!==i&&(l=e.apply(a,r),o=Date.now()),s=-1}),h)):(l=e.apply(this,r),o=c),l}}},282:function(e,t,n){"use strict";n.r(t),n.d(t,"base64ToArrayBuffer",(function(){return i})),n.d(t,"formatDecimal",(function(){return o})),n.d(t,"filterValid",(function(){return a})),n.d(t,"getStrLength",(function(){return s})),n.d(t,"isHighSurrogate",(function(){return l})),n.d(t,"isLowSurrogate",(function(){return r})),n.d(t,"isSurrogate",(function(){return u})),n.d(t,"replaceEmoji",(function(){return c})),n.d(t,"hasEmoji",(function(){return d}));var i=function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=t.charCodeAt(o);return i.buffer},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(""===e)return e;var n=(e=e.toString()).indexOf(".");return n>-1&&e.length-n-1>t&&(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t)),e.toString()},a=function(e){var t=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]","g");return e.replace(t,"")},s=function(e){for(var t=e.length,n=0,i=0;i<t;i++)0!=(65280&e.charCodeAt(i))&&n++,n++;return n},l=function(e){return e>=55296&&e<=56319},r=function(e){return e>=56320&&e<=57343},u=function(e){return e>=55296&&e<=57343};function c(e){return e.replace(/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g,"")}function d(e){return/(?:[\xA9\xAE\u2122\u23E9-\u23EF\u23F3\u23F8-\u23FA\u24C2\u25B6\u2600-\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDE51\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]|\uD83E[\uDD00-\uDDFF])/g.test(e)}},310:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(448),n(142)),h=n.n(d),p=function(e){function t(){return o()(this,t),r()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c()(t,e),s()(t,[{key:"render",value:function(){var e=this.props.className,t="component-divider";return e&&(t+=" "+e),h.a.createElement("div",{className:t})}}]),t}(d.PureComponent);t.default=p},340:function(e,t,n){"use strict";n.r(t),n.d(t,"findIndex",(function(){return i.a})),n.d(t,"find",(function(){return s})),n.d(t,"each",(function(){return l.a})),n.d(t,"sortBy",(function(){return d})),n.d(t,"groupBy",(function(){return h})),n.d(t,"throttle",(function(){return p.a})),n.d(t,"debounce",(function(){return f.debounce})),n.d(t,"debounceFrame",(function(){return v})),n.d(t,"getType",(function(){return o.a}));var i=n(243),o=n(186),a=n(198),s=function(e,t){if(Object(o.a)(e)!=a.a.arrayTag)throw new TypeError(a.b.ARRAY_ERROR_TEXT);var n=Object(i.a)(e,t);return n>-1?e[n]:void 0},l=n(244),r=n(43),u=n.n(r),c=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,s=e==e,l=Object(o.a)(e)===a.a.symbolTag,r=void 0!==t,u=null===t,c=t==t,d=Object(o.a)(e)===a.a.symbolTag;if(!u&&!d&&!l&&e>t||l&&r&&c&&!u&&!d||i&&r&&c||!n&&c||!s)return 1;if(!i&&!l&&!d&&e<t||d&&n&&s&&!i&&!l||u&&n&&s||!r&&s||!c)return-1}return 0},d=function(e){var t=Object(o.a)(e);if(!e||t===a.a.stringTag||t===a.a.numberTag)return[];if(t===a.a.arrayTag&&e.length<=1||t===a.a.objectTag&&Object.keys(e).length<=1)return e;for(var n=Array.prototype.slice.call(arguments,1),i=-1,s=n.length,l=[];++i<s;){var r=n[i],d=Object(o.a)(r);d===a.a.stringTag||d===a.a.funcTag?l.push(r):d===a.a.arrayTag&&l.push.apply(l,u()(r))}return 0===l.length&&l.push((function(e){return e})),(e=(e=t===a.a.objectTag?Object.values(e):e).map((function(e,t){var n=l.map((function(t){return Object(o.a)(t)===a.a.funcTag?t(e):e&&void 0!==e[t]?e[t]:e}));return e&&e.value?{index:t,value:e.value,filter:n}:{index:t,value:e,filter:n}}))).sort((function(e,t){for(var n=-1,i=l.length;++n<i;){var o=c(e.filter[n],t.filter[n]);if(o)return o}return e.index-t.index})),e.map((function(e){return e.value}))},h=function(e,t){if(null==e||!t)return{};var n={};return Object(l.a)(e,(function(e){var i=void 0,s=Object(o.a)(t);if(s===a.a.stringTag?i=e[t]:s===a.a.funcTag&&(i=t(e)),void 0!==i){var l=n[i];n[i]=l?[].concat(u()(l),[e]):[e]}})),n},p=n(264),f=n(156),v=function(e,t){if(Object(o.a)(e)!=a.a.funcTag)throw new TypeError(a.b.FUNC_ERROR_TEXT);t=Number(t)||0;var n=void 0,i=void 0,s=void 0,l=void 0;function r(){n&&cancelAnimationFrame(n),performance.now()-i>=t?e.apply(s,l):n=requestAnimationFrame(r)}return function(){l=Array.prototype.slice.call(arguments),s=this,i=performance.now(),n=requestAnimationFrame(r)}}},353:function(e,t,n){},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=(n(467),n(142)),h=n.n(d),p=n(340),f=n(145),v=n(282),m=n(144),w=function(e,t){return t>=e.split(".")[1].length},g=function(e,t,n,i){var o=e,a=/^(-)?(0)+$/,s=a.test(o);return s&&(o=o.replace(a,"$10")),t&&!n?function(e){e=Number(e);return{valid:/^\d+$/.test(e),newStr:e}}(o):t&&n?function(e){var t=/^(-)?\d*$/.test(e);return/(-)?\d+$/.test(e)&&(e=Number(e)),{valid:t,newStr:e}}(o):t||n?!t&&n?function(e,t,n){var i=/^(-)?\d+\.\d+$/,o=/^(-)?\d*$/.test(e)||/^(-)?\d+\.$/.test(e)||i.test(e);i.test(e)&&!w(e,n)&&(o=!1);return/(-)?0+\d+$/.test(e)&&(e=Number(e)),{valid:o,newStr:e}}(o,0,i):void 0:function(e,t){var n=/^\d+$/,i=/^\d+\.\d+$/,o=n.test(e)||/^\d+\.$/.test(e)||i.test(e);return i.test(e)&&!w(e,t)&&(o=!1),n.test(e)&&(e=Number(e)),{valid:o,newStr:e}}(o,i)},b=n(169),y={add:"add",subtract:"subtract"},C=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleWheel=function(e){f.isMouseInElement(e,n.mianRef.current)&&f.stopBubble(e)},n.clickTimeout=null,n.clickInterval=null,n.refAdd=h.a.createRef(),n.refInput=h.a.createRef(),n.mianRef=h.a.createRef(),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handleMinusBtnClick=n.handleMinusBtnClick.bind(n),n.handleInputBlur=n.handleInputBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleInputKeyUp=n.handleInputKeyUp.bind(n),n.handleInputWheel=n.handleInputWheel.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleContainerClick=n.handleContainerClick.bind(n),n.handleInputFocus=n.handleInputFocus.bind(n),n.getValue=n.getValue.bind(n);var i=n.props,a=i.value,s=i.defaultValue,l=i.step,u=i.debounceWait;return n.step=l||1,n.defaultValue=s||a,n.state={value:a},n._lockLazyChange=!0,n.debounceInputChange=Object(p.debounce)((function(e){n.inputChange(e)}),u),n}return c()(t,e),s()(t,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&(this.setState({value:this.props.value}),this._lockLazyChange=!0)}},{key:"componentDidMount",value:function(){document.addEventListener("wheel",this.handleWheel,m.getPassiveParam())}},{key:"componentWillUnmount",value:function(){clearTimeout(this.lazyTimer),document.removeEventListener("wheel",this.handleWheel,m.getPassiveParam())}},{key:"getValue",value:function(){var e=this.props,t=e.value,n=e.isInt,i=e.min,o=e.max,a=this.refInput.current.value,s=n?parseInt(a):parseFloat(a);return s>o||s<i?Number(t):isNaN(s)?Number(this.defaultValue):Number(s)}},{key:"focus",value:function(){f.setInputFocus(this.refInput.current)}},{key:"select",value:function(){this.refInput.current.select()}},{key:"blur",value:function(){this.refInput.current.blur()}},{key:"getInnerValue",value:function(){return Number(this.refInput.current.value)}},{key:"getInputText",value:function(){return this.refInput.current.value}},{key:"setValue",value:function(e){var t=this.props,n=t.onChange,i=t.isInt,o=t.max,a=t.min,s=t.places;return e=i?e:Object(v.formatDecimal)(e,s),e=(e=isNaN(e)?this.defaultValue:e)>o?o:e<a?a:e,this._lockLazyChange=e===this.props.value,this.setState({value:e}),n&&n(e),e}},{key:"setInvalidValue",value:function(e){var t=this.props.onOutOfRange;this.setState({value:e}),t&&t(e)}},{key:"inputChange",value:function(e){var t=this.props,n=t.max,i=t.min,o=t.isInt,a=t.isNegative,s=t.places,l=t.onOutOfRange,r=e.replace(/\s+/g,"");if(""!==r)if(r>n)l&&l(r);else{var u=g(r,o,a,s),c=u.valid,d=u.newStr;if(!(c&&d<i))return c&&isNaN(d)?(this.setState({value:d}),void(l&&l(e))):void(c&&"-0"===r?this.setState({value:r}):c&&this.setValue(d));this.setInvalidValue(d)}else this.setInvalidValue(r)}},{key:"handleInputChange",value:function(e){f.stopBubble(e);var t=e.target.value;this.props.debounceWait?this.debounceInputChange(t):this.inputChange(t)}},{key:"handleInputBlur",value:function(e){f.stopBubble(e),this.handleLazyChange(this.state.value),this.props.onBlur&&this.props.onBlur(e)}},{key:"handleInputFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"handleInputKeyDown",value:function(e){if(Object(b.isMatchShortCutKey)(e,[b.Keys.ArrowUp]))this.handleAddBtnClick(e);else if(Object(b.isMatchShortCutKey)(e,[b.Keys.ArrowDown]))this.handleMinusBtnClick(e);else{var t=this.props.onEnter;Object(b.isMatchShortCutKey)(e,[b.Keys.Enter])&&(f.stopBubble(e),t&&t(),this.handleLazyChange(this.state.value))}}},{key:"handleInputKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"handleInputWheel",value:function(e){if(this.props.readOnly)return!1;var t=parseFloat(this.state.value),n=this.props.step;e.deltaY>0||e.deltaX<0?t-=n:t+=n,this.handleLazyChange(this.setValue(t))}},{key:"handleAddBtnClick",value:function(e){this.btnClick(e,!0)}},{key:"handleMinusBtnClick",value:function(e){this.btnClick(e,!1)}},{key:"btnClick",value:function(e,t){f.stopBubble(e);var n=this.state.value,i=this.props.step,o=e.currentTarget.className;if(f.setInputFocus(this.refInput.current),-1===o.indexOf("disabled")&&-1===o.indexOf("readonly")){var a=parseFloat(n);a+=t?i:-i,this.handleLazyChange(this.setValue(a),t?y.add:y.subtract,!0)}}},{key:"handleMouseDown",value:function(e){var t=this,n=e.target===this.refAdd.current;clearTimeout(this.clickTimeout),clearInterval(this.clickInterval);var i={currentTarget:{className:e.currentTarget.className}};this.clickTimeout=setTimeout((function(){t.clickInterval=setInterval((function(){n?t.handleAddBtnClick(i):t.handleMinusBtnClick(i)}),100)}),500)}},{key:"handleMouseUp",value:function(){clearTimeout(this.clickTimeout),clearInterval(this.clickInterval)}},{key:"handleContainerClick",value:function(e){var t=this.props,n=t.stopbubble,i=t.onContainerClick;i&&i(e),n&&f.stopBubble(e)}},{key:"handleInputMouseDown",value:function(){f.stopOnceClick()}},{key:"handleLazyChange",value:function(e,t,n){var i=this.props.onLazyChange;i&&!this._lockLazyChange&&(clearTimeout(this.lazyTimer),this._lockLazyChange=!0,this.lazyTimer=setTimeout((function(){i(e,t)}),n?100:300))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.max,i=e.min,o=e.unit,a=e.readOnly,s=e.onPaste,l=e.showBtn,r=this.state.value;return h.a.createElement("div",{className:"component-input-number "+(t||""),ref:this.mianRef,onWheel:this.handleInputWheel,onClick:this.handleContainerClick},h.a.createElement("input",{ref:this.refInput,className:a?"readonly":"",value:r,maxLength:7,type:"text",tabIndex:-1,onFocus:this.handleInputFocus,onKeyUp:this.handleInputKeyUp,onKeyDown:this.handleInputKeyDown,onChange:this.handleInputChange,onBlur:this.handleInputBlur,readOnly:a,onPaste:s,unselectable:a?"on":null,disabled:a,onMouseDown:this.handleInputMouseDown}),l&&!m.isTouchScreen&&h.a.createElement("div",{className:"input-btns-wrap"+(a?"  readonly":"")},h.a.createElement("span",{ref:this.refAdd,className:"input-btn add"+(r>=n||a?" disabled":""),onClick:this.handleAddBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp}),h.a.createElement("span",{className:"input-btn minus"+(r<=i&&""!==r||a?" disabled":""),onClick:this.handleMinusBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp})),!!o&&h.a.createElement("i",{className:"unit"},o))}}]),t}(d.PureComponent);C.defaultProps={max:999999,min:-999999,value:0,isInt:!1,isNegative:!1,places:2,stopbubble:!0,showBtn:!0,step:1,debounceWait:0};t.b=C},390:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),s=n.n(a),l=n(3),r=n.n(l),u=n(25),c=n.n(u),d=n(42),h=n.n(d),p=(n(545),n(142)),f=n.n(p),v=n(144),m=n(146),w=n(155),g=n(191),b=n(750),y=w.default.iconTypes.size16,C=function(e){function t(){var e,n,i,o;s()(this,t);for(var a=arguments.length,l=Array(a),r=0;r<a;r++)l[r]=arguments[r];return n=i=c()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.state={didMount:!1,left:void 0,right:void 0,top:void 0,bottom:void 0},i.handleCloseModal=function(){i.props.visible&&i.props.isExclusive&&i.props.onClose()},i.handleKeyDown=function(e){!i.props.visible||"Escape"!==e.code&&27!==e.keyCode||i.props.onClose(e)},i.handleWindowResize=function(){i.props.visible&&(v.isTouchScreen?i.forceUpdate():i.fullDisplay(!0))},i.handleTouchStart=function(e){1===e.touches.length&&i.handleDragModal(e,!0)},i.handleDragModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.refTitle.current,o=i.refContainer.current,a=e.target,s=a.tagName;if("TEXTAREA"!==s&&"INPUT"!==s&&"true"!==a.contentEditable&&o.contains(a)){var l=i.props.isAllDrag;if(l||(l=a.classList&&a.classList.contains("drag")),l||(l=!!n&&n.contains(e.target)),l){var r=i.props.retainSize,u=function(e,t){if(e&&i.setState(e),i.props.onDragMove){var n=!e;i.props.onDragMove(n,t)}};b.onDragMove(e,o,r,u,t)}}},i.refContainer=f.a.createRef(),i.refTitle=f.a.createRef(),o=n,c()(i,o)}return h()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),window.addEventListener(m.default.names.CLOSE_NON_MODAL,this.handleCloseModal),this.props.visible&&this.firstShow()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener(m.default.names.CLOSE_NON_MODAL,this.handleCloseModal)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.visible,i=t.position;if(n){var o=JSON.stringify(i)===JSON.stringify(e.position);n===e.visible&&o||(this.state.didMount&&o?this.fullDisplay():this.firstShow())}}},{key:"firstShow",value:function(){var e=this.props.position,t=this.refContainer.current,n=t.offsetWidth,i=t.offsetHeight,a=o()({},e);a.didMount=!0,e||(a.left="calc(50% - "+n/2+"px",a.top="calc(50% - "+i/2+"px"),this.setState(a,this.fullDisplay)}},{key:"fullDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.isExclusive&&(m.default.dispatchEvent(m.default.names.CLOSE_DROPDOWN_PANEL),m.default.dispatchEvent(m.default.names.CLOSE_MODAL_DIALOG));var t=this.refContainer.current,n=this.state,i=n.left,o=n.right,a=n.top,s=n.bottom,l={left:i,right:o,top:a,bottom:s},r=b.fullDisplay(l,t,e?0:this.props.retainSize);this.setState(r,e?null:this.props.onShow)}},{key:"getClassName",value:function(){var e=this.props.className,t="component-non-modal animation-bounce-in drag";return this.state.didMount&&(t+=" did-mount"),e&&(t+=" "+e),t}},{key:"render",value:function(){if(!this.props.visible&&!this.state.didMount)return!1;var e=this.props,t=e.children,n=e.visible,i=e.title,o=e.options,a=e.showCloseBtn,s=this.props.onClose,l=this.state,r={left:l.left,top:l.top,right:l.right,bottom:l.bottom,width:l.width,height:l.height,minHeight:l.minHeight,minWidth:l.minWidth,maxHeight:l.maxHeight,maxWidth:l.maxWidth},u=this.getClassName();return f.a.createElement(g.default,{destroyOnHide:!1,visible:n},f.a.createElement("div",{ref:this.refContainer,className:u,tabIndex:"1",style:r,onTouchStart:this.handleTouchStart,onKeyDown:this.handleKeyDown,onMouseDown:this.handleDragModal},!!i&&f.a.createElement("div",{className:"non-modal-header drag"},f.a.createElement("div",{ref:this.refTitle,className:"title drag"},i),o,a&&f.a.createElement(w.default,{className:"close-btn",iconType:y.close,onClick:s})),f.a.createElement("div",{className:"non-modal-body"},t)))}},{key:"element",get:function(){return this.refContainer.current}}]),t}(p.PureComponent);C.defaultProps={visible:!0,showCloseBtn:!0,retainSize:30,isExclusive:!0,isAllDrag:!1},t.a=C},448:function(e,t,n){},464:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u}));var i=n(344),o=n(656),a=function(e){return{types:[i.HTTP_REQUEST,o.a.LOAD_UPDATE_NOTICES_SUCCESS,i.HTTP_FAILURE],callAPI:function(t){return t.get("/api/v3/office/tip/type/"+e).end()}}},s=function(e){return{types:i.HTTP_TYPES,callAPI:function(t){return t.get("/api/v3/office/tip/name/"+e).end()}}},l=function(e){return{types:i.HTTP_TYPES,callAPI:function(t){return t.post("/api/v3/office/tip/"+e).end()}}},r=null,u=function(e,t){var n={content:t};return{types:i.HTTP_TYPES,callAPI:function(t){return r&&r.abort(),(r=t.post("/api/v3/office/search/func/"+e).send(n)).end()}}}},467:function(e,t,n){},545:function(e,t,n){},6716:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(25),r=n.n(l),u=n(42),c=n.n(u),d=n(142),h=n.n(d),p=n(149),f=n(168),v=n.n(f),m=n(162),w=n(155),g=n(2527),b=n(1872),y=n(310),C=n(1034),E=n(1627),k=n(1513),_=n(249),T=n(144),S=n(1864),D=n(6717),O=n.n(D),M=(n(6720),n(179)),L=n(45),P=w.default.iconTypes.size16,N=window.Toast,B=function(e){function t(e){o()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onTaskPaneVisibleChange=function(e){e.detail.visible||n.handleCommentPanelClose()},n.handleOnline=function(){n.setState({onLine:!0})},n.handleOffline=function(){n.setState({onLine:!1})},n.handleGetThumbnailCount=function(){var e=n.selection.getSlideCount();n.setState({thumbnailCount:e})},n.handleKeyBoardEvent=function(e){n.props.showInkEditor&&Object(_.isCtrlOrCmd)(e)&&e.preventDefault()},n.handlePlayClick=function(){window.collection("newui","value",window.pcTrack.newui.play_now_bottomtoolbar),n.props.handlePlayMode("active")},n.commentPanelVisilbe=function(e){n.setState({commentPanelVisible:e})},n.toggleCommentPanel=function(){if(n.state.thumbnailCount){var e=!n.state.commentPanelVisible;e?window.collection("newui","value",window.pcTrack.newui.comment_switch_on):window.collection("newui","value",window.pcTrack.newui.comment_switch_off),n.setState({commentPanelVisible:e},(function(){n.dispatchEvent(n.eventTypes.comment.ON_COMMENT_TOGGLE,{visible:e})}))}},n.onInkVisible=function(){setTimeout((function(){n.setState({inkVisible:n.inkVisible})}))},n.toggleInkVisible=function(){n.state.thumbnailCount&&n.setState({inkVisible:!n.inkVisible},(function(){n.inkVisible?(N.success(_i18n("applications.presentation.components.StatusBar.hideMark", "墨迹已隐藏")),window.collection("newui","value",window.pcTrack.newui.ink_switch_off)):(N.success(_i18n("applications.presentation.components.StatusBar.showMark", "墨迹已显示")),window.collection("newui","value",window.pcTrack.newui.ink_switch_on)),n.editor.ink.setAllInkHidden(n.inkVisible)}))},n.handleMasterViewClick=function(){n.isMasterView?(n.dispatchEvent(n.eventTypes.guideTips.MasterViewGuideTips,{isClosed:!0}),window.collection("newui","value",window.pcTrack.newui.view_masterview_off_btn)):window.collection("newui","value",window.pcTrack.newui.view_masterview_on_btn),n.props.handleChangeMasterView()},n.handleShortcutVisibleChange=function(e){n.setState({shortcutPanelVisible:e},(function(){n.state.shortcutPanelVisible&&window.collection("newui","value",window.pcTrack.newui.shortcut_statusbar)}))},n.handleBestScale=n.handleBestScale.bind(n),n.state={thumbnailCount:0,inkVisible:n.inkVisible,commentPanelVisible:!1,onLine:window.navigator.onLine,shortcutPanelVisible:!1},n.handleCommentPanelClose=n.commentPanelVisilbe.bind(n,!1),n}return c()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){window.addEventListener("keydown",this.handleKeyBoardEvent),window.addEventListener(this.eventTypes.eventTypes.pc.ON_TASKPANE_VISIBLE,this.onTaskPaneVisibleChange),this.doc.on(this.doc.constructor.EVENT_TYPES.THUMBNAIL_UPDATE,this.handleGetThumbnailCount),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.handleGetThumbnailCount),this.on(this.eventTypes.names.ON_TOGGLE_INK_VISIBLE,this.onInkVisible),this.handleGetThumbnailCount()}},{key:"onUnBindEvent",value:function(){window.removeEventListener("keydown",this.handleKeyBoardEvent),window.removeEventListener(this.eventTypes.eventTypes.pc.ON_TASKPANE_VISIBLE,this.onTaskPaneVisibleChange),this.doc.off(this.doc.constructor.EVENT_TYPES.THUMBNAIL_UPDATE,this.handleGetThumbnailCount)}},{key:"handleBestScale",value:function(){this.props.handleAutoZoomClick(),window.collection("newui","value",window.pcTrack.newui.view_best_statusbar)}},{key:"render",value:function(){var e=this.props,t=e.public,n=t.file,i=t.network,o=i.connected,a=i.openSuccess,s=i.isAppReady,l=t.user,r=e.dispatch,u=e.viewZoom,c=e.activeSlideIndex,d=e.isPlayMode,p=e.showInkEditor,f=e.isMasterViewMode,v=e.readOnly,_=this.state,D=_.thumbnailCount,M=_.inkVisible,N=_.onLine,B=_.commentPanelVisible,x=_.shortcutPanelVisible,R=!a||!s,I=Object(L.hasQuery)("version"),W=o&&N;return f&&B&&this.toggleCommentPanel(),h.a.createElement("div",{className:"wpp_status_bar"},f?h.a.createElement("div",{className:"status_page_index"}," ",_i18n("applications.presentation.components.StatusBar.master", "母版")):h.a.createElement("div",{className:"status_page_index"},_i18n("applications.presentation.components.StatusBar.powerPoint", "幻灯片")," ",0===D?0:c+1,"/",D),h.a.createElement("div",{className:"status_tool_group"},!Object(L.hasQuery)("hidecmb")&&h.a.createElement(S.default,{placement:S.default.placementTypes.topLeft,eventName:this.eventTypes.guideTips.MasterViewGuideTips,title:_i18n("applications.presentation.components.StatusBar.masterViewGuidTips", "快速进入/退出母版视图"),offsetX:-11,isClickClosed:!1,isEscClosed:!1},h.a.createElement(w.default,{selected:f,disabled:R||v||!W,className:"status_btn",onClick:this.handleMasterViewClick,title:_i18n("applications.presentation.components.StatusBar.masterView", "母版视图"),iconType:P.wpp_master_view})),!I&&h.a.createElement(h.a.Fragment,null,h.a.createElement(w.default,{selected:M,disabled:R||!W||!D||f,className:"status_btn",onClick:this.toggleInkVisible,title:_i18n("applications.presentation.components.StatusBar.remarkInk", "显示墨迹"),iconType:P.show_mark})),h.a.createElement(w.default,{disabled:R,className:"status_btn",onClick:this.handlePlayClick,title:I?_i18n("applications.presentation.components.StatusBar.play", "播放"):Object(T.convertCtrl)(_i18n("applications.presentation.components.StatusBar.playShortCut", "播放(Ctrl+Enter)")),iconType:P.highlight_play}),h.a.createElement(O.a,{className:"status_btn",title:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.keyboardShortcut", "常用快捷键"),shortcutPanelVisible:x,onChange:this.handleShortcutVisibleChange}),h.a.createElement(b.a,{className:"network-status",connected:o}),h.a.createElement(y.default,null),!d&&u&&h.a.createElement(g.a,{officeType:m.default.presentation,index:u,disabled:R||p,onBestScale:this.handleBestScale,outMax:400,outMin:10,onChange:this.props.handleZoomChange}),h.a.createElement(C.a,null),h.a.createElement(k.a,{dispatch:r,file:n,user:l})),a&&h.a.createElement(E.a,null))}}]),t}(M.BaseComponent);B.propTypes={dispatch:v.a.func.isRequired},t.default=Object(p.connect)((function(e){return e}))(B)},6717:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=(0,i.__importDefault)(n(142)),a=(0,i.__importDefault)(n(155)),s=(0,i.__importDefault)(n(166)),l=(0,i.__importDefault)(n(151)),r=n(208),u=n(6718);n(6719);var c=s.default.DropdownPanel;t.default=o.default.memo((function(e){var t=e.className,n=e.title,i=e.shortcutPanelVisible,d=e.onChange,h=function(){var t=u.ShortcutList.map((function(e,t){return o.default.createElement("div",{className:"row",key:t},o.default.createElement(l.default,{title:e.actionText},o.default.createElement("span",{className:"action"},e.actionText)),o.default.createElement("span",{className:"shortcut"},(n=e.keyCode,r.userAgent.isMacOs&&(n=(n=(n=n.replace(/Ctrl/i,"⌘")).replace(/Shift/i,"⇧")).replace(/Alt/i,"⌥")),n.split("|").map((function(e,t){return o.default.createElement("i",{className:t%2==0?"keycode":"connector",key:t},e)})))));var n}));return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"shortcut-list"},o.default.createElement("div",{className:"row"},o.default.createElement("span",{className:"title"},e.title)),t))}(),p=o.default.createElement("div",{className:"shadow__wrapper"},o.default.createElement(c,{className:"shortcut-modal"},h));return o.default.createElement(s.default,{panel:p,visible:i,destroyOnHide:!1,onVisibleChange:d,placement:s.default.placementTypes.topCenter,distance:16},o.default.createElement(a.default,{className:t,selected:i,title:n,iconType:a.default.iconTypes.size16.statusbar_keyboard}))}))},6718:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutList=void 0,t.ShortcutList=[{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.textBox", "文本框"),keyCode:"".concat(_i18n("applications.presentation.components.StatusBar.ShortcutPanel.dbClick", "双击空白处"),"|/|T")},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.rectangle", "矩形"),keyCode:"R"},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.circle", "椭圆"),keyCode:"O"},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.line", "直线"),keyCode:"L"},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.connector", "连接符"),keyCode:"C"},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.copy", "复制一份"),keyCode:"Ctrl|+|D"},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.dragCopy", "水平/垂直复制一份"),keyCode:"Ctrl|+|Shift|+|".concat(_i18n("applications.presentation.components.StatusBar.ShortcutPanel.drag", "拖拽"))},{actionText:_i18n("applications.presentation.components.StatusBar.ShortcutPanel.zoomBest", "最佳比例"),keyCode:"Ctrl|+|0"}]},6719:function(e,t,n){},6720:function(e,t,n){},774:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return _}));var i=n(147),o=n.n(i),a=n(0),s=n.n(a),l=n(3),r=n.n(l),u=n(152),c=n.n(u),d=n(156),h=n(464),p=n(839),f=n(1187),v=n.n(f),m=null,w=null,g=null;function b(){if(!w){w={};var e=[];p.a.forEach((function(t){t.iconClassName=function(e){if(e){var t=e.split(" "),n=c()(t,2),i=n[0];return"icons icons-"+i+" icons-"+i+"-"+n[1]}}(t.icon),w[t.id]=t,e.push({id:t.id,text:t.text})})),(m=new v.a).postMessage({type:"init",items:e})}}var y,C=function(){function e(){s()(this,e),this._prevResult={keyword:null,values:[]},this._keyword=null,b(),this._handleMessage=this._handleMessage.bind(this),m.addEventListener("message",this._handleMessage)}return r()(e,[{key:"destroy",value:function(){m.removeEventListener("message",this._handleMessage)}},{key:"_handleMessage",value:function(e){var t=e.data,n=t.keyword,i=t.items;if(n===this._keyword){var o={},a=[];i.forEach((function(e){e.content&&e.url?a.push(e):o[e.text]||(o[e.text]=!0,a.push(w[e.id]))})),this._prevResult={keyword:n,values:a},this.onResult({keyword:n,result:a})}}},{key:"search",value:function(e,t,n){this.onResult=n,e=e.trim(),this._keyword=e,e!==this._prevResult.keyword?e?m.postMessage({type:"search",data:t,keyword:e}):(this._prevResult={keyword:e,values:[]},this.onResult({keyword:e,result:this._prevResult.values})):this.onResult({keyword:e,result:this._prevResult.values})}}]),e}(),E=Object(d.throttle)((y=o()(regeneratorRuntime.mark((function e(t,n){var i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.trim()){e.next=3;break}return n(null),e.abrupt("return");case 3:return i=window.__WPSENV__.reduxDispatch,e.next=6,i(Object(h.a)(window.officeType,t));case 6:(o=e.sent).error||n(o.response.body);case 8:case"end":return e.stop()}}),e,void 0)}))),function(e,t){return y.apply(this,arguments)}),100);function k(e,t){E(e,(function(n){g||(g=new C),g.search(e,n,t)}))}function _(e){return b(),Object.values(w).filter((function(t){return t.text===e}))}},820:function(e,t,n){"use strict";n.r(t);var i=n(186),o=n(198);t.default=function(e,t){if(Object(i.a)(e)!=o.a.funcTag)throw new TypeError(o.b.FUNC_ERROR_TEXT);t=Number(t)||0;var n=void 0,a=void 0,s=void 0;function l(){n&&(clearTimeout(n),n=null)}function r(){l(),e.apply(a,s)}return function(){s=Array.prototype.slice.call(arguments),a=this,l(),n=setTimeout(r,t)}}},962:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return g}));var i=n(0),o=n.n(i),a=n(3),s=n.n(a),l=n(144),r=n(145),u=n(45),c=n(146);function d(e){var t=e.documentElement,n=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen;if(n)return function(){return n.call(t)}}function h(){return!!window.__CONFIG__.isEnableFullScreen&&(!!d(window.document)&&(!(l.isIE&&!l.isEdge)&&(!(l.isQQBrowser||l.isWpsClient||l.isWps2019)&&!Object(u.hasQuery)("version"))))}var p=function(){function e(t,n,i){o()(this,e),this.win=t,this.doc=t.document,this.onChange=n,this.onF11=i,this._handleChange=this._handleChange.bind(this),this._handleF11=this._handleF11.bind(this),this.doc.addEventListener("keydown",this._handleF11),this.doc.addEventListener("fullscreenchange",this._handleChange),this.doc.addEventListener("mozfullscreenchange",this._handleChange),this.doc.addEventListener("webkitfullscreenchange",this._handleChange)}return s()(e,[{key:"destroy",value:function(){this.doc.removeEventListener("keydown",this._handleF11),this.doc.removeEventListener("fullscreenchange",this._handleChange),this.doc.removeEventListener("mozfullscreenchange",this._handleChange),this.doc.removeEventListener("webkitfullscreenchange",this._handleChange)}},{key:"fullScreen",value:function(){console.log("进入全屏"),d(this.doc)()}},{key:"exitFullScreen",value:function(){console.log("退出全屏"),function(e){var t=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen||e.webkitExitFullscreen;if(t)return function(){return t.call(e)}}(this.doc)()}},{key:"isFullScreen",value:function(){return void 0!==(e=this.doc).fullscreen?e.fullscreen:void 0!==e.webkitIsFullScreen?e.webkitIsFullScreen:void 0!==e.mozFullScreen?e.mozFullScreen:void 0;var e}},{key:"_handleChange",value:function(){this.onChange(this.isFullScreen())}},{key:"_handleF11",value:function(e){(l.isMacOs?e.ctrlKey&&e.metaKey&&"f"===e.key:122===e.keyCode)&&(Object(r.stopBubble)(e),this.onF11())}}]),e}(),f=void 0,v=void 0;function m(e){f=new p(window,e,g),window._parent!==window&&(v=new p(window._parent,e,g)),window.addEventListener(c.default.names.EXIT_FULL_SCREEN,b)}function w(){f.destroy(),v&&v.destroy(),window.removeEventListener(c.default.names.EXIT_FULL_SCREEN,b),f=null,v=null}function g(){var e=v||f;e.isFullScreen()?e.exitFullScreen():e.fullScreen()}function b(){var e=v||f;e.isFullScreen()&&e.exitFullScreen()}}}]);