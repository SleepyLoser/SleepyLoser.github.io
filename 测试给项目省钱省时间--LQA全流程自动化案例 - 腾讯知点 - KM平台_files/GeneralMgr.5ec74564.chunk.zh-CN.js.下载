(window.webpackJsonp=window.webpackJsonp||[]).push([[190],{1371:function(e,t,n){"use strict";var i,o=n(150),a=n.n(o),s=n(559);t.a=(i={},a()(i,s.a.SUCCESS_INCLUDE_DATA,_i18n("applications.public.components.commandbars.CopyNotice.success1", "由于浏览器的限制，点击「粘贴到其他应用」按钮，可将复制的内容带格式粘贴到其他应用。")),a()(i,s.a.SUCCESS_CONTENT_LONG,_i18n("applications.public.components.commandbars.CopyNotice.success2", "由于复制的内容长度超出浏览器限制，点击「粘贴到其他应用」按钮，可将前部分内容带格式粘贴到其他应用。")),a()(i,s.a.SUCCESS_CONTENT_LONG_TEXT,_i18n("applications.public.components.commandbars.CopyNotice.success3", "当前复制内容过多，超出浏览器限制，如果粘贴到其它应用，只能粘贴出部分内容，建议分批复制。")),a()(i,s.a.SUCCESS_CONTENT_LONG_TEXT_CUT,_i18n("applications.public.components.commandbars.CopyNotice.success4", "当前剪切内容过多，超出浏览器限制，如果粘贴到其它应用，只能粘贴出部分内容，建议分批剪切。")),i)},1493:function(e,t,n){"use strict";n.r(t),n.d(t,"convertUrlToDataURL",(function(){return h})),n.d(t,"convertBase64UrlToBlob",(function(){return f})),n.d(t,"getBase64Size",(function(){return m})),n.d(t,"convertImageToDataURL",(function(){return v})),n.d(t,"convertDataURLtoBlob",(function(){return g})),n.d(t,"convertDataURLtoFile",(function(){return w})),n.d(t,"convertBlobToDataURL",(function(){return y})),n.d(t,"convertBlobToFile",(function(){return E})),n.d(t,"convertImageToBlob",(function(){return _})),n.d(t,"convertUrlToBlob",(function(){return S})),n.d(t,"convertImageToFile",(function(){return C})),n.d(t,"convertUrlToFile",(function(){return b})),n.d(t,"downloadFile",(function(){return T})),n.d(t,"getOriginImage",(function(){return I})),n.d(t,"convertHttpToHttps",(function(){return L})),n.d(t,"compressImage",(function(){return O})),n.d(t,"ImageLazyLoad",(function(){return N})),n.d(t,"changeImageType",(function(){return D})),n.d(t,"getImageByFile",(function(){return R})),n.d(t,"changeImgFileType",(function(){return x}));var i,o,a=n(0),s=n.n(a),r=n(3),l=n.n(r),c=n(147),u=n.n(c),d=n(158),p=window.Toast,h=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o=new Image;o.crossOrigin="anonymous",o.onload=function(){if(this.height&&this.width){var e=document.createElement("canvas"),t=e.getContext("2d");e.height=this.height,e.width=this.width,t.drawImage(this,0,0);var i=e.toDataURL();return n&&n(i),e=null,i}p.warn(_i18n("applications.presentation.components.utils.imageHelpers.insertTip", "无法插入该类型图标，建议切换浏览器后重试"))},o.onerror=function(){i>=1&&e(t+"?v="+i,n,i-1)},o.src=t},f=function(e){for(var t=e.dataURL,n=e.type,i=window.atob(t.split(",")[1]),o=new ArrayBuffer(i.length),a=new Uint8Array(o),s=0;s<i.length;s++)a[s]=i.charCodeAt(s);return new Blob([o],{type:n})},m=function(e){var t=e.indexOf("="),n=(-1!==t?e.substring(0,t):e).length;return((n-n/4)/1024).toFixed(2)},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.92,i=document.createElement("canvas"),o=i.getContext("2d");i.height=e.height,i.width=e.width,o.drawImage(e,0,0);var a=i.toDataURL("image/"+t,n);return a},g=function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),o=i.length,a=new Uint8Array(o);o--;)a[o]=i.charCodeAt(o);return new Blob([a],{type:n})},w=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"picture.png",n=e.split(","),i=n[0].match(/:(.*?);/)[1],o=atob(n[1]),a=o.length,s=new Uint8Array(a);a--;)s[a]=o.charCodeAt(a);return new File([s],t,{type:i})},y=(i=u()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i=new FileReader;i.onload=function(t){e(t&&t.target&&t.target.result)},i.onerror=function(e){n(e)},i.readAsDataURL(t)})));case 1:case"end":return e.stop()}}),e,void 0)}))),function(e){return i.apply(this,arguments)}),E=function(e,t,n){return new File([e],t,{type:n,lastModified:Date.now()})},_=function(){return g(v.apply(void 0,arguments))},S=function(){return g(h.apply(void 0,arguments))},C=function(){return w(v.apply(void 0,arguments))},b=function(){return w(h.apply(void 0,arguments))},T=function(e,t){if(d.userAgent.isIE)window.navigator.msSaveBlob(e,t);else{var n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,document.body.appendChild(n);var i=document.createEvent("MouseEvents");i.initEvent("click",!1,!1),n.dispatchEvent(i),document.body.removeChild(n)}},I=function(e){return new Promise((function(t,n){window.backendImageManager.fetchImage({imageId:e,origin:!0,cb:function(e,i,o){e&&n(e),t(i)}})}))},L=function(e){return e.replace(/^http/,"https")},P=function(e){var t=e.image,n=e.maxWidth,i=e.maxHeight,o=e.type,a=e.quality,s=e.dataURL,r=t.width,l=t.height,c=r,u=l,d=!0;if(r>n||l>i?r/l>n/i?(c=n,u=Math.round(n*(l/r))):(u=i,c=Math.round(i*(r/l))):d=!1,!d&&s)return s;var p=document.createElement("canvas"),h=p.getContext("2d");return p.width=c,p.height=u,h.clearRect(0,0,c,u),h.drawImage(t,0,0,c,u),p.toDataURL(o,a)},k=function(e,t){var n=void 0;switch(t){case"base64":n=e;break;case"file":n=w(e);break;default:n=e}return n},O=function(e){var t=e.dataURL,n=e.image,i=(e.file,e.options),o=i.type,a=i.size,s=a.maxWidth,r=void 0===s?1e3:s,l=a.maxHeight,c=void 0===l?1e3:l,u=i.quality,d=void 0===u?1:u;return new Promise((function(e,i){var a=void 0;if(n)a=P({image:n,maxWidth:r,maxHeight:c,type:o,quality:d,dataURL:t}),e(k(a,o));else if(t){var s=new Image;s.src=t,s.onload=function(){a=P({image:s,maxWidth:r,maxHeight:c,type:o,quality:d}),e(k(a,o))},s.onerror=function(e){i(e)}}}))},N=function(){function e(t){s()(this,e),this.imglist=Array.from(t||[]),this.init()}return l()(e,[{key:"init",value:function(){this.load()}},{key:"load",value:function(){for(var e=this.imglist.length-1;e>=0;e--)this.getBound(this.imglist[e])&&this.loadImage(this.imglist[e],e)}},{key:"getBound",value:function(e){var t=e.getBoundingClientRect(),n=window.innerHeight;return t.top<=n}},{key:"loadImage",value:function(e,t){var n=e.getAttribute("data-src");e.src=n,this.imglist.splice(t,1)}}]),e}(),D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(o,a){try{var s=document.createElement("canvas");s.width=e.width*t,s.height=e.height*t,s.getContext("2d").drawImage(e,0,0,s.width,s.height),i?o(s.toDataURL(n)):s.toBlob((function(e){o(e)}),n)}catch(e){a(e)}}))},R=function(e){var t=window.URL.createObjectURL(e);return new Promise((function(e,n){var i=new Image;i.src=t,i.onload=function(){e(i)},i.onerror=function(e){n(e)}}))},x=(o=u()(regeneratorRuntime.mark((function e(t,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png";return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t);case 2:return i=e.sent,e.abrupt("return",D(i,n,o));case 4:case"end":return e.stop()}}),e,void 0)}))),function(e,t){return o.apply(this,arguments)})},1769:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),c=n(42),u=n.n(c),d=(n(1770),n(142)),p=n.n(d),h=n(146),f=n(144),m=n(559),v=n(205),g=n(148),w=n(322),y=n(1371),E=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showConfirm:!1,text:"",showLoading:!1,tip:""},n.timer=null,n.handlePasteClick=n.handlePasteClick.bind(n),n.handleIconClick=n.handleIconClick.bind(n),n.handleNotice=n.handleNotice.bind(n),n.handleOkConfirm=n.handleOkConfirm.bind(n),n.handlePasteLoading=n.handlePasteLoading.bind(n),n.handlePasteSuccess=n.handlePasteSuccess.bind(n),n}return u()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(h.default.names.edit.COPY_NOTICE,this.handleNotice),window.addEventListener(h.default.names.edit.COPY_PASTE_LOADING,this.handlePasteLoading),window.addEventListener(h.default.names.edit.COPY_PASTE_SUCCESS,this.handlePasteSuccess),window.addEventListener(h.default.names.edit.SECURITY_PASTE_NOTIFY,this.handlePasteSuccess)}},{key:"componentDidUpdate",value:function(e,t){e.connected&&!this.props.connected&&this.state.showLoading&&this.setState({showLoading:!1})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.timer=null,window.removeEventListener(h.default.names.edit.COPY_NOTICE,this.handleNotice),window.removeEventListener(h.default.names.edit.COPY_PASTE_LOADING,this.handlePasteLoading),window.removeEventListener(h.default.names.edit.COPY_PASTE_SUCCESS,this.handlePasteSuccess),window.removeEventListener(h.default.names.edit.SECURITY_PASTE_NOTIFY,this.handlePasteSuccess)}},{key:"renderContent",value:function(e,t){var n=t!==m.a.ERROR,i=!f.isPCWpsClient(),o=t!==m.a.SUCCESS_INCLUDE_DATA||!f.isPCWpsClient(),a="component-copy-notice-wrap";return n||(a+=" no-icon"),p.a.createElement("div",{className:a},p.a.createElement("div",{className:"msg"},e),n&&p.a.createElement("div",{className:"paste"},i&&p.a.createElement("span",{onClick:this.handlePasteClick},_i18n("applications.public.components.commandbars.CopyNotice.pasteBtn", "粘贴到其他应用")),o&&p.a.createElement(g.default,{type:g.default.types.size16.notice_ok_normal,onClick:this.handleIconClick})))}},{key:"handlePasteLoading",value:function(e){var t=this;clearTimeout(this.timer),this.timer=null;var n=e.detail.tip;this.timer=setTimeout((function(){t.setState({showLoading:!0,tip:n})}),500)}},{key:"handlePasteSuccess",value:function(){clearTimeout(this.timer),this.timer=null,this.setState({showLoading:!1})}},{key:"handleNotice",value:function(e){var t=this,n=e.detail,i=n.callBack,o=n.type,a=n.msg,s=o===m.a.ERROR?"":y.a[o];this.setState({text:s},(function(){t.callBack=i;var e=t.renderContent(a,o);window.Notice.info(e,5,window.Toast.defaultTop)})),window.collection("copyresult","value",o)}},{key:"handlePasteClick",value:function(){window.Notice.close(),this.callBack(),window.collection("copysnackbarsclick","click","copyToOtherApp")}},{key:"handleIconClick",value:function(){this.state.showConfirm||(this.setState({showConfirm:!0}),window.collection("copysnackbarsclick","click","info"))}},{key:"handleOkConfirm",value:function(){this.setState({showConfirm:!1})}},{key:"render",value:function(){var e=this.state,t=e.showConfirm,n=e.text,i=e.tip,o=e.showLoading;return p.a.createElement(p.a.Fragment,null,t&&p.a.createElement(v.default,{className:"notice-confirm",okBtnText:_i18n("applications.public.components.commandbars.CopyNotice.okBtn", "知道了"),onOk:this.handleOkConfirm},p.a.createElement("div",null,n)),o&&p.a.createElement(w.default,{text:i}))}}]),t}(d.PureComponent);t.a=E},1770:function(e,t,n){},1833:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canShapePreview=t.isValidPicture=t.isBrokenPicShape=t.getImgMsgByShape=void 0;var i=function(e){var t=e&&window.APP.shell.doc.getShapeInActiveSlide(e.getId());return!(null==t?void 0:t.isLocalShape())},o=["jpg","jpeg","png","gif","svg"];t.getImgMsgByShape=function(e){var t,n=null==e?void 0:e.getPicture();if(null===(t=null==n?void 0:n.blip)||void 0===t?void 0:t.blipAtom){var a=n.blip.blipAtom,s=a.format,r=a.imageHeight,l=a.imageId,c=a.imageWidth,u=a.size;if(l&&u>0&&c>0&&r>0)return o.includes(s)?{format:s,imageHeight:r,imageId:l,imageWidth:c,size:u}:{imageId:l}}return i(e)&&{isDrawAsImg:!0}};t.isBrokenPicShape=function(e){var t;if(!e)return!1;var n=e.getPicture();if(null===(t=null==n?void 0:n.blip)||void 0===t?void 0:t.blipAtom){var i=n.blip.blipAtom,o=i.imageHeight,a=i.imageId,s=i.imageWidth,r=i.size;if(a>0&&r<=0&&s<=0&&o<=0)return!0}return!1};t.isValidPicture=function(e){return!!(0,t.getImgMsgByShape)(e)};t.canShapePreview=function(e,n){return!(!e||e.isGroupShape()||e.isLatexMath()||e.isMedia()||e.isHidden()||e.getChartLayer())&&(!(n||!e.getPicture())||(n?(0,t.isValidPicture)(e):i(e)))}},2267:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return p}));var i=n(147),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),c=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;s()(this,e),this._props={list:t,func:n,timeout:i},this._promise=this._init().catch((function(e){console.warn("RunTasks: ",e)}))}return l()(e,[{key:"_init",value:function(){var e=this,t=0,n=Date.now(),i=this._props,a=i.list,s=i.func,r=i.timeout;return new Promise((function(i,l){if(Array.isArray(a)){var c=(u=o()(regeneratorRuntime.mark((function o(){var u;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!e._stop){o.next=4;break}l("task stop"),o.next=13;break;case 4:if(!(t<a.length)){o.next=12;break}return o.next=7,s(a[t],t);case 7:t++,u=r-Date.now()-n,setTimeout((function(){c(),n=Date.now()}),u<0?0:u),o.next=13;break;case 12:i(!0);case 13:case"end":return o.stop()}}),o,e)}))),function(){return u.apply(this,arguments)});setTimeout(c,r)}else l("list should be an array");var u}))}},{key:"then",value:function(e){e&&this._promise.then(e)}},{key:"stop",value:function(){this._stop=!0}}]),e}(),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split(""),d={};function p(e){var t=d[e]||"";if(t)return t;for(var n=53819,i=e.length-1;i>-1;i--)n+=(n<<5)+e.charCodeAt(i);var o=2147483647&n;do{t+=u[63&o],o>>=6}while(o);return d[e]=t,t}},322:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),c=n(42),u=n.n(c),d=(n(407),n(142)),p=n.n(d),h=n(191),f=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.timer=null;var i=n.props.delay;return n.state={visible:!i},n}return u()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.delay;t&&(this.timer=setTimeout((function(){e.setState({visible:!0})}),t))}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"render",value:function(){if(!this.state.visible)return null;var e=this.props,t=e.text,n=e.getContainer,i=e.children,o=e.className,a=p.a.classNames({"component-loading":1},o);return p.a.createElement(h.default,{visible:!0,getContainer:n,className:a},p.a.createElement("div",{className:"loading-content"},p.a.createElement("div",{className:"loading-img "+window.officeType}),!!t&&p.a.createElement("div",{className:"text"},t),!!i&&p.a.createElement("div",{className:"custom-content"},i)))}}]),t}(d.PureComponent);t.default=f},348:function(e,t,n){"use strict";n.r(t),n.d(t,"copyToClipboard",(function(){return o}));function i(e,t){var n,i,o,a,s,r,l=!1;t||(t={}),n=t.debug||!1;try{if(o=function(){var e=document.getSelection();if(!e.rangeCount&&0!==e.rangeCount)return function(){};for(var t=document.activeElement,n=[],i=0;i<e.rangeCount;i++)n.push(e.getRangeAt(i));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),a=document.createRange(),s=document.getSelection(),(r=document.createElement("span")).textContent=e,r.style.all="unset",r.style.position="fixed",r.style.top=0,r.style.clip="rect(0, 0, 0, 0)",r.style.whiteSpace="pre",r.style.webkitUserSelect="text",r.style.MozUserSelect="text",r.style.msUserSelect="text",r.style.userSelect="text",document.body.appendChild(r),a.selectNode(r),s.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(o){n&&console.error("unable to copy using execCommand: ",o),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),l=!0}catch(o){n&&console.error("unable to copy using clipboardData: ",o),n&&console.error("falling back to prompt"),i=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(i,e)}}finally{s&&("function"==typeof s.removeRange?s.removeRange(a):s.removeAllRanges()),r&&document.body.removeChild(r),o()}return l}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=null;t&&(o=t.getContainer||null);var a=n||_i18n("applications.public.helpers.copy2clipboard.success", "复制成功");return i(e,t)?(window.Toast.success(a,o),!0):(window.Toast.error(_i18n("applications.public.helpers.copy2clipboard.fail", "复制失败"),o),!1)}},3857:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageLazyLoad=t.openedFilePermission=t.isFilePermissImport=t.getImageRect=t.ThumbnailSize=t.getFileName=t.isFilesSizeExceed=t.SupportExtArr=t.ResultCode=void 0;var i,o=n(4555);!function(e){e.PermissionDenied="permissionDenied",e.SecureDocumentError="SecureDocumentError",e.LightlinkForbid="lightlinkForbid",e.ForbidProtectedFile="forbidProtectedFile",e.InternalError="internalError",e.FileNotExists="fileNotExists",e.OpenedFileNoPermission="openedFileNoPermission",e.Success="success",e.Processing="processing"}(i=t.ResultCode||(t.ResultCode={})),t.SupportExtArr=["ppt","pptx","pptm","ppsx","ppsm","pps","potx","potm","dpt","dps","pot"];t.isFilesSizeExceed=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].size;return t>314572800};t.getFileName=function(e){return-1!==e.indexOf(".")&&(e=e.substring(0,e.lastIndexOf("."))),e},t.ThumbnailSize={width:134,height:76};t.getImageRect=function(e){return new Promise((function(t){var n=new Image;n.onload=function(){var e=n.width,i=n.height;t({width:e,height:i})},n.onerror=function(){t(null)},n.src=e}))};t.isFilePermissImport=function(e){return new Promise((function(t,n){window.__WPSENV__.reduxDispatch((0,o.getFileInfo)(e)).then((function(e){var o,a,s,r,l,c;if(e.error)n(e.result);else{var u=null===(a=null===(o=e.response)||void 0===o?void 0:o.user_acl)||void 0===a?void 0:a.copy,d=null===(r=null===(s=e.response)||void 0===s?void 0:s.user_acl)||void 0===r?void 0:r.download,p=null===(c=null===(l=e.response)||void 0===l?void 0:l.user_acl)||void 0===c?void 0:c.saveas;u||d||p?t(e):n(i.PermissionDenied)}}))}))};t.openedFilePermission=function(e){return new Promise((function(t,n){window.__WPSENV__.reduxDispatch((0,o.getFileInfo)(e)).then((function(e){var o,a;e.error?e.result===i.PermissionDenied?n(i.OpenedFileNoPermission):n(e.result):(null===(a=null===(o=e.response)||void 0===o?void 0:o.user_acl)||void 0===a?void 0:a.update)?t(e):n(i.OpenedFileNoPermission)}))}))};var a=function(){function e(e){this.wrapper=e,this.init()}return e.prototype.init=function(){this.load()},e.prototype.load=function(){for(var e=this.wrapper.querySelectorAll("img"),t=Array.from(e||[]),n=0;n<t.length;n++)this.getBound(t[n])&&this.loadImage(t[n])},e.prototype.getBound=function(e){var t=this.wrapper.getBoundingClientRect(),n=e.getBoundingClientRect();return n.bottom>t.top&&n.top<t.bottom},e.prototype.loadImage=function(e){if(!e.src){var t=e.getAttribute("data-src");e.src=t}},e}();t.ImageLazyLoad=a},3858:function(e,t,n){e.exports=function(e,t){n.e(365).then(n.t.bind(null,2857,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},390:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),c=n(25),u=n.n(c),d=n(42),p=n.n(d),h=(n(545),n(142)),f=n.n(h),m=n(144),v=n(146),g=n(155),w=n(191),y=n(750),E=g.default.iconTypes.size16,_=function(e){function t(){var e,n,i,o;s()(this,t);for(var a=arguments.length,r=Array(a),l=0;l<a;l++)r[l]=arguments[l];return n=i=u()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.state={didMount:!1,left:void 0,right:void 0,top:void 0,bottom:void 0},i.handleCloseModal=function(){i.props.visible&&i.props.isExclusive&&i.props.onClose()},i.handleKeyDown=function(e){!i.props.visible||"Escape"!==e.code&&27!==e.keyCode||i.props.onClose(e)},i.handleWindowResize=function(){i.props.visible&&(m.isTouchScreen?i.forceUpdate():i.fullDisplay(!0))},i.handleTouchStart=function(e){1===e.touches.length&&i.handleDragModal(e,!0)},i.handleDragModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.refTitle.current,o=i.refContainer.current,a=e.target,s=a.tagName;if("TEXTAREA"!==s&&"INPUT"!==s&&"true"!==a.contentEditable&&o.contains(a)){var r=i.props.isAllDrag;if(r||(r=a.classList&&a.classList.contains("drag")),r||(r=!!n&&n.contains(e.target)),r){var l=i.props.retainSize,c=function(e,t){if(e&&i.setState(e),i.props.onDragMove){var n=!e;i.props.onDragMove(n,t)}};y.onDragMove(e,o,l,c,t)}}},i.refContainer=f.a.createRef(),i.refTitle=f.a.createRef(),o=n,u()(i,o)}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),window.addEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal),this.props.visible&&this.firstShow()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.visible,i=t.position;if(n){var o=JSON.stringify(i)===JSON.stringify(e.position);n===e.visible&&o||(this.state.didMount&&o?this.fullDisplay():this.firstShow())}}},{key:"firstShow",value:function(){var e=this.props.position,t=this.refContainer.current,n=t.offsetWidth,i=t.offsetHeight,a=o()({},e);a.didMount=!0,e||(a.left="calc(50% - "+n/2+"px",a.top="calc(50% - "+i/2+"px"),this.setState(a,this.fullDisplay)}},{key:"fullDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.isExclusive&&(v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL),v.default.dispatchEvent(v.default.names.CLOSE_MODAL_DIALOG));var t=this.refContainer.current,n=this.state,i=n.left,o=n.right,a=n.top,s=n.bottom,r={left:i,right:o,top:a,bottom:s},l=y.fullDisplay(r,t,e?0:this.props.retainSize);this.setState(l,e?null:this.props.onShow)}},{key:"getClassName",value:function(){var e=this.props.className,t="component-non-modal animation-bounce-in drag";return this.state.didMount&&(t+=" did-mount"),e&&(t+=" "+e),t}},{key:"render",value:function(){if(!this.props.visible&&!this.state.didMount)return!1;var e=this.props,t=e.children,n=e.visible,i=e.title,o=e.options,a=e.showCloseBtn,s=this.props.onClose,r=this.state,l={left:r.left,top:r.top,right:r.right,bottom:r.bottom,width:r.width,height:r.height,minHeight:r.minHeight,minWidth:r.minWidth,maxHeight:r.maxHeight,maxWidth:r.maxWidth},c=this.getClassName();return f.a.createElement(w.default,{destroyOnHide:!1,visible:n},f.a.createElement("div",{ref:this.refContainer,className:c,tabIndex:"1",style:l,onTouchStart:this.handleTouchStart,onKeyDown:this.handleKeyDown,onMouseDown:this.handleDragModal},!!i&&f.a.createElement("div",{className:"non-modal-header drag"},f.a.createElement("div",{ref:this.refTitle,className:"title drag"},i),o,a&&f.a.createElement(g.default,{className:"close-btn",iconType:E.close,onClick:s})),f.a.createElement("div",{className:"non-modal-body"},t)))}},{key:"element",get:function(){return this.refContainer.current}}]),t}(h.PureComponent);_.defaultProps={visible:!0,showCloseBtn:!0,retainSize:30,isExclusive:!0,isAllDrag:!1},t.a=_},407:function(e,t,n){},4555:function(e,t,n){"use strict";n.r(t),n.d(t,"startSlidesExport",(function(){return u})),n.d(t,"getSlidesExportUrl",(function(){return d})),n.d(t,"getFileInfo",(function(){return p}));var i=n(147),o=n.n(i),a=n(26),s=n.n(a),r=n(327),l={password:"",readonly:!1,modify_password:"",sync:!0},c={},u=function(e,t,n,i){var a,u=s()({},i,{clientId:window.RPCClient.clientID,connid:window.__WPSENV__.conn_id,group:window.__WPSENV__.user_group||"",args:l,ex_args:c}),d="/api/v3/office/file/"+e+"/slides/async-export";return{types:r.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(a=o()(regeneratorRuntime.mark((function e(i){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.post(d).query({version:t,slidecount:n}).send(u).end();case 2:return o=e.sent,e.abrupt("return",o.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return a.apply(this,arguments)})}},d=function(e,t,n,i){var a,s="/api/v3/office/file/"+e+"/slides/export-progress";return{types:r.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(a=o()(regeneratorRuntime.mark((function e(o){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.get(s).query({version:t,from_page:n,to_page:i}).end();case 2:return a=e.sent,e.abrupt("return",a.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return a.apply(this,arguments)})}},p=function(e){var t,n="/api/drive/v5/files/"+e+"/metadata";return{types:r.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(n).end();case 2:return i=e.sent,e.abrupt("return",i.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}}},545:function(e,t,n){},559:function(e,t,n){"use strict";t.a={SUCCESS_INCLUDE_DATA:1,SUCCESS_CONTENT_LONG:2,SUCCESS_CONTENT_LONG_TEXT:3,SUCCESS_CONTENT_LONG_TEXT_CUT:4,ERROR:5}},6807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=n(142),a=(0,i.__importDefault)(n(164)),s=(0,i.__importDefault)(n(6808)),r=(0,i.__importDefault)(n(237)),l=n(1833),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onImgPreview=function(e){var t=e.detail,o=t.shape,a=t.imgParams;if(a||(0,l.isValidPicture)(o)){var s=window.selection.getActiveSlide(),r=null==s?void 0:s.getShapeTree();if(r){var c=[],u=a&&a.index||0,d=0;!function e(t){if(t)for(var s=0;s<t.length;s++){var r=t[s];if(r.isGroupShape())e(r.getChilds());else if((0,l.canShapePreview)(r,!0)){a||o!==r||(u=d);var p=(0,l.getImgMsgByShape)(r);if(p){var h=r.getSlideId(),f=r.getId(),m=n.getThumbUrl(p.isDrawAsImg?{slideId:h,shapeId:f}:{imageId:p.imageId});c.push((0,i.__assign)((0,i.__assign)({},p),{shape:r,thumbUrl:m,slideId:h,shapeId:f,url:p.isDrawAsImg?m:"",isProcessOn:r.getShapeType()===n.props.ShapeType.Processon})),d++}}}}(r.getChilds()),n.showImageViewer(c,u,a)}}else window.Toast.warn(_i18n("applications.presentation.components.ImageViewer.picErrorTip", "图片已损坏，无法显示"))},n.getThumbUrl=function(e){var t=window.backendImageManager.fetchImageSync((0,i.__assign)((0,i.__assign)({},e),{thumbnail:!0}));return t||(t=window.backendImageManager.fetchImageSync((0,i.__assign)({},e))),t||(t=window.backendImageManager.fetchImageSync((0,i.__assign)((0,i.__assign)({},e),{thumbnail:!0,noNeedLoad:!0}))),t||(t=window.backendImageManager.fetchImageSync((0,i.__assign)((0,i.__assign)({},e),{noNeedLoad:!0}))),t&&t.image?t.image.src||t.image.data_url:""},n.showImageViewer=function(e,t,i){n.setState({imgDatas:e,imgParams:i,defaultIndex:t,visible:!0})},n.onImageViewerClose=function(){n.setState({visible:!1,imgDatas:[],defaultIndex:0}),n.sendMsgToRemarkWin({value:"close"}),r.default.uilDispatcher.fire(r.default.names.ON_EXIT_IMAGE_VIEWER)},n.sendMsgToRemarkWin=function(e){n.props.isRemarkSpeaker&&!n.props.isRemarksWin&&r.default.uilDispatcher.fire(r.default.names.ON_POST_REMARKS_DATA,{event:r.default.remarkEvent.NORMAL_INFO,data:(0,i.__assign)({type:"originPic"},e)})},n.state={imgDatas:null,defaultIndex:0,visible:!1,imgParams:null},n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){window.addEventListener(r.default.names.ON_OPEN_IMAGE_VIEWER,this.onImgPreview),r.default.uilDispatcher.fire(r.default.names.ON_IMAGE_VIEWER_DID_MOUNT)},t.prototype.componentWillUnmount=function(){window.removeEventListener(r.default.names.ON_OPEN_IMAGE_VIEWER,this.onImgPreview)},t.prototype.render=function(){var e=this.props,t=e.connected,n=e.readOnly,i=this.state,o=i.visible,r=i.imgDatas,l=i.defaultIndex,c=i.imgParams;return o?(0,a.default)(s.default,{connected:t,readOnly:n,imgDatas:r,defaultIndex:l,initParams:c,onClose:this.onImageViewerClose,sendMsgToRemarkWin:this.sendMsgToRemarkWin}):null},t}(o.PureComponent);t.default=c},6808:function(e,t,n){e.exports=function(e,t){n.e(209).then(n.t.bind(null,7629,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6809:function(e,t,n){e.exports=function(e,t){n.e(215).then(n.bind(null,8129)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6810:function(e,t,n){e.exports=function(e,t){n.e(211).then(n.t.bind(null,7635,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6811:function(e,t,n){e.exports=function(e,t){n.e(210).then(n.bind(null,7638)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6812:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=n(179),a=n(3857),s=(0,i.__importDefault)(n(6813)),r=(0,i.__importDefault)(n(164)),l=window.__WPSPLUGIN__.helper,c=window.Toast,u=function(e){function t(t){var n=e.call(this,t)||this;return n.openPPTFileSelector=function(){var e={title:_i18n("applications.presentation.components.ImportSlide.importPPTTitle", "请选择包含导入幻灯片的文件"),isSelectFile:!0,sendShareLink:!1,isMulti:!0,hide:"lastest",from:"import_slide",file:{includes:a.SupportExtArr,fileLitmitNum:5}},t=l.exec(l.types.FileSelector,{config:e});n.stopKeyEvent(!0),t.then((function(e){n.onFileSelect(e)})).catch((function(e){n.stopKeyEvent(!1)}))},n.onFileSelect=function(e){var t=e.data||[];if("success"===e.result){if(!t||0===t.length)return;if(t.length>5&&(t=t.slice(0,5),c.warn(_i18n("applications.presentation.components.ImportSlide.maxSelectFiles", "最多选择5份文件"))),(0,a.isFilesSizeExceed)(t))return void c.warn(_i18n("applications.presentation.components.ImportSlide.maxFilesSize", "选择文件总和不能超过300M"));n.openSlideSelector(t)}n.stopKeyEvent(!1)},n.openSlideSelector=function(e){n.setState({modalVisible:!0,fileList:e})},n.closeSlideSelector=function(){n.setState({modalVisible:!1})},n.stopKeyEvent=function(e){n.fire(n.uiEventTypes.names.ON_STOP_KEY_EVENT,e)},n.state={modalVisible:!1,fileList:null},n}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.on(this.uiEventTypes.pc.OPEN_PPT_FILE_SELECTOR,this.openPPTFileSelector),this.on(this.uiEventTypes.pc.OPEN_SLIDE_SELECTOR,this.openSlideSelector),this.on(this.uiEventTypes.pc.CLOSE_SLIDE_SELECTOR,this.closeSlideSelector)},t.prototype.onUnBindEvent=function(){this.off(this.uiEventTypes.pc.OPEN_PPT_FILE_SELECTOR,this.openPPTFileSelector),this.off(this.uiEventTypes.pc.OPEN_SLIDE_SELECTOR,this.openSlideSelector),this.off(this.uiEventTypes.pc.CLOSE_SLIDE_SELECTOR,this.closeSlideSelector)},t.prototype.render=function(){var e=this.state,t=e.modalVisible,n=e.fileList;return t&&(0,r.default)(s.default,{fileList:n})},t}(o.BaseComponent);t.default=u},6813:function(e,t,n){e.exports=function(e,t){n.e(212).then(n.t.bind(null,7639,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6814:function(e,t,n){e.exports=function(e,t){n.e(208).then(n.bind(null,7647)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6815:function(e,t,n){e.exports=function(e,t){n.e(213).then(n.bind(null,8048)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6816:function(e,t,n){},6817:function(e,t,n){},6818:function(e,t,n){e.exports=function(e,t){n.e(188).then(n.bind(null,7653)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6819:function(e,t,n){},6820:function(e,t,n){},6821:function(e,t,n){},6822:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=n(179),a=(0,i.__importDefault)(n(164)),s=(0,i.__importDefault)(n(3858)),r=function(e){function t(t){var n=e.call(this,t)||this;return n.onOpenPanel=function(e){/^.pptx$/i.test(window.fileInfo.ext)?n.setState({visible:!0,id:e?e.id:"",latexStr:e?e.latexStr:"",shape:e&&e.shape}):window.Toast.warn(e?_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.unSupportEditLatex", "仅pptx格式文档可编辑LaTeX公式"):_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.unSupportLatex", "仅pptx格式文档可插入LaTeX公式"))},n.onCancel=function(){n.reset()},n.onCommit=function(e){var t=e.latexStr,i=e.svgData,o=e.width,a=e.height,s=e.positionInfo;window.APP.coreAPI.beginCommand(n);var r=n.presentation.getSlideById2(null==s?void 0:s.category,null,null==s?void 0:s.slideId),l=(null==r?void 0:r.findShapeById(null==s?void 0:s.shapeId))||n.state.shape;if(r){if(((null==r?void 0:r.isMasterSlide)||(null==r?void 0:r.isLayoutSlide))&&!n.isMasterView){var c=n.presentation.getSlideProxy(r);n.dispatchEvent(n.eventTypes.names.ON_CHANGE_MASTER_VIEW,{activeSlideProxy:c})}n.selection.selectSlide(r),l&&n.selection.selectShape(l)}if(l&&l.parent){var u=l&&l.getExtData();u&&u.latexStr===t||(window.APP.coreAPI.setCooperHandler("handlerLatexMath"),n.editor.slide.modifyLatexMath({latexStr:t,svgData:i,img:{width:o,height:a}},l))}else window.APP.coreAPI.setCooperHandler("handlerLatexMath",{insert:!0}),n.editor.slide.insertLatexMath({width:o,height:a,latexStr:t,svgData:i});window.APP.coreAPI.endCommand(),window.collection("newui","value",window.pcTrack.newui.lateX_insert_button),n.reset()},n.reset=function(){n.setState({visible:!1,id:"",latexStr:"",shape:null})},n.getPositionInfo=function(){var e=n.state.shape,t=null==e?void 0:e.getSlide();return{category:null==t?void 0:t.getCategory(),slideId:null==e?void 0:e.getSlideId(),shapeId:null==e?void 0:e.getId()}},n.state={visible:!1,id:"",latexStr:"",shape:null},n}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.on(this.uiEventTypes.pc.OPEN_LATEX_PANEL,this.onOpenPanel)},t.prototype.onUnBindEvent=function(){this.off(this.uiEventTypes.pc.OPEN_LATEX_PANEL,this.onOpenPanel)},t.prototype.render=function(){var e=this.state,t=e.visible,n=e.id,i=e.latexStr,o=this.props,r=o.disabled,l=o.userId,c=o.readOnly,u=o.connected;return(0,a.default)(s.default,{visible:t,id:n,latexStr:i,disabled:r,connected:u,userId:l,readOnly:c,onCancel:this.onCancel,onCommit:this.onCommit,getPositionInfo:this.getPositionInfo})},t}(o.BaseComponent);t.default=r},6823:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=n(142),a=(0,i.__importDefault)(n(237)),s=(0,i.__importDefault)(n(164)),r=(0,i.__importDefault)(n(6824));t.default=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],i=(0,o.useState)(null),l=i[0],c=i[1],u=function(e){var t=null==e?void 0:e.shapeData;if(!t){var i=window.selection.getActiveShapes();t=i&&i[0]}c(t),n(!0)};return(0,o.useEffect)((function(){return a.default.uilDispatcher.on(a.default.eventTypes.pc.OPEN_CHART_EDIT_PANEL,u),function(){a.default.uilDispatcher.off(a.default.eventTypes.pc.OPEN_CHART_EDIT_PANEL,u)}}),[]),(0,o.useEffect)((function(){a.default.uilDispatcher.fire(a.default.eventTypes.pc.CHART_EDIT_VISIBLE_CHANGE,{visible:t}),t||c(null)}),[t]),t&&l?(0,s.default)(r.default,{shapeData:l,onVisibleChange:function(e){n(e)},onError:function(){n(!1)}}):null}},6824:function(e,t,n){e.exports=function(e,t){n.e(184).then(n.t.bind(null,7654,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6825:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(6826);var o=(0,i.__importDefault)(n(142)),a=n(179),s=n(158),r=n(899),l=(0,i.__importDefault)(n(6827)),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isFirstLoading:!0},t.onChangeExplain=function(e){var n=e.explainType,i=e.activeSlideIndex;t.props.setExplainTypeState({explainType:n,activeSlideIndex:i})},t.onDocInitDone=function(){t.initExplain()},t.initExplain=function(){var e=t.props,n=e.explainType,i=e.isCoreDataLoaded,o=e.isAutoPlay;i&&n&&(t.state.isFirstLoading&&t.editor.explain.isExplainEmpty()?(0,r.renderGuide)({onClose:function(){return t.onChangeExplain({explainType:null})}}):(t.doc.setMode(a.ViewModes.PlayView),t.doc.setExplainType(s.ExplainMode.play),t.setState({isFirstLoading:!1}))),i&&o&&(t.doc.setMode(a.ViewModes.PlayView),t.doc.setAutoPlayPlayer("autoplay"))},t.exitExplain=function(){t.setState({isFirstLoading:!0}),t.doc.setExplainType(null),t.doc.setMode(a.ViewModes.EditView)},t.onLoadingClose=function(){t.onChangeExplain({explainType:null})},t}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.initExplain(),this.on(this.uiEventTypes.names.CHANGE_EXPLAIN_TYPE,this.onChangeExplain),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.onDocInitDone)},t.prototype.componentDidUpdate=function(e){!e.isCoreDataLoaded&&this.props.isCoreDataLoaded&&this.initExplain(),e.explainType!==this.props.explainType&&(this.props.explainType?this.initExplain():this.exitExplain())},t.prototype.render=function(){var e=this.props,t=e.explainType,n=e.isCoreDataLoaded,i=this.state.isFirstLoading;return t&&i?o.default.createElement(l.default,{onClose:this.onLoadingClose,isLoading:!n}):null},t}(a.BaseComponent);t.default=c},6826:function(e,t,n){},6827:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),o=(0,i.__importStar)(n(142)),a=(0,i.__importDefault)(n(160)),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onKeyDown=function(e){e.stopPropagation&&e.stopPropagation(),27===e.keyCode&&t.props.onClose()},t.onKeyUp=function(e){e.stopPropagation&&e.stopPropagation()},t.onMaskClick=function(){t.props.onClose()},t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){window.addEventListener("keydown",this.onKeyDown,!0),window.addEventListener("keyup",this.onKeyUp,!0)},t.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.onKeyDown,!0),window.removeEventListener("keyup",this.onKeyUp,!0)},t.prototype.render=function(){var e=this.props.isLoading,t=o.default.createElement("div",{className:"wpp-loading-page-wrap",onClick:this.onMaskClick},e&&o.default.createElement("div",{className:"loading-box"},o.default.createElement("div",{className:"laoding-icon"}),o.default.createElement("div",{className:"tip"},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.playLoading", "正在加载讲解…"))));return a.default.createPortal(t,document.body)},t}(o.PureComponent);t.default=s},8067:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),c=n(42),u=n.n(c),d=n(142),p=n.n(d),h=n(149),f=n(164),m=n(6807),v=n.n(m),g=n(6809),w=n.n(g),y=n(6810),E=n.n(y),_=n(6811),S=n.n(_),C=n(6812),b=n.n(C),T=n(1493),I=n(237),L=n(158),P=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),c=0;c<s;c++)r[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.handleDownloadPicture=function(e){},i.handleDownloadActivePicture=function(e){if(!L.userAgent.isIPad||L.userAgent.isSafari){var t=i.localSelection.getActiveShapes();if(t&&1===t.length){var n=t[0],o=n.getId(),a=n&&n.getShapeType();if(a&&(a===L.ShapeType.Picture||a===L.ShapeType.Processon)){var s=n.getPicture().blip.blipAtom.imageId;window.backendImageManager.fetchImage({imageId:s,origin:!0,requestBolb:!0,download:!0,cb:function(e,t){if(!e&&t){var n=t.type,i=n&&n.split("/")[1],a=i&&i.split("+")[0],s="image"+o+"."+a;Object(T.downloadFile)(t,s),window.collection("picview","click","download")}}})}}}else window.Toast.warn(_i18n("applications.presentation.components.public.Download.limits", "由于浏览器限制，建议使用系统浏览器"))},a=n,l()(i,a)}return u()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(I.default.eventTypes.pc.ON_DOWNLOAD_PICTURE,this.handleDownloadPicture),window.addEventListener(I.default.eventTypes.pc.ON_DOWNLOAD_ACTIVE_PICTURE,this.handleDownloadActivePicture)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(I.default.eventTypes.pc.ON_DOWNLOAD_PICTURE,this.handleDownloadPicture),window.removeEventListener(I.default.eventTypes.pc.ON_DOWNLOAD_ACTIVE_PICTURE,this.handleDownloadActivePicture)}},{key:"downloadFile",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(e&&e.src){if(!t){var i=e.src.match(/image\/(\w*)/),o=i?i[1]:"png";t="image"+n+"."+o}var a=Object(T.convertImageToBlob)(e);Object(T.downloadFile)(a,t),window.collection("picview","click","download")}}},{key:"render",value:function(){return null}},{key:"localSelection",get:function(){return window.APP.workspace.getSelectionsMgr().getLocalSelection()}}]),t}(d.Component),k=n(179),O=n(6814),N=n.n(O),D={default:_i18n("applications.presentation.components.public.GuestLogin.function", "功能"),comment:_i18n("applications.presentation.components.public.GuestLogin.comment", "评论"),mark:_i18n("applications.presentation.components.public.GuestLogin.mark", "画笔")},R=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showLogin:!1,fromType:D.default},n.handleGuestLogin=n.handleGuestLogin.bind(n),n.handleLoginCancel=n.handleLoginCancel.bind(n),n}return u()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(I.default.names.WPP_GUEST_CONFIRM_LOGIN,this.handleGuestLogin)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(I.default.names.WPP_GUEST_CONFIRM_LOGIN,this.handleGuestLogin)}},{key:"handleGuestLogin",value:function(e){window.collection("bootlogin","value","popupshow");var t=e.detail.fromType;this.setState({showLogin:!0,fromType:t})}},{key:"handleLoginCancel",value:function(){this.setState({showLogin:!1})}},{key:"render",value:function(){var e=this.state,t=e.showLogin,n=e.fromType,i=D[n];return t&&Object(f.default)(N.a,{onClose:this.handleLoginCancel,text:_i18n("applications.presentation.components.public.GuestLogin.loginWillOpen", "登录将开启")+"「"+i+"」"})}}]),t}(d.PureComponent),x=n(205),A=n(348),M=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOpen=function(e){var t=(e&&e.detail).address;n.setState({visible:!0,address:t})},n.handleOk=function(){Object(A.copyToClipboard)(n.state.address),window.Toast.success(_i18n("applications.presentation.components.public.Dialog.CopyLink.successTips", "复制链接成功")),n.onClose()},n.onClose=function(){n.setState({visible:!1,address:null})},n.state={visible:!1,address:null},n.handleOk=n.handleOk.bind(n),n}return u()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(I.default.hyperlinkType.OPEN_COPY_LINK_MODAL,this.handleOpen)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(I.default.hyperlinkType.OPEN_COPY_LINK_MODAL,this.handleOpen)}},{key:"render",value:function(){return this.state.visible?p.a.createElement(x.default,{okBtnText:_i18n("applications.presentation.components.public.Dialog.CopyLink.okBtn", "复制链接"),onCancel:this.onClose,onOk:this.handleOk},_i18n("applications.presentation.components.public.Dialog.CopyLink.text", "由于平台限制，请复制链接后使用浏览器打开")):null}}]),t}(d.PureComponent),U=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),s()(t,[{key:"render",value:function(){return p.a.createElement(x.default,{className:"remark-view-unsupport",showFooter:!1,title:_i18n("applications.presentation.components.public.Dialog.RemarkViewUnsupport.tip", "提示"),onCancel:this.props.onClose},_i18n("applications.presentation.components.public.Dialog.RemarkViewUnsupport.wxUnsupport", "微信中不支持多窗口，请在浏览器中打开文档使用备注视图功能。"))}}]),t}(d.PureComponent),B=n(6815),F=n.n(B),V=n(1769),W=(n(6816),n(154)),G=n.n(W),H=(n(6817),n(390)),j=n(155),z=n(6818),Y=n.n(z),K=n(148),q=n(1019),J=j.default.iconTypes.size16,X=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showTimeCountPanel=function(e){n.setState({startHours:e.hours,startMinutes:e.minutes,startSeconds:e.seconds,hours:e.hours,minutes:e.minutes,seconds:e.seconds,chooseBell:e.chooseBell,showPanel:!0},(function(){return n.init()}))},n.init=function(){var e=n.state,t=e.hours,i=e.minutes,o=e.seconds,a=60*parseInt(t)*60+60*parseInt(i)+parseInt(o);n.time_token=0,n._ordertimer=setInterval((function(){return n.leftTimer(a)}),1e3),n.audioMsg=new Audio,n.audioMsg.loop="loop",Y()((function(e){n.audioMsg.src=e.audio}))},n.onClose=function(){clearInterval(n._ordertimer),n.state.chooseBell&&n.audioMsg.pause(),n.setState({showPanel:!1,ringBell:!1}),n.setKeyState(q.a.ON_TIME_COUNTING,!1)},n.handleModeChange=function(){var e=n.doc.getMode();if(e===k.ViewModes.EditView){var t=document.querySelector(".wpp_cmd_bar_container"),i=t&&t.getBoundingClientRect();n.setState({position:{left:250,top:i?i.bottom-1:99}})}e===k.ViewModes.PlayView&&n.setState({position:{left:n.props.isRemarkSpeaker?85:30,top:28}})},n.handleClick=function(){n.state.chooseBell&&n.audioMsg.pause(),n.setState({chooseBell:!n.state.chooseBell})},n.state={hours:"00",minutes:"00",seconds:"00",ringBell:!1,showPanel:!1,position:{left:30,top:28}},n.refModal=p.a.createRef(),n.refHours=p.a.createRef(),n.refMinutes=p.a.createRef(),n.refSeconds=p.a.createRef(),n}return u()(t,e),s()(t,[{key:"componentDidUpdate",value:function(e){G()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),e.isRemarkSpeaker!==this.props.isRemarkSpeaker&&this.handleModeChange()}},{key:"onSafeBindEvent",value:function(){this.handleModeChange(),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.on(this.uiEventTypes.pc.play.CLICK_SHOW_TIME_COUNT,this.showTimeCountPanel)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.MODE_CHANGE,this.handleModeChange)}},{key:"leftTimer",value:function(e){var t=this;this.time_token++;var n=e-this.time_token,i=parseInt(n/60/60,10),o=parseInt(n/60%60,10),a=parseInt(n%60,10);(i=this.checkTime(i),o=this.checkTime(o),a=this.checkTime(a),(parseInt(i)>=0||parseInt(o)>=0||parseInt(a)>=0)&&this.setState({hours:i,minutes:o,seconds:a}),parseInt(i)<=0&&parseInt(o)<=0&&parseInt(a)<=0)&&(clearInterval(this._ordertimer),this._ordertimer=null,this.state.chooseBell&&(this.audioMsg.play(),setTimeout((function(){t.audioMsg.pause()}),6e4)),this.setState({ringBell:!0}))}},{key:"checkTime",value:function(e){return e<10&&(e="0"+e),e}},{key:"render",value:function(){var e=this.state,t=e.hours,n=e.minutes,i=e.seconds,o=e.position,a=e.ringBell,s=e.chooseBell,r=e.showPanel,l=e.startHours,c=e.startMinutes,u=e.startSeconds;if(!r)return null;var d=_i18n("applications.presentation.components.CountDown.title", "倒计时")+": "+(parseInt(l)?l+_i18n("applications.presentation.components.CountDown.hours", "小时"):"")+(parseInt(c)?c+_i18n("applications.presentation.components.CountDown.minutes", "分钟"):"")+(parseInt(u)?u+_i18n("applications.presentation.components.CountDown.seconds", "秒"):""),h=p.a.createElement(j.default,{className:"bell-img",iconType:s?J.bell:J.bell_ban,onClick:this.handleClick,title:_i18n("applications.presentation.components.CountDown.bell", "响铃")});return p.a.createElement(H.a,{ref:this.refModal,onClose:this.onClose,title:d,position:o,visible:!0,options:h,className:"time_count_panel"},!a&&p.a.createElement("div",{className:"time_count_num"},p.a.createElement("div",{className:"time",ref:this.refHours},t),p.a.createElement("div",{className:"colon"},":"),p.a.createElement("div",{className:"time",ref:this.refMinutes},n),p.a.createElement("div",{className:"colon"},":"),p.a.createElement("div",{className:"time",ref:this.refSeconds},i)),a&&p.a.createElement("div",{className:"time_out_container"},p.a.createElement(K.default,{type:"other time_out",className:"ring-bell"}),p.a.createElement("div",{className:"time_out_tips"},_i18n("applications.presentation.components.CountDown.timeOut", "时间到~"))))}}]),t}(k.BaseComponent),Q=n(160),Z=n.n(Q),$=n(43),ee=n.n($),te=n(26),ne=n.n(te),ie=(n(6819),n(168)),oe=n.n(ie),ae=(n(6820),n(6821),n(151)),se=n.n(ae),re=n(156),le=n(144),ce=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),c=0;c<s;c++)r[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.state={isIpadClick:!1},i.handleWindowMouseDown=function(e){if(le.isPad){var t=i.layoutRef.current.contains(e.target)||i.btnWrapRef.current.contains(e.target)||i.layoutRef.current===e.target;i.setState({isIpadClick:t})}},i.onApplyClick=Object(re.debounce)((function(){var e=i.props,t=e.id,n=e.name,o=e.onItemClick;i.selection.modifyLocalLayout(t,{name:n}),window.Toast.success(_i18n("applications.presentation.components.SlideTaskBar.Slide.SlideLayout.changeLayoutSuccess", "已应用给当前幻灯片")),o&&o("apply")}),50),i.onNewClick=function(){var e=i.props,t=e.id,n=e.onItemClick;i.eventTypes.dispatchEvent(i.uiEventTypes.pc.ON_INSERT_SLIDE,{layoutType:t}),n&&n("new")},i.getLayoutDiv=function(){return i.slideRef.current},i.slideRef=p.a.createRef(),i.layoutRef=p.a.createRef(),i.btnWrapRef=p.a.createRef(),a=n,l()(i,a)}return u()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){window.domTools.addEventListener(document,"mousedown",this.handleWindowMouseDown)}},{key:"onUnBindEvent",value:function(){window.domTools.removeEventListener(document,"mousedown",this.handleWindowMouseDown)}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.name,i=e.disabled,o=e.curLayoutId,a=e.slideStyle;n=n||"";var s=p.a.classNames({layout_wrapper:1,"ipad-show":this.state.isIpadClick}),r=p.a.classNames({btn:1,disabled:i}),l=p.a.classNames({img_wrapper:1,ipad_img_wrapper:le.isPad});return p.a.createElement(se.a,{middleShow:!0,title:n},p.a.createElement("div",{className:s},p.a.createElement("div",{className:"layout",ref:this.layoutRef},p.a.createElement("div",{className:l,ref:this.slideRef,style:a}),o===t&&p.a.createElement(K.default,{className:"match_icon",type:K.default.types.size16.layout_active})),p.a.createElement("p",{className:"layout_name"},n),p.a.createElement("div",{className:"btn_wrap",ref:this.btnWrapRef},p.a.createElement("span",{className:r,onClick:this.onApplyClick},_i18n("applications.presentation.components.SlideTaskBar.Slide.SlideLayout.apply", "应用")),p.a.createElement("span",{className:"btn",onClick:this.onNewClick},_i18n("applications.presentation.components.SlideTaskBar.Slide.SlideLayout.new", "新建")))))}}]),t}(k.BaseComponent);ce.propTypes={id:oe.a.number.isRequired,name:oe.a.string,disabled:oe.a.bool,curLayoutId:oe.a.number,onItemClick:oe.a.func};var ue=ce,de=n(2267),pe=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));he.call(n);var i=n.props.getCurLayoutId(),a=-1===i?0===e.index:n.isActiveGroup(i);return n.state={curLayoutId:i,isFolded:!a},n._refMap={},n}return u()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){this.setGroupHeight(),this.state.isFolded||this.scrollIntoView()}},{key:"componentDidUpdate",value:function(e,n){G()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this);var i=this.state.isFolded;i&&n.isFolded!==i&&this.prevTask&&this.prevTask.stop()}},{key:"getSlideStyle",value:function(){if(!this.svgSize){var e=this.props.svgWidth,t=this.doc.getThumbnailSize(),n=t.width,i=t.height;this.svgSize={width:e,height:e*i/n}}return this.svgSize}},{key:"render",value:function(){var e=this.props.title,t=this.state,n=t.isFolded,i=t.noAnime,o=p.a.classNames({"layout-group-container":1,folded:n});return p.a.createElement("div",{className:o,ref:this.groupRef},p.a.createElement("div",{className:"group-title dropdown",onClick:this.onClickTitle},e),p.a.createElement("div",{className:"layout-group-wrap "+(i?"no-anime":""),ref:this.wrapRef},!n&&this.renderItems()))}}]),t}(k.BaseComponent);pe.propTypes={title:oe.a.string.isRequired,index:oe.a.number.isRequired,layoutGroup:oe.a.array.isRequired,setCtnScroll:oe.a.func.isRequired,getCurLayoutId:oe.a.func.isRequired,cloneSvg:oe.a.bool,svgWidth:oe.a.number,baseHeight:oe.a.number,itemBaseHeight:oe.a.number,renderItem:oe.a.func,onItemClick:oe.a.func},pe.defaultProps={itemBaseHeight:0,baseHeight:0,svgWidth:90};var he=function(){var e=this;this.foldByChange=function(t){return new Promise((function(n){var i=e.isActiveGroup(t);e.setState({curLayoutId:t,noAnime:!0,isFolded:-1===t?e.state.isFolded:!i},(function(){n()}))}))},this.onFoldByChange=function(){e.state.isFolded||e.scrollIntoView(),e.changeSlideVisible(),e.setState({noAnime:!1})},this.isActiveGroup=function(t){var n=e.props.layoutGroup;return n&&n.some((function(e){return e.id===t}))},this.renderItems=function(){var t=e.props,n=t.layoutGroup,i=t.renderItem,o=t.onItemClick,a=e.state.curLayoutId,s=e.getSlideStyle();return n&&n.every((function(e){return e.id}))?n.map((function(t){var n=ne()({},t,{curLayoutId:a,slideStyle:s,onItemClick:o,ref:function(n){return e._refMap[t.id]=n}});return i?i(n,t.id):p.a.createElement(ue,ne()({key:t.id},n))})):null},this.onClickTitle=function(){e.setState((function(e){return{isFolded:!e.isFolded}}),(function(){e.changeSlideVisible()}))},this.changeSlideVisible=function(){var t=e.props.layoutGroup;e.prevTask=new de.a(t,(function(t){e._changeLayoutVisible(t.id)}))},this.setGroupHeight=function(){if(e.wrapRef.current){var t=e.props,n=t.layoutGroup,i=t.itemBaseHeight,o=0;if(n&&n.length>0)o=(i+e.getSlideStyle().height)*Math.ceil(n.length/2);e.wrapRef.current.style.height=o+"px"}},this.scrollIntoView=function(){var t=e.props;(0,t.setCtnScroll)((t.index-1)*t.baseHeight)},this._changeLayoutVisible=function(t){var n=e._refMap[t],i=n&&n.getLayoutDiv();if(i)if(e.state.isFolded)i.show=!1;else if(i.show=!0,!i.querySelector("svg")){var o=e.props.svgWidth;e.presentation.getLayouts().isAllLoaded()&&e.doc.renderSlideLayout(t,{width:o}).then((function(t){if(i.show&&(!i.querySelector("svg")&&t)){var n=t.slideView,a=e.props.cloneSvg?n.cloneSvg(o):n.ctx.getSvg();i.appendChild(a)}}))}},this.groupRef=p.a.createRef(),this.wrapRef=p.a.createRef()},fe=pe,me=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),c=0;c<s;c++)r[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.state={slideLayoutList:[]},i._refMap={},i.docInit=function(){i.setState({slideLayoutList:[]},(function(){i.initLayoutList()}))},i.handlePageSetUp=Object(re.debounce)((function(){i.docInit()}),100),i.handleChange=Object(re.debounce)((function(){var e=i.getCurLayoutId();if(i.curSlideIndex!==i.doc.getActiveSlideIdx()||i.preLayoutId!==e){var t=i.state.slideLayoutList;i.prevTask&&i.prevTask.stop(),i.prevTask=new de.a(t,(function(t){var n=i._refMap[t.id];n&&n.foldByChange(e)})).then((function(){t&&t.forEach((function(e){var t=i._refMap[e.id];t&&t.onFoldByChange()}))})),i.curSlideIndex=i.doc.getActiveSlideIdx()}i.preLayoutId=e}),100),i.onMasterSlideChange=Object(re.debounce)((function(){i.docInit()}),100),i.getCurLayoutId=function(){var e=i.slideMarker&&i.slideMarker.fetch(),t=void 0;if(e&&e.length>0)for(var n=0;n<e.length;n++){var o=e[n],a=o&&o.bLoaded&&i.presentation.getSlideById2(o.category,null,o.slideId),s=a&&a.getFollowing(),r=s&&s.getId();if(0!==n){if(t!==r){t=-1;break}}else t=r}return t},i.renderLayoutGroup=function(){var e=i.state.slideLayoutList;return e&&e.map((function(e,t){var n=_i18n("applications.presentation.components.public.Layout.masterLayout", "来自母版{0}").replace("{0}",t+1);return p.a.createElement(fe,ne()({key:e.id,ref:function(t){return i._refMap[e.id]=t},title:n,index:t,layoutGroup:e.layouts,setCtnScroll:i.setCtnScroll,getCurLayoutId:i.getCurLayoutId},i.props))}))},i.setCtnScroll=function(e){i.ctnRef.current&&(i.ctnRef.current.scrollTop=e)},i.ctnRef=p.a.createRef(),a=n,l()(i,a)}return u()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){this.initLayoutList(),this.doc.on(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),this.doc.on(this.viewEventTypes.MASTER_SLIDE_CHANGE,this.onMasterSlideChange),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.docInit),this.doc.on(this.viewEventTypes.MULTI_SLIDE,this.handleChange),this.doc.on(this.viewEventTypes.MODIFY_PAGE_SETUP,this.handlePageSetUp),this.curSlideIndex=this.doc.getActiveSlideIdx()}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),this.doc.off(this.viewEventTypes.MASTER_SLIDE_CHANGE,this.onMasterSlideChange),this.doc.off(this.viewEventTypes.MULTI_SLIDE,this.handleChange),this.doc.off(this.viewEventTypes.MODIFY_PAGE_SETUP,this.handlePageSetUp)}},{key:"initLayoutList",value:function(){var e=this,t=function(t){t&&0!==t.length&&e.setState({slideLayoutList:[].concat(ee()(t))},(function(){e.displayViewContent()}))};this.doc.getSlideLayoutsTypeLoader().progress(t).then(t).start()}},{key:"displayViewContent",value:function(){var e=this,t=this.state.slideLayoutList;t&&t.forEach((function(t){var n=e._refMap[t.id];n&&n.changeSlideVisible()}))}},{key:"render",value:function(){var e=this.props.className,t=this.renderLayoutGroup(),n=p.a.classNames({"layout-container":1},e);return p.a.createElement("div",{className:n,ref:this.ctnRef},p.a.createElement("div",{className:"layout-wrapper"},t))}}]),t}(k.BaseComponent);me.propTypes={className:oe.a.string,cloneSvg:oe.a.bool,svgWidth:oe.a.number,renderItem:oe.a.func,onItemClick:oe.a.func};var ve=me,ge=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),c=0;c<s;c++)r[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.onRenderLayout=function(e){var t=e.container,n=e.props;t&&Z.a.render(p.a.createElement(ve,n),t)},i.onUnRenderLayout=function(e){var t=e.container;t&&Z.a.unmountComponentAtNode(t)},a=n,l()(i,a)}return u()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.RENDER_LAYOUT,this.onRenderLayout),this.on(this.uiEventTypes.pc.UN_RENDER_LAYOUT,this.onUnRenderLayout)}},{key:"onUnBindEvent",value:function(){this.off(this.uiEventTypes.pc.RENDER_LAYOUT,this.onRenderLayout),this.off(this.uiEventTypes.pc.UN_RENDER_LAYOUT,this.onUnRenderLayout)}},{key:"render",value:function(){return null}}]),t}(k.BaseComponent),we=n(6822),ye=n.n(we),Ee=n(6823),_e=n.n(Ee),Se=n(6825),Ce=n.n(Se),be=n(899),Te=n(45),Ie=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleMaterialVisible=function(){n.setState({materialPanelVisible:!0}),window.collection("newui","value",window.pcTrack.newui.docer_panel_show)},n.handleCloseMaterialPanel=function(){n.setState({materialPanelVisible:!1}),n.fire(n.uiEventTypes.pc.ON_CLOSE_MATERIAPANEL)},n.onRemarkViewUnsupportOpen=function(){n.setState({remarkViewUnsupport:!0})},n.onRemarkViewUnsupportClose=function(){n.setState({remarkViewUnsupport:!1})},n.handleOnline=function(){n.setState({isOnline:!0})},n.handleOffline=function(){n.setState({isOnline:!1})},n.state={remarkViewUnsupport:!1,materialPanelVisible:!1,isOnline:window.navigator.onLine},n}return u()(t,e),s()(t,[{key:"onSafeBindEvent",value:function(){window.addEventListener(this.eventTypes.eventTypes.pc.ON_MATERIAL_VISIBLE,this.handleMaterialVisible),this.on(this.uiEventTypes.pc.ON_REMARK_VIEW_UNSUPPORT,this.onRemarkViewUnsupportOpen)}},{key:"onUnBindEvent",value:function(){window.removeEventListener(this.eventTypes.eventTypes.pc.ON_MATERIAL_VISIBLE,this.handleMaterialVisible),this.off(this.uiEventTypes.pc.ON_REMARK_VIEW_UNSUPPORT,this.onRemarkViewUnsupportOpen)}},{key:"render",value:function(){var e=this.state,t=e.remarkViewUnsupport,n=e.materialPanelVisible,i=e.isOnline,o=this.props,a=o.readOnly,s=o.app,r=o.public,l=r.network,c=r.user,u=o.hasPassword,d=o.isEditMode,h=o.handleToggleTaskPane,m=o.dispatch,g=o.needLocateComment,y=o.isRemarkSpeaker,_=o.explainType,C=o.isCoreDataLoaded,T=o.ShapeType,I=o.setExplainTypeState,L=o.isAutoPlay,k=l.connected;return p.a.createElement(p.a.Fragment,null,p.a.createElement(v.a,{ShapeType:T,connected:k&&i,readOnly:a,isRemarkSpeaker:y,isRemarksWin:this.isRemarksWin}),!Object(Te.hasQuery)("simple")&&!this.isRemarksWin&&Object(f.default)(w.a,{readOnly:a,app:s,hasPassword:u,handleToggleTaskPane:h,needLocateComment:g}),d&&Object(f.default)(E.a,{connected:k,readOnly:a}),d&&p.a.createElement(P,null),d&&Object(f.default)(S.a,{connected:k}),p.a.createElement(R,null),p.a.createElement(M,null),t&&p.a.createElement(U,{onClose:this.onRemarkViewUnsupportClose}),n&&d&&Object(f.default)(F.a,{onClose:this.handleCloseMaterialPanel,user:c,dispatch:m}),p.a.createElement(V.a,{connected:k}),p.a.createElement(X,{isRemarkSpeaker:y}),be.isSupportExplain&&p.a.createElement(Ce.a,{isCoreDataLoaded:C,explainType:_,setExplainTypeState:I,isAutoPlay:L}),p.a.createElement(ge,null),window.__CONFIG__.enableLaTeX&&p.a.createElement(ye.a,{disabled:a||!k||!i,connected:k&&i,readOnly:a,userId:c.id}),window.__CONFIG__.wpp.enableChartDataEdit&&p.a.createElement(_e.a,null),d&&window.__CONFIG__.wpp.enableImportSlide&&k&&i&&p.a.createElement(b.a,null))}}]),t}(k.BaseComponent);t.default=Object(h.connect)((function(e){return e}))(Ie)}}]);