(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{1034:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),l=n.n(o),s=n(25),r=n.n(s),c=n(42),d=n.n(c),p=(n(1035),n(142)),u=n.n(p),m=n(155),f=n(183),h=n(962),_=m.default.iconTypes.size16,w=[],b=function(e){function t(e){a()(this,t);var n=r()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){h.d()},n.refBtn=u.a.createRef(),n.state={isFull:!1,visible:h.a()},n}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.state.visible&&(window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.public.components.commandbars.FullScreenBtn.full", "全屏显示"),icon:_.full_screen2}),0===w.length&&h.b((function(e){w.forEach((function(t){return t.setState({isFull:e})})),window.collection2("full_screen_"+!e)})),w.push(this))}},{key:"componentWillUnmount",value:function(){var e=this;0===(w=w.filter((function(t){return t!==e}))).length&&h.c()}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.isFull;if(!t)return!1;var i=this.props.showText,a=n?_i18n("applications.public.components.commandbars.FullScreenBtn.exits", "退出全屏"):_i18n("applications.public.components.commandbars.FullScreenBtn.full", "全屏显示");if(i){var o=n?_.exit_full_screen2:_.full_screen2;return u.a.createElement(f.default,{ref:this.refBtn,iconType:o,onClick:this.handleClick},a)}var l=n?_.exit_full_screen:_.full_screen;return u.a.createElement(m.default,{ref:this.refBtn,className:"component-full-screen",title:a,iconType:l,onClick:this.handleClick})}}]),t}(p.PureComponent);t.a=b},1035:function(e,t,n){},7615:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(183)),l=(0,i.__importDefault)(n(237)),s=o.default.iconTypes.size16,r=window.pcTrack,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){window.collection("newui","value",r.newui.play_now_toolbar),l.default.dispatchEvent(l.default.eventTypes.pc.ON_START_PLAY,{type:"active"}),window.collectionOnce()},t.activePlayBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords()},t.prototype.initSearchKeywords=function(){var e=[{el:this.activePlayBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_active", "从当前播放"),icon:s.play_from_active}];window.__WPSENV__.commandbars.push(e)},t.prototype.render=function(){return a.default.createElement("div",{className:"inline-middle"},a.default.createElement(o.default,{ref:this.activePlayBtn,iconType:s.play_from_active,onClick:this.onClick},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_active", "从当前播放")))},t}(a.PureComponent);t.default=c},7616:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(183)),l=(0,i.__importDefault)(n(237)),s=o.default.iconTypes.size16,r=window.pcTrack,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){window.collection("newui","value",r.newui.play_replay_toolbar),l.default.dispatchEvent(l.default.eventTypes.pc.ON_START_PLAY,{type:"start"}),window.collectionOnce()},t.startPlayBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords()},t.prototype.initSearchKeywords=function(){var e=[{el:this.startPlayBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_start", "从头播放"),icon:s.play_from_start}];window.__WPSENV__.commandbars.push(e)},t.prototype.render=function(){return a.default.createElement("div",{className:"inline-middle"},a.default.createElement(o.default,{ref:this.startPlayBtn,iconType:s.play_from_start,onClick:this.onClick},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_start", "从头播放")))},t}(a.PureComponent);t.default=c},7617:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=n(179),l=(0,i.__importDefault)(n(183)),s=n(899),r=n(158),c=l.default.iconTypes.size16,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){if(window.collection("newui","value",window.pcTrack.newui.play_speech_toolbar),0!==t.doc.getSlideCount()){var e={explainType:r.ExplainMode.play};t.isMasterView&&(e.activeSlideIndex=0),t.fire(t.uiEventTypes.names.CHANGE_EXPLAIN_TYPE,e)}else window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.emptySlide", "此演示文稿中没有幻灯片"))},t.playExplainBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords()},t.prototype.initSearchKeywords=function(){if(s.isSupportExplain){var e=[{el:this.playExplainBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.play_explain", "讲解播放"),icon:c.play_explain}];window.__WPSENV__.commandbars.push(e)}},t.prototype.render=function(){if(!s.isSupportExplain)return null;var e=this.props.connected;return a.default.createElement("div",{className:"inline-middle"},a.default.createElement(l.default,{ref:this.playExplainBtn,iconType:c.play_explain,onClick:this.onClick,disabled:!e},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.play_explain", "讲解播放")))},t}(o.BaseComponent);t.default=d},7618:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=(0,i.__importDefault)(n(183)),l=(0,i.__importDefault)(n(7619)),s=(0,i.__importDefault)(n(237)),r=n(179),c=(0,i.__importDefault)(n(164)),d=n(208),p=o.default.iconTypes.size16,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={panelVisible:!1,isFormExplain:!1,isFromPlay:!1},t.handlePlay=function(e){var n=e.detail,i=n.type,a=n.isFormExplain,o=n.isFromPlay;"auto"===i&&t.setState({panelVisible:!0,isFormExplain:a,isFromPlay:o})},t.startAutoPlay=function(){(clearTimeout(t.timeout),t.doc.getMode()!==d.ViewModes.PlayView)?t.timeout=setTimeout((function(){t.doc.setMode(d.ViewModes.PlayView),t.startAutoPlay()}),10):t.doc.getAutoplayPlayer()?s.default.dispatchEvent(s.default.eventTypes.pc.START_PLAY,{isOk:!0}):(t.doc.setAutoPlayPlayer("autoplay"),t.fire(t.uiEventTypes.pc.play.CLICK_AUTO_PLAY_MODE,{isFromStart:!1}))},t.onClick=function(){t.setState({panelVisible:!0}),window.collection("newui","value",window.pcTrack.newui.tabbar_playtab_autoplay)},t.handleClose=function(){t.setState({panelVisible:!1,isFromPlay:!1,isFormExplain:!1})},t.autoPlayBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.initSearchKeywords(),window.addEventListener(s.default.eventTypes.pc.ON_START_PLAY,this.handlePlay),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_START_AUTO_PLAY,this.startAutoPlay)},t.prototype.onUnBindEvent=function(){window.removeEventListener(s.default.eventTypes.pc.ON_START_PLAY,this.handlePlay),this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_START_AUTO_PLAY,this.startAutoPlay)},t.prototype.initSearchKeywords=function(){var e=[{el:this.autoPlayBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.auto_play", "自动播放"),icon:p.auto_play}];window.__WPSENV__.commandbars.push(e)},t.prototype.render=function(){var e=this.state,t=e.panelVisible,n=e.isFormExplain,i=e.isFromPlay,s=this.props.connected;return a.default.createElement("div",{className:"inline-middle"},a.default.createElement(o.default,{ref:this.autoPlayBtn,iconType:p.auto_play,onClick:this.onClick,disabled:!s},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.PlayExplain.auto_play", "自动播放")),t&&(0,c.default)(l.default,{panelVisible:t,isFormExplain:n,isFromPlay:i,onClose:this.handleClose}))},t}(r.BaseComponent);t.default=u},7619:function(e,t,n){e.exports=function(e,t){n.e(185).then(n.t.bind(null,7976,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},7620:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(183)),l=o.default.iconTypes.size16,s=window.pcTrack,r=window.__WPSPLUGIN__.helper,c=window.WppCommandBarComponentFragment,d=c.cmbIds.wpp,p=r.has(r.types.Meeting),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){window.collection("newui","value",s.newui.meeting_toolbar),r.exec(r.types.Meeting)},t.startMeetingBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords()},t.prototype.initSearchKeywords=function(){if(p){var e=[{el:this.startMeetingBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_meeting", "远程会议"),icon:l.play_from_meeting}];window.__WPSENV__.commandbars.push(e)}},t.prototype.render=function(){if(!p)return null;var e=this.props,t=e.user,n=e.connected,i=t.isLogin;return a.default.createElement("div",{className:"inline-middle"},a.default.createElement(c,{cmbId:d.MeetingEnter},a.default.createElement(o.default,{ref:this.startMeetingBtn,iconType:l.play_from_meeting,className:"meeting-btn icon-btn",title:_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_meetings", "远程会议：多人同步观看文档，手机电脑语音讨论。"),onClick:this.onClick,disabled:!n||!i},_i18n("applications.presentation.components.CommandBars.RbTab.PlayTab.Play.play_from_meeting", "远程会议"))))},t}(a.PureComponent);t.default=u},7621:function(e,t,n){},7622:function(e,t,n){e.exports=n.p+"images/masterTooltip.865859c7.svg"},7623:function(e,t,n){},7624:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=n(179),l=(0,i.__importDefault)(n(203)),s=(0,i.__importDefault)(n(166)),r=(0,i.__importDefault)(n(183)),c=n(156),d=r.default.iconTypes.size16,p={width:19200,height:10800,scale:"16: 9"},u={width:14400,height:10800,scale:"4: 3"},m={width:10800,height:19200,scale:"9: 16"},f=0,h=1,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={panelVisible:!1},t.refBtn=a.default.createRef(),t.initSearchKeywords=function(){window.__WPSENV__.commandbars.push({icon:d.wpp_slide_size,text:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.title", "幻灯片比例"),el:t.refBtn,items:[{text:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize16_9", "宽屏 16 : 9")},{text:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize4_3", "标准 4 : 3")},{text:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize9_16", "竖屏 9 : 16")}]})},t.handlePageSetUp=(0,c.debounce)((function(e){e.param&&e.param.finish&&t.coreView.resetZoom()}),100),t.onSize4_3=function(){var e=u,n=e.width,i=e.height,a=e.scale;t.onModifiSize(n,i,a)},t.onSize16_9=function(){var e=p,n=e.width,i=e.height,a=e.scale;t.onModifiSize(n,i,a)},t.onSize9_16=function(){var e=m,n=e.width,i=e.height,a=e.scale;t.onModifiSize(n,i,a)},t.handleVisibleChange=function(e){t.setState({panelVisible:e})},t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords(),this.doc.on(this.viewEventTypes.MODIFY_PAGE_SETUP,this.handlePageSetUp)},t.prototype.componentWillUnmount=function(){this.doc.off(this.viewEventTypes.MODIFY_PAGE_SETUP,this.handlePageSetUp)},t.prototype.onModifiSize=function(e,t,n){this.setState({panelVisible:!1});var i=this.presentation.getSlideSize().width>e?f:h,a=this.selection.transaction;a.beginBatchCommand(),a.setCooperHandler("pageSetUp"),a.setUserData("slideSize",n);var o=this.getPageSetupModifier();o.modify("slideWidth",e),o.modify("slideHeight",t),o.modify("scaleMode",i),window.selection.modifyPresentationProps(o),a.endBatchCommand(),window.collection("newui","value","set_view_".concat(n))},t.prototype.getPageSetupModifier=function(){return this.createModifierByName("PageSetup",{})},t.prototype.createModifierByName=function(e,t){return window.APP.utils.createModifier(e,t)},t.prototype.getSelectedItem=function(){var e=this.presentation.getSlideSize(),t=e.width,n=e.height;return t===p.width&&n===p.height?0:t===u.width&&n===u.height?1:t===m.width&&n===m.height?2:-1},t.prototype.renderItem=function(){var e=this.getSelectedItem();return a.default.createElement(l.default,{className:"wpp-dropdown-submenu"},a.default.createElement(l.default.Item,{onClick:this.onSize16_9,selected:0===e},a.default.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize16_9", "宽屏 16 : 9"))),a.default.createElement(l.default.Item,{onClick:this.onSize4_3,selected:1===e},a.default.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize4_3", "标准 4 : 3"))),a.default.createElement(l.default.Item,{onClick:this.onSize9_16,selected:2===e},a.default.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.slideSize9_16", "竖屏 9 : 16"))))},t.prototype.render=function(){var e=this.state.panelVisible,t=this.props.disabled,n=this.renderItem();return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"inline-middle"},a.default.createElement(s.default,{panel:n,visible:e,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:t},a.default.createElement(r.default,{disabled:t,selected:e,isDropdown:!0,ref:this.refBtn,title:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.title", "幻灯片比例"),iconType:d.wpp_slide_size},_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.SlideSize.title", "幻灯片比例")))))},t}(o.BaseComponent);t.default=_},7625:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=n(179),l=(0,i.__importDefault)(n(183)),s=(0,i.__importDefault)(n(237)),r=l.default.iconTypes.size16,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.fire(s.default.eventTypes.pc.OPEN_PPT_FILE_SELECTOR),window.collection("newui","value",window.pcTrack.newui.slide_import_toolbar)},t.refBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.importSlide", "导入幻灯片"),icon:r.wpp_import_slide})},t.prototype.render=function(){var e=this.props.disabled;return a.default.createElement(l.default,{ref:this.refBtn,disabled:e,iconType:r.wpp_import_slide,onClick:this.handleClick},_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.importSlide", "导入幻灯片"))},t}(o.BaseComponent);t.default=c},8062:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n.n(i),o=n(0),l=n.n(o),s=n(3),r=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),m=n(142),f=n.n(m),h=n(168),_=n.n(h),w=n(516),b=n(2673),y=n(7615),v=n.n(y),T=n(7616),E=n.n(T),C=n(7617),S=n.n(C),g=n(7618),P=n.n(g),k=n(7620),B=n.n(k),R=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dropDownMenu:"",isEditMode:!1,connected:n.props.connected,hasSlide:!0},n}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.visible,i=e.connected,a=e.user,o=e.isOnline;return f.a.createElement(w.a,{ref:this.wrapRef,tabKey:t,visible:n},f.a.createElement(v.a,null),f.a.createElement(E.a,null),f.a.createElement(S.a,{connected:i&&o}),f.a.createElement(P.a,{connected:i&&o}),f.a.createElement(B.a,{user:a,connected:i&&o}))}}]),t}(b.a);R.propTypes={tabKey:_.a.string.isRequired};var O=R,M=n(183),x=n(237),N=M.default.iconTypes.size16,F=window.CommandBarComponent,V=F.cmbIds.wpp,I=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,V.Comment));return n.handleCommentShow=n.handleCommentShow.bind(n),n.initSearchKeywords=n.initSearchKeywords.bind(n),n.commentBtn=f.a.createRef(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords()}},{key:"componentWillUnmount",value:function(){}},{key:"initSearchKeywords",value:function(){var e=[{el:this.commentBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.Comment.comment", "评论"),icon:N.insert_comment}];window.__WPSENV__.commandbars.push(e)}},{key:"handleCommentShow",value:function(){if(!this.props.disabled){var e=window.selection.getSlideMarker();e&&e.clear(),x.default.dispatchEvent(x.default.comment.ON_COMMENT_SHOW)}}},{key:"render",value:function(){var e=this.props.disabled;return f.a.createElement("div",{className:"inline-middle"},f.a.createElement(M.default,{ref:this.commentBtn,iconType:N.insert_comment,onClick:this.handleCommentShow,disabled:e},_i18n("applications.presentation.components.CommandBars.RbTab.ReviewTab.Comment.comment", "评论")))}}]),t}(F),A=n(155),D=n(179),z=n(166),K=n(203),L=n(148),W=(n(7621),M.default.iconTypes.size16),j=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addMark=function(){n.props.disabled||(n.handleVisibleChange(!1),n.fire(n.eventTypes.names.REQ_OPEN_INK_EDITOR,{open:!0}))},n.toggleInkVisible=function(){n.handleVisibleChange(!1),n.fire(x.default.names.ON_TOGGLE_INK_VISIBLE)},n.handleVisibleChange=function(e){n.setState({panelVisible:e})},n.state={panelVisible:!1},n.initSearchKeywords=n.initSearchKeywords.bind(n),n.refBtn=f.a.createRef(),n}return u()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.initSearchKeywords()}},{key:"onUnBindEvent",value:function(){}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.mark", "画笔"),icon:W.mark,items:[{icon:W.add_mark,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.addMark", "打开画笔")},{icon:W.show_mark,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.showMark", "显示墨迹")}]})}},{key:"renderPanel",value:function(){return f.a.createElement(K.default,{className:"wpp-dropdown-submenu"},f.a.createElement(K.default.Item,{onClick:this.addMark},f.a.createElement(L.default,{ref:this.refBtn,type:W.add_mark}),f.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.addMark", "打开画笔"))),f.a.createElement(K.default.Item,{onClick:this.toggleInkVisible,className:"item_show_mark "+(this.inkVisible?"active":"")},f.a.createElement(L.default,{ref:this.refBtn,type:W.show_mark}),f.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.showMark", "显示墨迹"))))}},{key:"render",value:function(){var e=this.state.panelVisible,t=this.props,n=t.showText,i=t.disabled,a=this.renderPanel();return f.a.createElement("div",{className:"inline-middle"},f.a.createElement(z.default,{panel:a,visible:e,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:i},n?f.a.createElement(M.default,{disabled:i,selected:e,isDropdown:!0,ref:this.refBtn,iconType:W.mark},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.mark", "画笔")):f.a.createElement(A.default,{disabled:i,selected:e,isDropdown:!0,ref:this.refBtn,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Mark.mark", "画笔"),iconType:W.mark})))}},{key:"inkVisible",get:function(){var e=this.selection.getActiveSlide();return!(e&&e.isHideAllInk)}}]),t}(D.BaseComponent),U=n(208),G=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dropDownMenu:"",isEditMode:!1,connected:n.props.connected,hasSlide:!0},n}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.visible,i=e.readOnly,a=e.connected,o=e.isOnline,l=this.state.hasSlide,s=!a||!o,r=this.doc.getMode()===U.ViewModes.MasterView;return f.a.createElement(w.a,{ref:this.wrapRef,tabKey:t,visible:n},window.__CONFIG__.wpp.isShowComment&&f.a.createElement("div",null,f.a.createElement(I,{connected:a,readOnly:i,disabled:s||!l||r})),f.a.createElement("div",null,f.a.createElement(j,{connected:a,showText:!0,disabled:s||!l||r})))}}]),t}(b.a);G.propTypes={tabKey:_.a.string.isRequired};var H=G,q=n(7622),Y=n.n(q),X=(n(7623),function(e){function t(){return l()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.imgSrc,n=e.title,i=e.subTitle;return f.a.createElement("div",{className:"rich-text-tooltip"},f.a.createElement("div",{className:"rich-text-title"},n),!!i&&f.a.createElement("div",{className:"rich-text-sub-title"},i),f.a.createElement("img",{src:t}))}}]),t}(m.PureComponent)),Q=n(355),J=M.default.iconTypes.size16,Z=window.makeCommandBarComponent(D.BaseComponent),$=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Z.cmbIds.wpp.ViewTabTemplate));return n.handleModeChange=function(){var e=n.shell.doc.getMode();n.setState({selected:e===U.ViewModes.MasterView})},n.handleMasterViewClick=function(){n.dispatchEvent(n.eventTypes.names.ON_CHANGE_MASTER_VIEW)},n.renderTooltip=function(){var e=_i18n("applications.presentation.components.CommandBars.RbTab.ViewTab.templateTitle", "在母版中设置属性、插入内容"),t=_i18n("applications.presentation.components.CommandBars.RbTab.ViewTab.templateSubTitle", "会应用给所有使用了该母版的幻灯片");return f.a.createElement(X,{imgSrc:Y.a,title:e,subTitle:t})},n.state={selected:n.isMasterView},n.initSearchKeywords=n.initSearchKeywords.bind(n),n.refBtn=f.a.createRef(),n.isMasterView&&n.dispatchEvent(x.default.pubNames.SWITCH_COMMANDBAR_TAB,{tabKey:Q.wpp.ViewTab}),n}return u()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.initSearchKeywords(),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.MODE_CHANGE,this.handleModeChange)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ViewTab.template", "母版视图"),icon:J.wpp_master_view})}},{key:"render",value:function(){var e=this.renderTooltip(),t=this.props,n=t.readOnly,i=t.connected,a=t.isOnline,o=!i||n||!a;return f.a.createElement("div",{className:"inline-middle"},f.a.createElement(M.default,{ref:this.refBtn,selected:this.state.selected,iconType:J.wpp_master_view,onClick:this.handleMasterViewClick,disabled:o,title:e},_i18n("applications.presentation.components.CommandBars.RbTab.ViewTab.template", "母版视图")))}}]),t}(Z),ee=n(1034),te=n(7624),ne=n.n(te),ie=window.CommandBarComponentFragment,ae=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dropDownMenu:"",isEditMode:!1,connected:n.props.connected},n.wrapRef=f.a.createRef(),n}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.visible,i=e.readOnly,a=e.connected,o=e.isOnline;return f.a.createElement(w.a,{ref:this.wrapRef,tabKey:t,visible:n},f.a.createElement(ne.a,{disabled:!a||!o||i,isOnline:o}),f.a.createElement("div",null,f.a.createElement($,this.props)),f.a.createElement(ie,{cmbId:ie.cmbIds.wpp.ViewTabFullScreen},f.a.createElement(ee.a,{showText:!0})))}}]),t}(b.a);ae.propTypes={tabKey:_.a.string.isRequired};var oe=ae,le=n(158),se=M.default.iconTypes.size16,re=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){Date.now()-n.lastClickTime<300?n.clickTimes+=1:n.clickTimes=1,x.default.uilDispatcher.fire(x.default.eventTypes.pc.ON_FORMAT_BRUSH_CLICK,{isDoubleClick:2===n.clickTimes,type:le.FormatBrushType.Animation}),n.lastClickTime=Date.now()},n.onBrushChange=function(){n.setState({isAnimeBrush:n.isAnimeBrush()})},n.refBtn=f.a.createRef(),n.state={isAnimeBrush:n.isAnimeBrush()},n}return u()(t,e),r()(t,[{key:"isAnimeBrush",value:function(){var e=window.APP.shell.editor.slide.brushData;return e&&e.brushType===le.FormatBrushType.Animation}},{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.animFormat", "动画刷"),icon:se.wpp_brush_anime}),x.default.uilDispatcher.on(x.default.eventTypes.pc.ON_FORMAT_BRUSH_CHANGE,this.onBrushChange)}},{key:"componentWillUnmount",value:function(){x.default.uilDispatcher.off(x.default.eventTypes.pc.ON_FORMAT_BRUSH_CHANGE,this.onBrushChange)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state.isAnimeBrush;return f.a.createElement(M.default,{ref:this.refBtn,disabled:e,iconType:se.wpp_brush_anime,onClick:this.handleClick,selected:t,title:_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.animeTitle", "将所选对象的动画应用到其它对象上（双击可连续使用）")},_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.animFormat", "动画刷"))}}]),t}(f.a.PureComponent),ce=n(144),de=n(146),pe=M.default.iconTypes.size16,ue=window.CommandBarComponent,me=function(e){function t(e){l()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,ue.cmbIds.wpp.ToolsTabExportImage));return n.handleClick=function(){var e=window.__WPSPLUGIN__,t=e.loader,n={pluginType:e.type.ShapeExport},i=t.search(n);(ce.isIPad&&i||Object(ce.isSupportDownload)())&&(i?t.loadSingleInstance(n).then((function(e){e.messageGet({action:"show"})})):de.default.dispatchEvent(de.default.names.file.ON_EXPORT_IMG))},n.refBtn=f.a.createRef(),n}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.exportImg", "导出为图片"),icon:pe.export_img_new})}},{key:"render",value:function(){var e=this.props.disabled;return f.a.createElement(M.default,{ref:this.refBtn,disabled:e,iconType:pe.export_img_new,onClick:this.handleClick},_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.exportImg", "导出为图片"))}}]),t}(ue);me.propTypes={disabled:_.a.bool.isRequired};var fe=me,he=M.default.iconTypes.size16,_e=function(e){function t(){var e,n,i,a;l()(this,t);for(var o=arguments.length,s=Array(o),r=0;r<o;r++)s[r]=arguments[r];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.handleClick=function(){de.default.dispatchEvent(de.default.names.file.ON_EXPORT_PDF)},i.refBtn=f.a.createRef(),a=n,d()(i,a)}return u()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.exportPdf", "导出为PDF"),icon:he.export_pdf_new})}},{key:"render",value:function(){var e=this.props.disabled;return f.a.createElement(M.default,{ref:this.refBtn,disabled:e,iconType:he.export_pdf_new,onClick:this.handleClick},_i18n("applications.presentation.components.CommandBars.RbTab.ToolsTab.exportPdf", "导出为PDF"))}}]),t}(f.a.PureComponent),we=n(7625),be=n.n(we),ye=function(e){function t(){var e,n,i,a;l()(this,t);for(var o=arguments.length,s=Array(o),r=0;r<o;r++)s[r]=arguments[r];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={hasSlide:!0},a=n,d()(i,a)}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.tabKey,n=e.visible,i=e.file,a=e.connected,o=e.isOnline,l=e.readOnly,s=this.state.hasSlide,r=window.APP.canDownload(),c=!a||!o,d=c||!i.user_acl.download,p=this.doc.getMode()===U.ViewModes.MasterView,u=window.__CONFIG__.wpp.enableImportSlide;return f.a.createElement(w.a,{ref:this.wrapRef,tabKey:t,visible:n},f.a.createElement("div",null,f.a.createElement(re,{disabled:c||!s||l||p})),f.a.createElement("div",null,f.a.createElement(j,{connected:a,showText:!0,disabled:c||!s||p})),u&&f.a.createElement("div",null,f.a.createElement(be.a,{disabled:c||l||p})),f.a.createElement("div",null,f.a.createElement(_e,{disabled:d||!r||p})),f.a.createElement("div",null,f.a.createElement(fe,{disabled:d||!r||p})))}}]),t}(b.a);ye.propTypes={tabKey:_.a.string.isRequired,visible:_.a.bool.isRequired,file:_.a.object.isRequired};var ve=ye,Te=window.CommandBarComponent.cmbIds.wpp,Ee=function(e){function t(){return l()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.readOnly,n=e.dispatch,i=e.activeTab,o=e.isOnline,l=e.user,s={dispatch:n,openSuccess:e.openSuccess,connected:e.connected,readOnly:t,isOnline:o,user:l,file:e.file};return f.a.createElement(f.a.Fragment,null,f.a.createElement(H,a()({},s,{tabKey:Te.ReviewTab,visible:i===Te.ReviewTab})),f.a.createElement(oe,a()({},s,{tabKey:Te.ViewTab,visible:i===Te.ViewTab})),f.a.createElement(O,a()({},s,{tabKey:Te.PlayTab,visible:i===Te.PlayTab})),f.a.createElement(ve,a()({},s,{tabKey:Te.ToolsTab,visible:i===Te.ToolsTab})))}}]),t}(m.PureComponent);t.default=Ee},962:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return b}));var i=n(0),a=n.n(i),o=n(3),l=n.n(o),s=n(144),r=n(145),c=n(45),d=n(146);function p(e){var t=e.documentElement,n=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen;if(n)return function(){return n.call(t)}}function u(){return!!window.__CONFIG__.isEnableFullScreen&&(!!p(window.document)&&(!(s.isIE&&!s.isEdge)&&(!(s.isQQBrowser||s.isWpsClient||s.isWps2019)&&!Object(c.hasQuery)("version"))))}var m=function(){function e(t,n,i){a()(this,e),this.win=t,this.doc=t.document,this.onChange=n,this.onF11=i,this._handleChange=this._handleChange.bind(this),this._handleF11=this._handleF11.bind(this),this.doc.addEventListener("keydown",this._handleF11),this.doc.addEventListener("fullscreenchange",this._handleChange),this.doc.addEventListener("mozfullscreenchange",this._handleChange),this.doc.addEventListener("webkitfullscreenchange",this._handleChange)}return l()(e,[{key:"destroy",value:function(){this.doc.removeEventListener("keydown",this._handleF11),this.doc.removeEventListener("fullscreenchange",this._handleChange),this.doc.removeEventListener("mozfullscreenchange",this._handleChange),this.doc.removeEventListener("webkitfullscreenchange",this._handleChange)}},{key:"fullScreen",value:function(){console.log("进入全屏"),p(this.doc)()}},{key:"exitFullScreen",value:function(){console.log("退出全屏"),function(e){var t=e.exitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen||e.webkitCancelFullScreen||e.webkitExitFullscreen;if(t)return function(){return t.call(e)}}(this.doc)()}},{key:"isFullScreen",value:function(){return void 0!==(e=this.doc).fullscreen?e.fullscreen:void 0!==e.webkitIsFullScreen?e.webkitIsFullScreen:void 0!==e.mozFullScreen?e.mozFullScreen:void 0;var e}},{key:"_handleChange",value:function(){this.onChange(this.isFullScreen())}},{key:"_handleF11",value:function(e){(s.isMacOs?e.ctrlKey&&e.metaKey&&"f"===e.key:122===e.keyCode)&&(Object(r.stopBubble)(e),this.onF11())}}]),e}(),f=void 0,h=void 0;function _(e){f=new m(window,e,b),window._parent!==window&&(h=new m(window._parent,e,b)),window.addEventListener(d.default.names.EXIT_FULL_SCREEN,y)}function w(){f.destroy(),h&&h.destroy(),window.removeEventListener(d.default.names.EXIT_FULL_SCREEN,y),f=null,h=null}function b(){var e=h||f;e.isFullScreen()?e.exitFullScreen():e.fullScreen()}function y(){var e=h||f;e.isFullScreen()&&e.exitFullScreen()}}}]);