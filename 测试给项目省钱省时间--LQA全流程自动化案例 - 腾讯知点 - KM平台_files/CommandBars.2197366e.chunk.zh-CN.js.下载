(window.webpackJsonp=window.webpackJsonp||[]).push([[183,218],{1038:function(e,t,n){e.exports=function(e,t){Promise.resolve().then(n.bind(null,205)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},1061:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1062:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessOnCategory=void 0,function(e){e.MindFree="mind_free",e.Flow="flow"}(t.ProcessOnCategory||(t.ProcessOnCategory={}))},1063:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBackupKey=t.deleteBackupData=t.storeBackupData=void 0;var i=(0,n(143).__importDefault)(n(680));function a(){var e=window.fileInfo,t=e.office_type,n=e.id,i="prcobc-".concat(t,"-").concat(n);return{dataKey:i,timeKey:"time-"+i}}t.storeBackupData=function(e,t,n){(0,i.default)((function(i){var o=i.default.getInstance(),r=a(),s=r.dataKey,l=r.timeKey;o.write(s,JSON.stringify({userId:t,processonData:e,isProcessonEdit:!0,positionInfo:n})),o.write(l,Date.now())}))},t.deleteBackupData=function(){(0,i.default)((function(e){var t=e.default.getInstance(),n=a(),i=n.dataKey,o=n.timeKey;t.delete(i),t.delete(o)}))},t.getBackupKey=a},1114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(183)),r=(0,i.__importDefault)(n(155)),s=(0,a.forwardRef)((function(e,t){var n=e.text,s=void 0===n?"":n,l=e.disabled,c=void 0!==l&&l,d=e.selected,p=void 0!==d&&d,u=e.isDropdown,h=void 0!==u&&u,f=e.iconType,m=e.onClick,v=void 0===m?function(){}:m,w=e.title,g=void 0===w?"":w,y=e.textBtnProps,b=void 0===y?{}:y,_=e.iconBtnProps,C=void 0===_?{}:_,T=(0,a.useState)(!0),k=T[0],E=T[1],S=(0,a.useRef)(null),P=(0,a.useRef)(null),R=0;return(0,a.useEffect)((function(){var e;R=null===(e=S.current)||void 0===e?void 0:e.offsetWidth}),[]),(0,a.useImperativeHandle)(t,(function(){return{getTextWidth:function(){return R||(null==S?void 0:S.current.offsetWidth)||0},toggleShowText:function(e){E(e)},isTextShow:function(){return k},getElement:function(){return P.current}}})),a.default.createElement("div",{ref:P},k?a.default.createElement(o.default,(0,i.__assign)({disabled:c,selected:p,isDropdown:h,iconType:f,onClick:v,title:s===g?"":g},b),a.default.createElement("span",{ref:S},s)):a.default.createElement(r.default,(0,i.__assign)({disabled:c,selected:p,isDropdown:h,title:g,iconType:f,onClick:v},C)))}));t.default=a.default.memo(s)},1188:function(e,t,n){},1189:function(e,t,n){},1213:function(e,t,n){},1241:function(e,t,n){},1480:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(144),l=function(){function e(t){a()(this,e),this.init(t)}return r()(e,[{key:"init",value:function(e){var t={src:null,middleHtml:window.__CONFIG__.pathRoot+"/print.html",type:"pdf",header:null,onError:function(e){throw new Error(e)},onEnd:null,iframeId:parseInt(1e3*Math.random())};this.args=Object.assign({},t,e),this.onMessage=this.onMessage.bind(this),this.onEnd=this.onEnd.bind(this),this.onError=this.onError.bind(this),this.printFrame=document.createElement("iframe"),this.printFrame.setAttribute("style","position: absolute; width:0; height:0; top: 0; left: 0; visibility: hidden;"),this.printFrame.id=this.args.iframeId}},{key:"print",value:function(e,t){var n=this.args,i=n.type,a=n.src;if(e)a=e;else if(!a)return void this.onError(_i18n("applications.public.components.panel.Printer.failedRegeneration", "生成失败"));t&&(this.previewId=t),"pdf"===i&&(a=/^(blob|http)/i.test(a)?a:window.location.origin+("/"!==a.charAt(0)?"/"+a:a))&&(this.makeFrame(a),this.bindLoad(this.args))}},{key:"createFrame",value:function(){var e=document.getElementsByTagName("body")[0];this.previewId&&(this.printFrame.setAttribute("style","width:100%; height:100%; visibility:visible; overflow:hidden;"),e=document.getElementById(this.previewId)),e.appendChild(this.printFrame)}},{key:"makeFrame",value:function(e){e&&(this.args.src=e);var t=document.getElementById(this.args.iframeId);t&&(window.removeEventListener("message",this.onEnd),t.parentNode.removeChild(t)),this.createFrame(),this.args.middleHtml?(window.addEventListener("message",this.onMessage),this.printFrame.setAttribute("src",this.args.middleHtml)):(this.printFrame.setAttribute("src",this.args.src),this.printFrame.type="application/pdf")}},{key:"bindLoad",value:function(){var e=this;s.isEdge&&this.printFrame.setAttribute("onload",this.finishPrint()),this.printFrame.onload=function(){e.finishPrint()}}},{key:"finishPrint",value:function(){try{this.performPrint()}catch(e){this.onError()}}},{key:"performPrint",value:function(){var e=document.getElementById(this.args.iframeId);if(e&&e.contentWindow)if(this.previewId)this.args.middleHtml&&e.contentWindow.postMessage({method:"preview",src:this.args.src,id:this.args.iframeId,isEdge:s.isEdge},window.location.origin);else if(this.args.middleHtml)e.contentWindow.postMessage({method:"print",src:this.args.src,id:this.args.iframeId,isEdge:s.isEdge},window.location.origin);else{if(s.isEdge)try{e.contentWindow.document.execCommand("print",!1,null)}catch(t){e.contentWindow.print()}else e.contentWindow.print();this.onEnd()}else this.create(),this.performPrint()}},{key:"forcePrint",value:function(){if(this.args.middleHtml){var e=document.getElementById(this.args.iframeId);e&&e.contentWindow&&e.contentWindow.postMessage({method:"forcePrint",id:this.args.iframeId,isEdge:s.isEdge},window.location.origin)}}},{key:"cleanUp",value:function(){this.args.middleHtml&&window.removeEventListener("message",this.onMessage)}},{key:"onMessage",value:function(e){if(e.origin===window.location.origin){var t=e.data;"end"===t?this.onEnd():"error"===t&&this.onError(_i18n("applications.public.components.panel.Printer.printFail", "打印失败"))}}},{key:"onError",value:function(e){e||(e=_i18n("applications.public.components.panel.Printer.printFail", "打印失败")),this.onEnd(),this.args.onError(e);var t=document.getElementById(this.args.iframeId);t&&t.parentNode.removeChild(t)}},{key:"onEnd",value:function(e){var t=this;setTimeout((function(){t.args.onEnd(),t.cleanUp()}),500)}}]),e}(),c=window.WPSOpenApi.getPrinter()||l;t.a=c},1481:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(1482),n(142)),u=n.n(p),h=function(e){function t(e){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return d()(t,e),r()(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"wrap"},u.a.createElement("div",{className:"title"},u.a.createElement("span",null,_i18n("applications.public.components.panel.Printer.printPreview", "打印预览")),u.a.createElement("div",{className:"btns"},u.a.createElement("a",{href:"javascript:void(0);",className:"print",onClick:this.props.handlePrint},_i18n("applications.public.components.panel.Printer.print", "打印")),u.a.createElement("a",{href:"javascript:void(0);",className:"close",onClick:this.props.handleClose},_i18n("applications.public.components.panel.Printer.closePreview", "关闭预览")))),u.a.createElement("div",{className:"frame",id:"frame"}))}}]),t}(p.PureComponent);t.a=h},1482:function(e,t,n){},166:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=(n(259),n(142)),f=n.n(h),m=n(160),v=n.n(m),w=n(144),g=n(146),y=n(191),b=n(229),_=n(182),C=n(283),T={click:"click",hover:"hover"},k=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.trigger===T.hover&&!w.isTouchScreen},n.refDropDown=f.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return u()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,a=n.destroyOnHide;!i&&e.visible&&!a&&void 0!==a&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||v.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,a=t.trigger;i?i(e):a===T.hover&&!w.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,a=n.right,o=n.top,r=n.bottom,s=e.pageX,l=e.pageY;if(s>=i&&s<=a&&l>=o&&l<=r)return}g.default.dispatchEvent(g.default.names.DROPDOWN_BTN_CONTENT_MOUSE_LEAVE,e),this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,a=t.visible,o=t.placement,r=t.distance,s=t.panelClass,l=t.isAuto,c=t.offsetX;return f.a.createElement(b.default,{ref:this.refDropDown,isAuto:l,className:s,triggerElement:this.btnDom,rect:e,offsetX:c,visible:a,placement:o,distance:r,isSetHeight:n,onClose:this.handleContentClose,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,a=e.destroyOnHide;t=t||n.props.disabled;var o=this.getRect();if(!t){var r=n.props.title;r&&i&&(r=null),n=f.a.cloneElement(n,{title:r,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return f.a.createElement(f.a.Fragment,null,n,!!o&&f.a.createElement(y.default,{visible:i,destroyOnHide:a},this.renderContent()))}}]),t}(h.PureComponent);k.placementTypes=b.default.placementTypes,k.DropdownPanel=_.default,k.triggerTypes=T,k.defaultProps={visible:!1,trigger:T.click,distance:4,offsetX:0},t.default=k;var E=function(e){function t(){return r()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this.props.commandBarId;window.__WPSENV__.reduxDispatch(Object(C.altLazyLoad)({id:e}))}},{key:"render",value:function(){return f.a.createElement(_.default,a()({},this.props,{ref:this.forwardRef}),this.props.children)}}]),t}(h.PureComponent);E.Item=_.default.Item,E.Divider=_.default.Divider,k.AltDropdownPanel=E},172:function(e,t,n){"use strict";n.r(t);var i=n(44),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=n(142),f=n.n(h),m=n(145),v=n(151),w=n.n(v),g=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refDiv=f.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return u()(t,e),l()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(m.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getClassName",value:function(){var e=this.props,t=e.selected,n=e.disabled,i=e.disabledTag,o=e.children,r=e.className,s="component-menu-item",l=this.refDiv.current;l&&-1!==l.className.indexOf(" hover")&&(s+=" hover"),t&&(s+=" selected"),n&&(s+=" disabled"),i&&(s+=" disabled-tag"),r&&(s+=" "+r);var c=void 0===o?"undefined":a()(o);return"string"!==c&&"number"!==c||(s+=" only-text"),r&&(s+=" "+r),s}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.keepEdit,a=e.dataKey,o=e.title,r=e.draggable,s=e.onDragStart,l=e.onDragEnd,c=this.getClassName();return f.a.createElement(w.a,{title:o},f.a.createElement("div",{ref:this.refDiv,id:t,className:c,"data-keep-edit":i||void 0,"data-key":a||void 0,draggable:r,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:s,onDragEnd:l},n))}}]),t}(h.PureComponent);t.default=g},182:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(209),n(142)),u=n.n(p),h=n(144),f=n(146),m=n(145),v=n(148),w=n(226),g=n(245),y=n(169),b="right",_="down",C="rightDown",T=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer)}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){f.default.dispatchEvent(f.default.names.DROPDOWN_PANEL_SCROLL);var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var a=n.refPanel.current,o=a.scrollTop;o+a.clientHeight+t>=a.scrollHeight&&i({scrollTop:o})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=u.a.createRef(),n.refContent=u.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(m.getPageOfficeType)(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){h.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(){h.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(){if(this.props.onItemHover&&!h.isTouchScreen){var e=this.getHoverItem();this.props.onItemHover(e,!0)}}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(m.stopBubble)(e);var i=e.clientX,a=e.clientY,o=e.target,r=e.currentTarget.getAttribute("data-orien");o.setCapture&&o.setCapture();var s=this.state,l=s.width,c=s.height,d=s.minWidth,p=s.minHeight;document.onmousemove=function(e){Object(m.stopBubble)(e);var n=e.clientX,o=e.clientY,s=Math.max(d,l+n-i),u=Math.max(p,c+o-a);r===b?u=c:r===_&&(s=l),t.setState({width:s,height:u},(function(){f.default.dispatchEvent(f.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(m.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,o.releaseCapture&&o.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if(!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad")){var i=Object(y.getKey)(e);switch(i){case y.Keys.Enter:var a=this.getHoverItem();a&&(Object(m.stopBubble)(e),a.click());break;case y.Keys.ArrowUp:case y.Keys.ArrowDown:if(window.__WPSENV__.store.getState().public.alt.isInMode)break;var o=i===y.Keys.ArrowUp;this.setPreSelectItem(o,e),this.props.isPreSelectCloseDropdown&&f.default.dispatchEvent(f.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(m.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var a=this.getPreSelectItem(e,n,i);a.classList.add("hover"),this.showPreSelectItem(a)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,a=0;a<t.length;a++)if(t[a]===n){i=a;break}if(e){for(var o=i-1;o>=0;o--)if(-1===t[o].className.indexOf("disabled")){i=o;break}}else for(var r=i+1;r<t.length;r++)if(-1===t[r].className.indexOf("disabled")){i=r;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,a=t.maxWidth;if(n||i||a)return{width:n,minWidth:i,maxWidth:a}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,a="dropdown-panel";e.isAuto&&(a+=" "+this.officeType),i&&(a+=" can-resize"),t&&(a+=" "+t);var o=this.getPanelStyle();return u.a.createElement("div",{ref:this.refPanel,className:a,style:o,tabIndex:0,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0},u.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),u.a.createElement("div",{className:"drag-hand rightBottom","data-orien":C,onMouseDown:this.handleDragMouseDown},u.a.createElement(v.default,{type:v.default.types.other.drag_right_bottom})),u.a.createElement("div",{className:"drag-hand right","data-orien":b,onMouseDown:this.handleDragMouseDown}),u.a.createElement("div",{className:"drag-hand bottom","data-orien":_,onMouseDown:this.handleDragMouseDown}))}}]),t}(p.PureComponent);T.Item=w.default,T.Divider=g.a,T.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=T},183:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(353),n(142)),u=n.n(p),h=n(151),f=n.n(h),m=n(148),v=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.refWrap=u.a.createRef(),o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.selected,a="component-icon-text-btn";return e.isDropdown&&(a+=" dropdown"),e.isReverse&&(a+=" reverse"),n&&(a+=" disabled"),i&&(a+=" selected"),e.showBorder&&(a+=" show-border"),t&&(a+=" "+t),a}},{key:"getElement",value:function(){return this.refWrap.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.disabled,a=e.title,o=e.iconType,r=e.keepEdit,s=e.onClick,l=e.onMouseEnter,c=e.onMouseLeave;i&&(s=void 0);var d=this.getClassName();return u.a.createElement(f.a,{title:a,onMouseEnter:l,onMouseLeave:c},u.a.createElement("div",{ref:this.refWrap,id:t,onClick:s,className:d,"data-keep-edit":r||void 0},u.a.createElement(m.default,{type:o}),u.a.createElement("div",{className:"btn-text"},n)))}}]),t}(p.PureComponent);v.iconTypes=m.default.types,t.default=v},1830:function(e,t,n){},185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runScrollLeft=t.runOpacity=t.runTranslateY=t.runTranslateX=t.runRotate=t.runHeight=t.runStyle=t.run=t.StyleNames=t.defaultTransition=t.IRunOption=void 0;var i=n(143),a=n(405);function o(e){e.start,e.end,e.element}Object.defineProperty(t,"IRunOption",{enumerable:!0,get:function(){return a.IRunOption}}),Object.defineProperty(t,"StyleNames",{enumerable:!0,get:function(){return a.StyleNames}});function r(e){var t=e.setValue,n=e.start,i=e.end,a=e.keepEnd,r=e.onDone;r=r||Function.prototype,o(e);var s=!1,l=null,c=function(){window.cancelAnimationFrame(l),s=!0};if(n===i)return r(),c;var d=window.performance.now(),p=d,u=n,h=0;return t(u),l=window.requestAnimationFrame((function e(){s?r():(u=function(e,t,n,i,a){var o=window.performance.now(),r=(180-o+e)/Math.max(15,o-t);return r=Math.ceil(r),r=Math.min(10-n,r),i=(i+=(a-i)/(r=Math.max(4-n,r,1)))>a?Math.max(a,i):Math.min(a,i)}(d,p,h++,u,i),p=window.performance.now(),u===i&&(s=!0,u=a?i:""),t(u),window.requestAnimationFrame(e))})),c}t.defaultTransition="all 0.2s ease-in-out";var s=null,l=[];function c(e){return e.useFrame?r(e):function(e){var t=e.element,n=e.setValue,i=e.start,a=e.end,r=e.keepEnd,c=e.onDone,d=e.transition;if(c=c||Function.prototype,d=d||"all 0.2s ease-in-out",o(e),i.toFixed(2)===a.toFixed(2))return c(),null;n(i);var p=null;clearTimeout(s),l.push((function(){t.style.transition=d,n(a);var e=d.split(" ")[1],i=e.includes("ms")?parseFloat(e):1e3*parseFloat(e);p=setTimeout((function(){h()}),i+=100)})),s=setTimeout((function(){for(;l.length;){l.shift()()}}),10);var u=!1,h=function e(){u||(u=!0,t.removeEventListener("transitionend",e),t.style.transition="",n(r?a:""),c(),clearTimeout(p),p=null)};return t.addEventListener("transitionend",h),h}(e)}function d(e,t){return c((0,i.__assign)((0,i.__assign)({},t),{setValue:function(n){var i=e,o="".concat(n,"px");switch(e){case a.StyleNames.translateX:case a.StyleNames.translateY:n&&window.rightToLeft&&(n=-n),i="transform",o="".concat(e,"(").concat(n,"%)");break;case a.StyleNames.rotate:i="transform",o="rotate(".concat(n,"deg)");break;case a.StyleNames.opacity:o=n}t.element.style[i]=""===n?"":o}}))}t.run=c,t.runStyle=d,t.runHeight=function(e){return d(a.StyleNames.height,e)},t.runTranslateX=function(e){return d(a.StyleNames.translateX,e)},t.runTranslateY=function(e){return d(a.StyleNames.translateY,e)},t.runRotate=function(e){return d(a.StyleNames.rotate,e)},t.runOpacity=function(e){return d(a.StyleNames.opacity,e)},t.runScrollLeft=function(e){return c((0,i.__assign)((0,i.__assign)({},e),{useFrame:!0,setValue:function(t){e.element.scrollLeft=t}}))}},1864:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=(n(1241),n(191)),f={top:"top",left:"left",right:"right",bottom:"bottom",bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right"},m=n(26),v=n.n(m),w=n(144),g=n(145),y=w.isMobile,b=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rect:null,style:{visibility:"hidden",top:0,left:0},arrowStyle:null},n.arrowSize=6,n.handleWindowClick=n.handleWindowClick.bind(n),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.getStyle(),this.props.onVisibleChange&&this.props.onVisibleChange(!0),this.props.isClickClosed&&(!y&&window.addEventListener("click",this.handleWindowClick),y&&window.addEventListener("touchstart",this.handleWindowClick,{passive:!1}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.rect;e.rect!==n&&n&&this.getStyle()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleWindowClick),window.removeEventListener("touchstart",this.handleWindowClick,{passive:!1})}},{key:"handleWindowClick",value:function(e){var t=this.popoverContentDom,n=e.target,i=this.props,a=i.onClose,o=i.onVisibleChange;document.body.contains(n)&&!t.contains(n)&&(Object(g.stopBubble)(e),a&&a(),o&&o(!1))}},{key:"getStyle",value:function(){var e=this.props,t=e.rect,n=e.placement,i=e.offsetX,a=e.offsetY;if(!t||!this.popoverContentDom)return this.state.style;var o=document.body.clientWidth,r=this.popoverContentDom,s=r.offsetWidth,l=r.offsetHeight,c=void 0,d=void 0;switch(n){case f.left:c={top:t.top+t.height/2-l/2+a,right:o-t.left+i},d={top:l/2-this.arrowSize-a};break;case f.right:c={top:t.top+t.height/2-l/2+a,left:t.right+i},d={top:l/2-this.arrowSize-a};break;case f.bottomRight:c={top:t.bottom+a,right:o-t.right+i},d={right:this.arrowSize+10-i};break;case f.bottomLeft:c={top:t.bottom+a,left:t.left+i},d={left:this.arrowSize+10};break;case f.bottom:c={top:t.bottom+a,left:t.right-s/2-t.width/2+i},d={left:s/2-this.arrowSize};break;case f.top:c={top:t.top-l+a,left:t.right-s/2-t.width/2+i},d={left:s/2-this.arrowSize};break;case f.topRight:c={top:t.top-l+a,right:o-t.right-i},d={right:this.arrowSize+10};break;case f.topLeft:c={top:t.top-l+a,left:t.left+i},d={left:this.arrowSize+10}}if(this.props.autoAdjustOverflow){if(c.left&&(c.left=Math.max(c.left,0)),c.right&&(c.right=Math.max(c.right,0)),o-(c.left+s)<0){switch(n){case f.top:case f.topLeft:case f.bottom:case f.bottomLeft:d={left:d.left-(o-(c.left+s))+10}}c.left=void 0,c.right=10}o-(c.right+s)<0&&(c.left=0,c.right=void 0)}this.setState({style:c,arrowStyle:d})}},{key:"getPixelRatio",value:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.children,a=t.placement,o=t.autoAdjustOverflow,r=t.drawArrow,s=this.state.arrowStyle,l=v()({},this.state.style,this.props.style);o||(l=v()({},l,{whiteSpace:"nowrap"}));var c="component-popover "+a;return n&&(c+=" "+n),u.a.createElement("div",{ref:function(t){return e.popoverContentDom=t},className:c,style:l},r&&u.a.createElement("div",{className:"popover-arrow "+a,style:s}),u.a.createElement("div",{className:"popover-body"},i))}}]),t}(p.PureComponent);b.defaultProps={offsetX:0,offsetY:0,isClickClosed:!0,drawCanvas:!1,drawArrow:!0};var _=b,C=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,wrap:null},n.saveWrap=function(e){n.wrap=e},n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.setState({visible:!0})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&this.setState({visible:n})}},{key:"getRect",value:function(){var e=this.wrap;return this.state.visible&&e?(e=this.props.children?e.children[0]:e.parentNode).getBoundingClientRect():null}},{key:"handleMouseEnter",value:function(){this.props.proactiveTrigger&&this.setState({visible:!0})}},{key:"handleMouseLeave",value:function(){this.props.proactiveTrigger&&this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.popoverClass,i=e.popoverStyle,a=e.content,o=e.placement,r=e.onClose,s=e.onVisibleChange,l=e.offsetX,c=e.offsetY,d=e.containerClassName,p=e.autoAdjustOverflow,f=e.drawArrow,m=e.isClickClosed,v=e.getContainer,w=this.state.visible,g=this.getRect();return u.a.createElement("popover-container",{className:d,ref:this.saveWrap,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},w&&u.a.createElement(h.default,{visible:!0,className:"wpp-popup",getContainer:v},u.a.createElement(_,{className:n,visible:w,rect:g,style:i,offsetX:l,offsetY:c,placement:o,onClose:r,onVisibleChange:s,isClickClosed:m,autoAdjustOverflow:p,drawArrow:f},a)),t)}}]),t}(p.PureComponent);C.placementTypes=f,C.defaultProps={placement:f.bottomRight,autoAdjustOverflow:!0};var T=C,k=n(148),E=(n(1830),function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.content,i=e.onClose;return u.a.createElement("div",{className:"wpp-guide-tip-panel"},u.a.createElement("div",{className:"wpp-guide-tip-header"},u.a.createElement(k.default,{className:"tip-icon",type:k.default.types.other.meeting_tips}),u.a.createElement("p",{className:"tip-title"},t),u.a.createElement(k.default,{className:"close-btn",type:k.default.types.other.close,onClick:i})),n&&u.a.createElement("p",{className:"wpp-guide-tip-detail"},n))}}]),t}(p.PureComponent)),S=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowGuideTip=function(e){var t=e.detail,i=!(!t||!t.isClosed);n.setState({visible:!i}),n.props.onShowGuideTip&&n.props.onShowGuideTip()},n.onCloseGuideTiplose=function(e){n.setState({visible:!1}),n.props.onCloseGuideTip&&n.props.onCloseGuideTip()},n.refPopover=u.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.state={visible:e.defaultVisible},n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.props.eventName&&window.addEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.addEventListener("keydown",this.handleWindowKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),this.props.eventName&&window.removeEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.removeEventListener("keydown",this.handleWindowKeyDown)}},{key:"handleWindowKeyDown",value:function(e){var t=e.code,n=e.keyCode;"Escape"!==t&&27!==n||this.state.visible&&(this.stopBubble(e),this.onCloseGuideTiplose())}},{key:"stopBubble",value:function(e){(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0}},{key:"handleVisibleChange",value:function(e){this.setState({visible:e})}},{key:"handleWindowResize",value:function(){this.refPopover.current.forceUpdate()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.content,a=e.popoverClass,o=e.placement,r=e.offsetX,s=e.offsetY,l=e.isClickClosed,c=e.getContainer,d=e.drawArrow;if(!n&&!i)return null;var p=this.state.visible,h=u.a.createElement(E,{onClose:this.onCloseGuideTiplose,title:n,content:i});return u.a.createElement(T,{ref:this.refPopover,placement:o,visible:p,content:h,popoverClass:a,offsetX:r,offsetY:s,autoAdjustOverflow:!0,onVisibleChange:this.handleVisibleChange,isClickClosed:l,getContainer:c,drawArrow:d},t)}}]),t}(p.PureComponent);S.defaultProps={popoverClass:"",placement:T.placementTypes.bottomLeft,offsetX:0,offsetY:0,isClickClosed:!0,isEscClosed:!0,defaultVisible:!1},S.placementTypes=T.placementTypes;t.default=S},1874:function(e,t,n){"use strict";n.d(t,"b",(function(){return p.a})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return d.FocusTargetsDef}));var i=n(26),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(335),d=n(158),p=n(388),u=function(){function e(t){r()(this,e),this.stopBubble=function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()},this.handleMap={}}return l()(e,[{key:"onEvent",value:function(e,t){if(this.isEvtHotkey(e,t)){var n=this.getHotKeyName(t);return this.handleMap[e].fireDirect(n,t),!0}return!1}},{key:"isEvtHotkey",value:function(e,t){if(this.handleMap&&this.handleMap[e]){var n=this.getHotKeyName(t);if(this.handleMap[e]._listeners[n])return!0}return!1}},{key:"getHotKeyName",value:function(t){return e.getHotKeyName(t)}},{key:"addListener",value:function(e,t,n){var i=this,a=t.keyCode,o=t.ctrlKey,r=t.metaKey,s=t.shiftKey,l=t.altKey;e instanceof Array||(e=[e]),a instanceof Array||(a=[a]),e.forEach((function(e){i.handleMap[e]||(i.handleMap[e]=new c.a),a.forEach((function(t){var a=i.getHotKeyName({keyCode:t,ctrlKey:o,metaKey:r,shiftKey:s,altKey:l});i.handleMap[e].on(a,n)}))}))}},{key:"removeListener",value:function(e,t,n){var i=this,a=t.keyCode,o=t.ctrlKey,r=t.metaKey,s=t.shiftKey,l=t.altKey;e instanceof Array||(e=[e]),a instanceof Array||(a=[a]),e.forEach((function(e){i.handleMap[e]||(i.handleMap[e]=new c.a),a.forEach((function(t){var a=i.getHotKeyName({keyCode:t,ctrlKey:o,metaKey:r,shiftKey:s,altKey:l});i.handleMap[e].off(a,n)}))}))}},{key:"addKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"addKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}}],[{key:"getHotKeyName",value:function(e){var t=e,n=t.keyCode,i=t.key;return d.userAgent.isMacOs&&e.metaKey&&e.ctrlKey&&!d.userAgent.isIPad?null:(e instanceof KeyboardEvent||!d.userAgent.isMacOs||!Object.isEmpty(e.metaKey)||((e=Object.assign({},e)).metaKey=e.ctrlKey),window.isCtrlOrCmd(e)&&(d.userAgent.isIPad&&229===n?(i=i&&i.toUpperCase&&i.toUpperCase(),n=p.a[i]+"_ctrl"):n+="_ctrl"),e.shiftKey&&(n+="_shift"),window.isCtrlOrCmdAndAlt(e)?n+="_ctrl_alt":e.altKey&&(n+="_alt"),"_"+n)}}]),e}(),h=n(156),f=n(144),m=n(2270),v=function(){function e(t){var n=this;r()(this,e),this.onEvent=function(e,t){if(Object(m.a)()&&!n.stopKeyEvent&&window.APP.presentation){var i=n.getTragetModel();if(i&&i.isEvtHotkey(e,t))n.stopBubble(t),t.immediately||n._immedShortcuts.includes(u.getHotKeyName(t))?n._dispatcherImmediately(e,t):n._dispatcher(e,t),console.log("UilHotkeys have Hotkey");else(n.hasLockFocus()&&d.FocusTargetsDef.PLAY_View===n.curModelName&&n._abortShortcuts.includes(u.getHotKeyName(t))||n._globalShortcuts.includes(u.getHotKeyName(t)))&&n.stopBubble(t)}},this._dispatcher=Object(h.throttle)((function(e,t){var i=n.getTragetModel();return!i||!n.isPubHotkeys(t)&&n.hasLockFocus()?void 0:i&&i.onEvent(e,t)}),30),this._dispatcherImmediately=function(e,t){var i=n.getTragetModel();return!i||!n.isPubHotkeys(t)&&n.hasLockFocus()?void 0:i&&i.onEvent(e,t)},this.stopBubble=function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()},this._modelEventMap={},this._eventNameMap={},this._panelOrModalCount=0,window.addEventListener(d.UserEventTypes.KEY_EVENT,(function(e){var t=e.detail,i=t.type,a=t.data;n.onEvent(i,a)})),document.addEventListener("paste",(function(e){e.clipboardData&&e.clipboardData.items&&(f.isMobile||document.activeElement&&"text"===document.activeElement.type||n.onEvent("keydown",{keyCode:"paste",event:e}))})),this._globalShortcuts=this._globalShortcuts||[u.getHotKeyName({keyCode:p.a.F,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.S,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.H,ctrlKey:!0})],this._abortShortcuts=this._abortShortcuts||[u.getHotKeyName({keyCode:p.a.ADD,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.MINUS,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.NUMBER_ADD,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.EQUAL,ctrlKey:!0}),u.getHotKeyName({keyCode:p.a.CONNECT,ctrlKey:!0})],this._immedShortcuts=this._immedShortcuts||[u.getHotKeyName({keyCode:p.a.C,ctrlKey:!0})]}return l()(e,[{key:"on",value:function(e,t,n,i){var o=this;e instanceof Array||(e=[e]),e.forEach((function(r){o._modelEventMap[r]||(o._modelEventMap[r]=new u(o)),o._modelEventMap[r].addListener(t,n,i);var s=n.keyCode,l=n.global,c=n.immed,d=n.abort;s instanceof Array||(s=[s]),s.forEach((function(e){l&&o._globalShortcuts.push(u.getHotKeyName(a()({},n,{keyCode:e}))),c&&o._immedShortcuts.push(u.getHotKeyName(a()({},n,{keyCode:e}))),d&&o._abortShortcuts.push(u.getHotKeyName(a()({},n,{keyCode:e})))})),o._eventNameMap[t]?o._eventNameMap[t]++:(o._eventNameMap[t]=1,console.log("addEventListener",e,t,n),window.domTools.addEventListener(document,t,(function(e){!document.activeElement||"text"!==document.activeElement.type&&"textarea"!==document.activeElement.type||o._globalShortcuts.includes(u.getHotKeyName(e))?o.onEvent(t,e):o._abortShortcuts.includes(u.getHotKeyName(e))&&o.stopBubble(e)})))}))}},{key:"getTragetModel",value:function(e){return this._modelEventMap[e||this.curModelName||d.FocusTargetsDef.CONTAINER]}},{key:"isPubHotkeys",value:function(e){return this._globalShortcuts.includes(u.getHotKeyName(e))}},{key:"off",value:function(e,t,n,i){var a=this;e instanceof Array||(e=[e]),e.forEach((function(e){var o=a._modelEventMap[e];o&&o.removeListener(t,n,i)}))}},{key:"setFocusTarget",value:function(e){this.curModelName=e}},{key:"hasLockFocus",value:function(){return document.lockFocus}},{key:"setStopKeyEvent",value:function(e){this.stopKeyEvent=e}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}()},203:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(295),n(142)),u=n.n(p),h=n(146),f=n(145),m=n(241),v=n(172),w=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollSelectedChildren=function(){var e=n.refContent.current;if(e)for(var t=0;t<e.childElementCount;t++){var i=e.children[t];if(i.classList.contains("selected")){i.scrollIntoViewIfNeeded();break}}},n.refPanel=u.a.createRef(),n.refContent=u.a.createRef(),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.officeType=Object(f.getPageOfficeType)(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){var t=e.refPanel.current;t&&(t.focus(),e.scrollSelectedChildren())}),10)}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"handleKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if(!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))switch(e.keyCode){case 13:var i=this.getHoverItem();i&&(Object(f.stopBubble)(e),i.click());break;case 38:case 40:var a=38===e.keyCode;this.setPreSelectItem(a,e);break;case 9:case 39:var o=this.getHoverItem();if(o){Object(f.stopBubble)(e);var r={visible:!0,element:o,parent:this.refPanel.current};h.default.dispatchEvent(h.default.names.SUB_MENU_VISIBLE_CHANGE,r)}break;case 37:Object(f.stopBubble)(e),this.props.onLeftArrow&&this.props.onLeftArrow()}}}},{key:"handleMouseMove",value:function(e){var t=this.refPanel.current;if(!t.contains(document.activeElement)&&t.contains(e.target)&&t.focus(),this.props.onItemHover){var n=this.getHoverItem();this.props.onItemHover(n,t)}}},{key:"handleMouseOut",value:function(){if(this.props.onItemHover){var e=this.getHoverItem();this.props.onItemHover(e,this.refPanel.current)}}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("component-menu-item");if(n.length){Object(f.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var a=this.getPreSelectItem(e,n,i);if(a.classList.add("hover"),a.scrollIntoViewIfNeeded(),i!==a){var o={visible:!1,element:i,parent:this.refPanel.current};h.default.dispatchEvent(h.default.names.SUB_MENU_VISIBLE_CHANGE,o)}this.props.onItemHover&&this.props.onItemHover(a,this.refPanel.current)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,a=0;a<t.length;a++)if(t[a]===n){i=a;break}if(e){for(var o=i-1;o>=0;o--)if(-1===t[o].className.indexOf("disabled")){i=o;break}}else for(var r=i+1;r<t.length;r++)if(-1===t[r].className.indexOf("disabled")){i=r;break}return t[Math.max(0,i)]}},{key:"preSelectFirst",value:function(){this.setPreSelectItem(!0,null),this.refPanel.current.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.isAuto,i=e.children,a=e.onScroll,o=e.onMouseEnter,r="component-menu";return n&&(r+=" "+this.officeType),t&&(r+=" "+t),u.a.createElement("div",{ref:this.refPanel,className:r,tabIndex:0,onKeyDown:this.handleKeyDown,onScroll:a,onMouseMove:this.handleMouseMove,onMouseEnter:o,onMouseOut:this.handleMouseOut},u.a.createElement("div",{ref:this.refContent,className:"menu-content"},i))}}]),t}(p.PureComponent);w.Divider=m.default,w.Item=v.default,w.defaultProps={isAuto:!0,enabledHotKey:!0},t.default=w},209:function(e,t,n){},213:function(e,t,n){"use strict";t.a={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"}},226:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n.n(i),o=n(44),r=n.n(o),s=n(0),l=n.n(s),c=n(3),d=n.n(c),p=n(25),u=n.n(p),h=n(42),f=n.n(h),m=n(142),v=n.n(m),w=n(145),g=n(151),y=n.n(g),b=function(e){function t(e){l()(this,t);var n=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=v.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return f()(t,e),d()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(w.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,a=e.children,o="panel-item",s=this.refDiv.current;s&&-1!==s.className.indexOf(" hover")&&(o+=" hover"),t&&(o+=" disabled"),n&&(o+=" selected");var l=void 0===a?"undefined":r()(a);return"string"!==l&&"number"!==l||(o+=" only-text"),i&&(o+=" "+i),o}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,o=e.children,r=e.getStyle,s=e.visible,l=e.dataKey,c=e.keepEdit,d=e.draggable,p=e.onMouseEnter,u=e.onMouseLeave,h=e.onDragEnter,f=e.onDragStart,m=e.onDragEnd;if(!s)return!1;var w=this.getClassName(),g=r?r(i):null,b={};return p&&(b.onMouseEnter=p),u&&(b.onMouseLeave=u),v.a.createElement(y.a,a()({title:n},b),v.a.createElement("div",a()({ref:this.refDiv,id:t,className:w,style:g,"data-key":l||void 0,"data-keep-edit":c||void 0,draggable:d,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:f,onDragEnter:h,onDragEnd:m},b),o))}}]),t}(m.PureComponent);b.defaultProps={visible:!0},t.default=b},2270:function(e,t,n){"use strict";function i(){var e=window.getSelection(),t=e&&(e.focusNode||e.anchorNode);return!!(e&&e.isCollapsed||!t||t instanceof HTMLFormElement)}n.d(t,"a",(function(){return i}))},229:function(e,t,n){"use strict";n.r(t);var i=n(150),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=(n(260),n(142)),f=n.n(h),m=n(144),v=n(145),w=n(169),g=n(146),y=n(213),b=n(286),_=n(26),C=n.n(_);var T=function(e,t,n,i){n=function(e){var t=C()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var a=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case y.a.topCenter:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body.clientHeight,r=t.left+t.width/2-i/2,s=t.top-n,l=o-t.bottom-n,c=t.top-n-a,d=t.bottom+n;return{left:r,top:s>=a?c:l>=a?d:s>=50||s>=l?c:d}}(t,n,i);break;case y.a.topRight:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=t.right,c=r-t.left,d=t.right-i,p=t.left,u=void 0;u=l>=i?d:c>=i?p:l>=50||l>=c?d:p;var h=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-a;return{left:u,top:f>=a?v:h>=a||h>=50||h>=f?m:v}}(t,n,i);break;case y.a.topLeft:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=t.right,c=r-t.left,d=t.right-i,p=t.left,u=void 0;u=c>=i?p:l>=i||l>=50||l>=c?d:p;var h=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-a;return{left:u,top:f>=a?v:h>=a||h>=50||h>=f?m:v}}(t,n,i);break;case y.a.bottomLeft:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=r-t.left,c=t.right,d=t.left,p=t.right-i,u=void 0;u=l>=i?d:c>=i?p:l>=50||l>=c?d:p;var h=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-a;return{left:u,top:h>=a?m:f>=a?v:h>=50||h>=f?m:v}}(t,n,i);break;case y.a.bottomRight:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=t.right,c=r-t.left,d=t.right-i,p=t.left,u=void 0;u=l>=i?d:c>=i?p:l>=50||l>=c?d:p;var h=s-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-a;return{left:u,top:h>=a?m:f>=a?v:h>=50||h>=f?m:v}}(t,n,i);break;case y.a.rightBottom:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=r-t.right-n,c=t.left-n,d=t.right+n,p=t.left-n-i,u=void 0;u=l>=i?d:c>=i?p:l>=50||l>=c?d:p;var h=s-t.top,f=t.bottom,m=t.top,v=t.bottom-a;return{left:u,top:h>=a?m:f>=a?v:h>=50||h>=f?m:v}}(t,n,i);break;case y.a.leftBottom:a=function(e,t,n){var i=e.offsetWidth,a=e.offsetHeight,o=document.body,r=o.clientWidth,s=o.clientHeight,l=r-t.right-n,c=t.left-n,d=t.right+n,p=t.left-n-i,u=void 0;u=c>=i?p:l>=i||l>=50||l>=c?d:p;var h=s-t.top,f=t.bottom,m=t.top,v=t.bottom-a;return{left:u,top:h>=a?m:f>=a?v:h>=50||h>=f?m:v}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(a.right=document.body.clientWidth-a.left-t.offsetWidth,delete a.left),a},k=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,a=n.props.triggerElement;!i||i.contains(t)||function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,a=i.pageX,o=i.pageY;return a>=n.left&&a<=n.right&&o>=n.top&&o<=n.bottom}return!1}(a,e)||b.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=f.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return u()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})).observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){this.props.onClose()}},{key:"handleWindowKeyDown",value:function(e){w.getKey(e)===w.Keys.Esc&&(b.b(this.level+1)||(Object(v.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){window.performance.now()-this.timestamp>300&&this.handleClose(e)}},{key:"handleWindowResize",value:function(){m.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose()}},{key:"bindEvents",value:function(){this.observerPanel(),g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var a=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(a>=n.top+n.height/2?"bottom":"top")}(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},a()(t,window.rightToLeft?"right":"left",0),a()(t,"top",0),t),i=this.props,o=i.placement,r=i.rect,s=i.distance,l=i.isAuto,c=i.triggerElement;if(c){var d=c.getBoundingClientRect(),p=d.top,u=d.bottom;r=Object.assign({},r,{top:p,bottom:u})}var h=T(o,e,r,s);return l&&(h=function(e,t){var n=e.left,i=e.right,a=e.top,o=t.offsetWidth,r=t.offsetHeight,s=document.body,l=s.clientWidth,c=s.clientHeight;return window.rightToLeft?(i+o+4>l&&(i=l-o-4),i=Math.max(4,i)):(n+o+4>l&&(n=l-o-4),n=Math.max(4,n)),a+r+4>c&&(a=c-r-4),a=Math.max(4,a),window.rightToLeft?{right:i,top:a}:{left:n,top:a}}(h,e)),Object.assign(n,h),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},a()(n,window.rightToLeft?"right":"left",0),a()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var o=this.props,r=o.distance,s=o.isSetHeight;if(!this.style){this.style=this.createStyle(t),s&&(this.style.height=function(e,t,n){var i=document.body.clientHeight,a=i-e-n;return e<0&&(a=i-2*n),t.offsetHeight<a?void 0:a}(this.style.top,t,r));var l=t.getBoundingClientRect().height;Math.abs(l-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return f.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=b.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,a=e.className,o=this.state.visible,r=null;"function"==typeof t.type&&(r={isListenEvent:o});var s=f.a.cloneElement(t,r),l=this.getPanelStyle(),c=this.getAnimationOrigin(l),d=this.calcTransparentPlaceholder(c),p=b.c;return o&&(this.showAnimation&&(p+=" animation-fade-scaleY-in"),p+=" origin-"+c,a&&(p+=" "+a)),f.a.createElement("div",{ref:this.refPanel,className:p,style:l,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},d,s)}}]),t}(h.PureComponent);k.placementTypes=y.a,k.defaultProps={placement:y.a.bottomLeft,distance:0,offsetX:0,isSetHeight:!1};t.default=k},241:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.className,t="component-menu-divider";return e&&(t+=" "+e),u.a.createElement("div",{className:t})}}]),t}(p.PureComponent);t.default=h},245:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(209),n(142)),u=n.n(p),h=function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"divider-line"})}}]),t}(p.PureComponent);t.a=h},247:function(e,t,n){"use strict";n.r(t);var i=n(44),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=(n(410),n(142)),f=n.n(h),m=n(182),v=n(166),w=n(151),g=n.n(w),y=m.default.Item,b=m.default.Divider,_=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,width:null},n.refSelect=f.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleItemClick=n.handleItemClick.bind(n),n}return u()(t,e),l()(t,[{key:"handleVisibleChange",value:function(e){this.props.onVisibleChange&&this.props.onVisibleChange(e);var t=this.refSelect.current.offsetWidth;this.setState({visible:e,width:t})}},{key:"handleItemClick",value:function(e,t){this.props.onChange(e,t),this.handleVisibleChange(!1)}},{key:"getElement",value:function(){return this.refSelect.current}},{key:"renderItem",value:function(e,t,n){var i=t,o=t;"object"===(void 0===t?"undefined":a()(t))&&(i=t.content,o=t.value);var r=o===n,s=this.props.getItemStyle;return f.a.createElement(y,{key:e.toString(),value:o,getStyle:s,dataKey:o.toString(),selected:r,onClick:this.handleItemClick},i)}},{key:"renderItems",value:function(){var e=this,t=0,n=this.props,i=n.value,a=n.options,o=n.groups;if(a)return a.map((function(n,a){return e.renderItem(++t,n,i,a)}));var r=[];if(o)for(var s=0;s<o.length;s++)o[s].forEach((function(n){return r.push(e.renderItem(++t,n,i))})),s<o.length-1&&r.push(f.a.createElement(b,{key:(++t).toString()}));return r}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.showBorder,i="component-select dropdown";return e.disabled&&(i+=" disabled"),this.state.visible&&(i+=" selected"),n&&(i+=" show-border"),t&&(i+=" "+t),i}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.value,i=e.content,a=e.dropdownClassName,o=e.disabled,r=e.getItemStyle,s=e.onItemHover,l=e.panelClass,c=e.placeholder,d=this.state,p=d.visible,u=d.width,h=this.renderItems(),w=i||n,y=f.a.classNames({content:1,placeholder:!w&&c}),b="component-select-panel";a&&(b+=" "+a);var _=f.a.createElement(m.default,{className:b,minWidth:u,onItemHover:s},h),C=this.getClassName(),T=r?r(n):null;return f.a.createElement(v.default,{isSetHeight:!0,panel:_,visible:p,panelClass:l,disabled:o,onVisibleChange:this.handleVisibleChange},f.a.createElement(g.a,{title:t},f.a.createElement("div",{ref:this.refSelect,className:C,style:T},f.a.createElement("span",{className:y},w||c))))}}]),t}(h.PureComponent);t.default=_},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canRequestForAuthForSecurityDoc=t.requestForAuth=t.isPrintLimitedSecurityDoc=t.isCopyLimitedSecurityDoc=t.isEditLimitedSecurityDoc=t.isSupportSecurityDoc=t.AUTH_TYPES=void 0;var i=(0,n(143).__importDefault)(n(162)),a={EDIT:"edit",COPY:"copy",PRINT:"print",SAVE_AS:"saveAs"};t.AUTH_TYPES=a;var o={pluginType:window.__WPSPLUGIN__.helper.types.SecureDocApplyAuth};var r=[i.default.writer,i.default.spreadsheet,i.default.presentation].includes(window.officeType);t.isSupportSecurityDoc=r,t.isEditLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canEdit()},t.isCopyLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canCopy()},t.isPrintLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canPrint()},t.requestForAuth=function(e){return void 0===e&&(e={type:a.EDIT}),window.__WPSPLUGIN__.loader.loadSingleInstance(o).then((function(t){return t.show(e.type)}))};var s=r&&!!window.__WPSPLUGIN__.loader.search(o);t.canRequestForAuthForSecurityDoc=s},2673:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(154),d=n.n(c),p=n(42),u=n.n(p),h=n(142),f=n.n(h),m=n(179),v=n(156);var w=window.rightToLeft;var g=n(697),y=window.CommandBarComponent.cmbIds.wpp,b=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateTabWrap=function(){var e=n.props,t=e.visible,i=e.tabKey;if(t){var a=n.wrapRef&&n.wrapRef.current;i===y.InsertTab?function(e){var t=e&&e.refWrap&&e.refWrap.current,n=w?"paddingRight":"paddingLeft",i=function(){return t.style[n]&&(t.style[n]="")};if(e&&t){var a=e.getItemsWidth(),o=a.wrapWidth,r=a.allItemWidth;if(o>r){var s=document.body.clientWidth/2,l=o-r,c=383+r/2,d=Math.min(s-c,l/2)+24;c<s?t.style[n]=d+"px":i()}else i();e.handleWindowResize()}}(a):function(e){var t=e&&e.refWrap&&e.refWrap.current;if(e&&t){var n=e.getItemsWidth(),i=n.wrapWidth,a=n.allItemWidth;if(i>a){var o=i-a;t.style.cssText="padding-"+(window.rightToLeft?"right":"left")+": 0px; \n                padding-"+(window.rightToLeft?"left":"right")+": \n                "+(o>99?99:o)+"px"}else t.style.paddingRight="",t.style.paddingLeft="";e.handleWindowResize()}}(a)}},n.handleWindowResize=function(){n.debounceUpdateTabWrap()},n.debounceUpdateTabWrap=Object(v.debounce)((function(){n.updateTabWrap()}),300),n.handleSlideCountChange=function(){var e=n.slideCount;n.setState({hasSlide:!!e})},n.handleOnline=function(){n.handleNetWork(!0)},n.handleOffline=function(){n.handleNetWork(!1)},n.handleModeChange=function(){var e=n.shell.doc.getMode();e!==g.ViewModes.MasterView&&e!==g.ViewModes.EditView||n.handleSlideCountChange()},n.wrapRef=f.a.createRef(),n.state={connected:!1,isOnline:!1},n}return u()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(this.viewEventTypes.THUMBNAIL_UPDATE,this.handleSlideCountChange),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("offline",this.handleOffline),window.addEventListener("online",this.handleOnline),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.handleSlideCountChange),this.handleSlideCountChange(),this.observerPanel()}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.THUMBNAIL_UPDATE,this.handleSlideCountChange),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("offline",this.handleOffline),window.removeEventListener("online",this.handleOnline),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange)}},{key:"componentDidUpdate",value:function(){d()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.updateTabWrap()}},{key:"observerPanel",value:function(){var e=this,t=this.wrapRef.current&&this.wrapRef.current.refItems.current;t&&(this.panelW=t.clientWidth,new MutationObserver((function(){var n=t.clientWidth;e.panelW!==n&&(e.panelW=n,e.handleWindowResize(t.childElementCount))})).observe(t,{childList:!0,subtree:!0}))}},{key:"getCmdClassName",value:function(e){return"cmd-bar-wrap"+(e?"":" disabled")}},{key:"handleNetWork",value:function(e){this.setState({connected:e})}},{key:"render",value:function(){return null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.connected!==t.connected||e.isOnline!==t.isOnline?{connected:e.connected,isOnline:e.isOnline}:null}}]),t}(m.BaseComponent);t.a=b},295:function(e,t,n){},310:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(448),n(142)),u=n.n(p),h=function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.className,t="component-divider";return e&&(t+=" "+e),u.a.createElement("div",{className:t})}}]),t}(p.PureComponent);t.default=h},336:function(e,t,n){"use strict";n.r(t),n.d(t,"auditText",(function(){return a}));var i=n(498),a=function(e){var t={text:e,fileId:window.fileInfo.id};return{types:i.a.HTTP_TYPES,callAPI:function(e){return e.post("/api/v3/office/comment/create").send(t).end()}}}},353:function(e,t,n){},362:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var i={button:"button",dropdown:"dropdown"};function a(e){return e?{backgroundImage:"url("+e+")"}:null}},3656:function(e,t,n){e.exports=function(e,t){n.e(315).then(n.bind(null,4599)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},370:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n(379),a=function(e){return e.clientId=window.RPCClient.clientID,{types:i.a.HTTP_TYPES,callAPI:function(t){return t.post("/api/v3/office/file/"+window.urlFileId+"/export").send(e).end()}}},o=function(e){return e.clientId=window.RPCClient.clientID,{types:i.a.HTTP_TYPES,callAPI:function(t){return t.post("/api/v3/office/file/"+window.urlFileId+"/export").send(e).end()}}}},377:function(e,t,n){"use strict";n.r(t);n(590);var i=n(144),a=n(0),o=n.n(a),r=n(3),s=n.n(r),l=n(25),c=n.n(l),d=n(42),p=n.n(d),u=n(142),h=n.n(u),f=n(168),m=n.n(f),v=n(166),w=n(148),g=function(e){function t(){return o()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.iconContent,a=e.disabled,o=e.iconType,r=e.visible,s=e.onVisibleChange,l=this.getClassName();return h.a.createElement(v.default,{visible:r,panel:n,disabled:a,onVisibleChange:s},h.a.createElement("div",{ref:this.refWrap,id:t,className:l},h.a.createElement("div",{className:"left-btn"},o&&h.a.createElement(w.default,{type:o}),i),h.a.createElement("div",{className:"right-btn"})))}}]),t}(n(421).a);g.propTypes={id:m.a.string,visible:m.a.bool.isRequired,className:m.a.string,disabled:m.a.bool,title:m.a.oneOfType([m.a.object,m.a.string]),iconType:m.a.string,iconContent:m.a.oneOfType([m.a.object,m.a.string]),onIconClick:m.a.func,iconSelected:m.a.bool,onVisibleChange:m.a.func.isRequired};var y=g,b=n(569),_=i.isPad?y:b.default;t.default=_},3833:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return u}));var i,a,o=n(150),r=n.n(o),s=n(158),l=(i={},r()(i,s.WpActionType.ActionFirstSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.firstSlide", "第一页幻灯片")),r()(i,s.WpActionType.ActionLastSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.lastSlide", "最后一页幻灯片")),r()(i,s.WpActionType.ActionPreviousSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.previousSlide", "上一页幻灯片")),r()(i,s.WpActionType.ActionNextSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.nextSlide", "下一页幻灯片")),i),c=(a={},r()(a,s.LinkType.web,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.webPage", "网页")),r()(a,s.LinkType.slideRlt,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slide", "幻灯片")),r()(a,s.LinkType.slideAsl,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slide", "幻灯片")),r()(a,s.LinkType.email,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.email", "邮箱")),a),d=[{content:c[s.LinkType.web],value:s.LinkType.web},{content:c[s.LinkType.slideRlt],value:s.LinkType.slideRlt},{content:c[s.LinkType.email],value:s.LinkType.email}],p=[{content:l[s.WpActionType.ActionFirstSlide],value:s.WpActionType.ActionFirstSlide},{content:l[s.WpActionType.ActionLastSlide],value:s.WpActionType.ActionLastSlide},{content:l[s.WpActionType.ActionPreviousSlide],value:s.WpActionType.ActionPreviousSlide},{content:l[s.WpActionType.ActionNextSlide],value:s.WpActionType.ActionNextSlide}],u=function(e){return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)}},3834:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={InsertDiagram:"InsertDiagram",TextBox:"TextBox",Picture:"Picture",InsertGeomerty:"InsertGeomerty",Table:"Table",FlowChart:"FlowChart",MindMap:"MindMap",InsertHyperlink:"InsertHyperlink",LatexMath:"LatexMath",Media:"Media",InsertSymbol:"InsertSymbol",QRCode:"QRCode",Material:"Material",Chart:"Chart",Divider:"Divider"}},3835:function(e,t,n){"use strict";var i=n(158),a=[{groupId:i.ShapeGroupType.LineGroup,items:[{value:"line",title:_i18n("applications.presentation.constants.insert_geometry_define.line", "直线 (L)"),type:0},{value:"straightConnector1",title:_i18n("applications.presentation.constants.insert_geometry_define.straightConnector1", "箭头"),type:95},{value:"straightConnector2",title:_i18n("applications.presentation.constants.insert_geometry_define.straightConnector2", "双箭头"),type:95},{value:"bentConnector2",title:_i18n("applications.presentation.constants.insert_geometry_define.bentConnector2", "肘形连接符"),type:97},{value:"bentConnector3",title:_i18n("applications.presentation.constants.insert_geometry_define.bentConnector3", "肘形箭头连接符 (C)"),type:97},{value:"bentConnector4",title:_i18n("applications.presentation.constants.insert_geometry_define.bentConnector4", "肘形双箭头连接符"),type:97},{value:"curvedConnector2",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedConnector2", "曲线连接符"),type:101},{value:"curvedConnector3",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedConnector3", "曲线箭头连接符"),type:101},{value:"curvedConnector4",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedConnector4", "曲线双箭头连接符"),type:101},{value:"freeCurve",title:_i18n("applications.presentation.constants.insert_geometry_define.freeCurve", "自由曲线"),type:231}]},{groupId:i.ShapeGroupType.RectangleGroup,items:[{value:"rect",title:_i18n("applications.presentation.constants.insert_geometry_define.rect", "矩形 (R)"),type:4},{value:"roundRect",title:_i18n("applications.presentation.constants.insert_geometry_define.roundRect", "圆角矩形"),type:25},{value:"snip1Rect",title:_i18n("applications.presentation.constants.insert_geometry_define.snip1Rect", "剪去单角的矩形"),type:30},{value:"snip2SameRect",title:_i18n("applications.presentation.constants.insert_geometry_define.snip2SameRect", "剪去同侧角的矩形"),type:31},{value:"snip2DiagRect",title:_i18n("applications.presentation.constants.insert_geometry_define.snip2DiagRect", "剪去对角的矩形"),type:32},{value:"snipRoundRect",title:_i18n("applications.presentation.constants.insert_geometry_define.snipRoundRect", "单圆角矩形1"),type:29},{value:"round1Rect",title:_i18n("applications.presentation.constants.insert_geometry_define.round1Rect", "单圆角矩形２"),type:26},{value:"round2SameRect",title:_i18n("applications.presentation.constants.insert_geometry_define.round2SameRect", "同侧圆角矩形"),type:27},{value:"round2DiagRect",title:_i18n("applications.presentation.constants.insert_geometry_define.round2DiagRect", "对角圆角矩形"),type:28}]},{groupId:i.ShapeGroupType.NormalGroup,items:[{value:"textBoxHorizontal",title:_i18n("applications.presentation.constants.insert_geometry_define.textBoxHorizontal", "文本框"),type:4},{value:"textBoxVertical",title:_i18n("applications.presentation.constants.insert_geometry_define.textBoxVertical", "垂直文本框"),type:4},{value:"ellipse",title:_i18n("applications.presentation.constants.insert_geometry_define.ellipse", "椭圆 (O)"),type:34},{value:"triangle",title:_i18n("applications.presentation.constants.insert_geometry_define.triangle", "等腰三角形"),type:2},{value:"rtTriangle",title:_i18n("applications.presentation.constants.insert_geometry_define.rtTriangle", "直角三角形"),type:3},{value:"parallelogram",title:_i18n("applications.presentation.constants.insert_geometry_define.parallelogram", "平行四边形"),type:6},{value:"trapezoid",title:_i18n("applications.presentation.constants.insert_geometry_define.trapezoid", "梯形"),type:7},{value:"diamond",title:_i18n("applications.presentation.constants.insert_geometry_define.diamond", "菱形"),type:5},{value:"pentagon",title:_i18n("applications.presentation.constants.insert_geometry_define.pentagon", "正五边形"),type:9},{value:"hexagon",title:_i18n("applications.presentation.constants.insert_geometry_define.hexagon", "六边形"),type:10},{value:"heptagon",title:_i18n("applications.presentation.constants.insert_geometry_define.heptagon", "七边形"),type:11},{value:"octagon",title:_i18n("applications.presentation.constants.insert_geometry_define.octagon", "八边形"),type:12},{value:"decagon",title:_i18n("applications.presentation.constants.insert_geometry_define.decagon", "十边形"),type:13},{value:"dodecagon",title:_i18n("applications.presentation.constants.insert_geometry_define.dodecagon", "十二边形"),type:14},{value:"pie",title:_i18n("applications.presentation.constants.insert_geometry_define.pie", "饼形"),type:39},{value:"chord",title:_i18n("applications.presentation.constants.insert_geometry_define.chord", "弦形"),type:87},{value:"teardrop",title:_i18n("applications.presentation.constants.insert_geometry_define.teardrop", "泪滴形"),type:35},{value:"frame",title:_i18n("applications.presentation.constants.insert_geometry_define.frame", "图文框"),type:83},{value:"halfFrame",title:_i18n("applications.presentation.constants.insert_geometry_define.halfFrame", "半闭框"),type:84},{value:"corner",title:_i18n("applications.presentation.constants.insert_geometry_define.corner", "L形"),type:85},{value:"diagStripe",title:_i18n("applications.presentation.constants.insert_geometry_define.diagStripe", "斜纹"),type:86},{value:"plus",title:_i18n("applications.presentation.constants.insert_geometry_define.plus", "十字形"),type:130},{value:"plaque",title:_i18n("applications.presentation.constants.insert_geometry_define.plaque", "缺角矩形"),type:33},{value:"can",title:_i18n("applications.presentation.constants.insert_geometry_define.can", "圆柱形"),type:73},{value:"cube",title:_i18n("applications.presentation.constants.insert_geometry_define.cube", "立方体"),type:72},{value:"bevel",title:_i18n("applications.presentation.constants.insert_geometry_define.bevel", "棱台"),type:82},{value:"donut",title:_i18n("applications.presentation.constants.insert_geometry_define.donut", "同心圆"),type:41},{value:"noSmoking",title:_i18n("applications.presentation.constants.insert_geometry_define.noSmoking", "禁止符"),type:42},{value:"blockArc",title:_i18n("applications.presentation.constants.insert_geometry_define.blockArc", "空心弧"),type:40},{value:"foldedCorner",title:_i18n("applications.presentation.constants.insert_geometry_define.foldedCorner", "折角形"),type:81},{value:"smileyFace",title:_i18n("applications.presentation.constants.insert_geometry_define.smileyFace", "笑脸"),type:78},{value:"heart",title:_i18n("applications.presentation.constants.insert_geometry_define.heart", "心形"),type:75},{value:"lightningBolt",title:_i18n("applications.presentation.constants.insert_geometry_define.lightningBolt", "闪电形"),type:74},{value:"sun",title:_i18n("applications.presentation.constants.insert_geometry_define.sun", "太阳形"),type:76},{value:"moon",title:_i18n("applications.presentation.constants.insert_geometry_define.moon", "新月形"),type:77},{value:"cloud",title:_i18n("applications.presentation.constants.insert_geometry_define.cloud", "云形"),type:120},{value:"arc",title:_i18n("applications.presentation.constants.insert_geometry_define.arc", "弧形"),type:88},{value:"bracketPair",title:_i18n("applications.presentation.constants.insert_geometry_define.bracketPair", "双括号"),type:93},{value:"bracePair",title:_i18n("applications.presentation.constants.insert_geometry_define.bracePair", "双大括号"),type:94},{value:"leftBracket",title:_i18n("applications.presentation.constants.insert_geometry_define.leftBracket", "左中括号"),type:89},{value:"rightBracket",title:_i18n("applications.presentation.constants.insert_geometry_define.rightBracket", "右中括号"),type:90},{value:"leftBrace",title:_i18n("applications.presentation.constants.insert_geometry_define.leftBrace", "左大括号"),type:91},{value:"rightBrace",title:_i18n("applications.presentation.constants.insert_geometry_define.rightBrace", "右大括号"),type:92}]},{groupId:i.ShapeGroupType.ArrowGroup,items:[{value:"rightArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.rightArrow", "右箭头"),type:43},{value:"leftArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.leftArrow", "左箭头"),type:44},{value:"upArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.upArrow", "上箭头"),type:45},{value:"downArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.downArrow", "下箭头"),type:46},{value:"leftRightArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.leftRightArrow", "左右箭头"),type:50},{value:"upDownArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.upDownArrow", "上下箭头"),type:51},{value:"quadArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.quadArrow", "十字箭头"),type:54},{value:"leftRightUpArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.leftRightUpArrow", "丁字箭头"),type:53},{value:"bentArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.bentArrow", "圆角右箭头"),type:62},{value:"uturnArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.uturnArrow", "手杖形箭头"),type:63},{value:"leftUpArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.leftUpArrow", "直角双向箭头"),type:52},{value:"bentUpArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.bentUpArrow", "直角上箭头"),type:49},{value:"curvedRightArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedRightArrow", "左弧形箭头"),type:67},{value:"curvedLeftArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedLeftArrow", "右弧形箭头"),type:68},{value:"curvedUpArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedUpArrow", "下弧形箭头"),type:69},{value:"curvedDownArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.curvedDownArrow", "上弧形箭头"),type:70},{value:"stripedRightArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.stripedRightArrow", "虚尾箭头"),type:47},{value:"notchedRightArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.notchedRightArrow", "燕尾形箭头"),type:48},{value:"homePlate",title:_i18n("applications.presentation.constants.insert_geometry_define.homePlate", "五边形"),type:36},{value:"chevron",title:_i18n("applications.presentation.constants.insert_geometry_define.chevron", "燕尾形"),type:37},{value:"rightArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.rightArrowCallout", "右箭头标注"),type:56},{value:"leftArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.leftArrowCallout", "左箭头标注"),type:55},{value:"upArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.upArrowCallout", "上箭头标注"),type:57},{value:"downArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.downArrowCallout", "下箭头标注"),type:58},{value:"leftRightArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.leftRightArrowCallout", "左右箭头标注"),type:59},{value:"quadArrowCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.quadArrowCallout", "十字箭头标注"),type:61},{value:"circularArrow",title:_i18n("applications.presentation.constants.insert_geometry_define.circularArrow", "环形箭头"),type:64}]},{groupId:i.ShapeGroupType.FormulaGroup,items:[{value:"mathPlus",title:_i18n("applications.presentation.constants.insert_geometry_define.mathPlus", "加号"),type:175},{value:"mathMinus",title:_i18n("applications.presentation.constants.insert_geometry_define.mathMinus", "减号"),type:176},{value:"mathMultiply",title:_i18n("applications.presentation.constants.insert_geometry_define.mathMultiply", "乘号"),type:177},{value:"mathDivide",title:_i18n("applications.presentation.constants.insert_geometry_define.mathDivide", "除号"),type:178},{value:"mathEqual",title:_i18n("applications.presentation.constants.insert_geometry_define.mathEqual", "等于号"),type:179},{value:"mathNotEqual",title:_i18n("applications.presentation.constants.insert_geometry_define.mathNotEqual", "不等于号"),type:180}]},{groupId:i.ShapeGroupType.ProcessGroup,items:[{value:"flowChartProcess",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartProcess", "流程图:过程"),type:131},{value:"flowChartAlternateProcess",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartAlternateProcess", "流程图:可选过程"),type:158},{value:"flowChartDecision",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartDecision", "流程图:决策"),type:132},{value:"flowChartInputOutput",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartInputOutput", "流程图:数据"),type:133},{value:"flowChartPredefinedProcess",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartPredefinedProcess", "流程图:预定义过程"),type:134},{value:"flowChartInternalStorage",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartInternalStorage", "流程图:内部贮存"),type:135},{value:"flowChartDocument",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartDocument", "流程图:文档"),type:136},{value:"flowChartMultidocument",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartMultidocument", "流程图:多文档"),type:137},{value:"flowChartTerminator",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartTerminator", "流程图:终止"),type:138},{value:"flowChartPreparation",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartPreparation", "流程图:准备"),type:139},{value:"flowChartManualInput",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartManualInput", "流程图:手动输入"),type:140},{value:"flowChartManualOperation",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartManualOperation", "流程图:手动操作"),type:141},{value:"flowChartConnector",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartConnector", "流程图:联系"),type:142},{value:"flowChartOffpageConnector",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartOffpageConnector", "流程图:离页连接符"),type:159},{value:"flowChartPunchedCard",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartPunchedCard", "流程图:卡片"),type:143},{value:"flowChartPunchedTape",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartPunchedTape", "流程图:资料带"),type:144},{value:"flowChartSummingJunction",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartSummingJunction", "流程图:汇总连接"),type:145},{value:"flowChartOr",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartOr", "流程图:或者"),type:146},{value:"flowChartCollate",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartCollate", "流程图:对照"),type:147},{value:"flowChartSort",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartSort", "流程图:排序"),type:148},{value:"flowChartExtract",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartExtract", "流程图:摘录"),type:149},{value:"flowChartMerge",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartMerge", "流程图:合并"),type:150},{value:"flowChartOnlineStorage",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartOnlineStorage", "流程图:库存数据"),type:152},{value:"flowChartDelay",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartDelay", "流程图:延期"),type:157},{value:"flowChartMagneticTape",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartMagneticTape", "流程图:顺序访问存储器"),type:153},{value:"flowChartMagneticDisk",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartMagneticDisk", "流程图:磁盘"),type:154},{value:"flowChartMagneticDrum",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartMagneticDrum", "流程图:直接访问存储器"),type:155},{value:"flowChartDisplay",title:_i18n("applications.presentation.constants.insert_geometry_define.flowChartDisplay", "流程图:显示"),type:156}]},{groupId:i.ShapeGroupType.StarAndFlagGroup,items:[{value:"irregularSeal1",title:_i18n("applications.presentation.constants.insert_geometry_define.irregularSeal1", "爆炸形1"),type:79},{value:"irregularSeal2",title:_i18n("applications.presentation.constants.insert_geometry_define.irregularSeal2", "爆炸形2"),type:80},{value:"star4",title:_i18n("applications.presentation.constants.insert_geometry_define.star4", "十字星"),type:15},{value:"star5",title:_i18n("applications.presentation.constants.insert_geometry_define.star5", "五角星"),type:16},{value:"star6",title:_i18n("applications.presentation.constants.insert_geometry_define.star6", "六角星"),type:17},{value:"star7",title:_i18n("applications.presentation.constants.insert_geometry_define.star7", "七角星"),type:18},{value:"star8",title:_i18n("applications.presentation.constants.insert_geometry_define.star8", "八角星"),type:19},{value:"star10",title:_i18n("applications.presentation.constants.insert_geometry_define.star10", "十角星"),type:20},{value:"star12",title:_i18n("applications.presentation.constants.insert_geometry_define.star12", "十二角星"),type:21},{value:"star16",title:_i18n("applications.presentation.constants.insert_geometry_define.star16", "十六角星"),type:22},{value:"star24",title:_i18n("applications.presentation.constants.insert_geometry_define.star24", "二十四角星"),type:23},{value:"star32",title:_i18n("applications.presentation.constants.insert_geometry_define.star32", "三十二角星"),type:24},{value:"ribbon2",title:_i18n("applications.presentation.constants.insert_geometry_define.ribbon2", "上凸带形"),type:122},{value:"ribbon",title:_i18n("applications.presentation.constants.insert_geometry_define.ribbon", "前凸带形"),type:121},{value:"ellipseRibbon2",title:_i18n("applications.presentation.constants.insert_geometry_define.ellipseRibbon2", "上凸弯带形"),type:124},{value:"ellipseRibbon",title:_i18n("applications.presentation.constants.insert_geometry_define.ellipseRibbon", "前凸弯带形"),type:123},{value:"verticalScroll",title:_i18n("applications.presentation.constants.insert_geometry_define.verticalScroll", "竖卷轴"),type:126},{value:"horizontalScroll",title:_i18n("applications.presentation.constants.insert_geometry_define.horizontalScroll", "横卷形"),type:127},{value:"wave",title:_i18n("applications.presentation.constants.insert_geometry_define.wave", "波形"),type:128},{value:"doubleWave",title:_i18n("applications.presentation.constants.insert_geometry_define.doubleWave", "双波形"),type:129}]},{groupId:i.ShapeGroupType.CalloutGroup,items:[{value:"wedgeRectCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.wedgeRectCallout", "矩形标注"),type:116},{value:"wedgeRoundRectCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.wedgeRoundRectCallout", "圆角矩形标注"),type:117},{value:"wedgeEllipseCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.wedgeEllipseCallout", "椭圆形标注"),type:118},{value:"cloudCallout",title:_i18n("applications.presentation.constants.insert_geometry_define.cloudCallout", "云形标注"),type:119},{value:"borderCallout1",title:_i18n("applications.presentation.constants.insert_geometry_define.borderCallout1", "线形标注1"),type:110},{value:"borderCallout2",title:_i18n("applications.presentation.constants.insert_geometry_define.borderCallout2", "线形标注2"),type:111},{value:"borderCallout3",title:_i18n("applications.presentation.constants.insert_geometry_define.borderCallout3", "线形标注3"),type:112},{value:"accentCallout1",title:_i18n("applications.presentation.constants.insert_geometry_define.accentCallout1", "线形标注1(带强调线)"),type:107},{value:"accentCallout2",title:_i18n("applications.presentation.constants.insert_geometry_define.accentCallout2", "线形标注2(带强调线)"),type:108},{value:"accentCallout3",title:_i18n("applications.presentation.constants.insert_geometry_define.accentCallout3", "线形标注3(带强调线)"),type:109},{value:"callout1",title:_i18n("applications.presentation.constants.insert_geometry_define.callout1", "线形标注1(无边框)"),type:104},{value:"callout2",title:_i18n("applications.presentation.constants.insert_geometry_define.callout2", "线形标注2(无边框)"),type:105},{value:"callout3",title:_i18n("applications.presentation.constants.insert_geometry_define.callout3", "线形标注3(无边框)"),type:106},{value:"accentBorderCallout1",title:_i18n("applications.presentation.constants.insert_geometry_define.accentBorderCallout1", "线形标注1(带边框和强调线)"),type:113},{value:"accentBorderCallout2",title:_i18n("applications.presentation.constants.insert_geometry_define.accentBorderCallout2", "线形标注2(带边框和强调线)"),type:114},{value:"accentBorderCallout3",title:_i18n("applications.presentation.constants.insert_geometry_define.accentBorderCallout3", "线形标注3(带边框和强调线)"),type:115}]}];t.a=a},3836:function(e,t,n){"use strict";var i=n(152),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=n(142),f=n.n(h),m=n(725),v=n(156),w=(n(3837),function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=n.onMouseEnter.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return u()(t,e),l()(t,[{key:"onMouseEnter",value:function(){var e=this.props,t=e.row,n=e.column;this.props.onActive({row:t,column:n})}},{key:"onMouseUp",value:function(e){var t=this.props,n=t.row,i=t.column;e.button===m.MouseButton.left&&this.props.onSelect({row:n,column:i})}},{key:"render",value:function(){var e=this.props,t=e.row,n=e.column,i=e.activeRow,a=e.activeColumn,o="cell "+(t<=i&&n<=a?"active":"");return f.a.createElement("div",{className:o,key:n,onMouseEnter:this.onMouseEnter,onMouseUp:this.onMouseUp})}}]),t}(h.PureComponent)),g=function(e){function t(e){return r()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),l()(t,[{key:"renderCells",value:function(){for(var e=this.props,t=e.row,n=e.activeRow,i=e.activeColumn,a=e.adjust,o=a?10:Math.max(10,Math.min(10,i+1)),r=[],s=1;s<=o;++s)r.push(f.a.createElement(w,{row:t,column:s,key:s,activeRow:n,activeColumn:i,adjust:a,onActive:this.props.onActive,onSelect:this.props.onSelect}));return r}},{key:"render",value:function(){return f.a.createElement("div",{className:"row"},this.renderCells())}}]),t}(h.PureComponent),y=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeRow:0,activeColumn:0},n.touchToActive=function(e){n.elementRectCache||(n.elementRectCache={rows:[]});var t=e.touches||e.changedTouches||[],i=a()(t,1)[0];if(i){if(!n.elementRectCache.content){var o=n.panel.querySelector(".content");n.elementRectCache.content={innerOffsetX:o.offsetLeft,innerOffsetY:o.offsetTop,width:o.clientWidth,height:o.clientHeight}}var r=n.elementRectCache.content,s=r.innerOffsetX,l=r.innerOffsetY,c=r.width,d=r.height;if(!n.elementRectCache.panel){var p=n.panel.getBoundingClientRect();n.elementRectCache.panel={offsetX:p.x,offsetY:p.y}}for(var u=n.elementRectCache.panel,h=u.offsetX,f=u.offsetY,m=Math.max(s,Math.min(i.clientX-h,s+c)),v=Math.max(l,Math.min(i.clientY-f,l+d)),w=n.panel.querySelectorAll(".row"),g=0,y=w.length;g<y;g++){var b=w[g];n.elementRectCache.rows[g]||(n.elementRectCache.rows[g]={cells:[],rowX:b.offsetLeft,rowY:b.offsetTop,rowWidth:b.clientWidth,rowHeight:b.clientHeight});var _=n.elementRectCache.rows[g],C=_.rowX,T=_.rowY,k=_.rowWidth,E=_.rowHeight;if(m>=C&&m<=C+k&&v>=T&&v<=T+E)for(var S=b.children,P=0,R=S.length;P<R;P++){var O=S[P];n.elementRectCache.rows[g].cells[P]||(n.elementRectCache.rows[g].cells[P]={cellX:O.offsetLeft,cellY:O.offsetTop,cellWidth:O.scrollWidth,cellHeight:O.scrollHeight});var I=n.elementRectCache.rows[g].cells[P],B=I.cellX,N=I.cellY,M=I.cellWidth,D=I.cellHeight;m>=B&&m<=B+M&&v>=N&&v<=N+D&&n.onActive({row:g+1,column:P+1})}}}},n.onTouchStart=function(e){n.touchToActive(e)},n.onTouchMove=function(e){n.touchToActive(e)},n.throttleTouchMove=Object(v.throttle)(n.onTouchMove,50,{trailing:!1}),n.onTouchEnd=function(e){e.preventDefault();var t=n.state,i=t.activeRow,a=t.activeColumn;0!==i&&0!==a&&n.onSelect({row:i,column:a})},n.onActive=n.onActive.bind(n),n.onSelect=n.onSelect.bind(n),n}return u()(t,e),l()(t,[{key:"onActive",value:function(e){var t=e.row,n=e.column;this.setState({activeRow:t,activeColumn:n})}},{key:"onSelect",value:function(e){var t=e.row,n=e.column;this.props.onSelect(t,n)}},{key:"renderRows",value:function(){for(var e=this.props.adjust,t=this.state,n=t.activeRow,i=t.activeColumn,a=e?10:Math.max(10,Math.min(10,n+1)),o=[],r=1;r<=a;++r)o.push(f.a.createElement(g,{row:r,key:r,activeRow:n,activeColumn:i,adjust:e,onActive:this.onActive,onSelect:this.onSelect}));return o}},{key:"render",value:function(){var e=this,t=this.state,n=t.activeRow,i=t.activeColumn,a=n&&i?n+"x"+i+" "+_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.table", "表格"):_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.insertTable", "表格"),o=this.renderRows();return f.a.createElement("div",{ref:function(t){return e.panel=t},className:"component-table-panel"},f.a.createElement("div",{className:"title"},a),f.a.createElement("div",{className:"content",onTouchStart:this.onTouchStart,onTouchMove:this.throttleTouchMove,onTouchEnd:this.onTouchEnd},o))}}]),t}(h.PureComponent);t.a=y},3837:function(e,t,n){},384:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(485),n(142)),u=n.n(p),h=n(145),f=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n}return d()(t,e),r()(t,[{key:"handleClick",value:function(){this.props.onClick(this.props.tabKey)}},{key:"render",value:function(){var e=this.props,t=e.children,n="tab-name";return e.selected&&(n+=" tab-name-selected"),e.disabled&&(n+=" disabled"),u.a.createElement("div",{className:n,onClick:this.handleClick},t)}}]),t}(p.PureComponent),m=n(449),v=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.refTabList=u.a.createRef(),n.handleTabNameClick=n.handleTabNameClick.bind(n);var i=n.getTabNames(e.children);return n.state={tabNames:i,paneStyle:null,barStyle:null,officeType:Object(h.getPageOfficeType)()},n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.setActiveKey(this.props.activeKey)}},{key:"componentDidUpdate",value:function(e,t){var n=this;if(e!==this.props){var i=this.props,a=i.activeKey,o=i.children,r=e.activeKey,s=t.tabNames,l=this.getTabNames(o);this.setState({tabNames:l},(function(){n.checkTabChange(a,l,r,s)&&n.setActiveKey(a)}))}}},{key:"getTabNames",value:function(e){var t=[];return u.a.Children.map(e,(function(e){if(e&&e.props.visible){var n=e.props,i=n.tabKey,a=n.tab,o=n.disabled;t.push({tabKey:i,tab:a,disabled:o})}})),t}},{key:"handleTabNameClick",value:function(e){var t=this;e!==this.props.activeKey&&this.setActiveKey(e,(function(){t.props.onChange(e)}))}},{key:"checkTabChange",value:function(e,t,n,i){if(e!==n||t.length!==i.length)return!0;for(var a=0;a<t.length;a++){var o=t[a],r=i[a];if(o.tab!==r.tab)return!0}return!1}},{key:"setActiveKey",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.getTabIndex(e),i=this.refTabList.current.getElementsByClassName("tab-name"),a=0,o=0;o<=n;o++){var r=i[o],s=getComputedStyle(r);a+=o===n?parseFloat(window.rightToLeft?s.marginRight:s.marginLeft):r.offsetWidth+parseFloat(s.marginLeft)+parseFloat(s.marginRight)}var l=this.props.destroyOnHide,c={marginLeft:"-"+100*n+"%"},d={marginLeft:a,width:i[n].offsetWidth};window.rightToLeft&&(c={marginRight:"-"+100*n+"%"},d={marginRight:a,width:i[n].offsetWidth}),l&&(c=null),this.setState({activeKey:e,paneStyle:c,barStyle:d},t)}},{key:"getTabIndex",value:function(e){for(var t=this.state.tabNames,n=0;n<t.length;n++)if(t[n].tabKey===e)return n;return 0}},{key:"render",value:function(){var e=this,t=this.state,n=t.paneStyle,i=t.barStyle,a=t.officeType,o=this.props,r=o.children,s=o.activeKey,l=o.disabled,c=o.destroyOnHide,d=o.className,p=o.keepEdit,h=this.state.tabNames.map((function(t){return u.a.createElement(f,{tabKey:t.tabKey,selected:t.tabKey===s,key:t.tabKey,disabled:t.disabled,onClick:e.handleTabNameClick},t.tab)}));r=u.a.Children.map(r,(function(e){if(e)return u.a.cloneElement(e,{destroyOnHide:c,active:s===e.props.tabKey})}));var m="component-tabs "+a;return l&&(m+=" disabled"),d&&(m+=" "+d),u.a.createElement("div",{"data-keep-edit":p,className:m},u.a.createElement("div",{className:"tab-name-list"},u.a.createElement("div",{className:"tab-name-container"},u.a.createElement("div",{ref:this.refTabList},h),!!s&&u.a.createElement("div",{className:"tabs-ink-bar",style:i}))),u.a.createElement("div",{className:"tabs-pane-container",style:n},r))}}]),t}(p.PureComponent);v.TabPane=m.default;t.default=v},390:function(e,t,n){"use strict";var i=n(26),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=(n(545),n(142)),f=n.n(h),m=n(144),v=n(146),w=n(155),g=n(191),y=n(750),b=w.default.iconTypes.size16,_=function(e){function t(){var e,n,i,a;r()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={didMount:!1,left:void 0,right:void 0,top:void 0,bottom:void 0},i.handleCloseModal=function(){i.props.visible&&i.props.isExclusive&&i.props.onClose()},i.handleKeyDown=function(e){!i.props.visible||"Escape"!==e.code&&27!==e.keyCode||i.props.onClose(e)},i.handleWindowResize=function(){i.props.visible&&(m.isTouchScreen?i.forceUpdate():i.fullDisplay(!0))},i.handleTouchStart=function(e){1===e.touches.length&&i.handleDragModal(e,!0)},i.handleDragModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.refTitle.current,a=i.refContainer.current,o=e.target,r=o.tagName;if("TEXTAREA"!==r&&"INPUT"!==r&&"true"!==o.contentEditable&&a.contains(o)){var s=i.props.isAllDrag;if(s||(s=o.classList&&o.classList.contains("drag")),s||(s=!!n&&n.contains(e.target)),s){var l=i.props.retainSize,c=function(e,t){if(e&&i.setState(e),i.props.onDragMove){var n=!e;i.props.onDragMove(n,t)}};y.onDragMove(e,a,l,c,t)}}},i.refContainer=f.a.createRef(),i.refTitle=f.a.createRef(),a=n,d()(i,a)}return u()(t,e),l()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),window.addEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal),this.props.visible&&this.firstShow()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener(v.default.names.CLOSE_NON_MODAL,this.handleCloseModal)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.visible,i=t.position;if(n){var a=JSON.stringify(i)===JSON.stringify(e.position);n===e.visible&&a||(this.state.didMount&&a?this.fullDisplay():this.firstShow())}}},{key:"firstShow",value:function(){var e=this.props.position,t=this.refContainer.current,n=t.offsetWidth,i=t.offsetHeight,o=a()({},e);o.didMount=!0,e||(o.left="calc(50% - "+n/2+"px",o.top="calc(50% - "+i/2+"px"),this.setState(o,this.fullDisplay)}},{key:"fullDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.isExclusive&&(v.default.dispatchEvent(v.default.names.CLOSE_DROPDOWN_PANEL),v.default.dispatchEvent(v.default.names.CLOSE_MODAL_DIALOG));var t=this.refContainer.current,n=this.state,i=n.left,a=n.right,o=n.top,r=n.bottom,s={left:i,right:a,top:o,bottom:r},l=y.fullDisplay(s,t,e?0:this.props.retainSize);this.setState(l,e?null:this.props.onShow)}},{key:"getClassName",value:function(){var e=this.props.className,t="component-non-modal animation-bounce-in drag";return this.state.didMount&&(t+=" did-mount"),e&&(t+=" "+e),t}},{key:"render",value:function(){if(!this.props.visible&&!this.state.didMount)return!1;var e=this.props,t=e.children,n=e.visible,i=e.title,a=e.options,o=e.showCloseBtn,r=this.props.onClose,s=this.state,l={left:s.left,top:s.top,right:s.right,bottom:s.bottom,width:s.width,height:s.height,minHeight:s.minHeight,minWidth:s.minWidth,maxHeight:s.maxHeight,maxWidth:s.maxWidth},c=this.getClassName();return f.a.createElement(g.default,{destroyOnHide:!1,visible:n},f.a.createElement("div",{ref:this.refContainer,className:c,tabIndex:"1",style:l,onTouchStart:this.handleTouchStart,onKeyDown:this.handleKeyDown,onMouseDown:this.handleDragModal},!!i&&f.a.createElement("div",{className:"non-modal-header drag"},f.a.createElement("div",{ref:this.refTitle,className:"title drag"},i),a,o&&f.a.createElement(w.default,{className:"close-btn",iconType:b.close,onClick:r})),f.a.createElement("div",{className:"non-modal-body"},t)))}},{key:"element",get:function(){return this.refContainer.current}}]),t}(h.PureComponent);_.defaultProps={visible:!0,showCloseBtn:!0,retainSize:30,isExclusive:!0,isAllDrag:!1},t.a=_},405:function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.StyleNames=void 0,function(e){e.width="width",e.height="height",e.left="left",e.top="top",e.marginLeft="marginLeft",e.marginTop="marginTop",e.translateX="translateX",e.translateY="translateY",e.rotate="rotate",e.opacity="opacity"}(i||(i={})),t.StyleNames=i},410:function(e,t,n){},421:function(e,t,n){"use strict";var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(166),f=n(148),m=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.refWrap=u.a.createRef(),o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.visible,i=e.iconSelected,a=e.iconContent,o=e.className;return u.a.classNames({"component-dropdown-group":1,disabled:t,selected:n,"icon-selected":i,"icon-text":"string"==typeof a},o)}},{key:"getElement",value:function(){return this.refWrap.current}}]),t}(p.PureComponent);m.iconTypes=f.default.types,m.DropdownPanel=h.default.DropdownPanel,t.a=m},424:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(429),n(142)),u=n.n(p),h=n(151),f=n.n(h),m=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.state={checked:e.defaultChecked||e.checked},n}return d()(t,e),r()(t,[{key:"componentDidUpdate",value:function(e,t){e.checked!==this.props.checked&&this.setState({checked:this.props.checked})}},{key:"handleClick",value:function(){if(!this.state.checked){var e=this.props,t=e.onChecked,n=e.value;this.setState({checked:!0},(function(){t&&t(n)}))}}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i="component-radio";return this.state.checked&&(i+=" checked"),n&&(i+=" disabled"),t&&(i+=" "+t),i}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.disabled,i=e.title,a=this.getClassName(),o=this.handleClick;return n&&(o=void 0),u.a.createElement(f.a,{title:i},u.a.createElement("div",{className:a,onClick:o},u.a.createElement("div",{className:"radio-icon"}),!!t&&u.a.createElement("div",{className:"radio-text"},t)))}}]),t}(p.PureComponent);m.defaultProps={defaultChecked:!1,checked:!1,disabled:!1},t.default=m},429:function(e,t,n){},437:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=(0,i.__importDefault)(n(166)),r=(0,i.__importDefault)(n(168)),s=(0,i.__importDefault)(n(456)),l=(0,i.__importDefault)(n(251)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.commandBarId,r=t.children,c=t.altChildIds,d=t.panel,p=t.altRef,u=t.isLazy;return d?(e=u?a.default.cloneElement(d,{ref:p||this.refPanel}):a.default.createElement(s.default,{commandBarId:n},a.default.cloneElement(d,{ref:p||this.refPanel})),a.default.createElement(l.default,{commandBarId:n,ref:this.refAlt,altChildIds:c,iNotI:!0},a.default.createElement(o.default,(0,i.__assign)({},this.props,{onVisibleChange:this.onVisibleChange,panel:e}),r))):a.default.createElement(o.default,(0,i.__assign)({},this.props,{onVisibleChange:this.onVisibleChange,panel:d}),r)},t.placementTypes=o.default.placementTypes,t.DropdownPanel=o.default.DropdownPanel,t.triggerTypes=o.default.triggerTypes,t.propTypes=(0,i.__assign)({commandBarId:r.default.string.isRequired,altRef:r.default.object,isLazy:r.default.bool},o.default.propTypes),t}((0,i.__importDefault)(n(768)).default);t.default=c},442:function(e,t,n){"use strict";n.r(t),n.d(t,"groupMap",(function(){return u})),n.d(t,"icons",(function(){return s})),n.d(t,"chartTypes",(function(){return l.default})),n.d(t,"styleTabs",(function(){return c})),n.d(t,"elementTabs",(function(){return d})),n.d(t,"groupTypes",(function(){return p}));var i=n(26),a=n.n(i),o=n(150),r=n.n(o),s=(n(1213),{histogram:"chart 16_histogram 1",line:"chart 16_line 1",pie:"chart 16_pie 1",bar:"chart 16_bar 1",area:"chart 16_area 1",scatter:"chart 16_scatter 1",stock:"chart 16_stock 1",radar:"chart 16_radar 1",combo:"chart 16_combo 1",histogram1:"chart 36_histogram1",histogram2:"chart 36_histogram2",histogram3:"chart 36_histogram3",line1:"chart 36_line1",line2:"chart 36_line2",line3:"chart 36_line3",line4:"chart 36_line4",line5:"chart 36_line5",line6:"chart 36_line6",pie1:"chart 36_pie1",pie2:"chart 36_pie2",pie3:"chart 36_pie3",pie4:"chart 36_pie4",bar1:"chart 36_bar1",bar2:"chart 36_bar2",bar3:"chart 36_bar3",area1:"chart 36_area1",area2:"chart 36_area2",area3:"chart 36_area3",scatter1:"chart 36_scatter1",scatter2:"chart 36_scatter2",scatter3:"chart 36_scatter3",scatter4:"chart 36_scatter4",scatter5:"chart 36_scatter5",scatter6:"chart 36_scatter6",stock1:"chart 36_stock1",stock2:"chart 36_stock2",stock3:"chart 36_stock3",stock4:"chart 36_stock4",radar1:"chart 36_radar1",radar2:"chart 36_radar2",radar3:"chart 36_radar3",combo1:"chart 36_combo1",combo2:"chart 36_combo2",combo3:"chart 36_combo3"}),l=n(741),c={style:{key:"style",name:_i18n("applications.public.components.commandbars.Chart.style", "样式")},color:{key:"color",name:_i18n("applications.public.components.commandbars.Chart.color", "颜色")}},d={chartElement:{key:"chartElement",name:_i18n("applications.public.components.commandbars.Chart.element", "图表元素")},layout:{key:"layout",name:_i18n("applications.public.components.commandbars.Chart.layout", "快速布局")}},p={all:{text:_i18n("applications.public.components.commandbars.Chart.text", "图表"),icon:s.histogram},histogram:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Histogram.text", "柱状图"),icon:s.histogram},line:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Line.text", "折线图"),icon:s.line},pie:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Pie.text", "饼图"),icon:s.pie},bar:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Bar.text", "条形图"),icon:s.bar},area:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Area.text", "面积图"),icon:s.area},scatter:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Scatter.text", "X Y(散点图)"),icon:s.scatter},stock:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Stock.text", "股价图"),icon:s.stock},radar:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Radar.text", "雷达图"),icon:s.radar},combo:{text:_i18n("applications.public.components.commandbars.Chart.ChartMenus.Combo.text", "组合图"),icon:s.combo}},u={};Object.keys(p).map((function(e){return r()({},p[e].text,e)})).forEach((function(e){return u=a()({},e,u)}))},448:function(e,t,n){},449:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.isShown=!1,o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.active,i=e.destroyOnHide;this.isShown=this.isShown||n;var a="tab-pane"+(n?"":" tab-pane-hidden");return!(!n&&i)&&u.a.createElement("div",{className:a},!!this.isShown&&t)}}]),t}(p.PureComponent);h.defaultProps={visible:!0},t.default=h},4547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShowEntry=t.getPlugin=t.enableDiagram=void 0;var i=n(143),a=window.__WPSPLUGIN__,o=a.helper.types.WppInsertFigureZntx,r=a.helper.has(o);function s(){return r?a.loader.loadSingleInstance({pluginType:o}):Promise.reject("InsertDiagram Plugin is disabled!")}t.enableDiagram=r,t.getPlugin=s,t.isShowEntry=function(){return(0,i.__awaiter)(this,void 0,Promise,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:if(!r)return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,s()];case 2:return[2,t.sent().showFigureEntry()];case 3:return e=t.sent(),console.warn("[InsertDiagram Entry] something wrong: ",e),[2,!1];case 4:return[2]}}))}))}},4548:function(e,t,n){},4549:function(e,t,n){},456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=n(283),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.commandBarId;e?this.props.children&&"Bundle"===this.props.children.type.name||window.__WPSENV__.reduxDispatch((0,o.altLazyLoad)({id:e})):window.isDebugger&&console.error("AltPanelFragment id is null")},t.prototype.render=function(){return!!this.props.children&&a.default.cloneElement(this.props.children)},t}(a.PureComponent);t.default=r},476:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=n(142),f=n.n(h),m=n(424),v=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleItemChecked=n.handleItemChecked.bind(n),n.state={value:e.value},n}return u()(t,e),l()(t,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&this.setState({value:this.props.value})}},{key:"handleItemChecked",value:function(e){this.setState({value:e}),this.props.onChecked(e)}},{key:"renderItems",value:function(){var e=this,t=this.props.options,n=this.state.value;return t.map((function(t,i){var o=t.value===n;return f.a.createElement(m.default,a()({key:i},t,{checked:o,onChecked:e.handleItemChecked}),t.content)}))}},{key:"render",value:function(){var e="component-radio-group";this.props.isAuto&&(e+=" auto");var t=this.renderItems();return f.a.createElement("div",{className:e},t)}}]),t}(h.PureComponent);v.defaultProps={isAuto:!0},t.default=v},485:function(e,t,n){},509:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n.n(i),o=n(223),r=n.n(o),s=n(0),l=n.n(s),c=n(3),d=n.n(c),p=n(25),u=n.n(p),h=n(42),f=n.n(h),m=(n(548),n(142)),v=n.n(m),w=n(622),g=n(148),y=g.default.types.size16,b=function(e){function t(){return l()(this,t),u()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=r()(e,["className","children"]),o="component-simple-modal";return t&&(o+=" "+t),v.a.createElement(w.default,a()({className:o},i),v.a.createElement("div",{className:"modal-close-btn",onClick:i.onCancel},v.a.createElement(g.default,{type:y.close_white})),v.a.createElement("div",null,n))}}]),t}(m.PureComponent);b.defaultProps=w.default.defaultProps,t.default=b},512:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(156),f=n(145),m=n(513),v=n.n(m),w=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.xhr=null,n._completed=!1,n.throttleUploadProgress=Object(h.throttle)((function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;n.props.onProgress&&n.props.onProgress(t),n.setState({progress:t})}}),100),n.handleUploadComplete=n.handleUploadComplete.bind(n),n.handleUploadError=n.handleUploadError.bind(n),n.handleOffline=n.handleOffline.bind(n),n.handleCancel=n.handleCancel.bind(n),n.handleMaskClick=n.handleMaskClick.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.state={progress:0,officeType:Object(f.getPageOfficeType)()},n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.startUpload(),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("offline",this.handleOffline)}},{key:"componentWillUnmount",value:function(){null!==this.xhr&&this.xhr.abort(),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("offline",this.handleOffline)}},{key:"startUpload",value:function(){var e=this,t=this.props,n=t.formData,i=t.url,a=t.onProgress;a&&a(0),this.xhr=window.__WPSENV__.request({method:"POST",url:i,body:n}),this.xhr.onprogress=this.throttleUploadProgress,this.xhr.end().then((function(t){e.handleUploadComplete(t)})).catch((function(t){e.handleUploadError(t)}))}},{key:"handleUploadComplete",value:function(e){console.log("上传文件完成"),this.xhr=null,this._completed=!0,this.setState({progress:100}),this.props.onComplete(e)}},{key:"handleUploadError",value:function(e){console.log("上传文件失败：",e),this.xhr=null,this.props.onError(e)}},{key:"handleOffline",value:function(){this.xhr.abort(),this.handleUploadError({body:{result:"offline"}})}},{key:"handleCancel",value:function(){this._completed||(this.xhr.abort(),this.xhr=null,this.props.onCancel&&this.props.onCancel())}},{key:"handleWindowKeyDown",value:function(e){var t="F5"===e.code||116===e.keyCode,n="F12"===e.code||123===e.keyCode;t||n||Object(f.stopBubble)(e)}},{key:"handleMaskClick",value:function(e){Object(f.stopBubble)(e)}},{key:"render",value:function(){var e=this.state.progress,t=this.props,n=t.uploadTips,i=t.visible,a=t.hideDotting;return u.a.createElement(v.a,{progress:e,uploadTips:n,visible:i,hideDotting:a,onCancel:this.handleCancel})}}]),t}(p.PureComponent);w.defaultProps={visible:!0},t.default=w},513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(514);var a=(0,i.__importStar)(n(142)),o=n(145),r=(0,i.__importDefault)(n(192)),s=function(e){function t(t){var n=e.call(this,t)||this;return n.handleWindowKeyDown=function(e){var t="F5"===e.code||116===e.keyCode,n="F12"===e.code||123===e.keyCode;t||n||(0,o.stopBubble)(e)},n.handleMaskClick=function(e){(0,o.stopBubble)(e)},n.renderTitle=function(){var e=n.props.title;return e?a.default.createElement("div",{className:"uploader-header"},a.default.createElement("div",{className:"uploader-header-text"},e)):null},n.renderContent=function(){var e=n.props,t=e.children,i=e.uploadTips,o=e.hideDotting;return t||a.default.createElement("div",{className:"progress-tips"},a.default.createElement("span",null,i),!o&&a.default.createElement("i",{className:"dotting"}))},n.state={officeType:(0,o.getPageOfficeType)()},n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)},t.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.handleWindowKeyDown,!0)},t.prototype.render=function(){var e=this.state.officeType,t=this.props,n=t.progress,i=t.visible,o=t.onCancel,s=t.cancelBtnText,l=t.className,c=t.title,d=t.maskTransparency,p=a.default.classNames({"component-uploader":1,"uploader-with-title":!!c,mask:!d},l);return a.default.createElement("div",{className:p,onClick:this.handleMaskClick},i&&a.default.createElement("div",{className:"uploader-content"},this.renderTitle(),a.default.createElement("div",{className:"progress-wrap"},a.default.createElement("div",{className:"progress-bar ".concat(e),style:{width:"".concat(n,"%")}})),this.renderContent(),a.default.createElement(r.default,{className:"cancel-btn",onClick:o},s||_i18n("applications.public.components.upload.FileUploader.cancel", "取消"))))},t.defaultProps={visible:!0,maskTransparency:!0},t}(a.PureComponent);t.default=s},514:function(e,t,n){},516:function(e,t,n){"use strict";var i=n(43),a=n.n(i),o=n(0),r=n.n(o),s=n(3),l=n.n(s),c=n(25),d=n.n(c),p=n(42),u=n.n(p),h=(n(1188),n(142)),f=n.n(h),m=n(168),v=n.n(m),w=n(156),g=n(146),y=n(26),b=n.n(y),_=(n(1189),n(151)),C=n.n(_),T=n(362),k=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.state.enable&&n._action&&n._action()},n.state={id:e.id,icon:e.icon,caption:e.caption,tooltip:e.tooltip,enable:!0,visible:!0,iconStyle:Object(T.b)(e.icon)},n}return u()(t,e),l()(t,[{key:"getClassName",value:function(){var e=this.state,t=e.icon,n=e.caption,i=e.enable,a=e.visible;return f.a.classNames({"component-custom-cmb-btn":1,"component-icon-text-btn":t&&n,"component-icon-btn":t&&!n,"component-text-btn border-none":!t&&n,disabled:!i,hidden:!a})}},{key:"renderBtn",value:function(){var e=this.state,t=e.icon,n=e.caption,i=e.tooltip,a=e.iconStyle;return f.a.createElement(C.a,{title:i},f.a.createElement("div",{className:this.getClassName(),onClick:this.handleClick},!!t&&f.a.createElement("div",{className:"icons icons-16",style:a}),!!n&&f.a.createElement("div",{className:"btn-text"},n)))}},{key:"id",get:function(){return this.state.id}},{key:"icon",set:function(e){this.setState({icon:e,iconStyle:Object(T.b)(e)})},get:function(){return this.state.icon}},{key:"caption",set:function(e){this.setState({caption:e})},get:function(){return this.state.caption}},{key:"tooltip",set:function(e){this.setState({tooltip:e})},get:function(){return this.state.tooltip}},{key:"action",set:function(e){this._action=e},get:function(){return this._action}},{key:"enable",set:function(e){this.setState({enable:e})},get:function(){return this.state.enable}},{key:"visible",set:function(e){this.setState({visible:e})},get:function(){return this.state.visible}}]),t}(h.PureComponent),E=n(251),S=n.n(E),P=function(e){function t(){return r()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),l()(t,[{key:"render",value:function(){var e=this.props,t=e.id;return e.alt?f.a.createElement(S.a,{commandBarId:t},this.renderBtn()):this.renderBtn()}}]),t}(k);P.propTypes={id:v.a.oneOfType([v.a.string,v.a.number]).isRequired,icon:v.a.string,caption:v.a.string,tooltip:v.a.string,alt:v.a.bool};var R=P,O=n(154),I=n.n(O),B=n(166),N=n(437),M=n.n(N),D=B.default.DropdownPanel,L=D.Item,A=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelect=function(e){e.action(),n.setState({panelVisible:!1})},n.handleVisibleChange=function(e){n.setState({panelVisible:e})},n.state=b()({},n.state,{panelItems:[],panelVisible:!1}),e.alt&&(n.altChildIds=[]),n}return u()(t,e),l()(t,[{key:"renderItems",value:function(){var e,t,n=this,i=this.state.panelItems;return e=i.map((function(e){return f.a.createElement(L,{className:e.disabled?"disabled":"",key:e.key,value:e,onClick:n.handleSelect},!!e.icon&&f.a.createElement("div",{className:"icons icons-16",style:Object(T.b)(e.icon)}),e.caption)})),t=n.props.alt,n.altChildIds=[],t?e.map((function(e,t){return n.altChildIds.push(i[t].key),f.a.createElement(S.a,{commandBarId:i[t].key,key:i[t].key},e)})):e}},{key:"getClassName",value:function(){var e=I()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this),n=this.state.panelVisible;return f.a.classNames({dropdown:1,selected:n},e)}},{key:"render",value:function(){var e=this.state.panelVisible,t=this.renderItems(),n=f.a.createElement(D,null,t),i=this.props,a=i.id,o=i.alt?M.a:B.default;return f.a.createElement(o,{panel:n,visible:e,onVisibleChange:this.handleVisibleChange,commandBarId:a,altChildIds:this.altChildIds},this.renderBtn())}},{key:"panelItems",set:function(e){this.setState({panelItems:e})},get:function(){return this.state.panelItems}}]),t}(k);A.propTypes={id:v.a.oneOfType([v.a.string,v.a.number]).isRequired,icon:v.a.string,caption:v.a.string,tooltip:v.a.string};var x=A,W=function(e){function t(){var e,n,i,a;r()(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={items:[]},a=n,d()(i,a)}return u()(t,e),l()(t,[{key:"add",value:function(e){var t=this,n=e.id,i=e.controlType,o=void 0===i?T.a.button:i,r=e.icon,s=void 0===r?null:r,l=e.caption,c=void 0===l?null:l,d=e.tooltip,p=void 0===d?null:d;if(this.state.items.find((function(e){return e.id===n})))throw new Error("该控件ID已存在："+n);var u=[].concat(a()(this.state.items));return u.push({id:n,icon:s,caption:c,tooltip:p,controlType:o}),new Promise((function(e){t.setState({items:u},(function(){return e(t._refMap[n].el)}))}))}},{key:"remove",value:function(e){var t=this.state.items.filter((function(t){return t.id!==e}));return this.setState({items:t}),!0}},{key:"_ref",value:function(e){var t=this;return this._refMap=this._refMap||{},this._refMap[e]||(this._refMap[e]={cb:function(n){return t._refMap[e].el=n}}),this._refMap[e]}},{key:"render",value:function(){var e=this,t=this.props.alt;return this.state.items.map((function(n){return f.a.createElement("div",{key:n.id},n.controlType===T.a.dropdown&&f.a.createElement(x,b()({ref:e._ref(n.id).cb},n,{alt:t})),n.controlType===T.a.button&&f.a.createElement(R,b()({ref:e._ref(n.id).cb},n,{alt:t})))}))}}]),t}(h.PureComponent),F=n(144),V=n(185),H=function(){function e(){var t=this;r()(this,e),this.leftItems=[],this.setLeftItems=function(e,n){var i=0;t.leftItems=[];for(var a=0;a<e.length&&(i+=e[a].offsetWidth,t.leftItems.push(e[a]),!(i>=n));a++);}}return l()(e,[{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t.offsetWidth}),0)}},{key:"findElementIndex",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].contains(t))return n;return-1}},{key:"adjustOffsetItems",value:function(e,t,n,i,a,o){var r=this;if(t)this.leftItems.pop();else if(n)this.leftItems=o.filter((function(e,t){return t<r.leftItems.length+1}));else{for(;this.leftItems.length>0;){if(!(a-this.sum(this.leftItems)+this.leftItems[this.leftItems.length-1].offsetWidth<=i))break;this.leftItems.pop()}if(e){var s=e;e=null;var l=this.findElementIndex(this.leftItems,s);if(-1===l){for(var c=0,d=this.leftItems.length;d<o.length&&(c+=o[d].offsetWidth)<=i;d++)if(o[d].contains(s))return;l=this.findElementIndex(o,s);var p=o.filter((function(e,t){return t<=l})),u=this.sum(p);this.leftItems=[];for(var h=0;h<l;h++)if(this.leftItems.push(o[h]),(u-=o[h].offsetWidth)<=i)return}else this.leftItems=this.leftItems.filter((function(e,t){return t<l}))}}}},{key:"getBtnStatus",value:function(e){var t=e.enabledLeftBtn,n=e.enabledRightBtn,i=e.isLeft,a=e.isRight,o=e.getItemsWidth;if(window.rightToLeft){var r=i;i=a,a=r}var s=o(),l=s.wrapWidth,c=s.allItemWidth,d=s.items,p=s.itemsWrap,u=s.locationElement,h=s.scrollLeft,f=s.offsetWidth;if(l>=c)return this.leftItems=[],{showBtn:!1,enabledLeftBtn:t,enabledRightBtn:n};this.adjustOffsetItems(u,i,a,l,c,d);var m=this.sum(this.leftItems);return t=h>0,n=c-h>f+1,window.rightToLeft&&(t=c+h>f+1,n=h<0,m=-m),(i||a||u)&&Object(V.runScrollLeft)({element:p,start:h,end:m,keepEnd:!0}),{showBtn:!0,enabledLeftBtn:t,enabledRightBtn:n}}}]),e}(),K=n(283),U=function(e){function t(e){r()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.tabKey));return n.state={showBtn:!1,wrapStyle:null,enabledLeftBtn:!1,enabledRightBtn:!1},n.handleWindowResize=function(){n.props.visible&&n.adjustUI(!1,!1)},n.panelW=void 0,n.getItemsWidth=function(){var e=n.refWrap.current,t=n.refItemsWrap.current,i=e.clientWidth-2*n.refBtn.current.offsetWidth,a=Array.from(n.refItems.current.childNodes),o=n.helper.sum(a),r=t.scrollLeft;return{wrapWidth:i,allItemWidth:o,offsetWidth:t.offsetWidth,items:a,scrollLeft:r,wrap:e,itemsWrap:t,locationElement:n.locationElement}},n.adjustUI=Object(w.throttle)((function(e,t){var i=n.state,a=i.enabledLeftBtn,o=i.enabledRightBtn,r=n.helper.getBtnStatus({isLeft:e,isRight:t,enabledLeftBtn:a,enabledRightBtn:o,getItemsWidth:n.getItemsWidth}),s=r.showBtn,l=r.enabledLeftBtn,c=r.enabledRightBtn;n.setState({showBtn:s,enabledLeftBtn:l,enabledRightBtn:c})}),100),n.handleLeftBtnClick=function(){n.state.enabledLeftBtn&&(n.adjustUI(!0,!1),g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL))},n.handleRightBtnClick=function(){n.state.enabledRightBtn&&(n.adjustUI(!1,!0),g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL))},n.touchTime=null,n.handleWheel=function(e){if(n.state.showBtn&&e.currentTarget.contains(e.target)){if(void 0!==e.wheelDelta&&e.wheelDelta%120!=0){if(Math.abs(e.deltaX)<Math.abs(e.deltaY))return;var t=(new Date).getTime();if(t-n.touchTime<150)return;n.touchTime=t}e.deltaY>0||e.deltaX>0?n.handleRightBtnClick():(e.deltaY<0||e.deltaX<0)&&n.handleLeftBtnClick(),g.default.dispatchEvent(g.default.names.TAB_WRAP_WHEEL)}},n.handleScroll=function(e){n.refDiv.current.contains(e.target)&&(g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL),n.throttleScroll()),g.default.dispatchEvent(g.default.names.TAB_WRAP_SCROLL)},n.throttleScroll=Object(w.throttle)((function(){var e=n.getItemsWidth(),t=e.allItemWidth,i=e.offsetWidth,a=e.scrollLeft,o=e.items,r=a>0,s=t-a>i+1;F.isIPad&&n.helper.setLeftItems(o,a),window.rightToLeft&&(r=t+a>i+1,s=a<0),n.setState({enabledLeftBtn:r,enabledRightBtn:s})}),100),n.isVisible=function(){return n.props.visible},n.contains=function(e){return n.refWrap.current.contains(e)},n.locationElement=null,n.location=function(e){if(n.locationElement=e,n.props.visible)n.adjustUI(!1,!1);else{var t={tabKey:n.props.tabKey};g.default.dispatchEvent(g.default.names.SWITCH_COMMANDBAR_TAB,t)}},n.add=function(e){var t=e.id,i=e.controlType,o=void 0===i?T.a.button:i,r=e.icon,s=void 0===r?null:r,l=e.caption,c=void 0===l?null:l,d=e.tooltip,p=void 0===d?null:d,u=n.props.altChildIds;if(!u)return n.refCustom.current.add({id:t,icon:s,caption:c,tooltip:p,controlType:o});n.customItemIds.push(t);var h=n.props.tabKey,f=n.refCustom.current.add({id:t,icon:s,caption:c,tooltip:p,controlType:o});return new Promise((function(e){f.then((function(t){window.__WPSENV__.reduxDispatch(Object(K.altAppend)({id:"Tab"+h,child:[].concat(a()(u),a()(n.customItemIds))})),e(t)}))}))},n.remove=function(e){return n.refCustom.current.remove(e)},n.refDiv=f.a.createRef(),n.refWrap=f.a.createRef(),n.refItems=f.a.createRef(),n.refCustom=f.a.createRef(),n.refItemsWrap=f.a.createRef(),n.refBtn=f.a.createRef(),n.helper=new H,n.refMap=void 0,n.customItemIds=[],n}return u()(t,e),l()(t,[{key:"ref",value:function(e){var t=this;return this.refMap=this.refMap||{},this.refMap[e]||(this.refMap[e]={cb:function(n){return t.refMap[e].el=n}}),this.refMap[e]}},{key:"componentDidMount",value:function(){window.__WPSENV__.tabwraps.push(this),this.props.isAppReady&&this.initEvents();var e=this.props,t=e.tabKey,n=e.altChildIds;n&&window.__WPSENV__.reduxDispatch(Object(K.altAppend)({id:"Tab"+t,child:n}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize,{passive:!0}),this.refDiv.current.removeEventListener("wheel",this.handleWheel,{passive:!0}),this.refItemsWrap.current.removeEventListener("scroll",this.handleScroll,{passive:!0})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible;n.isAppReady&&!e.isAppReady?this.initEvents():i&&!e.visible&&this.handleWindowResize()}},{key:"initEvents",value:function(){this.handleWindowResize(),this.observerPanel(),window.addEventListener("resize",this.handleWindowResize),this.refDiv.current.addEventListener("wheel",this.handleWheel,{passive:!0}),this.refItemsWrap.current.addEventListener("scroll",this.handleScroll,{passive:!0})}},{key:"observerPanel",value:function(){var e=this,t=this.refItems.current;this.panelW=t.clientWidth,new MutationObserver((function(){var n=t.clientWidth;e.panelW!==n&&(e.panelW=n,e.handleWindowResize())})).observe(t,{childList:!0,subtree:!0})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.visible,i=e.altChildIds,a=this.state,o=a.showBtn,r=a.enabledLeftBtn,s=a.enabledRightBtn,l="cmb-tab-wrap";o&&(l+=" show-roll-btn"),n||(l+=" hidden");var c=f.a.classNames({"items-container":1,disabled:window.__WPSENV__.cache_preview&&window.__WPSENV__.publish});return f.a.createElement("div",{ref:this.refDiv,className:l},f.a.createElement("div",{ref:this.refWrap,className:"tab-wrap"},f.a.createElement("div",{ref:this.refItemsWrap,className:"items-wrap"},f.a.createElement("div",{ref:this.refItems,className:c},t,f.a.createElement(W,{ref:this.refCustom,alt:!!i})))),f.a.createElement("div",{ref:this.refBtn,className:"roll-btn left-btn"+(r?"":" disabled"),onClick:this.handleLeftBtnClick}),f.a.createElement("div",{className:"roll-btn right-btn"+(s?"":" disabled"),onClick:this.handleRightBtnClick}))}}]),t}(window.CommandBarComponent);U.propTypes={tabKey:v.a.string.isRequired,visible:v.a.bool.isRequired,isAppReady:v.a.bool,onEmptyClick:v.a.func,altChildIds:v.a.arrayOf(v.a.string)},U.defaultProps={isAppReady:!0};t.a=U},523:function(e,t,n){"use strict";n.r(t),n.d(t,"UnderlineType",(function(){return a})),n.d(t,"ParagraphReadingOrder",(function(){return o})),n.d(t,"TaskListChar",(function(){return r})),n.d(t,"TaskListIndex",(function(){return s})),n.d(t,"UnitType",(function(){return l})),n.d(t,"WpsEmphasisMark",(function(){return c})),n.d(t,"SupLinkType",(function(){return d}));var i=n(158);n.d(t,"FormatOpType",(function(){return i.FormatOpType})),n.d(t,"StyleSti",(function(){return i.StyleSti})),n.d(t,"HorzAlignMode",(function(){return i.HorzAlignMode})),n.d(t,"ListType",(function(){return i.ListType})),n.d(t,"SelectType",(function(){return i.SelectType})),n.d(t,"EditorEventTypes",(function(){return i.EditorEventTypes})),n.d(t,"NoWidthLineStyle",(function(){return i.NoWidthLineStyle})),n.d(t,"UnderlineMode",(function(){return i.UnderlineMode})),n.d(t,"ModelNamesDef",(function(){return i.ModelNamesDef})),n.d(t,"FillType",(function(){return i.FillType})),n.d(t,"ShapeType",(function(){return i.ShapeType})),n.d(t,"PlaceholderType",(function(){return i.PlaceholderType})),n.d(t,"WpActionType",(function(){return i.WpActionType})),n.d(t,"LinkType",(function(){return i.LinkType})),n.d(t,"BlibFillType",(function(){return i.BlibFillType})),n.d(t,"LineType",(function(){return i.LineType})),n.d(t,"LineValueMap",(function(){return i.LineValueMap}));var a={wpsUnderlineNone:0,wpsUnderlineSingle:1,wpsUnderlineWords:2,wpsUnderlineDouble:3,wpsUnderlineDotted:4,wpsUnderlineThick:6,wpsUnderlineDash:7,wpsUnderlineDotDash:9,wpsUnderlineDotDotDash:10,wpsUnderlineWavy:11,wpsUnderlineWavyHeavy:27,wpsUnderlineDottedHeavy:20,wpsUnderlineDashHeavy:23,wpsUnderlineDotDashHeavy:25,wpsUnderlineDotDotDashHeavy:26,wpsUnderlineDashLong:39,wpsUnderlineDashLongHeavy:55,wpsUnderlineWavyDouble:43},o={ReadingOrderLtr:0,ReadingOrderRtl:1},r={Todo:String.fromCharCode(61693),Done:String.fromCharCode(61694)},s={Todo:8,Done:9},l={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},c={wpsEmphasisMarkNone:0,wpsEmphasisMarkOverSolidCircle:1,wpsEmphasisMarkOverComma:2,wpsEmphasisMarkOverWhiteCircle:3,wpsEmphasisMarkUnderSolidCircle:4},d=[i.WpActionType.ActionFirstSlide,i.WpActionType.ActionLastSlide,i.WpActionType.ActionPreviousSlide,i.WpActionType.ActionNextSlide,i.WpActionType.ActionHyperlink]},545:function(e,t,n){},548:function(e,t,n){},569:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(168),f=n.n(h),m=n(145),v=n(166),w=n(148),g=n(151),y=n.n(g),b=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.handleIconClick=function(e){Object(m.stopBubble)(e),i.props.visible&&i.props.onVisibleChange(!1),i.props.onIconClick(e)},o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.iconContent,a=e.disabled,o=e.title,r=e.iconType,s=e.visible,l=e.onVisibleChange,c=a?void 0:this.handleIconClick,d=this.getClassName();return u.a.createElement(v.default,{visible:s,panel:n,disabled:a,onVisibleChange:l},u.a.createElement(y.a,{title:o},u.a.createElement("div",{ref:this.refWrap,id:t,className:d},u.a.createElement("div",{className:"left-btn",onClick:c},r&&u.a.createElement(w.default,{type:r}),i),u.a.createElement("div",{className:"right-btn"}))))}}]),t}(n(421).a);b.propTypes={id:f.a.string,visible:f.a.bool.isRequired,className:f.a.string,disabled:f.a.bool,title:f.a.oneOfType([f.a.object,f.a.string]),iconType:f.a.string,iconContent:f.a.oneOfType([f.a.object,f.a.string]),onIconClick:f.a.func,iconSelected:f.a.bool,onVisibleChange:f.a.func.isRequired},t.default=b},590:function(e,t,n){},6721:function(e,t,n){},6722:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BtnConfigList=void 0;var i=n(143),a=(0,i.__importDefault)(n(310)),o=(0,i.__importDefault)(n(6723)),r=(0,i.__importDefault)(n(6725)),s=(0,i.__importDefault)(n(6726)),l=(0,i.__importDefault)(n(6728)),c=(0,i.__importDefault)(n(8222)),d=(0,i.__importDefault)(n(6732)),p=(0,i.__importDefault)(n(6734)),u=(0,i.__importDefault)(n(6736)),h=(0,i.__importDefault)(n(6738)),f=(0,i.__importDefault)(n(6739)),m=(0,i.__importDefault)(n(6740)),v=(0,i.__importDefault)(n(6741)),w=(0,i.__importDefault)(n(6743)),g=n(4547),y=(0,i.__importDefault)(n(3834)),b=n(679),_=window.__WPSPLUGIN__.helper,C=window.__CONFIG__.enableLaTeX,T=window.__CONFIG__.wpp.isShowInsertMedia,k=window.__CONFIG__.wpp.enableQRCode,E=_.has(_.types.Material),S=window.__CONFIG__.wpp.enableChartDataEdit,P=[{id:y.default.Material,Com:r.default,enabled:E},{id:y.default.InsertDiagram,Com:w.default,enabled:g.enableDiagram},{id:y.default.Divider,Com:a.default,enabled:!(!E&&!g.enableDiagram)},{id:y.default.TextBox,Com:o.default,enabled:!0},{id:y.default.Picture,Com:d.default,enabled:!0},{id:y.default.InsertGeomerty,Com:u.default,enabled:!0},{id:y.default.Table,Com:h.default,enabled:!0},{id:y.default.Chart,Com:v.default,enabled:S},{id:y.default.FlowChart,Com:p.default,enabled:b.isProcessOnAvailable},{id:y.default.MindMap,Com:null,enabled:b.isProcessOnAvailable},{id:y.default.InsertHyperlink,Com:c.default,enabled:!0},{id:y.default.Media,Com:f.default,enabled:T},{id:y.default.LatexMath,Com:m.default,enabled:C},{id:y.default.InsertSymbol,Com:s.default,enabled:!0},{id:y.default.QRCode,Com:l.default,enabled:k},{id:y.default.Divider,Com:a.default,enabled:!0}];t.BtnConfigList=P.map((function(e,t){return(0,i.__assign)((0,i.__assign)({},e),{idx:t})}))},6723:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(6724),n(142)),u=n.n(p),h=n(377),f=n(203),m=n(172),v=n(148),w=n(725),g=n(179),y=window.pcTrack,b=h.default.iconTypes.size16,_=void 0,C=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getTextWidth=function(){if(_)return _;var e=_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.textBox", "文本框"),t=document.createElement("span");return t.style.cssText="visibility:hidden;position:absolute;z-index:-1;top:-1000px;",t.innerText=e,document.body.appendChild(t),_=t.offsetWidth,document.body.removeChild(t),_},n.toggleShowText=function(e){n.setState({showText:e})},n.isTextShow=function(){return n.state.showText},n.handleClick=n.handleClick.bind(n),n.onVisibleChange=n.onVisibleChange.bind(n),n.handleSelected=n.handleSelected.bind(n),n.state={list:[{title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title_horizontal", "横向文本框"),iconType:"text_box_vertical",value:"horizontal"},{title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title_vertical", "竖向文本框"),iconType:"text_box_horizontal",value:"vertical"}],visible:!1,selected:!1,showText:!0},n.refBtn=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title", "双击幻灯片空白处，可快速添加文本框"),icon:b.text_box,items:[{icon:b.text_box_vertical,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title_horizontal", "横向文本框")},{icon:b.text_box_horizontal,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title_vertical", "竖向文本框")}]})}},{key:"onVisibleChange",value:function(e){this.setState({visible:e}),e?(this.fire(this.uiEventTypes.pc.TEXTTOOL_DROPDOWN_MENU,{type:"word_tool",state:!0}),window.collection("newui","value",y.newui.text_add_more_toolbar)):this.fire(this.uiEventTypes.pc.TEXTTOOL_DROPDOWN_MENU,{type:"word_tool",state:!1})}},{key:"handleClick",value:function(){if(!this.props.disabled){var e=this.state.list[0].value;this.handleSelected(e),window.collection("newui","value",y.newui.text_add_toolbar)}}},{key:"handleSelected",value:function(e){var t=this;if(!this.props.disabled){var n=this.editor.slide,i=w.MouseAction.insertTextBox,a=!0;e===this.defaultSelValue&&this.state.selected&&(i=w.MouseAction.clickSlide,a=!1),n.insertTextBox({action:i,data:{orientation:e},callback:function(){return t.setState({selected:!1})}}),this.setState({visible:!1,selected:a}),this.defaultSelValue=e,this.fire(this.uiEventTypes.pc.TEXTTOOL_DROPDOWN_MENU,{type:"word_tool",state:!1}),"horizontal"===e?window.collection("newui","value",y.newui.text_add_horizontal_toolbar):window.collection("newui","value",y.newui.text_add_vertical_toolbar)}}},{key:"renderItem",value:function(e){var t=e.iconType,n=e.value===this.defaultSelValue?"insert-text-selected":null;return u.a.createElement(m.default,{key:e.iconType,onClick:this.handleSelected,value:e.value},u.a.createElement(v.default,{type:b[t],className:n}),u.a.createElement("span",{className:"item-name"},e.title))}},{key:"render",value:function(){var e=this,t=this.state,n=t.visible,i=t.list,a=t.showText,o=this.props.disabled,r=i.map((function(t){return e.renderItem(t)}));return u.a.createElement("div",null,u.a.createElement(h.default,{ref:this.refBtn,visible:n,disabled:o,iconType:b.text_box,iconContent:a?_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.textBox", "文本框"):"",title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.TextBox.title", "双击幻灯片空白处，可快速添加文本框"),onIconClick:this.handleClick,onVisibleChange:this.onVisibleChange},u.a.createElement(f.default,null,r)))}},{key:"current",get:function(){return{getTextWidth:this.getTextWidth,toggleShowText:this.toggleShowText,isTextShow:this.isTextShow}}}]),t}(g.BaseComponent);t.default=C},6724:function(e,t,n){},6725:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(183),f=n(237),m=n(1114),v=n.n(m),w=h.default.iconTypes.size16,g=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.props.disabled||(window.collection("newui","value",window.pcTrack.newui.docer_toolbar),f.default.dispatchEvent(f.default.eventTypes.pc.ON_MATERIAL_VISIBLE))},n.initSearchKeywords=n.initSearchKeywords.bind(n),n.handleClick=n.handleClick.bind(n),n.refBtn=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Material.material", "素材"),icon:w.docer_icons})}},{key:"render",value:function(){var e=this.props.disabled;return u.a.createElement(v.a,{disabled:e,ref:this.refBtn,iconType:w.docer_icons,onClick:this.handleClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Material.tooltip", "在线图片、图标素材"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Material.material", "素材")})}}]),t}(p.PureComponent);t.default=g},6726:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(6727),n(142)),u=n.n(p),h=n(168),f=n.n(h),m=n(166),v=n(183),w=n(179),g=n(158),y=n(1114),b=n.n(y),_=["＋","－","×","÷","≠","≈","<",">","≤","≥","≦","≧","%","¾","¼","½","‰","∑","∫","∬","∮","∯","π","∞","∈","∉","∩","∪","Φ","∵","∴"],C=["α","β","γ","Δ","θ","λ","μ","ρ","Ω","ω","㎏","㎜","㎝","㎡","℃","°","§","◎","©","®","｛","「","〖","№","＄","￥","＠","&","*","｜","#","※","…","①","②","③","↑","↓","←","→","√","×"],T=m.default.DropdownPanel,k=v.default.iconTypes.size16,E=window.pcTrack,S=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.refBtn=u.a.createRef(),n.handleItemClick=n.handleItemClick.bind(n),n.handleVisibleChange=n.handleVisibleChange.bind(n),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Symbol.symbols", "符号"),icon:k.insert_symbol}),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"handleVisibleChange",value:function(e){e&&window.collection("newui","value",E.newui.symbol_show_toolbar),this.setState({visible:e})}},{key:"enableInsert",value:function(e){return e.getShapeType()===g.ShapeType.Table||!(e.isPlaceHolder()&&!e.isTextShape())&&null!==e.getTextFrame()}},{key:"handleItemClick",value:function(e){e.stopPropagation(),e.nativeEvent&&e.nativeEvent.stopImmediatePropagation();var t=e.target.innerText;"〖"===t&&(t="〖〗"),"｛"===t&&(t="｛｝"),"「"===t&&(t="「」");var n=this.selection.getActiveShapes(),i=n&&n[0],a=i&&i.getShapeType();if(!n||!this.enableInsert(i)||n.length>1){var o=this.doc.getLayout(),r=o&&o.viewBox;if(!r)return;var s={x:(635*r.width*15-3098800)/2,y:(635*r.height*15-368300)/2};return window.APP.coreAPI.beginCommand(this),this.selection.insertTextBox("horizontal",s),this.selection.insertText(t),window.APP.coreAPI.endCommand(),window.collection("newui","value",E.newui.symbol_insert_toolbar),void this.setState({visible:!1})}var l=void 0;if(a===g.ShapeType.Table){if(this.selection.getActiveTableCells()){var c=this.selection.getActiveTableRange();c&&this.selection.selectTableCell(c.startRow,c.startCol)}else this.selection.selectTableCell(0,0);l=this.selection.getActiveTableCells()[0].getTextFrame()}else l=i&&i.getTextFrame();if(l&&1===n.length){if(this.selection.state!==g.SelectType.select_text){var d=l&&l.getTextStream(),p=d&&d.getCharCount();this.selection.selectText(p-1,p-1)}if(this.selection.layerType()===g.WppLayerType.WppLayerNotesPage){var u=document.getElementById("remark_eidt"),h=u&&u.selectionStart,f=u&&u.selectionEnd;u&&this.selection.selectText(h,f)}this.selection.insertText(t)}window.collection("newui","value",E.newui.symbol_insert_toolbar),this.setState({visible:!1})}},{key:"renderItems",value:function(e,t){var n=this,i=e.map((function(e){return u.a.createElement("span",{key:e,"data-keep-edit":!0,className:t,onClick:n.handleItemClick},e)}));return u.a.createElement("div",{className:"items"},i)}},{key:"renderPanel",value:function(){var e=this.renderItems(_,"used-symbol-item"),t=this.renderItems(C,"symbol-item");return u.a.createElement(T,{className:"wpp-symbol-wrap"},u.a.createElement("div",{className:"used"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Symbol.math", "数学")),e),u.a.createElement("div",{className:"symbols"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Symbol.used", "常用")),t))}},{key:"render",value:function(){var e=this.props.disabled,t=this.state.visible,n=this.renderPanel();return u.a.createElement(m.default,{panel:n,visible:t,onVisibleChange:this.handleVisibleChange},u.a.createElement(b.a,{selected:t,disabled:e,iconBtnProps:{keepEdit:!0},isDropdown:!0,ref:this.refBtn,iconType:k.insert_symbol,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Symbol.symbols", "符号"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Symbol.symbols", "符号")}))}}]),t}(w.BaseComponent);S.propTypes={disabled:f.a.bool.isRequired,addBtnRef:f.a.func},t.default=S},6727:function(e,t,n){},6728:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(183),f=n(179),m=n(164),v=n(6729),w=n.n(v),g=n(1114),y=n.n(g),b=h.default.iconTypes.size16,_={TEXT:"text",MECARD:"mecard"},C=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.initSearchKeywords=function(){var e={el:n.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.qrCode", "二维码"),icon:b.qrcode};window.__WPSENV__.commandbars.push(e)},n.onEditQrcode=function(e){var t=e.type,i=e.data,a=e.rect;n._checkDisabled(!0)||Object.values(_).includes(t)&&(n.reEditRect=a,n.setState({qrcodeType:t,qrcodeData:i||"",visible:!0}),window.collection("newui","value",window.pcTrack.newui.qrcode_insert))},n.handleClick=function(){n._checkDisabled()||(n.setState({visible:!0}),window.collection("newui","value",window.pcTrack.newui.qrcode_insert))},n.onClose=function(){n.setState({visible:!1,qrcodeType:_.TEXT,qrcodeData:""}),n.reEditRect=null},n.saveQRCode=function(e){var t=e.type,i=e.data,a=e.qrcode,o=e.size;if(0!==n.doc.getSlideCount())if(n.props.disabled)window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.serverError", "无法连接到服务器，请检查网络后重试。"));else{if(a){var r=a.cloneNode(!0);r.style.cssText="";var s={svgData:r.outerHTML,extParams:{type:t,data:i}};if(window.APP.coreAPI.beginCommand(n,!1,!0),n.reEditRect){n.reEditRect.isKeepShapeSize=!0,s.reEditPictureData=n.reEditRect,o=Math.max(n.reEditRect.width,n.reEditRect.height);var l=n.doc.svgLayout.scale;o=window.Ti2Px(window.Emu2Ti(o),l),s.img={width:o,height:o},window.APP.coreAPI.setCooperHandler("handlerQRCode"),n.editor.slide.modifyQRCode(s)}else s.img={width:o,height:o},window.APP.coreAPI.setCooperHandler("handlerQRCode",{insert:!0}),n.editor.slide.insertQRCode(s);window.APP.coreAPI.endCommand(),_.TEXT===t?window.collection("newui","value",window.pcTrack.newui.qrcode_insert_text):_.MECARD===t&&window.collection("newui","value",window.pcTrack.newui.qrcode_insert_card)}n.onClose()}else window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.noSlide", "当前无幻灯片，无法{0}二维码").replace("{0}",n.reEditRect?_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.edit", "编辑"):_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.insert", "插入")))},n.handleCopy=function(e,t){e&&n.editor.common.copyXClipBoard(e,t)},n.refBtn=u.a.createRef(),n.state={visible:!1,qrcodeType:_.TEXT},n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.initSearchKeywords(),this.on(this.uiEventTypes.pc.ON_EDIT_QRCODE,this.onEditQrcode),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"_checkDisabled",value:function(e){return!!this.props.disabled||(/^.pptx$/i.test(window.fileInfo.ext)?void 0:(window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.unSupport", "仅pptx格式文档可{0}二维码").replace("{0}",e?_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.edit", "编辑"):_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.insert", "插入"))),!0))}},{key:"render",value:function(){var e=this.props.disabled,t=this.state,n=t.visible,i=t.qrcodeType,a=t.qrcodeData;return u.a.createElement(u.a.Fragment,null,u.a.createElement(y.a,{disabled:e,ref:this.refBtn,iconType:b.qrcode,onClick:this.handleClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.qrCode", "二维码"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.QRCode.qrCode", "二维码")}),n&&Object(m.default)(w.a,{defaultValue:a,defaultType:i,onCancel:this.onClose,onOk:this.saveQRCode,onCopy:this.handleCopy}))}}]),t}(f.BaseComponent);t.default=C},6729:function(e,t,n){e.exports=function(e,t){n.e(343).then(n.bind(null,8172)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6730:function(e,t,n){},6731:function(e,t,n){},6732:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(6733),n(142)),u=n.n(p),h=n(168),f=n.n(h),m=n(183),v=n(148),w=n(166),g=n(203),y=n(179),b=n(1114),_=n.n(b),C=m.default.iconTypes.size16,T=window.__WPSPLUGIN__.helper,k=T.has(T.types.FileSelector),E=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.insertLocalPic=function(){n.props.disabled||(window.collection("newui","value",window.pcTrack.newui.pic_add_toolbar),n.fire(n.uiEventTypes.pc.picture.ON_PICTURE_INSERT),n.closePanel())},n.insertOnlinePic=function(){n.props.disabled||(n.fire(n.uiEventTypes.pc.picture.ON_PICTURE_INSERT,{isSelectOnline:!0}),n.closePanel())},n.insertCloudPic=function(){n.props.disabled||(n.fire(n.uiEventTypes.pc.picture.ON_PICTURE_INSERT,{isSelectCloud:!0}),n.closePanel())},n.initSearchKeywords=function(){var e=n.state.enableMaterial,t={el:n.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.title", "图片"),icon:C.picture,items:[{icon:C.picture,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.localPicture", "本地图片")}]};e&&t.items.push({icon:C.online_picture,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.onlinePicture", "在线图片")}),k&&t.items.push({icon:C.cloud_picture,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.cloudPicture", "云图片")}),window.__WPSENV__.commandbars.push(t)},n.closePanel=function(){n.setState({panelVisible:!1})},n.initSearchKeywords=n.initSearchKeywords.bind(n),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.refBtn=u.a.createRef(),n.state={panelVisible:!1,enableMaterial:T.has(T.types.Material)},n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"onUnBindEvent",value:function(){}},{key:"renderPanel",value:function(){var e=this.state.enableMaterial;return u.a.createElement(g.default,{className:"wpp-dropdown-submenu"},u.a.createElement(g.default.Item,{onClick:this.insertLocalPic},u.a.createElement(v.default,{type:C.picture}),u.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.localPicture", "本地图片"))),k&&u.a.createElement(g.default.Item,{onClick:this.insertCloudPic},u.a.createElement(v.default,{type:C.cloud_picture}),u.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.cloudPicture", "云图片"))),e&&u.a.createElement(g.default.Item,{onClick:this.insertOnlinePic},u.a.createElement(v.default,{type:C.online_picture}),u.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.onlinePicture", "在线图片"))))}},{key:"handleVisibleChange",value:function(e){this.setState({panelVisible:e})}},{key:"render",value:function(){var e=this.state.panelVisible,t=this.props.disabled,n=this.renderPanel();return u.a.createElement(w.default,{panel:n,visible:e,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:t},u.a.createElement(_.a,{disabled:t,selected:e,isDropdown:!0,ref:this.refBtn,iconType:C.picture,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.title", "图片"),title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Picture.title", "图片")}))}}]),t}(y.BaseComponent);E.propTypes={connected:f.a.bool,addBtnRef:f.a.func},t.default=E},6733:function(e,t,n){},6734:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(168)),r=(0,i.__importDefault)(n(512)),s=(0,i.__importDefault)(n(146)),l=(0,i.__importDefault)(n(183)),c=(0,i.__importStar)(n(679)),d=n(325),p=n(6735),u=(0,i.__importDefault)(n(1114)),h=(0,i.__importDefault)(n(3834)),f=window.pcTrack,m=l.default.iconTypes.size16,v=function(e){function t(t){var n=e.call(this,t)||this;return n.handleEdit=n.handleEdit.bind(n),n.handleSave=n.handleSave.bind(n),n.handlePictureUploadCompleted=n.handlePictureUploadCompleted.bind(n),n.handlePictureUploadError=n.handlePictureUploadError.bind(n),n.handleDialogClosed=n.handleDialogClosed.bind(n),n.initSearchKeywords=n.initSearchKeywords.bind(n),n.handleGetProcessonDetail=n.handleGetProcessonDetail.bind(n),n.state={isUploadingImage:!1,isEdit:!1,editData:null,formData:null,uploadUrl:void 0,processonAjaxParam:null,reEditPictureData:null,category:c.ProcessOnCategory.Flow,showPlugin:!1,shapeId:""},n.flowChartBtn=a.default.createRef(),n.mindMapBtn=a.default.createRef(),n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){window.addEventListener(s.default.names.processon.ON_PROCESSON_UPDATE,this.handleEdit),window.addEventListener(s.default.names.processon.ON_PROCESSON_GETDETAIL,this.handleGetProcessonDetail),c.isProcessOnAvailable&&(this.initSearchKeywords(),this.props.addBtnRef&&(this.props.addBtnRef(this.flowChartBtn,h.default.FlowChart),this.props.addBtnRef(this.mindMapBtn,h.default.MindMap)))},t.prototype.componentWillUnmount=function(){window.removeEventListener(s.default.names.processon.ON_PROCESSON_UPDATE,this.handleEdit),window.removeEventListener(s.default.names.processon.ON_PROCESSON_GETDETAIL,this.handleGetProcessonDetail)},t.prototype.initSearchKeywords=function(){window.__WPSENV__.commandbars.push([{el:this.flowChartBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.flowChart", "流程图"),icon:m.flow_chart},{el:this.mindMapBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.mindMap", "思维导图"),icon:m.mind_map}])},t.prototype.handleCreate=function(e){if(void 0===e&&(e=c.ProcessOnCategory.Flow),!this.props.disabled&&this.tryLock()){this.setState({editData:null,category:e,showPlugin:!0,isEdit:!1});var t=e===c.ProcessOnCategory.Flow?f.newui.process_toolbar:f.newui.mind_toolbar;window.collection("newui","value",t)}},t.prototype.tryLock=function(){return window.__WPSENV__.conflictLock.tryLock(!1)?(console.info("lock is fired"),!1):(s.default.dispatchEvent(s.default.names.cooper.ON_DOCUMENT_SAVEING_HOLDING_LOCK,{holdLocked:!0}),!0)},t.prototype.handleGetProcessonDetail=function(e){e&&e.detail&&this.setState({editData:e.detail,reEditPictureData:e.detail.reEditPictureData,showPlugin:!1})},t.prototype.handleEdit=function(e){if(e&&e.detail&&this.tryLock()){var t=e.detail.reEditPictureData,n=t&&Object.keys(t).length?{reEditPictureData:t}:{},a=window.APP.shell.doc.selection.getActiveShapes()[0].getId(),o=Object.assign({},{shapeId:String(a),editData:e.detail,showPlugin:!0,isEdit:!0},n);this.setState((0,i.__assign)({},o))}},t.prototype.handleSave=function(e){if(e&&0!==window.APP.shell.doc.getSlideCount()){e.reEditPictureData;var t=(0,i.__rest)(e,["reEditPictureData"]),n=e.positionInfo,a=(0,p.getResultByPositionInfo)(n).slide;a&&window.APP.shell.doc.selection.selectSlide(a),this.setState((0,i.__assign)((0,i.__assign)({},t),{isUploadingImage:!0}))}},t.prototype.handlePictureUploadCompleted=function(e){var t=this;this.setState({isUploadingImage:!1,editData:null});var n=window.APP.shell.editor.slide,a=this.state,o=a.file,r=a.reEditPictureData,s=a.processonAjaxParam,l=a.isEdit,c=a.successCallback,d=a.isRestoringBackupData,u=a.positionInfo,h=s.category,f=s.definition,m=s.fileid,v=JSON.parse(e.target.response),w=window.URL.createObjectURL(o),g=new Image;g.onload=function(){g.onload=null;var e={uploadId:v.uploadid,img:g,category:h,fileId:m,definition:f};if(l&&r)n.modifyShapeProcessOn((0,i.__assign)((0,i.__assign)({},e),{reEditPictureData:r}));else if(d){var a=(0,p.getResultByPositionInfo)(u).shape;if(a){var o=a.visual.getTransform2D();n.modifyShapeProcessOn((0,i.__assign)((0,i.__assign)({},e),{reEditPictureData:o,shapeList:[a]}))}else n.insertProcessOn(e);c&&c()}else n.insertProcessOn(e);t.resetState()},g.src=w},t.prototype.handlePictureUploadError=function(e){var t=(0,d.getError)(e);t&&window.Toast.error(t),this.resetState()},t.prototype.resetState=function(){this.setState({isUploadingImage:!1,editData:null,showPlugin:!1,isRestoringBackupData:!1,successCallback:null,positionInfo:null})},t.prototype.handleDialogClosed=function(){s.default.dispatchEvent(s.default.names.cooper.ON_DOCUMENT_SAVEING_HOLDING_LOCK,{holdLocked:!1}),this.resetState()},t.prototype.render=function(){var e=this.props,t=e.userId,n=e.disabled,i=e.readOnly,o=this.state,s=o.editData,l=o.isUploadingImage,d=o.formData,h=o.uploadUrl,f=o.category,v=o.showPlugin;return a.default.createElement(a.default.Fragment,null,c.isProcessOnAvailable&&a.default.createElement(a.default.Fragment,null,a.default.createElement(u.default,{disabled:n,ref:this.flowChartBtn,iconType:m.flow_chart,onClick:this.handleCreate.bind(this,c.ProcessOnCategory.Flow),title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.flowChart", "流程图"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.flowChart", "流程图")}),a.default.createElement(u.default,{disabled:n,ref:this.mindMapBtn,iconType:m.mind_map,onClick:this.handleCreate.bind(this,c.ProcessOnCategory.MindFree),title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.mindMap", "思维导图"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Processon.mindMap", "思维导图")})),a.default.createElement(a.default.Fragment,null,a.default.createElement(c.default,{isShow:v,category:f,editData:s,userId:t,onSave:this.handleSave,onClose:this.handleDialogClosed,getPositionInfo:p.getPositionInfo,isReadOnly:i}),l&&a.default.createElement(r.default,{visible:!1,url:h,formData:d,uploadTips:"",onComplete:this.handlePictureUploadCompleted,onError:this.handlePictureUploadError,onCancel:Function.prototype})))},t.propTypes={connected:o.default.bool.isRequired,userId:o.default.string},t}(a.PureComponent);t.default=v},6735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResultByPositionInfo=t.getPositionInfo=t.SlideCategory=void 0;var i,a=n(158);!function(e){e.Slides="slides",e.SlideMasters="slideMasters",e.SlideLayouts="slideLayouts"}(i=t.SlideCategory||(t.SlideCategory={})),t.getPositionInfo=function(){var e,t=window.APP.shell.doc.selection.getActiveSlide(),n=t.getId(),i=t.getCategory();try{e=window.APP.shell.doc.selection.getActiveShapes()[0].getDescription()}catch(e){}return{slideId:n,category:i,description:e}},t.getResultByPositionInfo=function(e){var t,n,o=e||{},r=o.slideId,s=o.description,l=o.category,c=((t={})[i.Slides]=a.WppLayerType.WppLayerNormalSlide,t[i.SlideMasters]=a.WppLayerType.WppLayerMasterSlide,t[i.SlideLayouts]=a.WppLayerType.WppLayerLayoutSlide,t)[l],d=window.APP.shell.coreView.coreData.getSlideById2(l,c,r);if(!d)return{};if(!s)return{slide:d};for(var p=d.getShapeCount(),u=0;u<p;u++){var h=d.getShapeAt(u);if(h.getShapeType()===a.ShapeType.Processon&&h.getDescription()===s){n=h;break}}return{slide:d,shape:n}}},6736:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(6737),n(142)),u=n.n(p),h=n(377),f=n(182),m=n(166),v=n(155),w=n(3835),g=n(158),y=n(1114),b=n.n(y),_=h.default.iconTypes,C=_.other,T=_.size16,k=[_i18n("applications.presentation.constants.insert_geometry_define.title_line_group", "线条"),_i18n("applications.presentation.constants.insert_geometry_define.title_rectangle_group", "矩形"),_i18n("applications.presentation.constants.insert_geometry_define.title_normal_group", "基本形状"),_i18n("applications.presentation.constants.insert_geometry_define.title_arrow_group", "箭头总汇"),_i18n("applications.presentation.constants.insert_geometry_define.title_formula_group", "公式形状"),_i18n("applications.presentation.constants.insert_geometry_define.title_process_group", "流程图"),_i18n("applications.presentation.constants.insert_geometry_define.title_starandflag_group", "星与旗帜"),_i18n("applications.presentation.constants.insert_geometry_define.title_callout_group", "标注"),_i18n("applications.presentation.constants.insert_geometry_define.title_action_group", "动作按钮")],E=["insert_line_group_geomerty","insert_rectangle_group_geomerty","insert_normal_group_geomerty","insert_arrow_group_geomerty","insert_formual_group_geomerty","insert_process_group_geomerty","insert_startandflag_group_geomerty","insert_callout_group_geomerty","insert_action_group_geomerty"],S=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onVisibleChange=n.onVisibleChange.bind(n),n.handleSelected=n.handleSelected.bind(n),n.state={list:w.a,visible:!1,selected:!1},n.refBtn=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.constants.insert_geometry_define.title", "形状"),icon:T.insert_panel_geomerty})}},{key:"onVisibleChange",value:function(e){this.setState({visible:e})}},{key:"handleSelected",value:function(e,t){var n=this;if(!this.props.disabled){var i=window.APP.shell.editor.slide;if(2!==e||0!==t&&1!==t){var a=void 0;e===g.ShapeGroupType.LineGroup&&11===t&&(a="cursor-free-curve-pen"),i.insertShape({cursorClass:a,data:{groupId:e,index:t}})}else{var o=void 0;o=0===t?"horizontal":"vertical",i.insertTextBox({data:{orientation:o},callback:function(){return n.setState({selected:!1})}})}this.setState({visible:!1})}}},{key:"renderItem",value:function(e){var t=this,n=e.groupId,i=e.items,a=k[n],o=E[n],r=i.map((function(e,a){var r=e.title,s=e.type;g.ShapeGroupType.LineGroup===n&&a===i.length-1&&(a=11);var l="position-off-"+a;return u.a.createElement("div",{className:"group-item-wrapper",key:n+"_"+s+"_"+a},u.a.createElement("div",{className:"group-item"}," ",u.a.createElement(v.default,{iconType:C[o],onClick:function(){t.handleSelected(n,a)},title:r,className:l})))})),s={height:24*(Math.floor(i.length/11)+1)};return u.a.createElement("div",{className:"insert_geomerty_panel",key:n},u.a.createElement("div",{className:"geomerty-group"},u.a.createElement("div",{className:"group-title"},a),u.a.createElement("div",{className:"group-content",style:s},r)))}},{key:"renderPanel",value:function(){var e=this,t=this.state.list.map((function(t){return e.renderItem(t)}));return u.a.createElement("div",{ref:function(t){e.rootView=t,t&&t.addEventListener("mousemove",(function(e){window.domTools.setCursor(),e.stopPropagation()}))}},u.a.createElement(f.default,{className:"wpp-insert-geomerty-wrapper",maxWidth:368},t))}},{key:"render",value:function(){var e=this.state.visible,t=this.renderPanel(),n=this.props.disabled;return u.a.createElement(m.default,{panel:t,visible:e,isSetHeight:!0,onVisibleChange:this.onVisibleChange,disabled:n},u.a.createElement(b.a,{disabled:n,iconBtnProps:{keepEdit:!0},selected:e,isDropdown:!0,ref:this.refBtn,iconType:T.insert_panel_geomerty,text:_i18n("applications.presentation.constants.insert_geometry_define.title", "形状"),title:_i18n("applications.presentation.constants.insert_geometry_define.title", "形状")}))}}]),t}(p.PureComponent);t.default=S},6737:function(e,t,n){},6738:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(168),f=n.n(h),m=n(155),v=n(166),w=n(179),g=n(3836),y=n(182),b=n(158),_=n(1114),C=n.n(_),T=m.default.iconTypes.size16,k=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSelect=function(e,t){console.log("insert table: "+e+" * "+t),window.collection("newui","value",window.pcTrack.newui.table_insert_toolbar);var i=n.selection.fetchAvailPh(b.PlaceholderType.Table);n.editor.slide.insertTable(e,t,i),n.setState({panelVisible:!1})},n.initSearchKeywords=n.initSearchKeywords.bind(n),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.refBtn=u.a.createRef(),n.panelRef=u.a.createRef(),n.state={panelVisible:!1,adjust:!1},n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"initSearchKeywords",value:function(){var e={el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.insertTable", "表格"),icon:T.insert_panel_table,items:[{icon:T.insert_panel_table,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.insertTable", "表格")}]};window.__WPSENV__.commandbars.push(e)}},{key:"handleVisibleChange",value:function(e){this.setState({panelVisible:e}),this.panelRef&&this.panelRef.current&&this.panelRef.current.onActive({row:0,column:0})}},{key:"render",value:function(){var e=this.state,t=e.panelVisible,n=e.adjust,i=this.props.disabled,a=u.a.createElement(y.default,null,u.a.createElement(g.a,{ref:this.panelRef,onSelect:this.onSelect,adjust:n}));return u.a.createElement(v.default,{panel:a,visible:t,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:i},u.a.createElement(C.a,{selected:t,disabled:i,isDropdown:!0,ref:this.refBtn,iconType:T.insert_panel_table,onClick:this.handleClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.table", "表格"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Table.table", "表格")}))}}]),t}(w.BaseComponent);k.propTypes={connected:f.a.bool,addBtnRef:f.a.func},t.default=k},6739:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=n(168),f=n.n(h),m=n(183),v=n(148),w=n(166),g=n(203),y=n(179),b=n(208),_=n(1114),C=n.n(_),T=m.default.iconTypes.size16,k=b.userAgent.isIPad&&/QQ\//i.test(b.userAgent.agent),E=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.insertAudio=function(){n.setState({panelVisible:!1}),n.isPPTXFile()?k?window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.unSupportInsertAudio", "当前浏览器不支持插入音频")):(n.fire(n.uiEventTypes.pc.media.ON_MEDIA_INSERT,{type:"audio"}),window.collection("newui","value",window.pcTrack.newui.insert_audio)):window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.unSupportFileToInsertMedia", "仅pptx格式文档可插入音视频"))},n.insertVideo=function(){n.setState({panelVisible:!1}),n.isPPTXFile()?k?window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.unSupportInsertVideo", "当前浏览器不支持插入视频")):(n.fire(n.uiEventTypes.pc.media.ON_MEDIA_INSERT,{type:"video"}),window.collection("newui","value",window.pcTrack.newui.insert_video)):window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.unSupportFileToInsertMedia", "仅pptx格式文档可插入音视频"))},n.handleVisibleChange=function(e){n.setState({panelVisible:e})},n.refBtn=u.a.createRef(),n.state={panelVisible:!1},n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"isPPTXFile",value:function(){var e=(window.__WPSENV__.file_info||{}).file;return".pptx"===(void 0===e?{}:e).ext}},{key:"initSearchKeywords",value:function(){var e={el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.title", "音视频"),icon:T.insert_audio,items:[{icon:T.insert_audio,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.insertAudio", "插入音频")},{icon:T.insert_video,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.insertVideo", "插入视频")}]};window.__WPSENV__.commandbars.push(e)}},{key:"renderPanel",value:function(){var e=this.props.disabled;return u.a.createElement(g.default,{className:"wpp-dropdown-submenu"},u.a.createElement(g.default.Item,{disabled:e,onClick:this.insertAudio},u.a.createElement(v.default,{type:T.insert_audio}),u.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.insertAudio", "插入音频"))),u.a.createElement(g.default.Item,{disabled:e,onClick:this.insertVideo},u.a.createElement(v.default,{type:T.insert_video}),u.a.createElement("span",{className:"item-name"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.insertVideo", "插入视频"))))}},{key:"render",value:function(){var e=this.state.panelVisible,t=this.renderPanel(),n=this.props.disabled;return u.a.createElement(w.default,{panel:t,visible:e,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:n},u.a.createElement(C.a,{selected:e,disabled:n,isDropdown:!0,ref:this.refBtn,iconType:T.insert_audio,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.title", "音视频"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Media.title", "音视频")}))}}]),t}(y.BaseComponent);E.propTypes={connected:f.a.bool,disabled:f.a.bool},t.default=E},6740:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importDefault)(n(142)),o=n(179),r=(0,i.__importDefault)(n(183)),s=(0,i.__importDefault)(n(1114)),l=r.default.iconTypes.size16.latex_formula,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.initSearchKeywords=function(){window.__WPSENV__.commandbars.push({icon:l,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.latex", "LaTeX"),el:t.refBtn})},t.onClick=function(){window.collection("newui","value",window.pcTrack.newui.lateX_insert),t.fire(t.uiEventTypes.pc.OPEN_LATEX_PANEL)},t.refBtn=a.default.createRef(),t}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)},t.prototype.render=function(){var e=this.props.disabled;return a.default.createElement(s.default,{disabled:e,ref:this.refBtn,iconType:l,onClick:this.onClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.latexMath", "LaTeX公式"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.latex", "LaTeX")})},t}(o.BaseComponent);t.default=c},6741:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(6742);var a=(0,i.__importDefault)(n(142)),o=(0,i.__importDefault)(n(166)),r=n(179),s=(0,i.__importDefault)(n(3656)),l=n(442),c=n(158),d=(0,i.__importDefault)(n(1114)),p=(0,i.__importDefault)(n(164)),u=function(e){function t(t){var n=e.call(this,t)||this;return n.refBtn=a.default.createRef(),n.onItemClick=function(e){var t=e.chartStyle,i=e.chartType,a=n.selection.fetchAvailPh(c.PlaceholderType.Chart);n.editor.slide.insertChart(i,t,a),n.handleVisibleChange(!1),window.collection("webui","value",window.pcTrack.webui.chart_insert)},n.handleClose=function(){n.handleVisibleChange(!1)},n.handleVisibleChange=function(e){n.setState({panelVisible:e})},n.state={panelVisible:!1},n}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)},t.prototype.initSearchKeywords=function(){var e={el:this.refBtn,text:l.groupTypes.all.text,icon:l.groupTypes.all.icon,items:[l.groupTypes.all,l.groupTypes.histogram,l.groupTypes.line,l.groupTypes.pie,l.groupTypes.bar,l.groupTypes.area,l.groupTypes.scatter,l.groupTypes.stock,l.groupTypes.radar]};window.__WPSENV__.commandbars.push(e)},t.prototype.renderPanel=function(){return(0,p.default)(s.default,{group:l.groupTypes.all,onClose:this.handleClose,onItemClick:this.onItemClick,hiddenGroups:[l.groupTypes.combo]})},t.prototype.render=function(){var e=this.state.panelVisible,t=this.renderPanel(),n=this.props.disabled;return a.default.createElement(o.default,{panel:t,visible:e,destroyOnHide:!1,onVisibleChange:this.handleVisibleChange,disabled:n},a.default.createElement(d.default,{selected:e,disabled:n,isDropdown:!0,ref:this.refBtn,iconType:l.groupTypes.all.icon,title:l.groupTypes.all.text,text:l.groupTypes.all.text}))},t}(r.BaseComponent);t.default=u},6742:function(e,t,n){},6743:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(183)),r=(0,i.__importDefault)(n(1114)),s=n(4547),l=o.default.iconTypes.size16;t.default=function(e){var t=this,n=e.addBtnRef,o=e.disabled,c=(0,a.useState)(!1),d=c[0],p=c[1],u=(0,a.useRef)(null);return(0,a.useEffect)((function(){(0,s.isShowEntry)().then((function(e){p(e)}))}),[]),(0,a.useEffect)((function(){d&&(n(u),window.__WPSENV__.commandbars.push({el:u,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.InsertDiagram.text", "关系图"),icon:l.wpp_insert_diagram}))}),[d]),d?a.default.createElement(r.default,{disabled:o,ref:u,iconType:l.wpp_insert_diagram,onClick:function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,s.getPlugin)()];case 1:return e.sent().showFigurePopup(),[2]}}))}))},title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.InsertDiagram.title", "带逻辑关系的图形组合"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.InsertDiagram.text", "关系图")}):null}},6744:function(e,t,n){e.exports=function(e,t){n.e(186).then(n.bind(null,8062)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6745:function(e,t,n){e.exports=function(e,t){n.e(187).then(n.t.bind(null,7626,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6746:function(e,t,n){},6747:function(e,t,n){},6748:function(e,t,n){},6749:function(e,t,n){},6750:function(e,t,n){},679:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isProcessOnAvailable=t.ISaveCallbackParam=t.IPluginEditData=t.IPluginRenderParams=t.IPropsOfProcessOnEditor=t.IProcessOnData=t.ProcessOnCategory=void 0;var i=n(143),a=(0,i.__importStar)(n(142)),o=n(1061);Object.defineProperty(t,"IProcessOnData",{enumerable:!0,get:function(){return o.IProcessOnData}}),Object.defineProperty(t,"IPropsOfProcessOnEditor",{enumerable:!0,get:function(){return o.IPropsOfProcessOnEditor}}),Object.defineProperty(t,"IPluginRenderParams",{enumerable:!0,get:function(){return o.IPluginRenderParams}}),Object.defineProperty(t,"IPluginEditData",{enumerable:!0,get:function(){return o.IPluginEditData}}),Object.defineProperty(t,"ISaveCallbackParam",{enumerable:!0,get:function(){return o.ISaveCallbackParam}});var r=n(1062);Object.defineProperty(t,"ProcessOnCategory",{enumerable:!0,get:function(){return r.ProcessOnCategory}});var s=n(1063),l=(0,i.__importDefault)(n(680)),c=(0,i.__importDefault)(n(1038)),d=(0,i.__importDefault)(n(164)),p=window.__WPSPLUGIN__.type.ProcessOn,u=n(144),h=n(292);t.isProcessOnAvailable=window.__WPSPLUGIN__.helper.has(p)&&!u.isPad,t.default=a.default.memo((function(e){var n=e.category,o=void 0===n?r.ProcessOnCategory.Flow:n,u=e.isShow,f=e.onError,m=void 0===f?Function.prototype:f,v=e.onClose,w=e.onSave,g=e.getPositionInfo,y=e.userId,b=e.isReadOnly,_=(0,a.useState)(!1),C=_[0],T=_[1],k=(0,a.useState)(null),E=k[0],S=k[1],P=(0,a.useState)(!1),R=P[0],O=P[1],I=(0,a.useState)(null),B=I[0],N=I[1],M=(0,a.useState)(null),D=M[0],L=M[1],A=(0,a.useRef)(D),x=(0,a.useState)(!1),W=x[0],F=x[1],V=(0,a.useState)(!1),H=V[0],K=V[1],U=(0,a.useState)(_i18n("applications.public.components.commandbars.Processon.errorNoticeOfFlow", "检测到你编辑的流程图异常退出，是否要恢复数据？")),j=U[0],z=U[1],G=u||C,X=E||e.editData;function q(){F(!1),T(!1),S(null),N(null),O(!1)}return(0,a.useEffect)((function(){G&&!D&&window.__WPSPLUGIN__.loader.loadSingleInstance({pluginType:p}).then((function(e){L(e),A.current=e})).catch((function(e){window.Toast.error(_i18n("applications.public.components.commandbars.Processon.networkError", "网络异常")),m(e),v()}))}),[G]),(0,a.useEffect)((function(){return function(){A.current&&A.current.unmount()}}),[]),(0,a.useEffect)((function(){b||(0,l.default)((function(e){var t=e.default.getInstance(),n=(0,s.getBackupKey)(),i=n.dataKey,a=n.timeKey;t.has(i).then((function(){t.read(a,(function(e,n){if(!e){var a=parseInt(window.localStorage.getItem("processonBackupExistenceTime"),10)||86400;Date.now()-n<=1e3*a?t.read(i,(function(e,t){if(!e){var n=JSON.parse(t);n.userId!==y?(0,s.deleteBackupData)():("flow"===n.processonData.category?z(_i18n("applications.public.components.commandbars.Processon.errorNoticeOfFlow", "检测到你编辑的流程图异常退出，是否要恢复数据？")):z(_i18n("applications.public.components.commandbars.Processon.errorNoticeOfMind", "检测到你编辑的思维导图异常退出，是否要恢复数据？")),K(!0),window.collection("commandbar","click","tips_continue_edit_po"))}})):(0,s.deleteBackupData)()}}))})).catch((function(e){console.debug(e)}))}))}),[]),G&&!!D&&t.isProcessOnAvailable&&D?(D.render({category:X?X.processonData.category:o,editData:X,onSave:function(e){var t=function(e){return function(){(0,s.deleteBackupData)(),e()}}(v);w((0,i.__assign)((0,i.__assign)({},e),{isRestoringBackupData:W,positionInfo:B,successCallback:t})),q()},onClose:function(e){v(),e&&!R&&(0,s.deleteBackupData)(),q()},onError:function(){O(!0),m(),window.report(h.TYPE.COUNT,"processon_save_error_500",1)},isShow:!0,onEditDataUpdate:function(e){var t=null;W&&B?t=B:"function"==typeof g&&(t=g()),(0,s.storeBackupData)(e,y,t)}}),null):H?(0,d.default)(c.default,{onOk:function(){window.collection("commandbar","click","continue_edit_po"),(0,l.default)((function(e){e.default.getInstance().read((0,s.getBackupKey)().dataKey,(function(e,t){if(!e){var n=JSON.parse(t);N(n.positionInfo),S({isProcessonEdit:!0,processonData:n.processonData}),T(!0),F(!0),K(!1)}}))}))},onCancel:function(){(0,s.deleteBackupData)(),F(!1),K(!1)},cancelBtnText:_i18n("applications.public.components.commandbars.Processon.refusedToRestore", "不恢复"),okBtnText:_i18n("applications.public.components.commandbars.Processon.restore", "恢复"),drag:!1},a.default.createElement("div",null,j)):(A.current&&A.current.unmount(),null)}))},680:function(e,t,n){e.exports=function(e,t){Promise.resolve().then(n.bind(null,576)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},697:function(e,t,n){"use strict";n.r(t);var i=n(164);n.d(t,"Loader",(function(){return i.default}));var a=n(311);n.d(t,"PubComponent",(function(){return a.PubComponent})),n.d(t,"WPPCustomEvent",(function(){return a.WPPCustomEvent}));var o=n(208);n.d(t,"userAgent",(function(){return o.userAgent})),n.d(t,"ViewModes",(function(){return o.ViewModes})),n.d(t,"VIEW_EVENT_TYPES",(function(){return o.VIEW_EVENT_TYPES})),n.d(t,"FocusTargetsDef",(function(){return o.FocusTargetsDef}))},725:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyAction",(function(){return a})),n.d(t,"KeyCode",(function(){return o})),n.d(t,"MouseButton",(function(){return r})),n.d(t,"MouseAction",(function(){return s})),n.d(t,"MenuText",(function(){return l}));var i=n(144),a={down:"down",up:"up",press:"press",inputText:"inputText"},o={enter:13,backspace:8,tab:9,space:32,delete:46,left:37,right:39,up:38,down:40,m:77,home:36,end:35},r={left:0,middle:1,right:2},s={clickSlide:0,clickText:1,rightClick:2,selectText:3,selectMultiShape:4,clickShape:5,insertShape:6,insertTextBox:7,movingShape:8,insertInk:9,moveContent:10,selectTableColumn:11,selectTableRow:12,selectTableBorderVert:13,selectTableBorderHori:14,clickTableCell:15,resizingShape:16,adjustingShape:17},l={copy:'<i class="icons icon-16 icons-context-copy"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.copy", "复制")+'</span><span class="short-cut">'+Object(i.convertCtrl)("Ctrl + C")+"</span>",paste:'<i class="icons icon-16 icons-context-paste"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.paste", "粘贴")+'</span><span class="short-cut">'+Object(i.convertCtrl)("Ctrl + V")+"</span>",cut:'<i class="icons icon-16 icons-context-cut"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.cut", "剪切")+'</span><span class="short-cut">'+Object(i.convertCtrl)("Ctrl + X")+"</span>",replace:'<i class="icons icon-16 icons-16-replace_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.replacePicture", "替换图片")+"</span>",download:'<i class="icons icon-16 icons-16-download_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.downloadPicture", "下载原图")+"</span>",matting:'<i class="icons icon-16 icons-16-matting_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.mattingPicture", "抠图")+"</span>",line:'<span class="divider-line"></span>',link:'<i class="icons icon-16 icons-context-hyperlink"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.link", "插入链接")+'</span><span class="short-cut">',openLink:'<i class="icons icon-16 icons-context-hyperlink"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.openLink", "打开链接")+'</span><span class="short-cut"></span>',editLink:'<i class="icons icon-16 icons-context-link_edit"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.editLink", "编辑链接")+'</span><span class="short-cut"></span>',cancelLink:'<i class="icons icon-16 icons-context-link_delete"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.cancelLink", "取消链接")+'</span><span class="short-cut"></span>',setSlideBg:'<i class="icons icon-16 icons-16-set_to_bg"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.setSlideBg", "设为背景")+"</span>",slideBg:'<i class="icons icon-16 icons-16-set_to_bg"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.slideBg", "设置背景")+"</span>"}},741:function(e,t,n){"use strict";n.r(t);t.default={xlArea:1,xlAreaStacked:76,xlAreaStacked100:77,xlBarClustered:57,xlBarOfPie:71,xlBarStacked:58,xlBarStacked100:59,xlBubble:15,xlColumnClustered:51,xlColumnStacked:52,xlColumnStacked100:53,xlDoughnut:-4120,xlLine:4,xlLineMarkers:65,xlLineMarkersStacked:66,xlLineMarkersStacked100:67,xlLineStacked:63,xlLineStacked100:64,xlPie:5,xlPieOfPie:68,xlRadar:-4151,xlRadarFilled:82,xlRadarMarkers:81,xlStockHLC:88,xlStockOHLC:89,xlStockVHLC:90,xlStockVOHLC:91,xlXYScatter:-4169,xlXYScatterLines:74,xlXYScatterLinesNoMarkers:75,xlXYScatterSmooth:72,xlXYScatterSmoothNoMarkers:73,xlComboColumnLine:113,xlComboColumnLineDoubleAxis:114,xlComboAreaStackedLine:115}},768:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143),a=(0,i.__importStar)(n(142)),o=(0,i.__importDefault)(n(160)),r=(0,i.__importDefault)(n(251)),s=(0,i.__importDefault)(n(994)),l=n(162),c=(0,i.__assign)((0,i.__assign)({},s.default[(0,l.getOfficeName)(window.officeType)]),s.default.$public),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.panelVisible=!1,t.refPanel=a.default.createRef(),t.refAlt=a.default.createRef(),t.isUnmount=!1,t.onVisibleChange=function(e){var n=t.props.onVisibleChange;t.panelVisible=e,n&&n(e)},t.getElement=function(){if(!t.isUnmount)return t.refAlt.current?t.refAlt.current.getElement():o.default.findDOMNode(t)},t.getAltChildren=function(){if(!t.panelVisible)return[];var e=t.props,n=e.refLazyPanel,i=e.altRef,a=i||t.refPanel,o=n?n.current:a.current;if(o){var r=o.getAltChildren;if(r)return r();var s=t.props.altChildIds;if((!s||0===s.length)&&t.refAlt.current){var l=t.props.commandBarId;s=t.refAlt.current.props.alt[l]}return s&&s.length>0&&t.refAlt&&t.refAlt.current?t.refAlt.current.getAltChildren():[]}return[]},t.getAltCfg=function(){var e=t.props.commandBarId;return c[e]?(0,i.__assign)((0,i.__assign)({},c[e]),{id:e}):{id:e}},t}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.commandBarId;r.default.pushRef(e,{ref:this})},t.prototype.componentWillUnmount=function(){this.isUnmount=!0;var e=this.props.commandBarId;r.default.remove(e)},t}(a.PureComponent);t.default=d},8055:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=n(142),u=n.n(p),h=(n(6721),n(149)),f=n(146),m=n(154),v=n.n(m),w=n(168),g=n.n(w),y=n(516),b=n(2673),_=n(6722),C=n(3834),T=n.n(C),k=n(156),E=n(237),S=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dropDownMenu:"",connected:n.props.connected,hasSlide:!0,btnList:_.BtnConfigList.slice()},n.handleWindowResize=function(e){if("number"==typeof e){if(n._childCount===e)return;n._childCount=e}n.debounceToggleTextShow(),n.debounceUpdateTabWrap()},n.debounceToggleTextShow=Object(k.debounce)((function(){n.toggleTextShow()}),200),n.toggleTextShow=function(){if(n.props.visible&&n.wrapRef.current){var e=n.wrapRef.current.getItemsWidth(),t=e.wrapWidth-e.allItemWidth;t<0&&n.hideSomeText(t),t>0&&n.showSomeText(t)}},n.handleDropDownMenuToggled=n.handleDropDownMenuToggled.bind(n),n.btnRefList=[],n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onSafeBindEvent",this).call(this),this.on(this.uiEventTypes.pc.TEXTTOOL_DROPDOWN_MENU,this.handleDropDownMenuToggled),this.debounceToggleTextShow(),window.addEventListener(E.default.eventTypes.pc.ON_CANVAS_RESIZE,this.handleWindowResize)}},{key:"onUnBindEvent",value:function(){this.btnRefList=[],v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUnBindEvent",this).call(this),window.removeEventListener(E.default.eventTypes.pc.ON_CANVAS_RESIZE,this.handleWindowResize)}},{key:"handleDropDownMenuToggled",value:function(e){var t=e.type,n=e.state,i=e.fontScale;t===this.state.dropDownMenu?n||("font_size"===t&&i&&1!==i&&document.body.classList.remove("fontStyle-adjust"),this.setState({dropDownMenu:""})):n&&("font_size"===t&&i&&1!==i&&document.body.classList.add("fontStyle-adjust"),this.setState({dropDownMenu:t}))}},{key:"hideSomeText",value:function(e){e=Math.abs(e);for(var t=this.btnRefList.length-1;t>=0;t--){var n=this.btnRefList[t],i=n.ref,a=n.textWidth,o=n.keepShowText;if(i&&i.current&&i.current.isTextShow()&&!o){if(e<0)break;i.current.toggleShowText(!1),e-=a}}}},{key:"showSomeText",value:function(e){for(var t=this.btnRefList.length,n=0;n<t;n++){var i=this.btnRefList[n],a=i.ref,o=i.textWidth;if(!i.keepShowText&&a&&a.current&&!a.current.isTextShow()){if(e-o<Math.max(o,24))break;a.current.toggleShowText(!0),e-=o}}}},{key:"addBtnRef",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=this.getConfigById(n||e);if(i&&t&&t.current){var a=i.keepShowText,o=void 0!==a&&a,r=i.idx,s=t.current.getTextWidth(),l=this.btnRefList.filter((function(e){return e.idx!==r}));l.push({ref:t,id:e,idx:r,keepShowText:o,textWidth:s}),l.sort((function(e,t){return e.idx>t.idx?1:-1})),this.btnRefList=l}}},{key:"getConfigById",value:function(e){return _.BtnConfigList.filter((function(t){return t.id===e}))[0]}},{key:"render",value:function(){var e=this,t=this.props,n=t.tabKey,i=t.visible,a=t.readOnly,o=t.connected,r=t.user,s=t.isOnline,l=this.state,c=l.hasSlide,d=l.btnList,p=!o||a||!s||!c;return u.a.createElement("div",{className:"wpp-insert-tab"},u.a.createElement(y.a,{ref:this.wrapRef,tabKey:n,visible:i},d.map((function(t){var n=t.id,i=t.Com,s=t.enabled,l=t.idx;return s&&i?n===T.a.Divider?u.a.createElement("div",{className:"wpp-insert-tab-divider",key:n+"_"+l},u.a.createElement(i,null)):u.a.createElement(i,{key:n,disabled:p,connected:o,userId:r.id,readOnly:a,addBtnRef:e.addBtnRef.bind(e,n)}):null}))))}}]),t}(b.a);S.propTypes={tabKey:g.a.string.isRequired,user:g.a.object.isRequired};var P=S,R=n(6744),O=n.n(R),I=n(6745),B=n.n(I),N=n(164),M=n(169),D=window.pcTrack,L=window.CommandBarComponent.cmbIds.wpp,A=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={activeTab:window.__wpp_activeTab||L.InsertTab,isOnline:!0,showCache:!1},n.handleKeydown=function(e){Object(M.isMatchShortCutKey)(e,[M.Keys.Ctrl,"F7"])&&n.toggleModal(!0)},n.handleClick=function(e){n._countClick=n._countClick||0,e&&e.target&&"tab-wrap"===e.target.className&&(n._countClick++,clearTimeout(n._timer),n._countClick>=5?(n._countClick=0,n.toggleModal(!0)):n._timer=setTimeout((function(){n._countClick=0,n._timer=null}),300))},n.toggleModal=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.setState({showCache:e})},n.handleSwitchTab=n.handleSwitchTab.bind(n),n.handleOnline=n.handleOnline.bind(n),n.handleOffline=n.handleOffline.bind(n),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(f.default.names.SWITCH_COMMANDBAR_TAB,this.handleSwitchTab),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline),window.addEventListener("keydown",this.handleKeydown),f.default.dispatchEvent(f.default.names.COMMAND_BAR_TABS_DID_MOUNT)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.default.names.SWITCH_COMMANDBAR_TAB,this.handleSwitchTab),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline),window.removeEventListener("keydown",this.handleKeydown)}},{key:"handleOnline",value:function(){this.setState({isOnline:!0})}},{key:"handleOffline",value:function(){this.setState({isOnline:!1})}},{key:"handleSwitchTab",value:function(e){var t=e.detail.tabKey;this.setState({activeTab:t}),window.__wpp_activeTab=t;var n=void 0;switch(t){case L.InsertTab:n=D.newui.insert_tab;break;case L.ReviewTab:n=D.newui.review_tab;break;case L.ViewTab:n=D.newui.view_tab;break;case L.PlayTab:n=D.newui.play_tab;break;default:n=D.newui.insert_tab}window.collection("newui","value",n)}},{key:"render",value:function(){var e=this.props,t=e.readOnly,n=e.dispatch,i=e.coreReady,a=this.state,o=a.activeTab,r=a.isOnline,s=a.showCache,l=this.props.public,c=l.user,d=l.file,p=l.network,h=l.cmb,f=p.openSuccess,m=p.connected,v="wpp-cmd-bar";return f&&!h.showGuide||(v+=" file-opening"),u.a.createElement("div",{className:v,onClick:this.handleClick},u.a.createElement(P,{tabKey:L.InsertTab,visible:o===L.InsertTab,dispatch:n,openSuccess:f,connected:m,readOnly:t,isOnline:r,user:c}),f&&i&&Object(N.default)(O.a,{activeTab:o,dispatch:n,openSuccess:f,connected:m,readOnly:t,isOnline:r,user:c,file:d}),s&&Object(N.default)(B.a,{onClose:this.toggleModal}))}}]),t}(p.PureComponent),x=Object(h.connect)((function(e){return e}),null,null,{forwardRef:!0})(A),W=n(155),F=n(144),V=W.default.iconTypes.size16,H=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.initSearchKeywords=n.initSearchKeywords.bind(n),n.refBtn=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords()}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.UndoRedo.redo", "恢复"),icon:V.redo,shortcut:"Ctrl+Y"})}},{key:"handleClick",value:function(){window.APP.shell.editor.common.redo()}},{key:"render",value:function(){var e=this.props.disabled;return u.a.createElement(W.default,{ref:this.refBtn,title:""+_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.UndoRedo.redo", "恢复")+Object(F.convertCtrl)("(Ctrl+Y)"),iconType:V.redo,disabled:e,onClick:this.handleClick})}}]),t}(p.PureComponent),K=W.default.iconTypes.size16,U=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=n.handleClick.bind(n),n.initSearchKeywords=n.initSearchKeywords.bind(n),n.refBtn=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.initSearchKeywords()}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.UndoRedo.undo", "撤销"),icon:K.undo,shortcut:"Ctrl+Z"})}},{key:"handleClick",value:function(){window.APP.shell.editor.common.undo()}},{key:"render",value:function(){var e=this.props.disabled;return u.a.createElement(W.default,{ref:this.refBtn,title:""+_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.UndoRedo.undo", "撤销")+Object(F.convertCtrl)("(Ctrl+Z)"),iconType:K.undo,disabled:e,onClick:this.handleClick})}}]),t}(p.PureComponent),j=(n(6746),function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={canRedo:!1,canUndo:!1,isOnline:!0},n.handleTransactChanged=n.handleTransactChanged.bind(n),n.handleOffline=n.handleOffline.bind(n),n.handleOnline=n.handleOnline.bind(n),n}return d()(t,e),r()(t,[{key:"componentDidMount",value:function(){window.addEventListener(f.default.names.TRANSACT_CHANGED,this.handleTransactChanged),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline),this.handleTransactChanged()}},{key:"componentWillUnmount",value:function(){window.removeEventListener(f.default.names.TRANSACT_CHANGED,this.handleTransactChanged),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline)}},{key:"handleOnline",value:function(){this.setState({isOnline:!0})}},{key:"handleOffline",value:function(){this.setState({isOnline:!1})}},{key:"handleTransactChanged",value:function(){var e=window.g_rpt;this.setState({canRedo:e.canRedo(),canUndo:e.canUndo()})}},{key:"render",value:function(){var e=this.state,t=e.canRedo,n=e.canUndo,i=e.isOnline,a=this.props,o=a.connected,r=a.readOnly,s=!i||!o||r;return u.a.createElement("div",{className:"undoredo-absolute"},u.a.createElement(U,{disabled:s||!n}),u.a.createElement(H,{disabled:s||!t}))}}]),t}(p.PureComponent)),z=n(147),G=n.n(z),X=(n(4548),n(179)),q=n(205),Y=n(476),Q=n(247),J=n(509),Z=n(1481),$=n(1480),ee=n(145),te=n(370),ne=[{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.allSlide", "全部幻灯片"),value:"all"},{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.curSlide", "当前幻灯片"),value:"this"}],ie=[{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.vertical", "竖向"),value:"vertical"},{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.horizontal", "横向"),value:"horizontal"}],ae=[{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.hasOutline", "加边框"),value:1},{content:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.noOutline", "不加边框"),value:0}],oe=[{content:"1",value:1},{content:"2",value:2},{content:"4",value:4},{content:"6",value:6},{content:"9",value:9}],re=function(e){function t(e){var n=this;a()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.hiddenModal=function(e){i.setState({modalVisible:!1,loading:!1})},i.showModal=function(e){i.setState({modalVisible:!0})},i.onOk=G()(regeneratorRuntime.mark((function e(){var t,a,o,r,s,l,c,d,p,u,h,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.state,a=t.loading,o=t.range,r=t.direction,s=t.outline,l=t.slideNum,!a){e.next=3;break}return e.abrupt("return");case 3:if(!i.unSupport){e.next=6;break}return window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.unSupportTip", "由于浏览器限制，建议使用系统浏览器")),e.abrupt("return");case 6:if(c=window.pcTrack.newui,window.collection("newui","value",i.isDownload?c.print_downPDF_button:c.print_next_button),window.collection("newui","value",c.print_range.replace("{0}",o)),window.collection("newui","value",c.print_amount.replace("{0}",l)),window.collection("newui","value",c.print_page_order.replace("{0}",r)),window.collection("newui","value",s?c.print_border_add:c.print_border_no),i.props.connected){e.next=16;break}return window.Toast.error(i.isDownload?_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.downloadFalse", "下载失败"):_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.printFalse", "打印失败")),e.abrupt("return");case 16:i.setState({loading:!0}),i.printTimer=setTimeout((function(){window.Toast.error(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.printTimeOut", "打印文件超时")),i.setState({loading:!1})}),6e4),d={multipage:l,optframe:!!s,order:"vertical"===r?1:2,printHiddenPage:!0},e.t0=o,e.next="this"===e.t0?22:26;break;case 22:return p=i.doc.getActiveSlideIdx(),d.from=p+1,d.to=p+1,e.abrupt("break",29);case 26:u=i.slideCount,d.from=1,d.to=u;case 29:return console.log("print options",d),h={options:d,format:"pdf",print:!i.isDownload},e.next=33,i.app.dispatch(Object(te.b)(h));case 33:if(f=e.sent,i.clearTime(),f&&!f.error){e.next=38;break}return i.setState({loading:!1}),e.abrupt("return");case 38:console.log("ppt export pdf success",f),m=f.response.body.url,i.isDownload?(ee.download(m),i.setState({loading:!1})):i.hasPreview?i.setState({previewVisible:!0,loading:!1},(function(){i.printer.print(m,"frame")})):(i.printer.print(m),i.hiddenModal());case 41:case"end":return e.stop()}}),e,n)}))),i.clearTime=function(){i.printTimer&&(clearTimeout(i.printTimer),i.printTimer=null)},i.onRangeChange=function(e){i.setState({range:e})},i.onSlideNumChange=function(e){i.setState({slideNum:e})},i.onDirectionChange=function(e){i.setState({direction:e})},i.onOutlineChange=function(e){i.setState({outline:e})},i.onCancelPreview=function(){i.setState({previewVisible:!1})},i.handlePrint=function(){i.printer.forcePrint()},i.handleOnCancel=function(){i.clearTime(),i.hiddenModal()},i.renderOption=function(){var e=i.state,t=e.range,n=e.direction,a=e.outline,o=e.slideNum;return u.a.createElement("div",{className:"oprate-wrap"},u.a.createElement("div",{className:"oprate-item-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.printRange", "打印范围：")),u.a.createElement(Y.default,{options:ne,value:t,onChecked:i.onRangeChange})),u.a.createElement("div",{className:"oprate-item-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.slideNum", "每页幻灯片数：")),u.a.createElement(Q.default,{className:"slide-num-select",showBorder:!0,options:oe,value:o,onChange:i.onSlideNumChange})),u.a.createElement("div",{className:"oprate-item-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.paperDirection", "纸张方向：")),u.a.createElement(Y.default,{options:ie,value:n,onChecked:i.onDirectionChange})),u.a.createElement("div",{className:"oprate-item-wrap"},u.a.createElement("div",{className:"title"},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.slideOutline", "幻灯片边框")),u.a.createElement(Y.default,{options:ae,value:a,onChecked:i.onOutlineChange})))},i.renderLayout=function(){for(var e=i.state,t=e.direction,n=e.outline,a=e.slideNum,o="print-slide slide-"+a+" "+(n?"border":""),r=[],s=0;s<a;s++){var l=u.a.createElement("div",{key:"print-slide-"+s,className:o},s+1);r.push(l)}return u.a.createElement("div",{className:"preview-img-wrap"},u.a.createElement("div",{className:"paper-wrap "+t},r,u.a.createElement("div",{className:"text"},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.slideNumEveryPage", "每页{0}张幻灯片").replace("{0}",a))))},i.hasPreview=F.isSougou||F.isLb||F.isWpsClient,i.isDownload=!F.isSupportPrint,i.unSupport=F.isTouchScreen&&!F.isSafari,i.state={okBtnText:i.isDownload?_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.downloadPDF", "下载PDF"):_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.next", "下一步"),range:"all",direction:"vertical",outline:1,slideNum:2,previewVisible:!1,loading:!1,modalVisible:!1},i.printer=new $.a({onEnd:function(){i.hiddenModal()},onError:function(e){window.Toast.error(e),i.setState({loading:!1})}}),i}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.state,t=e.okBtnText,n=e.previewVisible,i=e.loading,a=e.modalVisible;return u.a.createElement(p.Fragment,null,a&&u.a.createElement(q.default,{className:"ppt-print-modal "+(i?"loading":""),title:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.printSetting", "打印设置"),okBtnText:t,okDisabled:i,onOk:this.onOk,onCancel:this.handleOnCancel},u.a.createElement("div",{className:"print-content-wrap"},this.renderOption(),this.renderLayout()),this.isDownload&&u.a.createElement("div",{className:"download-tips"},"*"+_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.downloadTip", "当前浏览器不支持打印，建议您下载PDF文件打印"))),this.hasPreview&&n&&u.a.createElement(J.default,{className:"print-preview",onCancel:this.onCancelPreview},u.a.createElement(Z.a,{handleClose:this.onCancelPreview,handlePrint:this.handlePrint})))}}]),t}(X.BaseComponent),se=n(261),le=W.default.iconTypes.size16,ce=window.makeCommandBarComponent(X.BaseComponent),de=ce.cmbIds.$public,pe=function(e){function t(e){var n=this;a()(this,t);var i,o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,de.TabPrintPreview));return o.handleOnline=function(){o.setState({isOnline:!0})},o.handleOffline=function(){o.setState({isOnline:!1})},o.handleSlideChange=function(){var e=o.slideCount;o.setState({slideCount:e})},o.handlePrint=(i=G()(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.detail&&t.detail.shortcut&&window.collection("newui","value",window.pcTrack.newui.print_shortcut),o.app.canPrint()){e.next=4;break}return o.canRequestAuthForPrint?Object(se.requestForAuth)({type:se.AUTH_TYPES.PRINT}):window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.suppressPrint", "作者不允许打印文档")),e.abrupt("return");case 4:(i=o.slideCount)>0&&o.state.isOnline?o.modalRef&&o.modalRef.current.showModal():i<=0&&window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.nothingPrint", "未发现可打印内容"));case 6:case"end":return e.stop()}}),e,n)}))),function(e){return i.apply(this,arguments)}),o.handleClick=function(){o.handlePrint(),window.collection("newui","value",window.pcTrack.newui.print_toolbar)},o.state={slideCount:o.slideCount,isOnline:window.navigator.onLine},o.canRequestAuthForPrint=se.canRequestForAuthForSecurityDoc&&Object(se.isPrintLimitedSecurityDoc)(),o.refBtn=u.a.createRef(),o.modalRef=u.a.createRef(),o}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){window.addEventListener(f.default.names.file.ON_PRINT,this.handlePrint),this.doc.on(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleSlideChange),this.initSearchKeywords(),Object(ee.hasAutoPrint)()&&this.handlePrint()}},{key:"onUnBindEvent",value:function(){window.removeEventListener(f.default.names.file.ON_PRINT,this.handlePrint),this.doc.off(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleSlideChange)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.print", "打印"),icon:le.print,shortcut:"Ctrl+P"})}},{key:"__execute",value:function(){this.handleClick()}},{key:"render",value:function(){var e=this.state,t=e.slideCount,n=e.isOnline,i=this.props.connected,a=!this.app.canPrint()&&!this.canRequestAuthForPrint,o=!i||t<=0||!n||a;return u.a.createElement("div",{className:"print-btn-wrap"},u.a.createElement(W.default,{ref:this.refBtn,title:""+_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.Print.print", "打印")+(F.isIEPure?"":Object(F.convertCtrl)("(Ctrl+P)")),onClick:this.handleClick,iconType:le.print,disabled:o}),u.a.createElement(re,{ref:this.modalRef,connected:i}))}},{key:"slideCount",get:function(){var e=this.presentation.getSlideCount(),t=this.presentation.slidesPreviewLimit();return t>0&&t<=e&&(e=t),e}}]),t}(ce),ue=n(26),he=n.n(ue),fe=n(43),me=n.n(fe),ve=(n(4549),n(148)),we=n(390),ge=n(384),ye=n(192),be=n(388),_e=n(523),Ce=n(311),Te=W.default.iconTypes.size16,ke=ge.default.TabPane,Ee="search",Se="replaceCurrent",Pe="PREVIOUS",Re="NEXT",Oe="REPLACE",Ie="REPLACE_ALL",Be=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.autoFocus=Object(k.debounce)((function(){var e=n.state.replaceVisible&&""!==n.refFind.value,t=e?n.refReplace:n.refFind;t.focus(),e&&n.replaceValue&&(t.value=n.replaceValue),""!==t.value&&t.select()}),50),n.closeModal=function(){n.cancelFindResults(),n.props.closeModal()},n.cancelFindResults=function(){n.hasSetTransform&&n.setTransform(0,0),n.discardAllFindReuslts(),n.setState({isLoaded:!1,loading:!1,count:0})},n.handleTabChange=function(e){e===Ee?(n.setState({replaceVisible:!1},(function(){n.autoFocus()})),n.refReplace&&""!==n.refReplace.value&&(n.replaceValue=n.refReplace.value),window.collection("newui","value",window.pcTrack.newui.find_lookuptab)):e===Se&&(n.setState({replaceVisible:!0},(function(){n.autoFocus()})),window.collection("newui","value",window.pcTrack.newui.find_replacetab))},n.handleIconClick=function(){if(n.props.online){var e=n.state.keyword;n.buttonType=Re,document.lockFocus=!0,e&&(n.find(),window.collection("newui","value",window.pcTrack.newui.find_icon))}},n.find=function(){var e=n.state,t=e.count,i=e.isLoading,a=e.isLoaded;if(!i){if(!n.forceFind&&t&&n.buttonType===Re&&a)return n.nextItem(),!1;if(n.selection.getSlideCount()){n._searcherStartTime=window.performance.now();var o=n.refFind.value;n.textSearcher=n.selection.getPresentation().searcherMgr.startNewSearch("text"),n.textSearcher.search(o),n.buttonType===Pe&&n.textSearcher.setDefSearchDirect(!1)}else n.setState({searchNone:!0,isLoaded:!0,count:0})}},n.handleSearchFinish=function(e){if(e&&e.atEnd()){n.eventMap={};var t=n.textSearcher.count;if(t){var i=n.textSearcher.getResultByParams();i&&i.forEach((function(e){n.reRenderEvent(e)})),window.collection("experience",{event:"reading_find",times:Math.round(window.performance.now()-n._searcherStartTime)}),n.setState({searchNone:!1,isLoaded:!0,count:t,isLoading:!1},(function(){n.buttonType===Oe?n.replaceCurrent():n.buttonType===Ie&&n.replaceAll(),n.buttonType===Re&&n.state.currentIndex<0?n.nextItem():n.buttonType===Pe&&n.state.currentIndex<0&&n.prevItem()})),n.forceFind=!1,n._needSetTransform=!0}else n.setState({searchNone:!0,count:0,isLoaded:!0,isLoading:!1})}},n.transformXY=Object(k.debounce)((function(e,t){if(e&&t){var i=e.getId(),a=n.coreView.thumbnail||n.coreView.doc,o=t.getId(),r=a.getSlideViewById(o),s=r&&r.getShape(i),l=s&&s.layout();if(l){var c=n.coreView.doc.layoutResult,d=c.svgLayout,p=c.bestZoom,u=c.autoZoom,h=c.containerSize,f=p>u,m=l&&l.getViewRectPx(p),v=Math.max(40,h.width-d.width)/2,w=Math.max(15,h.height-d.height)/2;f&&(v+=40,w+=15);var g=h.width,y=h.height,b=-v,_=-w;if(m){var C=0,T=0,k=void 0,E=window.Rect;if(n.selection.state===_e.SelectType.select_text)n.genSelRange(e,l).forEach((function(e){e.forEach((function(e){var t=new E(e.x,e.y,e.width+40,e.height+40);k=k||t,k=n._calcRect(k,t)}))}));var S=new window.Rect(m.x,m.y,m.width+20,m.height+20);(S.width()>g||S.height()>y)&&k&&(S=k);var P=S.topLeft(),R=P.x(),O=P.y(),I=S.bottomRight(),B=I.x(),N=I.y();R<b?C=R-b-20:B>g+b&&(C=B-(g+b)),O<_?T=O-_-20:N>y+_&&(T=N-(y+_)),n.setTransform(C,T)}}}}),100),n.setTransform=Object(k.debounce)((function(e,t){Ce.WPPCustomEvent.dispatchEvent(Ce.WPPCustomEvent.eventTypes.names.ON_EDITVIEW_SCROLL_UPDATE,{x:e,y:t,updateMenu:!0})}),100),n.selectionChange=Object(k.debounce)((function(){var e=n.selection.getActiveSlide(),t=n.selection.getActiveShapes();t&&n._needSetTransform&&t.forEach((function(t){n.transformXY(t,e)})),n._needSetTransform=!1}),200),n.handleSearchResultChanged=function(e){var t=e.item;if(!n.replacing)if(t&&n.textSearcher.atEnd()){n.reRenderEvent(t);var i=n.textSearcher.count;console.log("*******handleSearchResultChanged",i),i<=0?n.setState({searchNone:!0,count:0,isLoaded:!1}):n.setState({count:i})}else if(!n.state.isLoading){var a=n.loadingOverTime;n._searcherStartTime&&window.performance.now()-n._searcherStartTime>a&&(console.log("**********SearchOverTime  isloading",window.performance.now()-n._searcherStartTime),n.setState({isLoading:!0}))}},n.handleSearchIndexChange=Object(k.debounce)((function(e){var t=e.index;n.replacing||(t>=0?n.setState({currentIndex:t}):(n.setState({currentIndex:-1}),n.forceFind=!0))}),50),n.handleSearchResultAdd=function(e){e.item},n.handleSearchResultRemove=function(e){e.item},n.handleDocInit=function(){n._unBindTextSearcher(),n._initTextSearcher(),n.setState({currentIndex:-1,isLoaded:!1,isLoading:!1,count:0}),n.forceFind=!0},n.handleKeyBoardEvent=function(e){if(n.props.online)switch(e.keyCode){case be.a.ENTER:n.state.keyword&&(e.preventDefault(),n.handleNextBtn(),window.collection("newui","value",window.pcTrack.newui.find_enter_shortcut));break;case be.a.DOWN:e.preventDefault(),n.state.keyword&&!Object(be.d)(e)&&n.nextItem();break;case be.a.UP:e.preventDefault(),n.state.keyword&&!Object(be.d)(e)&&n.prevItem();break;case be.a.F3:e.preventDefault(),Object(be.f)(e)?n.state.keyword&&(n.handlePrevBtn(),window.collection("newui","value",window.pcTrack.newui.find_previous_shortcut)):n.state.keyword&&(n.handleNextBtn(),window.collection("newui","value",window.pcTrack.newui.find_next_shortcut));break;case be.a.G:F.isMacOs&&Object(be.d)(e)&&(e.preventDefault(),Object(be.f)(e)?n.state.keyword&&(n.handlePrevBtn(),window.collection("newui","value",window.pcTrack.newui.find_previous_shortcut)):n.state.keyword&&(window.collection("newui","value",window.pcTrack.newui.find_next_shortcut),n.handleNextBtn()))}},n.handlePrevBtn=function(e){n.buttonType=Pe;var t=n.state.isLoaded;document.lockFocus=!0,!t||n.forceFind?n.find():n.prevItem(),e&&window.collection("newui","value",window.pcTrack.newui.find_previous)},n.handleNextBtn=function(e){n.buttonType=Re;var t=n.state.isLoaded;document.lockFocus=!0,!t||n.forceFind?n.find():n.nextItem(),e&&window.collection("newui","value",window.pcTrack.newui.find_next)},n.nextItem=function(){n.state.isLoaded&&(n.textSearcher.toNext(),n._needSetTransform=!0)},n.prevItem=function(){n.state.isLoaded&&(n.textSearcher.toPrev(),n._needSetTransform=!0)},n.handleInputChange=function(e){n.setState({keyword:e.target.value,count:0,isLoaded:!1,searchNone:!1}),n.forceFind=!0,n.cancelFindResults()},n.handleReplaceChange=function(e){n.replaceValue=n.refReplace.value},n.replaceCurrent=function(){if(n.props.online){document.lockFocus=!0;var e=n.refReplace.value;n.textSearcher.count>0?(n.textSearcher.replace(e),window.collection("newui","value",window.pcTrack.newui.find_replace)):(n.buttonType=Re,n.find())}},n.replaceAll=function(){if(n.props.online)if(n.state.isLoaded){var e=n.refReplace.value,t=n.textSearcher.count;if(n.replacing=!0,n.textSearcher._searchData===e)window.Toast.success(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceSame", " 已将查找内容全部替换"),null,2),n.cancelFindResults();else{var i=t>0&&n.textSearcher.replaceAll(e);n.replacing=!1,i&&(window.Toast.success(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceAllSuccess", "替换完成，共完成{*}处替换").replace("{*}",t),null,2),window.collection("newui","value",window.pcTrack.newui.find_replace_all),n.cancelFindResults())}}else n.buttonType=Ie,n.find()},n.replaceNameRef=u.a.createRef(),n.findNameRef=u.a.createRef(),n.state={position:e.position,keyword:"",querying:!1,isLoaded:!1,currentIndex:0,isLoading:!1,replaceVisible:e.replaceVisible},n.lastFindResult=null,n.eventMap={},n.slideUil=document.querySelector("#uil-content"),n.slidePool=window.SlidePool.getInstance(),n.loadingOverTime=1e3,n}return d()(t,e),r()(t,[{key:"_initTextSearcher",value:function(){this.textSearcher=this.selection.getPresentation().searcherMgr.ensureSearcher("text"),this.textSearcher.on(this.viewEventTypes.SEARCH_RESULT_CHANGED,this.handleSearchResultChanged),this.textSearcher.on(this.viewEventTypes.SEARCH_RESULT_ADD,this.handleSearchResultChanged),this.textSearcher.on(this.viewEventTypes.SEARCH_RESULT_REMOVE,this.handleSearchResultChanged),this.textSearcher.on(this.viewEventTypes.SEARCH_AT_END,this.handleSearchFinish),this.textSearcher.on(this.viewEventTypes.SEARCH_INDEX_CHANGE,this.handleSearchIndexChange)}},{key:"_unBindTextSearcher",value:function(){this.textSearcher&&(this.textSearcher.off(this.viewEventTypes.SEARCH_RESULT_CHANGED,this.handleSearchResultChanged),this.textSearcher.off(this.viewEventTypes.SEARCH_RESULT_ADD,this.handleSearchResultChanged),this.textSearcher.off(this.viewEventTypes.SEARCH_RESULT_REMOVE,this.handleSearchResultChanged),this.textSearcher.off(this.viewEventTypes.SEARCH_AT_END,this.handleSearchFinish),this.textSearcher.off(this.viewEventTypes.SEARCH_INDEX_CHANGE,this.handleSearchIndexChange))}},{key:"onSafeBindEvent",value:function(){this._initTextSearcher(),this.doc.on(this.viewEventTypes.SELECT_SHAPE_CHANGE,this.selectionChange),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.handleDocInit),window.addEventListener("keydown",this.handleKeyBoardEvent),this.autoFocus(),this.adjustUI()}},{key:"onUnBindEvent",value:function(){this._unBindTextSearcher(),this.doc.off(this.viewEventTypes.SELECT_SHAPE_CHANGE,this.selectionChange),this.cancelFindResults(),window.removeEventListener("keydown",this.handleKeyBoardEvent),document.lockFocus=!1}},{key:"componentDidUpdate",value:function(){v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.adjustUI()}},{key:"discardAllFindReuslts",value:function(){var e=this;if(this.textSearcher){var t=this.textSearcher.getResultByParams();this.textSearcher.discard(),t&&t.forEach((function(t){e.reRenderEvent(t)}))}}},{key:"getEvent",value:function(e){if(e){var t=e.getState();if(t&&t.slideId&&t.shapeIds)return{type:"hasShapeFocus",slideId:t.slideId,shapeIds:t.shapeIds}}}},{key:"reRenderEvent",value:function(e){var t=this.getEvent(e);t&&this.slidePool.reRender(t)}},{key:"genSelRange",value:function(e,t){var n=this.selection,i=[],a=n.getRange();if(e.getTableFrame()){var o=n.getActiveTableCells();o instanceof Array&&o.filter(Boolean).forEach((function(e){var n;(n=i).push.apply(n,me()(t.getSelectRectByGcp(he()({},a,{cellIndex:e.getIdx()}))))}))}else i=t.getSelectRectByGcp(he()({},a));return i}},{key:"_calcRect",value:function(e,t){if(!e.isQRect||!t.isQRect)return console.error("not rect"),!1;var n=e.left()<t.left()?e.left():t.left(),i=e.right()>t.right()?e.right():t.right(),a=e.top()<t.top()?e.top():t.top(),o=e.bottom()>t.bottom()?e.bottom():t.bottom();return new window.Rect(n,a,i-n,o-a)}},{key:"_createFindReplaceTabs",value:function(){var e=u.a.createElement("div",{className:"header_tabname"},u.a.createElement("span",null,_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceCurrent", "替换"))),t=u.a.createElement("div",{className:"header_tabname"},u.a.createElement("span",null,_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.search", "查找"))),n=this.state.replaceVisible?Se:Ee;return u.a.createElement(ge.default,{activeKey:n,onChange:this.handleTabChange},u.a.createElement(ke,{tab:t,tabKey:Ee}),u.a.createElement(ke,{tab:e,tabKey:Se,disabled:this.props.readOnly}))}},{key:"adjustUI",value:function(){if(this.findNameRef.current&&this.replaceNameRef.current){var e=this.replaceNameRef.current.offsetWidth;this.findNameRef.current.style.width=e+"px"}}},{key:"render",value:function(){var e=this,t=this.state,n=t.position,i=t.querying,a=t.keyword,o=t.replaceVisible,r=t.count,s=t.currentIndex,l=t.searchNone,c=t.isLoading,d=t.isLoaded,h=this.props.online,f=this._createFindReplaceTabs(),m=!a||i||!h;return u.a.createElement(p.Fragment,null,u.a.createElement(we.a,{title:f,isAllDrag:!1,onClose:this.closeModal,className:"find_replace_modal",position:n,ref:this.miniThumbnailRef},u.a.createElement("div",{className:"find-replace-panel-wrapper"},u.a.createElement("div",{className:"find-replace-panel"},u.a.createElement("div",{className:"find-menu-container"},o&&u.a.createElement("div",{className:"find_replace_name",ref:this.findNameRef},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.search", "查找")),u.a.createElement("div",{className:"find-input-container"},u.a.createElement(ve.default,{type:Te.search,disabled:!a||i||!h,className:"find-input-icon "+(m?"disabled":""),onClick:function(){return e.handleIconClick()}}),u.a.createElement("input",{ref:function(t){return e.refFind=t},type:"text",maxLength:"1000",autoFocus:!0,placeholder:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.placeHolderFind", "输入查找内容"),className:"keyword-input"+(a.length&&!i?" has-value":""),onChange:this.handleInputChange}),r>0&&s>=0&&u.a.createElement("div",{className:"status_find_index"}," ",s+1,"/",r),c&&u.a.createElement(ve.default,{type:"16 loading"}),u.a.createElement(W.default,{iconType:Te.et_find_pre,disabled:!a||i||!h,onClick:this.handlePrevBtn,className:(a.length?"":" disable")+" border_left",title:F.isMacOs?F.convertCtrl(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.prevOne_mac", "上一个(Ctrl+Shift+g)")):_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.prevOne", "上一个(Shift+F3)")}),u.a.createElement(W.default,{iconType:Te.et_find_pre,className:"transform180 "+(a.length?"":" disable")+" border_right",disabled:!a||i||!h,onClick:this.handleNextBtn,title:F.isMacOs?F.convertCtrl(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.nextOne_mac", "下一个(Ctrl+g)")):_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.nextOne", "下一个(F3)")}))),o&&u.a.createElement("div",{className:"find-menu-container"},u.a.createElement("div",{className:"find_replace_name",ref:this.replaceNameRef},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceTo", "替换为")),u.a.createElement("div",{className:"find-input-container"},u.a.createElement("input",{ref:function(t){return e.refReplace=t},type:"text",maxLength:"1000",placeholder:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.placeHolderReplace", "输入替换内容"),className:"keyword-input"+(a.length&&!i?" has-value":""),onChange:this.handleReplaceChange}))),l&&r<1&&d&&u.a.createElement("div",{className:"find_replace_none"},u.a.createElement("div",{className:"find_replace_none_text "+(o?"find_replace_none_left":"")},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.findNoResultTips", "未找到匹配内容")))),o&&u.a.createElement("div",{className:"component-replace-btn-container"},u.a.createElement(ye.default,{className:"component-replace-all-btn",onClick:this.replaceAll,disabled:!h||!a||d&&!r},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceAll", "全部替换")),u.a.createElement(ye.default,{className:"component-replace-current-btn",onClick:this.replaceCurrent,disabled:!h||!a||d&&!r},_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.replaceCurrent", "替换"))))))}}]),t}(X.BaseComponent),Ne=n(1874),Me=n(208),De=window.CommandBarComponentFragment,Le=De.cmbIds.wpp,Ae=W.default.iconTypes.size16,xe=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleOnline=function(){n.setState({online:!0})},n.handleOffline=function(){n.setState({online:!1})},n.onFindEvent=function(e){e.preventDefault();var t=n.doc.getMode();n.isOpenInkEditor||t!==Me.ViewModes.EditView&&t!==Me.ViewModes.MasterView||(n.handleSearch(),window.collection("newui","value",window.pcTrack.newui.find_lookup_shortcut))},n.onReplaceEvent=function(e){e.preventDefault();var t=n.doc.getMode();n.props.readOnly||n.isOpenInkEditor||t!==Me.ViewModes.EditView&&t!==Me.ViewModes.MasterView||(n.handleSearch(!0),window.collection("newui","value",window.pcTrack.newui.find_replacetab_shortcut))},n.openInkEditor=function(){n.props.readOnly||(n.setState({showFindReplaceModal:!1}),n.isOpenInkEditor=!0)},n.closeInkEditor=function(){n.isOpenInkEditor=!1},n.handleModeChange=function(){var e=n.doc.getMode();e!==Me.ViewModes.EditView?(n.showPanelAfterPreview=e===Me.ViewModes.PreView&&n.state.showFindReplaceModal,n.setState({showFindReplaceModal:!1})):n.showPanelAfterPreview&&(n.setState({showFindReplaceModal:!0}),n.showPanelAfterPreview=!1)},n.handleThumbnailUpdate=function(){var e=n.doc.getSlideCount();e!==n.state.slideCount&&n.setState({slideCount:e})},n.handleSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.doc.getMode(),i=n.props.connected,a=!(i&&n.state.online);if(!(n.isOpenInkEditor||t!==Me.ViewModes.EditView&&t!==Me.ViewModes.MasterView||a)){var o=n.doc.getSlideCount();n.state.showFindReplaceModal&&n.refFindReplaceModal?n.refFindReplaceModal.replaceVisible!==e?n.refFindReplaceModal.setState({replaceVisible:e},(function(){n.refFindReplaceModal.autoFocus()})):n.refFindReplaceModal.autoFocus():o>0&&n.setState({showFindReplaceModal:!0,replaceVisible:e})}},n.handleClick=function(){n.handleSearch(),window.collection("newui","value",window.pcTrack.newui.find_toolbar)},n.closeModal=function(){n.setState({showFindReplaceModal:!1})},n.getPosition=function(){var e=n.props.isPanelVisible("formatBrush");return{left:window.rightToLeft?"auto":e?502:302,right:window.rightToLeft?e?1078:1300:"auto",top:99}},n.state={slideCount:n.doc.getSlideCount(),showFindReplaceModal:!1,replaceVisible:!1,online:!0},n.refBtn=u.a.createRef(),n.refFindReplaceModal=u.a.createRef(),n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(this.viewEventTypes.THUMBNAIL_UPDATE,this.handleThumbnailUpdate),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.handleThumbnailUpdate),this.on(this.eventTypes.names.ON_OPEN_INK_EDITOR,this.openInkEditor),this.on(this.eventTypes.names.ON_CLOSE_INK_EDITOR,this.closeInkEditor),this.uilHotkeys.on([Ne.a.CONTAINER,Ne.a.SLIDE,Ne.a.SHAPE],"keydown",{keyCode:Ne.b.F,ctrlKey:!0,global:!0},this.onFindEvent),this.uilHotkeys.on([Ne.a.CONTAINER,Ne.a.SLIDE,Ne.a.SHAPE],"keydown",{keyCode:Ne.b.H,ctrlKey:!0,global:!0},this.onReplaceEvent),this.initSearchKeywords()}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.THUMBNAIL_UPDATE,this.handleThumbnailUpdate),this.doc.off(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.uilHotkeys.off([Ne.a.CONTAINER,Ne.a.SLIDE,Ne.a.SHAPE],"keydown",{keyCode:Ne.b.F,ctrlKey:!0,global:!0},this.onFindEvent),this.uilHotkeys.off([Ne.a.CONTAINER,Ne.a.SLIDE,Ne.a.SHAPE],"keydown",{keyCode:Ne.b.H,ctrlKey:!0,global:!0},this.onReplaceEvent)}},{key:"componentDidUpdate",value:function(e,n){v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.state.showFindReplaceModal!==n.showFindReplaceModal&&this.props.setPanelVisible("findReplace",this.state.showFindReplaceModal)}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.findReplace", "查找替换"),icon:Ae.find,shortcut:"Ctrl+F"})}},{key:"render",value:function(){var e=this,t=this.state,n=t.slideCount,i=t.showFindReplaceModal,a=t.online,o=t.replaceVisible,r=this.props,s=r.connected,l=r.readOnly,c=r.isPanelVisible,d=n<=0||!(s&&a),p=this.getPosition();return u.a.createElement("div",{className:"find-btn-wrap"},u.a.createElement(De,{cmbId:Le.Find},u.a.createElement(W.default,{ref:this.refBtn,title:""+_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FindReplace.findReplace", "查找替换")+Object(F.convertCtrl)("(Ctrl+F)"),onClick:this.handleClick,iconType:Ae.find,disabled:d})),i&&u.a.createElement(Be,{ref:function(t){return e.refFindReplaceModal=t},replaceVisible:o,closeModal:this.closeModal,readOnly:l,online:s&&a,isPanelVisible:c,position:p}))}}]),t}(X.BaseComponent),We=n(310),Fe=(n(6747),n(6748),n(6749),n(151)),Ve=n.n(Fe),He=n(158),Ke=[{title:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.formatBrush", "格式刷"),icon:"brush_format",value:He.FormatBrushType.Common,tip:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.brushTip", "将所选对象的{0}应用到其它对象（双击可连续使用）").replace("{0}",_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.format", "格式"))},{title:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.positionFormat", "位置刷"),icon:"brush_position",value:He.FormatBrushType.Transform2D,tip:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.brushTip", "将所选对象的{0}应用到其它对象（双击可连续使用）").replace("{0}",_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.position", "位置"))},{title:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.animeFormat", "动画刷"),icon:"brush_anime",value:He.FormatBrushType.Animation,tip:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.brushTip", "将所选对象的{0}应用到其它对象（双击可连续使用）").replace("{0}",_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.anime", "动画"))}],Ue=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemSingleClick=function(e){clearTimeout(n.singleClickTimer),n.singleClickTimer=setTimeout((function(){n.props.onItemClick(e,!1)}),200)},n.onItemDoubleClick=function(e){clearTimeout(n.singleClickTimer),n.props.onItemClick(e,!0)},n.renderItems=function(){var e=n.props,t=e.type,i=e.disabled;return Ke.map((function(e){return u.a.createElement(je,he()({key:e.value,onClick:n.onItemSingleClick,onDoubleClick:n.onItemDoubleClick,activeType:t,disabled:i},e))}))},n.onClose=function(e){n.props.onClose(e)},n.modalRef=u.a.createRef(),n.position=e.position,n.multiClick=0,n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){var e=this;setTimeout((function(){var t=e.selection.getActiveShapes();t&&0!==t.length||e.modalRef.current&&e.modalRef.current.element.focus()}),300)}},{key:"render",value:function(){return u.a.createElement(we.a,{ref:this.modalRef,className:"format-brush-panel",onClose:this.onClose,position:this.position},u.a.createElement("div",{className:"content-header"},u.a.createElement(W.default,{className:"close-btn",iconType:ve.default.types.size16.close,onClick:this.onClose})),u.a.createElement("div",{className:"content-wrap"},this.renderItems()))}}]),t}(X.BaseComponent),je=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.lastTouchEndTime=0,i.onClick=function(e){i.props.disabled||i.props.onClick(i.props.value,e)},i.onDoubleClick=function(e){i.props.disabled||i.props.onDoubleClick(i.props.value,e)},i.onTouchEnd=function(e){Date.now()-i.lastTouchEndTime<300&&i.onDoubleClick(e),i.lastTouchEndTime=Date.now()},o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,i=e.activeType,a=e.value,o=e.tip,r=e.disabled,s=u.a.classNames({selected:i===a,"format-item-wrap":1,disabled:r});return u.a.createElement(Ve.a,{title:o},u.a.createElement("div",{className:s,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onTouchEnd:this.onTouchEnd},u.a.createElement(ve.default,{type:ve.default.types.size24[t]}),u.a.createElement("div",{className:"format-type-title"},n)))}}]),t}(p.PureComponent),ze=W.default.iconTypes.size16,Ge=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={showPanel:!1,type:null,slideCount:i.doc.getSlideCount(),online:window.navigator.onLine},i.refBtn=u.a.createRef(),i.handleOnline=function(){i.setState({online:!0})},i.handleOffline=function(){i.setState({online:!1})},i.onThumbnailUpdate=function(){i.slideCount!==i.state.slideCount&&i.setState({slideCount:i.slideCount})},i.onFormatBrushChange=function(e){e||null===i.state.type?e&&e.brushType!==i.state.type&&i.setState({type:e.brushType}):i.setState({type:null})},i.onClick=function(){i.setState({showPanel:!0})},i.closePanel=function(e){e&&27===e.keyCode||i.setState({showPanel:!1})},i.onFormatBrushClick=function(e){var t=e.type,n=e.isDoubleClick;i.onBrushTypeChange(t,n)},i.onBrushTypeChange=function(e,t){t||e!==i.state.type?(i.track(e),i.isSupportBrush(e)&&i.setState({type:e},(function(){var n=i.selection.getActiveShapes(),a=n&&n[0];i.selection.saveFormat(e);var o=(i.presentation.stashCache||{}).stashType;i.editor.slide.setFormatBrush({canSelectText:"text"===o,cursorClass:i.getCursorClass(),brushType:e,isContinue:t,shapeId:a.getId(),slideId:a.getSlideId()})}))):i.setState({type:null},(function(){i.editor.slide.setFormatBrush(null)}))},i.getCursorClass=function(){var e=i.state.type,t=He.USER_CUSTOM_CURSOR.brushPointer;switch(e){case He.FormatBrushType.Common:t="text"===(i.presentation.stashCache||{}).stashType?He.USER_CUSTOM_CURSOR.brushText:He.USER_CUSTOM_CURSOR.brushPointer;break;case He.FormatBrushType.Transform2D:t=He.USER_CUSTOM_CURSOR.brushPosition;break;case He.FormatBrushType.Animation:t=He.USER_CUSTOM_CURSOR.brushAnime}return t},i.onModeChange=function(){i.state.type===He.FormatBrushType.Animation&&i.isMasterView&&i.setState({type:null},(function(){i.editor.slide.setFormatBrush(null),window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.unSupportCopyAnimeInMaster", "母版视图暂不支持动画刷"))})),i.doc.getMode()===He.ViewModes.PreView&&i.state.showPanel?(i.showPanelAfterPreview=!0,i.setState({showPanel:!1})):i.doc.getMode()!==He.ViewModes.PreView&&i.showPanelAfterPreview&&(i.setState({showPanel:!0}),i.showPanelAfterPreview=!1)},i.getPosition=function(){var e=i.props.isPanelVisible("findReplace");return{left:window.rightToLeft?"auto":e?642:278,right:window.rightToLeft?e?960:1300:"auto",top:99}},o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(this.viewEventTypes.THUMBNAIL_UPDATE,this.onThumbnailUpdate),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.onModeChange),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.onThumbnailUpdate),this.on(this.uiEventTypes.pc.ON_FORMAT_BRUSH_CHANGE,this.onFormatBrushChange),this.on(this.uiEventTypes.pc.ON_FORMAT_BRUSH_CLICK,this.onFormatBrushClick),window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.formatBrush", "格式刷"),icon:ze.format_painter})}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.THUMBNAIL_UPDATE,this.onThumbnailUpdate),this.doc.off(this.viewEventTypes.MODE_CHANGE,this.onModeChange),this.editor.slide.setFormatBrush(null)}},{key:"componentDidUpdate",value:function(e,n){v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.state.showPanel!==n.showPanel&&this.props.setPanelVisible("formatBrush",this.state.showPanel)}},{key:"isSupportBrush",value:function(e){var t=this.selection.getActiveShapes();if(e===He.FormatBrushType.Animation&&this.isMasterView)return window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.unSupportCopyAnimeInMaster", "母版视图暂不支持动画刷")),!1;if(this.selection.layerType()===He.WppLayerType.WppLayerNotesPage&&e!==He.FormatBrushType.Common||!t||0===t.length){var n=e===He.FormatBrushType.Common?_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.format", "格式"):e===He.FormatBrushType.Transform2D?_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.position", "位置"):_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.anime", "动画");return window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.selectShapeTip", "请选择要复制{0}的对象").replace("{0}",n)),!1}if(e===He.FormatBrushType.Transform2D)return!0;if(e===He.FormatBrushType.Animation)return t.length>1?(window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.unSupportCopyAnime", "不支持复制多个对象的动画")),!1):!this._isAnimeEmpty(t)||(window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.emptyAnimeShape", "当前选中对象没有动画")),!1);var i="";if(t.length>1)i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.multiObject", "多个对象");else{var a=t[0];a.isMath()&&(i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.math", "公式对象")),a.isGroupShape()&&(i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.groupShape", "组合对象")),a.hasChart()&&(i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.chart", "图表对象")),a.hasSmartArt()&&(i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.smartArt", "SmartArt对象")),a.isOle()?i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.oleShape", "Ole对象"):a.isControlShape()&&(i=_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.controlShape", "控件对象"))}return!i||(window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.unSupportShape", "不支持复制{0}的格式").replace("{0}",i)),!1)}},{key:"track",value:function(e){switch(e){case He.FormatBrushType.Common:window.collection("newui","value",window.pcTrack.newui.format_painter);break;case He.FormatBrushType.Transform2D:window.collection("newui","value",window.pcTrack.newui.position_painter);break;case He.FormatBrushType.Animation:window.collection("newui","value",window.pcTrack.newui.animation_painter)}}},{key:"_isAnimeEmpty",value:function(e){if(e&&1===e.length){var t=this.selection.getActiveSlide(),n=t&&t.getTiming(),i=n&&n.mainSequence,a=e[0]&&e[0].visual.getRootShape(),o=i&&a&&i.getEffect(a.getId()),r=o&&o.filter((function(e){return!e.isMedia}));return!r||0===r.length}}},{key:"render",value:function(){var e=this.state,t=e.showPanel,n=e.slideCount,i=e.type,a=e.online,o=this.props,r=o.connected,s=o.readOnly,l=n<=0||!r||s||!a,c=this.getPosition();return u.a.createElement(p.Fragment,null,u.a.createElement(W.default,{ref:this.refBtn,className:"format-brush-btn",iconType:ze.format_painter,onClick:this.onClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.StartTab.FormatBrush.formatBrush", "格式刷"),disabled:l}),t&&u.a.createElement(Ue,he()({},this.props,{type:i,onItemClick:this.onBrushTypeChange,onClose:this.closePanel,disabled:l,position:c})))}},{key:"brushData",get:function(){return this.editor.slide.brushData}}]),t}(X.BaseComponent),Xe=function(e){function t(){var e,n,i,o;a()(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.setPanelVisible=function(e,t){i["_panel_"+e]=t},i.isPanelVisible=function(e){return i["_panel_"+e]},o=n,l()(i,o)}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.connected,n=e.readOnly,i=e.isEditMode;return u.a.createElement("div",{className:"left-tab-wrap"},u.a.createElement("div",{className:"inline-middle"},u.a.createElement(j,{connected:t,readOnly:n})),u.a.createElement("div",{className:"inline-middle"},u.a.createElement(We.default,null),u.a.createElement(Ge,{connected:t,readOnly:n,setPanelVisible:this.setPanelVisible,isPanelVisible:this.isPanelVisible})),u.a.createElement("div",{className:"inline-middle"},u.a.createElement(xe,{connected:t,isEditMode:i,readOnly:n,setPanelVisible:this.setPanelVisible,isPanelVisible:this.isPanelVisible})),u.a.createElement("div",{className:"inline-middle"},u.a.createElement(pe,{connected:t,isEditMode:i})))}}]),t}(p.PureComponent),qe=n(1864),Ye=(n(6750),n(1019)),Qe=window.CommandBarComponentFragment,Je=Qe.cmbIds.wpp,Ze=0,$e=1,et=2,tt=-1,nt=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.needLocateComment=function(){n.props.needLocateComment&&!n.hasShowCommentPanel&&(n.setState({activeIndex:2}),n.hasShowCommentPanel=!0)},n.handleCommentPanelShow=function(){n.toggleActivePane(et)},n.onOpenAttributePanel=function(){n.toggleActivePane(Ze)},n.handleClosePanel=function(){n.setState({activeIndex:-1})},n.handleGoToComment=function(e){var t=e.commentId;n.setKeyState(Ye.a.COMMENT_ITEM_ID,t),n.toggleActivePane(et)},n.toggleActivePane=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4],r=arguments[5];n.dispatchEvent(n.eventTypes.guideTips.AnimGuideTips,{isClosed:!0}),n.setState({activeIndex:e}),n.fire(n.uiEventTypes.pc.CLICK_PROPSNAV_CHANGE,{idx:e,activeTab:t,isCommentFocus:i,isBlink:a,isAttributeType:o,isTextType:r})},n.onSetSlideTab=function(e){var t=e.activeTab,i=e.activePane,a=e.isAttributeType,o=e.isTextType,r=-1!==n.state.activeIndex,s="anime"===i?$e:"comment"===i?et:Ze;n.toggleActivePane(s,t,"",r,a,o)},n.getBtnClass=function(e){var t=n.state.slideCount,i=n.props,a=i.readOnly,o=i.connected,r=a&&(0===e||1===e)||!o||0===t;return"subnav_btn "+(n.state.activeIndex!==e||r?"":"active")+" "+(r?"disabled":"")},n.handleChange=function(){n.setState({slideCount:n.slideCount})},n.handleModeChange=function(){if(n.isMasterView){var e=-1===n.state.activeIndex?-1:0;n.setState({defaultPanes:[{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.attribute", "格式")}],activeIndex:e})}else n.setState({defaultPanes:[{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.attribute", "格式")},{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.animate", "动画")},{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.comment", "评论")}]})},n.openCommentPanle=function(){n.toggleActivePane(et,"",!0)},n.state={slideCount:n.slideCount,activeIndex:window.activePane||tt,defaultPanes:n.isMasterView?[{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.attribute", "格式")}]:[{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.attribute", "格式")},{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.animate", "动画")},{title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.comment", "评论")}]},n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){window.addEventListener(this.eventTypes.comment.ON_COMMENT_SHOW,this.handleCommentPanelShow),this.on(this.uiEventTypes.pc.ON_SET_SLIDEBAR_TAB,this.onSetSlideTab),this.on(this.uiEventTypes.pc.CLICK_PROPSNAV_CLOSE,this.handleClosePanel),this.on(this.uiEventTypes.names.ON_SHOW_EDIT_PANEL,this.onOpenAttributePanel),this.doc.on(this.viewEventTypes.SELECT_SLIDE_CHANGE,this.handleChange),this.doc.on(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.on(this.uiEventTypes.pc.ON_INSERT_COMMENT,this.openCommentPanle),this.on(this.uiEventTypes.names.DOC_INIT_DONE,this.handleChange),this.doc.on(this.eventTypes.OPENAPI_EVENT.GO_TO_COMMENTITEM,this.handleGoToComment),this.needLocateComment(),this.showAnimGuideTip()}},{key:"onUnBindEvent",value:function(){window.removeEventListener(this.eventTypes.comment.ON_COMMENT_SHOW,this.handleCommentPanelShow),this.off(this.uiEventTypes.names.ON_SHOW_EDIT_PANEL,this.onOpenAttributePanel),this.off(this.uiEventTypes.pc.CLICK_PROPSNAV_CLOSE,this.handleClosePanel),this.doc.off(this.viewEventTypes.SELECT_SLIDE_CHANGE,this.handleChange),this.doc.off(this.viewEventTypes.MODE_CHANGE,this.handleModeChange),this.doc.off(this.eventTypes.OPENAPI_EVENT.GO_TO_COMMENTITEM,this.handleGoToComment),clearTimeout(this.delayTimer)}},{key:"componentDidUpdate",value:function(){v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.needLocateComment()}},{key:"showAnimGuideTip",value:function(){var e=this;clearTimeout(this.delayTimer),this.delayTimer=setTimeout((function(){if(!e.props.readOnly&&!e.props.hideCmb){var t="showAnimGuideTip";localStorage.getItem(t)||(localStorage.setItem(t,JSON.stringify(!0)),e.dispatchEvent(e.eventTypes.guideTips.AnimGuideTips,{isClosed:!1}))}}),2e3)}},{key:"render",value:function(){var e=this,t=this.state.defaultPanes;return u.a.createElement("div",{className:"edit_props_subnav"},u.a.createElement("ul",{className:"subnav_layout"},t.map((function(t,n){var i=t.title;return i===_i18n("applications.presentation.components.CommandBars.EditPropsTab.comment", "评论")?window.__CONFIG__.wpp.isShowComment&&u.a.createElement(Qe,{cmbId:Je.WPPPcCommentButton,key:n},u.a.createElement(Ve.a,{title:i},u.a.createElement("li",{onClick:function(){return e.toggleActivePane(n)},className:e.getBtnClass(n),key:n},i))):i===_i18n("applications.presentation.components.CommandBars.EditPropsTab.animate", "动画")?u.a.createElement(qe.default,{popoverClass:"anime_guide_tip",placement:qe.default.placementTypes.bottom,eventName:e.eventTypes.guideTips.AnimGuideTips,title:_i18n("applications.presentation.components.CommandBars.EditPropsTab.animeGuideTip", "已支持更多动画效果"),isClickClosed:!1,key:n},u.a.createElement("li",{key:n,onClick:function(){return e.toggleActivePane(n)},className:e.getBtnClass(n)},i)):u.a.createElement(Ve.a,{key:n,title:i},u.a.createElement("li",{key:n,onClick:function(){return e.toggleActivePane(n)},className:e.getBtnClass(n)},i))}))))}}]),t}(X.BaseComponent),it=function(e){function t(){return a()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),r()(t,[{key:"getClassName",value:function(){var e="wpp-cmd-bar";return this.props.openSuccess||(e+=" disabled"),e}},{key:"render0",value:function(){var e=this.getClassName();return u.a.createElement("div",{className:e},u.a.createElement(x,null))}},{key:"render",value:function(){var e=this.props,t=e.openSuccess,n=e.coreReady,i=e.showCommandBars;return u.a.createElement(u.a.Fragment,null,t&&n&&i&&u.a.createElement(Xe,this.props),i&&u.a.createElement(x,this.props),i&&u.a.createElement(nt,this.props))}}]),t}(p.PureComponent);t.default=it},8222:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(3),r=n.n(o),s=n(25),l=n.n(s),c=n(42),d=n.n(c),p=(n(6730),n(142)),u=n.n(p),h=n(147),f=n.n(h),m=n(26),v=n.n(m),w=(n(6731),n(168)),g=n.n(w),y=n(247),b=n(145),_=n(156),C=n(158),T=n(205),k=n(3833),E=n(179),S=n(336),P=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleTouchStart=function(e){e.stopPropagation()},n.updateSlideCountOptions=function(){n.setState({slideCountOptions:n.getSlideCountOptions()})},n.handleCompositionStart=function(e){n.isChineseInputting=!0},n.handleCompositionEnd=function(e){n.isChineseInputting=!1,n.input.current===document.activeElement&&n.handleLinkChange(e),n.refMaskTextInput.current===document.activeElement&&n.handleMaskTextChange(e)},n.handleMaskTextChange=function(e){var t=e.target.value;n.isChineseInputting||(t=(t=t.trim()).replace(/\s*/g,"")),n.setState({linkMaskText:t})},n.handleLinkChange=function(e){var t=e.target.value;if(n.isChineseInputting||(t=(t=t.trim()).replace(/\s*/g,"")),n.state.linkType===C.LinkType.web)n.setState({webAddress:t});else{var i=Object(k.e)(t);n.setState({emailAddress:t,isEmail:i})}},n.handleInputKeyDown=function(e){var t=e.key,i=e.keyCode;"Enter"!==t&&13!==i||(Object(b.stopBubble)(e),n.handleSetLink())},n.onItemHover=Object(_.debounce)((function(e){if(n.hoverItem!==e&&n.slideSelectPanel){n.hoverItem=e;var t=e&&e.getAttribute("data-key");if(t&&t.split(":")[1]){if(!n.hoverSlideSize){var i=n.doc.getLayout({}).svgLayout,a=i.height,o=i.width,r=Math.ceil(a*(260/o));n.hoverSlideSize={width:260,height:r}}var s=n.hoverSlideSize,l=s.width,c=s.height,d=document.body.getBoundingClientRect(),p=d.width,u=d.height,h=e.getBoundingClientRect(),f=h.right,m=h.top,w=h.left;f+=C.userAgent.isEdge?20:10,n.setState({hoverSlide:t,hoverStyle:v()({},n.hoverSlideSize,{left:(f+l+12>p?w-l-12:f+12)+"px",top:(m+c>u?u-c-8:m+8)+"px"})});var g=Number(t.split(":")[1])-1;n.coreView.genSlideSvgSnapshot({idx:g,width:l,height:c}).then((function(e){if(n.hoverWrap){var t=n.hoverWrap.querySelector("svg");t&&t.remove(),n.hoverWrap.appendChild(e)}}))}else n.setState({hoverSlide:!1})}}),300),n.handleSlideLinkVisible=function(e){e||n.setState({hoverSlide:!1}),n.slideSelectPanel=e},n.handleLinkChange=n.handleLinkChange.bind(n),n.handleSetLink=n.handleSetLink.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleLinkTypeChange=n.handleLinkTypeChange.bind(n),n.handleSlideLinkChange=n.handleSlideLinkChange.bind(n),n.getLinkInfo=n.getLinkInfo.bind(n),n.getSlideCountOptions=n.getSlideCountOptions.bind(n),n.state=n.getLinkInfo(),n.input=u.a.createRef(),n.refMaskTextInput=u.a.createRef(),n}var n;return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){var e=this.input.current,t=this.refMaskTextInput.current;e&&e.focus(),this.doc.on(this.viewEventTypes.THUMBNAIL_UPDATE,this.updateSlideCountOptions),e&&e.addEventListener("touchstart",this.handleTouchStart),t&&t.addEventListener("touchstart",this.handleTouchStart)}},{key:"onUnBindEvent",value:function(){var e=this.input.current,t=this.refMaskTextInput.current;this.doc.off(this.viewEventTypes.THUMBNAIL_UPDATE,this.updateSlideCountOptions),e&&e.removeEventListener("touchstart",this.handleTouchStart),t&&t.removeEventListener("touchstart",this.handleTouchStart)}},{key:"getLinkInfo",value:function(){var e={linkType:C.LinkType.web,webAddress:"",emailAddress:"",slideAddress:"",slideError:!1,slideCountOptions:this.getSlideCountOptions(),linkMaskText:this.getSelectedText()};if(this.link.hasLink)switch(Object.assign(e,{linkType:this.link.getLinkType(),slideValue:this.link.action}),e.linkType){case C.LinkType.web:e.webAddress=this.link.getViewAddress();break;case C.LinkType.email:e.emailAddress=this.link.getViewAddress(),e.isEmail=!0;break;case C.LinkType.slideRlt:case C.LinkType.slideAsl:var t=this.link.getLinkSlideIndex();Object.assign(e,{slideAddress:this.link.getViewAddress(),slidePage:t+1,slideError:-1===t,slideId:this.link.viewData.linkSlideId})}return e}},{key:"getSlideCountOptions",value:function(){for(var e=this.selection.getSlideCount(),t=[],n=0;n<e;n++){var i={content:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slidePage", "第{0}页幻灯片").replace("{0}",n+1),value:"page:"+(n+1)};t.push(i)}return t}},{key:"handleLinkTypeChange",value:function(e){this.setState({linkType:e})}},{key:"handleSlideLinkChange",value:function(e){if("string"==typeof e){var t=e.split(":")[1],n=window.APP.presentation.getSlideAt(t-1);this.setState({slidePage:t,linkType:C.LinkType.slideAsl,slideAddress:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slidePage", "第{0}页幻灯片").replace("{0}",t),slideError:!n,slideId:n&&n.getId()})}else this.setState({linkType:C.LinkType.slideRlt,slideValue:e,slideAddress:k.b[e],slideError:!1})}},{key:"handleSetLink",value:(n=f()(regeneratorRuntime.mark((function e(){var t,n,i,a,o,r,s,l,c,d,p,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.linkType,i=t.webAddress,a=t.slideValue,o=t.emailAddress,r=t.slidePage,s=t.slideId,l=t.slideAddress,c=t.isEmail,e.next=3,window.__WPSENV__.reduxDispatch(Object(S.auditText)(o+" "+i));case 3:if(!e.sent.error){e.next=6;break}return e.abrupt("return");case 6:d=void 0,p=void 0,e.t0=n,e.next=e.t0===C.LinkType.web?10:e.t0===C.LinkType.email?12:e.t0===C.LinkType.slideRlt?14:e.t0===C.LinkType.slideAsl?20:23;break;case 10:return i&&(d={action:C.WpActionType.ActionHyperlink,linkTo:C.ActionLinkToType.URL,hyperlink:{address:i}},p=i),e.abrupt("break",23);case 12:return c&&o&&(d={action:C.WpActionType.ActionHyperlink,linkTo:C.ActionLinkToType.URL,hyperlink:{address:"mailto:"+o}},p=o),e.abrupt("break",23);case 14:return u=this.getRltSlideByType(a),r=u.slideIndex,s=u.slideId,d={action:a,linkTo:C.ActionLinkToType.Slide,hyperlink:{subAddress:s+","+r+","+_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slide", "幻灯片")+" "+r}},p=l,e.abrupt("break",23);case 20:return d={action:C.WpActionType.ActionHyperlink,linkTo:C.ActionLinkToType.Slide,hyperlink:{subAddress:s+","+r+","+_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slide", "幻灯片")+" "+r}},p=l,e.abrupt("break",23);case 23:h=this.getLinkMaskText(p),d&&(this.link.modifyLink(d,h),this.props.onCancel());case 25:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getRltSlideByType",value:function(e){var t=this.selection.getActiveSlideIdx(),n=this.selection.getSlideCount(),i=void 0;switch(e){case C.WpActionType.ActionFirstSlide:i=0;break;case C.WpActionType.ActionLastSlide:i=n-1;break;case C.WpActionType.ActionPreviousSlide:i=Math.max(0,t-1);break;case C.WpActionType.ActionNextSlide:i=Math.min(n-1,t+1)}return{slideIndex:i,slideId:this.workspace.presentation.getSlideAt(i).getId()}}},{key:"getSelectedText",value:function(){var e=this.selection.getText();return e?e.join(""):""}},{key:"getLinkMaskText",value:function(e){if(this.selection.state===C.SelectType.select_text){var t=this.state.linkMaskText;return t||e}return e}},{key:"renderSectionInput",value:function(){var e=this,t=this.state,n=t.linkType,i=t.slideValue,a=t.webAddress,o=t.emailAddress,r=t.slideAddress,s=t.slidePage,l=t.slideError,c=t.hoverSlide,d=t.hoverStyle,p=t.linkMaskText,h=t.slideCountOptions;return u.a.createElement(u.a.Fragment,null,this.selection.state===C.SelectType.select_text?u.a.createElement("div",{className:"link-input-wrap"},u.a.createElement("div",{className:"link-label"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.maskTextLabel", "显示文本")," :"),u.a.createElement("input",{className:"link-content link-content-input",ref:this.refMaskTextInput,value:p,placeholder:"",onChange:this.handleMaskTextChange,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd})):null,u.a.createElement("div",{className:"link-input-wrap"},u.a.createElement("div",{className:"link-label"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.linkTypeLabel", "链接类型")," :"),u.a.createElement(y.default,{className:"link-content link-type-select",content:k.d[n],value:n===C.LinkType.slideAsl?C.LinkType.slideRlt:n,showBorder:!0,options:k.c,onChange:this.handleLinkTypeChange})),u.a.createElement("div",{className:"link-input-wrap"},u.a.createElement("div",{className:"link-label"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.linkToLabel", "链接至")," :"),(n===C.LinkType.slideRlt||n===C.LinkType.slideAsl)&&u.a.createElement(y.default,{disabled:this.selection.getSlideCount()<1,className:"link-content "+(r?"":"placeholder"),content:r||_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slidePlaceholder", "请选择幻灯片"),value:n===C.LinkType.slideRlt?i:"page:"+s,showBorder:!0,groups:[k.a,h],onChange:this.handleSlideLinkChange,onVisibleChange:this.handleSlideLinkVisible,onItemHover:this.onItemHover}),n===C.LinkType.slideAsl&&l&&u.a.createElement("div",{className:"error"},_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.none", "幻灯片不存在或被删除")),(n===C.LinkType.web||n===C.LinkType.email)&&u.a.createElement("input",{ref:this.input,className:"link-content link-content-input",value:n===C.LinkType.web?a:o,placeholder:n===C.LinkType.web?_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.webPlaceholder", "请输入网页地址"):_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.emailPlaceholder", "请输入邮箱地址"),onChange:this.handleLinkChange,onKeyDown:this.handleInputKeyDown,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd}),c&&u.a.createElement("div",{ref:function(t){e.hoverWrap=t},className:"hover-slide-wrap",style:d})))}},{key:"render",value:function(){var e=this.state,t=e.webAddress,n=e.emailAddress,i=e.slideAddress,a=e.slideError,o=e.isEmail,r=e.linkType,s=this.props,l=s.connected,c=s.onCancel,d=this.renderSectionInput(),p=!l;return r!==C.LinkType.web||t||(p=!0),r!==C.LinkType.slideRlt&&r!==C.LinkType.slideAsl||!a&&i||(p=!0),r!==C.LinkType.email||o&&n||(p=!0),u.a.createElement(T.default,{className:"hyperlink-modal",title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.title", "链接至"),okBtnText:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.confirm", "确定"),okDisabled:p,onOk:this.handleSetLink,onCancel:c},u.a.createElement("div",{className:"hyperlink-body"},d))}},{key:"link",get:function(){return this.editor&&this.editor.link}}]),t}(E.BaseComponent);P.propTypes={onCancel:g.a.func.isRequired};var R=P,O=n(183),I=n(1114),B=n.n(I),N=O.default.iconTypes.size16,M=window.Toast,D=window.pcTrack,L=function(e){function t(e){a()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleModalClose=function(){n.setState({modalVisible:!1}),n.fire(n.uiEventTypes.pc.link.ON_LINK_INSERT_CLOSE)},n.handleLinkInsert=function(e){e&&(e.modifySelf?n.link.selectSelf():n.link.changeSelectText(),setTimeout((function(){n.setState({modalVisible:!0})}),100))},n.handleClick=function(e){if(!n.props.disabled){var t=n.selection.getActiveShapes();switch(n.selection.state){case C.SelectType.select_shape:n.link.isSupportShape(t[0])?n.showInsertModal():M.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.Link.unSupportShape", "该对象不支持添加链接"));break;case C.SelectType.select_text:t[0]&&t[0].isPlaceHolder()&&n.isMasterView?M.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.Link.unSupportShape", "该对象不支持添加链接")):n.showInsertModal(!0);break;case C.SelectType.select_multi_shape:M.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.Link.unSupportShapes", "不支持多选对象添加链接"));break;case C.SelectType.select_cell:case C.SelectType.select_multi_cell:M.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.Link.unSupportShape", "该对象不支持添加链接"));break;default:M.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.Link.selectTextOrShape", "请选择要添加链接的文本或对象"))}window.collection("newui","value",D.newui.link_add_toolbar)}},n.showInsertModal=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.fire(n.uiEventTypes.pc.link.ON_LINK_INSERT),n.link.initData(),e&&n.link.changeSelectText(),setTimeout((function(){n.setState({modalVisible:!0})}),100)},n.refBtn=u.a.createRef(),n.state={modalVisible:!1},n}return d()(t,e),r()(t,[{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.link.ON_LINK_INSERT,this.handleLinkInsert),this.initSearchKeywords(),this.props.addBtnRef&&this.props.addBtnRef(this.refBtn)}},{key:"onUnBindEvent",value:function(){}},{key:"initSearchKeywords",value:function(){window.__WPSENV__.commandbars.push({el:this.refBtn,text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.link", "链接"),icon:N.insert_hyper_links})}},{key:"render",value:function(){var e=this.props,t=e.connected,n=e.disabled,i=this.state.modalVisible;return u.a.createElement(u.a.Fragment,null,u.a.createElement(B.a,{disabled:n,ref:this.refBtn,iconType:N.hyper_link,onClick:this.handleClick,title:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.link", "链接"),text:_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.Insert.link", "链接")}),i&&u.a.createElement(R,{connected:t,onCancel:this.handleModalClose}))}},{key:"link",get:function(){return this.editor&&this.editor.link}}]),t}(E.BaseComponent);t.default=L}}]);