(window.webpackJsonp=window.webpackJsonp||[]).push([[225,363],{1012:function(e,t,i){"use strict";function n(e,t){var i=e.x1,n=e.y1,r=e.x2,a=e.y2,o=e.x3,s=e.y3,l=1-t,h=i*l+r*t,u=r*l+o*t,c=n*l+a*t,d=a*l+s*t;return{x:(h=h*l+u*t)*l+(u=u*l+(o*l+e.x4*t)*t)*t,y:(c=c*l+d*t)*l+(d=d*l+(s*l+e.y4*t)*t)*t}}function r(e,t,i){var n=e.x1,r=e.y1,a=e.x2,o=e.y2,s=e.x3,l=e.y3,h=e.x4,u=e.y4,c=.5*(a+s);t.x2=.5*(n+a),i.x3=.5*(s+h),t.x1=n,i.x4=h,t.x3=.5*(t.x2+c),i.x2=.5*(i.x3+c),t.x4=i.x1=.5*(t.x3+i.x2),c=(o+l)/2,t.y2=.5*(r+o),i.y3=.5*(l+u),t.y1=r,i.y4=u,t.y3=.5*(t.y2+c),i.y2=.5*(i.y3+c),t.y4=i.y1=.5*(t.y3+i.y2)}function a(e,t,i){for(var n=new Array(10),a=0;a<n.length;a++)n[a]={x1:0,y1:0,x2:0,y2:0,x3:0,y3:0,x4:0,y4:0};var o=new Array(10);n[0]=e,o[0]=9;for(var s=0,l=0,h=window.Point;s>=0;){var u=n[s],c=u.y4-u.y1,d=u.x4-u.x1,p=Math.abs(d)+Math.abs(c),f=void 0;p>1?f=Math.abs(d*(u.y1-u.y2)-c*(u.x1-u.x2))+Math.abs(d*(u.y1-u.y3)-c*(u.x1-u.x3)):(f=Math.abs(u.x1-u.x2)+Math.abs(u.y1-u.y2)+Math.abs(u.x1-u.x3)+Math.abs(u.y1-u.y3),p=1),f<i*p||0===o[l]?(t.push(new h(u.x4,u.y4)),--s,--l):(r(u,n[s+1],u),o[l+1]=--o[l],++s,++l)}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=[];return i.push(e.pt1()),a(e,i,t),i}function s(e,t){if(!e||t<=2)return console.warn("convert2Beziers fail!! ",e,t),[];var i=[],n=window.Point;if(2===t)return i[0]=e[0],i[1]=n["/"](n["+"](n["*"](2,e[0]),e[1]),3),i[2]=n["/"](n["+"](n["*"](2,e[1]),e[0]),3),i[3]=e[1],i;var r=t,a=3*r-2;i[0]=e[0];var o=n["/"](n["-"](n["-"](e[1],e[0]),n["*"](n["-"](e[2],e[1]),.1)),5);i[1]=n["+"](i[0],o);for(var s=1,l=0;s<r-1;)i[l=3*s]=e[s],o=n["/"](n["-"](e[s+1],e[s-1]),5),i[l-1]=n["-"](e[s],o),i[l+1]=n["+"](e[s],o),s++;return i[a-1]=e[r-1],o=n["/"](n["-"](n["-"](e[r-2],e[r-1]),n["*"](n["-"](e[r-3],e[r-2]),.1)),5),i[a-2]=n["+"](i[a-1],o),i}i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"e",(function(){return o})),i.d(t,"a",(function(){return s}))},1017:function(e,t,i){"use strict";i.r(t);var n,r,a,o,s=i(158),l=void 0,h="http://www.w3.org/2000/svg";function u(e){var t,i=void 0,n=void 0;if(!e)throw new Error("cannot create a random attribute name for an undefined object");t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",i="";do{for(i="",n=0;n<12;n++)i+=t[Math.floor(Math.random()*t.length)]}while(e[i]);return i}function c(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}o=function(e,t){var i=void 0,n=void 0,r={},a=void 0;for(e=e.split(","),t=t||10,i=0;i<e.length;i+=2)n="&"+e[i+1]+";",a=parseInt(e[i],t),r[n]="&#"+a+";";return r["\\xa0"]="&#160;",r}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),n={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}},Object.freeze(n);var d=Object.keys(n);(r=function(e,t){this.__root=e,this.__ctx=t}).prototype.addColorStop=function(e,t){var i=this.__ctx.__createElement("stop"),n=void 0;i.setAttribute("offset",e),-1!==t.indexOf("rgba")?(n=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t))?(i.setAttribute("stop-color","rgb("+n[1]+","+n[2]+","+n[3]+")"),i.setAttribute("stop-opacity",n[4])):console.error("error rgba param!",t):i.setAttribute("stop-color",t),this.__root.appendChild(i)},(a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l;this.__root=e,this.__ctx=t}).prototype.getPattern=function(){return this.__root},a.prototype.setTransform=function(e){e=e.isQMatrix?e.toString():e;var t=this.__root.getAttribute("patternTransform");e=t?t+e:e,this.__root.setAttribute("patternTransform",e)},(l=function(e){var t=this,i={width:500,height:500,enableMirroring:!1},n=void 0;if(arguments.length>1?((n=i).width=arguments[0],n.height=arguments[1]):n=e||i,!(this instanceof l))return new l(n);this.__width=n.width||i.width,this.__height=n.height||i.height,this.enableMirroring=void 0!==n.enableMirroring?n.enableMirroring:i.enableMirroring,this.canvas=this,this.__document=n.document||document,n.ctx?this.__ctx=n.ctx:this.__ctx=this,this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS(h,"svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns",h),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.__width),this.__root.setAttribute("height",this.__height),this.__root.setAttribute("overflow","visible"),this.__ids={},this.__defs=this.__document.createElementNS(h,"defs"),this.__defs.appendNode=function(e){t.curId&&(t.__curDefs[t.curId]=t.__curDefs[t.curId]||[],t.__curDefs[t.curId].includes(e)||t.__curDefs[t.curId].push(e)),t.__defs.appendChild(e)},this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS(h,"g"),this.__root.appendChild(this.__currentElement),this.__curDefs={}}).prototype.setViewBox=function(e){var t=e.x,i=e.y,n=e.width,r=e.height;this.setAttribute("viewBox",(t||0)+" "+(i||0)+" "+n+" "+r)},l.prototype.setAttribute=function(e,t){e&&this.__root.setAttribute(e,t)},Object.defineProperty(l.prototype,"width",{get:function(){return this.__width},set:function(e){this.__width=e,this.__root.setAttribute("width",this.__width)}}),Object.defineProperty(l.prototype,"height",{get:function(){return this.__height},set:function(e){this.__height=e,this.__root.setAttribute("height",this.__height)}}),l.prototype.__createElement=function(e,t,i){var n=this.__document.createElementNS(h,e);for(var r in i&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none")),t)n.setAttribute(r,t[r]);return n},l.prototype.getElem=function(){return this},l.prototype.getContext=function(){return this},l.prototype.__setDefaultStyles=function(){var e=d,t=void 0,i=void 0;for(t=0;t<e.length;t++)this[i=e[t]]=n[i].canvas},l.prototype.__applyStyleState=function(e){var t=Object.keys(e),i=void 0,n=void 0;for(i=0;i<t.length;i++)this[n=t[i]]=e[n]},l.prototype.__getStyleState=function(){var e=void 0,t={},i=d,n=void 0;for(e=0;e<i.length;e++)t[n=i[e]]=this[n];return t},l.prototype.__applyStyleToCurrentElement=function(e){var t=this.__currentElement,i=this.__currentElementsToStyle;i&&(t.setAttribute(e,""),t=i.element,i.children.forEach((function(t){t.setAttribute(e,"")})));var o=d,s=void 0,l=void 0,h=void 0,u=void 0,c=void 0;for(s=0;s<o.length;s++)if(l=n[o[s]],h=this[o[s]],l.apply&&!Object.isEmpty(h))if(h instanceof a&&l.apply===e){if(h.__ctx&&h.__ctx!==this)for(var p=0;p<h.__ctx.__defs.childNodes.length;p++)u=h.__ctx.__defs.childNodes[p].getAttribute("id"),this.__ids[u]=u,this.__defs.appendNode(h.__ctx.__defs.childNodes[p]);t.setAttribute(l.apply,"url(#"+h.__root.getAttribute("id")+")"),t.setAttribute("class","_used_url")}else if(h instanceof r&&l.apply===e)t.setAttribute(l.apply,"url(#"+h.__root.getAttribute("id")+")"),t.setAttribute("class","_used_url");else if(-1!==l.apply.indexOf(e)&&l.svg!==h)if("stroke"!==l.svgAttr&&"fill"!==l.svgAttr||-1===h.indexOf("rgba")){var f=l.svgAttr;if("globalAlpha"===o[s]&&(f=e+"-"+l.svgAttr,t.getAttribute(f)))continue;t.setAttribute(f,h)}else if(c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(h)){t.setAttribute(l.svgAttr,"rgb("+c[1]+","+c[2]+","+c[3]+")");var g=c[4],y=this.globalAlpha;Object.isEmpty(y)||(g*=y),t.setAttribute(l.svgAttr+"-opacity",g)}else console.error("error rgba param!",h)},l.prototype.__closestGroupOrSvg=function(e){return"g"===(e=e||this.__currentElement).nodeName||"svg"===e.nodeName?e:this.__closestGroupOrSvg(e.parentNode)},l.prototype.getSerializedSvg=function(e){var t=(new XMLSerializer).serializeToString(this.__root),i=void 0,n=void 0,r=void 0,a=void 0,s=void 0;if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(i=Object.keys(o),n=0;n<i.length;n++)r=i[n],a=o[r],(s=new RegExp(r,"gi")).test(t)&&(t=t.replace(s,a));return t},l.prototype.getSvg=function(){return this.__root},l.prototype.save=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.__createElement("g");e&&(e.toString&&0===e.toString().indexOf("s_")&&i&&(this.curId=e),n.setAttribute("id",e)),t&&(n.style["mix-blend-mode"]=t);var r=this.__closestGroupOrSvg();return this.__groupStack.push(r),r.appendChild(n),this.__currentElement=n,this.__stack.push(this.__getStyleState()),n},l.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]),this.drawImageAlpha=null;var e=this.__stack.pop();this.__applyStyleState(e)},l.prototype.__addTransform=function(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0){"path"===this.__currentElement.nodeName&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:t,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var i=this.__createElement("g");t.appendChild(i),this.__currentElement=i}var n=this.__currentElement.getAttribute("transform");n?n+=" ":n="",n+=e,this.__currentElement.setAttribute("transform",n)},l.prototype.scale=function(e,t){void 0===t&&(t=e),1===Number(e)&&1===Number(t)||this.__addTransform("scale("+e+","+t+")")},l.prototype.rotate=function(e){if(e){var t=180*e/Math.PI;this.__addTransform("rotate("+t+", 0, 0)")}},l.prototype.translate=function(e,t){0===Number(e)&&0===Number(t)||this.__addTransform("translate("+e+", "+t+")")},l.prototype.transform=function(e,t,i,n,r,a){this.__addTransform("matrix("+e+", "+t+", "+i+", "+n+", "+r+", "+a+")")},l.prototype.beginPath=function(e){var t=void 0;this.__currentDefaultPath="",this.__currentDefaultPath_hasM=!1,this.__currentPosition={},t=this.__createElement("path",void 0,!0),e&&(t.style["mix-blend-mode"]=e),this.__closestGroupOrSvg().appendChild(t),this.__currentElement=t},l.prototype.__applyCurrentDefaultPath=function(){var e=this.__currentElement;"path"===e.nodeName?e.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",e.nodeName)},l.prototype.__addPathCommand=function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e},l.prototype.moveTo=function(e,t){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand("M "+e+" "+t),this.__currentDefaultPath_hasM=!0},l.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")},l.prototype.lineTo=function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath_hasM?this.__addPathCommand("L "+e+" "+t):(this.__addPathCommand("M "+e+" "+t),this.__currentDefaultPath_hasM=!0)},l.prototype.bezierCurveTo=function(e,t,i,n,r,a){this.__currentPosition={x:r,y:a},this.__addPathCommand("C "+e+" "+t+" "+i+" "+n+" "+r+" "+a)},l.prototype.quadraticCurveTo=function(e,t,i,n){this.__currentPosition={x:i,y:n},this.__addPathCommand("Q "+e+" "+t+" "+i+" "+n)};var p=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]};l.prototype.arcTo=function(e,t,i,n,r){var a=this.__currentPosition&&this.__currentPosition.x,o=this.__currentPosition&&this.__currentPosition.y;if(void 0!==a&&void 0!==o){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(a===e&&o===t||e===i&&t===n||0===r)this.lineTo(e,t);else{var s=p([a-e,o-t]),l=p([i-e,n-t]);if(s[0]*l[1]!=s[1]*l[0]){var h=s[0]*l[0]+s[1]*l[1],u=Math.acos(Math.abs(h)),c=p([s[0]+l[0],s[1]+l[1]]),d=r/Math.sin(u/2),f=e+d*c[0],g=t+d*c[1],y=[-s[1],s[0]],v=[l[1],-l[0]],m=function(e){var t=e[0];return e[1]>=0?Math.acos(t):-Math.acos(t)},_=m(y),w=m(v);this.lineTo(f+y[0]*r,g+y[1]*r),this.arc(f,g,r,_,w)}else this.lineTo(e,t)}}},l.prototype.stroke=function(e){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),e&&(this.__currentElement.id=e),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},l.prototype.fill=function(e,t){"path"===this.__currentElement.nodeName&&(this.__currentElement.setAttribute("paint-order","stroke fill markers"),"evenodd"===e&&this.__currentElement.setAttribute("fill-rule","evenodd")),t&&(this.__currentElement.id=t),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},l.prototype.rect=function(e,t,i,n){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.closePath()},l.prototype.fillRect=function(e,t,i,n){var r;r=this.__createElement("rect",{x:e,y:t,width:i,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("fill")},l.prototype.strokeRect=function(e,t,i,n){var r;r=this.__createElement("rect",{x:e,y:t,width:i,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")},l.prototype.__clearCanvas=function(){for(var e=this.__closestGroupOrSvg().getAttribute("transform"),t=this.__root.childNodes[0],i=t.childNodes,n=i.length-1;n>=0;n--)i[n]&&t.removeChild(i[n]);for(var r=(i=(t=this.__root.childNodes[1]).childNodes).length-1;r>=0;r--)i[r]&&t.removeChild(i[r]);this.__currentElement=t,this.__groupStack=[],e&&this.__addTransform(e)},l.prototype.clearRect=function(e,t,i,n){this.__clearCanvas()},l.prototype.createLinearGradient=function(e,t,i,n){var a=this.__createElement("linearGradient",{id:u(this.__ids),x1:e+"px",x2:i+"px",y1:t+"px",y2:n+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendNode(a),new r(a,this)},l.prototype.createRadialGradient=function(e,t,i,n,a,o){try{var l=s.userAgent.agent.match(/cpu iphone os (.*?) like mac os/);l&&"13_1_3"===l[1]&&(n=e,a=t);var h=Math.sqrt((e-n)*(e-n)+(t-a)*(t-a));o=h>o?h:o}catch(e){console.error("createRadialGradient error")}var c=this.__createElement("radialGradient",{id:u(this.__ids),cx:n+"px",cy:a+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendNode(c),new r(c,this)},l.prototype.__parseFont=function(){var e=this.__root.style,t=e.font;e.font=this.font;var i={style:e.fontStyle||"normal",size:e.fontSize||"10px",family:e.fontFamily||"sans-serif",weight:e.fontWeight||"normal",decoration:e.textDecoration||"normal",href:null};return e.font=t,"underline"===this.__fontUnderline&&(i.decoration="underline"),this.__fontHref&&(i.href=this.__fontHref),i},l.prototype.__wrapTextLink=function(e,t){if(e.href){var i=this.__createElement("a");return i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),i.appendChild(t),i}return t},l.prototype.__applyText=function(e,t,i,n){var r,a,o=this.__parseFont(),s=this.__closestGroupOrSvg(),l=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:t,y:i,"text-anchor":(r=this.textAlign,a={left:"start",right:"end",center:"middle",start:"start",end:"end"},a[r]||a.start),"dominant-baseline":c(this.textBaseline)},!0);l.appendChild(this.__document.createTextNode(e)),this.__currentElement=l,this.__applyStyleToCurrentElement(n),s.appendChild(this.__wrapTextLink(o,l))},l.prototype.fillText=function(e,t,i){this.__applyText(e,t,i,"fill")},l.prototype.strokeText=function(e,t,i){this.__applyText(e,t,i,"stroke")},l.prototype.measureText=function(e){},l.prototype.arc=function(e,t,i,n,r,a){if(n!==r){(n%=2*Math.PI)===(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(a?-1:1))%(2*Math.PI));var o=e+i*Math.cos(r),s=t+i*Math.sin(r),l=e+i*Math.cos(n),h=t+i*Math.sin(n),u=a?0:1,c=0,d=r-n;d<0&&(d+=2*Math.PI),c=a?d>Math.PI?0:1:d>Math.PI?1:0,this.lineTo(l,h),this.__addPathCommand("A "+i+" "+i+" 0 "+c+" "+u+" "+o+" "+s),this.__currentPosition={x:o,y:s}}},l.prototype.clip=function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),i=u(this.__ids),n=this.__createElement("g");this.__applyCurrentDefaultPath(),e.removeChild(this.__currentElement),t.setAttribute("id",i),t.appendChild(this.__currentElement),this.__defs.appendNode(t),e.setAttribute("clip-path","url(#"+i+")"),e.setAttribute("class","_used_url"),e.appendChild(n),this.__currentElement=n},l.prototype.drawImage=function(){var e=Array.prototype.slice.call(arguments),t=e[0],i=void 0,n=void 0,r=void 0,a=void 0,o=0,h=0,u=void 0,c=void 0,d=void 0,p=void 0,f=void 0,g=void 0,y=void 0,v=void 0,m=void 0,_=void 0;if(3===e.length)i=e[1],n=e[2],r=u=t.width,a=c=t.height;else if(5===e.length||6===e.length)i=e[1],n=e[2],r=Math.ceil(e[3]),a=Math.ceil(e[4]),_=e[5],u=t.width,c=t.height;else{if(9!==e.length)throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);o=e[1],h=e[2],u=Math.ceil(e[3]),c=Math.ceil(e[4]),i=e[5],n=e[6],r=Math.ceil(e[7]),a=Math.ceil(e[8])}d=this.__closestGroupOrSvg();var w="translate("+i+", "+n+")";if(t instanceof l){if((p=t.getSvg().cloneNode(!0)).childNodes&&p.childNodes.length>1){if(f=p.childNodes[0],!_)for(;f.childNodes.length;)if(m=f.childNodes[0].id,f.children||(this.__defs.children={}),this.__ids[m]=m,this.__defs.children||(this.__defs.children={}),this.__defs.children[m]){var S=f.children[m]||f.querySelector("#"+m);S.remove()}else this.__defs.appendNode(f.childNodes[0]),this.__defs.children[m]||(this.__defs.children[m]=!0);if(g=p.childNodes[1]){var x=g.getAttribute("transform"),T=void 0;T=x?x+" "+w:w,g.setAttribute("transform",T),d.appendChild(g)}}}else if("CANVAS"===t.nodeName||"IMG"===t.nodeName){y=this.__createElement("image"),!Object.isEmpty(r)&&y.setAttribute("width",r),!Object.isEmpty(a)&&y.setAttribute("height",a),y.setAttribute("crossOrigin","anonymous"),y.setAttribute("preserveAspectRatio","none"),t.setAttribute("crossOrigin","anonymous"),t.height&&t.width&&(o||h||u!==t.width||c!==t.height)&&((v=this.__document.createElement("canvas")).width=r,v.height=a,v.getContext("2d").drawImage(t,o,h,u,c,0,0,r,a),t=v),t.crossOrigin="anonymous",y.setAttribute("transform",w);var k=t.src?t.src:t.data_url;t.data_url&&t.isLoading&&(t.startTime=Date.now(),y._tokenKey=t._tokenKey,y.setAttribute("tokenKey",""+t._tokenKey),y.onload=function(e){window.svgImageLoad(e.target||e.srcElement)},y.onerror=function(e){window.svgImageError(e.target||e.srcElement)},s.userAgent.isIE?(t.onload=function(){window.svgImageLoad(y)},t.onerror=function(){window.svgImageError(y)},t.src=k):s.userAgent.isIos&&setTimeout((function(){window.svgImageLoad(y)}),1e3*(.5*Math.random()+.5)),window.__isSupportSVGImageLoad||window.svgImageLoad(y,!0)),y.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():k),isNaN(this.drawImageAlpha)||y.setAttribute("opacity",this.drawImageAlpha),d.appendChild(y)}},l.prototype.createPattern=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this,o=arguments[4],c=arguments[5],d=this.__document.createElementNS(h,"pattern"),p=u(this.__ids),f=void 0;if(d.setAttribute("id",p),d.setAttribute("x",i),d.setAttribute("y",n),d.setAttribute("width",o||e.width),d.setAttribute("height",c||e.height),d.setAttribute("patternUnits","userSpaceOnUse"),"CANVAS"===e.nodeName||"IMG"===e.nodeName?((f=this.__document.createElementNS(h,"image")).setAttribute("width",e.width),f.setAttribute("height",e.height),e.setAttribute("crossOrigin","anonymous"),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===e.nodeName?e.toDataURL():e.getAttribute("src")),d.appendChild(f),this.__defs.appendNode(d)):e instanceof l&&(d.appendChild(e.__root.childNodes[1].cloneNode(!0)),this.__defs.appendNode(d),e.__defs.children.forEach((function(e){r.__defs.appendNode(e.cloneNode(!0))}))),s.userAgent.chromeVS<96&&s.userAgent.chromeVS>70){d.setAttribute("patternTransform","scale(0.25)"),d.setAttribute("width",4*+d.getAttribute("width")),d.setAttribute("height",4*+d.getAttribute("height"));for(var g=d.firstElementChild;g;){var y=g.getAttribute("transform");y&&g.setAttribute("transform","scale(4, 4)"+y+"scale(0.25, 0.25)");var v=g.getAttribute("width"),m=g.getAttribute("height");v&&g.setAttribute("width",4*+v),m&&g.setAttribute("height",4*+m),g=g.firstElementChild}}return new a(d)},l.prototype.setLineDash=function(e){e&&e.length>0?this.lineDash=e.join(","):this.lineDash=null},l.prototype.drawFocusRing=function(){},l.prototype.createImageData=function(){},l.prototype.getImageData=function(){},l.prototype.putImageData=function(){},l.prototype.globalCompositeOperation=function(){},l.prototype.setTransform=function(){},l.prototype.isSvg=!0,l.prototype.getLastGroup=function(){return this.__groupStack[this.__groupStack.length-1]},l.prototype.clearDefById=function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.__curDefs[e];n&&n instanceof Array&&(n.forEach((function(e){if(i){e.remove();var n=window.domTools.getCommonSvg().querySelector("#"+e.id);n&&n.remove()}else t.__defs.removeNodeIds=t.__defs.removeNodeIds||[],t.__defs.removeNodeIds.push(e.id)})),this.__curDefs[e]=[])},l.prototype.getCurrentElement=function(){return this.__currentElement},l.prototype.destroy=function(){this.__root&&(this.__root.remove(),this.__root.innerHTML="",this.__root=null)};var f=l;t.default=f},1018:function(e,t,i){"use strict";var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=i(432),l=function(){function e(){r()(this,e),this._copyTicket=null,this._querying=!1,this._notifyInfo=null,this.init()}return o()(e,[{key:"init",value:function(){var e=this;if(!this._copyTicket&&!this._querying){var t="/api/v3/office/file/"+window.urlFileId+"/copy/ticket",i=window.__WPSENV__.request({method:"GET",url:t});this._querying=!0,i.end().then((function(t){e._querying=!1,200===t.status?e._copyTicket=t.body.copy_ticket:console.error("ERR_GET_COPY_TICKET",t.status)})).catch((function(e){console.log(e)}))}return this._copyTicket}},{key:"generateUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._copyTicket)return console.error("ERR_NO_COPY_TICKET"),"";if(!e)return"";this._notifyInfo||(this._notifyInfo={ticket:this._copyTicket,objects:[]});var i=e,n=this.getImageUrlPrePostfix(),r=""+n.urlPrefix+i+n.urlPostfix;console.log("📌[ShapeCopy] ",r);var a=this._notifyInfo.objects.some((function(e){return e.attach_id===i})),o=t&&t.type?t.type:"image";return a||this._notifyInfo.objects.push({attach_id:i,object_type:o,object:e}),r}},{key:"getImageUrlPrePostfix",value:function(){var e=window.__CONFIG__.pathPrefix||"",t=""+window.location.origin+e+"/api/v3/office/copy/"+this._copyTicket+"/attach/object/",i=Object(s.default)("weboffice_branch");return{urlPrefix:t,urlPostfix:i?"?weboffice_branch="+i:""}}},{key:"update",value:function(e){if(this._notifyInfo&&this._notifyInfo.objects.length>0){var t="/api/v3/office/copy/"+this._copyTicket+"/attach/object";window.__WPSENV__.request({method:"POST",url:t,body:this._notifyInfo}).end().then((function(t){console.log("📌[ShapeCopy] NotifyServer:",t&&t.body),e&&t&&t.body&&"ok"===t.body.result&&e()}))}this._notifyInfo=null}}]),e}();t.a=l},1019:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n={ON_TIME_COUNTING:"on_time_counting",HIGH_LIGHT_COLOR:"highlightColor",COMMENT_ITEM_ID:"comment_item_id"}},1150:function(e,t,i){e.exports=i.p+"images/1.a8bd215c.png"},1151:function(e,t,i){e.exports=i.p+"images/2.ecf68379.png"},1152:function(e,t,i){e.exports=i.p+"images/3.3dea1e95.png"},1153:function(e,t,i){e.exports=i.p+"images/4.a198a616.png"},1154:function(e,t,i){e.exports=i.p+"images/5.189dc92b.png"},1155:function(e,t,i){e.exports=i.p+"images/6.e56bef1c.png"},1266:function(e,t,i){"use strict";i.r(t),i.d(t,"pcWpsClientCopy",(function(){return r})),i.d(t,"pcWpsClientPaste",(function(){return a})),i.d(t,"checkApi",(function(){return o})),i.d(t,"invoke",(function(){return l}));var n=i(536),r=function(e){l("setClipboardData",e)},a=function(e){l("getClipboardData",null,(function(t){var i=JSON.parse(t);"ok"===i.callstatus&&i.result&&(i.result.getData=function(e){if(!e)return null;var t=i.result;if(e.match(/^image\//i))return t[e];var r=t[e]||t[e.toLowerCase()];return r?n.default.decode(r):r},e(i.result))}))},o=function(e,t){if(window.cefQuery){l("common.util.support",{api:e},(function(e){var i=JSON.parse(e);"ok"!==i.callstatus?t(!1):t(i.result)}))}else t(!1)},s=0,l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=Object.assign({method:e},{params:t});if("openFile"===e&&(n=Object.assign({method:e},t)),i){var r="PCWpsClientCallBack"+(s+=1);window._parent[r]=function(e){i(e),delete window._parent[r]},n.callback='window["'+r+'"]'}var a="fromJSAsynCall("+JSON.stringify(n)+")";window.cefQuery({request:a})}},1284:function(e,t,i){"use strict";var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=i(268),l=i(724),h=i(470),u=function(){function e(t){r()(this,e),this.private=t?t.data:{}}return o()(e,[{key:"clone",value:function(){return new e(Object(s.a)(this.type))}},{key:"shadowClone",value:function(){var t=this.private,i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return new e({data:i})}},{key:"getPaths",value:function(){return this.private.paths}},{key:"setPaths",value:function(e){this.private.paths=e}},{key:"isCustomGeometry",value:function(){return null!=this.private.paths}},{key:"hasGeometry2DData",value:function(){return null!=this.getGeometrySvrObj()}},{key:"isClosedCurve",value:function(){if(!this.isCustomGeometry())return!1;var e=this.getPaths(),t=e&&e[0];return!!t&&(t.commands&&t.commands.slice(-1)[0]===l.d.Close)}},{key:"setEnv",value:function(e,t){this.geometry=e,this.sink=t}},{key:"interpretPath",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.sink&&this.geometry){var n=this.sink;return this.geometry.interpretPathList(n,e,t,i),n.pathList}console.warn("this Geomerty is not set environment！！！")}},{key:"setDataToken",value:function(e){this.dataToken=e}},{key:"getDataToken",value:function(){return this.dataToken}},{key:"setAdjustValues",value:function(e){this.type&&(this.type.data.hasOwnProperty("adjustValues")||(this.type.data.adjustValues={}),this.type.data.adjustValues=e)}},{key:"getGeometry",value:function(){if(this.geometry)return this.geometry;console.error("geomerty is not interpret!!")}},{key:"getGeometryType",value:function(){var e=this.type.data;return e&&e.presetType?e.presetType:null}},{key:"setProp",value:function(e,t){e&&t&&(this.type.data[e]=t)}},{key:"getGeometrySvrObj",value:function(){return this.type}},{key:"isPathsAttributesHasWH",value:function(){for(var e=this.geometry.geometry.definition.paths,t=0;t<e.length;t++){var i=e[t];return i.attributes&&i.attributes.w&&i.attributes.h}}},{key:"getDefinition",value:function(){return this.geometry&&this.geometry.getDefinition()}},{key:"calcRefXAdjMax",value:function(e,t,i,n){var r=void 0,a=void 0;e.isPolar?(a=e.maxR,r="gdRefR"):(a=e.maxX,r="gdRefX");var o={};return o[e[r]]=a,this.updateAdjXY(i,n,t,o)}},{key:"calcRefXAdjMin",value:function(e,t,i,n){var r=void 0,a=void 0;e.isPolar?(a=e.minR,r="gdRefR"):(a=e.minX,r="gdRefX");var o={};return o[e[r]]=a,this.updateAdjXY(i,n,t,o)}},{key:"calcRefYAdjMax",value:function(e,t,i,n){var r=void 0,a=void 0;e.isPolar?(a=e.maxAng,r="gdRefAng"):(a=e.maxY,r="gdRefY");var o={};return o[e[r]]=a,this.updateAdjXY(i,n,t,o)}},{key:"calcRefYAdjMin",value:function(e,t,i,n){var r=void 0,a=void 0;e.isPolar?(a=e.minAng,r="gdRefAng"):(a=e.minY,r="gdRefY");var o={};return o[e[r]]=a,this.updateAdjXY(i,n,t,o)}},{key:"updateAdjXY",value:function(e,t,i,n){var r=this.getDefinition(),a=this.geometry.getNameTable(),o=void 0;o=a.w==e&&a.h==t?a:new r.Guides,Object.assign(o,{w:e,h:t},this.adjustValues,n);var s=r.adjustHandles[i],l=s.x,h=s.y;return"string"==typeof l&&(l=o[l]),"string"==typeof h&&(h=o[h]),{x:l,y:h}}},{key:"calcAdjustValue",value:function(e,t,i,n){if(!this.geometry)return[];var r=!1,a=!1,o=t.isPolar;switch(this.getAdjType(t)){case l.a.gdRefR:o=!0;case l.a.gdRefX:r=!0;break;case l.a.gdRefAng:o=!0;case l.a.gdRefY:a=!0;break;case l.a.gdRefPolar:o=!0;case l.a.gdRefXY:r=a=!0}var s=[];return r&&s.push(this.updateAdjustValueForRefX(e,t,i,n,o)),a&&s.push(this.updateAdjustValueForRefY(e,t,i,n,o)),s}},{key:"getAdjType",value:function(e){return e.gdRefX&&e.gdRefY?l.a.gdRefXY:e.gdRefX?l.a.gdRefX:e.gdRefY?l.a.gdRefY:e.gdRefR&&e.gdRefAng?l.a.gdRefPolar:e.gdRefR?l.a.gdRefR:e.gdRefAng?l.a.gdRefAng:void console.warn("may adj type has a error")}},{key:"updateAdjustValueForRefX",value:function(e,t,i,n,r){var a=null!=t.maxX?t.maxX:t.maxR,o=null!=t.minX?t.minX:t.minR,s=this.calcRefXAdjMin(t,i,n.width,n.height),l=this.calcRefXAdjMax(t,i,n.width,n.height),h=s.x,u=l.x,c=e.x,d=t.gdRefX;return r&&(h=this.cartToPolar(s,n).x,u=this.cartToPolar(l,n).x,c=this.cartToPolar(e,n).x,d=t.gdRefR),{name:d,value:this.calcAjustValue(c,h,u,o,a)}}},{key:"updateAdjustValueForRefY",value:function(e,t,i,n,r){var a=null!=t.maxY?t.maxY:t.maxAng,o=null!=t.minY?t.minY:t.minAng,s=this.calcRefYAdjMin(t,i,n.width,n.height),l=this.calcRefYAdjMax(t,i,n.width,n.height),h=s.y,u=l.y,c=e.y,d=t.gdRefY,p=void 0;return r?(h=this.cartToPolar(s,n).y,u=this.cartToPolar(l,n).y,c=this.cartToPolar(e,n).y,d=t.gdRefAng,"circularArrow"===this.getGeometryType()&&(u=this.recalcForCircularArrow(d,h,u)),p=this.calcAngelAdjustValue(c,h,u,o,a)):p=this.calcAjustValue(c,h,u,o,a),{name:d,value:p}}},{key:"cartToPolar",value:function(e,t){var i=e.x-t.width/2,n=e.y-t.height/2,r=Math.sqrt(i*i+n*n),a=Math.atan2(n,i);return a<0&&(a+=2*Math.PI),{x:r,y:a}}},{key:"calcAjustValue",value:function(e,t,i,n,r){if(a=t-i,Math.abs(a)<=1e-12)return n;var a,o=Math.min(t,i),s=Math.max(t,i);return e<o?e=o:e>s&&(e=s),n+(e-t)*(r-n)/(i-t)}},{key:"calcAngelAdjustValue",value:function(e,t,i,n,r){var a,o,s;return s=i,(a=e)>=(o=t)&&a<=s||o>s&&(a<=2*Math.PI&&a>=o||a>=0&&a<=s)||(e=i),t>i&&(e>=t&&(e-=2*Math.PI),t-=2*Math.PI),n+(e-t)*(r-n)/(i-t)}},{key:"recalcForCircularArrow",value:function(e,t,i){return"adj3"===e&&Math.abs(t-i)<.001&&(i+=2*Math.PI),i}},{key:"interpretShapeSize",value:function(e,t){if(e&&t)return this.geometry.interpretShapeSize(e,t,h)}},{key:"interpretTextBoxRect",value:function(e,t){return this.geometry.interpretTextBoxRect(e,t)}},{key:"isGeometry2D",get:function(){return!0}},{key:"type",get:function(){return{data:this.private}}},{key:"adjustValues",get:function(){return this.geometry?this.geometry.adjustValues:this.type&&this.type.data&&this.type.data.adjustValues?this.type.data.adjustValues:(console.warn("geomerty is not interpret!!"),{})}}]),e}();t.a=u,Math.sqrtFix=function(e){return e<0?0:this.sqrt(e)}},1536:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(0),r=i.n(n),a=i(724),o=i(360);i.d(t,"c",(function(){return o.b})),i.d(t,"b",(function(){return o.a})),i.d(t,"d",(function(){return o.d}));i(2719);var s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.e.Normal,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r()(this,e),this.fillMode=t,this.hasStroke=i,this.extrusionOk=n,this.isClosePath=o,this.legacyColor=0}},154:function(e,t,i){"use strict";t.__esModule=!0;var n=a(i(270)),r=a(i(271));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,i,a){null===t&&(t=Function.prototype);var o=(0,r.default)(t,i);if(void 0===o){var s=(0,n.default)(t);return null===s?void 0:e(s,i,a)}if("value"in o)return o.value;var l=o.get;return void 0!==l?l.call(a):void 0}},156:function(e,t,i){"use strict";i.r(t),i.d(t,"throttle",(function(){return n})),i.d(t,"debounce",(function(){return r}));var n=function(e,t,i){if(0===t)return e;var n=void 0,r=void 0,a=void 0,o=null,s=0;i||(i={});var l=function(){s=!1===i.leading?0:(new Date).getTime(),o=null,a=e.apply(n,r),o||(n=r=null)};return function(){var h=(new Date).getTime();s||!1!==i.leading||(s=h);var u=t-(h-s);return n=this,r=arguments,u<=0||u>t?(o&&(clearTimeout(o),o=null),s=h,a=e.apply(n,r),o||(n=r=null)):o||!1===i.trailing||(o=setTimeout(l,u)),a}},r=function(e,t,i){var n=void 0,r=void 0,a=void 0,o=void 0,s=void 0,l=function l(){var h=(new Date).getTime()-o;h<t&&h>=0?n=setTimeout(l,t-h):(n=null,i||(s=e.apply(a,r),n||(a=r=null)))};return function(){a=this,r=arguments,o=(new Date).getTime();var h=i&&!n;return n||(n=setTimeout(l,t)),h&&(s=e.apply(a,r),a=r=null),s}}},158:function(e,t,i){"use strict";i.r(t),i.d(t,"UnitType",(function(){return h})),i.d(t,"FormatOpType",(function(){return u})),i.d(t,"StyleSti",(function(){return c})),i.d(t,"EditorEventTypes",(function(){return d})),i.d(t,"DirectionTypes",(function(){return p})),i.d(t,"UserEventTypes",(function(){return f})),i.d(t,"FocusTargetsDef",(function(){return g})),i.d(t,"ModelNamesDef",(function(){return y})),i.d(t,"DeviceType",(function(){return v})),i.d(t,"actionType",(function(){return m})),i.d(t,"ShapeGroupType",(function(){return _})),i.d(t,"RotateType",(function(){return w})),i.d(t,"TileTypes",(function(){return S})),i.d(t,"BorderType",(function(){return x})),i.d(t,"TblStyleOp",(function(){return T})),i.d(t,"TblSelBorderType",(function(){return k})),i.d(t,"LinkType",(function(){return C})),i.d(t,"WppLayerType",(function(){return b})),i.d(t,"FeatureType",(function(){return E})),i.d(t,"BlibFillType",(function(){return R})),i.d(t,"LineType",(function(){return P})),i.d(t,"LineValueMap",(function(){return I})),i.d(t,"USER_CUSTOM_CURSOR",(function(){return L})),i.d(t,"LineEndType",(function(){return A})),i.d(t,"ExplainBehaviorCmd",(function(){return B})),i.d(t,"ExplainType",(function(){return D})),i.d(t,"ExplainMode",(function(){return M})),i.d(t,"SlideType",(function(){return O}));var n=i(150),r=i.n(n),a=i(167);i.d(t,"ListType",(function(){return a.ListType})),i.d(t,"HorzAlignMode",(function(){return a.HorzAlignMode})),i.d(t,"ViewModes",(function(){return a.ViewModes})),i.d(t,"TextDirectionType",(function(){return a.TextDirectionType})),i.d(t,"TextAnchoringType",(function(){return a.TextAnchoringType})),i.d(t,"AutoFit",(function(){return a.AutoFit})),i.d(t,"TextWrap",(function(){return a.TextWrap})),i.d(t,"CursorType",(function(){return a.CursorType})),i.d(t,"SelectType",(function(){return a.SelectType})),i.d(t,"CommentActionType",(function(){return a.CommentActionType})),i.d(t,"CompositionState",(function(){return a.CompositionState})),i.d(t,"NoWidthLineStyle",(function(){return a.NoWidthLineStyle})),i.d(t,"UnderlineMode",(function(){return a.UnderlineMode})),i.d(t,"FillType",(function(){return a.FillType})),i.d(t,"VIEW_EVENT_TYPES",(function(){return a.VIEW_EVENT_TYPES})),i.d(t,"PlaceholderType",(function(){return a.PlaceholderType})),i.d(t,"WpActionType",(function(){return a.WpActionType})),i.d(t,"ShapeType",(function(){return a.ShapeType})),i.d(t,"TblBorderType",(function(){return a.TblBorderType})),i.d(t,"ShapeModeType",(function(){return a.ShapeModeType})),i.d(t,"MediaType",(function(){return a.MediaType})),i.d(t,"MediaSubType",(function(){return a.MediaSubType})),i.d(t,"MediaDataType",(function(){return a.MediaDataType})),i.d(t,"TableOPT",(function(){return a.TableOPT})),i.d(t,"WhiteBoardShapeType",(function(){return a.WhiteBoardShapeType})),i.d(t,"FormatBrushType",(function(){return a.FormatBrushType})),i.d(t,"PartOfShapeName",(function(){return a.PartOfShapeName})),i.d(t,"ShowAdvanceMode",(function(){return a.ShowAdvanceMode})),i.d(t,"CoreErrorType",(function(){return a.CoreErrorType})),i.d(t,"ActionLinkToType",(function(){return a.ActionLinkToType})),i.d(t,"DefThemeLangInfo",(function(){return a.DefThemeLangInfo}));var o=i(664);i.d(t,"OPENAPI_EVENT",(function(){return o.OPENAPI_EVENT}));var s,l=i(144);i.d(t,"userAgent",(function(){return l}));var h={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},u={Font_Bold:0,Font_Italic:1,Font_Underline:2,Font_StrikeThrough:3,Font_FontSize:4,Font_GrowUp:5,Font_Superscript:6,Font_Subscript:7,Font_Name:8,Font_Color:9,Para_ChangeIndent:10,Para_Alignment:11,Style_ApplyToRange:12,Para_LineSpacingRel:13,Para_ChangeFirstLineIndent:14,List_ApplyToRange:15,Para_RemoveIndent:16,Font_HighlightColor:99,Font_AllCaps:50,Font_SmallCaps:51,Font_DoubleStrikeThrough:52,Font_EmphasisMark:53,Font_Hidden:54,Font_Scaling:55,Font_Spacing:56,Font_Actions:57,Para_ReadingOrder:100,Para_LeftIndentAbsAndRef:101,Para_FirstLineIndentAbsAndRef:102,Para_RightIndentAbsAndRef:103,Para_SpaceBeforeAbsAndRef:104,Para_SpaceAfterAbsAndRef:105,Para_OutlineLevel:106,Para_FarEastLineBreakControl:107,Para_WordWrap:108,Para_HangingPunctuation:109,Para_HalfWidthPunctuationOnTopOfLine:110,Para_AddSpaceBetweenFarEastAndAlpha:111,Para_AddSpaceBetweenFarEastAndDigit:112,Para_Indentation:113,Sec_Margins:200,Sec_PageOrientation:201},c={stiNormal:0,stiLev1:1,stiLev2:2,stiLev3:3,stiLev4:4,stiNormalChar:65,stiMax:260,stiUser:4094,stiNil:4095},d={SELECT_CHANGE:"select_change",PICTURE_INSERT:"picture_insert",PICTURE_EDIT:"picture_edit"},p={LEFT:"left",RIGHT:"right",BOTTOM_RIGHT:"BOTTOM_RIGHT",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_CENTER:"BOTTOM_CENTER",BOTTOM:"BOTTOM",TOP:"TOP",TOP_RIGHT:"TOP_RIGHT",TOP_LEFT:"TOP_LEFT",TOP_CENTER:"TOP_CENTER",RIGHT_TOP:"RIGHT_TOP",RIGHT_CENTER:"RIGHT_CENTER",RIGHT_BOTTOM:"RIGHT_BOTTOM",COOP_ICON_HOVER_RIGHT:"COOP_ICON_HOVER_RIGHT"},f={KEY_EVENT:"key_event",MOUSE_ACTION:"mouse_action"},g={COMMON:"common",CONTAINER:"container",SLIDE:"slide",SHAPE:"shape",PLAY_View:"play_view",PREVIEW:"preview"},y={paragraph:"paragraph",chapter:"chapter",common:"common",container:"container",slide:"slide",shape:"shape",link:"link",fill:"fill",outline:"outline",action:"action",ink:"ink",connector:"connector",explain:"explain"},v={DEVICE_PC:0,DEVICE_MOBILE:1},m={Move_Shape:1,Resize_Shape:2,Rotate_Shape:3,Modify_Picture:4,Modify_Processon:5,Modify_Fill:6,Modify_Outline:7,Modify_Geometry:8,Modify_TextFont:9,Modify_Media:10,Modify_Table:11,Modify_Chart:12,Modify_InkData:13,Shape_Replace:14,Modify_Hyperlink:15,Modify_TextFrameProps:16,Modify_Property:17,Tile_Shapes:18,Modify_Line:19,Modify_Picture_Props:20,not_used:21,Modify_Border:22,Modify_Effects:23,Modify_ExtData:24,Modify_Actions:25},_={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9},w={VerticalFlipped:"verticalFlipped",HorizontalFlipped:"horizontalFlipped",Right:"right",Left:"left",Some:"some",Reset:"reset"},S={Top:"top",Right:"right",Bottom:"bottom",Left:"left",Center:"center",VerCenter:"ver_center",VerAverage:"ver_average",HorCenter:"hor_center",HorAverage:"hor_average"},x={BorderTop:1,BorderLeft:2,BorderBottom:3,BorderRight:4,BorderDiagonalDown:5,BorderDiagonalUp:6,BorderHorizontal:7,BorderVertical:8},T={HeaderRow:1,FirstCol:2,TotalRow:3,LastCol:4,BandedRows:5,BandedCols:6},k={Invalid:0,AllBorder:1,MiddleBorder:2,LeftBorder:3,RightBorder:4,TopBorder:5,BottomBorder:6,InsideHBorder:7,InsideVBorder:8,OutBorder:9,NonBorder:10},C={web:"web",email:"email",slideRlt:"slideRelative",slideAsl:"slideAbsolute"},b={WppLayerDocument:65536,WppLayerSlideContainer:65537,WppLayerNormalSlide:65538,WppLayerMasterSlide:65539,WppLayerLayoutSlide:65540,WppLayerHandoutSlide:65541,WppLayerNotesMaster:65542,WppLayerNotesPage:65543},E={index:"ppt",whiteboard:"kw"},R={scaleFill:0,scaleSuit:1,stretch:2,tile:3,other:4},P={SINGLE:"single",DOUBLE:"double",THIN_THICK:"thin_thick",THICK_THIN:"thick_thin",THIN_THICK_THIN:"thin_thick_thin",ROUND_DOT:"round_dot",SHORT_DASH:"short_dash",DASH_DOT:"dash_dot",DOUBLE_DOT:"double_dot",OTHER:"..."},I=(s={},r()(s,P.SINGLE,{compoundLine:0,dashType:0}),r()(s,P.DOUBLE,{compoundLine:1,dashType:0}),r()(s,P.THIN_THICK,{compoundLine:3,dashType:0}),r()(s,P.THICK_THIN,{compoundLine:2,dashType:0}),r()(s,P.THIN_THICK_THIN,{compoundLine:4,dashType:0}),r()(s,P.ROUND_DOT,{compoundLine:0,dashType:8}),r()(s,P.SHORT_DASH,{compoundLine:0,dashType:2}),r()(s,P.DASH_DOT,{compoundLine:0,dashType:4}),r()(s,P.DOUBLE_DOT,{compoundLine:1,dashType:8}),s),L={rowSelect:"cursor-row-select",colSelect:"cursor-col-select-down",rowSelectLeft:"cursor-row-select-left",rowSelectUp:"cursor-col-select-up",brushPosition:"cursor-format-position",brushAnime:"cursor-format-anime",brushPointer:"cursor-format-pointer",brushText:"cursor-format-text"},A={LineEndTypeNone:0,LineEndTypeTriangle:1,LineEndTypeStealth:2,LineEndTypeDiamond:3,LineEndTypeOval:4,LineEndTypeArrow:5},B="webwpp_explain",D={shapeAnime:"shapeAnimeExplain",slideAnime:"slideAnimeExplain"},M={play:"play",edit:"edit"},O={slide:"slides",layout:"slideLayouts",master:"slideMasters"}},167:function(e,t,i){"use strict";i.r(t),i.d(t,"MediaDataType",(function(){return r.a})),i.d(t,"MediaType",(function(){return r.c})),i.d(t,"MediaSubType",(function(){return r.b})),i.d(t,"DefThemeLangInfo",(function(){return a.a})),i.d(t,"UnderlineMode",(function(){return o})),i.d(t,"NoWidthLineStyle",(function(){return s})),i.d(t,"HorzAlignMode",(function(){return l})),i.d(t,"TextFrameAlignType",(function(){return h})),i.d(t,"ParagraphReadingOrder",(function(){return u})),i.d(t,"ListType",(function(){return c})),i.d(t,"PlaceholderType",(function(){return d})),i.d(t,"WpPlaceholder",(function(){return p})),i.d(t,"TextStyleType",(function(){return f})),i.d(t,"PlaceholderSizeType",(function(){return g})),i.d(t,"TextDirectionType",(function(){return y})),i.d(t,"TextAnchoringType",(function(){return v})),i.d(t,"TextVerticalType",(function(){return m})),i.d(t,"TextWrap",(function(){return _})),i.d(t,"AutoFit",(function(){return w})),i.d(t,"DirectionKey",(function(){return S})),i.d(t,"CursorType",(function(){return x})),i.d(t,"GlyphFactor",(function(){return T})),i.d(t,"LineSpaceRule",(function(){return k})),i.d(t,"ViewModes",(function(){return C})),i.d(t,"EditMode",(function(){return b})),i.d(t,"PhTextModifyRules",(function(){return E})),i.d(t,"SelectType",(function(){return R})),i.d(t,"CompositionState",(function(){return P})),i.d(t,"FillType",(function(){return I})),i.d(t,"WpActionType",(function(){return L})),i.d(t,"ActionLinkToType",(function(){return A})),i.d(t,"ShapeTreeInsertCommandTypes",(function(){return B})),i.d(t,"UnitsLength",(function(){return D})),i.d(t,"InkBrushType",(function(){return M})),i.d(t,"InkBrushTip",(function(){return O})),i.d(t,"InkBrushRasterOp",(function(){return N})),i.d(t,"ShapeMoveType",(function(){return F})),i.d(t,"TableOPT",(function(){return V})),i.d(t,"TblBorderType",(function(){return U})),i.d(t,"CommentActionType",(function(){return G})),i.d(t,"FormatBrushType",(function(){return H})),i.d(t,"VIEW_EVENT_TYPES",(function(){return n.VIEW_EVENT_TYPES})),i.d(t,"UpdatePartOfShape",(function(){return W})),i.d(t,"PartOfShapeName",(function(){return j})),i.d(t,"ShapeType",(function(){return Y})),i.d(t,"ShapeModeType",(function(){return z})),i.d(t,"WhiteBoardShapeType",(function(){return K})),i.d(t,"DefaultTextSize",(function(){return q})),i.d(t,"ShowAdvanceMode",(function(){return X})),i.d(t,"CoreErrorType",(function(){return J})),i.d(t,"WppBeautifyType",(function(){return Z})),i.d(t,"TransActionType",(function(){return Q})),i.d(t,"WppErrStr",(function(){return $})),i.d(t,"DocerSlideActionType",(function(){return ee}));var n=i(563),r=i(522),a=i(873),o={None:0,Normal:1,Wordonly:2},s={None:0,Single:1,Hairline:2,Double:3,Dotted:4,Hidden:5,Thick:6,Dash:7,Dot:8,DotDash:9,DotDotDash:10,Wave:11,DottedHeavy:12,DashedHeavy:13,DashLong:14,DashLongHeavy:15,DashDotHeavy:16,DashDotDotHeavy:17,WavyHeavy:18,WavyDouble:19},l={Auto:0,Left:1,Center:2,Right:3,Adjustify:4,FullAdjustify:5,MiddleJustify:6,CenterAcross:7,HighJustify:8,LowJustify:9,ThaiFullAdjustify:10},h={Left:0,Center:1,Right:2},u={ReadingOrderLtr:0,ReadingOrderRtl:1},c={NoNumbering:0,Bullet:1,Numbering:2,TaskList:3},d={Title:0,Body:1,CenterTitle:2,SubTitle:3,DateTime:4,SlideNumber:5,Footer:6,Header:7,Object:8,Chart:9,Table:10,ClipArt:11,Diagram:12,Media:13,SlideImage:14,Picture:15},p={Title:1,Body:2,CenterTitle:3,SubTitle:4,VerticalTitle:5,VerticalBody:6,Object:7,Chart:8,Bitmap:9,MediaClip:10,OrgChart:11,Table:12,SlideNumber:13,Header:14,Footer:15,Date:16},f={Title:"title",Body:"body",Other:"other",Notes:"notes"},g={PlaceholderSizeTypeFull:0,PlaceholderSizeTypeHalf:1,PlaceholderSizeTypeQuarter:2},y={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7},v={Top:0,Center:1,Bottom:2,Justified:3,Distributed:4},m={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7},_={None:0,Square:1},w={None:0,Normal:1,Advanced:2},S={Up:1,Down:2,Left:3,Right:4},x={Text:1,TextBorder:11,Shape:2,ShapeBoder:21,Table:3,TableBoder:31,TableCell:32,CellText:33,TableTop:34,TableBottom:35,TableLeft:36,TableRight:37,TableBorderVert:38,TableBorderHori:39,Link:41,Image:42,ProcessOn:43,resourceReload:66},T={compressWidth:.6,scriptHeight:.2},k={Auto:"auto",Exact:"exact",Least:"atLeast"},C={EditView:"edit",PlayView:"play",PreView:"preview",ThmubnailView:"thumbnail",NotesBody:"notesbody",Snapshot:"snapshot",Review:"review",MasterView:"masterView",MasterThumbnailView:"masterThumbnailView"},b={slide:2,layout:1,master:0},E=[{src:"编辑母版",dst:"编辑"},{src:/\u6807\u9898\u6837\u5f0f/g,dst:"标题"},{src:/edit master/gi,dst:"edit"},{src:/title style/gi,dst:"title"},{src:/\u6587\u672c\u6837\u5f0f/g,dst:"文本"},{src:/text style/gi,dst:"text"}],R={select_none:0,select_slide:1,select_multi_slide:2,select_shape:3,select_multi_shape:4,select_table:5,select_cell:6,select_multi_cell:7,select_text:8,select_multi_animation:9,_strs:["select_none","select_slide","select_multi_slide","select_shape","select_multi_shape","select_table","select_cell","select_multi_cell","select_text","select_multi_animation"],toString:function(e){return this._strs[e]},canSelectTextType:function(e){return e===this.select_shape||e===this.select_cell||e===this.select_text||e===this.select_multi_animation}},P={NoComposition:0,Start:1,Update:2,End:3},I={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},L={ActionMixed:-2,ActionNull:-1,ActionNone:0,ActionNextSlide:1,ActionPreviousSlide:2,ActionFirstSlide:3,ActionLastSlide:4,ActionLastSlideViewed:5,ActionEndShow:6,ActionHyperlink:7,ActionRunMacro:8,ActionRunProgram:9,ActionNamedSlideShow:10,ActionOLEVerb:11,ActionPlay:12},A={CustomShow:6,Slide:7,URL:8,otherPres:9,otherFile:10,None:255},B={InsertTable:0,InsertPicture:1,InsertShape:2,InsertTextBox:3,InsertProcessOn:4,InsertInk:5,InsertMedia:6,InsertSvgPicture:7},D={m:0,cm:1,mm:2,in:3,pt:4,ti:5,pc:6,em:7,ex:6},M={brushDefaultWidth4Ellipse:19050,brushDefaultHeight4Ellipse:19050,waterColorBrushDefaultWidth4Ellipse:34925,waterColorBrushDefaultHeight4Ellipse:34925,brushDefaultWidth4Rectangle:31750,brushDefaultHeight4Rectangle:127e3},O={ellipse:0,rectangle:1,drop:2},N={CopyPen:0,MaskPen:1,NoOperation:2},F={Front:1,Back:2,Forward:3,Backward:4},V={InsertRow:1,InsertCol:2,DeleteRows:3,InsertRowFake:4,DeleteCols:5,InsertColFake:6,SplitCells:7,UnSplitCells:8,MergeCells:9,UnMergeCells:10,ModCells:11,ModTable:12,DistributeRows:13,DistributeCols:14,SetVertPos:15,SetHoriPos:16,SetRowHeight:17,SetColWidth:18},U={Top:1,Left:2,Right:3,Bottom:4,TL2BR:5,TR2BL:6},G={AddComment:0,DeleteComment:1,ModifyComment:2,ThumbsUpComment:3,OnceMoreComment:4},H={Invalid:-1,Common:0,Transform2D:1,Animation:2},W={UpdateShape:1,UpdateText:2,UpdateTableCell:3,UpdateShapePic:4,UpdateShapePicFill:5},j={Shape:function(e){return"s_"+e},BackendShape:function(e){return"backend_s_"+e},Geomerty:function(e){return"s_"+e+"_geomerty"},Media:function(e){return"s_"+e+"_media"},Text:function(e){return"s_"+e+"_text"},TextParagraph:function(e){return"s_"+e+"_textParagraph"},Ink:function(e){return"s_"+e+"_ink"},Table:function(e){return"s_"+e+"_table"},TableCell:function(e){return"s_"+e+"_tableCell"},TableText:function(e){return"s_"+e+"_tableText"},TableBorder:function(e){return"s_"+e+"_tableBorder"},ShapeFill:function(e,t){return"s_"+e+"_shapeFill_"+t},ShapeImage:function(e,t){return"s_"+e+"_image_"+t},ShapeFillPath:function(){return"shape_fill"},ShapeOutlinePath:function(){return"shape_outline"}},Y={Picture:1,NormalShape:2,TextBox:3,Processon:4,Table:5,SmartArt:6,Diagram:7,Chart:8,Slicer:9,Media:10,OleShape:11,GroupShape:12,Background:13,Ink:14},z={MODEL_CHART:0,MODEL_DIAGRAM:1,MODEL_DIAGRAM_SHAPETREE:2,MODEL_DIAGRAM_GROUPSHAPE:3,MODEL_DIAGRAM_SHAPE:4,MODEL_SMARTART:5,MODEL_SMARTART_SHAPETREE:6,MODEL_SMARTART_GROUPSHAPE:7,MODEL_SMARTART_SHAPE:8,MODEL_SMARTART_PICTURE_PLACEHOLDER:9,MODEL_OBJTABLE:10,MODEL_OBJTABLE_CELL:11,MODEL_TEXTFRAME:12,MODEL_OUTLINE:13,MODEL_SLICER:14,MODEL_CHART_SUBMODEL_BEGIN:15,MODEL_CHART_SUBMODEL_END:270,MODEL_CUSTOM:65536,MODEL_SLIDECONTAINER:65537,MODEL_NORMALSLIDE:65538,MODEL_MASTERSLIDE:65539,MODEL_LAYOUTSLIDE:65540,MODEL_HANDOUTMASTER:65541,MODEL_NOTESMASTER:65542,MODEL_NOTESPAGE:65543,MODEL_SHAPETREE:65544,MODEL_BGSHAPE:65545,MODEL_GROUPSHAPE:65546,MODEL_SHAPE:65547,MODEL_OUTLINE_TEXTFRAME:65548},K={StickyNotes:1},q=18,X={mixed:-2,onClick:1,onTime:2},J={LocalTransactErr:1,ServerDataErr:2,ServerQueryErr:3,SessionErr:4,SelectionErr:5},Z={Invalid:-1,Presentation:0,Slide:1,Shape:2},Q={None:"none",Forward:"forward",BackWard:"backward"},$={E_WPP_READ_ONLY:"read_only",E_WPP_CORE_INTERNAL_ERROR:"core_internal_error",E_WPP_CORE_EDITOR_UNLOADED:"core_editor_unloaded",E_WPP_INVALID_IN_PARAMETER:"invalid_in_parameter",E_WPP_INVALID_SELECT_STATE:"invalid_select_state",E_WPP_SLIDES_UNLOADED:"slides_unloaded"},ee={Invalid:-1,InsertSlide:0,ModifySlide:1,InsertDesign:2,DeleteDesign:3,InsertSlides:4}},1708:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(327),r=window.__CONFIG__.wps.cdnFontsJson,a=function(){return{types:n.default.HTTP_TYPES,autoErrorToast:!1,callAPI:function(e){return e.get(window.__CONFIG__.isEnableFontServer?"/api/v3/office/fonts_config/wps":r).end()}}}},1711:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return c}));var n=i(26),r=i.n(n),a=Math.atan2,o=Math.sin,s=Math.cos,l=Math.PI/180;function h(e,t,i){var n=a(e.y-t.y,e.x-t.x),r=a(i.y-t.y,i.x-t.x),o=(r-n)/l;return o<0&&(o=360+o),o%=360}function u(e,t,i){var n=e.x,r=e.y,a=e.width,l=e.height,h=Math.PI/180*i,u=(n-t.x)*s(h)-(r-t.y)*o(h)+t.x,c=(n-t.x)*o(h)+(r-t.y)*s(h)+t.y,d=((n+=a)-t.x)*s(h)-(r-t.y)*o(h)+t.x,p=(n-t.x)*o(h)+(r-t.y)*s(h)+t.y;r+=l;var f=(n-t.x)*s(h)-(r-t.y)*o(h)+t.x,g=(n-t.x)*o(h)+(r-t.y)*s(h)+t.y,y=((n-=a)-t.x)*s(h)-(r-t.y)*o(h)+t.x,v=(n-t.x)*o(h)+(r-t.y)*s(h)+t.y,m=Math.min(u,d,f,y),_=Math.min(c,p,g,v),w=Math.max(c,p,g,v);return{x:m,y:_,width:Math.max(u,d,f,y)-m,height:w-_}}function c(e,t){var i=r()({},e);return["x","y","width","height","top","left","bottom","right"].forEach((function(n){Object.isEmpty(e[n])||(i[n]=e[n]*t)})),i}window.zoomRect=c},1717:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;r()(this,e),this._max=t,this._keyList=[],this._map={}}return o()(e,[{key:"reset",value:function(){this._keyList=[],this._map={}}},{key:"destroy",value:function(){delete this._keyList,delete this._map,this._keyList=[],this._map={}}},{key:"_updateLRU",value:function(e){for(var t=this._keyList,i=t.indexOf(e);i>-1;)t.splice(i,1),i=t.indexOf(e);t.unshift(e)}},{key:"delete",value:function(e){delete this._map[e];for(var t=this._keyList,i=t.indexOf(e);i>-1;)t.splice(i,1),i=t.indexOf(e)}},{key:"set",value:function(e,t){for(this._map[e]=t,this._updateLRU(e);this.size()>this._max;)this.pop()}},{key:"pop",value:function(){var e=this._keyList.pop(),t=this._map[e];return delete this._map[e],t}},{key:"get",value:function(e){var t=this._map[e];return t&&this._updateLRU(e),t}},{key:"size",value:function(){return this._keyList.length}},{key:"isFull",value:function(){return this.size()>=this._max}}]),e}();!function(){function e(t){r()(this,e),this._imageSha1={},this._sha1Base64={}}o()(e,[{key:"isFull",value:function(){return!1}},{key:"set",value:function(e,t){var i=t&&t.data;i&&i.sha1&&(this._imageSha1[e]=i.sha1,this._sha1Base64[i.sha1]={data:t,timestamp:Date.now()},this.clean())}},{key:"get",value:function(e){var t=this._imageSha1[e],i=this._sha1Base64[t];if(t&&i)return i.timestamp=Date.now(),i.data}},{key:"setSha1",value:function(e,t){e&&t&&(this._imageSha1[e]=t)}},{key:"destroy",value:function(){delete this._imageSha1,this._imageSha1={},this.clean()}},{key:"clean",value:function(){var e=Object.values(this._sha1Base64);if(e.length>50){e.sort((function(e,t){return e.timestamp-t.timestamp}));for(var t=0;t<e.length-50;t++){var i=e[t],n=i&&i.data.sha1;n&&delete this._sha1Base64[n]}}}}])}()},1718:function(e,t,i){"use strict";i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return h})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return f})),i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return y}));var n=!1,r=!1,a=0,o=null,s=null,l=function(){n=!0,a=window.performance.now()},h=function(e,t,i){if(n&&!r&&!o&&i>0){o=[],s={};for(var a=e;a<=t;a++)o.push(a),s[a]=!1}},u=function(e,t){n&&!r&&(o&&o.includes(e)&&s&&(s[e]=!0),(t<=0||o&&o.every((function(e){return s&&s[e]}))&&!r)&&(n=!1,r=!0,window.collection("experience",{event:"reading_thumbnail",times:Math.round(window.performance.now()-a),value:o?o.length:0}),s=null,o=null))},c=!1,d=!1,p=!1,f=function(){c=!0,v()},g=function(){d=!0;var e=window.backendImageManager&&window.backendImageManager.fetchInFirstRenderImageCount;Object.isEmpty(e)||(0===e&&y(),window.collection("experience",{event:"reading_pic1_quantity",value:e})),v()},y=function(){p=!0,v()},v=function(){c&&d&&p&&window.collection("experience",{event:"reading_open_all",times:parseInt(window.performance.now())})}},1874:function(e,t,i){"use strict";i.d(t,"b",(function(){return c.a})),i.d(t,"c",(function(){return y})),i.d(t,"a",(function(){return u.FocusTargetsDef}));var n=i(26),r=i.n(n),a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=i(335),u=i(158),c=i(388),d=function(){function e(t){o()(this,e),this.stopBubble=function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()},this.handleMap={}}return l()(e,[{key:"onEvent",value:function(e,t){if(this.isEvtHotkey(e,t)){var i=this.getHotKeyName(t);return this.handleMap[e].fireDirect(i,t),!0}return!1}},{key:"isEvtHotkey",value:function(e,t){if(this.handleMap&&this.handleMap[e]){var i=this.getHotKeyName(t);if(this.handleMap[e]._listeners[i])return!0}return!1}},{key:"getHotKeyName",value:function(t){return e.getHotKeyName(t)}},{key:"addListener",value:function(e,t,i){var n=this,r=t.keyCode,a=t.ctrlKey,o=t.metaKey,s=t.shiftKey,l=t.altKey;e instanceof Array||(e=[e]),r instanceof Array||(r=[r]),e.forEach((function(e){n.handleMap[e]||(n.handleMap[e]=new h.a),r.forEach((function(t){var r=n.getHotKeyName({keyCode:t,ctrlKey:a,metaKey:o,shiftKey:s,altKey:l});n.handleMap[e].on(r,i)}))}))}},{key:"removeListener",value:function(e,t,i){var n=this,r=t.keyCode,a=t.ctrlKey,o=t.metaKey,s=t.shiftKey,l=t.altKey;e instanceof Array||(e=[e]),r instanceof Array||(r=[r]),e.forEach((function(e){n.handleMap[e]||(n.handleMap[e]=new h.a),r.forEach((function(t){var r=n.getHotKeyName({keyCode:t,ctrlKey:a,metaKey:o,shiftKey:s,altKey:l});n.handleMap[e].off(r,i)}))}))}},{key:"addKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"addKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}}],[{key:"getHotKeyName",value:function(e){var t=e,i=t.keyCode,n=t.key;return u.userAgent.isMacOs&&e.metaKey&&e.ctrlKey&&!u.userAgent.isIPad?null:(e instanceof KeyboardEvent||!u.userAgent.isMacOs||!Object.isEmpty(e.metaKey)||((e=Object.assign({},e)).metaKey=e.ctrlKey),window.isCtrlOrCmd(e)&&(u.userAgent.isIPad&&229===i?(n=n&&n.toUpperCase&&n.toUpperCase(),i=c.a[n]+"_ctrl"):i+="_ctrl"),e.shiftKey&&(i+="_shift"),window.isCtrlOrCmdAndAlt(e)?i+="_ctrl_alt":e.altKey&&(i+="_alt"),"_"+i)}}]),e}(),p=i(156),f=i(144),g=i(2270),y=function(){function e(t){var i=this;o()(this,e),this.onEvent=function(e,t){if(Object(g.a)()&&!i.stopKeyEvent&&window.APP.presentation){var n=i.getTragetModel();if(n&&n.isEvtHotkey(e,t))i.stopBubble(t),t.immediately||i._immedShortcuts.includes(d.getHotKeyName(t))?i._dispatcherImmediately(e,t):i._dispatcher(e,t),console.log("UilHotkeys have Hotkey");else(i.hasLockFocus()&&u.FocusTargetsDef.PLAY_View===i.curModelName&&i._abortShortcuts.includes(d.getHotKeyName(t))||i._globalShortcuts.includes(d.getHotKeyName(t)))&&i.stopBubble(t)}},this._dispatcher=Object(p.throttle)((function(e,t){var n=i.getTragetModel();return!n||!i.isPubHotkeys(t)&&i.hasLockFocus()?void 0:n&&n.onEvent(e,t)}),30),this._dispatcherImmediately=function(e,t){var n=i.getTragetModel();return!n||!i.isPubHotkeys(t)&&i.hasLockFocus()?void 0:n&&n.onEvent(e,t)},this.stopBubble=function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()},this._modelEventMap={},this._eventNameMap={},this._panelOrModalCount=0,window.addEventListener(u.UserEventTypes.KEY_EVENT,(function(e){var t=e.detail,n=t.type,r=t.data;i.onEvent(n,r)})),document.addEventListener("paste",(function(e){e.clipboardData&&e.clipboardData.items&&(f.isMobile||document.activeElement&&"text"===document.activeElement.type||i.onEvent("keydown",{keyCode:"paste",event:e}))})),this._globalShortcuts=this._globalShortcuts||[d.getHotKeyName({keyCode:c.a.F,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.S,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.H,ctrlKey:!0})],this._abortShortcuts=this._abortShortcuts||[d.getHotKeyName({keyCode:c.a.ADD,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.MINUS,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.NUMBER_ADD,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.EQUAL,ctrlKey:!0}),d.getHotKeyName({keyCode:c.a.CONNECT,ctrlKey:!0})],this._immedShortcuts=this._immedShortcuts||[d.getHotKeyName({keyCode:c.a.C,ctrlKey:!0})]}return l()(e,[{key:"on",value:function(e,t,i,n){var a=this;e instanceof Array||(e=[e]),e.forEach((function(o){a._modelEventMap[o]||(a._modelEventMap[o]=new d(a)),a._modelEventMap[o].addListener(t,i,n);var s=i.keyCode,l=i.global,h=i.immed,u=i.abort;s instanceof Array||(s=[s]),s.forEach((function(e){l&&a._globalShortcuts.push(d.getHotKeyName(r()({},i,{keyCode:e}))),h&&a._immedShortcuts.push(d.getHotKeyName(r()({},i,{keyCode:e}))),u&&a._abortShortcuts.push(d.getHotKeyName(r()({},i,{keyCode:e})))})),a._eventNameMap[t]?a._eventNameMap[t]++:(a._eventNameMap[t]=1,console.log("addEventListener",e,t,i),window.domTools.addEventListener(document,t,(function(e){!document.activeElement||"text"!==document.activeElement.type&&"textarea"!==document.activeElement.type||a._globalShortcuts.includes(d.getHotKeyName(e))?a.onEvent(t,e):a._abortShortcuts.includes(d.getHotKeyName(e))&&a.stopBubble(e)})))}))}},{key:"getTragetModel",value:function(e){return this._modelEventMap[e||this.curModelName||u.FocusTargetsDef.CONTAINER]}},{key:"isPubHotkeys",value:function(e){return this._globalShortcuts.includes(d.getHotKeyName(e))}},{key:"off",value:function(e,t,i,n){var r=this;e instanceof Array||(e=[e]),e.forEach((function(e){var a=r._modelEventMap[e];a&&a.removeListener(t,i,n)}))}},{key:"setFocusTarget",value:function(e){this.curModelName=e}},{key:"hasLockFocus",value:function(){return document.lockFocus}},{key:"setStopKeyEvent",value:function(e){this.stopKeyEvent=e}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}()},1909:function(e,t,i){"use strict";var n=i(147),r=i.n(n),a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=i(158),u=i(617),c=i(261),d=window.Toast,p=void 0,f=function(){function e(t){o()(this,e),this.handleMimeDatas=function(e){var t=e.mimeDatas,i=["text/html"];return t.map((function(e){return i.push(e.type)})),i},this.handleMimeTypes=function(e,t){var i=[];e.map((function(e){i[e.type]=e.value}));var n="";return t&&t.map((function(e){n+='"'+e+'",'})),n=n&&n.substring(0,n.length-1),i["text/ksDocClipBoardInfo"]=i["text/ksDocClipBoardInfo"].replace('"text/html"',n),i},this._id=t.id,this._stack=[],this.selection=t}var t;return l()(e,[{key:"getId",value:function(){return this._id}},{key:"copy",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n&&!this._check())return c.canRequestForAuthForSecurityDoc&&Object(c.isCopyLimitedSecurityDoc)()?Object(c.requestForAuth)({type:c.AUTH_TYPES.COPY}):d.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.cannotOperate", "你没有此操作的权限，请联系所有者修改权限"));if(e===this.constructor.DataType.Text){if(!t)return d.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.copyFailed", "复制失败"));u.a.copy(window.APP.copyControl()?"":t),d.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessPure", "复制成功"))}else{u.a.copyShape("<html><body> </body></html>",!1," ");var r=u.a&&u.a.getCurrentClipBoardInfo()&&u.a.getCurrentClipBoardInfo().id;this.selection.copy((function(t){if(t&&0===t.error){i._push({type:e,data:r});var n=u.a.getCopyID(),a=window.APP.copyControl()?"<div></div>":t.copyHtml;u.a.asyncWrite({"text/plain":" ","text/html":a},n),d.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessPure", "复制成功"))}else d.error(_i18n("applications.presentation.app.shell.editor.model.commonModel.copyFailed", "复制失败"))}),{ksDocClipboardId:r})}}},{key:"paste",value:(t=r()(regeneratorRuntime.mark((function t(i){var n,r,a,o,s,l,c,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="",r="",a=0,o=void 0,s=void 0,l=void 0,t.prev=5,!h.userAgent.isMobile&&!h.userAgent.isIPad){t.next=14;break}return t.next=9,u.a.getClipBoardData();case 9:c=t.sent,n=c["text/plain"],r=c["text/html"],l=u.a.getCurrentClipBoardInfo(),s=l&&l.id;case 14:n&&n.trim()&&(o={timestamp:a,data:n,type:e.DataType.Text}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(5),console.error("fetch window.CLIPBOARD DATA failed: ",t.t0);case 20:if(n||r||s){t.next=23;break}return h.userAgent.isIPad||d.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.pasteEmpty", "系统未监测到可粘贴内容")),t.abrupt("return");case 23:o&&o.type===e.DataType.Text?(window.APP.shell.editor.common._insertText(n),1===(p=this.selection.getActiveShapes()||[]).length&&this.selection.selectShape(p[0])):this.selection.paste({ksDocClipboardId:s,fromApp:l.from,mimeTypes:l.mimeTypes,html:l.html}),i&&i(o);case 25:case"end":return t.stop()}}),t,this,[[5,17]])}))),function(e){return t.apply(this,arguments)})},{key:"cut",value:function(e,t,i){var n=this;if(!this._check())return c.canRequestForAuthForSecurityDoc&&Object(c.isCopyLimitedSecurityDoc)()?Object(c.requestForAuth)({type:c.AUTH_TYPES.COPY}):d.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.cannotOperate", "你没有此操作的权限，请联系所有者修改权限"));if(e===this.constructor.DataType.Text){if(!t)return d.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutFailed", "剪切失败"));this.selection.deleteText(),u.a.copy(t),d.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessPure", "剪切成功"))}else{u.a.copyShape("<html><body> </body></html>",!1," ");var r=u.a&&u.a.getCurrentClipBoardInfo()&&u.a.getCurrentClipBoardInfo().id;this.selection.cut((function(){return!0}),(function(t){if(t&&0===t.error){n._push({type:e,data:r}),n.selection._ksDocClipboardId=r;var i=u.a.getCopyID();u.a.asyncWrite({"text/plain":" ","text/html":t.copyHtml},i),d.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessPure", "剪切成功"))}else d.error(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutFailed", "剪切失败"))}),{ksDocClipboardId:r})}}},{key:"canPaste",value:function(e){return!this._isEmpty()&&this._stack[this._stack.length-1].type===e}},{key:"_check",value:function(){return!!window.APP.canCopy()}},{key:"_push",value:function(e){e&&e.type&&e.data||console.warn("[Clipboard] push invalid item: ",e),this._stack.length>100&&this._stack.shift(),e.timestamp=Date.now(),this._stack.push(e)}},{key:"_pop",value:function(){if(!this._isEmpty())return this._stack[this._stack.length-1]}},{key:"_isEmpty",value:function(){return 0===this._stack.length}}]),e}();f.DataType={Text:"text",Slide:"slide",Shape:"shape"};var g=function(){function e(){o()(this,e)}return l()(e,null,[{key:"getInstance",value:function(e){if(!e)throw new Error("[Clipboard] selection is invalid!");return p&&p.getId()===e.id||(p=new f(e)),p}}]),e}();t.a=g},208:function(e,t,i){"use strict";i.r(t);var n=i(158);i.d(t,"userAgent",(function(){return n.userAgent})),i.d(t,"ViewModes",(function(){return n.ViewModes})),i.d(t,"VIEW_EVENT_TYPES",(function(){return n.VIEW_EVENT_TYPES})),i.d(t,"FocusTargetsDef",(function(){return n.FocusTargetsDef}))},216:function(e,t,i){"use strict";i.r(t);var n=i(144),r=i(162),a=function(e){var t=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"{"+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()+"}"}();return t.substring(0,t.length-1)+"-"+e+"}"},o=["Kingsoft WPS 9.0 Format","Kingsoft Image Data","text/html","text/plain","Kingsoft Data Descriptor"],s=["Art::GVML ClipFormat","Kingsoft WPS 9.0 Format","Kingsoft Image Data","text/html","image/png","Kingsoft Data Descriptor"],l=function(){var e,t,i=window.officeType;return Object(r.isEtLike)(i)?(e=window.APP.getActiveSheetView().getShapeSelection(),t=[],e&&e.size>0?t.push("Art::GVML ClipFormat"):(t.push("text/plain"),t.push("text/html"),t.push("WPS Spreadsheets 6.0 Format")),{id:a(window.fileInfo.id),mimeTypes:t,from:"et"}):i===r.default.writer?function(){var e=void 0;return e=window.APP.data.selection.activeShapeId?s:o,{id:a(window.fileInfo.id),mimeTypes:e,from:"wps"}}():i===r.default.dbsheet?function(){var e=window.APP.getActiveSheetView().getShapeSelection(),t=[];return e&&e.size>0?t.push("Art::GVML ClipFormat"):t.push("text/plain"),{id:a(window.fileInfo.id),mimeTypes:t,from:"db"}}():i===r.default.presentation?function(){var e=window.APP.shell.doc.selection.getClipboardMimeTypes();return{id:a(window.fileInfo.id),mimeTypes:e,from:"webwpp"}}():i===r.default.outline?{id:a(window.fileInfo.id),mimeTypes:["text/html"],from:"outline"}:i===r.default.whiteboard?function(){var e=window.APP.presentation.selection.getClipboardMimeTypes();return{id:a(window.fileInfo.id),mimeTypes:e,from:"webwpp"}}():i===r.default.pdf?{id:a(window.fileInfo.id),mimeTypes:["text/plain"],from:"pdf"}:{}},h=i(156);var u=void 0,c=void 0;function d(){c=u={handler:null,next:null,rAF:void 0}}var p=function(e){if(e)for(var t=u;t!==c;t=t.next)e(t)};d();var f={trig:function(){p((function(e){cancelAnimationFrame(e.rAF),e.rAF=requestAnimationFrame(e.handler)}))},addEvent:function(e){for(var t=u;t!==c;){if(t.handler===e)return!0;t=t.next}return"function"==typeof e&&(u===c?(c={handler:null,next:null,rAF:void 0},u.next=c,void(u.handler=e)):(c.handler=e,c.next={handler:null,next:null,rAF:void 0},c=c.next,!0))},removeEvent:function(e){if(u.handler===e)return u=u.next,!0;for(var t=u,i=u.next;i!==c;i=i.next){if(i.handler===e)return t.next=i.next,!0;t=i}return!1},clear:function(){p((function(e){cancelAnimationFrame(e.rAF)})),d()}},g=i(222),y=i(303),v=null,m=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.chromeVS>=63||n.isFirefox||n.isIE||n.isPad||_(),e&&v&&v.expired?null:v},_=function(){var e=function(){var e=window.localStorage.getItem("ksDocClipBoardInfo"),t=null;if(e)try{t=JSON.parse(e)}catch(e){}return t}();if(!e!=!v||e){if(e&&v){var t=e.id,i=e.expired;if(t===v.id&&!i==!v.expired)return}f.trig(),v=e}},w=function(e){var t=e?JSON.stringify(e):"";window.localStorage.setItem("ksDocClipBoardInfo",t)},S=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!e&&t&&v&&"et"===v.from?(v.expired=!0,w(v)):(v=e,w(e))},x=Object(h.debounce)((function(){_()}),500),T=function(e){if(!e||e.expired||!e.mimeTypes)return"text/html";var t=window.officeType;return Object(r.isEtLike)(t)?k(e):t===r.default.writer?C(e):t===r.default.dbsheet||t===r.default.pdf?"text/plain":t===r.default.presentation?b(e):"text/html"},k=function(e){var t=e.mimeTypes;return t.indexOf("WPS Spreadsheets 6.0 Format")>=0?"WPS Spreadsheets 6.0 Format":t.indexOf("Et Internal Shape")>=0?"Et Internal Shape":t.indexOf("Art::GVML ClipFormat")>=0?"Art::GVML ClipFormat":t.indexOf("text/html")>=0?"text/html":t.indexOf("image/png")>=0?"image/png":"text/plain"},C=function(e){return e.mimeTypes},b=function(e){return e.mimeTypes},E=function(e,t){return!(!n.isIEPure||e||t)||!(e&&(!t||t.id===e.id))&&(console.debug("CopyPaste: resetCopyState: Clipboard info changed"),!0)},R=function(e){if(!e)return null;var t=e.clipboardData||window.clipboardData,i=void 0;if(t)try{var n=t.getData("text/ksDocClipBoardInfo");if(n)i=JSON.parse(n);else{var r=t.getData(g.default.html);i=y.a.parseClipboardInfoFromHtml(r)[g.default.ksDocClipBoardInfo]}}catch(e){}return i};t.default=(window.addEventListener("storage",x),{getCurrentClipBoardInfo:m,setCurrentClipBoardInfo:S,createClipboardInfo:l,getPriorityFormat:T,checkClipboardChange:E,getClipBoardInfo:R,addEvent:f.addEvent,removeEvent:f.removeEvent,clearKSEvent:f.clear,clear:function(){S(null,!1),f.trig()}})},223:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e,t){var i={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}},224:function(e,t,i){var n=i(11),r=i(5),a=i(17);e.exports=function(e,t){var i=(r.Object||{})[e]||Object[e],o={};o[e]=t(i),n(n.S+n.F*a((function(){i(1)})),"Object",o)}},2240:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(152),r=i.n(n),a=i(360);function o(e,t,i,n,o){o=0;var h=e.x(),u=e.y(),c=e.width(),d=e.width()/2,p=.5522847498*d,f=e.height(),g=e.height()/2,y=.5522847498*g,v=[new window.Point(h+c,u+g),new window.Point(h+c,u+g+y),new window.Point(h+d+p,u+f),new window.Point(h+d,u+f),new window.Point(h+d-p,u+f),new window.Point(h,u+g+y),new window.Point(h,u+g),new window.Point(h,u+g-y),new window.Point(h+d-p,u),new window.Point(h+d,u),new window.Point(h+d+p,u),new window.Point(h+c,u+g-y),new window.Point(h+c,u+g)];if(i>360?i=360:i<-360&&(i=-360),0===t){if(360===i){for(var m=11;m>=0;--m)n[o++]=v[m];return[v[12],o]}if(-360===i){for(var _=1;_<=12;++_)n[o++]=v[_];return[v[0],o]}}var w=parseInt(Math.floor(t/90),10),S=parseInt(Math.floor((t+i)/90),10),x=(t-90*w)/90,T=(t+i-90*S)/90,k=i>0?1:-1;k<0&&(x=1-x,T=1-T),Object(a.l)(x-1)&&(x=0,w+=k),Object(a.l)(T)&&(T=1,S-=k),x=s(90*x),T=s(90*T);var C=!Object(a.l)(x),b=!Object(a.l)(T-1),E=S+k;if(w===E){var R=3*(3-(w%4+4)%4);return[k>0?v[R+3]:v[R],o]}var P=new window.Point,I=new window.Point;!function(e,t,i,n,a){if(e.isNull())return;for(var o=e.width()/2,h=e.height()/2,u=[t,t+i],c=[n,a],d=window.Point,p=0;p<2;++p)if(c[p]){var f=(u[p]-360*Math.floor(u[p]/360))/90,g=parseInt(Math.floor(f),10);f=s(90*(f-=g)),1&g&&(f=1-f);var y=void 0,v=void 0,m=void 0,_=void 0,w=l(f,y,v,m,_),S=r()(w,4);y=S[0],v=S[1],m=S[2],_=S[3];var x=new window.Point(y+v+.5522847498*m,_+m+.5522847498*v);1!==g&&2!==g||x.setX(-x.x()),0!==g&&1!==g||x.setY(-x.y()),c[p].setFromPoint(d["+"](e.center(),new window.Point(o*x.x(),h*x.y())))}}(e,t,i,P,I);for(var L=window.QBezier,A=w;A!==E;A+=k){var B=3*(3-(A%4+4)%4),D=void 0;if(D=k>0?L.fromPoints(v[B+3],v[B+2],v[B+1],v[B]):L.fromPoints(v[B],v[B+1],v[B+2],v[B+3]),w===S&&Object(a.k)(x,T))return[P,o];A===w?A===S&&b?D=D.bezierOnInterval(x,T):C&&(D=D.bezierOnInterval(x,1)):A===S&&b&&(D=D.bezierOnInterval(0,T)),n[o++]=D.pt2(),n[o++]=D.pt3(),n[o++]=D.pt4()}return n[o-1]=I,[P,o]}function s(e){if(Object(a.l)(e))return 0;if(Object(a.k)(e,90))return 1;var t=Math.PI*e/180,i=Math.cos(t),n=Math.sin(t),r=e/90;r-=(((2-3*.5522847498)*r+3*-.4477152502)*r*r+1-i)/(((6-4.9705627482)*r+6*-.4477152502)*r);var o=r-=(((2-3*.5522847498)*r+3*-.4477152502)*r*r+1-i)/(((6-4.9705627482)*r+6*-.4477152502)*r);return o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-n)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498),.5*(r+(o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-n)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498)))}function l(e,t,i,n,r){var a=1-e;return r=(n=e*e)*e,[(i=a*a)*a,i*=3*e,n*=3*a,r]}},2266:function(e,t,i){"use strict";var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=function(){function e(){r()(this,e),window.APP.wppFontManager=this,this.fontList=new Set}return o()(e,[{key:"getFontList",value:function(){return this.fontList}},{key:"add",value:function(e){this.has(e)||this.fontList.add(e)}},{key:"delete",value:function(e){return this.fontList.delete(e)}},{key:"has",value:function(e){return this.fontList.has(e)}},{key:"clear",value:function(){return this.fontList.clear()}}],[{key:"getInstance",value:function(){return window.APP.wppFontManager||new e}}]),e}();t.a=s},2267:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return d}));var n=i(147),r=i.n(n),a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=function(){function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;o()(this,e),this._props={list:t,func:i,timeout:n},this._promise=this._init().catch((function(e){console.warn("RunTasks: ",e)}))}return l()(e,[{key:"_init",value:function(){var e=this,t=0,i=Date.now(),n=this._props,a=n.list,o=n.func,s=n.timeout;return new Promise((function(n,l){if(Array.isArray(a)){var h=(u=r()(regeneratorRuntime.mark((function r(){var u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e._stop){r.next=4;break}l("task stop"),r.next=13;break;case 4:if(!(t<a.length)){r.next=12;break}return r.next=7,o(a[t],t);case 7:t++,u=s-Date.now()-i,setTimeout((function(){h(),i=Date.now()}),u<0?0:u),r.next=13;break;case 12:n(!0);case 13:case"end":return r.stop()}}),r,e)}))),function(){return u.apply(this,arguments)});setTimeout(h,s)}else l("list should be an array");var u}))}},{key:"then",value:function(e){e&&this._promise.then(e)}},{key:"stop",value:function(){this._stop=!0}}]),e}(),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split(""),c={};function d(e){var t=c[e]||"";if(t)return t;for(var i=53819,n=e.length-1;n>-1;n--)i+=(i<<5)+e.charCodeAt(n);var r=2147483647&i;do{t+=u[63&r],r>>=6}while(r);return c[e]=t,t}},2268:function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return h})),i.d(t,"a",(function(){return u})),i.d(t,"e",(function(){return c})),i.d(t,"d",(function(){return d}));var n=i(223),r=i.n(n),a=i(147),o=i.n(a),s=i(327),l=function(e){var t,i="/api/v3/office/file/"+window.urlFileId+"/transcode",n={tasks:[e]};return{types:s.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(i).send(n).end();case 2:return r=e.sent,e.abrupt("return",r.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}},h=function(e){var t,i="/api/v3/office/file/"+window.urlFileId+"/transcode/progress",n={tasks:[e]};return{types:s.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(i).send(n).end();case 2:return r=e.sent,e.abrupt("return",r.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}},u=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="/api/v3/office/file/"+window.urlFileId+"/shapes",a={ids:e};return i&&(a.type="transcode"),n&&(a.with_check=!0),{types:s.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(r).send(a).end();case 2:return i=e.sent,e.abrupt("return",i.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}},c=function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="/api/office/v2/file/"+window.urlFileId+"/media_object/wpp?wx_media_id="+e+"&connid="+window.RPCClient.clientID;return i&&(n+="&orientation&duration"),{types:s.default.HTTP_TYPES,autoErrorToast:!1,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(n).send().end();case 2:return i=e.sent,e.abrupt("return",i.body);case 4:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}},d=function(e){var t,i=e.file,n=e.onProgress,a=r()(e,["file","onProgress"]),l="/api/v3/office/file/"+window.urlFileId+"/media_object/wpp?connid="+window.RPCClient.clientID,h=new FormData;return h.append("object",i),{types:s.default.HTTP_TYPES,callAPI:(t=o()(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.onprogress=n,e.next=3,t.post(l,h).query(a).end();case 3:return i=e.sent,e.abrupt("return",i.body);case 5:case"end":return e.stop()}}),e,void 0)}))),function(e){return t.apply(this,arguments)})}}},2269:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCommonVar=t.coNames=void 0;var n=i(143),r=(0,n.__importDefault)(i(934)),a=(0,n.__importDefault)(i(1882));t.coNames=a.default,t.setCommonVar=function(e){return function(t){t({type:r.default.CO_GLOBAL_VAR,payload:e})}}},2270:function(e,t,i){"use strict";function n(){var e=window.getSelection(),t=e&&(e.focusNode||e.anchorNode);return!!(e&&e.isCollapsed||!t||t instanceof HTMLFormElement)}i.d(t,"a",(function(){return n}))},236:function(e,t,i){"use strict";i.r(t),i.d(t,"base64ToBlob",(function(){return f}));var n=i(44),r=i.n(n),a=i(43),o=i.n(a),s=i(150),l=i.n(s),h=i(26),u=i.n(h),c=i(216),d=i(222),p=i(144),f=function(e,t){for(var i=atob(e),n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);return new Blob([r],{type:t})};t.default={extractClipFileData:function(e){if(p.isPCWpsClient())return function(e){var t=null;for(var i in e)if(i.match&&i.match(/^image\//i)){t=i;break}if(t){var n=e.getData(t);return n?f(n,t):null}}(e);var t=e.items;if(!t||!t.length)return null;for(var i=0;i<t.length;i++){var n=t[i];if("file"===n.kind&&n.type.match(/^image\//i)){var r=n.getAsFile();if(r)return r}}return null},assembleClipData:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=n?{isShape:n}:{};return(e||""===e)&&(o[d.default.text]=e),p.isIEPure||(t&&(o[d.default.html]=t),r&&(o[d.default.image]=r),a&&(o[d.default.async]=!0),o[d.default.ksDocClipBoardInfo]=i||c.default.createClipboardInfo(),p.isInMiniProgram&&(o[d.default.timestamp]=Date.now())),o},getWrapClipData:function(e,t){return e?e.clipboardData||window.clipboardData:u()({},t,{getData:function(e){return t[e]}})},wrapE:function(e){if(!e)return e;if(p.isFirefox){var t,i=(t={},l()(t,d.default.text,e.clipboardData.getData(d.default.text)),l()(t,d.default.html,e.clipboardData.getData(d.default.html)),l()(t,d.default.files,e.clipboardData.getData(d.default.files)),l()(t,d.default.ksDocClipBoardInfo,e.clipboardData.getData(d.default.ksDocClipBoardInfo)),t),n=e.clipboardData;return{clipboardData:{types:[].concat(o()(n.types)),items:u()({},n.items,{length:n.items.length}),getData:function(e){return i[e]}}}}return e},wrapClientClipData:function(e,t,i){var n,r=p.isInMiniProgram&&e.updateExternal,a=t&&t.id;return(r||a&&(t.id!==e.id||t.expired))&&(c.default.clear(),i=!0,console.log("wps端剪贴板发送变化")),n={},l()(n,d.default.html,e.getData(d.default.html)),l()(n,d.default.text,e.getData(d.default.text)),l()(n,d.default.files,e.getData(d.default.files)),l()(n,"updateExternal",i),n},needExpiredClipInfo:function(e,t){return"object"===(void 0===e?"undefined":r()(e))&&!!(e&&t&&"et"===t.from&&t.id===e.id&&t.expired)},buildClipboardData:function(e){return new Promise((function(t,i){if(e[d.default.html]){var n=/<img[^src]*src="(blob:https:[^"]+)".*>/g.exec(e[d.default.html]);if(!n||n.length<2)t(e);else{var r=n[1];e[d.default.files]?(console.log("[xclipboard] build text: ",e[d.default.text]),console.log("[xclipboard] build html: ",e[d.default.html]),e[d.default.text]&&0===e[d.default.text].indexOf("blob:https:")&&(e[d.default.text]="",e[d.default.html]=""),t(e)):function(e){return new Promise((function(t,i){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var i=n.response,r=new window.File([i],i.type.replace("/","."),{type:i.type});console.log("[xclipboard] "+e+" =>",r),t(r)},n.onerror=function(){t(null)},n.open("GET",e),n.send()}))}(r).then((function(i){i&&(e[d.default.html]=""),e[d.default.files]=i,t(e)}))}}else t(e)}))},buildSysClipboardData:function(e,t){Object.keys(e).forEach((function(i){t[i]=e[i]}));var i=t[d.default.ksDocClipBoardInfo];i||(i=c.default.createClipboardInfo(),t[d.default.ksDocClipBoardInfo]=i),c.default.setCurrentClipBoardInfo(i)}}},237:function(e,t,i){"use strict";i.r(t);var n=i(146),r=i(335),a=i(158),o=n.default.cooper,s=n.default.names,l=n.default.dispatchEvent,h=Math.round(100*Math.random());function u(e){return e+ ++h}var c={DOC_SELECTION_CHANGED:"wpp.selectionChanged",DOC_READONLY_SELECTION_CHANGED:"wpp.readonly.selectionChanged",DOC_COOPERATION_MODE_TOGGLED:"wpp.update.coopinfo",DOC_COOPINFO_UPDATED:"wpp.coopinfo.updated",DOC_SCROLL_INTO_VIEW:"wpp.scroll.into.view",DOC_SHOW_FIND_PANEL:"wpp.show.find.panel",DOC_SHOW_REPLACE_PANEL:"wpp.show.replace.panel",DOC_FIND_RESULT:"wpp.find.result",DOC_REPLACE_RESULT:"wpp.replace.result",DOC_WORKSPACE_SCROLL:"wpp.workspace.scroll",WPP_SHOW_CONTEXT_MENU:"wpp.show.context.menu",WPP_SHOW_READONLY_CONTEXT_MENU:"wpp.show.readonly.context.menu",WPP_CLOSE_CONTEXT_MENU:"wpp.close.context.menu",WPP_SHOW_CONTEXT_MENU_IN_WRAP:"wpp.show.context.menu.in.wrap",CLIPBOARD_COPY:"CLIPBOARD_COPY",CLOSE_DROPDOWN_PANEL:"CLOSE_DROPDOWN_PANEL",ON_OPEN_IMAGE_VIEWER:"wpp.slide.openImageViewer",ON_IMAGE_VIEWER_MSG:"wpp.slide.ImageViewerMsg",ON_IMAGE_VIEWER_DID_MOUNT:"on_image_viewer_did_mount",REQ_OPEN_INK_EDITOR:"wpp.open.ink.editor",ON_OPEN_INK_EDITOR:"wpp.ink.editor.open",ON_CLOSE_INK_EDITOR:"wpp.ink.editor.close",ON_UPDATE_INK_EDITOR:"wpp.update.ink.editor",ON_SHOW_INK_STYLEPANEL:"wpp.show.ink.stylepanel",ON_HIDE_INK_STYLEPANEL:"wpp.hide.ink.stylepanel",ON_TOGGLE_INK_VISIBLE:"wpp.toggle.ink.visible",ON_TOGGLE_INK_MODAL_VISIBLE:"wpp.ink.modal.visible",ON_SHOW_DEL_INK_MODAL:"wpp.ink.del.ink.modal",ON_CHANGE_MASTER_VIEW:"wpp.change.master.view",ON_COMMENT_CHANGE:"comment_notify",ON_SHOW_EDIT_PANEL:"on_show_edit_panel",SHOW_FUNCGUIDES_MOBILE_EDIT:"SHOW_FUNCGUIDES_MOBILE_EDIT",WPP_GUEST_CONFIRM_LOGIN:"WPP_GUEST_CONFIRM_LOGIN",ON_SLIDE_CHANGE:"wpp.slide.change",REQ_OPEN_LASERPEN:"wpp.toggle.laserpen",ON_GET_MEDIA_PLAY_MSG:"on_get_media_play_msg",ON_VIDEO_FULLSCREEN:"on_video_fullscreen",ON_TOGGLE_REMARKS_VIEW:"on_toggle_remarks_view",ON_POST_REMARKS_DATA:"on_post_remarks_data",ON_GET_REMARKS_LASERPEN:"on_get_remarks_laserpen",NOTIFY_LASERPEN_UPDATE:u("n_u_"),NOTIFY_INK_BTN_PERMISION:u("n_u_"),DOC_INIT_DONE:u("n_u_"),NOTIFY_FULLSCREEN_ENTER:"wpp.play.enter.fullscreen",NOTIFY_FULLSCREEN_EXIT:"wpp.play.exit.fullscreen",ON_EDITVIEW_SCROLL_UPDATE:"on_editview_scroll_update",ON_EDITVIEW_SCROLL_UPDATE_BASE_PREV:"on_editview_scroll_update_base_prev",ON_SELECT_CONTACT:"on_select_contact",ON_COMMENT_FOCUS:"on_comment_focus",ON_COMMENT_BLUR:"on_comment_blur",ON_REPLY_FOCUS:"on_reply_focus",ON_COMMENT_ITEM_MOUSEENTER:"on_comment_item_mouseenter",ON_COMMENT_ITEM_MOUSElEAVE:"on_comment_item_mouseleave",ON_COMMENT_ITEM_DELETE:"on_comment_item_delete",ON_TOGGLE_EXPLAIN_VIEW:u("e_"),CHANGE_EXPLAIN_TYPE:u("e_"),EXPLAIN_ZAN_STATUS_CHANGE:u("e_"),EXIT_AUTOPALY_MODE:u("e_"),MEDIA_PLAY_UIL_LOADED:"media_play_uil_loaded",NOTIFY_ON_LAST_SLIDE:"NOTIFY_ON_LAST_SLIDE",ON_CONTROL_HIDE:"ON_CONTROL_HIDE",UIL_VIEW_DID_MOUNT:"uil_view_did_mount",ON_EXIT_IMAGE_VIEWER:"on_exit_image_viewer",ON_STOP_KEY_EVENT:"on_stop_key_event"},d={names:c,guideTips:f,mobile:{ON_WP_SLIDE_CHANGE:"ON_WP_SLIDE_CHANGE",ON_THUMB_SLIDE_CHANGE:"ON_THUMB_SLIDE_CHANGE",ON_THUMBNAIL_SCROLL:"ON_THUMBNAIL_SCROLL",ON_SWITCH_TO_PREVIEW:"ON_SWITCH_TO_PREVIEW",ON_SWITCH_TO_PLAY:"ON_SWITCH_TO_PLAY",PREVIEW_THUMBNAIL_UPDATE:"PREVIEW_THUMBNAIL_UPDATE",PREVIEW_ON_MEDIA_PLAY:"PREVIEW_ON_MEDIA_PLAY",EDITPAGE_REPLACE_IMAGE:"EDITPAGE_REPLACE_IMAGE",EDITPAGE_EDIT_QRCODE:"EDITPAGE_EDIT_QRCODE",EDITPAGE_KEEP_INPUT_FOCUS:"EDITPAGE_KEEP_INPUT_FOCUS",EDITPAGE_TOGGLE_TOOLTABS:"EDITPAGE_TOGGLE_TOOLTABS",EDITPAGE_LAYOUT_PREPARED:"EDITPAGE_LAYOUT_PREPARED",EDITPAGE_CLOSE_MENU:"EDITPAGE_CLOSE_MENU",EDITPAGE_SHOW_FULLPANEL:"EDITPAGE_SHOW_FULLPANEL",EDITPAGE_SCROLL_SVG_THUMBNAIL:"EDITPAGE_SCROLL_SVG_THUMBNAIL",EDITPAGE_CHANGE_SLIDE:"EDITPAGE_CHANGE_SLIDE",EDITPAGE_REFRESH_SVG_THUMBNAIL:"EDITPAGE_REFRESH_SVG_THUMBNAIL",EDITPAGE_BEEN_COVERED:"EDITPAGE_BEEN_COVERED",ON_MEIDA_CLICK:"ON_MEIDA_CLICK",ON_MEDIA_PLAY:"ON_MEDIA_PLAY",ON_MEDIA_DESTROY:"ON_MEDIA_DESTROY",ON_VIDEO_DESTROY:"ON_VIDEO_DESTROY",ON_PLAY_AUDIO_CLICK:"ON_PLAY_AUDIO_CLICK",ON_PLAY_VIDEO_CLICK:"ON_PLAY_VIDEO_CLICK",ON_MENU_MEDIA_CLICK:"ON_MENU_MEDIA_CLICK",ON_MORE_VISIBLE_CHANGE:"ON_MORE_VISIBLE_CHANGE",ON_SHOW_DIALOG:"ON_SHOW_DIALOG",ON_TOGGLE_REVIEW:"m_wpp_toggle_review",ON_TOGGLE_EDIT_MODE:"ON_TOGGLE_EDIT_MODE",ON_VOICE_COMMENT_PLAY:"ON_VOICE_COMMENT_PLAY",ON_HYPERLINK_CLICK:"ON_HYPERLINK_CLICK",ON_SHOW_HYPERLINK_PANEL:"ON_SHOW_HYPERLINK_PANEL",ON_TOUCH_SCALE:"ON_TOUCH_SCALE",ON_PLAY_AUTO_SWITCH_BANED:"ON_PLAY_AUTO_SWITCH_BANED",ON_MEDIA_AVAILABLE:"ON_MEDIA_AVAILABLE",ON_PLAY_END:"ON_PLAY_END"},pc:{ON_REMARK_VISIBLE_CHANGE:"ON_REMARK_VISIBLE_CHANGE",ON_THUMBNAIL_RESIZE:"ON_THUMBNAIL_RESIZE",ON_THUMBNAIL_SCROLL:"ON_THUMBNAIL_SCROLL",ON_START_PLAY:"ON_START_PLAY",ON_TEMPLATE_VISIBLE_CHANGE:"ON_TEMPLATE_VISIBLE_CHANGE",ON_INSERT_SLIDE:"ON_INSERT_SLIDE",ON_SET_ACTIVE_SLIDE:"ON_SET_ACTIVE_SLIDE",ON_PANEL_VISIBLE:"ON_PANEL_VISIBLE",ON_PREVIEW_START:"ON_PREVIEW_START",ON_PREVIEW_STOP:"ON_PREVIEW_STOP",ON_EDITVIEW_RESIZE_ZOOM:"ON_EDITVIEW_RESIZE_ZOOM",ON_SET_SLIDEBAR_TAB:"ON_SET_SLIDEBAR_TAB",ON_DOWNLOAD_PICTURE:"ON_DOWNLOAD_PICTURE",ON_DOWNLOAD_ACTIVE_PICTURE:"ON_DOWNLOAD_ACTIVE_PICTURE",ON_TASKPANE_VISIBLE:"ON_TASKPANE_VISIBLE",ON_MATERIAL_VISIBLE:"ON_MATERIAL_VISIBLE",ON_REMARK_VIEW_UNSUPPORT:"ON_REMARK_VIEW_UNSUPPORT",OPEN_REMARK_VIEW_AUDIENCE:"open_remark_view_audience",ON_WPP_IMAGE_CLIP:"ON_WPP_IMAGE_CLIP",ON_CLIP_START:"ON_CLIP_START",ON_CLIP_END:"ON_CLIP_END",TEXTTOOL_DROPDOWN_MENU:"texttool_dropdown_menu",ON_EDITVIEW_SCROLL:"on_editview_scroll",ON_RIGHT_TASKBAR_TOGGLED:"ON_RIGHT_TASKBAR_TOGGLED",CLOSE_TASK_PANEL:"close_task_panel",ON_CANVAS_RESIZE:"ON_CANVAS_RESIZE",ON_EDITVIEW_SCROLL_X:"on_editview_scroll_x",ON_EDITVIEW_SCROLL_Y:"on_editview_scroll_y",UPDATE_EDITVIEW_SCROLL:"update_editview_scroll",ON_INSERT_COMMENT:"on_insert_comment",ON_CLOSE_MATERIAPANEL:"on_close_materiapaner",ON_EDIT_QRCODE:"on_edit_qrcode",picture:{ON_PICTURE_INSERT:u("p_i_"),ON_PICTURE_LOADING:u("p_i_"),ON_DOC_PICTURE_INSERT:u("p_i_"),ON_PICTURE_REPLACE:u("p_i_"),ON_PICTURE_FILE_UPLOAD:u("p_i_")},link:{ON_LINK_INSERT:u("p_l_"),UPDATE_FLOAT_LINK:u("p_l_"),OPEN_LINK_TO_SLIDE:u("p_l_"),OPEN_COPY_LINK_MODAL:u("p_l_"),ON_OPEN_LINK:u("p_l_"),ON_LINK_INSERT_CLOSE:u("p_l_")},play:{CLICK_EXIT_FULLSCREEN:u("p_v_"),CLICK_LANCH_FULLSCREEN:u("p_v_"),CLICK_END_PLAY:u("p_v_"),CLICK_SHOW_PAGE:u("p_v_"),CLICK_AUTO_PLAY_MODE:u("p_v_"),CLICK_START_AUTO_PLAY:u("p_v_"),CLICK_STOP_AUTO_PLAY:u("p_v_"),CLICK_SHOW_MORE:u("p_v_"),CLICK_SHOW_MINI_THUMBNAIL:u("p_v_"),CLICK_CLOSE_MINI_THUMBNAIL:u("p_v_"),CLICK_SHOW_TOOLBAR:u("p_v_"),CLICK_OPEN_INK_EDITOR:c.ON_OPEN_INK_EDITOR,CLICK_TOGGLE_INK_VISIBLE:c.ON_TOGGLE_INK_VISIBLE,CLICK_CONTAINER_DIV:u("p_v_"),CLICK_SHOW_SET_COUNTDOWN:u("p_v_"),CLICK_CLOSE_SET_COUNTDOWN:u("p_v_"),CLICK_SHOW_TIME_COUNT:u("p_v_"),START_RESIZE_REMARKS_AREA:u("p_v_"),ON_RESIZE_REMARKS_AREA:u("p_v_"),STOP_TOOLBAR_MOUSE_MOVE_EVENT:u("p_v_"),CLICK_RESIZE_FULLSCREEN:u("p_v_")},readonly:{PEVIEW_ORIGIN_PICTURE:"PEVIEW_ORIGIN_PICTURE"},media:{ON_MEDIA_INSERT:u("p_m_")},ON_FULLSCREEN_CHANGE:"onFullscreenChange",master:{ON_MASTER_SLIDE_SELECT_CHANGE:"on_master_slide_select_change"},CLICK_PROPSNAV_CHANGE:u("c_b_"),CLICK_PROPSNAV_CLOSE:u("c_b_"),MOVING_SHAPE_BOX:"moving_shape_box",ON_FORMAT_BRUSH_CHANGE:"on_format_brush_change",ON_FORMAT_BRUSH_CLICK:"on_format_brush_click",BEFORE_CHANGE_SELECT:"before_change_select",SET_MEDIA_TOOL_CONTAINER:"set_media_tool_container",MEDIA_TOOL_DID_MOUNT:"media_tool_did_mount",UPDATE_WATER_DROP_STATUS:"update_water_drop_status",RENDER_LAYOUT:"render_layout",UN_RENDER_LAYOUT:"un_render_layout",OPEN_LATEX_PANEL:"open_latex_panel",OPEN_CHART_EDIT_PANEL:"open_chart_edit_panel",CHART_EDIT_VISIBLE_CHANGE:"chart_edit_visible_change",ON_HOVER_PREVIEW_PANEL:"on_hover_preview_panel",UPDATE_FLOAT_MENU:"update_float_menu",ON_RESIZE_TOOLTIP_SHOW:u("r_t_"),ON_RESOZE_TOOLTIP_UPDATE:u("r_t_"),ON_RESIZE_TOOLTIP_TIMER:u("r_t_"),PAUSE_PLAY:"pause_play",START_PLAY:"start_play",ON_CANCEL_THUMB_HOVER:"ON_CANCEL_THUMB_HOVER",OPEN_PPT_FILE_SELECTOR:"open_ppt_file_selector",OPEN_SLIDE_SELECTOR:"open_slide_selector",CLOSE_SLIDE_SELECTOR:"close_slide_selector"}},p=new r.a;window.__uilDispatcher=p;var f={MasterViewGuideTips:"MasterViewGuideTips",Comment_QuickReply_tips:"Comment_QuickReply_tips",Clip_Guide_Tips:"Clip_Guide_Tips",RemarksViewGuideTips:"RemarksViewGuideTips",AnimGuideTips:"AnimGuideTips"},g={ON_DISCONNECTED:s.network.ON_DISCONNECTED,ON_CONNECT_ERROR:s.network.ON_CONNECT_ERROR,ON_CONNECTED:s.network.ON_CONNECTED,OFF_LINE:"offline",ON_LINE:"online"};t.default={names:c,thumbnailImg:{ON_IMG_NEW:"wpp.thumbnail.img.new",ON_IMG_IMPORT:"wpp.thumbnail.img.import",ON_IMG_HIDE:"wpp.thumbnail.img.hide",ON_IMG_SHOW:"wpp.thumbnail.img.show",ON_IMG_DELETE:"wpp.thumbnail.img.delete",ON_COOP_PANEL_SHOW:"thumbnail_coop_show_panel",ON_COOP_PANEL_CLOSE:"thumbnail_coop_close_panel"},thumbnailLine:{ON_LINE_NEW:"wpp.thumbnail.line.new"},slideStyles:{ON_SHOW_PANEL:"ON_SHOW_PANEL",ON_CLOSE_PANEL:"ON_CLOSE_PANEL"},eventTypes:d,dispatchEvent:l,dispatchKeyEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=document.createEvent("CustomEvent");r.initCustomEvent("key_event",i,n,{type:e,data:t}),window.dispatchEvent(r)},pubNames:s,uilDispatcher:p,hyperlinkType:d.pc.link,comment:{ON_COMMENT_TOGGLE:"wpp_toggle_comment",ON_COMMENT_INSERT:"wpp_insert_comment",ON_COMMENT_CLOSE:"wpp_comment_close",ON_COMMENT_SHOW:"wpp_comment_show",ON_COMMENT_PLAY:"wpp_comment_play"},OPENAPI_EVENT:a.OPENAPI_EVENT,guideTips:f,remarkEvent:{REQUEST_INFO:"remark_request_info",REQUEST_PICTURE_VIEWER_INFO:"request_picture_viewer_info",PLAY_INFO:"remark_play_info",LASER_INFO:"remark_laser_info",NORMAL_INFO:"remark_normal_info",BEFOREUNLOAD_INFO:"remark_beforeunload_info",AUDIENCE_FULL_SCREEN:"remark_audience_full_screen",AUDIENCE_END_PLAY:"remark_audience_end_play"},networkStatus:g,cooper:o}},261:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canRequestForAuthForSecurityDoc=t.requestForAuth=t.isPrintLimitedSecurityDoc=t.isCopyLimitedSecurityDoc=t.isEditLimitedSecurityDoc=t.isSupportSecurityDoc=t.AUTH_TYPES=void 0;var n=(0,i(143).__importDefault)(i(162)),r={EDIT:"edit",COPY:"copy",PRINT:"print",SAVE_AS:"saveAs"};t.AUTH_TYPES=r;var a={pluginType:window.__WPSPLUGIN__.helper.types.SecureDocApplyAuth};var o=[n.default.writer,n.default.spreadsheet,n.default.presentation].includes(window.officeType);t.isSupportSecurityDoc=o,t.isEditLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canEdit()},t.isCopyLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canCopy()},t.isPrintLimitedSecurityDoc=function(){return window.APP.isSecurityDoc()&&!window.APP.canPrint()},t.requestForAuth=function(e){return void 0===e&&(e={type:r.EDIT}),window.__WPSPLUGIN__.loader.loadSingleInstance(a).then((function(t){return t.show(e.type)}))};var s=o&&!!window.__WPSPLUGIN__.loader.search(a);t.canRequestForAuthForSecurityDoc=s},262:function(e,t,i){"use strict";i.r(t);var n={modify_types_start:0,insert_text:1,delete_text:2,modify_fmt:3,modify_slide:4,modify_layout:5,modify_master:6,modify_shape:7,modify_shapetree:8,modify_text_frame:9,modify_table_frame:10,modify_table_cell:11,modify_paragraph_attr:12,modify_chapter_attr:13,modify_notespage:14,modify_textframe_style:15,modify_shape_style:16,modify_master_text_style:17,modify_types_end:99,update_types_start:100,update_slides:101,update_types_end:109,edit_slide_start:110,modify_slide_container:111,edit_slide_end:119,animation_notify:120,animation_preview:121,modify_comment:122,modify_comment_container:123,modify_page_setup:124,error_readonly:220,collect_path:221,server_paste_start:222,server_paste_complete:223,server_doctemplate_start:224,server_doctemplate_end:225,server_chart_insert_start:226,server_chart_insert_end:227,server_pagesetup_start:226,server_pagesetup_end:227,server_documentbeautify_start:228,server_documentbeautify_end:229,operate_types_begin:999,op_modify:1e3,op_add:1001,op_remove:1002,op_move:1003,op_replace:1004,operate_types_end:1006,toString:function(e){var t=this._strs[e];return t||""},isModifyEvent:function(e){return e>this.modify_types_start&&e<this.modify_types_end}};!function(){var e={};for(var t in n){var i=n[t];"number"==typeof i&&(e[i]=t)}n._strs=e}(),Object.freeze(n),t.default=n},268:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s}));var n=i(44),r=i.n(n);function a(e,t){var i=void 0;if(null==e||"object"!==(void 0===e?"undefined":r()(e)))return e;if(e instanceof Date)return(i=new Date).setTime(e.getTime()),i;if(e instanceof Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array){i=[];for(var n=0,o=e.length;n<o;n++)i[n]=a(e[n],t);return i}if(e instanceof Function)return i=function(){return e.apply(this,arguments)};if(e instanceof Object){for(var s in i=t?new e.constructor:{},e)e.hasOwnProperty(s)&&(i[s]=a(e[s],t));return i}throw new Error("Unable to copy obj as type isn't supported "+e.constructor.name)}function o(e){return a(e,!1)}function s(e){return a(e,!0)}},270:function(e,t,i){e.exports={default:i(277),__esModule:!0}},271:function(e,t,i){e.exports={default:i(279),__esModule:!0}},2718:function(e,t,i){"use strict";var n=i(44),r=i.n(n),a=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-10;return"string"==typeof e||"string"==typeof t?e===t:Math.abs(e-t)<i};t.a={equals:function e(t,i,n){if(Object.isEmpty(t))return t===i;if((void 0===t?"undefined":r()(t))!==(void 0===i?"undefined":r()(i)))return!1;if(t instanceof Array){for(var o=0,s=t.length;o<s;o++){if(!e(t[o],i[o]))return!1}return!0}if("object"===(void 0===t?"undefined":r()(t))){for(var l in t){if(t.hasOwnProperty(l))if(!e(t[l],i[l]))return!1}return!0}return a(t,i,n)}}},2719:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=i(360),l=2*Math.PI,h=function(){function e(t,i){r()(this,e);var n=window.Point;if(!(t instanceof n&&i instanceof n))throw new Error(t+" or "+i+" is not instanceof Point");this._pt1=new window.Point(t.x(),t.y()),this._pt2=new window.Point(i.x(),i.y())}return o()(e,[{key:"clone",value:function(){return new e(this._pt1.clone(),this._pt2.clone())}},{key:"assign",value:function(e){return this._pt1=e._pt1.clone(),this._pt2=e._pt2.clone(),this}},{key:"p1",value:function(){return new window.Point(this._pt1.x(),this._pt1.y())}},{key:"p2",value:function(){return new window.Point(this._pt2.x(),this._pt2.y())}},{key:"isNull",value:function(){return Object(s.k)(this._pt1.x(),this._pt2.x())&&Object(s.k)(this._pt1.y(),this._pt2.y())}},{key:"setLength",value:function(e){var t=this.unitVector();this._pt2=new window.Point(this._pt1.x()+t.dx()*e,this._pt1.y()+t.dy()*e)}},{key:"length",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y();return Math.sqrt(e*e+t*t)}},{key:"angle",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y(),i=360*Math.atan2(-t,e)/l,n=i<0?i+360:i;return Object(s.k)(n,360)?0:n}},{key:"translate",value:function(e,t){var i=window.Point,n=new i(e,t);this._pt1=i["+"](this._pt1,n),this._pt2=i["+"](this._pt2,n)}},{key:"normalVector",value:function(){var t=window.Point;return new e(this.p1(),t["+"](this.p1(),new t(this.dy(),-this.dx())))}},{key:"intersect",value:function(t,i){var n=window.Point,r=n["-"](this._pt2,this._pt1),a=n["-"](t.p1(),t.p2()),o=n["-"](this._pt1,t.p1()),s=r.y()*a.x()-r.x()*a.y();if(0===s||!isFinite(s))return e.IntersectType.NoIntersection;var l=1/s,h=(a.y()*o.x()-a.x()*o.y())*l;if(i){var u=n["+"](this._pt1,n["*"](h,r));i.setX(u.x()),i.setY(u.y())}if(h<0||h>1)return e.IntersectType.UnboundedIntersection;var c=(r.x()*o.y()-r.y()*o.x())*l;return c<0||c>1?e.IntersectType.UnboundedIntersection:e.IntersectType.BoundedIntersection}},{key:"angleTo",value:function(t){if(!(t instanceof e))throw new Error(t+" is not instance of Line");if(this.isNull()||t.isNull())return 0;var i=this.angle(),n=t.angle()-i,r=n<0?n+360:n;return Object(s.k)(n,360)?0:r}},{key:"unitVector",value:function(){var t=this._pt2.x()-this._pt1.x(),i=this._pt2.y()-this._pt1.y(),n=Math.sqrt(t*t+i*i);return new e(this.p1(),new window.Point(this._pt1.x()+t/n,this._pt1.y()+i/n))}},{key:"dx",value:function(){return this._pt2.x()-this._pt1.x()}},{key:"dy",value:function(){return this._pt2.y()-this._pt1.y()}},{key:"setP1",value:function(e){this._pt1=e}},{key:"setP2",value:function(e){this._pt2=e}},{key:"setPoints",value:function(e,t){return this._pt1=e,this._pt2=t,this}},{key:"setLine",value:function(e,t,i,n){this._pt1=new window.Point(e,t),this._pt2=new window.Point(i,n)}},{key:"setNewLine",value:function(t){if(!(t instanceof e))throw new Error(t+" is no instanceof Line");this.setLine(t.p1().x(),t.p1().y(),t.p2().x(),t.p2().y())}},{key:"pointAt",value:function(e){var t=this._pt2.x()-this._pt1.x(),i=this._pt2.y()-this._pt1.y();return new window.Point(this.pt1.x()+t*e,this.pt1.y()+i*e)}},{key:"toLine",value:function(){return new e(this._pt1.toPoint(),this._pt2.toPoint())}},{key:"isQLine",get:function(){return!0}}]),e}();h.IntersectType={NoIntersection:0,BoundedIntersection:1,UnboundedIntersection:2},window.Line=h},2722:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return g}));var n,r,a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=(n=document.createElement("canvas").getContext("2d"),r=n.backingStorePixelRatio||n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||1,(window.devicePixelRatio||1)/r),u=[];window.canvasPool||(window.canvasPool=u);var c={WEBGL:"webgl",CANVAS:"canvas"},d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.TYPE.CANVAS,r=arguments[3];o()(this,e),this._status=e.STATUS.IDLE,this._type=n,r&&(this._label=r),this._createElement(),this._resize(t,i),this.use()}return l()(e,[{key:"_createElement",value:function(){this._elem||(this._elem=document.createElement("canvas"),this._elem._canvasPoolItem=this)}},{key:"_resize",value:function(t,i){if(t=t<1?1:t,i=i<1?1:i,this.width===t&&this.height===i||(this.width=t<1?1:t,this.height=i<1?1:i,this._elem.style.width=t+"px",this._elem.style.height=i+"px",h>1?(this._elem.width=t*h,this._elem.height=i*h):(this._elem.width=t,this._elem.height=i)),this._type===e.TYPE.CANVAS&&h>1){var n=this.getContext();n&&n.setTransform(h,0,0,h,0,0)}}},{key:"getElem",value:function(){return this._elem}},{key:"getContext",value:function(t){return this._type===e.TYPE.CANVAS?this._elem.getContext("2d"):this._type===e.TYPE.WEBGL?(this._webglContext=this._webglContext||y(this._elem,t),this._webglContext):void 0}},{key:"use",value:function(){this._status=e.STATUS.BUSY}},{key:"release",value:function(){var t=this;if(u.length>20){var i=u.findIndex((function(e){return e===t}));-1!==i&&u.splice(i,1)}else{this.width=0,this._elem.width=0,delete this._label,this._status=e.STATUS.IDLE;try{this._elem.style.cssText=""}catch(e){console.error(e,"reset style fail!")}}}},{key:"isIdle",value:function(){return this._status===e.STATUS.IDLE}}]),e}();function p(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.CANVAS,n=arguments[3];u.length>100&&console.warn("canvasPool.length = "+u.length+", 请检查是否有可release的canvasPoolItem！",u);var r=new d(e,t,i,n);return u.push(r),r}function f(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.CANVAS,n=arguments[3],r=void 0,a=0;a<u.length;a++){var o=u[a];if(o._type===i&&o.isIdle()){(r=o)._resize(e,t),r._label=n,r.use();break}}return r||(r=p(e,t,i,n)),r}function g(e){for(var t=0;t<u.length;t++){var i=u[t];i._label===e&&i.release()}}d.STATUS={IDLE:0,BUSY:1},d.TYPE=c;var y=function(e,t){for(var i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null,r=0;r<i.length;++r){try{n=e.getContext(i[r],t)}catch(e){console.error(e)}if(n)break}return n}},2723:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=i(237).default.eventTypes.pc},2724:function(e,t,i){"use strict";function n(e,t){var i=window.Toast.warn;switch(e){case"NOERROR":t();break;case"ONE_SHAPE":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastOneShape", "请选择多个对象进行组合"));break;case"HAS_GROUPED":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastHasGroup", "所选对象已组合"));break;case"TABLE":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.table", "表格")+_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastDisableGroup", "不支持组合"));break;case"SMART_ART":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.smartArt", "smartArt")+_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastDisableGroup", "不支持组合"));break;case"PLACEHOLDER":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.placeHolder", "占位符")+_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastDisableGroup", "不支持组合"));break;case"OLE_CONTROL":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.ole", "Ole对象")+_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastDisableGroup", "不支持组合"));break;case"HAS_TAGS":i(_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.tags", "关系图对象")+_i18n("applications.presentation.uil.components.FloatingMenu.ShapeGroup.toastDisableGroup", "不支持组合"));break;default:console.error("Cannot Group! INVALID_SHAPES")}}i.d(t,"a",(function(){return n}))},2725:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.audioMap=new Map}return e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.play=function(e){var t=e.slideId,i=e.shapeId,n=e.cellIndex,r=e.gcpRange,a=e.mediaId,o=e.sha1,s=e.isLoopSound,l=e.isAnimationSound;if(window.mediaManager.isServerClose&&window.Toast.error(_i18n("applications.presentation.helpers.tools.audioPlayer.soundUnavailable", "声音播放暂不可用")),a){var h=window.mediaManager.getMediaDataSync(a);if(h){if(!h.err)if(window.mediaManager.isOverdue(h.expires))window.mediaManager.updateMediaUrl({mediaId:a});else{var u=function(e){var t=e.slideId,i=e.shapeId,n=e.cellIndex,r=e.gcpRange,a=e.mediaId;if(e.isAnimationSound)return"isAnimationSound";var o="";return t&&(o+="_".concat(t)),i&&(o+="_".concat(i)),n&&(o+="_".concat(n)),r&&(o+="_".concat(r[0],"_").concat(r[1])),a&&(o+="_".concat(a)),o}({slideId:t,shapeId:i,cellIndex:n,gcpRange:r,mediaId:a,isAnimationSound:l}),c=this.audioMap.get(u);c||(c=new Audio,this.audioMap.set(u,c)),this._play(c,h,s)}}else window.mediaManager.getMediaData({mediaId:a,data:{type:"audio",sha1:o}},(function(){console.log("data",h)}))}},e.prototype._play=function(e,t,i){var n=t.url;if(e&&n){if(e.src===n)return e.loop=!!i,e.currentTime=0,void e.play();this._stopAudio(e),e.loop=!!i,e.src=n,e.load(),e.play()}},e.prototype._stopAudio=function(e){e&&!e.paused&&(e.pause(),e.loop=!1)},e.prototype.stop=function(){var e=this;this.audioMap.forEach((function(t){return e._stopAudio(t)}))},e}();t.default=n},277:function(e,t,i){i(278),e.exports=i(5).Object.getPrototypeOf},278:function(e,t,i){var n=i(20),r=i(63);i(224)("getPrototypeOf",(function(){return function(e){return r(n(e))}}))},279:function(e,t,i){i(280);var n=i(5).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},280:function(e,t,i){var n=i(13),r=i(46).f;i(224)("getOwnPropertyDescriptor",(function(){return function(e,t){return r(n(e),t)}}))},281:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WoMimeTypes=void 0,function(e){e.text="text/plain",e.html="text/html",e.ksDocClipBoardInfo="text/ksDocClipBoardInfo",e.image="image/png",e.mimeTypes="mimeTypes"}(t.WoMimeTypes||(t.WoMimeTypes={}))},311:function(e,t,i){"use strict";i.r(t),i.d(t,"VIEW_EVENT_TYPES",(function(){return f.a})),i.d(t,"WPPCustomEvent",(function(){return g.default})),i.d(t,"PubComponent",(function(){return E}));var n=i(43),r=i.n(n),a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=i(25),u=i.n(h),c=i(42),d=i.n(c),p=i(142),f=i(810),g=i(237),y={requestFullscreen:"requestFullscreen",onFullScreenEntered:"onFullscreenEntered",exitFullscreen:"exitFullscreen",onFullScreenExit:"onFullscreenExit",fullscreenchange:"fullscreenchange",init:function(){for(var e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],t=0;t<e.length;t++){var i=e[t];if(i&&i[1]in document){for(t=0;t<i.length;t++)y[e[0][t]]=i[t];break}}}},v=function(){function e(){var t=this;o()(this,e),this.handleMessage=function(e){var i=t.parseData(e),n=i.eventName,r=i.data;switch(n){case y.onFullScreenEntered:t.fullscreen=r.isFullscreen;var a=t._listeners[y.requestFullscreen];a&&a(r),console.log(y.onFullScreenEntered,r);break;case y.onFullScreenExit:t.fullscreen=r.isFullscreen,(a=t._listeners[y.exitFullscreen])&&a(r),console.log(y.onFullScreenExit,r);break;case y.fullscreenchange:t._onFullscreenChange&&t._onFullscreenChange({e:e,isFullscreen:t.isFullscreen,userClick:t.userClick}),t.userClick=!1,console.log(y.fullscreenchange,{isFullscreen:t.isFullscreen,userClick:t.userClick})}},this._listeners={},this._init()}return l()(e,[{key:"_init",value:function(){var e=this;y.init(),window.addEventListener("message",this.handleMessage),window.addEventListener(y.fullscreenchange,(function(t){e.onChange&&e.onChange({e:t,isFullscreen:e.isFullscreen,userClick:e.userClick}),e.userClick=!1}))}},{key:"parseData",value:function(e){if(!e||!e.data)return{};try{return JSON.parse(e.data)}catch(e){return{}}}},{key:"fsPostMessage",value:function(e,t){window.parentPostMessage({eventName:e}),console.log("fullscreen postMessage:",e),t&&(this._listeners[e]=t)}},{key:"request",value:function(e){var t=this;return new Promise((function(i,n){var r=void 0,a=function(e){t.hasParentIfr?(t.fsPostMessage("requestFullscreen",(function(e){e.isFullscreen?i(e):(t.userClick=!1,n(e))})),setTimeout((function(){n(!1)}),1e3)):e||(t.userClick=!1,n(!1))};try{t.userClick=!0;var o=e||t.document.documentElement;(r=o&&o[y.requestFullscreen]())instanceof Promise&&r.then(i).catch((function(e){a()}))}catch(e){console.error("req full screen error",e),a(r)}}))}},{key:"exit",value:function(){var e=this;return new Promise((function(t,i){var n=void 0,r=function(n){e.hasParentIfr?(e.fsPostMessage("exitFullscreen",(function(n){n.isFullscreen?(e.userClick=!1,i(n)):t(n)})),setTimeout((function(){i(!1)}),1e3)):n||(e.userClick=!1,i(!1))};try{e.userClick=!0,(n=e.document[y.exitFullscreen]())instanceof Promise&&n.then(t).catch((function(e){r()}))}catch(e){console.log("exit full screen error"),r(n)}}))}},{key:"hasParentIfr",get:function(){return window._parent!==window}},{key:"isFullscreen",get:function(){return this.document[y.fullscreenElement]||this.document.mozFullScreen||this.fullscreen}},{key:"isEnabled",get:function(){var e=this.document.documentElement;return e&&e[y.requestFullscreen]}},{key:"document",get:function(){var e=window.document;return window._parent!==window&&(e=window._parent.document),e}},{key:"onChange",set:function(e){this._onFullscreenChange=e},get:function(){return this._onFullscreenChange}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}().getInstance();var m=i(208),_=i(1019),w=document.createElement("style",{type:"text/css"});document.head.appendChild(w);var S=!1,x=!1,T=!1,k={},C=-1!==window.location.search.indexOf("isRemarksWin"),b=!0,E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var i=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.checkCoreReady=function(e){!i.hasInitEvent&&S&&(i.onSafeBindEvent(),i.hasInitEvent=!0)},i.app=e.app||window.APP,i.uiEventTypes=g.default.eventTypes,i.eventTypes=g.default,i.viewEventTypes=f.a,i._evtMap=[],i.isRemarksWin=C,i.uiStoreKey=_.a,P(i),i}return d()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this;this.checkCoreReady(),!this.hasInitEvent&&this.on("CORE_READY_NOTIFY",this.checkCoreReady),v.onChange||(v.onChange=function(t){return e.fire(e.uiEventTypes.pc.ON_FULLSCREEN_CHANGE,t)}),this.handleOnline&&this.on(R.ON_LINE,this.handleOnline),this.handleOffline&&this.on(R.OFF_LINE,this.handleOffline)}},{key:"componentDidUpdate",value:function(){this.checkCoreReady()}},{key:"componentWillUnmount",value:function(){var e=this;this.hasInitEvent&&this.onUnBindEvent(),this.setState=function(){},this.forceUpdate=function(){},this.isUnmount=!0,this._evtMap.forEach((function(t){e.off.apply(e,r()(t))}))}},{key:"onSafeBindEvent",value:function(){}},{key:"onUnBindEvent",value:function(){}},{key:"render",value:function(){return null}},{key:"appendStyle",value:function(e){w.innerHTML+=e}},{key:"on",value:function(){for(var e,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];(e=g.default.uilDispatcher).on.apply(e,i),this._evtMap.push(i)}},{key:"off",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n;0!==arguments.length&&(n=g.default.uilDispatcher).off.apply(n,t)}},{key:"fire",value:function(){var e;(e=g.default.uilDispatcher).fire.apply(e,arguments)}},{key:"dispatchEvent",value:function(){g.default.dispatchEvent.apply(g.default,arguments)}},{key:"requestFullscreen",value:function(e){return b?function(e){return v.request(e)}(e):new Promise((function(e,t){t(!1)}))}},{key:"exitFullscreen",value:function(){return v.exit()}},{key:"setKeyState",value:function(e,t){k[e]=t}},{key:"getKeyState",value:function(e){return k[e]}},{key:"stopBubble",value:function(e){e&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.nativeEvent&&e.nativeEvent.stopImmediatePropagation())}},{key:"checkInsertDataToken",value:function(){var e=this.selection.getActiveShapes(),t=e&&e[0];if(t){var i=this.doc.getActiveSlide().getShape(t.getId());return i&&t.getDataToken()===i.dataToken}return!0}},{key:"shell",get:function(){return this.app=this.app||this.props.app||window.APP,this.app&&this.app.shell}},{key:"editor",get:function(){return this.shell&&this.shell.editor}},{key:"doc",get:function(){return this.shell&&this.shell.doc}},{key:"coreView",get:function(){return this.shell&&this.shell.coreView}},{key:"selectionsMgr",get:function(){return this.workspace&&this.workspace.getSelectionsMgr()}},{key:"workspace",get:function(){return this.shell&&this.shell.app.workspace}},{key:"selection",get:function(){return this.workspace&&this.workspace.getSelection()}},{key:"presentation",get:function(){return this.workspace&&this.workspace.presentation}},{key:"inkVisible",get:function(){var e=this.selection.getActiveSlide();return!(e&&e.isHideAllInk)}},{key:"connected",get:function(){return this.app.session._isConnected&&navigator.onLine}},{key:"slideCount",get:function(){var e=this.presentation;if(this.isMasterView)return e.getMasters().getSlideCount()+e.getLayouts().getSlideCount();var t=e.getSlideCount(),i=e.slidesPreviewLimit();return i>0&&i<=t&&(t=i),t}},{key:"isMasterView",get:function(){return(this.state&&this.state.mode||this.doc&&this.doc.getMode())===m.ViewModes.MasterView}},{key:"slideMarker",get:function(){return this.selection.getSlideMarker()}},{key:"uilHotkeys",get:function(){return this.editor&&this.editor.uilHotkeys}},{key:"isNotChinese",get:function(){return"zh-CN"!==window.langName}},{key:"rightToLeft",get:function(){return window.rightToLeft}},{key:"isSupportFullScreen",get:function(){return!!v.isEnabled}},{key:"isFullscreen",get:function(){return v.isFullscreen}},{key:"enabledFullScreen",set:function(e){b=e},get:function(){return b}},{key:"isFromH5",set:function(e){x=e},get:function(){return x}},{key:"videoFullscreen",set:function(e){T=e},get:function(){return T}},{key:"activeSlideView",get:function(){return this.doc.getActiveSlide()}},{key:"activeSlideData",get:function(){return this.selection.getActiveSlide()}}],[{key:"coreReady",get:function(){return S},set:function(e){(S=e)&&g.default.uilDispatcher.fire("CORE_READY_NOTIFY")}}]),t}(p.Component),R=g.default.networkStatus;function P(e){}[R.ON_LINE,R.ON_CONNECTED].forEach((function(e){window.addEventListener(e,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.status=e,g.default.uilDispatcher.fire(R.ON_LINE,t)}))})),[R.OFF_LINE,R.ON_DISCONNECTED].forEach((function(e){window.addEventListener(e,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.status=e,g.default.uilDispatcher.fire(R.OFF_LINE,t)}))}))},315:function(e,t,i){"use strict";var n,r;t.a=(n=new Date-0,r=0,function(e){return e?e.toString(16):(n+r++).toString(16)})},3160:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="svg-shadow",r=function(){function e(e){this.svg=e,this.container=e&&e.parentElement,this.svg&&this.container||console.error("need container!")}return e.prototype.mount=function(){if(!this.getEle()){var e=document.createElement("div"),t=this.getStyle();e.setAttribute("class",n),e.setAttribute("style",t),this.container&&this.container.prepend(e),this.svgShadowRef=e}},e.prototype.unmount=function(){var e=this.getEle();e&&(e.remove(),this.svgShadowRef=null),this.svg=null,this.container=null},e.prototype.update=function(){var e=this.getEle();if(e){var t=this.getStyle(),i=e.style.transform||"";t+=i?";transform:".concat(i):"",e.setAttribute("class",n),e.setAttribute("style",t)}else this.mount()},e.prototype.setStyle=function(e,t){var i=this.getEle();i&&(i.style[e]=t)},e.prototype.getEle=function(){if(this.svgShadowRef){if(this.container&&this.container.contains(this.svgShadowRef))return this.svgShadowRef;this.svgShadowRef.remove()}return null},e.prototype.getStyle=function(){var e=this.svg||{},t=e.clientWidth,i=e.clientHeight,n={width:t,height:i,"margin-top":-i/2};return window.rightToLeft?n["margin-right"]=-t/2:n["margin-left"]=-t/2,Object.keys(n).reduce((function(e,t){return e+="".concat(t,": ").concat(n[t],"px;")}),"")},e}();t.default=r},335:function(e,t,i){"use strict";var n=i(43),r=i.n(n),a=i(0),o=i.n(a),s=i(3),l=i.n(s),h=function(){function e(){o()(this,e),this._listeners={}}return l()(e,[{key:"on",value:function(e,t){return e?this._on(e,{handler:t}):(console.trace("this evenName is empty",e),null)}},{key:"once",value:function(e,t){return e?this._on(e,{handler:t,once:!0}):(console.trace("this evenName is empty",e),null)}},{key:"off",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this._listeners[e];if(e)if(t){if(i){for(var n=0;n<i.length;n++)i[n].handler===t&&(i.splice(n,1),n--);0===i.length&&delete this._listeners[e]}}else delete this._listeners[e];else this._listeners={};return this}},{key:"fire",value:function(e){var t=this._listeners[e];if(t){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var a=t.length-1;a>=0;--a){var o=t[a];o?(o.handler&&o.handler.apply(o,n),t[a]&&t[a].once&&(t.splice(a,1),0===t.length&&delete this._listeners[e])):console.warn("fire handler is undefined")}}return this}},{key:"fireDirect",value:function(e){var t=this._listeners[e];if(t){for(var i=arguments.length,n=Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(var a=t.length-1;a>=0;--a){var o=t[a];o.handler.apply(o,n),o&&o.once&&(t.splice(a,1),0===t.length&&delete this._listeners[e])}}return this}},{key:"_on",value:function(e,t){return this._listeners[e]?(this._listeners[e].some((function(e){return e.handler===t.handler}))||this._listeners[e].push(t),this):(this._listeners[e]=[t],this)}},{key:"simpleOn",value:function(e,t){this._listeners[e]=[{handler:t}]}},{key:"fireAsync",value:function(e){var t=this,i=this._listeners[e];if(i){for(var n=arguments.length,a=Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];for(var s=function(n){var o=i[n];if(o.data=a,!o.runner){o.data=a;o.runner=requestAnimationFrame((function(){o.runner=null,o.handler&&o.handler.apply(o,r()(o.data)),i[n]&&i[n].once&&(i.splice(n,1),0===i.length&&delete t._listeners[e])}))}},l=i.length-1;l>=0;--l)s(l)}return this}},{key:"destroy",value:function(){this._listeners={}}}]),e}();t.a=h},348:function(e,t,i){"use strict";i.r(t),i.d(t,"copyToClipboard",(function(){return r}));function n(e,t){var i,n,r,a,o,s,l=!1;t||(t={}),i=t.debug||!1;try{if(r=function(){var e=document.getSelection();if(!e.rangeCount&&0!==e.rangeCount)return function(){};for(var t=document.activeElement,i=[],n=0;n<e.rangeCount;n++)i.push(e.getRangeAt(n));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||i.forEach((function(t){e.addRange(t)})),t&&t.focus()}}(),a=document.createRange(),o=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",document.body.appendChild(s),a.selectNode(s),o.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");l=!0}catch(r){i&&console.error("unable to copy using execCommand: ",r),i&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),l=!0}catch(r){i&&console.error("unable to copy using clipboardData: ",r),i&&console.error("falling back to prompt"),n=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(n,e)}}finally{o&&("function"==typeof o.removeRange?o.removeRange(a):o.removeAllRanges()),s&&document.body.removeChild(s),r()}return l}function r(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null;t&&(r=t.getContainer||null);var a=i||_i18n("applications.public.helpers.copy2clipboard.success", "复制成功");return n(e,t)?(window.Toast.success(a,r),!0):(window.Toast.error(_i18n("applications.public.helpers.copy2clipboard.fail", "复制失败"),r),!1)}},360:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s})),i.d(t,"d",(function(){return l})),i.d(t,"m",(function(){return h})),i.d(t,"k",(function(){return u})),i.d(t,"l",(function(){return c})),i.d(t,"i",(function(){return d})),i.d(t,"n",(function(){return p})),i.d(t,"o",(function(){return f})),i.d(t,"h",(function(){return g})),i.d(t,"j",(function(){return y})),i.d(t,"g",(function(){return v})),i.d(t,"p",(function(){return m})),i.d(t,"f",(function(){return _})),i.d(t,"e",(function(){return w}));var n=i(44),r=i.n(n),a=1e-6;function o(e,t,i){if(!e)throw new Error(t+" is Assert Because "+i+"!!")}function s(e){if(!e)throw new Error("there is a assert!!")}function l(e){return function e(t){if(!t||"object"!==(void 0===t?"undefined":r()(t)))return t;var i=new t.constructor;for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];i[n]="object"===(void 0===a?"undefined":r()(a))?e(a):a}return i}(e)}function h(e){return Object.isEmpty(e)}function u(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function c(e){return Math.abs(e)<=1e-12}function d(e,t,i){return p(e,f(i,t))}function p(e,t){return e>t?e:t}function f(e,t){return e<t?e:t}function g(e){return e>=0?e:-1*e}function y(e){return Math.ceil(e)}function v(e,t){return Math.min(t.m13()*e.left(),t.m13()*e.right())+Math.min(t.m23()*e.top(),t.m23()*e.bottom())+t.m33()<1e-6}var m=isFinite;function _(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")}function w(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.hasOwnProperty("width")&&e.hasOwnProperty("height")}},363:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.woObjectLogAop=t.woLogAOP=t.supportAOP=void 0;var n=i(143),r=(0,n.__importDefault)(i(454)),a="【WO_CLIPBOARD_DEBUG】";t.supportAOP=function(e,t){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(!t||!t.support())throw r.default.notSupport;try{return e.call.apply(e,(0,n.__spreadArray)([this],i,!1))}catch(t){o(e,i,t)}}};var o=function(e,t,i){if(window.isDebugger){if(i instanceof Promise)return console.log.apply(console,(0,n.__spreadArray)((0,n.__spreadArray)([a,"ASYNC FUNC_NAME: ".concat(e&&e.name?e.name:"anonymous")],t,!1),["return: ","pending"],!1)),void i.then((function(i){console.log.apply(console,(0,n.__spreadArray)((0,n.__spreadArray)([a,"ASYNC FUNC_NAME: ".concat(e&&e.name?e.name:"anonymous")],t,!1),["return: ",i],!1))})).catch((function(i){console.log.apply(console,(0,n.__spreadArray)((0,n.__spreadArray)([a,"ASYNC FUNC_NAME: ".concat(e&&e.name?e.name:"anonymous")],t,!1),["error:",i],!1))}));console.log.apply(console,(0,n.__spreadArray)((0,n.__spreadArray)([a,"FUNC_NAME: ".concat(e&&e.name?e.name:"anonymous")],t,!1),[i],!1))}};function s(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];try{var r=e.call.apply(e,(0,n.__spreadArray)([this],t,!1));return o(e,t,r),r}catch(i){o(e,t,i)}}}t.woLogAOP=s,t.woObjectLogAop=function(e){if(e instanceof Object){for(var t=0,i=Object.getOwnPropertyNames(e);t<i.length;t++){var n=i[t];e[n]&&e[n].constructor===Function&&(e[n]=s(e[n]))}return e}}},376:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLegalURL=t.openHyperlink=void 0;var n=i(143),r=(0,n.__importStar)(i(144)),a=(0,n.__importDefault)(i(162)),o=i(348);t.openHyperlink=function(e,t){if(!s(e))return window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "无法打开指定的链接")),!1;if(h(e))return r.isMobile?(window.open(e),!0):(window.Toast.error(_i18n("applications.public.helpers.openHyperlink.notOpen", "无法打开指定的链接")),!1);/^[a-z]*\:\/\/|^mailto\:/i.test(e)||(e="https://".concat(e));var i={okBtnText:_i18n("applications.public.helpers.openHyperlink.followLinkCopyLink", "复制链接"),text:_i18n("applications.public.helpers.openHyperlink.followLinkAlertText", "由于平台限制，请复制链接后使用浏览器打开"),cancelBtnText:_i18n("applications.public.helpers.openHyperlink.cancel", "好的"),onOk:function(){(0,o.copyToClipboard)(e),window.Toast.success(_i18n("applications.public.helpers.openHyperlink.followLinkCopySuccessTips", "复制链接成功")),t&&t.onOk&&t.onOk()},onCancel:function(){t&&t.onCancle&&t.onCancle()}};return r.isPCWxMiniProgram||r.isPad&&r.isPadMiniProgram||r.isMobile&&r.isInMiniProgram?u(e)?(window.open(e),!0):(window.Confirm(i),!1):(window.open(e),!0)};var s=function(e){var t=/^[`、|~,.?;:/<>'"{}\\\[\]\(\)!@#$%\^&\*\-_=\+·，。、￥？《》：；’‘“{}【】（）——！…]/;if(e.indexOf("javascript:")>-1)return!1;if(/^((https?|ftp)\:\/\/).+/i.test(e)){var i=e.replace(/^https?\:\/\//i,"").replace(/^ftp\:\/\//i,"").replace(/^mailto\:/i,"");if(t.test(i))return!1;return!/^[0-9]/.test(i)||l(i)}if(/^(mailto\:).+/i.test(e))return!0;if(h(e)){i=e.replace(/^tel:/i,"");return!t.test(i)}if(window.officeType===a.default.dbsheet){if(/^[a-z]*\:\/\/\S/i.test(e))return!0}return l(e)};t.isLegalURL=s;var l=function(e){return/^(((www\.)?[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*\.(com|edu|gov|int|mil|net|org|biz|info|pro|name|museum|coop|aero|xxx|idv|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|yr|za|zm|zw)|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)(\.((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d)){3})(:\d{1,5})?(?:(\/).*)?)$/i.test(e)},h=function(e){var t=new RegExp("^".concat("tel:\\s?").concat("((\\+86|86)\\s?)?1[3-9]\\d{9}","$")),i=new RegExp("^".concat("tel:\\s?").concat("((\\(0\\d{2,3}\\))|(0\\d{2,3}-?))?[1-9]\\d{6,7}","$"));return t.test(e)||i.test(e)},u=function(e){var t=/^https?:\/\/[^\/\?\#]+/i.exec(e.toLowerCase());if(!t)return!1;var i=t[0],n=window.location.origin.toLowerCase();if(i===n)return!0;return["https://www.kdocs.cn","https://web.wps.cn"].includes(n)&&["https://www.kdocs.cn","https://kdocs.cn","https://docs.wps.cn","https://web.wps.cn","https://f.wps.cn","https://todo.wps.cn"].includes(i)}},388:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return h})),i.d(t,"c",(function(){return u}));var n=i(144),r=i(249);i.d(t,"g",(function(){return r.isTwoFingerZoom}));var a={LEFT:0,MIDDLE:1,RIGHT:2},o={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,R:82,S:83,T:84,U:85,V:86,X:88,Y:89,Z:90,F3:114,BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,DELETER:46,LEFT_PARENTHESIS:219,RIGHT_PARENTHESIS:221,PERIOD:188,COMMA:190,LEFT:37,UP:38,RIGHT:39,DOWN:40,PAGEDOWN:34,PAGEUP:33,HOME:36,END:35,MINUS:189,ADD:187,EQUAL:61,CONNECT:173,ZERO:48,NUMBER_ADD:107,NUMBER_MINUS:109,NUMBER_ZERO:96,NUMBER_TWO:98,SHIFT:16,INCOMPOSITION:229,ALT:18};function s(e){return n.isWindows||n.isLinux?e.ctrlKey&&!e.altKey:!!n.isMacOs&&(e.metaKey&&!e.altKey)}function l(e){return n.isWindows||n.isLinux?e.ctrlKey&&e.altKey:!!n.isMacOs&&(e.metaKey&&e.altKey)}function h(e){return e.shiftKey}function u(e){var t=e.keyCode;return t===o.LEFT||t===o.RIGHT||t===o.DOWN||t===o.UP}var c=(n.isIos||n.isIPad)&&window._parent.visualViewport;c?window._parent.visualViewport.height:document.body.offsetHeight;window.isCtrlOrCmd=s,window.isCtrlOrCmdAndAlt=l},454:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={notSupport:new Error("WoClipBoard not supported"),invalid:new Error("woClipboard's copyId is invalid")}},4644:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=i(25),l=i.n(s),h=i(42),u=i.n(h),c=i(150),d=i.n(c),p=i(152),f=i.n(p),g=i(154),y=i.n(g),v=i(158),m=i(26),_=i.n(m),w=i(43),S=i.n(w),x=i(335),T=function(){function e(t){var i=t.slideId,n=t.slideIndex,a=t.shapeId,o=t.type,s=t.slidePGid,l=t.finished,h=t.canvas,u=t.thumbnailSrc;r()(this,e),this.slideId=i,this.shapeId=a,this.slideIndex=n,this.type=o,this.slidePGid=s,this.finished=l,this.canvas=h,this.thumbnailSrc=u}return o()(e,[{key:"setSlideIndex",value:function(e){this.slideIndex=e}}]),e}(),k=i(315),C=i(167);var b,E=(b=0,function(){return b++}),R=new(function(){function e(){r()(this,e),this.winPerformance=window.performance,this.isDebugger=window.isDebugger&&!!this.winPerformance}return o()(e,[{key:"mark",value:function(){var e;this.isDebugger&&(this.winPerformance.mark&&(e=this.winPerformance).mark.apply(e,arguments))}},{key:"measure",value:function(){var e;this.isDebugger&&(this.winPerformance.measure&&(e=this.winPerformance).measure.apply(e,arguments))}},{key:"timeStart",value:function(e){this.isDebugger&&this.mark(e+"_start")}},{key:"timeEnd",value:function(e){this.isDebugger&&(this.mark(e+"_end"),this.measure(e,e+"_start",e+"_end"))}}]),e}());R.isDebugger&&(window.WPPPerformance=R);var P=i(44),I=i.n(P);i(2062),i(2067),i(2073),i(2074),i(2075),i(2076),i(2077),i(2078),i(2079),i(2080),i(2081),i(2084),i(2085),i(2088),i(2089),i(2090),i(2092),i(2093),i(2094),i(2095),i(2096),i(2097),i(2098),i(2099),i(2101),i(2102),i(2103),i(2104),i(2106),i(2109),i(2110),i(2111),i(2112),i(2113),i(2114),i(2115),i(2116),i(2117),i(2118),i(2119),i(2120),i(2122),i(2123),i(2124),i(2125),i(2126),i(2128),i(2130),i(2132),i(2133),i(2134),i(2136),i(2137),i(2138),i(2139),i(2140),i(2141),i(2142),i(2143),i(2144),i(2145),i(1353),i(2146),i(2147),i(2149),i(2150),i(2151),i(2152),i(2153),i(2154),i(2156),i(2157),i(2158),i(2159),i(2160),i(2161),i(2162),i(2163),i(2164),i(2165),i(2166),i(2167),i(2168),i(2169),i(2170),i(2171),i(2172),i(2173),i(2175),i(2176),i(2177),i(2179),i(2180),i(2181),i(2182),i(2183);function L(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t&&t.private&&(t=t.private),t?(Object.keys(t).forEach((function(n){var r=t[n];if(null!=r){var a=e[n];if(r instanceof Object)if(r instanceof Array)i&&void 0!==a||(a||(a=[],e[n]=a),L(a,r,i));else{if(a){if("transform2D"===n&&(a.x<0||a.height<0))return}else a={},e[n]=a;L(a,r,i)}else i?void 0===a&&(e[n]=r):e instanceof Object&&(e[n]=r)}})),e):e}function A(e,t){if(t&&e)for(var i in t.private&&(e.private=t.private),t){var n=t[i];void 0!==n&&("transform2D"===i&&e[i]&&(e[i].x<0||e[i].height<0)||(n instanceof Array?(e[i]=[],A(e[i],n)):n instanceof Object?(e[i]={},A(e[i],n)):e[i]=n))}}function B(e){var t=e.x,i=e.y;void 0!==t&&void 0!==i&&(e.y=t,e.x=i)}function D(e){var t=e.width,i=e.height;void 0!==t&&void 0!==i&&(e.width=i,e.height=t)}function M(e){return function e(t){if(!t||"object"!==(void 0===t?"undefined":I()(t)))return t;var i=void 0;for(var n in i=t instanceof Array?new Array(t.length):{},t)if(t.hasOwnProperty(n)){var r=t[n];i[n]="object"===(void 0===r?"undefined":I()(r))?e(r):r}return i}(e)}var O,N,F=new(function(){function e(t){r()(this,e),t&&this.init(t)}return o()(e,[{key:"init",value:function(e){return e?(this.private=e,this):null}},{key:"getCharCount",value:function(){this.private.getCharCount()}},{key:"getCharAt",value:function(e){this.private.getCharAt(e)}},{key:"getText",value:function(e,t){var i=this.private,n=i.text.slice(0),r=window.APP.presentation.selection,a=r.getActiveTextStream();if(r.inComposition&&a&&a.objID===i.objID)for(var o=r.getCompositionState(),s=r.getCompositionText(),l=0,h=o.begin;l<s.length;++l,++h)n.splice(h,0,s[l]);return n.slice(e,e+t)}},{key:"getParaTbl",value:function(){return this.private.getParaTbl()}},{key:"getChpTbl",value:function(){return this.private.getChpTbl()}},{key:"getToken",value:function(){return this.private.data_token}},{key:"getTextBody",value:function(e){var t=this.private,i=t&&t.parent;if(i){var n=i.visual.getCompleteTextProps();if(n){var r={childs:[],style:{},autonumMgr:this.private.getAutonumMgr()},a=window.APP.presentation.selection,o=a.getActiveTextStream();if(a.inComposition&&o&&o.objID===t.objID){var s=a.getCompositionText();s&&(r.compositionLength=s.length)}for(var l=0;l<n.length;++l){var h=n[l],u=h.paraProps,c=h.chpProps,d=u.begin,p={childs:[],begin:d,ccp:u.end-d,style:u.props,selRange:e};r.childs.push(p);for(var f=0;f<c.length;++f){var g=c[f],y=g.begin,v=g.end,m=g.props,_={text:this.getText(y,v-y),style:m,begin:y,ccp:v-y};p.childs.push(_)}}return r}console.error("Empty text properties, please check the function of getCompleteTextProps")}else console.error("Empty textFrame !!")}}]),e}()),V=i(873),U=0,G=1,H=14,W=15,j=2,Y=3,z=4,K=5,q=6,X=7,J=8,Z=9,Q=10,$=11,ee=12,te=13,ie=16,ne=17,re=18;Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}[this.getDay()+""]),e=unescape(e.replace(/\/u/g,"%u"))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},Date.prototype.UsFormat=function(e){var t=this,i=function(e,t){t||(t=2),e=String(e);for(var i="",n=0;n<t-e.length;n++)i+="0";return i+e};return e.replace(/\b([dmyhHMstTlLZ]{1,4})?\b/g,(function(e){switch(e){case"d":return t.getDate();case"dd":return i(t.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][t.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()];case"M":return t.getMonth()+1;case"MM":return i(t.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()];case"yy":return String(t.getFullYear()).substr(2);case"yyyy":return t.getFullYear();case"h":return t.getHours()%12||12;case"hh":return i(t.getHours()%12||12);case"H":return t.getHours();case"HH":return i(t.getHours());case"m":return t.getMinutes();case"mm":return i(t.getMinutes());case"s":return t.getSeconds();case"ss":return i(t.getSeconds());case"l":return i(t.getMilliseconds(),3);case"L":var n=t.getMilliseconds();return n>99&&(n=Math.round(n/10)),i(n);case"tt":return t.getHours()<12?"am":"pm";case"TT":return t.getHours()<12?"AM":"PM";case"Z":return t.toUTCString().match(/[A-Z]+$/);default:return e.substr(1,e.length-2)}}))};var ae=(O={},d()(O,U,(function(){})),d()(O,G,(function(){return arguments[0]||"0"})),d()(O,H,(function(){var e=new Date,t=e.Format("h时mm分");return t=0===parseInt(e.getHours()/12)?"上午"+t:"下午"+t})),d()(O,W,(function(){var e=new Date,t=e.Format("h时mm分ss秒");return t=0===parseInt(e.getHours()/12)?"上午"+t:"下午"+t})),d()(O,j,(function(){return(new Date).Format("HH:mm:ss")})),d()(O,Y,(function(){return(new Date).Format("yyyy-MM-dd")})),d()(O,z,(function(){return(new Date).Format("yyyy年MM月dd日")})),d()(O,K,(function(){return(new Date).Format("yyyy年MM月dd日EEE")})),d()(O,q,(function(){return(new Date).Format("HH:mm")})),d()(O,X,(function(){return(new Date).Format("yyyy/MM/dd")})),d()(O,J,(function(){return(new Date).Format("yyyy年MM月")})),d()(O,Z,(function(){return(new Date).Format("yy.M.dd")})),d()(O,Q,(function(){return(new Date).Format("yyyy年MM月dd日 HH时mm分")})),d()(O,$,(function(){return(new Date).Format("yyyy年MM月dd日EEE HH时mm分ss秒")})),d()(O,ee,(function(){return(new Date).Format("HH:mm")})),d()(O,te,(function(){return(new Date).Format("HH:mm:ss")})),d()(O,ie,(function(){return(new Date).Format("yyyy-M-d")})),d()(O,ne,(function(){return arguments[0]})),d()(O,re,(function(){var e=arguments[0];return(e=e.slice(8)).replace(/\'/g,"")})),O),oe={"en-US":(N={},d()(N,U,(function(){})),d()(N,G,(function(){return arguments[0]||"0"})),d()(N,H,(function(){return(new Date).Format("M/dd/yyyy")})),d()(N,W,(function(){return(new Date).UsFormat("HH:mm:ss TT")})),d()(N,j,(function(){return(new Date).UsFormat("dd MMMM yyyy")})),d()(N,Y,(function(){return(new Date).Format("M/dd/yyyy")})),d()(N,z,(function(){return(new Date).UsFormat("dddd, MMMM dd, yyyy")})),d()(N,K,(function(){return(new Date).UsFormat("MMMM yyyy")})),d()(N,q,(function(){return(new Date).UsFormat("MMMM dd, yyyy")})),d()(N,X,(function(){return(new Date).UsFormat("dd-MMM-yy")})),d()(N,J,(function(){return(new Date).UsFormat("MMMM yy")})),d()(N,Z,(function(){return(new Date).UsFormat("MMM-yy")})),d()(N,Q,(function(){return(new Date).UsFormat("M/dd/yyyy h:mm TT")})),d()(N,$,(function(){return(new Date).UsFormat("M/dd/yyyy h:mm:ss TT")})),d()(N,ee,(function(){return(new Date).UsFormat("HH:mm")})),d()(N,te,(function(){return(new Date).UsFormat("HH:mm TT")})),d()(N,ie,(function(){return(new Date).Format("d-M-yyyy")})),d()(N,ne,(function(){return arguments[0]})),d()(N,re,(function(){var e=arguments[0];return(e=e.slice(8)).replace(/\'/g,"")})),N),"zh-CN":ae};function se(e,t){var i=oe[e];return i||(i=oe[t]),i}function le(){var e=arguments[0],t=arguments[1],i=Array.prototype.slice.call(arguments,2),n=se(e,"en-US");return n[t].apply(n,S()(i))}var he=i(809),ue={LineCapFlat:0,LineCapRound:1,LineCapSquare:2},ce=0,de=1,pe=2,fe=3,ge=4,ye=0,ve=1,me=2,_e={LineJoinTypeMiter:0,LineJoinTypeBevel:1,LineJoinTypeRound:2},we=11,Se=0,xe=1,Te=2,ke=3,Ce=4,be=5,Ee=0,Re=1,Pe=2,Ie=1,Le=2,Ae={width:9525,endingCap:ue.LineCapFlat,dashType:0,alignment:ye,compoundLine:ce,joinType:_e.LineJoinTypeRound,headEndType:Se,headEndWidth:Re,headEndLength:Ie,tailEndType:Se,tailEndWidth:Re,tailEndLength:Ie},Be=i(665),De=2,Me=function(){function e(){var t=this;r()(this,e),this.getShapesOutlineColor=function(e){var i=e.getId(),n=window.APP.shell.doc.getShapeInActiveSlide(i);if(n){if(n.isLocalShape()){var r=n.layout();if(e.isInk()){var a=r&&r.getExtendList();return a&&t.getInkOutlineColor(a.inkBody)}var o=r&&r.shapeProperty&&r.shapeProperty.outline;return t.getOutlineColor(o)}var s=e.visual.getOutline();return t.getOutlineColor(s)}},this._fillColorObj={},this._lineColorObj={},this._fontColorObj={},window.APP.wppColorManager=this}return o()(e,[{key:"addFillColor",value:function(e,t){this.__addColor(this.fillColor,e,t)}},{key:"addLineColor",value:function(e,t){this.__addColor(this.lineColor,e,t)}},{key:"addFontColor",value:function(e,t,i){this.__addColor(this.fontColor,e,t,!0,i)}},{key:"clearFontColor",value:function(e){this.__clearColor(this.fontColor,e)}},{key:"clearColor",value:function(e){this.__clearColor(this.fontColor,e),this.__clearColor(this.lineColor,e),this.__clearColor(this.fillColor,e)}},{key:"__addColor",value:function(e,t,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(t&&i){var r=t.toUpperCase();if(e[i.objID]){var a=e[i.objID].colorMap;if(a.has(r)){var o=a.get(r)+n;a.set(r,o)}else a.set(r,n)}else{var s=new Map;s.set(r,n),e[i.objID]={shape:i,colorMap:s}}}}},{key:"__clearColor",value:function(e,t){t&&t.objID&&delete e[t.objID]}},{key:"getAlreadyColors",value:function(e){var t=e.isFont,i=e.isBg,n=e.isBorder,r=e.limit,a=this.fillColor;i?a=this.fillColor:t?a=this.fontColor:n&&(a=this.lineColor);var o={};for(var s in a)if(a.hasOwnProperty(s)){var l=a[s],h=l.shape;this.isValidColor(h)?l.colorMap.forEach((function(e,t){o[t]?o[t]+=e:o[t]=e})):h.parent||delete a[s]}var u=Object.keys(o).sort((function(e,t){return o[t]-o[e]})).splice(0,r||20);return u||[]}},{key:"destroy",value:function(){this._fillColorObj={},this._lineColorObj={},this._fontColorObj={}}},{key:"isValidColor",value:function(e){if(e&&e.isShape){var t=e.parent,i=e.getSlide();if(t&&i&&i.parent)return!0}return!1}},{key:"getActiveColors",value:function(e){var t=e.isFont,i=e.isBg,n=e.isBorder,r=(e.limit,void 0),a=this.getLocalSelection().getActiveShapes();if(t){var o=window.APP.shell.editor.chapter.getColor();o&&(r=o)}else if(n){var s=this.getShapesOutline(a);s&&(r=s[0])}else if(i){if(1===this.getLocalSelection().state){var l=window.APP.shell.editor.fill.getFill();r=l&&l.hex}else{var h=this.getShapesFill(a);h&&(r=h[0])}}return r&&[r.toLocaleUpperCase()]}},{key:"getLocalSelection",value:function(){return window.APP.workspace.getSelectionsMgr().getLocalSelection()}},{key:"getBackgroundShapeView",value:function(){var e=window.APP.shell.doc.getActiveSlide(),t=e&&e.getCurSlide();return t&&t.backgroundShape}},{key:"getShapesFill",value:function(e){var t=this;if(!e||0===e.length)return null;var i=e.map((function(e){if(e.isGroupShape()){var i=e.getChilds();return t.getShapesFill(i)}if(!e.isBackgroundFillUsed())return t.getShapeFillColor(e)})),n=!1;return(i=i.flat()).length&&(n=i.every((function(e){return e===i[0]}))),n?i:[]}},{key:"getShapeFillColor",value:function(e){var t=e.getId(),i=window.APP.shell.doc.getShapeInActiveSlide(t);if(i){if(i.isLocalShape()){var n=i.layout(),r=n&&n.getShapeFill();return this.getFillColor(r)}var a=e.visual.getFill();return this.getFillColor(a)}}},{key:"getFillColor",value:function(e){return e&&e.type&&e.type===De?"#"+e.color.toRGB.slice(-6):null}},{key:"getShapesOutline",value:function(e){var t=this;if(!e||0===e.length)return null;var i=e.map((function(e){if(e.isGroupShape()){var i=e.getChilds();return t.getShapesOutline(i)}return t.getShapesOutlineColor(e)})),n=!1;return(i=i.flat()).length&&(n=i.every((function(e){return e===i[0]}))),n?i:[]}},{key:"getInkOutlineColor",value:function(e){var t=e.getTraceVec(),i=t&&t[0]&&t[0].getBrushRef(),n=i&&e.getBrushMap()[i],r=n&&n.getColor();return r?r.hex:null}},{key:"getOutlineColor",value:function(e){return e&&e.fill&&e.fill.type===De&&e.fill.color?"#"+e.fill.color.toRGB.slice(-6):null}},{key:"fillColor",get:function(){return this._fillColorObj}},{key:"lineColor",get:function(){return this._lineColorObj}},{key:"fontColor",get:function(){return this._fontColorObj}}],[{key:"getInstance",value:function(){return this._colorManager=this._colorManager||new e,this._colorManager}}]),e}(),Oe=i(2266),Ne=0,Fe=1,Ve=2,Ue=3,Ge=4,He=5,We=6,je=function(){function e(t,i,n,a){r()(this,e),this._shape=t,this.viewMode=i,this._currentSlideData=n||this.slide,this.colorManager=window.APP.wppColorManager||Me.getInstance(),this.fontManager=Oe.a.getInstance(),this.colorManager.clearColor(this._shape),this._colorDelegation=window.CoreUtils.getColorDelegation("fill",this._shape,this._currentSlideData),this._originShapeData=a||t,this._init()}return o()(e,[{key:"_init",value:function(){this._notesPage=window.ShapeUtil.getNotesPage(this._shape),this.slide=this._notesPage&&window.ShapeUtil.getNotesPage(this._shape)||window.ShapeUtil.getSlide(this._shape),this.presentation=this.slide&&this.slide.getPresentation(),this._layout=this._notesPage&&window.ShapeUtil.getNotesMaster(this._shape)||window.ShapeUtil.getLayout(this._shape),this.localSlt=this.presentation&&this.presentation.selection}},{key:"getNotesPage",value:function(){return this._notesPage}},{key:"showNotesBody",value:function(){return this.viewMode===C.ViewModes.NotesBody}},{key:"getBackgroundSize",value:function(){var e=this.presentation;return e?e.getSlideSize():null}},{key:"getLayout",value:function(){return this._layout}},{key:"getMaster",value:function(){var e=window.ShapeUtil;return this._master=e.getMaster(this._shape),this._master}},{key:"getSlideIndex",value:function(){var e=this.slide;return e&&e.parent?e.parent.getSlideIdx(e):0}},{key:"getSelection",value:function(){var e=this.localSlt.getActiveShapes();if(e&&e.includes(this._shape))return this.localSlt}},{key:"getSelRange",value:function(){var e=this.getSelection();return e&&e.getRange()||{begin:-1}}},{key:"getThemeAgent",value:function(){var e=this.slide;return e&&e.visual.getThemeAgent()}},{key:"getTransform2D",value:function(){return this._transform2D=this._transform2D||this._shape.visual.getRealTransform2D(),this._transform2D}},{key:"getParent",value:function(){return this._shape.getParent()}},{key:"getMachPhShape",value:function(){if(!this.matchShapeObj){var e=this._shape,t=e&&!e.hasTable()&&e.getPlaceHolder(),i={},n=this.getLayout();if(t&&n){var r=n.matchPhShapeCommon(e),a=this.getMaster();if(i.l_phShape=r,a){var o=a.matchPhShapeCommon(e);i.m_phShape=o}}this.matchShapeObj=i}return this.matchShapeObj}},{key:"getProperty",value:function(){if(this._spProperty)return this._spProperty;var e={},t=this._shape;if((e=t.visual.getAllProperties()).fill){if(t.visual.isBackgroundFillUsed()){var i=this._colorDelegation,n=t.visual.getBackgroundVisual();n&&(this._colorDelegation=n.getColorScheme(t.getSlide())),this._colorDelegation.setColorUsedFor("fill"),e.fill=this.getFillColorTransform(e.fill),this._colorDelegation=i}else this._colorDelegation.setColorUsedFor("fill"),e.fill=this.getFillColorTransform(e.fill);e.fill=this.mergeDefaultFill(e.fill)}var r=window.CoreUtils;if(e.outline&&e.outline.fill){var a=e.outline.fill.type;this._colorDelegation.setColorUsedFor("line"),e.outline=r.interpretOutline(e.outline,this._colorDelegation),a===We&&this._addGroupRectToFill(e.outline.fill),e.outline=L(M(Ae),e.outline)}if(e.effects&&(this._colorDelegation.setColorUsedFor("effects"),e.effects=r.interpretEffects(e.effects,this._colorDelegation)),e.shape3d){this._colorDelegation.setColorUsedFor("fill");var o=e.shape3d;o.contourColor&&(o.contourColor=this.getOverMapColor(o.contourColor)),o.extrusionColor&&(o.extrusionColor=this.getOverMapColor(o.extrusionColor))}if(e.inkData){this._colorDelegation.setColorUsedFor("fill");var s=e.inkData;if(s.brushMap){var l=s.brushMap;for(var h in l)if(l.hasOwnProperty(h)){var u=l[h];u.color&&(u.color=this.getOverMapColor(u.color),this.colorManager.addLineColor(u.color.hex,this._shape))}}}this._spProperty=e;var c=this.colorManager,d=e.fill&&e.fill.color;d&&c.addFillColor(d.hex,this._shape);var p=e.outline&&e.outline.fill&&e.outline.fill.color;return p&&c.addLineColor(p.hex,this._shape),e}},{key:"getGroupFill",value:function(e){if(!e||!e.isGroupShape())return null;for(;e.getFill()&&e.getFill().type===We;)e=e.getParent();return{groupFill:e.getFill(),groupRect:e.getRect(),groupAngel:e.getAngle()}}},{key:"_addGroupRectToFill",value:function(e){var t=this.getParent();if(!t||!t.isGroupShape())return e;for(;t.getFill()&&t.getFill().type===We;)t=t.getParent();var i=t.getRect(),n=t.getAngle();return i&&(e.rect=M(i),e.rect.groupAngel=n),e}},{key:"getFillColorTransform",value:function(e){if(e||(void 0===e?"undefined":I()(e))===Object){var t=e.type;return e=window.CoreUtils.interpretFill(e,this._colorDelegation),t===We&&this._addGroupRectToFill(e),e}console.warn("FillColor ERROR")}},{key:"getObjectValue",value:function(e,t,i){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"object"===(void 0===r?"undefined":I()(r))?this.getObjectValue(r,t,i):n===t&&i.push(r)}}},{key:"getStyle",value:function(){if(this._spStyle)return this._spStyle;var e=this._shape,t=this.getMachPhShape(),i=t.l_phShape,n=t.m_phShape,r={};n&&L(r,n.getStyle());i&&L(r,i.getStyle());return L(r,e.getStyle()),this.updateStyle(r),this._spStyle=r,r}},{key:"updateColor",value:function(e,t){var i=this;if(e[t]){var n=this.getOverMapColor(e[t+"Color"]);e[t+"Color"]=n;var r=e[t],a=r.color,o=r.stops,s=r.fill,l=r.outerShadow,h=e[t];if(s&&!a&&(a=s.color,h=s),l&&!a&&(a=l.color,h=l),a)16===a.scheme&&n&&(a.toRGB=n.toRGB,a.sRgb=n.sRgb,n.transOp&&(a.transOp=n.transOp)),h.color=this.getOverMapColor(a);o&&o.forEach((function(e){var t=e.color;t&&(16===t.scheme&&n&&(t.toRGB=n.toRGB,t.sRgb=n.sRgb,n.transOp&&(t.transOp=n.transOp)),e.color=i.getOverMapColor(t))}))}}},{key:"updateStyle",value:function(e){var t=this,i=this._shape,n=this.getThemeAgent();if(n){var r=e.lineIndex,a=e.fontIndex,o=e.effectsIndex,s=e.fillIndex;null!=r&&(e.line=L({},n.getFormatScheme().getLineAt(r))),null!=a&&(e.font=this.getOverMapColor({type:3,scheme:a})),null!=o&&(e.effects=L({},n.getFormatScheme().getEffectsAt(o))),null!=s&&(i.isBackground()?e.fill=L({},n.getFormatScheme().getBackgroundFillAt(s)):e.fill=L({},n.getFormatScheme().getFillAt(s)))}["line","fill","effects","font"].forEach((function(i){t._colorDelegation.setColorUsedFor(i),t.updateColor(e,i)}))}},{key:"isColorPlaceHolder",value:function(e){return e&&e.type&&e.type===Ve}},{key:"getTextFrame",value:function(e){if(e){var t=e.getPlaceHolder();if(t&&this._currentSlideData.isNormalSlide&&[C.PlaceholderType.Picture,C.PlaceholderType.ClipArt,C.PlaceholderType.Chart,C.PlaceholderType.Media,C.PlaceholderType.Table].includes(t.type)){var i=this.getMachPhShape().l_phShape;if(i)return i.getTextFrame()}for(var n=e.getChilds()||[],r=0;r<n.length;r++){var a=n[r];if(a.isTextFrame)return a}return null}}},{key:"getGeometry2D",value:function(){return this._shape.private.geometry2D?this._shape.private.geometry2D:null}},{key:"getTextBody",value:function(){if(this._spTextBody)return this._spTextBody;var e=this._shape,t=e.getPlaceHolder(),i=null,n=this.getSelRange(),r=this.getTextFrame(e),a=r&&F.init(r.getTextStream());if(!a)return null;if(i=a.getTextBody(n)){var o=t&&window.CoreUtils.PlaceHolderHelper.isTitleType(t.type),s=!1,l=!1,h=void 0,u=!1;if(i.style=i.style||{},t){var c=this.getMachPhShape(),d=c.l_phShape,p=c.m_phShape;if(d=d||p){if(p){var f=this.getTextFrame(p);f&&L(i.style,f.getProperty());var g=f&&f.getTextStream(),y=g&&g.getAllText();y instanceof Array&&(y=y.join("")),h=y&&y.split("\r")[0];var v=p.getPlaceHolder();u=v&&v.customPrompt}if(d!==p){var m=this.getTextFrame(d);m&&L(i.style,m.getProperty());var _=m&&m.getTextStream(),w=_&&_.getAllText();w instanceof Array&&(w=w.join("")),h=w&&w.split("\r")[0];var S=d.getPlaceHolder();u=S&&S.customPrompt}}}L(i.style,r.getProperty()),i.style.isTitle=o;var x=this.getSelection();if(1===i.childs.length){var T=i.childs[0].childs[0],k=T&&T.text||"";1===k.length&&"\r"===k[0]&&(s=!0,this.showNotesBody()?T.text=he.c.noteTitle:t&&(!x||x&&x.state!==C.SelectType.select_text)&&(u&&h?(T.text=h,l=!0):(h&&C.PhTextModifyRules.forEach((function(e){h=h.replace(e.src,e.dst)})),void 0!==t.type?(he.c[t.type]?l=!0:h&&C.PhTextModifyRules.forEach((function(e){h=h.replace(e.src,e.dst)})),T.text=he.c[t.type]||h||T.text):(T.text=he.c.other,l=!0),!this.slide.isNormalSlide&&T.text&&l&&t.type!==C.PlaceholderType.Footer&&(T.text=T.text.replace(he.c.add,he.c.editMaster),T.text=T.text+he.c.style))))}if(this.isPhTextEmpty=s,i.isEmpty=s,i.isDefText=l,i.isPlaceholder=!!t,i.dataPath={slideId:this.slide&&this.slide.getId(),shapeId:e.getId()},i.data_token=a.getToken(),x&&x.state===C.SelectType.select_text&&(i.hasTextSel=!0),t&&this._currentSlideData.isNormalSlide)[C.PlaceholderType.Picture,C.PlaceholderType.ClipArt,C.PlaceholderType.Chart,C.PlaceholderType.Media,C.PlaceholderType.Table].includes(t.type)&&(i.childs.length=1);this.updateTextBodyStyle(i)}return this._spTextBody=i,i}},{key:"getShapeTextStyle",value:function(e){var t=this.getTextFrame(e)||this._cellTextFrame;return t?t.visual.getTextStyle():null}},{key:"getDefaultStyle",value:function(){var e=this.presentation;if(e)return e.getDefaultTextStyle()}},{key:"getParaTextProps",value:function(e,t){var i=this.getTextFrame(e)||this._cellTextFrame;if(i)for(var n=i.visual.getCompleteTextProps(),r=0;r<n.length;++r){var a=n[r],o=a.begin,s=a.end,l=a.chpProps,h=a.paraProps;if(t>=o&&t<s){if(!h||!l)return;for(var u=0;u<l.length;++u)l[u]=l[u].props;return{paraProp:h.props,chpProp:l}}}return null}},{key:"getPapxProp",value:function(e,t,i){if(e&&t&&null!=i){var n=this.getTextFrame(e)||this._cellTextFrame;return n?n.visual.getPapxProp(t,i):null}}},{key:"getChpxProp",value:function(e,t,i){if(e&&t&&null!=i){var n=this.getTextFrame(e)||this._cellTextFrame;return n?n.visual.getChpxProp(t,i):null}}},{key:"getOutlineStyle",value:function(e,t){if(e){var i=e.chpStyles,n=e.paraStyles;if(i&&n)return{chpStyle:i[t],paraStyle:n[t]}}return{}}},{key:"_getAutoNum",value:function(e,t,i,n,r,a){var o=void 0;a&&r?(o=r["lvl"+i])||(o=r.def):o=n.at(e);return o||2!==t||(o={getStart:function(){return 1},getType:function(){return 3}}),o}},{key:"updateTextBodyStyle",value:function(e,t){var i=this._shape,n=i.getPlaceHolder(),r=this.getStyle().fontColor;r&&((t=t||{}).fontColor=t.fontColor||r);var a=void 0;this.showNotesBody()?(e.style.anchorType=he.b.anchorType,e.style.autoFit=he.b.autoFit):a=this.getShapeTextStyle(i);for(var o=e.autonumMgr,s=a&&a.listNumbers,l=[],h=function(e,t){return{index:e.getStart(),listType:0,listId:0,outline:t,autoNumType:e.getType(),autoNumStart:e.getStart()}},u=0,c=0;c<e.childs.length;c++){var d=e.childs[c],p=d.style,f=d.childs;this.showNotesBody()&&(p.lineSpacing=he.b.LineSpacing,p.alignMode=he.b.alignMode);var g={paraStyle:{},chpStyles:[]},y=this.getParaTextProps(i,d.begin);if(!y)return void console.error("textProp should not be null!");var v=y.paraProp,m=y.chpProp;if(g.chpStyles=m,g.paraStyle=v,d.style=g.paraStyle,d.style){var _=d.style,w=_.outline,S=_.listType,x=_.listId,T=_.bulletFont,k=_.bulletChar,C=_.bulletColor,b=_.ansizePercent;if(w?w<0?w=0:w>8&&(w=8):w=0,u>w)for(var E=w+1;E<=u;++E)l[E]=void 0;if(u=w,d.style.listType=d.style.listType||0,S<=0)d._splitPara||(l[w]=void 0);else{x=x||w;var R=l[w],P=void 0,I=void 0,L=void 0,A=this.getPapxProp(i,"autoNum",d.begin),B=A.value,D=A.bStyle,M=this._getAutoNum(B,S,w,o,s,D);if(M?R&&M.getType()===R.autoNumType&&M.getStart()===R.autoNumStart||(R=h(M,w),l[w]=R):(R=void 0,l[w]=R),M&&R&&(P=R.autoNumStart,I=R.autoNumType,L=R.index,R.index++,R.listId=x,R.listType=S,R.outline=w),C&&(this._colorDelegation.setColorUsedFor("font"),C=this.getOverMapColor(C.color)),this.showNotesBody()&&(b=100,C&&(C.rgba=he.b.FontColor)),d.autoNum={bulletChar:k,bulletFont:T,listType:S,listId:x,index:L,outline:w,autoNumStart:P,autoNumType:I,bulletColor:C,ansizePercent:b},d.style.autoNumType=I,R&&f.length<2){var O=f[0]&&f[0].text||[];O.length<2&&O[0]===String.fromCharCode(13)&&(R.index-=1)}}}this.updateParagraphChilds({childs:f,outlineStyle:g,placeholder:n,presetStyle:t})}}},{key:"updateParagraphChilds",value:function(e){var t=this,i=e.childs,n=e.outlineStyle,r=e.placeholder,a=e.presetStyle,o=n.chpStyles;if(i)for(var s=0;s<i.length;s++){var l=o[s]||{},h={};a&&this.getShapeTextStyle(this._shape)?(a&&A(h,a),l&&L(h,l)):(l&&L(h,l),a&&A(h,a));var u=i[s].style,c=u.textColor,d=L({},h);u=Object.assign(d,u),i[s].style=u;var p=u,f=p.language,g=p.fieldType,y=p.fieldRtfDateTimeExt,v=i[s].text;null!=g&&function(){if(Array.isArray(v)&&(v=v.join("")),G===g)if(t.slide.isLayoutSlide||t.slide.isMasterSlide)v="<#>";else{var e;e=t.getSlideIndex()+1,v=(v+"").replace("*",le(f,g,e))}else v=(v+"").replace("*",re===g?le(f,g,y):le(f,g));t.slide.fieldShapes=t.slide.fieldShapes||[];var n=t._shape.getId();!t.slide.fieldShapes.find((function(e){return e.id===n}))&&t.slide.fieldShapes.push({id:n,targetStyle:u,text:v}),i[s].text=v}();var m=[C.PlaceholderType.Footer,C.PlaceholderType.SlideNumber,C.PlaceholderType.DateTime];if(r&&m.includes(r.type)&&(this.isFieldPlaceholderShapes=!0),this.showNotesBody())u.fontSize=he.b.FontSize,u.color=he.b.FontColor,u.fontFamily=he.b.FontFamily;else{var _=L({},l&&l);u=Object.assign(_,u),i[s].style=u;var w=u,S=w.language,x=w.fontColor,T=w.textColor,k=w.altLanguage,b=w.fontNameComplex,E=w.fontNameAsiaEast,R=w.fontNameAscii,P=w.artTextOutLineFill,I=w.artTextEffectList,B=w.underlineFill,D=w.fontSize,O=w.hightLightColor;if(!S){for(var N=0,F=void 0;!F&&N<v.length;)F=window.langCode.getLangCode(v[N++]);S=F&&F.language}var U=void 0,H=V.a[S];u.langInfo=H;var W=this.getFontBySymbol(E,2,S,k)||he.f.FontFamily;E?E.name=W:((E={}).name=W,u.fontNameAsiaEast=E),H&&2!==H.type||(U=E.name),W=this.getFontBySymbol(R,0,S,k)||he.f.AsciiFont,R?R.name=W:((R={}).name=W,u.fontNameAscii=R),H&&0!==H.type||(U=R.name),W=this.getFontBySymbol(b,1,S,k),b?b.name=W:((b={}).name=W,u.fontNameComplex=b),H&&1!==H.type||(U=b.name),c?T=c:T||(T=x?{type:Ve,color:x}:he.f.TextColor||"#000000"),u.fontSize=D||he.f.FontSize,u.fontFamily=U;var j=this._shape.getSlide(),Y=this._shape.hasContent();j&&"slides"===j.getCategory()&&Y&&v.length&&(v.length>1||"\r"!==v[0])&&this.fontManager.add(U),this._colorDelegation.setColorUsedFor("font"),T=this.getFillColorTransform(T),u.textColor=T,u.color=T&&T.hex||T&&T.color&&T.color.hex;var z=this.colorManager;if(u.color&&z.addFontColor(u.color,this._shape,v&&v.length),P&&(P=L(P,M(Ae),!0),this._colorDelegation.setColorUsedFor("font"),P=window.CoreUtils.interpretOutline(P,this._colorDelegation)),I){this._colorDelegation.setColorUsedFor("effects");var K=window.CoreUtils.interpretEffects(I,this._colorDelegation);Object.assign(I,K)}if(B){var q=B.font;q&&(this._colorDelegation.setColorUsedFor("fill"),B.font=this.getFillColorTransform(q))}O&&(u.hightLightColor=this.getFillColorTransform(O))}}}},{key:"getOverMapColor",value:function(e){return window.CoreUtils.interpretColor(e,this._colorDelegation)}},{key:"getTableFrame",value:function(e){for(var t=e.getChilds(),i=0;i<t.length;i++){var n=t[i];if(n.isTableFrame)return n}return null}},{key:"getTableBody",value:function(){var e=this.getTableFrame(this._shape);if(!e)return null;for(var t=e.getRowCount(),i=e.getColumnCount(),n={childs:[],colCount:e.getColumnCount(),height:e.visual.getHeight(),width:e.visual.getWidth(),horiborderpos:M(e.visual.getHoriBorderPosV()),vertborderpos:M(e.visual.getVertBorderPosV()),horiborderposVisual:M(e.visual.getHoriBorderPosVisualV()),vertborderposVisual:M(e.visual.getVertBorderPosVisualV()),layer:e.visual.getLayer(),rowCount:e.getRowCount(),style:M(e.visual.interpretedStyle()),styleid:e.visual.getStyleId(),fill:this.mergeDefaultFill(M(e.visual.getFill())),effects:M(e.visual.getEffects()),usebandcol:e.visual.usebandCol,usebandrow:e.visual.usebandRow,usefirstcol:e.visual.useFirstCol,usefirstrow:e.visual.useFirstRow,uselastcol:e.visual.useLastCol,uselastrow:e.visual.useLastRow,usenecell:e.visual.useneCell,usesecell:e.visual.useseCell,useswcell:e.visual.useswCell,usewwcell:e.visual.usewwCell},r=this.getSelection(),a=r&&r.getActiveTableCells(),o=0;o<t;o++)for(var s=0;s<i;s++){var l=e.getCell(o,s),h=null,u=l.getTextFrame();if(this._cellTextFrame=u,u){var c=u&&F.init(u.getTextStream());if(c&&(a&&a.includes(l)&&1===a.length?(h=c.getTextBody(this.getSelRange())).hasTextSel=!0:h=c.getTextBody(),h.dataPath={slideId:this.slide&&this.slide.getId(),shapeId:this._shape.getId()},h.data_token=c.getToken()),h){h.style=h.style||{},L(h.style,u.getProperty());var d=(this.getCellDefaultStyle(n,{r:o,c:s},{row:t,col:i})||{}).textStyle;this.updateTextBodyStyle(h,this.getCellTextStyle(d))}}var p=this.mergeDefaultFill(M(l.visual.getFillNoStyle()));n.childs.push({textBody:h,border:M(l.getBorder()),idx:l.getIdx(),margin:l.visual.getMargin(),fill:p,tableCell3D:l.visual.getTableCell3D()})}return this._cellTextFrame=null,this.deepGetOverMapColor(n.style),this._colorDelegation.setColorUsedFor("effects"),n.effects=window.CoreUtils.interpretEffects(n.effects,this._colorDelegation),this.deepGetOverMapColor(n.childs),this._colorDelegation.setColorUsedFor("fill"),n.fill=window.CoreUtils.interpretFill(n.fill,this._colorDelegation),n}},{key:"getCellDefaultStyle",value:function(e,t,i){var n=t.r,r=t.c,a=i.row,o=i.col,s=e.style,l=e.usefirstcol,h=e.usefirstrow,u=e.uselastcol,c=e.uselastrow,d=s&&s.private||{},p=d.firstColumn,f=d.firstRow,g=d.lastColumn,y=d.lastRow,v=d.wholeTable;return 0===n&&h&&(v=f),0===r&&l&&(v=p),n===a-1&&c&&(v=y),r===o-1&&u&&(v=g),v&&v.private}},{key:"getCellTextStyle",value:function(e){if(e){var t=(e=L({},e)).textStyleSheet;e.textStyleSheet=null,t&&(L(t=t.prop,e),e=t)}return e}},{key:"deepGetOverMapColor",value:function(e){if(e instanceof Object){var t=this;!function e(i){for(var n in i)"textBody"!==n&&("color"===n?i[n]=t.getOverMapColor(i[n]):"fill"===n&&i[n]?i[n]=t.getFillColorTransform(i[n]):"object"===I()(i[n])&&e(i[n]))}(e)}}},{key:"isCJKLang",value:function(e){return"zh-CN"===e||"zh-TW"===e||"ko-KR"===e||"ja-JP"===e}},{key:"getFontBySymbol",value:function(e,t,i,n){e||(2===t?e={themeScript:"drawing.eastAsian",themeIndex:"minor"}:0===t?e={themeScript:"drawing.latin",themeIndex:"minor"}:1===t&&(e={themeScript:"drawing.complexScript",themeIndex:"minor"}));var r=e,a=r.themeScript,o=r.name;if(!a)return e.name;a.includes("east")?t=2:a.includes("latin")?t=0:a.includes("complex")&&(t=1);var s=i,l=V.a[s];if(!(l&&t===l.type||(s=n,(l=V.a[s])&&t===l.type))){if(l="",o)return o;var h=this.getThemeAgent();if(h){var u=h.getFontScheme().getDefaultFont(e);if(u){var c=u.latinFont,d=u.eastAsianFont,p=u.complexScriptFont;if(0===t)return c.name;if(1===t)return p.name;if(2===t)return d.name}}return""}if(e&&l){var f=e,g=f.themeScript,y=f.name;if(e.script=l.script,g)if(-1!==g.indexOf("east")){if(0===l.type)e.themeScript="drawing.latin";else if(2!==l.type)return null}else if(-1!==g.indexOf("latin")&&0!==l.type)return null;if(y)return y;var v=this.getThemeAgent();if(v)return v.getFontScheme().getFontAt(e)}return null}},{key:"getFontFamily",value:function(e,t){var i=e.fontNameAscii,n=e.fontNameAsiaEast,r=e.fontNameComplex,a=n;return t&&(0===t.type?a=i:1===t.type&&(a=r),(a=a||{}).type=t.type,a.script=t.script),a&&a.name?a.name:this.getFontBySymbol(a,t)}},{key:"getFontByStyle",value:function(e,t){var i=e.fontNameAscii,n=e.fontNameAsiaEast,r=e.fontNameComplex,a=n||r;return t&&(0===t.type?a=i:1===t.type&&(a=r)),a&&(a.type=t.type,a.script=t.script),a}},{key:"mergeDefaultFill",value:function(e){if(e){switch(e.type){case He:e=L(M(Be.a),e);break;case Ne:case Ue:case Ge:case Ve:case Fe:default:e=L(M(Be.b),e)}return e}}},{key:"objID",get:function(){return this._shape&&this._shape.objID}},{key:"isMasterView",get:function(){return window.APP.shell.coreView.getMode()===C.ViewModes.MasterView}}]),e}(),Ye=["x","y","width","height"],ze=function(){function e(t){var i=t.shapeData,n=t.parentLayout,a=void 0===n?null:n,o=t.extendList,s=void 0===o?{}:o,l=t.scale,h=t.slideEnvLayout,u=t.isLocalShape,c=t.currentSlideData;r()(this,e),this.shapeData=i,this.parentLayout=a,this.extendList=s,this.scale=l,this.isLocalShape=u,this.slideEnvLayout=h||{},this.dataToken=i.getDataToken(),this.treeToken=i.getTreeToken(),this.ratio=1,this.currentSlideData=c,this._init()}return o()(e,[{key:"destroy",value:function(){delete this.shapeData,delete this.parentLayout,delete this.currentSlideData}},{key:"getDataToken",value:function(){return this.dataToken}},{key:"getTreeToken",value:function(){return this.treeToken}},{key:"_getPhShapeData",value:function(){if(this.slideEnvLayout.editMode===C.EditMode.layout&&this.shapeData.isPlaceHolder()&&!this.shapeData.getPicture()){var e=this.shapeData.getPlaceHolder(),t=Object.isEmpty(e.type)?C.PlaceholderType.Object:e.type;switch(t){case C.PlaceholderType.Picture:case C.PlaceholderType.Chart:case C.PlaceholderType.Table:case C.PlaceholderType.Object:var i=this.shapeData.createFakeShape();i.parent=this.shapeData.parent;var n={blip:{blipAtom:{dpiX:96,dpiY:96,imageId:t===C.PlaceholderType.Chart?window.wppDefaultChartImageId:t===C.PlaceholderType.Picture?window.wppDefaultPictureImageId:t===C.PlaceholderType.Table?window.wppDefaultTableImageId:t===C.PlaceholderType.Object?[window.wppDefaultChartImageId,window.wppDefaultPictureImageId,window.wppDefaultTableImageId]:null}},type:4,isDefaultPic:!0,isObjectPlaceholder:t===C.PlaceholderType.Object};i.private.picture=n,this._originShapeData=this.shapeData,this.shapeData=i,this.dataToken=i.getDataToken()}}}},{key:"_init",value:function(){this._getPhShapeData();var e=new je(this.shapeData,this.slideEnvLayout.viewMode,this.currentSlideData,this._originShapeData||this.shapeData),t=void 0;if(this._shapeAgent=e,e.showNotesBody()){var i=this.slideEnvLayout;(t=Object.assign({},i.svgLayout)).width/=i.scale,t.height/=i.scale}else if(this.shapeData.isBackground())t=Object.assign({x:0,y:0,rotation:0},e.getBackgroundSize());else{var n=e.getTransform2D();t=Object.assign({},n),Ye.forEach((function(e){t[e]=(t[e]||0)/635})),this.parentLayout}this.transform2D=t,this.layoutRect=this._rect2Px(t,this.scale),this.exactRect=_()({},this.layoutRect),this.viewRect=this.layoutRect,this._updateRealRect()}},{key:"_updateRealRect",value:function(){var e=this.extendList||{},t=e.measureShapeBody,i=e.typoTextBody,n=e.typoTableBody,r=e.inkBody,a=this.exactRect,o=this.realRect;if(t&&t.layout){var s=t.layout,l=s.shapeRealyRect;l&&a.width<l.width()&&(a.width=l.width()),l&&a.height<l.height()&&(a.height=l.height()),a.x+=l.x(),a.y+=l.y(),t.overflowLeft=0,t.overflowTop=0,t.relativeX=s.relativeX,t.relativeY=s.relativeY,a.overflowLeft=s.offX,a.overflowTop=s.offY}if(r){var h=r.getMaxBrushWidth();h*=window.ti2pxRatio;var u=Object.assign({},this.viewRect);u.x-=h/2,u.y-=h/2,u.width+=h,u.height+=h,this.viewRect=u}if(i){var c=i.getWrapText(),d=i.getAutoFit(),p=i,f=i.overflowLeft,g=i.overflowTop,y=i.getScaleXY(),v=i.getMargin(),m=i.getVerticalType();if(d===C.AutoFit.Advanced)p.hasText&&!this.shapeData.isPlaceHolder()?(this.layoutRect.y+=g,this.layoutRect.x+=f,c?this.shapeData.isTextBox()?(this.layoutRect.width=Math.max(this.layoutRect.width,p.x+p.width+v.right),this.layoutRect.height=Math.max(this.layoutRect.height,p.y+p.height+v.bottom)):m===C.TextDirectionType.Horizontal?this.layoutRect.height=Math.max(this.layoutRect.height,p.y+p.height+v.bottom):this.layoutRect.width=Math.max(this.layoutRect.width,p.x+p.width+v.right):(this.layoutRect.height=Math.max(this.layoutRect.height,p.height+v.top+v.bottom),this.layoutRect.width=Math.max(this.layoutRect.width,p.width+v.left+v.right))):(p.x+=f,p.y+=g),p.overflowLeft=0,p.overflowTop=0,this.viewRect=o=this.realRect;else{var _=Object.assign({},this.layoutRect);if(f<0){var w=f;_.x+=w,_.width-=w,a.width-=w}if(g<0){var S=g;_.y+=S,_.height-=S,a.height-=S}var x=p.width*y.x,T=p.height*y.y;_.width=Math.max(x,_.width),_.height=Math.max(T,_.height);var k=_.x,b=_.y,E=_.width,R=_.height,P={left:Math.min(o.x,k),top:Math.min(o.y,b),bottom:Math.max(o.y+o.height,b+R),right:Math.max(o.x+o.width,k+E)};this.viewRect={x:P.left,y:P.top,width:P.right-P.left,height:P.bottom-P.top},this.viewRect.width>a.width&&(a.width=this.viewRect.width),this.viewRect.height>a.height&&(a.height=this.viewRect.height)}}else if(n)if(n.boundRect){var I=n.boundRect;I=this._rect2Px({width:I.width(),height:I.height()},this.scale),o.width=I.width,o.height=I.height}else{var L=this._rect2Px(n,this.scale);o.width<L.width&&(o.width=L.width),o.height<L.height&&(o.height=L.height),a.width<L.width&&(a.width=L.width),a.height<L.height&&(a.height=L.height)}this.layoutRect=o}},{key:"_mapExactRect",value:function(){var e=this.exactRect,t=this.viewRect||this.realRect,i=t.x,n=t.y,r=this.getHitTestMatrix().clone();r.translate(-i,-n);var a=new window.Rect(e.x,e.y,e.width,e.height),o=r.Map(a);this.exactRect.x=o.x(),this.exactRect.y=o.y(),this.exactRect.width=o.width(),this.exactRect.height=o.height()}},{key:"_getNormalAngel",value:function(e){var t=e;return t<0&&(t+=360),Math.round(t)%360}},{key:"_transform2Rect",value:function(e){return{x:e.x,y:e.y,width:e.width,height:e.height,rotation:e.rotation}}},{key:"_radian",value:function(e){return Math.PI*e/180}},{key:"_rect2Px",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,n=Object.assign({},e);return Ye.forEach((function(e){n[e]=window.Ti2Px(n[e],i)||0})),["overflowLeft","overflowTop"].forEach((function(e){n[e]&&(n[e]=Math.round(window.Ti2Px(n[e],t.scale))||0)})),n}},{key:"getLayoutRect",value:function(){return this.layoutRect}},{key:"getLayoutRectAfterRotation",value:function(){var e=window.Rect.create(this.layoutRect);return(e=e.rotationAtCenter(this.getRotation())).getRect()}},{key:"getLayoutRectPx",value:function(e){this.updateRatio(e);var t=_()({},this.layoutRect);return Ye.forEach((function(i){t[i]*=e})),t}},{key:"getRealRect",value:function(){return this.realRect}},{key:"getRealRectBeforeRotation",value:function(){return this.realRectBeforeRotation?this.realRectBeforeRotation:this.layoutRect}},{key:"getRealRectPxBeforeRotation",value:function(){return this.getRealRectBeforeRotation()}},{key:"getRealRectPx",value:function(e){if(!e)return this.getRealRect();this.updateRatio(e);var t=_()({},this.realRect);return Ye.forEach((function(i){t[i]*=e})),t}},{key:"getExactRect",value:function(){return this.exactRect}},{key:"getExactRectPx",value:function(e){if(!e)return this.getExactRect();this.updateRatio(e);var t=_()({},this.exactRect);return Ye.forEach((function(i){t[i]*=e})),t}},{key:"getViewRectPx",value:function(e){if(!e)return _()({},this.viewRect);this.updateRatio(e);var t=_()({},this.viewRect);return Ye.forEach((function(i){t[i]*=e})),t}},{key:"getViewRectAfterRotate",value:function(){var e=window.Rect.create(this.viewRect);return(e=e.rotationAtCenter(this.getRotation())).getRect()}},{key:"getTableMixHeight",value:function(e){if(this.extendList.typoTableBody){var t=this.extendList.typoTableBody.mixTableHieght;return e?t*e:t}return 0}},{key:"getBackendRectPx",value:function(e){if(!e)return _()({},this.getBackendRect());this.updateRatio(e);var t=_()({},this.getBackendRect());return Ye.forEach((function(i){t[i]*=e})),t}},{key:"getBackendRect",value:function(){var e=this.getRotation(),t=this.getFlipped(),i=t.horizontalFlipped,n=t.verticalFlipped,r=this.layoutRect,a=r.width,o=r.height,s=r.x,l=r.y,h=new window.QMatrix(1,0,0,1,0,0),u=new window.Rect(0,0,a,o);h.translate(a/2,o/2),h.rotate(e),h.scale(i?-1:1,n?-1:1),h.translate(-a/2,-o/2);var c=h.mapRect(u);return{x:s+c.x(),y:l+c.y(),width:c.width(),height:c.height()}}},{key:"setRealRect",value:function(e){this.realRect=e}},{key:"getTiCoefficient",value:function(e){var t=0,i=this.shapeData.getParent();if(this.parentLayout&&!i.isShapeTree){var n=this.shapeData.getParent(),r=this.shapeData.getAngle();r=r<0?r+360:r;var a=this.parentLayout.getLayoutRect().height/(n.getChildExtents().height||1),o=this.parentLayout.getLayoutRect().width/(n.getChildExtents().width||1);switch(t=o,e){case"height":t=r>=45&&r<135||r>=225&&r<315?o:a;break;case"width":t=r>=45&&r<135||r>=225&&r<315?a:o;break;case"x":t=o;break;case"y":t=a}}return t||(t=1/635),t}},{key:"getExtendList",value:function(){return this.extendList}},{key:"getRotation",value:function(){var e=this.transform2D,t=e.rotation;return e.verticalFlipped&&(t+=180),t||0}},{key:"getFrameRotation",value:function(){if(void 0===this._frame_rotate){var e=this.extendList.typoTextBody;this._frame_rotate=this.getRotation()+(e?e.frameRotation:0)}return this._frame_rotate}},{key:"getFlipped",value:function(){var e=this.transform2D;return{horizontalFlipped:e.horizontalFlipped,verticalFlipped:e.verticalFlipped}}},{key:"getShapeFill",value:function(){return this.shapeProperty&&this.shapeProperty.fill}},{key:"realRect",get:function(){return this.layoutRect}}]),e}(),Ke={1574:!0,1576:!0,1578:!0,1579:!0,1580:!0,1581:!0,1582:!0,1587:!0,1588:!0,1589:!0,1590:!0,1591:!0,1592:!0,1593:!0,1594:!0,1601:!0,1602:!0,1604:!0,1603:!0,1605:!0,1606:!0,1607:!0,1609:!0,1610:!0,1740:!0},qe={1580:!0,1581:!0,1582:!0,1607:!0,1593:!0,1594:!0,1601:!0,1602:!0,1579:!0,1589:!0,1590:!0,1591:!0,1603:!0,1605:!0,1606:!0,1578:!0,1604:!0,1576:!0,1610:!0,1587:!0,1588:!0,1592:!0,1574:!0,1575:!0,1571:!0,1573:!0,1570:!0,1583:!0,1584:!0,1585:!0,1586:!0,1608:!0,1572:!0,1577:!0,1609:!0,1740:!0},Xe=[[1536,1791],[1872,1919],[64336,65023],[65136,65279]];function Je(e){for(var t=0,i=Xe.length;t<i;++t){var n=Xe[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function Ze(e){return Ke[e]}function Qe(e){return qe[e]}function $e(e){return". ".split("").includes(String.fromCharCode(e))}var et={"(":")",")":"(","<":">",">":"<","[":"]","]":"[","{":"}","}":"{","（":"）","）":"（","》":"《","《":"》","【":"】","】":"【"};function tt(e){return et[e]}function it(e){return"0123456789".split("").includes(String.fromCharCode(e))}var nt=function(){function e(t){r()(this,e),this._data=t,this._textAlign_mode=C.HorzAlignMode.Left}return o()(e,[{key:"update",value:function(e){this._data=e}},{key:"measure",value:function(e){this.sortGlyphs();var t=this._data,i=t.getGlyphs(),n=i.length;if(!(n<1)){var r=t.getVerticalType(),a=e.textAlign,o=e.rect;t.overflowTop=0,t.overflowLeft=0,t.setRect(o.x,o.y,t.width,o.height),this.adjustGlyphsAlign(a,Object.assign({},o)),t.height=1.2*this.getMaxFontSize(),t.descent=0;for(var s=i[n-1],l=0,h=0,u=0,c=0;c<n;c++){var d=i[c];if(d.isOverlayCh&&s!==d)d.x+=l,d.width+=d.overlapW,l+=d.overlapW,u+=d.maxOverlapW;else if(l<u||s===d){s===d&&(d.x+=l,d.width+=d.overlapW,l=l>u?u:l,c=n);for(var p=l/(c-h),f=h;f<c;f++){var g=i[f];f!==h&&(g.x-=p*(f-h)),g.width-=p}h=c+1,l=0,u=0}r!==C.TextDirectionType.Horizontal&&r!==C.TextDirectionType.Vertical270||(d.y+=t.height)}t.width=s.x+s.width}}},{key:"layoutGlyphs",value:function(){var e=this._data,t=e.getGlyphs(),i=t.length,n=null;this._maxHeightGlyph=t[0],e.isR2L&&t[0]&&t[0].isLineBreak()&&i>1&&(this._maxHeightGlyph=t[1]);for(var r=e.getVerticalType(),a=this._maxHeightGlyph?this._maxHeightGlyph.ascent+this._maxHeightGlyph.descent:0,o=!0,s=0;s<i;s++){var l=t[s];if(l.parent=e,l.x=0,l.index=s,n){C.TextDirectionType.EastAsianVer,n.width+n.spacing<0?l.x=n.x:l.x=n.x+n.width+n.spacing,l.x<0&&(l.x=0)}else e.height=l.height;var h=l.getScriptPosition();if(l.isLowerPosition=!1,0!==h){h/=100,l.isLowerPosition=h<0,r!==C.TextDirectionType.EastAsianVer&&r!==C.TextDirectionType.VerticalWordArtRightToLeft&&r!==C.TextDirectionType.Vertical||(h=-h);var u=1.25*l.fontSize;l.y-=u*h;var c=u*(l.descent/(l.height-l.descent)),d=h<0?.1*l.fontSize:0;l.y-=c*h+d}this._maxHeightGlyph.fontSize<l.fontSize&&!l.isLineBreak()&&(this._maxHeightGlyph=l),a<l.descent+l.ascent+.025*l.height&&(a=l.descent+l.ascent+.025*l.height),n=l,o&=l.isSpace()||l.isTab()||l.isLineBreak()}e.hasVisibleChar=o,e.maxHighLightHeight=a}},{key:"getLineHeight",value:function(){return 1.2*this.getMaxFontSize()}},{key:"getMaxFontSize",value:function(){return this._maxHeightGlyph.fontSize}},{key:"compressGlyphsWidth",value:function(e){var t=this._data.getCompressGlyphs();if(t.length>0){var i=e/t.length;t.forEach((function(t){if(e>0){var n=t.width*(1-C.GlyphFactor.compressWidth);n>i?(t.width-=i,e-=i):(t.width-=n,e-=n)}else if(e<0){var r=t.width*C.GlyphFactor.compressWidth;r>-i?(t.width-=i,e-=i):(t.width-=r,e+=r)}}))}return e}},{key:"adjustGlyphsAlign",value:function(e,t){var i=t.width,n=this._data,r=n.getGlyphs(),a=r.length,o=i-n.getWidth();n.overlapW>n.maxOverlapW&&(o-=n.overlapW-n.maxOverlapW);var s=n.getWrapText();this.layoutGlyphs();for(var l=r[0],h=0,u=0,c=a-1;c>=0;c--){var d=r[c];if(!d.isSpace()&&!d.isLineBreak()){l=d;break}d.isTailSpace=!0,u+=d.width,h++}if(n.isR2L&&r[0]&&r[0].isLineBreak()&&(u+=r[0].width,h++),n.tailSpaceCount=h,n.tailSpaceWidth=u,o+=u,l.isLineBreak()&&1===a?n.setEmptyLine(!0):n.setEmptyLine(!1),0!==o)switch(e){case C.HorzAlignMode.Left:n.isR2L&&(n.offsetLeft=n.x,n.x=0);break;case C.HorzAlignMode.Right:return n.x+=o,void(n.offsetLeft=o);case C.HorzAlignMode.Center:if(o/=2,n.isR2L){var p=n.parent.width,f=n.x+o;f=p-(f+n.width-n.tailSpaceWidth),n.offsetLeft=o,n.x=f}else o>0&&(n.x+=o,n.offsetLeft=o);break;case C.HorzAlignMode.Adjustify:if(n.isLastLine()||a<=1||o<0)return;o/=a;for(var g=0;g<a;g++)r[g].x+=g*o;case C.HorzAlignMode.FullAdjustify:if(o<0||!s)return;if((a-=h)<2){var y=o/2;if(1===a){r[0].x+=y;var v=r[r.length-1];v&&v.isLineBreak()&&(v.x+=y)}}else if(n.isR2L&&r[0].isLineBreak()){for(var m=o/(a-1),_=1;_<a;_++)r[_].x+=(_-1)*m;for(;_<a+h;_++)r[_].x+=o}else{for(var w=o/(a-1),S=1;S<a;S++)r[S].x+=S*w;for(;S<a+h;S++)r[S].x+=o}}}},{key:"hitTest",value:function(e){var t=this._data,i=Object.assign({},e);i.x=i.x||0,i.y=i.y||0;for(var n=t.getGlyphs(),r={type:"text"},a=t.getVerticalType(),o=n.length,s=void 0,l=0,h=!1,u=t.isR2L;l<o;l++)if(s=n[l],a===C.TextDirectionType.Horizontal){if(s.x>=i.x||s.x<=i.x&&i.x<=s.x+s.width){h=i.x>s.x+s.width/2;break}l===o-1&&(h=i.x>s.x+s.width/2)}else if(a===C.TextDirectionType.EastAsianVer){if(s.y>=i.y||s.y-s.height<=i.y&&i.y<=s.y){h=i.y>s.y-s.height/2;break}l===o-1&&(h=i.y>s.y-s.height/2)}else if(a===C.TextDirectionType.Vertical270){if(s.y<=i.y||s.y>i.y&&s.y-s.height<i.y){h=i.y<s.y-s.height/2;break}l===o-1&&(h=i.y<s.y+s.height/2)}else{if(s.y>=i.y||s.y<=i.y&&i.y<=s.y+s.height){h=i.y>s.y+s.height/2;break}l===o-1&&(h=i.y>s.y+s.height/2)}var c=0;s.isRightChar||u&&s.isSpace()?h||s.isLineBreak()||(c=s.getCharLen()):h&&!s.isLineBreak()&&(c=s.getCharLen()),s.isLineBreak()&&(h=t.isR2L),r.hitRight=h,r.delt=c,r.gcp=s.getGcp()+c,r.char=s.getChar(),r.typoGlyph=s,s.isThaiChar&&h&&(r.gcp=r.gcp-r.delt+s.getCharLen(),r.delt=s.getCharLen());var d=void 0;if(d=a===C.TextDirectionType.Horizontal?i.x>=0&&i.x<t.width:i.y>=0&&i.y<t.height,l>=0&&l<o&&d){var p=s.hyperlink;p&&r.char&&"\r"!==r.char&&"\n"!==r.char&&(r.textHyperlink=p)}return{ret:r}}},{key:"hitTest_Old",value:function(e){var t=this._data,i=Object.assign({},e);i.x=i.x||0,i.y=i.y||0;for(var n=t.getGlyphs(),r={type:"text"},a=t.getVerticalType(),o=n.length,s=void 0,l=void 0,h=t.isR2L,u=0;u<o;u++)if(s=u,l=n[u],a===C.TextDirectionType.Horizontal){var c=l.isRightChar||l.isSpace()?l.width:0;if(!(l.x+c<i.x)){h?l.isRightChar||l.isSpace()?(0===u||l.x+(l.width>>1)<i.x)&&(r.gcp=l.getGcp(),r.char=l.getChar()):(0===u||l.x-(l.width>>1)<i.x)&&(r.gcp=l.getGcp(),r.char=l.getChar()):l.isRightChar||l.isSpace()?(0===u||l.x+(l.width>>1)<i.x)&&(r.gcp=l.getGcp(),r.char=l.getChar()):(0===u||l.x-(n[u-1].width>>1)<i.x)&&(r.gcp=l.getGcp(),r.char=l.getChar());break}r.gcp=l.getGcp(),r.char=l.getChar(),u===o-1&&(h?l.x+(l.width>>1)<i.x&&!l.isRightChar&&(r.gcp++,r.char="",r.hitEndLineChar=!0):l.x+(l.width>>1)<i.x&&!l.isLineBreak()&&!l.isRightChar&&!l.isSpace()&&(r.gcp++,r.char="",r.hitEndLineChar=!0))}else if(a===C.TextDirectionType.Vertical270){var d=l.y;if(d<i.y){(0===u||d+(l.height>>1)>i.y)&&(r.gcp=l.getGcp(),r.char=l.getChar());break}r.gcp=l.getGcp(),r.char=l.getChar(),h||u===o-1&&l.y-(l.height>>1)>i.y&&!l.isLineBreak()&&(r.gcp++,r.char="",r.hitEndLineChar=!0)}else{var p=l.y;if(a===C.TextDirectionType.EastAsianVer&&(p-=l.height),!(p<i.y)){(0===u||p-(n[u-1].height>>1)<i.y)&&(r.gcp=l.getGcp(),r.char=l.getChar());break}r.gcp=l.getGcp(),r.char=l.getChar(),h||u===o-1&&l.y-(l.height>>1)<i.y&&!l.isLineBreak()&&(r.gcp++,r.char="",r.hitEndLineChar=!0)}if(r.needRender=1===o,r.showComplex=l&&l.getParent().showComplex,void 0===r.gcp)return null;var f=t.getBeginCcp().begin,g=r.gcp-f,y=n&&n[g];if(s>0&&g>=0&&y){var v=y.hyperlink;v&&r.char&&"\r"!==r.char&&"\n"!==r.char&&(r.textHyperlink=v)}return{ret:r}}},{key:"getGlyph",value:function(e){return this._data.getGlyphs()[e]}},{key:"adjTextVerticalView",value:function(e){var t=this._data,i=t.getGlyphs(),n=t.getVerticalType(),r=t.width;i.forEach((function(e,t){n===C.TextDirectionType.Vertical270?(e.x=r-e.x,D(e)):n===C.TextDirectionType.EastAsianVer?e.isVerticalRotateChar()?(D(e),e.x+=e.height):e.x+=e.height:n===C.TextDirectionType.Vertical&&D(e),B(e)})),B(t),D(t)}},{key:"sortGlyphs",value:function(){var e=this._data,t=e&&e.getGlyphs();if(!(t&&t.length<1)){var i=[];if((i=e.isR2L?this._sortR2LGlyphs():this._sortL2RGlyphs()).length>0)e._glyphs=i;else if(e.isR2L){var n=e._glyphs.length,r=e._glyphs[n-1];if(r.isLineBreak()&&n>2){for(var a,o=[r],s=n-2;s>=0;s--){if(!((r=e._glyphs[s]).isSpace()||r.isTailPunc()||r.isPureHeadPunc())){s++;break}o.push(r)}e._glyphs=e._glyphs.slice(0,s),(a=e._glyphs).unshift.apply(a,o)}}e.hasR2LChPos.length=0}}},{key:"_sortR2LGlyphs",value:function(){for(var e=this._data,t=e&&e.getGlyphs(),i=[],n=[],r=0;r<e._glyphs.length;r++){var a=t[r];if("R2L"===a.direction||a.isLineBreak())if(i.unshift.apply(i,S()(n)),n=[],at(a.getChar())){for(var o=r,s=t[o],l=[];s&&at(s.getChar());)l.push(s),s=t[++o];i.unshift.apply(i,l),r+=l.length-1}else i.unshift(a);else n.push(a)}if(i.unshift.apply(i,S()(n)),e.isLastLine()&&i.length>1){for(var h=i.length,u=i[h-1],c=u&&u.getParent(),d=c&&c.props.language,p=h-2,f=i[p-2];f&&!rt(f);)f=i[--p];if(d&&d.split("-")&&"ar"===d.split("-")[0]&&f&&!f.getCharInfo().isArabic){for(var g=[],y=h-1;y>=0;y--){var v=i[y];if(!(v.isLineBreak()||v.isSpace()||v.isTailPunc()||v.isPureHeadPunc()))break;g.push(i.pop())}i[0]&&i[0].isLineBreak()?i.splice.apply(i,[1,0].concat(g)):i.unshift.apply(i,g)}}return this._convertBracket(),i}},{key:"_sortL2RGlyphs",value:function(){for(var e=this._data._glyphs,t=[],i=[],n=[],r=!1,a=0,o=e.length;a<o;a++){var s=e[a],l=e[a-1],h=e[a+1],u=s.getParent(),c=l&&l.getParent();0===a||c===u||s.isRightChar&&l&&(l.isRightChar||l.isSpace())||s.isSpace()&&l&&h&&l.isRightChar&&h.isRightChar?n.push(s):(n.hasRightChar=r,i.push(n),n=[s],r=!1),r=r||s.isRightChar}n.length>0&&(n.hasRightChar=r,i.push(n));for(var d=0,p=i.length;d<p;d++){var f=i[d];if(f.hasRightChar){for(var g=[],y=[],v=0,m=f.length;v<m;v++){var _=f[v];_.isRightChar||_.isSpace()&&y.length>0?y.push(_):(g.push.apply(g,S()(y.reverse())),y=[],g.push(_))}g.push.apply(g,S()(y.reverse())),t.push.apply(t,g)}else t.push.apply(t,S()(f))}for(var w=0,x=t.length;w<x;w++){var T=t[w],k=t[w-1],C=t[w+1],b=T.getChar();tt(b)&&k&&k.isRightChar&&C&&C.isRightChar&&(T.props.char=et[b])}return t}},{key:"_convertBracket",value:function(){for(var e=this._data.getGlyphs(),t=e.some((function(e){return e.isRightChar})),i=0,n=e.length;i<n;i++){var r=e[i];if(tt(r.getChar())){for(var a=r.getChar(),o=i,s=e[o-1];s&&!s.getCharInfo().isArabic;)s=e[--o];var l=e[o+1];for(o=i;l&&!l.getCharInfo().isArabic;)l=e[++o];t&&s&&s.getCharInfo().isArabic&&l&&l.getCharInfo().isArabic&&(r.props.char=et[a])}}}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}();function rt(e){return!!e&&(function(e){return!!e&&(e.isRightChar||e.getCharInfo().isArabic)}(e)||function(e){return!!e&&(e.getCharInfo().isAlpha||e.getCharInfo().isChinese)}(e))}function at(e){return",./<>?;':\"[]{}\\|=-_+)(*&^%$#@!~`，。／《》？；’‘”“：｛｝［］＼｜=+-——）（＊&……％￥#@！～「」『』·、".indexOf(e)>-1}var ot=i(147),st=i.n(ot),lt=i(237),ht=i(2267),ut={xeE1eB:0,wh1De:0,a9yV8B:0,iMXb9B:0,eURsZ:0,"_BT-p":0,"l1-rZ":0,j0r_g:0,exTn5:0,"8nKFjB":0,PjglfB:0,kPczsB:0,BxKdy:0,do40MB:0,"3E0EMB":0,wdPwR:0,HEbOm:0,"6OuKlB":0,ywsMT:0,AuwmCB:0,"-85qwB":0,JdS0FB:0,bpD9o:0,"2sDBEB":0,ICU4EB:0,AUKGN:0,Ex9Ds:0,NajrRB:0,dWc71B:0,wHvg7:0,bteBsB:1,TJ7QTB:1,"0JKrbB":1,thtXiB:1,YpcyuB:1,U8sxT:1,qo_5d:1,pgOh5B:1,"3AQW_B":1,ZlidL:1,yfNnCB:1,FSRGp:1,ZjsAAB:1,"2TcxF":1,U3gLgB:1,iJlm2:1,"1lWYuB":1,RIHhX:1,JRAiCB:1,JsUbFB:1,L7Hol:1,KQd0b:1,"0ydQTB":1,l4bnv:1,dBVoaB:1,"2JIv6B":1,tdARTB:1,lDihoB:1,D1DPO:1,"4IwMI":1,_LBtu:2,GowmhB:2,blE2h:2,dlzy9:2,PF3Kk:2,ApVVP:2,ZRbk9:2,QRYbgB:2,yHtyG:2,q0PCKB:2,"3OtTk":2,erUzBB:2,svOwtB:2,sS9H:2,EgG8LB:2,jMUwJB:2,"2kvIw":2,A01lsB:2,"4EQouB":2,Bu4JkB:2,LwqttB:2,f7mBpB:2,M3Om4B:2,pHCExB:2,n4d6eB:2,FndfU:2,eHDvjB:2,H8khd:2,u9UO7B:2,kk6EAB:2,"7laWsB":3,Z6AKwB:3,"x-EOlB":3,NQ1_OB:3,Lp4tsB:3,zDtxF:3,Pw0WsB:3,j8pL3B:3,HiQa5:3,"50LDOB":3,"8NQf2B":3,"sbb_-B":3,E9kdVB:3,ZW5Eb:3,"79MgcB":3,Mg29SB:3,_QpcF:3,57931:3,"01Vw9":3,hFH97:3,"w-7fP":3,zIdMF:3,iQT3J:3,K8TNj:3,Z_yB9B:3,"3I1UW":3,RpcEzB:3,h6QLOB:3,ZD1TZ:3,FrpioB:3,wkpAl:4,"81JUmB":4,f7fBR:4,"6qjKaB":4,qg0iX:4,Nmby_B:4,SkcBj:4,LtBBhB:4,izz4f:4,cdYBG:4,ErdGi:4,LRQ2jB:4,KKqoXB:4,x5ip6B:4,kms7O:4,Lytie:4,"7WRtsB":4,oVPZ2:4,lmrCsB:4,EwzhnB:4,oRKB6B:4,C19CE:4,tfB4SB:4,dhd9u:4,AAzqUB:4,s4PA0B:4,Mgv9m:4,hM6mVB:4,pU6Tu:4,i34NVB:4,GISRqB:5,jarbDB:5,LvBNUB:5,j2xpFB:5,"9ZlrPB":5,LsRhG:5,Uf2JrB:5,MCf_Y:5,wRNPP:5,"3zwVBB":5,"p-Vs6":5,xukNS:5,"-QkwdB":5,"1uK1v":5,f0gZrB:5,AzvND:5,"36YvwB":5,"-9MHN":5,"86VK":5,"3Sy8XB":5,NhQFUB:5,Ij9LhB:5,tnqvv:5,ZG82oB:5,"5x8IjB":5,oATk8B:5,J8WbE:5,pXttHB:5,YbWcS:5,YaEPi:5,XgAdoB:6,ANe_QB:6,kVhWK:6,"1uxT9B":6,"6ZK_":6,py4G4B:6,D72ryB:6,dX8cTB:6,PJndH:6,stbY5B:6,UcnW2:6,wQohR:6,yS3rS:6,"4F29aB":6,LfUNB:6,vudNi:6,"6HPaY":6,LqYvkB:6,PwCZf:6,Nydk3:6,"n-kfGB":6,OCx1K:6,skXpcB:6,hNnga:6,p_xReB:6,"Wx-WiB":6,JRXXk:6,gZZXUB:6,e4lM6B:6,"4s03wB":6,"-552fB":7,dp6RAB:7,yR31J:7,"6uBlFB":7,HVlK6:7,jd_o5B:7,qOO4e:7,IGfp0:7,da3S0B:7,"0i5Sk":7,yBGIKB:7,M2UzAB:7,TDayv:7,xyaNQ:7,GbXxZB:7,O4hgV:7,beFGK:7,lXVmJ:7,"9Lagz":7,"O8R-cB":7,h7q9_B:7,yWvWM:7,nCwbyB:7,dHoHlB:7,"-dVw8B":7,Ze83n:7,h13kcB:7,wugEmB:7,hwlWM:7,"2ME2oB":7,ueUhH:8,BhhIO:8,Sd1sF:8,HOf9AB:8,"9opid":8,fBWOp:8,"57DtV":8,BbILGB:8,sAmZO:8,OkktU:8,G6JGnB:8,"5iCRIB":8,qmUMC:8,"-Mrxq":8,"1slZzB":8,"XU_Y-B":8,xhFUO:8,"5cseZB":8,o9xyS:8,woWvrB:8,yJVa3B:8,UMWM3:8,YWnB2:8,W2jYQ:8,w9OOM:8,XXHxJB:8,"133zIB":8,ql90xB:8,yeLd5:8,fO3MW:8,SRrceB:9,pg7AP:9,jgvTKB:9,"tWx-JB":9,"0aVXpB":9,m9rwd:9,"3NvkXB":9,DwP8n:9,Qz8_a:9,sXlIf:9,"z-3jH":9,R13zi:9,mup6hB:9,"995eS":9,"39txNB":9,B0vdNB:9,I4T1sB:9,"6aqOh":9,LrtCbB:9,XNOar:9,kQ7ce:9,uzWLC:9,"7Cs7j":9,CElugB:9,zjjeKB:9,iLAHF:9,TleIJB:9,bF81KB:9,ZLOd_B:9,zkbi8B:9,a5jZJB:10,"4fQzX":10,t_yIMB:10,"1fPLL":10,gW50x:10,"iYI-y":10,J6_zUB:10,"Dv-o2":10,CUloQ:10,c_ovGB:10,XyF3x:10,"eE-FS":10,Vkoli:10,Cof8PB:10,AxFc2B:10,aD0ah:10,h9n3c:10,"-2nqPB":10,Umbk4:10,cbyzIB:10,pwJbZ:10,PddBI:10,NiyRv:10,nos9vB:10,"uQ-YYB":10,"MG-ozB":10,"h-wvy":10,pEeATB:10,"2Tzw0B":10,fNTuc:10,joIW6B:11,"5hUIN":11,aBfQ9:11,Ds9wY:11,"0m6BU":11,VKm_n:11,izuaYB:11,mOkC2:11,"8Hw0IB":11,dn684B:11,GSZdUB:11,"3MWuPB":11,YwBrjB:11,"7KSi7":11,"-lHKZ":11,VfT8r:11,"2_dEcB":11,fp8k3:11,Qk51y:11,xHlyGB:11,"8BJ0eB":11,Ad_b8:11,WWKOPB:11,"31UW-B":11,ggz2aB:11,RbwHWB:11,y_bEqB:11,NyvKZ:11,"L7Vq-":11,lNEpqB:11,sH4FmB:12,KB44Y:12,fwryB:12,nlCCS:12,"06ZpiB":12,yCkXAB:12,YQY_P:12,amKFEB:12,cO6tl:12,P7XN0:12,A0HIN:12,zcATuB:12,kgSOo:12,"5GpzQB":12,vmjbZ:12,RO8al:12,rbDW0:12,"zWqg-B":12,i3v04:12,zxVJo:12,oYCYU:12,gmbrI:12,TyJ5iB:12,E3bnMB:12,ZC_MwB:12,P4VXfB:12,xhO5gB:12,Lp5ucB:12,TsNPc:12,eHesrB:12,"gM-3f":13,"Acu-7":13,"4t_qaB":13,LwLShB:13,csf2YB:13,RdJHU:13,H4TswB:13,pQAY8B:13,DLu2oB:13,LqyUZ:13,aior8B:13,ixi6zB:13,ZSWsMB:13,dUdez:13,b4U5CB:13,"1LSiZ":13,c34mP:13,"6bz2S":13,"v-hW1":13,"3ox9dB":13,keu43:13,Xb8LzB:13,ucnwz:13,sdjpRB:13,GYRI_:13,NuekN:13,rfWLZ:13,AjaqS:13,I49APB:13,VBFtVB:13,xtqKe:14,"4nenZ":14,WheaMB:14,rQSU1:14,CS941B:14,AT5xT:14,aNnQ:14,hj0sPB:14,"-UsTbB":14,UYwyUB:14,ctTJR:14,p2a1X:14,zFpjFB:14,AbALW:14,wuVgL:14,el7RjB:14,ivMHiB:14,gPJe8:14,"6W0T4":14,hws21B:14,"-Qd50B":14,"0_i6d":14,"83wilB":14,pncSCB:14,cqQiK:14,z5gG7:14,t5UZ2B:14,"3vWF2B":14,_z6cV:14,wWR2JB:14,BnUqD:15,NJ1BUB:15,aMiEHB:15,"2wKOLB":15,"9Ydpz":15,bOd5OB:15,wHPAO:15,HXfk_:15,BXT35B:15,LNVj5B:15,SR56Y:15,E0PUNB:15,VETIH:15,hmzfXB:15,upgiKB:15,"4M8Qu":15,FcRBQB:15,HInWb:15,"_-MQs":15,"8Ff3fB":15,Wfs8dB:15,"9z0zq":15,bahN5B:15,Q5Djt:15,YaglsB:15,FTZZU:15,h54Ug:15,VSuDF:15,"Zc-4D":15,X87PeB:15,xDnFaB:16,YdfoX:16,"29PrW":16,"rrVs-":16,zkjUH:16,gUPEkB:16,TXDUs:16,qmT4cB:16,kmHLY:16,ucJ3X:16,"1gtO3":16,nDEorB:16,"4THcl":16,E2nz1B:16,R5U2oB:16,"td9-sB":16,"0FQbVB":16,S7PrwB:16,n0Byv:16,_DSWgB:16,"4DGpb":16,C6HVb:16,J_rs6:16,"7gCGvB":16,MxF6o:16,YTmR5B:16,lWTUsB:16,v5uCQB:16,"8IEzxB":16,PhRr1:16,ugoSMB:17,FgbwAB:17,HjLCnB:17,aO_bE:17,cRutq:17,odcOt:17,GOqV4B:17,"KUU-y":17,IWvKLB:17,ij2FaB:17,JmCce:17,nIpPwB:17,cx4Gu:17,kiD4xB:17,RVR91B:17,E1o93:17,b9q9nB:17,Zc3yN:17,zQGeE:17,"6dLdzB":17,YNM4TB:17,t1Icd:17,"1STLZB":17,C52wNB:17,eBQPN:17,lyfey:17,DqwPIB:17,Y_I5H:17,vGL53:17,tlXudB:17,HamZUB:18,OnrYDB:18,sWszj:18,"B-oXtB":18,JczGp:18,WCXsd:18,g7mMd:18,ttmAL:18,Ek4sPB:18,"-gYZW":18,C_XUQB:18,"9THF1":18,qJwU4:18,"8OdkEB":18,_QsuFB:18,zjZtjB:18,lj8vtB:18,AOJmP:18,ESxbPB:18,C1aSMB:18,c1Ba3B:18,jU_xv:18,"BIL-a":18,WmLWN:18,ezPlJB:18,rfn_gB:18,_1z4F:18,"1i-yYB":18,zC8Jz:18,"NKn-u":18,"0jfisB":19,SEQlrB:19,HyVmU:19,PrjOcB:19,"8aP_4":19,YVrOQ:19,"-ScF6B":19,d7YYG:19,SVEMM:19,JCQGfB:19,HiMd5:19,hp3S1:19,IDw1yB:19,mjg4xB:19,bRm5a:19,jK0hiB:19,"Q6fR-":19,au1Gk:19,eTz2JB:19,idEsIB:19,g9ADj:19,"6Es4e":19,hekbcB:19,"-_UebB":19,"0safE":19,"8loHMB":19,pVU3o:19,cYIHxB:19,znYrh:19,tnM_cB:19,"3dOqcB":20,_hyB8B:20,wEJbw:20,BVMPqB:20,N3sm6:20,a6Zpt:20,"2eCzx":20,"9GVOa":20,b8Ue1:20,w1Gl0B:20,HFXJl:20,BFLcgB:20,L7MIgB:20,"S-wf-B":20,EiH5z:20,VyKttB:20,hUrE_:20,uXYHx:20,"46z1U":20,FKJm2:20,Hq3ZI:20,lyqalB:20,pyR5cB:20,n3mJE:20,B_g1EB:20,ImzQt:20,mbzgIB:20,"7UlnH":20,DaS4n:20,QpnoJB:20,j8rZs:21,aCUqkB:21,YEv18B:21,yR2wL:21,ZUCHQB:21,"32o6h":21,sf4xfB:21,"0QDjj":21,hDRon:21,"9hn6G":21,kIIHcB:21,CzyEQ:21,"3H8Zu":21,uNkqmB:21,"sP-1_B":21,GdGxN:21,tfSHSB:21,LC56j:21,ArIyhB:21,IcTjl:21,"1Ohop":21,"-YKi6":21,D6VOxB:21,HAA4r:21,FCbDEB:21,fPi_SB:21,GSuUX:21,k0UIpB:21,"Zdk-m":21,hOvwqB:21,OB91uB:22,BhU2w:22,YpW2gB:22,WIjrG:22,w8xW9B:22,"3J3VsB":22,V53wMB:22,qh0UW:22,y__DSB:22,"-kipGB":22,bt7HG:22,ieLXr:22,AWcIBB:22,Vq0x:22,sy2xw:22,qRDnWB:22,EGSSNB:22,LTXR8:22,pCYsc:22,_qUQmB:22,"GIf-h":22,TuClW:22,dnSFW:22,qZS5D:22,sXidt:22,"9zWKcB":22,IyNzaB:22,JmSz2B:22,N3M2jB:22,tDtUpB:22,wLYmy:23,xxI_B:23,"97mFnB":23,"-fYPWB":23,"d-2riB":23,mguiN:23,ggazNB:23,"0dylj":23,CsIjaB:23,cbH6r:23,NkvHNB:23,"-oZKa":23,wxBY7:23,"4_Fo7":23,pHu1cB:23,Z44xH:23,"KBh-o":23,GuPVBB:23,ESHwQB:23,elEZn:23,FRrdd:23,j1ltg:23,YZUNDB:23,gCk0rB:23,N4gvFB:23,A1uCB:23,X2ZnBB:23,V3VgfB:23,"vxD-LB":23,"2HRbb":23,U5ICn:24,p8Mhg:24,xRw3cB:24,_a3jjB:24,aHdBs:24,hBRen:24,"-6QRaB":24,UqELDB:24,rrvvD:24,psroh:24,DnZHO:24,K9mjdB:24,oueKpB:24,"9xipiB":24,FHGAf:24,SQNsl:24,cfbaTB:24,p0yBk:24,_Tmf6:24,CcT_JB:24,AdP3nB:24,aX9VUB:24,htKyj:24,"-eCZv":24,UiG4o:24,c3pOlB:24,pAx6rB:24,"8Z4GuB":24,zt_He:24,xraj_B:24,LtD2KB:25,ydvXZ:25,Q8HTH:25,FvY1C:25,NwxJ2:25,"6cIh9":25,WzFMsB:25,"9HOD5":25,bu6cH:25,QNdy7:25,HhjzrB:25,"Ff-OMB":25,fgohY:25,GRUDnB:25,kvs_UB:25,Zi9gQB:25,hjW1D:25,OQtML:25,Yu506B:25,AQuAwB:25,WVyRj:25,IoESQ:25,Q7ZpS:25,f4Za9:25,"7Z6RwB":25,k2Lo6:25,ShKsSB:25,ohjaG:25,"24LFK":25,Dljeh:25,Fnyoi:26,"-J18K":26,_tE3QB:26,cdbpCB:26,z2olNB:26,Faqb9B:26,hO2FgB:26,hPnyk:26,c57V6B:26,S4xVBB:26,UYgJT:26,fEsur:26,oGOpFB:26,UTVjm:26,u0juNB:26,HYnhGB:26,x7KfVB:26,QY3J4B:26,O5S0O:26,brywY:26,SjYqp:26,QpqRdB:26,qC4WbB:26,RXAOo:26,v9sn2B:26,kcP9q:26,"s9r-pB":26,Z2kzR:26,aPsIE:26,JnmPO:26,NvTud:27,LwPn7:27,lq9Fo:27,sALi3B:27,KyCJD:27,f1Go8B:27,nKq_4:27,"0Txq-":27,Ht42BB:27,"_A-3xB":27,"8_aTSB":27,WAEme:27,"9wvHtB":27,bPIDbB:27,QCZlWB:27,YDy5J:27,FwIRR:27,"hGG8-":27,IbOzM:27,mB7MbB:27,bgdiP:27,"S0jj-":27,"Qy-_f":27,qzoRsB:27,RkUz6:27,vCtuo:27,k19Qk:27,s2WlXB:27,Zjt8eB:27,jB6kOB:27,O4jO1B:28,Q6yY2B:28,Wunsc:28,FacKh:28,yEczr:28,wKuafB:28,Kk7fdB:28,x4DXq:28,Pfww4B:28,E_SGt:28,MfvIsB:28,"5Xo8T":28,LPyY3B:28,tJDHKB:28,BHFesB:28,DHDFLB:28,PfplDB:28,"1Yvr1":28,"-Ae3qB":28,YUuTE:28,m1VFl:28,gk7hC:28,kojXCB:28,"iLNO-":28,"8L0VqB":28,Drwti:28,he96N:28,"289R":28,_JCh8:28,L2Z6TB:28,eMm04B:29,V5xuLB:29,TZuFm:29,tgZ7h:29,U6RefB:29,yaCheB:29,nIIiH:29,vBWKPB:29,cxB6r:29,"4rdKD":29,fpOBtB:29,"9RLU5B":29,"yr2H-B":29,pYCCSB:29,n4_Ys:29,BAqOo:29,oZixlB:29,G6S0kB:29,"7nY1N":29,DhmdVB:29,wQSNy:29,"6EoCX":29,lg7hp:29,nAqV7B:29,k3pS5:29,mYo9EB:29,"d-7gQB":29,PzRG_:29,T1Y4k:29,RZQT0:29,rsN8K:30,SY0AB:30,w8uQE:30,lgdwm:30,tJtXPB:30,"a-pSp":30,N83lkB:30,k9iKl:30,i_eDDB:30,"84Miv":30,DPa__B:30,hASlK:30,"2DWEE":30,_Y5aAB:30,LiAHHB:30,nOmkP:30,uIaBL:30,MCa09:30,hxNum:30,"4y4SnB":30,"2z0LF":30,QuiqxB:30,XEwGBB:30,"11ntMB":30,K5rMGB:30,SOPjC:30,fXWPJ:30,pmk92:30,tpgvDB:30,xxNOTB:30,vyJHxB:31,Jt3ldB:31,QDFCt:31,u08o4:31,D4AIy:31,LNkeuB:31,YWrK1B:31,rvyW3B:31,iD5Xn:31,gBVzH:31,"6C_FUB":31,hzpni:31,"-RCjQ":31,"0ETFM":31,"8FsZ-":31,pyCxGB:31,FJAc1B:31,sdITCB:31,KE1sQ:31,"-iXCFB":31,"22dD1B":31,"005eVB":31,O2ixh:31,"1mOTwB":31,TFnOeB:31,I43wZB:31,Q5QFN:31,"9lncU":31,HE0EE:31,"08s4r":31,"277kH":32,jsSzq:32,XO8ne:32,aBulN:32,IZXRwB:32,wFw2G:32,y7MM6B:32,Qx9mgB:32,snc65B:32,"9XUZj":32,QXtXFB:32,hyxwSB:32,Wey14:32,Mjqhr:32,u5XKDB:32,I6_RuB:32,QR6_i:32,fKjes:32,QMowSB:32,loGQv:32,d6W7NB:32,w8jiUB:32,B53GMB:32,"2phXH":32,sEs8jB:32,OdYovB:32,oXGHcB:32,w2KlM:32,bcozUB:32,"9-mHbB":32,"1VMgt":33,o_ErO:33,ZCXmIB:33,uotLxB:33,kIoz5:33,GwAzFB:33,g9HuUB:33,o4u4f:33,XZ0MZB:33,fEZJy:33,mNA7i:33,"tiHL-B":33,DhlPEB:33,C7yBxB:33,eSr31B:33,nRfnBB:33,V3Ccz:33,mxPdfB:33,mI0J2B:33,liB8i:33,B65xn:33,K5thzB:33,"4eRWlB":33,JZeXR:33,fMDD9:33,emQ1pB:33,"69IruB":33,D98a6:33,xigPs:33,CdtQYB:33,AkVQJB:34,"-9iC2B":34,bVb46B:34,kUPoGB:34,S6yc4:34,"j0-dkB":34,xcU6OB:34,"vE-MFB":34,Jk2iPB:34,whnZ5:34,OKksFB:34,DkPgLB:34,L9AbjB:34,"44CuHB":34,mGnjB:34,"9CLPzB":34,BHzEz:34,"-pc7v":34,ZqDDbB:34,gJAbT:34,_8Mo_B:34,"TbN-wB":34,boROt:34,oUpnEB:34,"7q1hpB":34,yXBc8:34,w39yW:34,"K-ooS":34,xYhLQB:34,P5ROPB:34,EnXP4B:35,"Mgl3-":35,"5PRnc":35,VKt3zB:35,"8HeudB":35,awaBqB:35,PKG1vB:35,G3RvCB:35,EXOGd:35,ee57Y:35,F4xeWB:35,jYihVB:35,YGoi_B:35,"g-1KGB":35,Nvh6i:35,Xj3vH:35,Ef5CsB:35,"2luyo":35,HWmRSB:35,"aV-P0B":35,rwDpB:35,gcEunB:35,Wh8ZaB:35,"43pCyB":35,S4QKd:35,aPM3RB:35,pI1WbB:35,aK6oB:35,vmYIeB:35,n4oz8B:35,"661aD":36,"L3J-6B":36,AozP2:36,"2C_0S":36,Ybqge:36,"yVY-K":36,"60cd7":36,la6rD:36,"H_4-J":36,"-TeYcB":36,y8Wj9:36,jApe3B:36,"4m-Dg":36,uG6roB:36,QuSr0B:36,q7ZmD:36,y2AxOB:36,hXGFI:36,pCrBhB:36,rv2BX:36,CjYuEB:36,Aot_rB:36,aunqs:36,hW6FV:36,"-L6Vw":36,UFscvB:36,cKZtP:36,pZudx:36,FOBJ7:36,Nu3dD:36,eev8s:37,xdI7OB:37,C5MUcB:37,"3kNZCB":37,tpFF1:37,PAztMB:37,pAa13B:37,xXVis:37,AR_B2:37,xSDUcB:37,Gvhz4:37,_AyeXB:37,"RD-FeB":37,"i-SqVB":37,Xw86Q:37,NLHgtB:37,vjzL5B:37,JehqlB:37,R9lIW:37,"8iDXeB":37,eGCrkB:37,WcnD3:37,JFgOY:37,"6IyJSB":37,PvIv6B:37,FPDXDB:37,n2bWPB:37,BEjReB:37,"J-Jcp":37,"4fPwiB":37,AL0s7:38,rqofYB:38,K1ciT:38,O9JBj:38,M_F6AB:38,m4zYt:38,tOB18B:38,LA5bI:38,gD96B:38,oYgR_:38,"1hn9EB":38,I7uJHB:38,"-O1K3B":38,"9MRmXB":38,XO64j:38,__layB:38,cd_VgB:38,RQP4bB:38,ZRoMP:38,G__jW:38,iU8OFB:38,JpEGS:38,nPxfgB:38,cuT1U:38,TCa2EB:38,RA2Rl:38,rBfkxB:38,SyKGAB:38,wQjBu:38,lD0jp:38,tEN4cB:39,axjPkB:39,kPw3TB:39,RIpr7B:39,CUgcN:39,EybCT:39,I4FsNB:39,G6g3lB:39,gHoy0B:39,HK0I5:39,lsa8K:39,aVqzIB:39,iG1kM:39,P5CqQ:39,CZaqSB:39,ZhcqC:39,XApfo:39,x03Kf:39,"4B9JO":39,Wx9kuB:39,rZ6I4:39,z2E4zB:39,AdodoB:39,clB8n:39,jWRLNB:39,BOi8iB:39,Wi6li:39,tq8lSB:39,rJJb4B:39,F_XGvB:39,MLdFeB:40,q6dg_:40,"-iaEI":40,HAlzDB:40,UmIZ4:40,efY53:40,rRYtl:40,JpvHj:40,Nr25J:40,LPuUZ:40,lir9vB:40,MOSCmB:40,qyMSpB:40,fW7xL:40,"n-KZ0":40,U1HUO:40,HyVnJB:40,ezAMK:40,c08Eo:40,"2uqjU":40,"9E4-jB":40,b2vmvB:40,w5zFpB:40,"4OXcl":40,FYeIs:40,hEEm0B:40,o_3CwB:40,G431i:40,bnrvL:40,yoWUMB:40,wpSNqB:41,KkAsWB:41,R6NIm:41,vrFvx:41,EvJOr:41,MEtknB:41,ZN0QuB:41,"jcC-b":41,wxZmsB:41,MayxEB:41,jDUTu:41,qXqRPB:41,C3bqa:41,GBtfZ:41,Ehp2zB:41,eoUsvB:41,FCNPt:41,ji9Rs:41,YQDTVB:41,gJR7c:41,N58q5B:41,A8w6BB:41,XLBfyB:41,RL1xt:41,bB3dt:41,iFb1MB:41,UoxOB:41,l40C7:41,xaVaL:41,_dCd_B:41,aCrmC:42,hq9BrB:42,"-f9RG":42,UZvYFB:42,"ro-81B":42,lozPx:42,ve17w:42,"2iZTQB":42,oFwsE:42,"5Vzg_":42,F4T4O:42,S7A7B:42,cecplB:42,ptxZH:42,"-8zhBB":42,WwVOvB:42,U1qeW:42,u7kKXB:42,"1j3l-":42,TZ31aB:42,oSp8Z:42,wXWN6:42,"9mr9bB":42,tvlamB:42,r06qN:42,F70WOB:42,MjHy2:42,qYHCSB:42,"-R5IR":42,HXmZx:42,Um7JTB:43,kYZ3jB:43,oeDhe:43,mges2:43,AulnFB:43,nwx9J:43,FTYxbB:43,"67noZ":43,CtyZdB:43,vfAfhB:43,"i-Xfj":43,"5HafTB":43,"3mmU5B":43,"Rb1-vB":43,Yo6_eB:43,"2X7Z-":43,LA49I:43,TdCtEB:43,gDmS5:43,"8L-w4B":43,D9OAe:43,h0fxz:43,"2I4azB":43,NR6aj:43,LwGQJB:43,"lkV7-":43,sxa6u:43,KhbVP:43,fJY5YB:43,nmioU:43,"0MGOJ":44,_FWuI:44,L4Vi2B:44,qPgJ0B:44,z_2mR:44,"3CfcRB":44,"1lITOB":44,Pmva5B:44,WFsyx:44,"044-c":44,JX5WP:44,Rk9lLB:44,"eQV-iB":44,xmh5H:44,oTtzaB:44,mzpK1:44,A7UAx:44,nUNjuB:44,F19ltB:44,"6iDnW":44,CcRPeB:44,vL9_6:44,LGZPS:44,yDKG8B:44,QsGZI:44,FGyMO:44,"8y9GhB":44,"6S6d7":44,UalT3:44,"7zd20B":44,ZUO5zB:45,OCU6c:45,W7hikB:45,DrNSBB:45,NfjHm:45,"6alaK":45,HiU0U:45,U9hdE:45,w1JDsB:45,RrxJKB:45,Kkjl7:45,pZVicB:45,XloYy:45,HvKF_:45,vqKdh:45,dY6tKB:45,Btbq2:45,"9Q6vZ":45,SDJqMB:45,"0211O":45,YVdfPB:45,lMkOD:45,w5VedB:45,SC7UsB:45,elx9G:45,xDxh0B:45,DZONw:45,tVtm7B:45,"0D8vO":45,YVCjmB:45,SodE2B:46,Qp48qB:46,"7dh0xB":46,D5t5zB:46,JVQlYB:46,AiVeMB:46,xb4oTB:46,Edfu4:46,"7K3On":46,yVFl3B:46,"ich-dB":46,M4BRt:46,UE8hEB:46,"6UKf6B":46,N012j:46,NuWDuB:46,H6zRnB:46,QVvTkB:46,Ra80a:46,"cRc-B":46,N8jgx:46,y1m03B:46,yMs6hB:46,NXXipB:46,tcNA6B:46,RM7fH:46,"1ucutB":46,uKEWsB:46,RhwLKB:46,kSWamB:46,_YfhcB:47,BSzPxB:47,aZhCsB:47,"1umDq":47,wfZ1o:47,"93qRJ":47,"80SSm":47,"6olUH":47,qbPj3B:47,oF50rB:47,"-kmFtB":47,uYf3P:47,cI4C5:47,FL6nL:47,XBMQqB:47,YWXnvB:47,i45eU:47,"-YMDjB":47,I0U8xB:47,"9yeQnB":47,"0ukcoB":47,rH7Wr:47,FejkOB:47,HY82oB:47,FQwkJ:47,ljmiD:47,"1-0vhB":47,IKi0P:47,"a-Z1P":47,u47VJ:48,"KAd-I":48,PAYLz:48,acvkJ:48,V6cud:48,nLKh1:48,Tb7aY:48,MpX0J:48,"0redK":48,"5IOiD":48,"9MeiD":48,weGov:48,ovgqx:48,unC81:48,mciue:48,XR1qz:48,v9IVHB:48,J8Yp0B:48,"9xr7y":48,"d4hf-":48,"7oNC7B":48,UU2C7B:48,EAWUJ:48,"r-c8pB":48,USZ0WB:48,UxLy0B:48,"8YH-J":48,uA7q1B:48,lAPiD:48,"1cdvhB":48,l17SG:49,O4eLs:49,t8asM:49,aXaTH:49,"wB-iDB":49,T8WUI:49,bekRNB:49,VtnNoB:49,"4n-_s":49,a0vCB:49,j7xjD:49,b4Gy4:49,tED61B:49,N7dQXB:49,I9RnWB:49,X7PiD:49,"-VSiD":49,DLtEg:50,knWlh:50,mVpiD:50,SXaCg:50,zzDjh:50,"2RWji":50,"3_tYUB":50,"2gmCg":50,X9Pjh:50,UpwvO:50,O5ltO:50,OfaPh:50,PMyETB:50,tScQh:50,"u-zFTB":50,"6JKDg":50,bmzjh:50,Jr0vY:50,"0Nqij":50,XW6HLB:50,TbnPh:50,"UI-ETB":50,mfZCg:50,H8Cjh:50,hwLPh:50,idjETB:50,oiyDg:50,"J-bkh":50,LNSDg:50,sp7jh:50,LssDg:50,sIWkh:50,hNZCg:50,CqCjh:50,f6I61B:50,xxjxDB:50,uyBsz:50,ER1w1:50},ct={NFOPXB:"nLKh1","17yqc":"0redK","0oQqc":"acvkJ",Zlwy7B:"u47VJ","1U3_zB":"a-Z1P","6xoz-B":"-VSiD",af_nM:"5IOiD",IOOng:"J8Yp0B",Op5qa:"ljmiD",NOeosB:"lAPiD",emlPZ:"1-0vhB",dTGj0:"1cdvhB","h-4Y2B":"unC81","4c5hcB":"X7PiD",V8KIyB:"9MeiD",Zqin5B:"nLKh1","-WKa0B":"IKi0P",omihd:"8YH-J",BmdFd:"EAWUJ",rB06BB:"KAd-I",er5mO:"V6cud",UWo3:"MpX0J",N3WVK:"Tb7aY",WGzsQB:"PAYLz"},dt=i(4901),pt=i.n(dt),ft=i(4902),gt=i.n(ft),yt=i(4903),vt=i.n(yt),mt=i(4904),_t=i.n(mt),wt=i(4905),St=i.n(wt),xt=i(4906),Tt=i.n(xt),kt=i(4907),Ct=i.n(kt),bt=i(4908),Et=i.n(bt),Rt=i(4909),Pt=i.n(Rt),It=i(4910),Lt=i.n(It),At=i(4911),Bt=i.n(At),Dt=i(4912),Mt=i.n(Dt),Ot=i(4913),Nt=i.n(Ot),Ft=i(4914),Vt=i.n(Ft),Ut=i(4915),Gt=i.n(Ut),Ht=i(4916),Wt=i.n(Ht),jt=i(4917),Yt=i.n(jt),zt=i(4918),Kt=i.n(zt),qt=i(4919),Xt=i.n(qt),Jt=i(4920),Zt=i.n(Jt),Qt=i(4921),$t=i.n(Qt),ei=i(4922),ti=i.n(ei),ii=i(4923),ni=i.n(ii),ri=i(4924),ai=i.n(ri),oi=i(4925),si=i.n(oi),li=i(4926),hi=i.n(li),ui=i(4927),ci=i.n(ui),di=i(4928),pi=i.n(di),fi=i(4929),gi=i.n(fi),yi=i(4930),vi=i.n(yi),mi=i(4931),_i=i.n(mi),wi=i(4932),Si=i.n(wi),xi=i(4933),Ti=i.n(xi),ki=i(4934),Ci=i.n(ki),bi=i(4935),Ei=i.n(bi),Ri=i(4936),Pi=i.n(Ri),Ii=i(4937),Li=i.n(Ii),Ai=i(4938),Bi=i.n(Ai),Di=i(4939),Mi=i.n(Di),Oi=i(4940),Ni=i.n(Oi),Fi=i(4941),Vi=i.n(Fi),Ui=i(4942),Gi=i.n(Ui),Hi=i(4943),Wi=i.n(Hi),ji=i(4944),Yi=i.n(ji),zi=i(4945),Ki=i.n(zi),qi=i(4946),Xi=i.n(qi),Ji=i(4947),Zi=i.n(Ji),Qi=i(4948),$i=i.n(Qi),en=i(4949),tn=i.n(en),nn=i(4950),rn=i.n(nn),an=i(4951),on=i.n(an),sn={0:pt.a,1:gt.a,10:vt.a,11:_t.a,12:St.a,13:Tt.a,14:Ct.a,15:Et.a,16:Pt.a,17:Lt.a,18:Bt.a,19:Mt.a,2:Nt.a,20:Vt.a,21:Gt.a,22:Wt.a,23:Yt.a,24:Kt.a,25:Xt.a,26:Zt.a,27:$t.a,28:ti.a,29:ni.a,3:ai.a,30:si.a,31:hi.a,32:ci.a,33:pi.a,34:gi.a,35:vi.a,36:_i.a,37:Si.a,38:Ti.a,39:Ci.a,4:Ei.a,40:Pi.a,41:Li.a,42:Bi.a,43:Mi.a,44:Ni.a,45:Vi.a,46:Gi.a,47:Wi.a,48:Yi.a,49:Ki.a,5:Xi.a,50:Zi.a,6:$i.a,7:tn.a,8:rn.a,9:on.a},ln=[];function hn(e){var t=ut[fn(e)];if(void 0!==t){var i=ln[t];return i?i.get(e):new Promise((function(i,n){sn[t]||n();try{var r=setTimeout(n,2e4);sn[t]((function(a){clearTimeout(r),a&&a.default?(ln[t]=new mn({data:a.default}),i(ln[t].get(e))):n()}))}catch(t){console.error("load metrics error",e,t),n()}}))}}var un={"":'":{"',"":'":["',"":'","',"":'"],"',"":'"},"',"":'":"',"":'"]},',"":"1000"},cn={};function dn(e){try{Object.keys(un).forEach((function(t){cn[t]=cn[t]||new RegExp(t,"g"),e=e.replace(cn[t],un[t])}))}catch(e){console.error(e)}return e.replace(/\"\"\"/g,'"\\""')}function pn(e,t){var i=ut[fn(e)],n=ln[i];if(n)return n.get(e).get(t,e)}function fn(e){var t=e.fontFamily.trim(),i=Object(ht.b)(t.toLocaleLowerCase());return ct[i]||Object(ht.b)(t)}var gn="〈·《「『【〔〖〝﹙﹛﹝＄（．［｛￡￥℃∶、。〃々〉》」』】〕〗〞︶︺︾﹀﹄﹚﹜﹞！＂％＇），．：；？］｀｜｝～￠★☆",yn="$([{£¥!%,.:;<>]})?+-=¢¨°·ˇˉ_―‖‘“’”…‰′″›\"' ";function vn(e){if(gn.includes(e))return gn[0];if(yn.includes(e))return yn[0];var t=e.charCodeAt();return t>=97&&t<=122?"a":t>=65&&t<=90?"A":t>=48&&t<=57?"0":t>=19968&&t<=40869?"一":void 0}var mn=function(){function e(t){r()(this,e),this.props=t,this._list={}}return o()(e,[{key:"get",value:function(e){var t=fn(e);if(!this._list[t])try{this._list[t]=new wn({data:JSON.parse(dn(this.data[t]))})}catch(t){console.error(e.fontFamily+" metrics error",t)}return this._list[t]}},{key:"data",get:function(){return this.props.data}}]),e}();function _n(e){return"\r"===e||"\n"===e||"\t"===e||"\v"===e||" "===e}var wn=function(){function e(t){r()(this,e),this.props=t}return o()(e,[{key:"getFontStr",value:function(e){return e.fontFamily}},{key:"has",value:function(e){return _n(e)&&(e=" "),!!vn(e)}},{key:"get",value:function(e,t){_n(e)&&(e=" ");var i=vn(e);if(i)return this.getMetrics(e,i,t)}},{key:"getStyle",value:function(e){var t="bold"===e.fontWeight,i=e.fontStyle;return t?"italic"===i?"bi":"b":"italic"===i?"i":"n"}},{key:"getMetrics",value:function(e,t,i){var n=i.fontSize/1e3,r=this.data[e],a=void 0;t&&e!==t&&(a=this.data[t]);var o=this.getStyle(i),s=void 0;if(r&&((s=r[o])||(s="bi"===o&&r.b||r.n,r[o]=s)),s){if("string"==typeof s){for(s=s.split(",");s.length<4;)s.push(0);r[o]=s}a=a&&a[o],r=[].concat(S()(r&&r[o])),Object.keys(r).forEach((function(e){a&&a[e]&&(r[e]=+r[e]+ +a[e]),r[e]*=n}))}else r=[].concat(S()(a&&a[o])),Object.keys(r).forEach((function(e){r[e]*=n}));return r&&{width:r[0],height:r[1],descent:r[2],ascent:r[3]}}},{key:"data",get:function(){return this.props.data}}]),e}();function Sn(e){var t=e&&e.charCodeAt();if(t&&t>=19968&&t<=40869)return!0}function xn(e){var t=e&&e.charCodeAt();return t>=19968&&t<=40869?"一":t>=0&&t<=255||gn.includes(e)||yn.includes(e)?e:void 0}function Tn(e){var t=ut[fn(e)];return void 0!==t&&t<50}var kn,Cn=i(156),bn="REQ_FONT_USER",En="RECV_FONT_USER",Rn="REQ_FONT_INFO",Pn="RECV_FONT_INFO",In=1,Ln=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.refreshSlides=function(e){console.log("recv textMeasure refreshSlides",e),Object.keys(e).forEach((function(t){window.SlidePool.getInstance().reRender({slideId:parseInt(t),shapeIds:e[t],type:"hasShapeReview"})}))},i._onBraodMessage=function(e){var t=e.detail;if(t.message){var n=t.message;n.type===En?(console.log("recv fontInfo:",n),i._recvFontUser(n)):n.type===bn?(console.log("recv fontInfo:",n),i._onSendFontUser(n)):n.type===Rn?(console.log("recv fontInfo:",n),n.data.recv_user_id===i.userId&&i._onSendFontInfo(n)):n.type===Pn&&(console.log("recv fontInfo:",n),i._recvTextInfo(n))}},i._onUserOnlineChange=Object(Cn.debounce)((function(){var e=i.users;e&&e.length>1&&(i._prevTasks&&i._prevTasks.stop(),i._prevTasks=new ht.a(i._notFontList,(function(e){i._notFontList.includes(e)&&i._reqUserFontMsg(e)}),i.random).then((function(){})))}),5e3),i._reqUserFontMsg=function(e){i._findOnlineUserByFont(e)||i.sendBroadcast({data:{fontFamily:e},type:bn})},i._findOnlineUserByFont=function(e){var t=i._fontUserCache[e];if(t)for(var n=0;n<t.length;n++){var r=t[n];if(i._isOnlineUser(r))return r}i._fontUserCache[e]=[]},i.wppTextMeasurer=e,i._fontUserCache={},i._req_timers={},i._req_tasks={},i._notFontList=[],window.__CONFIG__.wpp.enableShareFont&&(window.addEventListener(lt.default.pubNames.cooper.ON_BROADCAST_MSG,i._onBraodMessage),i.doc.selectionsMgr.on("new_selection",i._onUserOnlineChange),window.addEventListener(lt.default.pubNames.cooper.ON_USER_JOIN,i._onUserOnlineChange)),i._reqCnt=0,i.mTextMetrics=new An,i}var i;return u()(t,e),o()(t,[{key:"reqTextMetrics",value:function(e){var t=this,i=e.text,n=e.font,r=e.shape_path,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.refreshSlides;if(i&&n&&r){var o=xn(i);i=o||i;var s=this.mTextMetrics.get(n,i)||o&&pn(n,o);if(s)return s;if("Unicode"!==n.fontFamily){var l=r.slideId,h=r.shapeId,u=this.mTextMetrics.getFontStr(n),c=this._req_tasks[u]=this._req_tasks[u]||{callback:a,text_list:[],slide:{},font:_()({},n,{fontSize:100})};c.slide[l]=c.slide[l]||[],c.slide[l].includes(h)||c.slide[l].push(h),c.text_list.includes(i)||c.text_list.push(i),clearTimeout(c.timer),c.timer=setTimeout((function(){c.text_list.length<2||(delete t._req_tasks[u],t._execReqTask(c))}),500)}}}},{key:"_execReqTask",value:(i=st()(regeneratorRuntime.mark((function e(t){var i,n,r,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._fail_task=this._fail_task||[],e.prev=2,e.next=5,hn(t.font);case 5:(i=e.sent)&&(n=t.text_list.length,t.text_list=t.text_list.filter((function(e){return!i.has(e)})),t.text_list.length<n&&t.callback&&t.callback(t.slide)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.warn(t.font," load Metrics fail",e.t0);case 12:if(e.prev=12,!(t.text_list.length>0&&window.__CONFIG__.wpp.enableShareFont)){e.next=20;break}return e.next=16,this._reqFontUser(t.font.fontFamily);case 16:return r=e.sent,e.next=19,this._fetchTextInfo(r,t);case 19:t.callback&&t.callback(t.slide);case 20:return e.finish(12);case 21:a=void 0,o=0;case 23:if(!(o<this._fail_task.length)){e.next=31;break}if((s=this._fail_task[o]).font.fontFamily!==t.font.fontFamily){e.next=28;break}return a=s,e.abrupt("break",31);case 28:o++,e.next=23;break;case 31:this._fail_task.remove(a),a&&this._execReqTask(a),e.next=39;break;case 35:e.prev=35,e.t1=e.catch(0),console.warn("fetch info timeout"),this._fail_task.push(t);case 39:case"end":return e.stop()}}),e,this,[[0,35],[2,9,12,21]])}))),function(e){return i.apply(this,arguments)})},{key:"_getFontInfo",value:function(e,t){var i=this.wppTextMeasurer.calcMetrics(e,t,!0);return _()({},i)}},{key:"_isOnlineUser",value:function(e){for(var t=this.users,i=0;i<t.length;i++)if(t[i].indexOf(e)>0)return!0;return!1}},{key:"_hasFont",value:function(e){return this.wppTextMeasurer.isLocalFont(e)}},{key:"_recvFontUser",value:function(e){var t=this,i=e.data,n=i&&i.fontList;n&&n.forEach((function(n){t._fontUserCache[n]=t._fontUserCache[n]||[],t._fontUserCache[n].push(i.user_id),t.fire(n,e),clearTimeout(t._req_timers[n])}))}},{key:"_reqFontUser",value:function(e){var t=this;return new Promise((function(i,n){var r=t._findOnlineUserByFont(e);if(r)setTimeout((function(){i(r)}),t.random);else{var a=e;t.once(a,(function(n){var r=n.data;t._notFontList.remove(e),setTimeout((function(){i(r.user_id)}),t.random)})),t._notFontList.includes(e)||(t._notFontList.push(e),t._onUserOnlineChange())}}))}},{key:"_onSendFontUser",value:function(e){var t=this,i=e.data;if(this._hasFont(i.fontFamily)){var n=this.addLocalFont(i.fontFamily);this._req_timers[i.fontFamily]=setTimeout((function(){t.sendBroadcast({type:En,data:{fontList:[].concat(S()(n)),user_id:t.userId}})}),this.random)}else this._notFontList.remove(i.fontFamily)}},{key:"addLocalFont",value:function(e){var t=this._localFontList=this._localFontList||[];return!t.includes(e)&&t.push(e),t}},{key:"_fetchTextInfo",value:function(e,t){var i=this,n=t.font,r=t.text_list;return new Promise((function(t,a){for(var o=[],s=0;s<r.length;s++){var l=r[s];i.mTextMetrics.get(n,l)||o.push(l)}if((r=o).length){var h=i.genSeqNum();i.sendBroadcast({data:{recv_user_id:e,font:n,text_list:r,seq_num:h},type:Rn});var u=function(e){var i=e.data;t(i)};i.once(h,u),setTimeout((function(){i.off(h,u),a(!1)}),5e3)}else t()}))}},{key:"_onSendFontInfo",value:function(e){var t=this,i=e.data,n=i.text_list,r=i.font,a=i.seq_num,o=[];this._hasFont(r.fontFamily)&&new ht.a(n,(function(e){var i=t._getFontInfo(e,r),n=i.height,a=i.width;o.push({t:e,m:[a,n]})}),this.random).then((function(){t.sendBroadcast({data:{font:r,seq_num:a,text_info:o},type:Pn})}))}},{key:"_recvTextInfo",value:function(e){var t=e.data,i=t.text_info,n=t.seq_num,r=t.font;this.mTextMetrics.set(r,i),this.fire(n,e)}},{key:"sendBroadcast",value:function(e){console.log(this.userId,"send fontInfo:",e),window.APP.sendBroadcast(e)}},{key:"genSeqNum",value:function(){return In++}},{key:"doc",get:function(){return window.APP.shell.doc}},{key:"userId",get:function(){return this.doc.selection.getConnId().substr(20)}},{key:"random",get:function(){return Math.round(1500*Math.random())}},{key:"users",get:function(){return Object.keys(this.selections)}},{key:"selections",get:function(){return this.doc.selectionsMgr.selections}}]),t}(x.a),An=function(){function e(){r()(this,e),this._cache={},this._load()}return o()(e,[{key:"getFontStr",value:function(e){return Object(ht.b)(e.fontFamily+", "+e.fontWeight)}},{key:"set",value:function(e,t){var i=this.getFontStr(e),n=this._cache[i]=this._cache[i]||{};t.forEach((function(e){var t=e.t,i=e.m;n[Object(ht.b)(t)]=i})),n[this.time_key]=this.now(),this.save()}},{key:"get",value:function(e,t){var i=this.getFontStr(e),n=this._cache[i],r=void 0;if(n){var a=n[Object(ht.b)(t)];if(a){r={width:a[0],height:a[1]};var o=e.fontSize/100;Object.keys(r).forEach((function(e){r[e]*=o}))}n[this.time_key]=this.now()}return r}},{key:"_load",value:function(){var e=this.store;this._cache=JSON.parse(e&&e.getItem(this.store_key))||{}}},{key:"now",value:function(){return parseInt(Date.now()/1e3)}},{key:"save",value:function(){var e=this,t=Object.keys(this._cache);if(t.length>100){var i=this.now(),n=void 0;t.forEach((function(t){var r=e._cache[t];r[e.time_key]<i&&(i=r[e.time_key],n=t)})),delete this._cache[n]}var r=this.store;r&&r.setItem(this.store_key,JSON.stringify(this._cache))}},{key:"store",get:function(){return window.localStorage&&window.localStorage}},{key:"store_key",get:function(){return"font_infos_"}},{key:"time_key",get:function(){return"utime"}}]),e}(),Bn=i(4952),Dn=i.n(Bn),Mn=i(1708),On="宋体",Nn="SimSun",Fn="仿宋",Vn="FangSong",Un="楷体",Gn="KaiTi",Hn="黑体",Wn="SimHei",jn="等线",Yn="微软雅黑",zn="Microsoft YaHei",Kn="汉仪书宋二KW",qn="汉仪仿宋KW",Xn="汉仪楷体KW",Jn="汉仪中黑KW",Zn="汉仪中等线KW",Qn="汉仪旗黑KW 55S",$n="华文楷体",er="楷体-简",tr=(kn={},d()(kn,On,Kn),d()(kn,Nn,Kn),d()(kn,Fn,qn),d()(kn,Vn,qn),d()(kn,Un,Xn),d()(kn,Gn,Xn),d()(kn,Hn,Jn),d()(kn,Wn,Jn),d()(kn,jn,Zn),d()(kn,Yn,Qn),d()(kn,zn,Qn),d()(kn,Kn,Kn),d()(kn,qn,qn),d()(kn,Xn,Xn),d()(kn,Jn,Jn),d()(kn,Zn,Zn),d()(kn,Qn,Qn),kn),ir={},nr=tr,rr={},ar=function(){function e(){var t=this;r()(this,e),this.getFontFamilyType=function(e){if("string"!=typeof e)return sr.None;if(!t._defaultFont){var i=(document.documentElement.currentStyle?document.documentElement.currentStyle:window.getComputedStyle(document.documentElement,!1)).fontFamily;t._defaultFont=t.getUniformFont(i);var n=t._supportFontMap;switch(t._defaultFont){case On:case Nn:n[On]=2,n[Nn]=2;break;case Fn:case Vn:n[Fn]=2,n[Vn]=2;break;case Un:case Gn:n[Un]=2,n[Gn]=2;break;case Hn:case Wn:n[Hn]=2,n[Wn]=2;break;case jn:n[jn]=2;break;case Yn:case zn:n[Yn]=2,n[zn]=2;break;default:(v.userAgent.isIos||v.userAgent.isMacOs||v.userAgent.isIPad)&&(t._defaultFont="PingFang SC"),n[t._defaultFont]=2}}var r=t._supportFontMap[e];if(!Object.isEmpty(r))return r;if(r=t._supportFontMap[e.toLocaleLowerCase()],!Object.isEmpty(r))return r;var a=t._defaultFont,o=t.getMeasureCtx(),s=t._canvas;s.width=24,s.height=16,o.textAlign="center",o.fillStyle="black",o.textBaseline="middle";var l=function(e){o.clearRect(0,0,24,16),o.font='12px "'+e+'","'+a+'"';var i=o.measureText("i十");if(t._defaultMetric){if(t._defaultMetric.width!==i.width||t._defaultMetric.actualBoundingBoxDescent!==i.actualBoundingBoxDescent||t._defaultMetric.actualBoundingBoxAscent!==i.actualBoundingBoxAscent)return[]}else t._defaultMetric=i;o.fillText("i十",12,8);var n=o.getImageData(0,0,24,16).data;return[].slice.call(n).filter((function(e){return 0!==e}))};t._defaultFontData=t._defaultFontData||l(a).join("");var h=l(e);return t._supportFontMap[e]=t._defaultFontData===h.join("")?sr.None:sr.Local,t._supportFontMap[e]},this.loadingFontsCache=[],this._serverFontMap=null,this._loadFontTask={}}var t,i;return o()(e,[{key:"revertFontfamily",value:function(e){return e?(e=this.getUniformFont(e),ir[e]||(ir[e]=e,nr[e]||(-1!==e.indexOf(Un)?this.isLocalFont($n)||this.isLocalFont(er)||this.isLocalFont(e)||(ir[e]=Un):-1===e.indexOf(Yn)&&-1===e.indexOf(zn)||this.isLocalFont(e)||(ir[e]=Yn))),ir[e]):e}},{key:"covertFontfamily",value:function(e){e=this.revertFontfamily(e);var t=nr[e];return!t||t===e||this.isLocalFont(e)?""+e:""+t}},{key:"getFileFontlist",value:function(){return ir}},{key:"initFontServerPrefix",value:function(e){if(e){var t=e.lastIndexOf("/");return this._fontServerUrlPrefix=e.substring(0,t),this._fontServerUrlPrefix}}},{key:"startLoadServerFontList",value:function(e){return new Promise((function(t,i){var n={};window.__WPSENV__.reduxDispatch(e).then((function(e){if(e.error)i(e.error);else{for(var r=e.response.body,a=0;a<r.length;a++){var o=r[a];n[o.name]=o}t(n)}}))}))}},{key:"loadFontMap",value:(i=st()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._serverFontMap){e.next=5;break}return this.initFontServerPrefix(window.__CONFIG__.wps.cdnFontsJson),e.next=4,this.startLoadServerFontList(Object(Mn.a)());case 4:this._serverFontMap=e.sent;case 5:return e.abrupt("return",this._serverFontMap);case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"isSerFont",value:function(e){return!v.userAgent.isMobile&&(!!nr[e]||void 0)}},{key:"hasLoaded",value:function(e){return this._supportFontMap[e]===sr.Server||this._supportFontMap[e]===sr.Local}},{key:"loadFontStorage",value:function(){var e=this;return this._lazyStorage=this._lazyStorage||new Promise((function(t,i){Dn()((function(i){e._storage=new i.default,t(e._storage)}))})),this._lazyStorage}},{key:"loadFont",value:(t=st()(regeneratorRuntime.mark((function e(t){var i,n,r,a,o,s,l,h,u,c,d,p,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=nr[t])&&!this.hasLoaded(i)){e.next=3;break}return e.abrupt("return");case 3:if(!(n=this._loadFontTask[i]||{}).status){e.next=7;break}if(n.status===or.ERROR&&n.status!==or.NOT_FOND){e.next=7;break}return e.abrupt("return");case 7:if(e.t0=this._storage,e.t0){e.next=12;break}return e.next=11,this.loadFontStorage();case 11:e.t0=e.sent;case 12:return this._storage=e.t0,e.next=15,this._storage.isFontInStorage(i);case 15:if(r=e.sent,!(a=r.fontResData)||!a[0]){e.next=28;break}return o=window.URL.createObjectURL(a[0].data),s=new FontFace(i,"url("+o+")"),n.status=or.LOADING,e.next=23,s.load();case 23:return l=e.sent,document.fonts.add(l),this._supportFontMap[t]=sr.Server,this._supportFontMap[i]===sr.None&&(this._supportFontMap[i]=sr.Local),e.abrupt("return",i);case 28:return this._loadFontTask[i]=n,e.prev=29,n.status=or.WAITING,this._loadFontMap=this._loadFontMap||this.loadFontMap(),e.next=34,this._loadFontMap;case 34:if(this._serverFontMap=e.sent,h=this._serverFontMap[i]){e.next=41;break}return n.status=or.NOT_FOND,e.abrupt("return");case 41:if((u=h.faces[0])&&u.fn){e.next=45;break}return e.abrupt("return");case 45:return c=void 0,e.next=48,this._storage.addFont(h,this._fontServerUrlPrefix);case 48:if(!(d=e.sent)||!d[2]){e.next=61;break}if(!(p=d[2][0])){e.next=61;break}return c=window.URL.createObjectURL(p.data),f=new FontFace(i,"url("+c+")"),n.status=or.LOADING,e.next=57,f.load();case 57:g=e.sent,document.fonts.add(g),this._supportFontMap[t]=sr.Server,this._supportFontMap[i]===sr.None&&(this._supportFontMap[i]=sr.Local);case 61:return n.status=or.FINISH,e.abrupt("return",i);case 65:e.prev=65,e.t1=e.catch(29),console.error("loadFont",e.t1),n.status=or.ERROR;case 69:case"end":return e.stop()}}),e,this,[[29,65]])}))),function(e){return t.apply(this,arguments)})},{key:"initSupportFont",value:function(){this._usedFonts=new Set,this._supportFontMap={};var e=window.__WPSENV__.font_name_map;for(var t in e&&Object.keys(e).forEach((function(t){tr[t]=e[t]})),nr)rr[t.toLowerCase()]=t;for(var i in nr){i=this.getUniformFont(i);var n=this.getFontFamilyType(i);n&&(this._supportFontMap[i]=n)}}},{key:"getUniformFont",value:function(e){return"string"!=typeof e?"SimSun":('"'===e[0]&&(e=e.substring(1,e.length-1)),e.indexOf("(")&&(e=e.split("(")[0]),rr[e]||e)}},{key:"getMeasureCtx",value:function(){return this._canvas=this._canvas||document.createElement("canvas"),this._canvas.getContext("2d")}},{key:"isLocalFont",value:function(e){return this.getFontFamilyType(e)===sr.Local}}]),e}(),or={WAITING:"waiting",LOADING:"loading",FINISH:"finish",ERROR:"error",NOT_FOND:"not fond"},sr={Server:1,Local:2,None:0},lr=new ar;window.getFontFamilyType=lr.getFontFamilyType;var hr={9867:"PingFang SC",9542:"Arial",10943:"Arial Black",8365:"Arial Narrow",10140:"Arial Rounded MT Bold",9771:"Comic Sans MS",10201:"Courier New",9634:"Microsoft Sans Serif",9943:"Noto Nastaliq Urdu",9890:"Noto Sans Avestan,Noto Sans Myanmar ExtLt",9856:"Noto Sans Cham",10063:"Noto Sans Myanmar Blk",10034:"Noto Sans Myanmar ExtBd",9959:"Noto Sans Myanmar Med",9983:"Noto Sans Myanmar SemBd",9878:"Noto Sans Myanmar Thin",9776:"Noto Sans Oriya",9282:"Noto Sans Tai Le",10092:"Noto Sans Thaana",9612:"Noto Serif Kannada",10036:"Noto Serif Myanmar Blk",10037:"Noto Serif Myanmar ExtBd",10002:"Noto Serif Myanmar ExtLt",10011:"Noto Serif Myanmar Light",10030:"Noto Serif Myanmar Med",10038:"Noto Serif Myanmar SemBd",9996:"Noto Serif Myanmar Thin",10024:"Noto Serif Myanmar",10473:"Rockwell",9387:"Tahoma",9500:"Times New Roman,简宋",9583:"Trebuchet MS",9104:"Tw Cen MT",10406:"Verdana",10029:"华文仿宋",9451:"华文宋体",9464:"华文楷体,楷体-简",10857:"华文黑体",10521:"微軟正黑體",10836:"兰亭黑-简",10743:"儷黑 Pro",10185:"儷宋 Pro",9809:"蘋果儷細宋",9253:"蘋果儷中黑",9088:"手札体-简",9409:"宋体-简",9517:"魏碑-简,魏碑-繁",9840:"雅痞-简,雅痞-繁",9329:"圆体-简",10031:"標楷體",11209:"冬青黑体简体中文 W6",10618:"冬青黑体简体中文 W3,冬青黑体简体中文"},ur={10632:"Microsoft YaHei",9542:"Arial,Arial Narrow",10770:"Arial Black",9130:"Bahnschrift,Bahnschrift Light,Bahnschrift SemiBold",8260:"Bahnschrift Condensed,Bahnschrift SemiCondensed",9091:"Calibri",8960:"Calibri Light",9081:"Cambria,Cambria Math",9771:"Comic Sans MS",9598:"Consolas",9482:"Constantia",9263:"Corbel",10201:"Courier New",9453:"Ebrima,Gadugi,Leelawadee UI,Microsoft New Tai Lue,Microsoft PhagsPa,Myanmar Text,Segoe UI Emoji,Segoe UI Historic,Segoe UI Symbol",9356:"Franklin Gothic Heavy",9116:"Franklin Gothic Medium",7490:"Gabriola",9594:"Javanese Text",9902:"Kingsoft Math",10230:"Lucida Console",9811:"Lucida Sans Unicode",9574:"Malgun Gothic",7441:"Microsoft Himalaya",10211:"Microsoft JhengHei UI Light,微軟正黑體 Light",9898:"Microsoft JhengHei UI",9634:"Microsoft Sans Serif",10076:"Microsoft Tai Le",9684:"Microsoft YaHei UI Light,微软雅黑 Light",10009:"Microsoft YaHei UI",7606:"Microsoft Yi Baiti",9027:"Mongolian Baiti",9500:"MS Gothic,SimSun-ExtB,Times New Roman,仿宋,宋体,新宋体,楷体,細明體-ExtB,細明體_HKSCS-ExtB,黑体",8559:"MS PGothic,MS UI Gothic",9990:"MV Boli",9340:"Nirmala UI",10047:"Palatino Linotype",9017:"Segoe UI Light",9652:"Segoe UI Semibold",9409:"Segoe UI",8571:"Sitka Banner",9070:"Sitka Heading",10400:"Sitka Small",9402:"Sitka Subheading",9675:"Sylfaen",9522:"Tahoma",9436:"Trebuchet MS",10265:"Verdana",9023:"Yu Gothic Light",9564:"Yu Gothic Medium",8727:"Yu Gothic UI Light",9305:"Yu Gothic UI Semibold",8992:"Yu Gothic UI",9562:"Yu Gothic",10530:"华文新魏",10521:"微軟正黑體",9808:"新細明體-ExtB",9739:"汉仪中等线KW",10366:"汉仪中黑KW",9711:"汉仪书宋二KW",8991:"汉仪仿宋KW",10367:"汉仪楷体KW",9318:"等线",9188:"等线 Light"},cr={9557:"Arabic Transparent,Noto Kufi Arabic",9542:"Arial,Noto Sans Adlam",10140:"Arial Rounded MT Bold",10202:"Courier New",9695:"Georgia",9887:"Noto Nastaliq Urdu",9552:"Noto Sans Avestan",9668:"Noto Sans Cham",9030:"Noto Sans Mongolian",9792:"Noto Sans Oriya",8957:"Noto Sans Tai Le",10036:"Noto Sans Thaana",10474:"Rockwell",9437:"Trebuchet MS",10265:"Verdana",9867:"微軟正黑體,微软雅黑,黑体,苹方-简,苹方-繁,苹方-港"},dr={9557:"Arabic Transparent,Noto Kufi Arabic,Noto Naskh Arabic UI,Noto Naskh Arabic,Noto Sans Arabic Blk,Noto Sans Arabic Cond Blk,Noto Sans Arabic Cond ExtBd,Noto Sans Arabic Cond ExtLt,Noto Sans Arabic Cond Light,Noto Sans Arabic Cond Med,Noto Sans Arabic Cond SemBd,Noto Sans Arabic Cond Thin,Noto Sans Arabic Cond,Noto Sans Arabic ExtBd,Noto Sans Arabic ExtCond Blk,Noto Sans Arabic ExtCond ExtBd,Noto Sans Arabic ExtCond ExtLt,Noto Sans Arabic ExtCond Light,Noto Sans Arabic ExtCond Med,Noto Sans Arabic ExtCond SemBd,Noto Sans Arabic ExtCond Thin,Noto Sans Arabic ExtCond,Noto Sans Arabic ExtLt,Noto Sans Arabic Light,Noto Sans Arabic Med,Noto Sans Arabic SemBd,Noto Sans Arabic SemCond Blk,Noto Sans Arabic SemCond ExtBd,Noto Sans Arabic SemCond ExtLt,Noto Sans Arabic SemCond Light,Noto Sans Arabic SemCond Med,Noto Sans Arabic SemCond SemBd,Noto Sans Arabic SemCond Thin,Noto Sans Arabic SemCond,Noto Sans Arabic Thin,Noto Sans Arabic UI Bk,Noto Sans Arabic UI Cn Bk,Noto Sans Arabic UI Cn Lt,Noto Sans Arabic UI Cn Md,Noto Sans Arabic UI Cn SmBd,Noto Sans Arabic UI Cn Th,Noto Sans Arabic UI Cn XBd,Noto Sans Arabic UI Cn XLt,Noto Sans Arabic UI Cn,Noto Sans Arabic UI Lt,Noto Sans Arabic UI Md,Noto Sans Arabic UI SmBd,Noto Sans Arabic UI SmCn Bk,Noto Sans Arabic UI SmCn Lt,Noto Sans Arabic UI SmCn Md,Noto Sans Arabic UI SmCn SmBd,Noto Sans Arabic UI SmCn Th,Noto Sans Arabic UI SmCn XBd,Noto Sans Arabic UI SmCn XLt,Noto Sans Arabic UI SmCn,Noto Sans Arabic UI Th,Noto Sans Arabic UI XBd,Noto Sans Arabic UI XCn Bk,Noto Sans Arabic UI XCn Lt,Noto Sans Arabic UI XCn Md,Noto Sans Arabic UI XCn SmBd,Noto Sans Arabic UI XCn Th,Noto Sans Arabic UI XCn XBd,Noto Sans Arabic UI XCn XLt,Noto Sans Arabic UI XCn,Noto Sans Arabic UI XLt,Noto Sans Arabic UI,Noto Sans Arabic",9542:"Arial,Noto Sans Adlam,Noto Sans Armenian Light,Noto Sans Armenian,Noto Sans Bamum,Noto Sans Batak,Noto Sans Brahmi,Noto Sans Buginese,Noto Sans Buhid,Noto Sans Carian,Noto Sans Chakma,Noto Sans Coptic,Noto Sans Cuneiform,Noto Sans Cypriot,Noto Sans EgyptHiero,Noto Sans Glagolitic,Noto Sans Gothic,Noto Sans Hanunoo,Noto Sans ImpAramaic,Noto Sans InsPahlavi,Noto Sans InsParthi,Noto Sans Javanese,Noto Sans Kaithi,Noto Sans Kayah Li,Noto Sans Kharoshthi,Noto Sans Lepcha,Noto Sans Limbu,Noto Sans Linear B,Noto Sans Lisu,Noto Sans Lycian,Noto Sans Lydian,Noto Sans Mandaic,Noto Sans Meetei Mayek,Noto Sans NKo,Noto Sans NewTaiLue,Noto Sans Ogham,Noto Sans Ol Chiki,Noto Sans Old Italic,Noto Sans Old Turkic,Noto Sans OldPersian,Noto Sans OldSouArab,Noto Sans Osage,Noto Sans Osmanya,Noto Sans Phoenician,Noto Sans Rejang,Noto Sans Runic,Noto Sans Samaritan,Noto Sans Saurashtra,Noto Sans Shavian,Noto Sans Sundanese,Noto Sans Syloti Nagri,Noto Sans Tagalog,Noto Sans Tagbanwa,Noto Sans Tai Tham,Noto Sans Tai Viet,Noto Sans Tifinagh,Noto Sans Ugaritic,Noto Sans Vai,Noto Sans Yi",10140:"Arial Rounded MT Bold",10202:"Courier New",9695:"Georgia",9887:"Noto Nastaliq Urdu",9552:"Noto Sans Avestan",9668:"Noto Sans Cham",9030:"Noto Sans Mongolian",9792:"Noto Sans Oriya",8957:"Noto Sans Tai Le",10036:"Noto Sans Thaana",10474:"Rockwell",9579:"Symbol",9437:"Trebuchet MS",10265:"Verdana",9867:"微軟正黑體,微软雅黑,黑体,苹方-简,苹方-繁,苹方-港"},pr={7278:"sans-serif",8213:"Courier New",7967:"Georgia,Times New Roman"},fr=void 0,gr=void 0;var yr=void 0,vr=void 0,mr=v.userAgent.isFirefox?90:1e3,_r=function(){function e(t){r()(this,e),this.initCalcDom(),this.fontFamilyCache={},this.sameFFMap={},window.__CONFIG__.wpp.enableShareFont&&(this.shareTextMeasure=new Ln(this)),this.enableMatchFont=window.__CONFIG__.wpp.enableMatchFont,this.loaclFontMap={},lr.initSupportFont()}return o()(e,[{key:"measureChars",value:function(e,t,i,n,r,a){var o=this,s=n.span.pos,l=s+n.span.length;t.slice(s,l).forEach((function(t,i){var n=t.char,r=e.fontArg,a=o.calcMetrics(n,r);t.metrics=a}))}},{key:"initCalcDom",value:function(){yr?this.ruler=yr:(yr=this.ruler=document.createElement("div"),this.caliper=document.createElement("span"),this.vernier=document.createElement("div"),this.ruler.setAttribute("style","position: fixed;top: 0px;left: 0px;background: grey;display: block;z-index: -99;transform-origin: left top;transform: scale(0.01);line-height: normal;opacity: 0;"),this.vernier.setAttribute("style","display: inline-block; height: 1px; background: red; vertical-align: baseline;"),this.ruler.appendChild(this.caliper),this.ruler.appendChild(this.vernier),document.body.appendChild(this.ruler))}},{key:"createRuler",value:function(e,t){var i=document.createElement("div"),n=document.createElement("span"),r=document.createElement("div"),a=lr.covertFontfamily(e.fontFamily);return n.setAttribute("style","font-family: "+a+"; font-size: "+e.fontSize+"px;white-space: pre; font-weight: "+e.fontWeight+"; font-Style: "+e.fontStyle)," "===t?n.innerHTML="&nbsp":n.innerText=t,i.setAttribute("style","position: absolute;top: 0px;left: 0px;background: grey;display: block;transform-origin: left top;transform: scale(0.01);line-height: normal;"),r.setAttribute("style","vertical-align: baseline;display: inline-block; height: 1px; background: red;"),i.appendChild(n),i.appendChild(r),{ruler:i,vernier:r,caliper:n}}},{key:"calcMetrics",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=lr.getUniformFont(t.fontFamily),r=!1;"\r"!==e&&"\n"!==e&&"\v"!==e||(e=" ",n=n||"Arial",r=!0),t.fontFamily=n;var a=t.fontSize,o=1,s=this.isLocalFont(n),l=void 0,h=!1,u=void 0,c=void 0,d=void 0;if(s){var p=this.shareTextMeasure;p&&p.addLocalFont(t.fontFamily)}else n=lr.revertFontfamily(n),(h=this.loadServFont(n,l,t.dataPath))||(s=this.isLocalFont(n));if(!s||!v.userAgent.isWindows&&Tn(t)){var f=this.getShareMetris(e,t,!1);f&&(u=f.width,c=f.height);var g=this.getShareMetris("“",t,!1);g&&(d=g.width)}var y=void 0,m=this.enableMatchFont&&!s&&!h;m&&(n.includes(Un)&&(this.isLocalFont($n)?this.sameFFMap[n]=$n:this.isLocalFont(er)&&(this.sameFFMap[n]=er)),y=this.sameFFMap[n],t.fontFamily=y||t.fontFamily);var w=this.localMetrics(e,t,i);if(o=a/mr,m&&!y&&!r&&u){var S=u/o;if(d=d?d/o:0,S<.9*w.width){var x=this.findSameMetrics(e,t,S,d);console.log("************** sameFF",x.sameFF),x?(w=x.metrics,y=x.sameFF,this.sameFFMap[n]=y):(u=void 0,c=void 0)}}return(w=_()({ascent:0,descent:0,height:0,width:0},w))&&Object.keys(w).forEach((function(e){w[e]=Number((w[e]*o).toFixed(2))})),t.fontFamily.indexOf("Calibri")>-1&&!Sn(e)&&(w.width*=.99253),w.v_width=u,w.v_height=c,u&&"·"===e&&n===Yn&&(w.v_width=w.width),w}},{key:"findSameMetrics",value:function(e,t,i,n){var r=this,a=_()({},t),o=this.localMetrics('aowvAOWV,."“，。我',a,!0),s=1e3*o.width/mr,l=Tr(a.fontFamily),h=void 0,u=0,c=function(e,t){fr||(gr=ur,v.userAgent.isIPad?gr=cr:v.userAgent.isIphone?gr=dr:v.userAgent.isMacOs?gr=hr:v.userAgent.isMobile&&(gr=pr),fr=Object.keys(gr).sort((function(e,t){return e-t})).sort((function(e,t){return/[\u4e00-\u9fa5]+/g.test(gr[e])?-1:/[\u4e00-\u9fa5]+/g.test(gr[t])?1:-1})));for(var i=0;i<fr.length;i++)if(e>=+fr[i]){var n=gr[fr[i]];if(t){var r=t(n);if(r)return r}}}(s,(function(t){var s=t.split(",").filter((function(e){return r.isLocalFont(e)}));s.length>1&&l&&Tr(t)&&(s=s.sort((function(e,t){return Tr(t)?1:-1})));for(var c=0;c<s.length;c++){a.fontFamily=s[c];var d=r.localMetrics(e,a,!0),p=r.localMetrics("“",a,!0);if((!u||p.width<u)&&(h=a.fontFamily,u=p.width,o=d),d.width<=i){if(p&&n&&.9*p.width>=n)continue;return o=d,a.fontFamily}}}))||h;if(c)return{metrics:o,sameFF:c}}},{key:"localMetrics",value:function(e,t,i){var n=t.fontFamily;n=lr.revertFontfamily(n);var r=_()({},t,{fontFamily:n}),a=Sr.get(r,e);if(a)return a;try{this.caliper.innerText=e,n=lr.covertFontfamily(t.fontFamily),"·"===e&&n===Qn&&n!==t.fontFamily&&(n=t.fontFamily),this.caliper.setAttribute("style",'font-family: "'+n+'"; font-size: '+mr+"px;white-space: pre; font-weight: "+t.fontWeight+"; font-Style: "+t.fontStyle);var o=this.vernier.offsetTop,s=this.caliper,l=s.offsetTop,h=s.offsetHeight,u=s.offsetWidth,c=o-l,d=1*h,p=d-(c*=1.04),f=1*u,g=void 0;("normal"!==t.fontWeight&&Sn(e)||"Impact"===n)&&(this.caliper.setAttribute("style",'font-family: "'+n+'"; font-size: '+mr+"px;white-space: pre; font-weight: normal; font-Style: "+t.fontStyle),g=this.caliper.offsetWidth),g&&(f=g+1/3*(f-g)),a={width:Number(f.toFixed(2)),height:Number(d.toFixed(2)),descent:Number(p.toFixed(2)),ascent:Number(c.toFixed(2))}}finally{i&&Sr.add(r,e,a)}return a}},{key:"loadServFont",value:function(e,t,i){if(lr.isSerFont(e)){if(!lr.hasLoaded(e)&&xr.add(e,t,i)){var n=e;lr.loadFont(e).then((function(e){if(e){var t=xr.get(n).renderArr,i=void 0===t?[]:t;Sr.clear(n);for(var r=0;r<i.length;r++)window.SlidePool.getInstance().reRender(i[r]);xr.clear(n)}})).catch((function(e){console.warn(e)}))}return!0}return!1}},{key:"getShareMetris",value:function(e,t,i){if(this.shareTextMeasure)if(i)this.shareTextMeasure.addLocalFont(t.fontFamily);else{var n=this.shareTextMeasure.reqTextMetrics({text:e,font:t,shape_path:t.dataPath});if(n)return n}}},{key:"isLocalFont",value:function(e){return void 0===this.loaclFontMap[e]&&(this.loaclFontMap[e]="Unicode"===e||lr.isLocalFont(e)),this.loaclFontMap[e]}}],[{key:"getInstance",value:function(){return vr=vr||new e}}]),e}();function wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",t=arguments[1],i=arguments[2],n=_r.getInstance();return n.calcMetrics(e,t,i)}var Sr={add:function(e,t,i){this._cache(e)[t]=i},get:function(e,t){return this._cache(e)[t]},_cache:function(e){var t=this.__cache=this.__cache||{},i=t[e.fontFamily]=t[e.fontFamily]||{},n=("bold"===e.fontWeight?"b":"")+("normal"!==e.fontStyle?"i":"")||"n";return i[n]=i[n]||{}},clear:function(e){this.__cache&&(this.__cache[e]=null)}},xr={add:function(e){var t=arguments[2];if(t){var i=t.slideId,n=t.shapeId;this._fontCache=this._fontCache||{};var r=this._fontCache[e],a=this._fontCache[e]=this._fontCache[e]||{},o=a;return o[i]=o[i]||[],o[i].includes(n)?!1:(o[i].push(n),void 0===r)}},get:function(e){var t=this._fontCache[e],i=[];for(var n in t)i.push({slideId:parseInt(n),shapeIds:t[n],type:"hasShapeReview"});return{renderArr:i}},clear:function(e){this._fontCache&&(this._fontCache[e]=void 0)}};function Tr(e){return/[\u4e00-\u9fa5]+/g.test(e)}var kr=11,Cr=13,br=12,Er=15,Rr=14,Pr=2,Ir=5,Lr=8,Ar=1,Br=9,Dr=32,Mr=19,Or=20,Nr=40,Fr=7,Vr=3,Ur=4,Gr=26,Hr=27,Wr=12288,jr=160,Yr=8205,zr=function(e){var t=0,i=JSON.parse(JSON.stringify(e));for(var n in i){var r=i[n];i[n]="number"==typeof r?r:t,t++}return Object.freeze(i),i},Kr=function(e){return e.codePointAt()},qr=function(e){for(var t=[],i=0;i<e.length;i++)t.push(Kr(e[i]));return t},Xr=qr("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Jr=qr("0123456789"),Zr=qr('([{·‘“〈《「『【〔〖（．［｛￡￥"!),.:;?]}¨·ˇˉ―‖’”…∶、。〃々〉》」』】〕〗！＂＇），．：；？］｀｜｝～￠'),Qr=[11,13,15,12,14,2,5,8,1,9,32,19,20,21,40,12288,160,0,0],$r=zr({CC_Ascii:null,CC_FarEast:null,CC_NoFarEast:null,CC_Shared:null,CC_Complex:null}),ea=zr({SC_Ascii:$r.CC_Ascii,SC_FarEast:$r.CC_FarEast,SC_NoFarEast:$r.CC_NoFarEast,SC_Shared:$r.CC_Shared,SC_Complex:$r.CC_Complex,__SC_SomeShared__:null,__SC_Unknown__:null,__SC_Undefine__:null}),ta=zr({usrBasicLatin:null,usrLatin1:null,usrLatinXA:null,usrLatinXB:null,usrIPAExtensions:null,usrSpacingModLetters:null,usrCombDiacritical:null,usrBasicGreek:null,usrGreekSymbolsCop:null,usrCyrillic:null,usrCyrillic2:null,usrArmenian:null,usrHebrewXA:null,usrBasicHebrew:null,usrBasicArabic:null,usrArabicX:null,usrSyriac:null,usrArabicSupplement:null,usrThaana:null,usrDevangari:null,usrBengali:null,usrGurmukhi:null,usrGujarati:null,usrOriya:null,usrTamil:null,usrTelugu:null,usrKannada:null,usrMalayalam:null,usrCeylon:null,usrThai:null,usrLao:null,usrTibet:null,usrBurma:null,usrGeorgianExtended:null,usrBasicGeorgian:null,usrHangulJamo:null,usrEthiopia:null,usrCherokee:null,usrJLDTZPY:null,usrOGZM:null,usrAncientryNorthEurope:null,usrTJL:null,usrHanunoo:null,usrBuhid:null,usrTagbanwa:null,usrCambodia:null,usrMongolia:null,usrLatinExtendedAdd:null,usrGreekExtended:null,usrGeneralPunct:null,usrSuperAndSubscript:null,usrCurrencySymbols:null,usrCombDiacriticsS:null,usrLetterlikeSymbols:null,usrNumberForms:null,usrArrows:null,usrMathematicalOps:null,usrMiscTechnical:null,usrControlPictures:null,usrOpticalCharRecog:null,usrEnclosedAlphanum:null,usrBoxDrawing:null,usrBlockElements:null,usrGeometricShapes:null,usrMiscDingbats:null,usrDingbats:null,usrMiscMathSymbolsA:null,usrArrowsA:null,usrBraillePatterns:null,usrArrowsB:null,usrMiscMathSymbolsB:null,usrMathematicalOps1:null,usrCJKRadicals1:null,usrKangxiRadicals:null,usrIdeographicDescription:null,usrCJKSymAndPunct:null,usrHiragana:null,usrKatakana:null,usrBopomofo:null,usrHangulCompatJamo:null,usrCJKMisc:null,__usrUnnamed10:null,__usrUnnamed11:null,usrEnclosedCJKLtMnth:null,usrCJKCompatibility:null,usrCJKUnifiedIdeoExtendedA:null,usrCJKUnifiedIdeo:null,__usrUnnamed13:null,__usrUnnamed14:null,usrHangul:null,usrHighSurrogates:null,__usrUnnamed16:null,usrLowSurrogates:null,usrPrivateUseArea:null,usrCJKCompatibilityIdeographs:null,usrAlphaPresentationForms:null,usrArabicPresentationFormsA:null,__usrUnnamed18:null,usrCombiningHalfMarks:null,usrCJKCompatForms:null,usrSmallFormVariants:null,usrArabicPresentationFormsB:null,usrHFWidthForms:null,usrSpecials:null,usrLinearBSyllabary:null,usrLinearBIdeograms:null,usrAegeanNumbers:null,usrAncientGreekNumbers:null,__usrUnnamed19:null,usrOldItalic:null,usrGothic:null,__usrUnnamed20:null,usrUgaritic:null,usrOldPersian:null,__usrUnnamed21:null,usrDeseret:null,usrShavian:null,usrOsmanya:null,__usrUnnamed22:null,usrCypriotSyllabary:null,__usrUnnamed23:null,usrPhoenician:null,__usrUnnamed24:null,usrKharoshthi:null,__usrUnnamed25:null,usrCuneiform:null,__usrUnnamed26:null,usrCuneiformNumbersAndPunctuation:null,__usrUnnamed27:null,usrByzantineMusicalSymbols:null,usrMusicalSymbols:null,usrAncientGreekMusicalNotation:null,__usrUnnamed28:null,usrTaiXuanJingSymbols:null,usrCountingRodNumerals:null,__usrUnnamed29:null,usrMathematicalAlphanumericSymbols:null,__usrUnnamed30:null,usrCJKUnifiedIdeographsExtensionB:null,__usrUnnamed31:null,usrCJKCompatibilityIdeographsSupplement:null,__usrUnnamed32:null,usrTags:null,__usrUnnamed33:null,usrSupplementaryPrivateUseAreaA:null,usrSupplementaryPrivateUseAreaB:null,usrError:4294967295}),ia=function(){function e(){r()(this,e);var t=ea.SC_Ascii,i=ea.SC_FarEast,n=ea.SC_NoFarEast,a=ea.SC_Shared,o=ea.SC_Complex,s=ea.__SC_SomeShared__,l=ea.__SC_Unknown__;ea.__SC_Undefine__;this.TxUsrTable=[this.createTxUsrItem(ta.usrBasicLatin,0,127,t),this.createTxUsrItem(ta.usrLatin1,128,255,s),this.createTxUsrItem(ta.usrLatinXA,256,383,s),this.createTxUsrItem(ta.usrLatinXB,384,591,s),this.createTxUsrItem(ta.usrIPAExtensions,592,687,s),this.createTxUsrItem(ta.usrSpacingModLetters,688,767,a),this.createTxUsrItem(ta.usrCombDiacritical,768,879,a),this.createTxUsrItem(ta.usrBasicGreek,880,975,a),this.createTxUsrItem(ta.usrGreekSymbolsCop,976,1023,n),this.createTxUsrItem(ta.usrCyrillic,1024,1279,a),this.createTxUsrItem(ta.usrCyrillic2,1280,1327,n),this.createTxUsrItem(ta.usrArmenian,1328,1423,n),this.createTxUsrItem(ta.usrHebrewXA,1424,1487,o),this.createTxUsrItem(ta.usrBasicHebrew,1488,1535,o),this.createTxUsrItem(ta.usrBasicArabic,1536,1618,o),this.createTxUsrItem(ta.usrArabicX,1619,1791,o),this.createTxUsrItem(ta.usrSyriac,1792,1871,o),this.createTxUsrItem(ta.usrArabicSupplement,1872,1919,o),this.createTxUsrItem(ta.usrThaana,1920,1983,o),this.createTxUsrItem(ta.usrDevangari,2304,2431,o),this.createTxUsrItem(ta.usrBengali,2432,2559,o),this.createTxUsrItem(ta.usrGurmukhi,2560,2687,o),this.createTxUsrItem(ta.usrGujarati,2688,2815,o),this.createTxUsrItem(ta.usrOriya,2816,2943,o),this.createTxUsrItem(ta.usrTamil,2944,3071,o),this.createTxUsrItem(ta.usrTelugu,3072,3199,o),this.createTxUsrItem(ta.usrKannada,3200,3327,o),this.createTxUsrItem(ta.usrMalayalam,3328,3455,o),this.createTxUsrItem(ta.usrThai,3584,3711,o),this.createTxUsrItem(ta.usrLao,3712,3839,o),this.createTxUsrItem(ta.usrTibet,3840,4095,o),this.createTxUsrItem(ta.usrBurma,4096,4255,o),this.createTxUsrItem(ta.usrGeorgianExtended,4256,4303,n),this.createTxUsrItem(ta.usrBasicGeorgian,4304,4351,n),this.createTxUsrItem(ta.usrHangulJamo,4352,4607,n),this.createTxUsrItem(ta.usrEthiopia,4608,4991,n),this.createTxUsrItem(ta.usrCherokee,5024,5119,n),this.createTxUsrItem(ta.usrJLDTZPY,5120,5759,n),this.createTxUsrItem(ta.usrOGZM,5760,5791,n),this.createTxUsrItem(ta.usrAncientryNorthEurope,5792,5887,n),this.createTxUsrItem(ta.usrTJL,5888,5919,n),this.createTxUsrItem(ta.usrHanunoo,5920,5951,n),this.createTxUsrItem(ta.usrBuhid,5952,5983,o),this.createTxUsrItem(ta.usrTagbanwa,5984,6015,o),this.createTxUsrItem(ta.usrCambodia,6016,6143,o),this.createTxUsrItem(ta.usrMongolia,6144,6319,o),this.createTxUsrItem(ta.usrLatinExtendedAdd,7680,7935,a),this.createTxUsrItem(ta.usrGreekExtended,7936,8191,n),this.createTxUsrItem(ta.usrGeneralPunct,8192,8303,a),this.createTxUsrItem(ta.usrSuperAndSubscript,8304,8351,a),this.createTxUsrItem(ta.usrCurrencySymbols,8352,8399,a),this.createTxUsrItem(ta.usrCombDiacriticsS,8400,8447,a),this.createTxUsrItem(ta.usrLetterlikeSymbols,8448,8527,a),this.createTxUsrItem(ta.usrNumberForms,8528,8591,a),this.createTxUsrItem(ta.usrArrows,8592,8703,a),this.createTxUsrItem(ta.usrMathematicalOps,8704,8959,a),this.createTxUsrItem(ta.usrMiscTechnical,8960,9215,a),this.createTxUsrItem(ta.usrControlPictures,9216,9279,a),this.createTxUsrItem(ta.usrOpticalCharRecog,9280,9311,a),this.createTxUsrItem(ta.usrEnclosedAlphanum,9312,9471,a),this.createTxUsrItem(ta.usrBoxDrawing,9472,9599,a),this.createTxUsrItem(ta.usrBlockElements,9600,9631,a),this.createTxUsrItem(ta.usrGeometricShapes,9632,9727,a),this.createTxUsrItem(ta.usrMiscDingbats,9728,9983,a),this.createTxUsrItem(ta.usrDingbats,9984,10175,a),this.createTxUsrItem(ta.usrMiscMathSymbolsA,10176,10223,a),this.createTxUsrItem(ta.usrArrowsA,10224,10239,a),this.createTxUsrItem(ta.usrBraillePatterns,10240,10495,a),this.createTxUsrItem(ta.usrArrowsB,10496,10623,a),this.createTxUsrItem(ta.usrMiscMathSymbolsB,10624,10751,a),this.createTxUsrItem(ta.usrMathematicalOps1,10752,11007,a),this.createTxUsrItem(ta.usrCJKRadicals1,11904,12031,i),this.createTxUsrItem(ta.usrKangxiRadicals,12032,12255,i),this.createTxUsrItem(ta.usrIdeographicDescription,12272,12287,i),this.createTxUsrItem(ta.usrCJKSymAndPunct,12288,12351,i),this.createTxUsrItem(ta.usrHiragana,12352,12447,i),this.createTxUsrItem(ta.usrKatakana,12448,12543,i),this.createTxUsrItem(ta.usrBopomofo,12544,12591,i),this.createTxUsrItem(ta.usrHangulCompatJamo,12592,12687,i),this.createTxUsrItem(ta.usrCJKMisc,12688,12703,i),this.createTxUsrItem(ta.__usrUnnamed10,12704,12735,l),this.createTxUsrItem(ta.__usrUnnamed11,12784,12799,l),this.createTxUsrItem(ta.usrEnclosedCJKLtMnth,12800,13055,i),this.createTxUsrItem(ta.usrCJKCompatibility,13056,13311,i),this.createTxUsrItem(ta.usrCJKUnifiedIdeoExtendedA,13312,19903,i),this.createTxUsrItem(ta.usrCJKUnifiedIdeo,19968,40959,i),this.createTxUsrItem(ta.__usrUnnamed13,40960,42127,l),this.createTxUsrItem(ta.__usrUnnamed14,42128,42191,l),this.createTxUsrItem(ta.usrHangul,44032,55203,i),this.createTxUsrItem(ta.usrHighSurrogates,55296,56191,i),this.createTxUsrItem(ta.__usrUnnamed16,56192,56319,i),this.createTxUsrItem(ta.usrLowSurrogates,56320,57343,i),this.createTxUsrItem(ta.usrPrivateUseArea,57344,63743,a),this.createTxUsrItem(ta.usrCJKCompatibilityIdeographs,63744,64255,i),this.createTxUsrItem(ta.usrAlphaPresentationForms,64256,64335,a),this.createTxUsrItem(ta.usrArabicPresentationFormsA,64336,65023,a),this.createTxUsrItem(ta.__usrUnnamed18,65024,65039,l),this.createTxUsrItem(ta.usrCombiningHalfMarks,65056,65071,i),this.createTxUsrItem(ta.usrCJKCompatForms,65072,65103,i),this.createTxUsrItem(ta.usrSmallFormVariants,65104,65135,i),this.createTxUsrItem(ta.usrArabicPresentationFormsB,65136,65278,a),this.createTxUsrItem(ta.usrHFWidthForms,65280,65519,i),this.createTxUsrItem(ta.usrSpecials,65520,65535,n),this.createTxUsrItem(ta.usrLinearBSyllabary,65536,65663,n),this.createTxUsrItem(ta.usrLinearBIdeograms,65664,65791,n),this.createTxUsrItem(ta.usrAegeanNumbers,65792,65855,n),this.createTxUsrItem(ta.usrAncientGreekNumbers,65856,65935,n),this.createTxUsrItem(ta.__usrUnnamed19,65936,66303,l),this.createTxUsrItem(ta.usrOldItalic,66304,66351,n),this.createTxUsrItem(ta.usrGothic,66352,66383,n),this.createTxUsrItem(ta.__usrUnnamed20,66384,66431,l),this.createTxUsrItem(ta.usrUgaritic,66432,66463,n),this.createTxUsrItem(ta.usrOldPersian,66464,66527,n),this.createTxUsrItem(ta.__usrUnnamed21,66528,66559,l),this.createTxUsrItem(ta.usrDeseret,66560,66639,n),this.createTxUsrItem(ta.usrShavian,66640,66687,n),this.createTxUsrItem(ta.usrOsmanya,66688,66735,n),this.createTxUsrItem(ta.__usrUnnamed22,66736,67583,l),this.createTxUsrItem(ta.usrCypriotSyllabary,67584,67647,n),this.createTxUsrItem(ta.__usrUnnamed23,67648,67839,l),this.createTxUsrItem(ta.usrPhoenician,67840,67871,n),this.createTxUsrItem(ta.__usrUnnamed24,67872,68095,l),this.createTxUsrItem(ta.usrKharoshthi,68096,68191,n),this.createTxUsrItem(ta.__usrUnnamed25,68192,73727,l),this.createTxUsrItem(ta.usrCuneiform,73728,73983,n),this.createTxUsrItem(ta.__usrUnnamed26,73984,74751,l),this.createTxUsrItem(ta.usrCuneiformNumbersAndPunctuation,74752,74879,n),this.createTxUsrItem(ta.__usrUnnamed27,74880,118783,l),this.createTxUsrItem(ta.usrByzantineMusicalSymbols,118784,119039,n),this.createTxUsrItem(ta.usrMusicalSymbols,119040,119295,n),this.createTxUsrItem(ta.usrAncientGreekMusicalNotation,119296,119375,n),this.createTxUsrItem(ta.__usrUnnamed28,119376,119551,l),this.createTxUsrItem(ta.usrTaiXuanJingSymbols,119552,119647,i),this.createTxUsrItem(ta.usrCountingRodNumerals,119648,119679,i),this.createTxUsrItem(ta.__usrUnnamed29,119680,119807,l),this.createTxUsrItem(ta.usrMathematicalAlphanumericSymbols,119808,120831,n),this.createTxUsrItem(ta.__usrUnnamed30,120832,131071,l),this.createTxUsrItem(ta.usrCJKUnifiedIdeographsExtensionB,131072,173791,i),this.createTxUsrItem(ta.__usrUnnamed31,173792,194559,l),this.createTxUsrItem(ta.usrCJKCompatibilityIdeographsSupplement,194560,195103,i),this.createTxUsrItem(ta.__usrUnnamed32,195104,917503,l),this.createTxUsrItem(ta.usrTags,917504,917631,n),this.createTxUsrItem(ta.__usrUnnamed33,917632,983039,l),this.createTxUsrItem(ta.usrSupplementaryPrivateUseAreaA,983040,1048573,n),this.createTxUsrItem(ta.usrSupplementaryPrivateUseAreaB,1048576,1114109,n)];var h=$r.CC_Shared,u=$r.CC_NoFarEast;this.SomeSharedCharsTable=[u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,h,u,u,h,h,u,h,u,u,h,u,h,h,h,h,h,h,u,h,h,h,h,h,u,h,h,h,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,h,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,h,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,h,h,h,h,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,h,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u]}return o()(e,[{key:"createTxUsrItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{nType:e,chFrom:t,chTo:i,nClass:n}}},{key:"checkUsrTable",value:function(e,t){var i=e,n=e+1;do{var r=this.TxUsrTable[i],a=this.TxUsrTable[n];if(r.chTo<=r.chFrom||a.chFrom<=r.chTo)return!1;i=n,n++}while(n!==t-1);return!0}}]),e}(),na=function(){function e(){r()(this,e),this.TxUsrTable=new ia}return o()(e,[{key:"_isHighSurrogate",value:function(e){return e>=55296&&e<=56191}},{key:"_isLowSurrogate",value:function(e){return e>=56320&&e<=57343}},{key:"_surrogate2Unic4",value:function(e,t){var i=0;return this._isHighSurrogate(e)&&this._isLowSurrogate(t)&&(i=1024*(e-55296)+65536+(t-56320)),i}},{key:"_unic42LoSurrogate",value:function(e){var t=0;return e>65536&&(t=56320+(e-65536)%1024),t}},{key:"_unic42HiSurrogate",value:function(e){var t=0;return e>65536&&(t=55296+(e-65536)/1024),t}},{key:"_getUsrItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.TxUsrTable,n=i.TxUsrTable,r=i.checkUsrTable,a=i.createTxUsrItem,o=0,s=n.length,l=r.bind(this.TxUsrTable,o,s);if(l){var h=0;h=this._isHighSurrogate(t)&&this._isLowSurrogate(e)?this._surrogate2Unic4(t,e):e;var u=a.bind(this.TxUsrTable);u.chTo=h;var c=function(e,t,i,n,r){if(t>i||n>e[i])return-1;for(var a=Math.floor((t+i)/2);t<i;)r(a,e,n)?i=a:t=a+1,a=Math.floor((t+i)/2);return a}(n,o,s,u,(function(e,t,i){return t[e].chTo>=i.chTo}));return-1===c?null:n[c]}}},{key:"getCharClass",value:function(e){var t=this.TxUsrTable.SomeSharedCharsTable,i=String.fromCharCode(e),n=this._getUsrItem(e);return n?n.nClass!==ea.__SC_SomeShared__?n.nClass:n.nClass===ea.__SC_Unknown__?(console.error('----\x3e 字符"'+i+'"(0x'+e+")所属UnicodeSubrange的CharClass属性为Unknown!"),$r.CC_Ascii):e-128<t.length?t[e-128]:void console.error('---\x3e 字符"'+i+'"(0x'+e+")无法找到所属的Unicode Subrange"):(console.error('---\x3e 字符"'+i+'"(0x'+e+")未定义Unicode Subrange!"),$r.CC_Ascii)}},{key:"get4ByteCharClass",value:function(e,t){if(!t)return this.getCharClass(e);var i=this._getUsrItem(e,t);return i?i.nClass===$r.__SC_Unknown__?(console.error("---\x3e 字符(0x"+e+")所属的Unicode Subrange的CharClass属性为Unknown!"),$r.CC_Ascii):i.nClass===$r.__SC_SomeShared__?$r.CC_Ascii:i.nClass:(console.error("---\x3e 字符(0x"+e+")未定义Unicode Subrange!"),$r.CC_Ascii)}},{key:"getUsrType",value:function(e){var t=this._getUsrItem(e);return t?t.nType:ea.usrError}},{key:"isTxRealAsia",value:function(e){return e===ta.usrCJKUnifiedIdeo||e===ta.usrCJKCompatibilityIdeographs||e===ta.usrCJKCompatibility||e===ta.usrCJKUnifiedIdeoExtendedA||e===ta.usrHiragana||e===ta.usrKatakana||e===ta.usrBopomofo||e===ta.usrHangul||e===ta.usrHangulCompatJamo}},{key:"isTxChinese",value:function(e){return e===ta.usrCJKUnifiedIdeo||e===ta.usrCJKCompatibilityIdeographs||e===ta.usrCJKCompatibility||e===ta.usrCJKUnifiedIdeoExtendedA}},{key:"isTxAscii",value:function(e){return e===ta.usrCyrillic||e===ta.usrCyrillic2||e===ta.usrBasicGreek||e===ta.usrBasicLatin||e===ta.usrLatin1||e===ta.usrLatinXA||e===ta.usrLatinXB}},{key:"isTxComplex",value:function(e){var t=ta.usrHebrewXA,i=ta.usrBasicHebrew,n=ta.usrBasicArabic,r=ta.usrArabicX,a=ta.usrSyriac,o=ta.usrThaana,s=ta.usrThai,l=ta.usrTamil,h=ta.usrBengali,u=ta.usrDevangari,c=ta.usrGujarati,d=ta.usrGurmukhi,p=ta.usrKannada,f=ta.usrOriya,g=ta.usrTelugu,y=ta.usrMalayalam,v=ta.usrLao,m=ta.usrBuhid,_=ta.usrTagbanwa,w=ta.usrCambodia,S=ta.usrTibet,x=ta.usrMongolia,T=ta.usrBurma,k=ta.usrCeylon;return e===t||e===i||e===n||e===r||e===a||e===o||e===s||e===l||e===h||e===u||e===c||e===d||e===p||e===f||e===g||e===T||e===y||e===v||e===m||e===_||e===w||e===S||e===x||e===k}}]),e}(),ra=function(e){function t(){r()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._unicodeCharItemGroups=[],e._groupBits=8,e}return u()(t,e),o()(t,[{key:"_createUnicodeCharItem",value:function(e,t){var i={};return i.usrType=this._getUsrItem(e,t).nType,i.charClass=this.get4ByteCharClass(e,t),i.isAlpha=!1,i.isNum=!1,i.isPlaceHolder=!1,i.isPunc=!1,this.isTxRealAsia(i.usrType)?(i.isRealAsia=!0,this.isTxChinese(i.usrType)&&(i.isChinese=!0)):this.isTxAscii(i.usrType)?i.isTxAscii=!0:this.isTxComplex(i.usrType)&&(i.isComplex=!0,this.isTxRtl(i.usrType)&&(i.isRtl=!0,this.isTxArabic(i.usrType)&&(i.isArabic=!0))),i}},{key:"_isContainSpecificChar",value:function(e){var t=e<<this._groupBits;if(t>=65536)return!1;for(var i=e+1<<this._groupBits,n=0,r=Xr.length;n<r;n++){var a=Xr[n];if(t<=a&&a<=i)return!0}for(var o=0,s=Jr.length;o<s;o++){var l=Jr[o];if(t<=l&&l<=i)return!0}for(var h=0,u=Zr.length;h<u;h++){var c=Zr[h];if(t<=c&&c<=i)return!0}for(var d=0,p=Qr.length;d<p;d++){var f=Qr[d];if(t<=f&&f<=i)return!0}return!1}},{key:"_fillUnicodeCharItemsInGroup",value:function(e){for(var t={items:[],sItem:{}},i=1<<this._groupBits,n=e<<this._groupBits,r=n>=65536?this._unic42LoSurrogate(n):n,a=n>=65536?this._unic42HiSurrogate(n):0,o=0;o<i;o++)t.items[o]=this._createUnicodeCharItem(r+o,a);if(0===a){for(var s=r+i-1,l=0,h=Xr.length;l<h;l++){var u=Xr[l];t.items[u-n]||(t.items[u-n]={}),t.items[u-n].isAlpha=n<=u&&u<=s}for(var c=0,d=Jr.length;c<d;c++){var p=Jr[c];t.items[p-n]||(t.items[p-n]={}),t.items[p-n].isDigit=n<=p&&p<=s}for(var f=0,g=Zr.length;f<g;f++){var y=Zr[f];t.items[y-n]||(t.items[y-n]={}),t.items[y-n].isPunc=n<=y&&y<=s}for(var v=0,m=Qr.length;v<m;v++){var _=Qr[v];t.items[_-n]||(t.items[_-n]={}),t.items[_-n].isPlaceHolder=n<=_&&_<=s}}return t}},{key:"_createUnicodeCharItemGroup",value:function(e){var t={},i=e<<this._groupBits,n=i>65535?this._unic42LoSurrogate(i):i,r=i>65535?this._unic42HiSurrogate(i):0,a=this._getUsrItem(n,r);return a.chTo<i+(1<<this._groupBits)||a.nClass===ea.__SC_SomeShared__||this._isContainSpecificChar(e)?t=this._fillUnicodeCharItemsInGroup(e):t.sItem=this._createUnicodeCharItem(n,r),t}},{key:"getUnicodeCharItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t?this._surrogate2Unic4(t,e):e,n=i>>this._groupBits,r=i&(1<<this._groupBits)-1;return this._unicodeCharItemGroups[n]||(this._unicodeCharItemGroups[n]=this._createUnicodeCharItemGroup(n)),this._unicodeCharItemGroups[n].items?this._unicodeCharItemGroups[n].items[r]:this._unicodeCharItemGroups[n].sItem}},{key:"isTxRtl",value:function(e){var t=ta.usrHebrewXA,i=ta.usrBasicHebrew,n=ta.usrBasicArabic,r=ta.usrArabicX,a=ta.usrArabicSupplement,o=ta.usrSyriac,s=ta.usrArabicPresentationFormsA,l=ta.usrArabicPresentationFormsB;switch(e){case t:case i:case n:case r:case a:case o:case s:case l:return!0}return!1}},{key:"isTxArabic",value:function(e){var t=ta.usrBasicArabic,i=ta.usrArabicX,n=ta.usrArabicSupplement,r=ta.usrArabicPresentationFormsA,a=ta.usrArabicPresentationFormsB;switch(e){case t:case i:case n:case r:case a:return!0}return!1}}]),t}(na),aa={DOCCharTypeDetecter:new na,DOCCharTypeFastDetecter:new ra},oa=aa.DOCCharTypeFastDetecter,sa=ta.usrDevangari,la=ta.usrTibet,ha=ta.usrLao,ua=ta.usrThai,ca=ta.usrTamil,da=ta.usrTelugu,pa=ta.usrCeylon,fa=ta.usrGurmukhi,ga=ta.usrBurma,ya=ta.usrBengali,va=ta.usrMalayalam,ma=ta.usrKannada,_a=ta.usrGujarati,wa=ta.usrCambodia,Sa=ta.usrBasicArabic,xa=ta.usrArabicX,Ta=ta.usrArabicPresentationFormsA,ka=ta.usrArabicPresentationFormsB,Ca=ta.usrArabicSupplement,ba={};function Ea(e,t){var i={};return t.forEach((function(e){for(var t=e.begin,n=e.end;t<n;++t)i[t]=!0})),ba[e]=i,i}var Ra=Ea(sa,[{begin:2304,end:2308},{begin:2362,end:2365},{begin:2366,end:2384},{begin:2385,end:2392},{begin:2402,end:2404}]);function Pa(e,t,i){var n=1,r=i.charCodeAt(e++),a=oa.getUnicodeCharItem(r);switch(a.usrType){case sa:n+=function(e,t,i,n){if(t<i){var r=n.charCodeAt(t);if((r>=2304&&r<2432||r===Yr)&&(Ra[e]!==Ra[r]||r===Yr)){for(var a=1;t+a<i&&((r=n.charCodeAt(t+a))===Yr||Ra[r]||n.charCodeAt(t+a-1)===Yr);)++a;return a}}return 0}(r,e,t,i);break;default:var o=ba[a.usrType];o&&(n+=function(e,t,i,n,r){if(t<i&&!r[e]){for(var a=0;t+a<i;){var o=n.charCodeAt(t+a);if(!r[o])break;++a}return a}return 0}(r,e,t,i,o))}return n}Ea(la,[{begin:3864,end:3866},{begin:3893,end:3894},{begin:3895,end:3896},{begin:3897,end:3898},{begin:3902,end:3904},{begin:3953,end:3973},{begin:3974,end:3976},{begin:3981,end:4029}]),Ea(ha,[{begin:3761,end:3762},{begin:3764,end:3773},{begin:3784,end:3790}]),Ea(ua,[{begin:3633,end:3634},{begin:3636,end:3643},{begin:3655,end:3663}]),Ea(ca,[{begin:2946,end:2947},{begin:3006,end:3022},{begin:3031,end:3032}]),Ea(da,[{begin:3072,end:3077},{begin:3134,end:3159},{begin:3170,end:3172}]),Ea(pa,[{begin:3458,end:3460},{begin:3530,end:3552},{begin:3570,end:3571}]),Ea(fa,[{begin:2561,end:2564},{begin:2620,end:2642},{begin:2672,end:2674},{begin:2677,end:2678}]),Ea(ga,[{begin:4139,end:4159},{begin:4182,end:4186},{begin:4190,end:4193},{begin:4194,end:4197},{begin:4199,end:4206},{begin:4209,end:4213},{begin:4226,end:4238},{begin:4239,end:4240},{begin:4250,end:4254}]),Ea(ya,[{begin:2433,end:2436},{begin:2492,end:2493},{begin:2494,end:2510},{begin:2519,end:2520},{begin:2530,end:2532},{begin:2558,end:2559}]),Ea(va,[{begin:3328,end:3332},{begin:3387,end:3389},{begin:3390,end:3406},{begin:3415,end:3416},{begin:3426,end:3428}]),Ea(ma,[{begin:3201,end:3204},{begin:3260,end:3261},{begin:3262,end:3287},{begin:3298,end:3300}]),Ea(_a,[{begin:2689,end:2692},{begin:2748,end:2749},{begin:2750,end:2766},{begin:2786,end:2788},{begin:2810,end:2816}]),Ea(wa,[{begin:6070,end:6100},{begin:6109,end:6110}]);var Ia=void 0,La=[[1536,1791],[1872,1919],[64336,65023],[65136,65279]];function Aa(e){for(var t=0,i=La.length;t<i;++t){var n=La[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function Ba(e,t){for(var i=0,n=e.length-1;i<=n;){var r=i+(n-i>>>1);if(t<e[r].ch)n=r-1;else{if(t==e[r].ch)return e[r];i=r+1}}return null}var Da={};function Ma(e){return Da[e]}function Oa(e,t,i,n){if(!n.start&&!n.middle)return!1;var r=e[t];if(32==r||46==r)return!1;for(var a=Ia,o=a,s=t;a.childs;){if(Ma(r)){if(++s<i){r=e[s];continue}break}var l=Ba(a.childs,r);if(!l)break;if(l.level>0&&(o=l),a=l,!(++s<i))break;r=e[s]}return o!=Ia&&!(!o.middle&&!o.end)}function Na(){Ia||function(e){var t,i={ch:1569,isolate:{ch:65152},level:e.level+1},n={ch:1570,end:{ch:65154},isolate:{ch:65153},level:e.level+1},r={ch:1571,end:{ch:65156},isolate:{ch:65155},level:e.level+1},a={ch:1572,end:{ch:65158},isolate:{ch:65157},level:e.level+1},o={ch:1573,end:{ch:65160},isolate:{ch:65159},level:e.level+1},s={ch:1574,start:{ch:65163},end:{ch:65162},middle:{ch:65164},isolate:{ch:65161},level:e.level+1},l={ch:1575,end:{ch:65166},isolate:{ch:65165},level:e.level+1},h={ch:1576,start:{ch:65169},end:{ch:65168},middle:{ch:65170},isolate:{ch:65167},level:e.level+1},u={ch:1577,end:{ch:65172},isolate:{ch:65171},level:e.level+1},c={ch:1578,start:{ch:65175},end:{ch:65174},middle:{ch:65176},isolate:{ch:65173},level:e.level+1},d={ch:1579,start:{ch:65179},end:{ch:65178},middle:{ch:65180},isolate:{ch:65177},level:e.level+1},p={ch:1580,start:{ch:65183},end:{ch:65182},middle:{ch:65184},isolate:{ch:65181},level:e.level+1},f={ch:1581,start:{ch:65187},end:{ch:65186},middle:{ch:65188},isolate:{ch:65185},level:e.level+1},g={ch:1582,start:{ch:65191},end:{ch:65190},middle:{ch:65192},isolate:{ch:65189},level:e.level+1},y={ch:1583,end:{ch:65194},isolate:{ch:65193},level:e.level+1},v={ch:1584,end:{ch:65196},isolate:{ch:65195},level:e.level+1},m={ch:1585,end:{ch:65198},isolate:{ch:65197},level:e.level+1},_={ch:1586,end:{ch:65200},isolate:{ch:65199},level:e.level+1},w={ch:1587,start:{ch:65203},end:{ch:65202},middle:{ch:65204},isolate:{ch:65201},level:e.level+1},S={ch:1588,start:{ch:65207},end:{ch:65206},middle:{ch:65208},isolate:{ch:65205},level:e.level+1},x={ch:1589,start:{ch:65211},end:{ch:65210},middle:{ch:65212},isolate:{ch:65209},level:e.level+1},T={ch:1590,start:{ch:65215},end:{ch:65214},middle:{ch:65216},isolate:{ch:65213},level:e.level+1},k={ch:1591,start:{ch:65219},end:{ch:65218},middle:{ch:65220},isolate:{ch:65217},level:e.level+1},C={ch:1592,start:{ch:65223},end:{ch:65222},middle:{ch:65224},isolate:{ch:65221},level:e.level+1},b={ch:1593,start:{ch:65227},end:{ch:65226},middle:{ch:65228},isolate:{ch:65225},level:e.level+1},E={ch:1594,start:{ch:65231},end:{ch:65230},middle:{ch:65232},isolate:{ch:65229},level:e.level+1},R={ch:1601,start:{ch:65235},end:{ch:65234},middle:{ch:65236},isolate:{ch:65233},level:e.level+1},P={ch:1602,start:{ch:65239},end:{ch:65238},middle:{ch:65240},isolate:{ch:65237},level:e.level+1},I={ch:1603,start:{ch:65243},end:{ch:65242},middle:{ch:65244},isolate:{ch:65241},level:e.level+1},L={ch:1604,start:{ch:65247},end:{ch:65246},middle:{ch:65248},isolate:{ch:65245},level:e.level+1},A={ch:1605,start:{ch:65251},end:{ch:65250},middle:{ch:65252},isolate:{ch:65249},level:e.level+1},B={ch:1606,start:{ch:65255},end:{ch:65254},middle:{ch:65256},isolate:{ch:65253},level:e.level+1},D={ch:1607,start:{ch:65259},end:{ch:65258},middle:{ch:65260},isolate:{ch:65257},level:e.level+1},M={ch:1608,end:{ch:65262},isolate:{ch:65261},level:e.level+1},O={ch:1609,start:{ch:64488},end:{ch:65264},middle:{ch:64489},isolate:{ch:65263},level:e.level+1},N={ch:1610,start:{ch:65267},end:{ch:65266},middle:{ch:65268},isolate:{ch:65265},level:e.level+1},F={ch:1649,end:{ch:64337},isolate:{ch:64336},level:e.level+1},V={ch:1657,start:{ch:64360},end:{ch:64359},middle:{ch:64361},isolate:{ch:64358},level:e.level+1},U={ch:1662,start:{ch:64344},end:{ch:64343},middle:{ch:64345},isolate:{ch:64342},level:e.level+1},G={ch:1670,start:{ch:64380},end:{ch:64379},middle:{ch:64381},isolate:{ch:64378},level:e.level+1},H={ch:1672,end:{ch:64393},isolate:{ch:64392},level:e.level+1},W={ch:1681,end:{ch:64397},isolate:{ch:64396},level:e.level+1},j={ch:1700,start:{ch:64364},end:{ch:64363},middle:{ch:64365},isolate:{ch:64362},level:e.level+1},Y={ch:1705,start:{ch:64400},end:{ch:64399},middle:{ch:64401},isolate:{ch:64398},level:e.level+1},z={ch:1709,start:{ch:64469},end:{ch:64468},middle:{ch:64470},isolate:{ch:64467},level:e.level+1},K={ch:1711,start:{ch:64404},end:{ch:64403},middle:{ch:64405},isolate:{ch:64402},level:e.level+1},q={ch:1722,end:{ch:64415},isolate:{ch:64414},start:{ch:65255},middle:{ch:65256},level:e.level+1},X={ch:1726,start:{ch:64428},end:{ch:64427},middle:{ch:64429},isolate:{ch:64426},level:e.level+1},J={ch:1729,start:{ch:64424},end:{ch:64423},middle:{ch:64425},isolate:{ch:64422},level:e.level+1},Z={ch:1735,end:{ch:64472},level:e.level+1},Q={ch:1736,end:{ch:64476},level:e.level+1},$={ch:1740,start:{ch:64510},end:{ch:64509},middle:{ch:64511},isolate:{ch:64508},level:e.level+1},ee={ch:1744,start:{ch:64486},middle:{ch:64487},end:{ch:64485},level:e.level+1},te={ch:1746,end:{ch:64431},isolate:{ch:64430},level:e.level+1},ie={ch:1747,end:{ch:64433},isolate:{ch:64432},level:e.level+1},ne={ch:1749,end:{ch:65258},level:e.level+1};e.childs=[i,n,r,a,o,s,l,h,u,c,d,p,f,g,y,v,m,_,w,S,x,T,k,C,b,E,R,P,I,L,A,B,D,M,O,N,F,V,U,G,H,W,j,Y,z,K,q,X,J,Z,Q,$,ee,te,ie,ne],t=Da,[{begin:1552,end:1563},{begin:1600,end:1601},{begin:1611,end:1632},{begin:1648,end:1649},{begin:1750,end:1757},{begin:1759,end:1765},{begin:1767,end:1769},{begin:1770,end:1774}].forEach((function(e){for(var i=e.begin,n=e.end,r=i;r<n;++r)t[r]=!0})),L.childs=[{ch:1570,isolate:{ch:65269},end:{ch:65270},level:2},{ch:1571,isolate:{ch:65271},end:{ch:65272},level:2},{ch:1573,isolate:{ch:65273},end:{ch:65274},level:2},{ch:1575,isolate:{ch:65275},end:{ch:65276},level:2}];var re={ch:1604,childs:[{ch:1604,childs:[{ch:1607,isolate:{ch:65010},level:4},{ch:1729,isolate:{ch:65010},level:4}]}]};l.childs=[re];var ae={ch:1604,childs:[{ch:1575,childs:[{ch:1604,isolate:{ch:65020},level:4}]}]};m.childs=[ae]}(Ia={level:0})}function Fa(e){Na();var t=e.srcPos,i=t+e.len,n=0,r=!0,a=!0,o=-1,s=!1,l=t,h=e.startOrMiddleNode,u=e.srcBuff;h||(e.startOrMiddleNode=h={});for(var c=t;c<i;){var d=u[c],p=Ia,f=p,g=Aa(d);for(c===t&&(r=!1);f.childs;){if(Ma(d)){if(p!=Ia)break;if(e.desBuff[e.desPos++]=d,n++,e.len--,e.srcPos++,l++,++c<i){d=u[c];continue}return n}var y=Ba(f.childs,d);if(y){if(-1!=o&&o!=y.level)return n;f=y,c++,y.level>0&&(p=y,l=c),c<i&&(d=u[c])}if(!y||c>=i)break}if(-1!=o&&(o!=p.level||s!=g))return n;if(o=p.level,s=g,p==Ia)e.desBuff[e.desPos]=d,l++,r=!1;else{a=!(l>=i)&&Oa(u,l,i,p);var v=p.isolate;if(v||(v=p.end),v||(v=p.start),v||(v=p.middle),v||(v=p),!r&&e.desPos>=1&&(r=!!h[e.desBuff[e.desPos-1]]),r&&a){var m=p.middle;m?h[m.ch]=m:m=p.end?p.end:v,e.desBuff[e.desPos]=m.ch,r=m==p.middle||m==p.start}else if(r&&!a){var _=p.end;_||(_=p.middle?p.middle:v),e.desBuff[e.desPos]=_.ch,r=!1}else if(!r&&a){var w=p.start;r=!!w,w?h[w.ch]=w:w=p.isolate?p.isolate:v,e.desBuff[e.desPos]=w.ch}else if(!r&&!a){var S=p.isolate;S||(S=p.start?p.start:v),e.desBuff[e.desPos]=S.ch,r=!1}}if(e.len-=l-e.srcPos,e.srcPos=l,c=l,n++,e.desPos++,p.level>1)return n}return n}function Va(e){if(e>=56806&&e<=56831)return String.fromCharCode(e-56806+65)}function Ua(e,t){var i=t,n=e.charCodeAt(t);if(function(e){if(9757===e||10084===e||9977===e||e>=9994&&e<=9997||e>=55296&&e<=56319)return!0}(n)){t++;var r=!1;if((n=e.charCodeAt(t))>=56320&&n<=57343&&(t++,r=Va(n)),r&&!Ga.hasInit){for(var a=0;a<Ha.length;){var o=Ha.substr(a,2);Ga[o]=o,a+=2}Ga.hasInit=!0}if(55356===(n=e.charCodeAt(t)))if(function(e){return e>=57338&&e<=57343}(n=e.charCodeAt(t+1)))t+=2,n=e.charCodeAt(t);else if(r){var s=r+Va(n);Ga[s]&&(t+=2)}!function i(){8205===n&&(t++,t+=Ua(e,t),n=e.charCodeAt(t)),9792!==n&&9794!==n||(t++,n=e.charCodeAt(t)),9877!==n&&9878!==n||(t++,n=e.charCodeAt(t)),65039===n&&(t++,n=e.charCodeAt(t),i())}()}else n>=0&&n<=255?65039===(n=e.charCodeAt(t+1))?8419===(n=e.charCodeAt(t+2))&&(t+=3):8419===n&&65039===(n=e.charCodeAt(t+2))&&(t+=3):65039===(n=e.charCodeAt(t+1))&&(t+=2);return t-i}var Ga={},Ha=["ADAEAFAGAIALAMAOARATAUAXAZ","BBBDBEBFBGBHBIBJBLBMBNBOBQBRBSBWBYBZ","CACDCFCGCHCKCLCMCNCOCRCSCUCWCXCYCZDEDJDKDODZ","ECEEEGEHERESETEUFIFJFKFRFO","GAGBGDGEGFGGGHGIGLGMGNGRGSGTGUGWGY","HKHNHRHTHU","ICIDIEILIMINIOIQIRISITJMJOJPKEKGKHKMKNKPKRKTKWKZ","LALBLCLILKLRLSLTLULVLYMAMCMDMGMLMMMNMOMQMSMTMUMVMWMXMYMZ","NANCNENFNGNINLNONPNRNUNZ","OMPAPEPFPGPHPKPLPMPNPRPTPY","QARSRORUSASBSCSDSESGSHSISKSLSMSNSOSRSSSTSVSXSYSZ","TDTGTHTJTKTLTMTNTOTRTTTSTZ","UAUNUGUSUYUZVCVEVGVNVUWFWSXKYEYUZAZMZRZW"].join(""),Wa=function(){function e(t){r()(this,e),this._data=t,this.lineBreakChars=["\v","\n","\r"]}return o()(e,[{key:"update",value:function(e){this._data=e}},{key:"getData",value:function(){return this._data}},{key:"measure",value:function(e){var t=this._data,i=t.getFont(),n=t.getText(),r=t.getSpacing(),a=t.getCapitalization(),o=t.getBeginCcp().begin;t.clearGlyphs();var s=wr(" ",i);s.width<20*window.ti2pxRatio&&(i.fontFamily="Arial",t.updateFontFamily(i.fontFamily));var l=n;n instanceof Array&&(l=n.join(""));for(var h,u=t.getVerticalType(),c=0,d=0,p=0,f=l.length;p<f;p++){var g=l[p],y=g.charCodeAt(),v=g.length,m=void 0,w=oa.getUnicodeCharItem(y),S=!1;if(w.charClass===$r.CC_Complex)v=Pa(p,l.length,l);else{var x=Ua(l,p);x&&(v=x,S=!0,g=l.substr(p,v))}v>1?(g=l.substr(p,v),p+=v-1,m=wr(g,i)):((2!==a||this.isGeorgianMkhedruli(g.charCodeAt()))&&(1!==a||this.isGeorgianMkhedruli(g.charCodeAt()))||(g=g.toUpperCase()),m=wr(g,i=t.getFont(g)),-1!==this.lineBreakChars.indexOf(g)?(m.width*=.5,m.v_width&&(m.v_width*=.5)):9===g.codePointAt(0)&&(m.width=0,m.v_width&&(m.v_width=0))),u===C.TextDirectionType.VerticalWordArtRightToLeft&&((h=y)>=3585&&h<=3675&&(1===v?(m.height*=.7,m.v_height*=.7):(m.height*=.8,m.v_height*=.8)),m.width=m.height,m.v_width=m.v_height),t.height<m.height&&(t.height=m.height),t.width+=m.width,m.spacing=r,t.appendGlyph(_()({char:g},m,{gcp:o,font:i,charInfo:w,isEmojiFragment:S})),o+=v,m&&m.v_width&&!Ya(g)&&(d+=m.v_width,c+=m.width)}if(c>d){var T=d/c;t.fontShowScale=T<=.9?1.08*T:1,console.log("scale font",t.fontShowScale)}var k=t.getGlyphs()[0];k&&k.isComplex()&&!t.hasTextSel&&(s=wr(l,i,!1),t.width=s.width)}},{key:"getWidth",value:function(){return this._textWidth}},{key:"isGeorgianMkhedruli",value:function(e){return e>=4304&&e<=4351}},{key:"parseSpanStr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=null,r=[];t>0&&(n=e[t-1]);for(var a=[],o=t;o<i;++o){var s=e[o],l=s.charCodeAt();if(Je(l)){var h=null;o<i-1&&(h=e[o+1].charCodeAt());var u=Ze(n),c=Qe(h),d=$e(n),p=$e(h);(u||d)&&(c||p)?a.push(s):(!u&&!d||c||p)&&(u||d||!c&&!p)?it(l)?a.push(s):Qe(l)?(a.push(s),a.length>0&&(r.push({char:a.join(""),charCode:l}),a=[])):(a.length>0&&(r.push({char:a.join(""),charCode:n}),a=[]),r.push({char:s,charCode:l})):a.push(s),n=l}else{a.length>0&&(r.push({char:a.join(""),charCode:n}),a=[]);var f=!1,g=Ua(e,o);g&&(f=!0,s=e.substr(o,g),o+=g-1),ja[l]&&(s=String.fromCharCode(ja[l])),r.push({char:s,charCode:l,isEmojiFragment:f}),n=l}}return a.length>0&&r.push({char:a.join(""),charCode:n}),r}},{key:"measureArabic",value:function(e,t,i,n){var r=this._data,a=r.getFont(),o=r.getVerticalType(),s=r.getSpacing(),l=new Array(e),h=t.split("").map((function(e){return e.charCodeAt()})),u={srcBuff:h,srcPos:0,desBuff:l,desPos:0,len:e};do{for(Fa(u);u.desPos<u.srcPos;)l[u.desPos++]=8205}while(u.len>0);var c=l.map((function(e,t){var n=h[t],r=String.fromCharCode(e),o=oa.getUnicodeCharItem(n);return{char:r,originChar:String.fromCharCode(n),charCode:n,charInfo:o,gcp:i+t,metrics:wr(r,a)}}));c.length<1||c.forEach((function(e){var t=e.metrics;o===C.TextDirectionType.VerticalWordArtRightToLeft&&(t.width=t.height),r.height<t.height&&(r.height=t.height),r.width+=t.width,t.spacing=s,r.appendGlyph(_()({},e,t,{font:a,isEmojiFragment:n}))}))}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}();var ja={61554:961,61555:963,61544:951,61613:11105,61615:11107,61664:11106,61619:8805,61552:960,61663:8659,61511:915,61556:964,61542:966,61523:931,61563:123,61565:125,61541:949,61629:124,61501:61,61646:8712,61640:8746,61482:42,61483:43,61485:45,61645:8838,61614:8594};function Ya(e){return'\v\n\r\t !%#^&(),.:;<>?[]{}¢¨°·ˇˉ―‖‘’“”…‰′`~"″›=+-*/-_'.includes(e)}var za=function(){function e(t){r()(this,e),this._data=t}return o()(e,[{key:"update",value:function(e){return this._data=e,this}},{key:"measure",value:function(e){var t=this._data,i=t.getText(),n=t.getFont(),r=wr(i,n);t.width=r.width+t.getSpacing(),t.height=1.2*n.fontSize,C.TextDirectionType.VerticalWordArtRightToLeft===t.getVerticalType()&&(t.width=t.height*i.length+t.getSpacing()),t.metrics=r}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),Ka=i(725);function qa(e,t){var i;(["underlineType","strikeThrough","fontStyle","fontVariant","fontWeight","fontFamily","fontSize","italic","bold","color","tiFontSize"].forEach((function(i){e[i]!==t[i]&&delete e[i]})),t.fontList)&&(e.fontList=e.fontList||[],(i=e.fontList).push.apply(i,S()(t.fontList)));if(e.position&&e.position!==t.position&&(e.position=0),-1!==e.spacing&&(e.spacing||t.spacing?e.spacing!==t.spacing&&(e.spacing=-1):e.spacing=0),e.textHyperlink&&t.textHyperlink){if(!Array.isArray(e.textHyperlink)){var n=[];n.push(e.textHyperlink),e.textHyperlink=n}var r;if(Array.isArray(t.textHyperlink))(r=e.textHyperlink).push.apply(r,S()(t.textHyperlink));else e.textHyperlink.push(t.textHyperlink)}else t.textHyperlink&&(e.textHyperlink=t.textHyperlink);return window.sameCmp(e.hightLightColor,t.hightLightColor)||delete e.hightLightColor,e}function Xa(e,t){["firstIndent","leftIndent","marginBefore","marginAfter","tabStops"].forEach((function(i){e&&t&&e[i]!==t[i]&&e[i]&&t[i]&&(t[i]&&e[i].value===t[i].value||delete e[i])}));if(["breakInWord","kinsoku","alignMode","listType","autoNumType","bulletChar","rightToLeft"].forEach((function(i){e&&t&&e[i]!==t[i]&&delete e[i]})),-1!==e.lineSpacing&&(e.lineSpacing||(e.lineSpacing={rule:"auto",value:100}),t&&!t.lineSpacing&&(t.lineSpacing={rule:"auto",value:100}),t))for(var i in t.lineSpacing)if(e&&t&&e.lineSpacing[i]!==t.lineSpacing[i]){e.lineSpacing=-1;break}return e&&t&&e.chapterStyle&&t.chapterStyle&&qa(e.chapterStyle,t.chapterStyle),e}var Ja=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.x,n=void 0===i?0:i,a=t.y,o=void 0===a?0:a,s=t.width,l=void 0===s?0:s,h=t.height,u=void 0===h?0:h;r()(this,e),this.x=n,this.y=o,this.width=l,this.height=u}return o()(e,[{key:"setRect",value:function(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getRect",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"setY",value:function(e){this.y=e}},{key:"pointInRect",value:function(e,t){return e>=this.x+4&&e<=this.x+this.width-4&&t>=this.y+4&&t<=this.y+this.height-4}},{key:"getCross",value:function(e,t,i){return(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y)}},{key:"getRotatePoint",value:function(e,t,i){var n=t.x,r=t.y,a=i*Math.PI/180,o=e.x,s=e.y;return{x:(n-o)*Math.cos(a)-(r-s)*Math.sin(a)+o,y:(n-o)*Math.sin(a)+(r-s)*Math.cos(a)+s}}},{key:"pointInRotateRect",value:function(e,t,i){return i=i||{x:this.x+this.width/2,y:this.y+this.height/2},0!==t&&(e=this.getRotatePoint(i,e,-t)),this.pointInRect(e.x,e.y)?e:null}},{key:"pointOnBorder",value:function(e,t){var i=e,n=t,r=this.x,a=this.y,o=this.x+this.width,s=this.y+this.height;if(i<r+4&&i>r-4&&i>0){if(n<s+4&&n>a-4)return"left"}else if(i<o+4&&i>o-4){if(n<s+4&&n>a-4)return"right"}else if(n<a+4&&n>a-4&&n>0){if(i<o+4&&i>r-4)return"top"}else if(n<s+4&&n>s-4&&i<o+4&&i>r-4)return"bottom";return!1}},{key:"pointOnTop",value:function(e,t,i){var n=this.x,r=this.x+this.width;return t<-5&&e>n&&e<r?"arrowtop":t>-5&&t<0&&e>n&&e<r||e>n&&e<r&&t>i&&t<i+5?"selectShape":t>i+5&&e>n&&e<r&&"arrowbottom"}},{key:"pointOnLeft",value:function(e,t,i){var n=this.y,r=this.y+this.height;return t>n&&t<r&&e<-5?"arrowLeft":t>n&&t<r&&e>i+5?"arrowRight":(t>n&&t<r&&e>i&&e<i+5||t>n&&t<r&&e>-5&&e<0)&&"selectShape"}},{key:"setScaleXY",value:function(e,t){this.scale={x:e,y:t}}},{key:"getScaleXY",value:function(){return this.scale||{x:1,y:1}}},{key:"inRect",value:function(e){return this.x>=e.x&&this.y>=e.y&&this.width+this.x<=e.width+e.x&&this.height+this.y<=e.height+e.y}},{key:"pointInRectHorizontal",value:function(e,t){var i=e.x,n=e.y,r=this.height,a=i-this.x,o=n-this.y,s=this.lineHeight||0;if(s&&(o+=s-r,r=s),a>=0&&o>=0&&a<=this.width&&o<=r)return!0;if(t){if(o>=0&&o<=r)return this.isPlaceholder&&this.isPlaceholder(),!0}else if(a>=0&&a<=this.width)return this.isPlaceholder&&this.isPlaceholder(),!0;return!1}},{key:"destroy",value:function(){}}]),e}(),Za=aa.DOCCharTypeFastDetecter,Qa=window,$a=Qa.DOCWinNTHandler,eo=Qa.DOCPrimaryLangID,to=function(){function e(){r()(this,e)}return o()(e,null,[{key:"isParaBreak",value:function(e){return e===Cr||e===br||7===e}},{key:"isPageBreak",value:function(e){return e===Er||e===Rr||e===br}},{key:"isSpace",value:function(e){return Za.getUnicodeCharItem(e).isPlaceHolder&&e===Dr||e===Wr||e===jr}},{key:"isFullWidthSpace",value:function(e){return e===Wr}},{key:"isNormalSpace",value:function(e){return e===Dr}},{key:"isNonBreakSpace",value:function(e){return e===jr}},{key:"isSimpleLineBreak",value:function(e){return e===kr||e===Cr}},{key:"isLineBreak",value:function(e){return e===Cr||e===Er||e===kr||e===br||e===Rr||e===Fr}},{key:"isControl",value:function(e){return e===Vr||e===Ur}},{key:"isTab",value:function(e){return e===Br}},{key:"isTextSymbol",value:function(e){return e===Nr}},{key:"isComment",value:function(e){return e===Ir}},{key:"isFootnote",value:function(e){return e===Pr}},{key:"isDrawing",value:function(e){return e===Lr}},{key:"isEmbedDrawing",value:function(e){return e===Ar}},{key:"isControlBegin",value:function(e){return e===Vr}},{key:"isControlEnd",value:function(e){return e===Ur}},{key:"isFieldBeginEnd",value:function(e){return e===Mr||e===Or}},{key:"isAlpha",value:function(e){return e>="a".codePointAt()&&e<="z".codePointAt()||e>="A".codePointAt()&&e<="Z".codePointAt()}},{key:"isLowerAlpha",value:function(e){return e>="a".codePointAt()&&e<="z".codePointAt()}},{key:"isUpperAlpha",value:function(e){return e>="A".codePointAt()&&e<="Z".codePointAt()}},{key:"isNum",value:function(e){return e>="0".codePointAt()&&e<="9".codePointAt()}},{key:"isSpecialAlpha",value:function(e){return 1046===e}},{key:"isRealAsia",value:function(e){return Za.getUnicodeCharItem(e).isRealAsia}},{key:"isTxAscii",value:function(e){return Za.getUnicodeCharItem(e).isTxAscii}},{key:"isComplex",value:function(e){return Za.getUnicodeCharItem(e).isComplex}},{key:"isPunc",value:function(e){return Za.getUnicodeCharItem(e).isPunc||this.isJPNSpecPunc(e)}},{key:"isPureHeadPunc",value:function(e){return"$([{£¥‘“〈《「『【〔〖〝﹙﹛﹝＄（［｛￡￥".indexOf(String.fromCharCode(e))>-1}},{key:"isHeadPunc",value:function(e){return"$([{£¥·‘“〈《「『【〔〖〝﹙﹛﹝＄（．［｛￡￥".indexOf(String.fromCharCode(e))>-1}},{key:"isTailPunc",value:function(t){return t===jr||"!%),.:;>?]}¢¨°·ˇˉ―‖’”…‰′″›℃∶、。〃々〉》」』】〕〗〞︶︺︾﹀﹄﹚﹜﹞！＂％＇），．：；？］｀｜｝～￠".indexOf(String.fromCharCode(t))>-1||e.isJPNSpecPunc(t)}},{key:"isGenkohangPunc",value:function(t){return e.isTailPunc(t)}},{key:"isHangPunc",value:function(e,t,i,n){if(i)return this.isGenkohangPunc(e);switch($a.getPrimaryLangID(t)){case eo.JAPANESE:return",.!),:;?]}、，。".indexOf(String.fromCharCode(e))>-1;case eo.KOREAN:return",.!),:;?]}，".indexOf(String.fromCharCode(e))>-1;case eo.CHINESE:return n?",.!),:;?]}".indexOf(String.fromCharCode(e))>-1:"!),.:;?]}￠ˇ’”∶、。〉》」』】〕〗！＂＇），．·：；".indexOf(String.fromCharCode(e))>-1;default:return this.isDefaultHangPunc(e,n)}}},{key:"isDefaultHangPunc",value:function(e,t){return t?",.!),:;?]}".indexOf(String.fromCharCode(e))>-1:"!),.:;?]}￠ˇ’”∶＂".indexOf(String.fromCharCode(e))>-1}},{key:"isHeadCompressPunc",value:function(e){return Za.getUnicodeCharItem(e).isPunc&&"‘“〈《「『【〔〖（［｛".indexOf(String.fromCharCode(e))>-1}},{key:"isTailCompressPunc",value:function(e){return Za.getUnicodeCharItem(e).isPunc&&"·’”∶、。〃〉》」』】〕〗！｝］＇），．：；".indexOf(String.fromCharCode(e))>-1}},{key:"isCompressPunc",value:function(t){return e.isTailCompressPunc(t)||e.isHeadCompressPunc(t)}},{key:"isJPNSpecPunc",value:function(e){return 12539===e}},{key:"isMathFunction",value:function(e){return e===Gr}},{key:"isMathArgEnd",value:function(e){return e===Hr}},{key:"toUpperAlpha",value:function(e){return e.toUpperCase()}},{key:"toLowerAlpha",value:function(e){return e.toLowerCase()}},{key:"getCharInfo",value:function(e){return Za.getUnicodeCharItem(e)}}]),e}(),io=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.props=e,i.width=e.v_width||e.width,i.height=e.v_height||e.height,i.refTextSpan=e.parent,i.spacing=e.spacing,i.charcode=i.props.charCode||i.props.char.codePointAt(0),i._charInfo=e.charInfo,i.isEmojiFragment=e.isEmojiFragment;var n=e.width-i.width;return(!i.isOverlayCh||n<0&&(i.isPureHeadPunc()||-1==="·∶、。！，．：；".indexOf(i.getChar())&&i.isTailPunc()))&&(n=0),i.overlapW=n,i.maxOverlapW=.2*e.width,i}return u()(t,e),o()(t,[{key:"getParent",value:function(){return this.refTextSpan}},{key:"getChar",value:function(){return this.props.char}},{key:"getCharLen",value:function(){return this.getChar()?this.getChar().length:0}},{key:"getCharCode",value:function(){return this.charcode}},{key:"getAdjustWidth",value:function(){return this.adjustWidth}},{key:"setAdjustWidth",value:function(e){this.adjustWidth=e}},{key:"getCssStyle",value:function(){if(!this._cssStyle){var e=this.getFont(),t=e.fontStyle,i=e.fontVariant,n=e.fontWeight,r=e.fontFamily,a=e.fontSize;this._cssStyle={fontStyle:t,fontVariant:i,fontWeight:n,fontFamily:r,fontSize:a+"px"}}return this._cssStyle}},{key:"getTxtStyle",value:function(){var e=this.getCssStyle(),t=e.fontStyle,i=e.fontVariant,n=e.fontWeight,r=e.fontFamily,a=e.fontSize;return{fill:this.getFontColor(),"font-variant":i,"font-weight":n,"font-family":r,"font-size":a,"font-style":t}}},{key:"getFont",value:function(){if(!this._font){var e=this.props.originChar||this.getChar();this._font=this.refTextSpan.getFont(e),this._corefont=_()({},this._font);var t=this._font.fontFamily;t=function(e){return _r.getInstance().sameFFMap[e]||e}(t);var i=lr.covertFontfamily(t);!i||"√"===e&&i.includes(Un)||"·"===e&&i.includes(Qn)||(t=i),this._font.fontFamily='"'+t+'"'}return this._font}},{key:"getCoreFont",value:function(){return this._corefont}},{key:"getUnderline",value:function(){return this.isLineBreak()?0:this.refTextSpan.getUnderline()}},{key:"getUnderlineFill",value:function(){return this.refTextSpan.getUnderlineFill()}},{key:"getDeleteline",value:function(){return this.isLineBreak()?0:this.refTextSpan.getDeleteline()}},{key:"getFontColor",value:function(){return this.refTextSpan.getFontColor()}},{key:"isBold",value:function(){return this.refTextSpan.isBold()}},{key:"getRect",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"getArtTextEffectList",value:function(){return this.refTextSpan.getArtTextEffectList()}},{key:"artTextOutLineFill",value:function(){return this.refTextSpan.artTextOutLineFill()}},{key:"isAlpha",value:function(){return void 0===this._isAlpha&&(this._isAlpha=this.isUnderlineChar||to.isAlpha(this.charcode)),this._isAlpha}},{key:"isSpace",value:function(){return void 0===this._isSpace&&(this._isSpace=8194===this.charcode||to.isSpace(this.charcode)),this._isSpace}},{key:"isTailPunc",value:function(){return void 0===this._isTailPunc&&(this._isTailPunc=to.isTailPunc(this.charcode)),this._isTailPunc}},{key:"isCompressPunc",value:function(){return void 0===this._isCompressPunc&&(this._isCompressPunc=to.isCompressPunc(this.charcode)),this._isCompressPunc}},{key:"isRealAsia",value:function(){return void 0===this._isRealAsia&&(this._isRealAsia=to.isRealAsia(this.charcode)),this._isRealAsia}},{key:"isLineBreak",value:function(){return void 0===this._isLineBreak&&(this._isLineBreak=to.isLineBreak(this.charcode)||10===this.charcode),this._isLineBreak}},{key:"isTab",value:function(){return to.isTab(this.charcode)}},{key:"getVerticalType",value:function(){return this.refTextSpan.getVerticalType()}},{key:"isVerticalTopRightCornerChar",value:function(){return void 0===this._isTtrCh&&(this._isTtrCh="。，、，•".indexOf(this.getChar())>-1),this._isTtrCh}},{key:"isVerticalRightChar",value:function(){return void 0===this._isVrCh&&(this._isVrCh="！？：".indexOf(this.getChar())>-1),this._isVrCh}},{key:"isVerticalRotateChar",value:function(){if(void 0===this._isRotateChar){if(this.isVerticalRightChar()||this.isVerticalTopRightCornerChar())return!1;this._isRotateChar=!this.isRealAsia()&&-1==="￥".indexOf(this.getChar())}return this._isRotateChar}},{key:"getGcp",value:function(){return this.props.gcp}},{key:"getScriptPosition",value:function(){return this.refTextSpan.getScriptPosition()}},{key:"setDescent",value:function(e){this.props.descent=e}},{key:"setWidth",value:function(e){this.width=e}},{key:"setHeight",value:function(e){this.height=e}},{key:"setOriginChar",value:function(e){this.props.originChar=e}},{key:"setChar",value:function(e){this.props.char=e}},{key:"isLineSplitChar",value:function(){return void 0===this._isLineHeadChar&&(this._isLineHeadChar=this.isRealAsia()||this.isPureHeadPunc()||"-—".indexOf(this.getChar())>-1),this._isLineHeadChar}},{key:"getStyle",value:function(){return this.refTextSpan.getStyle()}},{key:"getGradientColor",value:function(){return this.refTextSpan.getGradientColor()}},{key:"isAlphaPunc",value:function(){return this._isAlphaPunc=this._isAlphaPunc||"'!%),.:;>?]}¢¨°·ˇˉ―‖’”…‰".indexOf(this.getChar())>-1,this._isAlphaPunc}},{key:"isNoBreakLinePunc",value:function(){return this._isNoBreakLinePunc=this._isNoBreakLinePunc||"£¥¢¨°ˇˉ`·~!@#$%^&*()_+=[]{}\\|;':”,./<>?·￥…‘“".indexOf(this.getChar())>-1,this._isNoBreakLinePunc}},{key:"isPureHeadPunc",value:function(){return void 0===this._isHeadChar&&(this._isHeadChar=to.isPureHeadPunc(this.charcode)),this._isHeadChar}},{key:"getCharInfo",value:function(){return to.getCharInfo(this.charcode)}},{key:"destroy",value:function(){delete this.refTextSpan,delete this.props}},{key:"isComplex",value:function(){return this._charInfo.isComplex}},{key:"descent",get:function(){return this.props.descent*this.refTextSpan.fontShowScale}},{key:"ascent",get:function(){return this.props.ascent*this.refTextSpan.fontShowScale}},{key:"realWidth",get:function(){return this._real_width||this.props.width*this.refTextSpan.fontShowScale},set:function(e){this._real_width=e}},{key:"fontSize",get:function(){if(void 0===this._fontSize){var e=this.getFont().fontSize;this._fontSize=e}return this._fontSize}},{key:"hyperlink",get:function(){return this.refTextSpan.hyperlink}},{key:"hasTextSel",get:function(){return this.refTextSpan.hasTextSel}},{key:"isNum",get:function(){return void 0===this._isNum&&(this._isNum=to.isNum(this.charcode)),this._isNum}},{key:"isUnderlineChar",get:function(){return"_"===this.props.char}},{key:"isDot",get:function(){return"."===this.props.char}},{key:"isRightChar",get:function(){return this._charInfo.isRtl}},{key:"isThaiChar",get:function(){var e=this.getCharCode();return e>=3585&&e<=3675}},{key:"isOverlayCh",get:function(){return void 0===this._overlay_ch&&(this._overlay_ch=!(this.isTab()||this.isSpace()||this.isLineBreak())),this._overlay_ch}},{key:"needLayoutUnderLine",get:function(){return this.refTextSpan.needLayoutUnderLine&&!this.getUnderline()}}]),t}(Ja),no=function(){function e(t){r()(this,e),this._data=t,this.init()}return o()(e,[{key:"getTypoData",value:function(){return this._data}},{key:"init",value:function(){this._textSpanLayouter=Wa.getInstance(),this._textLineLayouter=nt.getInstance(),this._hasChanged=!0}},{key:"update",value:function(e){this._data=e,this._hasChanged=!0}},{key:"measure",value:function(e){var t=this._data;if(this._hasChanged){var i=e.wrapText,n=e.rect,r=e.adjScale;n=n||{x:0,y:0,width:400,height:0},t.setRect(n.x,n.y,n.width,n.height);var a=Object.assign({},n),o=a.width;this.measureSpanChars(e),this.convertArabicRenderString();var s=this.measureAutonum(),l=s.firstLineIndent,h=s.leftIndent;this.composeLines({firstLineIndent:l,leftIndent:h,lineWidth:o,wrapText:i,adjScale:r}),this.calcLinesPosition(a),this.covertRight2Left(o)}}},{key:"covertRight2Left",value:function(e){var t=this._data,i=t.getTypoTextLines(),n=t.getAlignMode(),r=n===C.HorzAlignMode.Right||n===C.HorzAlignMode.Adjustify||n===C.HorzAlignMode.LowJustify||n===C.HorzAlignMode.FullAdjustify;i.forEach((function(i,n){if(i.isR2L)if(r){if(i.x=e-(i.x+i.width)+i.offsetLeft,0===n){var a=t.getTypoAutoNum();a&&(a.x=e-(a.x+a.width)+i.offsetLeft)}}else if(0===n){var o=t.getTypoAutoNum();if(o){var s=i.x-o.x;o.x+=i.width+s+o.width}}}))}},{key:"appendLinesBreakChar",value:function(){var e=this._data.getTypoTextLines(),t=e.length;t>1&&e.forEach((function(e,i){if(i!==t-1){var n=e.getGlyphs(),r=n[n.length-1],a=r.x,o=r.props;a+=o.width,e.appendGlyph(new io(_()({},o,{char:String.fromCharCode(11),charCode:11,x:a,width:0})))}}))}},{key:"measureSpanChars",value:function(e){var t=this,i=[],n=0,r=0,a=this._data.getChildren();a.forEach((function(o,s){t._textSpanLayouter.update(o),t._textSpanLayouter.measure(e);var l=o.getGlyphs();i=i.concat(l);var h=o.getFont().fontSize;(!s||s<a.length-1&&n>h)&&(n=h),(!s||s<a.length-1&&r<h)&&(r=h)})),this._data.minFontSize=n,this._data.maxFontSize=r,this._data.setGlyphs(i)}},{key:"measureAutonum",value:function(){var e=this._data,t=e.getLineIndent(),i=e.getFirstLineIndent(),n=i.isCh,r=i.value;if(n){var a=e.getGlyphs()[0];if(a.getCharInfo().isChinese)r=a.width*r;else r=wr("宋",a.getFont()).width*r}var o=this._data.getTypoAutoNum();if(o)if(za.getInstance().update(o).measure({}),r>0)o.x=t,o.width>t&&(o.x=0),r+=t,r=Math.max(o.x+o.width,r);else{var s=t+r;s<0?(r=Math.max(Math.abs(r),o.width),o.x=0):(o.x=s,r=Math.max(o.x+o.width,t))}else(r+=t)<0&&(r=0);return{firstLineIndent:r,leftIndent:t}}},{key:"composeLines",value:function(e){var t=e.firstLineIndent,i=e.leftIndent,n=e.lineWidth,r=e.wrapText,a=(e.adjScale,this._data);a.clearTypoTextLines();var o=a.createTypoTextLine();o.x=t;for(var s=a.getLineRule(),l=s.breakInWord,h=s.kinsoku,u=s.overflowPunct,c=a.getGlyphs(),d=n,p=d-o.x,f=!1,g=c[0],y=0;y<c.length;y++){g=c[y];var v;h&&g.isPureHeadPunc()&&o.getLength()>0?f=y:g.isAlpha()||g.isNum||(f=0);var m=d-p;if(g.isTab()){var _=a.getTabStop(m);0!==_&&(g.width=_-m,m=_)}p-=g.width,p-=g.spacing,v=-.0225*g.width;var w=c[y-1],S=c[y+1],x=g.isLineBreak(),T=g.getCharInfo(),k=this.isNeedbackforward(T);if(o.overlapW>o.maxOverlapW&&y<c.length-2){var C=o.overlapW-o.maxOverlapW;p<C&&(p-=C)}if(!x&&(p+g.spacing>v||o.getLength()<1||!r||g.isSpace()))o.appendGlyph(g);else{if(x)o.appendGlyph(g);else if(f)o.getLength()!==y-f&&(o.removeLastGlyphs(y-f),y=f-1);else{var b=!0,E=g.isAlpha();if(S&&(S.isAlphaPunc()||h&&S.isTailPunc()))b=!1;else if(g.isTailPunc()&&u&&p+g.width>0){o.appendGlyph(g),g.isCompressed=!0;continue}if(h&&w.isPureHeadPunc()&&o.getLength()>1)o.removeLastGlyphs(1),y-=2;else if(!l&&(E||g.isNum)||!b||g.isAlphaPunc()||h&&g.isTailPunc()||k){var R=y-1,P=y-o.getLength(),I=!1;S=g;var L=void 0;if(!l&&o.spaceCnt>0){for(var A=-1;R>P;R--){if(w=c[R],-1!==A){if(w.isSpace()){if(S.isPureHeadPunc()){A=R;break}}else if(!w.isUnderlineChar&&!w.isPureHeadPunc())break}else if(o.spaceCnt>0&&w.isSpace()&&(S.isPureHeadPunc()||!(S.isAlphaPunc()||h&&S.isTailPunc()))){if(S.isPureHeadPunc()){A=R;break}-1===A&&(A=R)}else{if(w.isRealAsia()){A=R;break}S.isPureHeadPunc()&&-1===A&&(A=R)}if(o.spaceCnt<1&&-1!==A||!h)break;S=w}(R=A)<=P?(R=y-1,S=g):S=c[R+1]}for(;R>P;R--){if(!(w=c[R]).isNoBreakLinePunc()&&w.isLineSplitChar()){(S.isAlphaPunc()||h&&(S.isTailPunc()||w.isPureHeadPunc()))&&R--,I=!0;break}if(!w.isNoBreakLinePunc()&&(w.isSpace()||w.isAlphaPunc()||h&&w.isTailPunc())){if(S.isPureHeadPunc()||!(S.isAlphaPunc()||h&&S.isTailPunc())){var B=w.isAlphaPunc()&&S.isAlpha();if(!((w.isAlphaPunc()||w.isNum)&&S.isNum)&&!B&&!S.isSpace()){I=!0;break}}}else L=L||R,I=!1;S=w}L&&(I||(g.isAlphaPunc()||h&&g.isTailPunc())&&(R=L-1,I=!0)),I&&R>=P?(o.removeLastGlyphs(y-R-1),y=R):y--}else y--}a.appendTypoTextLine(o),(o=a.createTypoTextLine()).x=i,p=d-o.x,f=0}}o.getLength()>0&&a.appendTypoTextLine(o)}},{key:"isNeedbackforward",value:function(e){return e.usrType&&!e.isChinese}},{key:"calcLinesPosition",value:function(e){var t=this._data,i=e.width,n=t.getTypoTextLines(),r=n.length;if(!(r<1)){var a=t.getTypoAutoNum(),o=t.getLineSpacing(),s=o.value/100,l=t.first,h=t.last;l||(e.y=0);var u=t.getAlignMode(),c=this._textLineLayouter,d=0,p=0;t.isEmpty=!0;var f=[],g=t.getMargin(n[0].maxFontsize,n[n.length-1].maxFontsize);if(t.isR2L&&this._measureGlyphDirection(),n.forEach((function(n,y){n.parent=t,n.index=y;var v=y===r-1;n.setLastLine(v),c.update(n),e.x=n.x,e.width=i-e.x,c.measure({rect:e,textAlign:u}),f.push(n.getBeginCcp());var m=n.x+n.width-n.tailSpaceWidth,_=t.parent.getAutoFit(),w=t.getAlignMode();if(_===C.AutoFit.Advanced&&w!==C.HorzAlignMode.Center){for(var S=n.getGlyphs(),x=S.length-1,T=S[x];T&&T.isLineBreak();)T=S[--x];T&&T.isCompressed&&(m-=T.width)}d<m&&(d=m),0===y&&a&&(a.x+=n.offsetLeft),n.lineHeight=0;var k=n.height,b=o.value,E=1;switch(o.rule){case C.LineSpaceRule.Auto:b=k*(E=s-t.lineSpaceReduction)*1;break;case C.LineSpaceRule.Least:k>b&&(b=k);break;case C.LineSpaceRule.Exact:var R=t.getVerticalType(),P=b-n.height;R===C.TextDirectionType.Horizontal&&n.getGlyphs().forEach((function(e){return e.y+=P})),n.height=b;break;default:b=k}if(n.lineHeight+=b,n.y+=b-n.height,n.descent=n.lineHeight*(E<=1?.2:.22),v&&h&&n.lineHeight>n.height){var I=.2*n.height-n.descent;n.lineHeight+=I,n.y+=I,n.descent=.2*n.height}n.marginBottom=0,0!==y||l||(n.lineHeight+=g.top,n.y+=g.top),!h&&v&&(n.lineHeight+=g.bottom,n.y+=g.bottom,n.descent+=g.bottom),1===n.getLength()&&c.getGlyph(0).isLineBreak()?p+=n.lineHeight:(p=0,t.isEmpty=!1),e.y+=n.lineHeight,t.lastEmptyHeight=p})),t.setTextLinesCcp(f),t.width=d,t.overflowTop=0,t.overflowLeft=0,a){var y=n[0],v=y.y+y.height;y.height<a.height&&(v+=a.descent-y.descent),a.y=v-a.height,v+=t.y,a.height}else{var m=n[0];m&&(m.y<0&&(t.overflowTop=m.y),t.overflowTop+=m.overflowTop)}t.height=e.y}}},{key:"_measureGlyphDirection",value:function(){for(var e=this._data.getGlyphs(),t=[],i=0,n=e.length;i<n;i++){var r=e[i],a=e[i-1],o=e[i+1],s=r.getCharInfo(),l=a&&a.getCharInfo(),h=o&&o.getCharInfo();if(r.isRightChar)r.direction="R2L";else if(s.isAlpha||s.isChinese)r.direction="L2R";else if(s.isDigit){for(var u=a,c=i-1;u&&!co(u);)u=e[--c];r.numberType=u&&u.getCharInfo().isArabic?"AN":"EN",r.direction="L2R"}else oo(r)&&l&&"EN"===l.numberType&&h&&"EN"===h.numberType?r.direction="L2R":t.push(i)}this._measureNeutralGlyphs(t)}},{key:"_measureBracket",value:function(){for(var e=this._data.getGlyphs(),t=0,i=e.length;t<i;){var n=e[t];if(go(n)){var r=this._getBetweenBracketGlyphs(n.getChar(),t);if(r){var a=r.length,o=r[0],s=r[a-1];r.hasRightChar?(o.direction="R2L",s.direction="R2L"):e[t-1]&&e[t-1].isRightChar||e[t+a]&&e[t+a].isRightChar||(o.direction="L2R",s.direction="L2R")}t+=r.length||1}else++t}}},{key:"_getBetweenBracketGlyphs",value:function(e,t){for(var i=this._data.getGlyphs(),n=t,r=i[n],a=[];r;){if(a.push(r),e===po[r.getChar()])return a;a.hasRightChar=a.hasRightChar||r.isRightChar,r=i[++n]}return!1}},{key:"_measureNeutralGlyphs",value:function(e){for(var t=this._data.getGlyphs(),i=0,n=e.length;i<n;i++){var r=e[i],a=t[r];if(!a.direction){for(var o=t[r-1],s=r;o&&(!o.direction||!co(o)&&!o.isNum);)o=t[--s];var l=t[r+1];for(s=r;l&&(!l.direction||!co(l)&&!l.isNum);)l=t[++s];if(uo(a)&&o&&o.isNum&&l&&l.isNum)a.direction="L2R";else{if(lo(a)){for(var h=t[r-1],u=i;h&&lo(h);)h=t[--u];var c=t[r+1];for(u=i;c&&lo(c);)c=t[++u];if(h&&"EN"===h.numberType||c&&"EN"===c.numberType){a.direction="L2R";continue}}o&&"L2R"===o.direction||l&&"L2R"===l.direction||a.isSpace()&&!l&&o&&"L2R"===o.direction?a.direction="L2R":a.direction="R2L"}}}}},{key:"adjTextVerticalView",value:function(e){var t=this._data,i=this._textLineLayouter,n=t.getTypoTextLines(),r=t.getTypoAutoNum(),a=t.height,o=t.getVerticalType(),s=t.width;n.forEach((function(t,n){if(i.update(t),i.adjTextVerticalView(e),o===C.TextDirectionType.Vertical270)0===n&&r&&(B(r),r.x=t.x,r.y=s-r.y-r.width,D(r)),t.y=s-t.height-t.y;else{t.x=a-t.x-t.width;var l=i.getGlyph(0);0===n&&r&&(B(r),r.x=t.x+l.x,D(r))}})),B(t),D(t)}},{key:"hitTest",value:function(e){var t=this._data,i=Object.assign({},e);i.x=i.x||0,i.y=i.y||0,i.x-=t.x,i.y-=t.y;for(var n=t.getVerticalType(),r=this._textLineLayouter,a=t.getTypoTextLines(),o=0;o<a.length;o++){var s=a[o];if(s.pointInRectHorizontal(i,n===C.TextDirectionType.Horizontal)){r.update(s);var l=Object.assign({},i);l.x-=s.x,l.y-=s.y;var h=r.hitTest(l).ret;return h&&(h.needRender&&(h.needRender=0===o&&!!t.getTypoAutoNum()),h.needRender=h.needRender||h.showComplex),h&&(h.paragraphText=t.text,h.paragraphBeginCcp=t.getBeginCcp()),h}}return null}},{key:"getSelectRectByGcp_xxx",value:function(e,t){for(var i=this._data,n=i.getBeginCcp(),r=[],a=null,o=-1,s=i.getVerticalType(),l=function(i){var n=i.parent,l=n.x+i.x,h=n.y+i.y,u=0,c=0;if(o!==n.index){if(s===C.TextDirectionType.Horizontal){var d=0;if(e===t)0!==i.getScriptPosition()&&(d=n.descent-i.descent);h=e===t?h-1.05*i.fontSize-d:n.y+n.height-n.lineHeight+n.marginBottom,c=e===t?1.05*i.fontSize:n.lineHeight}else if(l=n.x,e===t){var p=!1;s===C.TextDirectionType.EastAsianVer&&i.isVerticalRightChar()&&(p=!0),u=p?i.height:i.width}else u=n.lineHeight;a={x:l,y:h,width:u,height:c},r.push(a),o=n.index}if(s===C.TextDirectionType.Horizontal)a.x=Math.min(a.x,l),a.width=Math.max(a.width,i.x+i.width);else{var f=i.height;s===C.TextDirectionType.EastAsianVer?(i.isVerticalRightChar()&&(f=i.width),a.y=Math.min(a.y,h-f),a.height=Math.max(a.height,i.y)):s===C.TextDirectionType.Vertical270?(a.y=e===t?Math.min(a.y,h):Math.min(a.y,h-f),a.height=Math.max(a.height,i.y)):(a.y=Math.min(a.y,h),a.height=Math.max(a.height,i.y+f))}},h=i.getTypoTextLines(),u=0;u<h.length;u++){var c=h[u].getGlyphs().filter((function(i){if(i&&i.parent){var r=i.getGcp()-n.begin;return t===e?r===e:r>=e&&r<t}}));if(1===c.length){if(l(c.first()),e===t)break}else c.length>1&&(l(c.first()),l(c.last()))}return r}},{key:"getSelectRectByGcp",value:function(e,t,i){for(var n=this._data,r=n.getBeginCcp(),a=[],o=[],s=null,l=-1,h=n.getVerticalType(),u=n.getTypoTextLines(),c=void 0,d=function(i){var n=u[i],o=void 0,s=n.getGlyphs().filter((function(i){if(i&&i.parent){var n=i.getGcp()-r.begin;return t===e?(n!==e?o=i:c=o,n===e):n>=e&&n<t}}));return a.push.apply(a,S()(s)),e===t&&1===s.length?(c&&a.unshift(c),"break"):a.length>0&&0===s.length?"break":void 0},p=0;p<u.length;p++){if("break"===d(p))break}var f=function(e,t,i){if(e&&t&&i){var r=e.gcps,a=Math.min.apply(Math,S()(r));if(1===r.length)if(e.typoGlyph&&e.typoGlyph.isRightChar)h===C.TextDirectionType.Horizontal?(e.beginPos={x:i.x,y:t.y},e.endPos={x:t.x,y:i.y}):(e.beginPos={x:t.x,y:i.y},e.endPos={x:i.x,y:t.y});else{if(n.isR2L&&e.typoGlyph&&e.typoGlyph.isLineBreak()){var o=n.getGlyphByGcp(e.gcps[0]-1);o&&!o.isRightChar&&o.parent&&h===C.TextDirectionType.Horizontal&&(e.cursorX=o.parent.x+o.x+o.width)}e.beginPos=t,e.endPos=i}else r[0]===a?(e.beginPos=t,e.endPos=i):r[r.length-1]===a||n.isR2L?h===C.TextDirectionType.Horizontal?(e.beginPos={x:i.x,y:t.y},e.endPos={x:t.x,y:i.y}):(e.beginPos={x:t.x,y:i.y},e.endPos={x:i.x,y:t.y}):(e.beginPos=t,e.endPos=i)}},g=void 0,y=void 0;for(p=c?1:0;p<a.length;p++){var v=a[p],m=a[p-1],_=v.getGcp()-r.begin,w=v.parent,x=!1;if(h===C.TextDirectionType.EastAsianVer&&(v.isVerticalRightChar()||v.isVerticalTopRightCornerChar()||v.isRealAsia())&&(x=!0),l!==w.index||m&&m.index!==v.index-1){if(_===t&&l>-1)break;f(s,g,y),l=w.index;var T=p,k=v.getFontColor(),b=void 0;if(p>0){if(v.isRightChar){k=a[T].getFontColor();var E=w.getGlyphByGcp(v.getGcp()-1);b=E?E.getFontColor():k}else b=a[T-1].getFontColor();a[T-1].parent&&a[T-1].parent.index===l&&T--}else if(v.isRightChar){k=a[T].getFontColor();var R=w.getGlyphByGcp(v.getGcp()-1);b=R?R.getFontColor():k}var P=a[T];if(e===t){var I=w.getGlyphByGcp(v.getGcp()-1);P=i?(P.isRightChar||P.isLineBreak()&&"R2L"===P.direction)&&I||v:P.isRightChar||P.isLineBreak()&&"R2L"===P.direction?v:I||v}if(h===C.TextDirectionType.Horizontal){var L=1.3*P.fontSize,A=.3*P.fontSize,B=w.descent;s={x:w.x+v.x,y:e===t?w.y+P.y-L-B+A:w.y+w.height-w.lineHeight+w.marginBottom,width:v.width+v.spacing,height:e===t?L:w.lineHeight,char:v.getChar(),gcps:[v.getGcp()],typoGlyph:v,dx:v.x,color:k,prevColor:b}}else{var D=x?v.width:v.height;if(s={x:w.x,y:w.y+v.y,width:e===t?1.3*P.fontSize:w.lineHeight,height:D+v.spacing,char:v.getChar(),gcps:[v.getGcp()],typoGlyph:v,dy:v.y,color:k,prevColor:b},h===C.TextDirectionType.EastAsianVer)if(s.y-=v.height,t!==e)s.x-=w.marginBottom;else{s.x+=w.descent-P.descent;var M=P.getScriptPosition();if(0!==M){var O=P.descent;O*=1-M/100,s.x+=P.x+O}}else if(h===C.TextDirectionType.Vertical){if(t===e){var N=P.getScriptPosition();if(0!==N){var F=.18*w.width-P.descent;F*=1-N/100,s.x+=P.x-F}}}else if(h===C.TextDirectionType.Vertical270)if(t===e){s.x=w.x+w.width-P.width;var V=P.getScriptPosition();if(0!==V){var U=w.descent-P.descent;U*=1-V/100,U=V>0?-U:U,s.x+=U}}else s.y-=v.height,s.x-=w.lineHeight-w.width-w.marginBottom;else if(h===C.TextDirectionType.VerticalWordArtRightToLeft&&t===e){var G=P.getScriptPosition();if(0!==G){var H=.18*w.width-P.descent;H*=1-G/100,s.x+=P.x-H}}}g={x:s.x,y:s.y},y={x:e===t?s.x:s.x+s.width,y:s.y+s.height},o.push(s)}else if(p!==t)if(s.gcps.push(v.getGcp()),h===C.TextDirectionType.Horizontal)s.width=v.x-s.dx+v.width,y.x=g.x+v.x-s.dx+v.width;else{var W=x?v.width:v.height;s.height+=v.spacing+W,y.y+=v.spacing+W,h===C.TextDirectionType.Vertical270&&(s.y-=v.height,g.y-=v.height)}}return f(s,g,y),console.log("selectRect",o),o}},{key:"getNextGcpByDirectionKeys",value:function(e){var t=e.curGcp,i=e.prevGlyph,n=e.direction,r=e.code,a=e.isLastPara,o=e.isFirstPara,s=this._data,l=s.getGlyphs(),h=s.getBeginCcp().ccp;t>=h&&(t=h-1);var u=s.getGlyphByGcp(t);if(!u)return null;var c=u.index,d=u.parent;if(!d)return null;var p=d.index,f=s.getTypoTextLines(),g=f.length,y=s.getVerticalType();if(n)if(i||(i=u),y===C.TextDirectionType.Horizontal){if(n===Ka.KeyCode.down){if((p=d.index+1)>=g){if(!a)return{code:"next",ccp:c,prevGlyph:i};var v=d.getGlyphs();c=(i=v[v.length-1]).index,p=d.index}}else if(n===Ka.KeyCode.up&&(p=d.index-1)<0){if(!o)return{code:"prev",ccp:c,prevGlyph:i};c=(i=d.getGlyphs()[0]).index,p=d.index}}else if(n===Ka.KeyCode.left){if((p=d.index+1)>=g){if(!a)return{code:"next",ccp:c,prevGlyph:i};var m=d.getGlyphs();c=(i=m[m.length-1]).index,p=d.index}}else if(n===Ka.KeyCode.right&&(p=d.index-1)<0){if(!o)return{code:"prev",ccp:c,prevGlyph:i};c=(i=d.getGlyphs()[0]).index,p=d.index}var _=f[p];if("prev"===r&&(_=f[g-1]),l=_.getGlyphs()){c>=l.length&&(c=l.length-1);var w=l[c],S={x:s.isR2L?i.x+i.parent.x+i.width:i.x+i.parent.x,y:i.y+i.parent.y},x={x:s.isR2L?w.x+_.x+w.width:w.x+_.x,y:w.y+_.y};if(this.compareGlyphPos(S,x)<0){for(var T=void 0;this.compareGlyphPos(S,x)<0;){if(y===C.TextDirectionType.Vertical270){if(++c>=l.length-1)break}else if(--c<0)break;T=w,w=l[c],x={x:s.isR2L?w.x+_.x+w.width:w.x+w.parent.x,y:w.y+w.parent.y}}if(y===C.TextDirectionType.Vertical270){if(T=T||l[c-1]){var k={x:s.isR2L?T.x+_.x+T.width:T.x+T.parent.x,y:T.y+T.parent.y};Math.abs(k.x-S.x)<Math.abs(x.x-S.x)&&c--}}else if(T=T||l[c+1]){var b={x:s.isR2L?T.x+_.x+T.width:T.x+T.parent.x,y:T.y+T.parent.y};Math.abs(b.x-S.x)<Math.abs(x.x-S.x)&&c++}}else{for(var E=void 0;this.compareGlyphPos(S,x)>0;){if(y===C.TextDirectionType.Vertical270){if(--c<0)break}else if(++c>=l.length-1)break;E=w,w=l[c],x={x:s.isR2L?w.x+_.x+w.width:w.x+w.parent.x,y:w.y+w.parent.y}}if(y===C.TextDirectionType.Vertical270){if(E=E||l[c+1]){var R={x:s.isR2L?E.x+_.x+E.width:E.x+E.parent.x,y:E.y+E.parent.y};Math.abs(R.x-S.x)<Math.abs(x.x-S.x)&&c++}}else if(E=E||l[c-1]){var P={x:s.isR2L?E.x+_.x+E.width:E.x+E.parent.x,y:E.y+E.parent.y};Math.abs(P.x-S.x)<Math.abs(x.x-S.x)&&c--}}return c<0&&(c=0),c>=l.length&&(c=l.length-1),{code:"success",gcp:l[c].getGcp()}}return null}},{key:"compareGlyphPos",value:function(e,t){if(this._data.getVerticalType()===C.TextDirectionType.Horizontal){if(Math.abs(e.x-t.x)<2)return 0;if(e.x>t.x)return 1;if(e.x<t.x)return-1}else{if(Math.abs(e.y-t.y)<2)return 0;if(e.y>t.y)return 1;if(e.y<t.y)return-1}return 0}},{key:"getSelectStyleByRange",value:function(e,t){for(var i=this._data,n=null,r=null,a=[],o=e;o<=t;o++){var s=i.getGlyphByGcp(o);if(s){var l=_()({},s.getStyle());if(o<t&&a.push(_()({},s.getCoreFont(),{fontSize:l.fontSize})),s.parent)if(e!==t){if(l.textHyperlink=s.hyperlink,l===r)continue;r=l,n?o!==t&&qa(n,l):n=l}else o>0&&(s=i.getGlyphByGcp(o-1)),l.textHyperlink=s.hyperlink,n?qa(n,l):n=l}}return _()({},i.getStyle(),{chapterStyle:_()({},n,{fontList:a})})}},{key:"convertArabicRenderString",value:function(){for(var e=this._data.getGlyphs(),t=function(t,n){if(!e[t].getCharInfo().isArabic)return"continue";var r=function(e,t,i){var n=1,r=i[e++],a=r.getCharCode();switch(oa.getUnicodeCharItem(a).usrType){case Sa:case xa:case Ta:case ka:case Ca:for(;e<t;){var o=r.getParent(),s=i[e],l=s&&s.getParent(),h=!0;o&&l&&(o.props.fontSize!==l.props.fontSize||o.props.bold!==l.props.bold||o.props.italic!==l.props.italic||o.props.position!==l.props.position)&&(h=!1);var u=r.getCharCode();if(!oa.getUnicodeCharItem(u).isArabic||!h)break;++e,++n}}return n}(t,n,e);if(1===r)return"continue";var a=new Array(r),o={srcBuff:e.slice(t,t+r).map((function(e){return e.getChar().charCodeAt()})),srcPos:0,desBuff:a,desPos:0,len:r};do{for(Fa(o);o.desPos<o.srcPos;)a[o.desPos++]=ro}while(o.len>0);a.forEach((function(i,n){var r=String.fromCharCode(i),a=e[t+n],o=wr(r,a.getParent().getFont(r)),s=o.descent,l=o.height,h=o.width;a.getVerticalType()===C.TextDirectionType.VerticalWordArtRightToLeft&&(h=l),a.setDescent(s),a.setHeight(l),a.setWidth(h),a.realWidth=h,a.setOriginChar(a.props.char),a.setChar(r)})),i=t+=r-1},i=0,n=e.length;i<n;i++)t(i,n)}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),ro=8205,ao={"+":!0,"-":!0},oo=function(e){if(!e)return!1;var t=e.getChar();return ao[t]},so={"°":!0,$:!0,"￥":!0,"€":!0,"₹":!0,"#":!0,"%":!0},lo=function(e){if(!e)return!1;var t=e.getChar();return so[t]},ho={":":!0,",":!0,".":!0,"/":!0},uo=function(e){if(!e)return!1;var t=e.getChar();return ho[t]};function co(e){return!!e&&(function(e){return!!e&&(e.isRightChar||e.getCharInfo().isArabic)}(e)||function(e){return!!e&&(e.getCharInfo().isAlpha||e.getCharInfo().isChinese)}(e))}var po={"(":")","<":">","[":"]","{":"}","（":"）","《":"》","【":"】"},fo={")":"(",">":"<","]":"[","}":"{","）":"（","》":"《","】":"【"};function go(e){return!!e&&fo[e.getChar()]}var yo,vo=function(){function e(t){r()(this,e),this._data=t,this.init()}return o()(e,[{key:"init",value:function(){this._textParagraphLayouter=no.getInstance()}},{key:"update",value:function(e){return this._data=e,this.init(),this}},{key:"measure",value:function(e){var t=this._data;if(t){var i=e.rect,n=t.getMargin();i.x+=n.left,i.y+=n.top,i.width-=n.left+n.right,i.height-=n.top+n.bottom,t.setRect(i.x,i.y,i.width,i.height),t.overflowLeft=0,t.overflowTop=0;var r=this.composeTextBody({rect:{x:0,y:0,width:i.width,height:i.height}}),a=t.getScaleXY(),o=r.overflowLeft*a.x,s=r.overflowTop*a.y,l={height:r.height*a.y,width:r.width*a.x};t.realRect=l,this.adjContentVerticalAlign(i,l);var h=t.getVerticalType(),u=t.getTextAlign();if(h===C.TextDirectionType.Horizontal&&u===C.TextAnchoringType.Bottom&&(s=0),t.x+=o,t.overflowLeft-=o,t.y+=s,t.overflowTop-=s,h===C.TextDirectionType.Horizontal){var c=r.height;t.height=c;var d=r.width;t.width<d?t.width=d+n.right/a.x:t.width=d}else this.adjTextVerticalView(r);if(i.width<l.width){var p=t.getChilds();p&&p.forEach((function(e,t){e.getAlignMode()===C.HorzAlignMode.Center&&h===C.TextDirectionType.Horizontal&&(e.x-=(l.width-i.width)/2)}))}}}},{key:"composeTextBody",value:function(e){var t=this._data,i=e.rect,n=e.scale,r=Object.assign({},i),a=t.getVerticalType();a!==C.TextDirectionType.Horizontal&&D(r);var o=[],s=t.getWrapText(),l=this._textParagraphLayouter,h=0,u=0;i.overflowLeft=0,i.overflowTop=0;var c=t.getChilds(),d=0;if(c&&c.forEach((function(e,a){e.parent=t,e.index=a,0===a&&(e.first=!0),a===c.length-1&&(e.last=!0),l.update(e),l.measure({wrapText:s,rect:r,adjScale:n}),o.push.apply(o,S()(e.getTextLinesCcp())),e.first||(d+=e.lastEmptyHeight),e.isEmpty||(d=e.lastEmptyHeight),r.y+=e.height,h<e.width&&(h=e.width);var u=e.overflowLeft,p=e.overflowTop;i.overflowLeft>u&&(i.overflowLeft=u),e.first&&i.overflowTop>p&&(i.overflowTop=p),(!a||t.minFontSize>e.minFontSize)&&(t.minFontSize=e.minFontSize),(!a||t.maxFontSize>e.maxFontSize)&&(t.maxFontSize=e.maxFontSize)})),t.setAllTextLinesCcp(o),u=r.y,t.getAutoFit()===C.AutoFit.Normal){if(t.isTitlePlaceHolder()||(u-=d),i.width>0&&i.height>0){var p=this.adjContentRect(i,{height:u,width:h},e.fontScaleDelt);if(p)return p;a!==C.TextDirectionType.Horizontal&&(t.width=u)}}else t.fontScale=1,a===C.TextDirectionType.Horizontal?(h<i.width&&(h=i.width),t.width=h,t.height=u):(h<i.height&&(h=i.height),t.width=u,t.height=h);return u-=i.overflowTop,i.height=u,i.width=h,i.overflowTop*=-1,i.overflowLeft*=-1,i}},{key:"adjContentVerticalAlign",value:function(e,t){var i=this._data,n=i.getVerticalType(),r=i.getAutoFit(),a=this.getVerticalDeltXY(e,t);if(n===C.TextDirectionType.Horizontal){var o=a.y;r===C.AutoFit.Advanced?i.overflowTop=o:o>0?i.y+=o:i.overflowTop=o}else{var s=a.x;r===C.AutoFit.Advanced?i.overflowLeft=s:s>0?i.x+=s:i.overflowLeft=s}}},{key:"getVerticalDeltXY",value:function(e,t){var i=this._data,n=i.getTextAlign(),r=t.height,a=i.getVerticalType(),o=0,s=0;return a===C.TextDirectionType.Horizontal?n===C.TextAnchoringType.Center?o=(e.height-r)/2:n===C.TextAnchoringType.Bottom&&(o=e.height-r):n===C.TextAnchoringType.Center?s=(e.width-r)/2:a===C.TextDirectionType.Vertical270?n===C.TextAnchoringType.Bottom&&(s=e.width-r):n===C.TextAnchoringType.Top&&(s=e.width-r),{x:s,y:o}}},{key:"adjContentRect",value:function(e,t,i){var n=this._data,r=t.height,a=n.getVerticalType(),o=n.getRect();a!==C.TextDirectionType.Horizontal&&D(o);var s=n.getMinScale(),l=n.fontScale,h=r-o.height;if(!(h<=0)){var u=h/o.height;if(!(Math.abs(u)<.01||(i=-u/3,l<=s)))return l+i<=s&&(i=s-l),n.fontScale+=i,this.composeTextBody({rect:Object.assign({},e),fontScaleDelt:i})}}},{key:"adjTextVerticalView",value:function(e,t){var i=this._data,n=this._textParagraphLayouter,r=i.width,a=i.height,o=i.getVerticalType();i.getChilds().forEach((function(e){n.update(e),n.adjTextVerticalView(),o===C.TextDirectionType.Vertical270?e.y+=a-e.height:(r-=e.width,e.x=r)}))}},{key:"hitTest",value:function(e){var t=this._data,i=Object.assign({},e),n=t.getScaleXY();i.x-=t.x,i.y-=t.y,i.x=i.x/n.x||0,i.y=i.y/n.y||0;for(var r=t.getVerticalType(),a=this._textParagraphLayouter,o=t.getChilds(),s=0;s<o.length;s++){var l=o[s];if(l.pointInRectHorizontal(i,r===C.TextDirectionType.Horizontal)){var h=void 0;return t.isEmpty()?((h={}).gcp=0,h.needRender=!0):(a.update(l),h=a.hitTest(i)),h&&(h.type=C.CursorType.Text,h.verticalType=r),h}}}},{key:"getSelectRectByGcp",value:function(e,t,i){var n=this._data;if(!n)return[];for(var r=[],a=this._textParagraphLayouter,o=n.getChilds(),s=n.getScaleXY(),l=n.getVerticalType(),h=function(h){var u=o[h],c=u.getBeginCcp();if(c.begin<=e){if(c.begin+c.ccp>=e){a.update(u);var d=a.getSelectRectByGcp(e-c.begin,t-c.begin,i);if(d&&d.length>0&&(d.forEach((function(e){e.x+=u.x,e.y+=u.y,e.x*=s.x,e.width*=s.x,e.y*=s.y,e.height*=s.y,e.x+=n.x,e.y+=n.y,e.verticalType=l,e.beginPos.x+=u.x,e.beginPos.y+=u.y,e.endPos.x+=u.x,e.endPos.y+=u.y,e.beginPos.x*=s.x,e.beginPos.y*=s.y,e.endPos.x*=s.x,e.endPos.y*=s.y,e.beginPos.x+=n.x,e.beginPos.y+=n.y,e.endPos.x+=n.x,e.endPos.y+=n.y,e.cursorX+=u.x,e.cursorX*=s.x,e.cursorX+=n.x})),r.push(d)),t<c.begin+c.ccp)return"break";if(e!==t&&t<=c.begin+c.ccp)return"break"}}else{a.update(u);var p=a.getSelectRectByGcp(0,t-c.begin,i);if(p&&p.length>0&&(p.forEach((function(e){e.x+=u.x,e.y+=u.y,e.x*=s.x,e.width*=s.x,e.y*=s.y,e.height*=s.y,e.x+=n.x,e.y+=n.y,e.beginPos.x+=u.x,e.beginPos.y+=u.y,e.endPos.x+=u.x,e.endPos.y+=u.y,e.beginPos.x*=s.x,e.beginPos.y*=s.y,e.endPos.x*=s.x,e.endPos.y*=s.y,e.beginPos.x+=n.x,e.beginPos.y+=n.y,e.endPos.x+=n.x,e.endPos.y+=n.y,e.cursorX+=u.x,e.cursorX*=s.x,e.cursorX+=n.x})),r.push(p)),c.begin+c.ccp>=t)return"break"}},u=0;u<o.length;u++){if("break"===h(u))break}return r}},{key:"getNextGcpByDirectionKeys",value:function(e,t){var i=this._data,n=this._textParagraphLayouter;if(i){var r=i.getChilds(),a=i.getAllTextLinesCcp();if(t===Ka.KeyCode.home)for(var o=0;o<a.length;o++){var s=a[o];if(s.begin<=e&&e<=s.ccp)return{gcp:s.begin}}else if(t===Ka.KeyCode.end)for(var l=0;l<a.length;l++){var h=a[l];if(h.begin<=e&&e<=h.ccp)return{gcp:h.ccp}}for(var u=0;u<r.length;u++){var c=r[u],d=c.getBeginCcp(),p=u===r.length-1,f=0===u;if(d.begin<=e&&d.begin+d.ccp>e){n.update(c);var g=n.getNextGcpByDirectionKeys({curGcp:e-d.begin,direction:t,isFirstPara:f,isLastPara:p});if(g){var y=g,v=y.code,m=y.ccp,_=y.prevGlyph;if("next"===v){if(u>=r.length-1)return g;c=r[u+1],n.update(c),g=n.getNextGcpByDirectionKeys({curGcp:m,prevGlyph:_,code:v})}else if("prev"===v){if(u<1)return g;c=r[u-1],n.update(c),g=n.getNextGcpByDirectionKeys({curGcp:m,prevGlyph:_,code:v})}}return g}}}}},{key:"getSelectStyleByRange",value:function(e,t){var i=this._data;if(i){for(var n=_()({},i.getStyle(),{scale:i.getScaleXY(),autoFit:i.getCoreAutoFit()}),r=this._textParagraphLayouter,a=i.getChilds(),o={},s=[],l=[],h=0;h<a.length;h++){var u=a[h],c=u.getBeginCcp();if(c.begin<=e){if(c.begin+c.ccp>=e){r.update(u);var d=o=r.getSelectStyleByRange(e-c.begin,t-c.begin)||{},p=d.listType,f=d.autoNumType,g=d.bulletChar,y=d.rightToLeft,v=d.alignMode;if(s.push({listType:p,autoNumType:f,bulletChar:g}),l.push({rightToLeft:y,alignMode:v,start:e,end:t}),t<c.begin+c.ccp)break}}else{r.update(u);var m=r.getSelectStyleByRange(e-c.begin,t-c.begin);if(m){if(!Array.isArray(o.outline)){var w=o.outline?o.outline:0;o.outline=[w]}var S=m.listType,x=m.autoNumType,T=m.bulletChar,k=m.rightToLeft,C=m.alignMode,b=m.outline?m.outline:0;o.outline.push(b),s.push({listType:S,autoNumType:x,bulletChar:T}),l.push({rightToLeft:k,alignMode:C,start:c.begin,end:c.begin+c.ccp}),Xa(o,m)}if(c.begin+c.ccp>=t)break}}return n.autonumList=s,n.paragraphStyle=o,n.rightToLeftMap=l,n}}},{key:"getParagraphByGcp",value:function(e){return this._data.getParagraphByGcp(e)}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),mo=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.childs=[],i.props=e,i}return u()(t,e),o()(t,[{key:"getChildAt",value:function(e){return this.childs[e]}},{key:"getChildCount",value:function(){return this.childs.length}},{key:"appendChild",value:function(e){this.childs.push(e)}},{key:"insertChild",value:function(e,t){this.childs.splice(t,0,e)}},{key:"setChildAt",value:function(e,t){this.childs[t]=e}},{key:"getChildren",value:function(){return this.childs}},{key:"setDrawRect",value:function(e){var t=Object.assign({},e);this._drawRect=t}},{key:"getDrawRect",value:function(){return this._drawRect}},{key:"getStyle",value:function(){return this._style}},{key:"destroy",value:function(){this.childs.forEach((function(e){e.destroy()})),delete this.childs,delete this.props}}]),t}(Ja),_o=i(874),wo=_o.d,So=_o.a,xo=(yo={},d()(yo,So.LLetterWithDot,{getFormatedElement:function(e){return To(e)+"."}}),d()(yo,So.ULetterWithDot,{getFormatedElement:function(e){return ko(e)+"."}}),d()(yo,So.Ea1JpnChsWithDbDot,{getFormatedElement:function(e){return Fo(e)+"."}}),d()(yo,So.LChineseGB,{getFormatedElement:function(e){return Fo(e)}}),d()(yo,So.LChineseWithDot,{getFormatedElement:function(e){return Fo(e)+"."}}),d()(yo,So.LRomaWithLRBracket,{getFormatedElement:function(e){return"("+Eo(e).toLocaleLowerCase()+")"}}),d()(yo,So.LRomaWithRBracket,{getFormatedElement:function(e){return Eo(e).toLocaleLowerCase()+")"}}),d()(yo,So.LRomaWithDot,{getFormatedElement:function(e){return Eo(e).toLocaleLowerCase()+"."}}),d()(yo,So.URomaWithDot,{getFormatedElement:function(e){return Eo(e)+"."}}),d()(yo,So.URomaWithLRBracket,{getFormatedElement:function(e){return"("+Eo(e)+")"}}),d()(yo,So.URomaWithRBracket,{getFormatedElement:function(e){return Eo(e)+")"}}),d()(yo,So.LLetterWithLRBracket,{getFormatedElement:function(e){return"("+To(e)+")"}}),d()(yo,So.LLetterWithRBracket,{getFormatedElement:function(e){return To(e)+")"}}),d()(yo,So.ULetterWithLRBracket,{getFormatedElement:function(e){return"("+ko(e)+")"}}),d()(yo,So.ULetterWithRBracket,{getFormatedElement:function(e){return ko(e)+")"}}),d()(yo,So.ArabicWithRound,{elements:["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳"],getFormatedElement:function(e){return e<=this.elements.length?this.elements[e-1]:xo[So.Arabic].getFormatedElement(e)}}),d()(yo,So.Arabic,{getFormatedElement:function(e){return""+e}}),d()(yo,So.ArabicWithRBracket,{getFormatedElement:function(e){return e+")"}}),d()(yo,So.ArabicWithDot,{getFormatedElement:function(e){return e+"."}}),d()(yo,So.ArabicChar,{getFormatedElement:function(e){return"•"}}),d()(yo,So.None,{getFormatedElement:function(e){return"•"}}),d()(yo,"46",{elements:["أ‌","ب","ت","ث","ج‌","ح","خ","د","ذ‌","ر","ز‌","س","ش","ص‌","ض‌","ط","ظ‌","ع","غ","ف","ق‌","ك","ل","م","ن‌","ه‌","و","ي"],getFormatedElement:function(e){return Co(e,this.elements)}}),d()(yo,"49",{elements:["क","ख","ग","घ","ङ","च","छ","ज","झ","ञ","ट","ठ","ड","ड","ण","त","थ","द","ध","न","ऩ","प","फ","ब","भ","म","य","र","ऱ","ल","ळ","ऴ","व","श","ष","स","ह"],getFormatedElement:function(e){return Co(e,this.elements)}}),yo);function To(e){var t=["z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y"],i="";for(e=e>780?e%780:e;e>0;)i=t[e%26]+i,e-=26;return i}function ko(e){var t=["Z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y"],i="";for(e=e>780?e%780:e;e>0;)i=t[e%26]+i,e-=26;return i}function Co(e,t){if(e<=t.length)return t[e-1];var i=Math.floor((e-1)/t.length)+1;return t[(e-1)%t.length].repeat(i)}function bo(e){var t=Math.floor(e%1e5/1e4),i=Math.floor(e%1e4/1e3),n=Math.floor(e%1e3/100),r=Math.floor(e%100/10),a=e%10;return 0!==t?[t,i,n,r,a]:0!==i?[i,n,r,a]:0!==n?[n,r,a]:0!==r?[r,a]:[a]}function Eo(e){var t=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM","MMMM","MMMMM","MMMMMM","MMMMMMM","MMMMMMMM","MMMMMMMMM"]],i=bo(e),n="";return i.forEach((function(e,r){(r=i.length-1-r)<t.length&&(n+=t[r][e]||"")})),n}var Ro="〇",Po="一",Io="二",Lo="三",Ao="四",Bo="五",Do="六",Mo="七",Oo="八",No="九";function Fo(e){var t=[Ro,Po,Io,Lo,Ao,Bo,Do,Mo,Oo,No];return bo(e).reduce((function(e,i){return e+t[i]}),"")}var Vo=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=xo[e],r=n?n.getFormatedElement(t):xo[So.None].getFormatedElement(t);return null!=r?r:i};var Uo=function(e){function t(e){var i=e.parent,n=e.data,a=e.txtSpan;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));o._parent=i,o._data=n,o._txtSpan=a;var s=n.listType,h=n.index,u=n.bulletChar,c=n.autoNumType;if(o._hasBullet=!1,o._effects=o._txtSpan.getArtTextEffectList()||{},o._artTextOutLineFill=o._txtSpan.artTextOutLineFill()||{},o._fillColor=o._txtSpan.getGradientColor()||{},s===wo.Bullet){if(u)if(o._hasBullet=!0,(u=he.a[u]||u)<=255){var d=Go[u],p=v.userAgent.isMobile||v.userAgent.isIPad;216===u&&p&&(u=187,d=""),d&&(p||v.userAgent.isFirefox||v.userAgent.isAndroidPad)?(o._data.text=String.fromCharCode(d),o.fontFamily="Unicode"):(o._data.text=String.fromCharCode(u),o.fontFamily="Wingdings")}else o._data.text=String.fromCharCode(u),o.fontFamily="Unicode"}else if(s===wo.AutoNum){o._hasBullet=!0;var f=Vo(c,h,"");o._data.text=f}else wo.Image;return o}return u()(t,e),o()(t,[{key:"hasBullet",value:function(){return this._hasBullet}},{key:"formatAutoNum",value:function(e){var t=e,i=t.index,n=t.listId,r=t.next,a="",o=xo[n];if(o){var s=o.xst,l=o.nfc;for(a=Vo(i,s,l),e=r;e;){var h=e,u=h.index,c=h.next;a=""+a+Vo(u,s,l),e=c}}return a}},{key:"isHidden",value:function(){return this._txtSpan.isHidden()}},{key:"getText",value:function(){return this._data.text}},{key:"getFont",value:function(){var e=this._txtSpan.getFont();return e.fontFamily=this.fontFamily||e.fontFamily,e.fontSize*=this.getScalePercent(),e}},{key:"getFontColor",value:function(){var e=this._data.bulletColor;return e&&e.rgba||this._txtSpan.getFontColor()}},{key:"getbulletColor",value:function(){return this._data.bulletColor}},{key:"getArtTextEffectList",value:function(){return this._effects}},{key:"artTextOutLineFill",value:function(){return this._artTextOutLineFill}},{key:"getGradientColor",value:function(){return this._fillColor}},{key:"getParent",value:function(){return this._txtSpan||{}}},{key:"getCssStyle",value:function(e){var t=this.getFont(e),i=t.fontStyle,n=t.fontVariant,r=t.fontWeight,a=t.fontFamily;return i+" "+n+" "+r+" "+t.fontSize+"px "+(a=lr.covertFontfamily(a))}},{key:"getStyle",value:function(e){var t=this.getFont(e),i=t.fontStyle,n=t.fontVariant,r=t.fontWeight,a=t.fontFamily,o=t.fontSize;return{fill:this.getFontColor(),"font-variant":n,"font-weight":r,"font-family":a,"font-size":o,"font-style":i}}},{key:"getVerticalType",value:function(){return this._parent.getVerticalType()}},{key:"getSpacing",value:function(){return this._txtSpan.getSpacing()||75*window.ti2pxRatio}},{key:"getScalePercent",value:function(){var e=this._data.ansizePercent;return(e=e||100)/100}},{key:"descent",get:function(){return this.metrics.descent}},{key:"isR2L",get:function(){return this._parent.isR2L}}]),t}(Ja),Go={32:32,33:128393,34:9986,35:9985,36:128083,37:128365,38:128366,39:128367,40:128383,41:9990,42:128386,43:128387,44:128234,45:128235,46:128236,47:128237,48:128193,49:128194,50:128196,51:128463,52:128464,53:128452,54:8987,55:128430,56:128432,57:128434,58:128435,59:128436,60:128427,61:128428,62:9991,63:9997,64:128398,65:9996,66:128076,67:128077,68:128078,69:9756,70:9758,71:9757,72:9759,73:128400,74:9786,75:128528,76:9785,77:128163,78:9760,79:127987,80:127985,81:9992,82:9788,83:128167,84:10052,85:128326,86:10014,87:128328,88:10016,89:10017,90:9770,91:9775,92:2384,93:9784,94:9800,95:9801,96:9802,97:9803,98:9804,99:9805,100:9806,101:9807,102:9808,103:9809,104:9810,105:9811,106:128624,107:128629,108:9679,109:128318,110:9632,111:9633,112:9744,113:10065,114:10066,115:11047,116:10731,117:9670,118:10070,119:11045,120:8999,121:11193,122:8984,123:127989,124:127990,125:128630,126:128631,128:9450,129:9312,130:9313,131:9314,132:9315,133:9316,134:9317,135:9318,136:9319,137:9320,138:9321,139:9471,140:10102,141:10103,142:10104,143:10105,144:10106,145:10107,146:10108,147:10109,148:10110,149:10111,150:128610,151:128608,152:128609,153:128611,154:128606,155:128604,156:128605,157:128607,158:183,159:8226,160:9642,161:9898,162:128902,163:128904,164:9673,165:9678,166:128319,167:9642,168:9723,169:128962,170:10022,171:9733,172:10038,173:10036,174:10041,175:10037,176:11216,177:8982,178:10209,179:8977,180:11217,181:10026,182:10032,183:128336,184:128337,185:128338,186:128339,187:128340,188:128341,189:128342,190:128343,191:128344,192:128345,193:128346,194:128347,195:11184,196:11185,197:11186,198:11187,199:11188,200:11189,201:11190,202:11191,203:128618,204:128619,205:128597,206:128596,207:128599,208:128598,209:128592,210:128593,211:128594,212:128595,213:9003,214:8998,215:11160,216:11162,217:11161,218:11163,219:11144,220:11146,221:11145,222:11147,223:129128,224:129130,225:129129,226:129131,227:129132,228:129133,229:129135,230:129134,231:129144,232:129146,233:129145,234:129147,235:129148,236:129149,237:129151,238:129150,239:8678,240:8680,241:8679,242:8681,243:11012,244:8691,245:11008,246:11009,247:11011,248:11010,249:129196,250:129197,251:128502,252:10004,253:128503,254:128505},Ho=function(e){function t(e){var i=e.parent,n=e.data,a=e.style;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return o._parent=i,o._data=n,o._style=a||{},o._text_length=0,o._glyphs=[],o._compress_glyphs=[],o._compress_glyphs_width=0,o.tailSpaceCount=0,o.tailSpaceWidth=0,o.hasR2LChPos=[],o.offsetLeft=0,o.overlapW=0,o.maxOverlapW=0,o}return u()(t,e),o()(t,[{key:"getCssStyle",value:function(){return this._style.font}},{key:"setHeight",value:function(e){this.height=e}},{key:"getLength",value:function(){return this._text_length}},{key:"clearGlyphs",value:function(){this._glyphs=[],this._compress_glyphs=[],this._text_length=0,this._compress_glyphs_width=0,this.tailSpaceCount=0,this.tailSpaceWidth=0}},{key:"appendGlyph",value:function(e){e.isRightChar&&this.hasR2LChPos.push(this._glyphs.length),this._glyphs.push(e),this._text_length++,e.isRotateChar?e.height+e.spacing>0&&(this.width+=e.height+e.spacing):e.width+e.spacing>0&&(this.width+=e.width+e.spacing),e.isCompressPunc()&&(this._compress_glyphs.push(e),this._compress_glyphs_width+=e.width+e.spacing),this.spaceCnt=this.spaceCnt||0,e.isSpace()&&this.spaceCnt++,e.isOverlayCh&&(this.overlapW+=e.overlapW,this.maxOverlapW+=e.maxOverlapW)}},{key:"getGlyphs",value:function(){return this._glyphs}},{key:"getBeginCcp",value:function(){return{begin:this._glyphs[0].props.gcp,ccp:this._glyphs[this._glyphs.length-1].props.gcp}}},{key:"getGlyphByGcp",value:function(e){return this.getGlyphs().find((function(t){var i=t.getChar().length,n=t.getGcp();return e>=n&&e<i+n}))}},{key:"getCompressGlyphs",value:function(){return this._compress_glyphs}},{key:"getCompressWidth",value:function(){return this._compress_glyphs_width}},{key:"_removeCompressGlyph",value:function(e){var t=this._compress_glyphs.length;this._compress_glyphs[t-1]===e&&(this._compress_glyphs=this._compress_glyphs.slice(0,length-1),this._compress_glyphs_width-=e.width+e.spacing)}},{key:"removeLastGlyphs",value:function(e){if(!(e<1)){var t=this.getLength();if(!(t<1)){for(var i=t;i>t-e;i--){var n=this._glyphs[i-1];this.width-=n.width+n.spacing,this._glyphs=this._glyphs.slice(0,i-1),this._removeCompressGlyph(n),this.hasR2LChPos.includes(i-1)&&this.hasR2LChPos.pop(),n.isOverlayCh&&(this.overlapW-=n.overlapW,this.maxOverlapW-=n.maxOverlapW)}this._text_length-=e}}}},{key:"setLastLine",value:function(e){this._isLastLine=e}},{key:"isLastLine",value:function(){return this._isLastLine||!1}},{key:"getBgColor",value:function(){return this._style.BgColor||"transparent"}},{key:"getVerticalType",value:function(){return this._parent.getVerticalType()}},{key:"setEmptyLine",value:function(e){this._isEmptyLine=e}},{key:"isEmptyLine",value:function(){return this._isEmptyLine||!1}},{key:"getWrapText",value:function(){return this._parent.getWrapText()}},{key:"isDefText",value:function(){return this._parent.isDefText()}},{key:"isPlaceholder",value:function(){return this._parent.isPlaceholder()}},{key:"maxFontsize",get:function(){var e=this;return!this._maxFsizeGlyph&&this._glyphs.forEach((function(t){(!e._maxFsizeGlyph||e._maxFsizeGlyph.fontSize<t.fontSize)&&(e._maxFsizeGlyph=t)})),this._maxFsizeGlyph.fontSize}},{key:"isR2L",get:function(){return this._parent.isR2L}}]),t}(mo),Wo=function(e){function t(e){var i=e.parent,n=e.data,a=e.style;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return o.mergeSpanLink=function(e,t){var i=o.getActions().mouseClick,n=!1;if(e.getBeginCcp().begin<o._getTextBodyEnd()){var r=(e.getActions()||{}).mouseClick;n=o.isMouseClickEqual(i,r)}if(n){var a=e.getBeginCcp();return{isBreak:!1,value:o.mergeBeginCcp(t,a)}}return{isBreak:!0,value:_()({},t)}},o.mergeParaLink=function(e,t,i){var n=e.getChildren(),r=void 0;return{isBreak:!(r=i?o.leftMerge(n.length-1,n,o.mergeSpanLink,_()({},t)):o.rightMerge(0,n,o.mergeSpanLink,_()({},t))).isEnd,value:_()({},r.value)}},o._parent=i,o._data=n||{text:""},o._style=a,o._glyphs=[],o._coreFontSize=a.fontSize,o.fontShowScale=1,o}return u()(t,e),o()(t,[{key:"getText",value:function(){return this._data.text}},{key:"getLength",value:function(){return this._data.text.length}},{key:"getScriptPosition",value:function(){return this._style.position||0}},{key:"getFont",value:function(e){var t=this._style,i=t.fontStyle,n=t.fontVariant,r=t.fontWeight,a=t.fontFamily,o=t.italic,s=t.bold,l=this.fontSize;o&&(i="italic"),r=r||"normal",s&&(r="bold"),i=i||"normal",n=n||"normal",0!==this.getScriptPosition()&&(l*=2/3);var h=e&&e.codePointAt();1===this.getCapitalization()&&to.isUpperAlpha(h)&&(l*=.8,n="small-caps");var u=void 0;if(void 0!==h){var c=this._style,d=c.fontNameAsiaEast,p=c.fontNameAscii,f=c.fontNameSymbol,g=c.fontNameComplex,y=c.langInfo;u=d&&to.isRealAsia(h)?d.name:p&&(h<=127||to.isSpecialAlpha(h)||to.isTxAscii(h))?p.name:g&&to.isComplex(h)?g.name:f&&f.name,(to.isPunc(h)||"—"===e)&&(y&&0===y.type?u=p.name:y&&2===y.type&&(u=d.name))}u=u||a;var v=window.domTools.formatFontName(u,r);return{fontStyle:i,fontVariant:n,fontWeight:v.fontWeight,fontFamily:v.fontName,fontSize:l,dataPath:this.dataPath}}},{key:"getStyle",value:function(){return this._style}},{key:"updateFontFamily",value:function(e){this._style.fontFamily=e}},{key:"getFontColor",value:function(){var e=this._style.color;return this.hyperlink&&(e="#1F72F1"),e||"#080001"}},{key:"getArtTextEffectList",value:function(){return this._style.artTextEffectList||{}}},{key:"artTextOutLineFill",value:function(){return this._style.artTextOutLineFill||{}}},{key:"getUnderline",value:function(){var e=this._style,t=e.fontSize,i=e.underlineType,n=e.underlineType_custom,r=e.underlineFill;t=this.fontSize;var a=r&&r.font&&r.font.color&&r.font.color.rgba||this.getFontColor();return this.hyperlink?{lineWidth:t/24,lineStyle:"#1F72F1",underlineType:1,underlineType_custom:1}:i||n?{lineWidth:t/24,lineStyle:a,underlineType:i,underlineType_custom:n}:null}},{key:"getDeleteline",value:function(){var e=this._style,t=e.fontSize,i=e.strikeThrough;return t=this.fontSize,i>0?{lineWidth:t/24,lineStyle:this.getFontColor(),strikeThrough:i}:null}},{key:"isHidden",value:function(){return this._style.hidden||!1}},{key:"getUnderlineFill",value:function(){return this._style.underlineFill}},{key:"clearGlyphs",value:function(){this._glyphs=[]}},{key:"appendGlyph",value:function(e){e.parent=this,this._glyphs.push(new io(e))}},{key:"getGlyphs",value:function(){return this._glyphs}},{key:"getVerticalType",value:function(){return this._parent.getVerticalType()}},{key:"isBold",value:function(){return this._style.bold}},{key:"getBeginCcp",value:function(){var e=this._data;return{ccp:e.ccp,begin:e.begin}}},{key:"getSpacing",value:function(){return this._spacing=this._spacing||this._style.spacing/5*window.ti2pxRatio||0,this._spacing}},{key:"getCapitalization",value:function(){return this._style.capitalization||0}},{key:"getDefTabLen",value:function(){return this._parent.getDefTabLen()}},{key:"getGradientColor",value:function(){var e=this._style.textColor;return this.hyperlink&&(e={rgba:" rgba(31,114,241,1)"}),e}},{key:"getCellIndex",value:function(){return this._parent.getCellIndex()}},{key:"getLinkBeginEnd",value:function(){if(!this.linkBeginEnd){var e=this.getMergeLinkBeginCcp();e&&(this.linkBeginEnd={begin:e.begin,end:e.begin+e.ccp})}return this.linkBeginEnd}},{key:"getActions",value:function(){var e=this._style.actions;if(e&&(e.mouseClick&&-1!==e.mouseClick.action||e.mouseOver&&-1!==e.mouseOver.action))return e}},{key:"_getTextBodyEnd",value:function(){var e=this._parent._parent.getAllTextLinesCcp(),t=e&&e[e.length-1];return t&&t.ccp}},{key:"getMergeLinkBeginCcp",value:function(){if(void 0!==this._parent.index){var e=this.getBeginCcp();if(!(e.begin>=this._getTextBodyEnd())){var t=this._parent.getChildren(),i=t.indexOf(this),n=this._parent._parent.getChildren(),r=this._parent.index,a=this.leftMerge(i-1,t,this.mergeSpanLink,_()({},e));(a.isEnd||0===i)&&(a=this.leftMerge(r-1,n,this.mergeParaLink,_()({},a.value)));var o=this.rightMerge(i+1,t,this.mergeSpanLink,_()({},a.value));return(o.isEnd||i===t.length-1)&&(o=this.rightMerge(r+1,n,this.mergeParaLink,_()({},o.value))),_()({},o.value)}}}},{key:"leftMerge",value:function(e,t,i,n){for(var r=n,a=!1,o=e;o>=0;o--){var s=i(t[o],r,!0);if(r=s.value,s.isBreak)break;0===o&&(a=!0)}return{isEnd:a,value:r}}},{key:"rightMerge",value:function(e,t,i,n){for(var r=n,a=!1,o=e;o<t.length;o++){var s=i(t[o],r,!1);if(r=s.value,s.isBreak)break;o===t.length-1&&(a=!0)}return{isEnd:a,value:r}}},{key:"mergeBeginCcp",value:function(e,t){var i=e.begin,n=e.ccp;return i=Math.min(e.begin,t.begin),e.begin!==t.begin&&(n+=t.ccp),{begin:i,ccp:n}}},{key:"isMouseClickEqual",value:function(e,t){if(!e||!t)return!1;return["action","address","link"].every((function(i){return e[i]===t[i]}))}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),delete this._parent,delete this._glyphs}},{key:"isBidiLang",value:function(){var e=this._style.lang;return"ar-EG"===e||"ug-CN"===e}},{key:"isCJKLang",value:function(){var e=this._style.lang;return"zh-CN"===e||"zh-TW"===e||"ko-KR"===e||"ja-JP"===e}},{key:"isArabicSpan",value:function(){return this.getGlyphs().every((function(e){return e.isRightChar||e.isSpace()}))}},{key:"getHightLightColor",value:function(){return this._style.hightLightColor&&this._style.hightLightColor.color?this._style.hightLightColor.color.rgba:null}},{key:"getHightLightHex",value:function(){return this._style.hightLightColor&&this._style.hightLightColor.color?this._style.hightLightColor.color.hex:null}},{key:"fontSize",get:function(){return this._fontScale!==this.fontScale&&(this._fontScale=this.fontScale,this._fontSize=+(this._coreFontSize*this._fontScale*window.ti2pxRatio).toFixed(4)),this._fontSize*this.fontShowScale}},{key:"length",get:function(){return this._glyphs.length}},{key:"dataPath",get:function(){return this._parent.dataPath}},{key:"hyperlink",get:function(){var e=this.getActions();return e?_()({},e,{cellIndex:this.getCellIndex(),beginEnd:this.getLinkBeginEnd()}):null}},{key:"hasTextSel",get:function(){return this._parent.hasTextSel}},{key:"fontScale",get:function(){return this._parent.fontScale}},{key:"isFieldType",get:function(){return!!this._style.fieldType}},{key:"needLayoutUnderLine",get:function(){return this._parent.needLayoutUnderLine}}]),t}(mo),jo=function(e){function t(e){var i=e.parent,n=e.data,a=e.style;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a));return o._parent=i,o._data=n,o._style=a,o.init(),o._childLines=[],void 0===a.kinsoku&&(a.kinsoku=!0),void 0===a.overflowPunct&&(a.overflowPunct=!0),o}return u()(t,e),o()(t,[{key:"init",value:function(){var e=this._data;this._text="";for(var t=e.childs,i=0;i<t.length;i++){var n=t[i];if(n){"Array"===n.text.constructor.name?this._text+=n.text.join(""):this._text+=n.text;var r=new Wo({parent:this,data:n,style:n.style});if(r.isHidden())continue;if(this.appendChild(r),0===i){var a=e.autoNum;a&&(this._typoAutoNum=new Uo({parent:this,data:a,txtSpan:r}),this._typoAutoNum.hasBullet()||(this._typoAutoNum=null))}}}}},{key:"getTypoAutoNum",value:function(){return this._typoAutoNum||null}},{key:"getTypoSpanChildren",value:function(){return this.childs}},{key:"createTypoTextLine",value:function(e,t){return new Ho({parent:this,data:e,style:t})}},{key:"appendTypoTextLine",value:function(e){this._childLines.push(e)}},{key:"removeTypoTextLine",value:function(e){var t=this._childLines,i=t.indexOf(e);this._childLines=t.slice(0,i).concat(t.slice(i+1,t.length))}},{key:"clearTypoTextLines",value:function(){this._childLines=[]}},{key:"getTypoTextLines",value:function(){return this._childLines}},{key:"getAlignMode",value:function(){var e=this._style,t=this._parent.getCenterText(),i=e.alignMode;return t&&(i!==C.HorzAlignMode.Right&&i!==C.HorzAlignMode.Left||(i=C.HorzAlignMode.Center)),void 0===e.alignMode&&(e.alignMode=C.HorzAlignMode.Left),i||C.HorzAlignMode.Left}},{key:"getFirstLineIndent",value:function(){var e=this._style.firstIndent||{},t=e.isCh,i=e.value,n=void 0===i?0:i;return n&&(n=t?n/100:n*window.ti2pxRatio),{isCh:t,value:n}}},{key:"getLineIndent",value:function(){return(this._style.leftIndent||{}).value*window.ti2pxRatio||0}},{key:"getLineSpacing",value:function(){var e=this._style.lineSpacing||{value:0},t=e.value,i=e.rule;return"auto"!==i&&(t*=window.ti2pxRatio),{value:t,rule:i}}},{key:"getLineRule",value:function(){var e=this._style;return{breakInWord:e.breakInWord,kinsoku:e.kinsoku,overflowPunct:e.overflowPunct}}},{key:"getMargin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._style,n=i.marginBefore,r=i.marginAfter,a=0,o=0;return r&&(o=r.value,r.isAbs?o*=window.ti2pxRatio:o=o/100*t*1.2),n&&(a=n.value,n.isAbs?a*=window.ti2pxRatio:a=a/100*e*1.2),{top:a,left:0,right:0,bottom:o}}},{key:"getCssStyle",value:function(){return this._style.font}},{key:"getBgColor",value:function(){return this._style.BgColor||"transparent"}},{key:"setGlyphs",value:function(e){this._allGlyphs=e}},{key:"getGlyphs",value:function(){return this._allGlyphs}},{key:"getBeginCcp",value:function(){var e=this._data;return{ccp:e.ccp,begin:e.begin}}},{key:"getVerticalType",value:function(){return this._parent.getVerticalType()}},{key:"getWrapText",value:function(){return this._parent.getWrapText()}},{key:"getTabStop",value:function(e){var t=e,i=this._getTabStopFromProp(e,t),n=i.isOK;return t=i.newStop,(t=this._getTabStopFromLeftLineIndent(e,t))<=e&&!n&&(t=this._getDefaultTabStop(e)),t}},{key:"_getTabStopFromProp",value:function(e,t){var i=this._style.tabStops;if(!i||!i.stops||!i.stops.length)return{isOK:!1,newStop:t};for(var n=!1,r=0,a=i.stops.length;r<a;r++){var o=i.stops[r],s=o&&o.pos?o.pos*window.ti2pxRatio:0;if(!e&&s<=0)return{isOK:!0,newStop:t+1};if(s-e>1e-8&&(n=!0,t=(parseInt(e/s)+1)*s),n||s===e){var l=i.defTabLen;if(l||(l=1440*window.ti2pxRatio),0===r&&t%l==0&&(n=!0,t+=1),n)return{isOK:!0,newStop:t}}}return{isOK:!1,newStop:t}}},{key:"_getTabStopFromLeftLineIndent",value:function(e,t){var i=this.getLineIndent();return(t>i&&i>e||t===e&&e<i)&&(t=i),t}},{key:"_getDefaultTabStop",value:function(e){var t=void 0,i=this._style.tabStops;return i&&void 0!==i.defTabLen&&(t=i.defTabLen*window.ti2pxRatio),(!i||t<0||Object.isEmpty(t))&&(t=1440*window.ti2pxRatio),t=0!==(t=parseInt(t))?(parseInt(e/t)+1)*t:0}},{key:"getGlyphByGcp",value:function(e){var t=this._allGlyphs,i=this.getBeginCcp().begin;return t.find((function(t){var n=t.getChar().length,r=t.getGcp();return e>=r-i&&e<n+r-i}))}},{key:"isEmpty",value:function(){return this._parent.isEmpty()}},{key:"isFocus",value:function(){if(this._data){var e=this._data,t=e.begin,i=e.ccp,n=e.selRange;if(this.hasTextSel&&1===i&&n&&n.begin===t)return!0}return!1}},{key:"isDefText",value:function(){return this._parent.isDefText()}},{key:"isPlaceholder",value:function(){return this._parent.isPlaceholder()}},{key:"getCellIndex",value:function(){return this._parent.cellIndex}},{key:"setTextLinesCcp",value:function(e){this.textLinesCcp=e}},{key:"getTextLinesCcp",value:function(){return this.textLinesCcp||[{begin:-1,ccp:-1}]}},{key:"getAllTextLinesCcp",value:function(){return this._parent.getAllTextLinesCcp()}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this._childLines.forEach((function(e){e.destroy()})),delete this._childLines,delete this._parent,delete this._data,delete this._style}},{key:"first",set:function(e){this._isFirst=e},get:function(){return!0===this._isFirst}},{key:"last",set:function(e){this._isLast=e},get:function(){return!0===this._isLast}},{key:"text",get:function(){return this._text}},{key:"lineSpaceReduction",get:function(){return this._parent.lineSpaceReduction}},{key:"dataPath",get:function(){return this._parent.dataPath}},{key:"hasTextSel",get:function(){return this._parent.hasTextSel}},{key:"fontScale",get:function(){return this._parent.fontScale}},{key:"findResults",get:function(){return this._parent.findResults}},{key:"isR2L",get:function(){return this._style.rightToLeft}},{key:"needLayoutUnderLine",get:function(){return this._parent.needLayoutUnderLine}}]),t}(mo),Yo=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.timeStamp=Date.now(),e&&i.init(),i}return u()(t,e),o()(t,[{key:"init",value:function(){this._data=this.props.data||{},this._style=this._data.style||{},this._coreAutofit=this._style.autoFit||C.AutoFit.None,this._fontScale=this._style.fontScale,this._textWrap=this._style.textWrap;var e=this._data.childs;if(e)for(var t=0;t<e.length;t++){var i=e[t];this.appendChild(new jo({parent:this,data:i,style:i.style}))}var n=this._style.rect;n&&this.setRect(n.x,n.y,n.width,n.height);var r=this._style.frameRotation||0;this._frameRotation=Math.round(r/6e4)}},{key:"getChilds",value:function(){return this.childs}},{key:"getMargin",value:function(){var e=this._style.textInset,t=window.Emu2Ti,i=75*window.ti2pxRatio,n=144*window.ti2pxRatio,r=144*window.ti2pxRatio,a=75*window.ti2pxRatio;return e&&(void 0!==e.top&&(i=t(e.top)*window.ti2pxRatio),void 0!==e.bottom&&(a=t(e.bottom)*window.ti2pxRatio),void 0!==e.left&&(n=t(e.left)*window.ti2pxRatio),void 0!==e.right&&(r=t(e.right)*window.ti2pxRatio)),{top:i,left:n,right:r,bottom:a}}},{key:"getRect",value:function(){return{x:this.x||0,y:this.y||0,width:this.width||400,height:this.height||300}}},{key:"getTextAlign",value:function(){return this._style.anchorType||C.TextAnchoringType.Top}},{key:"getAutoFit",value:function(){return this._autofit||this._coreAutofit}},{key:"getCoreAutoFit",value:function(){return this._coreAutofit}},{key:"setAutoFit",value:function(e){this._autofit=e}},{key:"setScaleXY",value:function(e,t){this.scale={x:e,y:t}}},{key:"getScaleXY",value:function(){return this.scale||{x:1,y:1}}},{key:"setWrapText",value:function(e){this._textWrap=e}},{key:"getWrapText",value:function(){var e=this._textWrap;return Object.isEmpty(e)&&(e=1),e}},{key:"getVerticalType",value:function(){var e=this._style.verticalType||C.TextDirectionType.Horizontal,t=this.props.parent&&this.props.parent.getRotation();return e===C.TextDirectionType.EastAsianVer&&270===t&&(e=C.TextDirectionType.Vertical),e}},{key:"getCenterText",value:function(){return this._style.anchorCenter||!1}},{key:"getMinScale",value:function(){return this._style.isTitle?.89393:he.f.FONT_MIN_SCALE}},{key:"isEmpty",value:function(){return this._data.isEmpty||!1}},{key:"isDefText",value:function(){return this._data.isDefText||!1}},{key:"isPlaceholder",value:function(){return this._data.isPlaceholder||!1}},{key:"isTitlePlaceHolder",value:function(){return this._style.isTitle||!1}},{key:"setAllTextLinesCcp",value:function(e){this.allTextLinesCcp=e}},{key:"getAllTextLinesCcp",value:function(){return this.allTextLinesCcp}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),delete this._style,delete this._data,this.txt_hlg_node&&this.txt_hlg_node.remove(),this.find_hlg_node&&this.find_hlg_node.remove(),this.txt_node&&this.txt_node.remove(),delete this.txt_hlg_node,delete this.find_hlg_node,delete this.txt_node}},{key:"getParagraphByGcp",value:function(e){var t=this.getChilds();if(!t)return null;for(var i=0;i<t.length;i++){var n=t[i],r=n.getBeginCcp();if(r.begin<=e&&r.begin+r.ccp>e)return n}return null}},{key:"getGlyphByGcp",value:function(e){var t=this.getChilds();if(!t)return null;for(var i=0;i<t.length;i++){var n=t[i],r=n.getBeginCcp();if(r.begin<=e&&r.begin+r.ccp>e)return n.getGlyphByGcp(e-r.begin)}return null}},{key:"getToken",value:function(){return this._data.data_token}},{key:"sameData",value:function(e){return this._data===e||e.data_token===this._data.data_token&&window.sameCmp(this._data,e,10)}},{key:"lineSpaceReduction",get:function(){return this._style.lineSpaceReduction||0}},{key:"dataPath",get:function(){return this._data.dataPath}},{key:"hasTextSel",get:function(){return this._data.hasTextSel}},{key:"fontScale",get:function(){return this.getAutoFit()===C.AutoFit.Normal&&this._fontScale||1},set:function(e){e>1&&(e=1),this._fontScale=e||this._fontScale}},{key:"findResults",get:function(){return this._data.findResults},set:function(e){this._data.findResults=e}},{key:"hasText",get:function(){var e=this.getChilds();if(e.length<=1){var t=e[0];return!!t&&(e=t.getGlyphs()).length>1}return!0}},{key:"isR2L",get:function(){return this._style.columnRightToLeft}},{key:"frameRotation",get:function(){return this._frameRotation}},{key:"compositionLength",get:function(){return this._data.compositionLength}},{key:"needLayoutUnderLine",get:function(){var e=this.props.parent,t=e&&e.shapeData,i=t&&t.getSlide(),n=i&&i.getTiming(),r=n&&n.mainSequence,a=r&&r.getEffects();return a&&a.some((function(e){return e.getTargetShapeId()===t.getId()&&67===e.getType()}))}}]),t}(mo),zo=function(e){function t(){r()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.m_index=null,e.m_x=null,e.m_y=null,e.m_width=null,e.m_height=null,e.m_leftCell=null,e.m_rightCell=null,e.m_upCell=null,e.m_downCell,e}return u()(t,e),o()(t,[{key:"setFromGridData",value:function(e){e&&e.isCellGridData?(this.m_index=e.m_index,this.m_x=e.m_x,this.m_y=e.m_y,this.m_width=e.m_width,this.m_height=e.m_height,this.m_leftCell=e.m_leftCell,this.m_rightCell=e.m_rightCell,this.m_upCell=e.m_upCell,this.m_downCell=e.m_downCell,this.m_startRow=e.m_startRow,this.m_endRow=e.m_endRow,this.m_startCol=e.m_startCol,this.m_endCol=e.m_endCol):console.error(e+"is not instanceof CellGridData")}},{key:"index",value:function(){return this.m_index}},{key:"x",value:function(){return this.m_x}},{key:"y",value:function(){return this.m_y}},{key:"width",value:function(){return this.m_width}},{key:"height",value:function(){return this.m_height}},{key:"leftCell",value:function(){return this.m_leftCell}},{key:"rightCell",value:function(){return this.m_rightCell}},{key:"upCell",value:function(){return this.m_upCell}},{key:"downCell",value:function(){return this.m_downCell}},{key:"startRow",value:function(){return this.m_startRow}},{key:"endRow",value:function(){return this.m_endRow}},{key:"startCol",value:function(){return this.m_startCol}},{key:"endCol",value:function(){return this.m_endCol}},{key:"row",value:function(){return this.m_startRow}},{key:"col",value:function(){return this.m_startCol}},{key:"isCellGridData",get:function(){return!0}}]),t}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r()(this,e),this.m_startRow=t,this.m_endRow=i,this.m_startCol=n,this.m_endCol=a})),Ko=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,a))}return u()(t,e),o()(t,[{key:"isEmptyCellRange",value:function(){return this.colEnd-this.colBegin==0&&this.rowEnd-this.rowBegin==0}}],[{key:"=",value:function(e){return e instanceof t?this.rowBegin===e.rowBegin&&this.rowEnd===e.rowEnd&&this.colBegin===e.colBegin&&this.colEnd===e.colEnd:(console.log(e+" is not instanceof CellRange!!"),!1)}}]),t}((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r()(this,e),this.rowBegin=t,this.rowEnd=i,this.colBegin=n,this.colEnd=a})),qo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r()(this,e),this.pLineRef=t,this.isRef=i}return o()(e,[{key:"setLine",value:function(e){e=Object.assign({alignment:0,dashType:0,endingCap:0,joinType:0,miterLimit:8},e),this.pLine=e,this.isRef=!1}},{key:"setLineRef",value:function(e){this.pLineRef=e,this.isRef=!0}}]),e}(),Xo=0,Jo=1,Zo=2,Qo=3,$o=4,es=5,ts=6,is=function(){function e(t,i){r()(this,e),this._cell=t,this._tableGraphic=i}return o()(e,[{key:"isDirty",value:function(){var e=this.token!==this._tableGraphic.token;return this.token=this._tableGraphic.token,e}},{key:"getTableGraphic",value:function(){return this._tableGraphic}},{key:"getIndex",value:function(){return this._cell.idx}},{key:"getBorder",value:function(){return this._cell?this._cell.border:null}},{key:"getMargin",value:function(){return this._cell.margin}},{key:"getTableCell3D",value:function(){return this._cell.tableCell3D}},{key:"getTextBody",value:function(){return this._cell.getTextBody}},{key:"getCellGridData",value:function(){if(!this._cellGridData||this.isDirty()){var e=new zo;this._tableGraphic.getCellGridData(this.getIndex(),e),this._cellGridData=e}return this._cellGridData}},{key:"hasLine",value:function(e,t,i){if(e===Xo)return!1;var n=new qo;return this.isLineValid(e,t,i,n)}},{key:"line",value:function(e,t,i,n){var r=new qo,a=void 0,o=this.isLineValid(e,t,i,r);return o&&(a=r.pLine,r.isRef||a||(a={fill:{type:0}}),Object.isEmpty(n)||(n=o)),a}},{key:"setRect",value:function(e,t,i,n){var r=this._tableGraphic.GetVertBorderPos(i),a=this._tableGraphic.GetVertBorderPos(n),o=this._tableGraphic.GetHoriBorderPos(e),s=this._tableGraphic.GetHoriBorderPos(t);this.m_boundsOfVisual=new window.Rect(r,o,a-r,s-o)}},{key:"rect",value:function(){var e=this.getCellGridData(),t=Math.round(100*e.m_x)/100,i=Math.round(100*e.m_y)/100,n=Math.round(100*e.m_width)/100,r=Math.round(100*e.m_height)/100;return new window.Rect(t,i,n,r)}},{key:"styleHasFill",value:function(e){return!(!e||!e.fill)}},{key:"getFill",value:function(){if(!this.isDirty()&&this._fill)return this._fill;if(this._cell.fill)return this._fill=this._cell.fill,this._fill;var e=this._tableGraphic.getStyle();if(this.isFirstRowFill()){var t=e.getFristRow().getCellStyle();if(this.styleHasFill(t))return this._fill=t.fill,this._fill}if(this.isLastRowFill()){var i=e.getLastRow().getCellStyle();if(this.styleHasFill(i))return this._fill=i.fill,this._fill}if(this.isFirstColFill()){var n=e.getFristCol().getCellStyle();if(this.styleHasFill(n))return this._fill=n.fill,this._fill}if(this.isLastColFill()){var r=e.getLastCol().getCellStyle();if(this.styleHasFill(r))return this._fill=r.fill,this._fill}var a=void 0;if(this.isBandRowFill()&&!this.isFillFirstOrLastRow(this.getRowBegin(),this.getRowEnd())){var o=this._tableGraphic.getUsefirstrow()?1:0;0===(this.getRowBegin()+o)%2&&e.getBand1H()?a=e.getBand1H().getCellStyle():e.getBand2H()&&(a=e.getBand2H().getCellStyle())}if(this.isBandColFill()&&!this.isFillFirstOrLastCol(this.getColBegin(),this.getColEnd())){var s=this._tableGraphic.getUsefirstcol()?1:0,l=(this.getColBegin()+s)%2;if(a&&a.fill)return this._fill=a.fill,this._fill;0===l&&e.getBand1V()?a=e.getBand1V().getCellStyle():e.getBand2V()&&(a=e.getBand2V().getCellStyle())}if(a&&a.fill)return this._fill=a.fill,this._fill;var h=this._tableGraphic.getStyle(),u=h&&h.getWholeTable(),c=u&&u.getCellStyle(),d=c&&c.fill;return d?(this._fill=d,this._fill):void 0}},{key:"isFillFirstOrLastRow",value:function(e,t){return this._tableGraphic.getUsefirstrow()&&0===e||this._tableGraphic.getUselastrow()&&t===this._tableGraphic.getRowCount()}},{key:"isFillFirstOrLastCol",value:function(e,t){return this._tableGraphic.getUsefirstcol()&&0===e||this._tableGraphic.getUselastcol()&&t===this._tableGraphic.getColCount()}},{key:"getRange",value:function(){var e=this.getCellGridData();return new Ko(e.m_startRow,e.m_endRow,e.m_startCol,e.m_endCol)}},{key:"getRowBegin",value:function(){return this.getCellGridData().m_startRow}},{key:"getColBegin",value:function(){return this.getCellGridData().m_startCol}},{key:"getRowEnd",value:function(){return this.getCellGridData().m_endRow}},{key:"getColEnd",value:function(){return this.getCellGridData().m_endCol}},{key:"isLeftBorderCell",value:function(){return 0===this.getCellGridData().m_startCol}},{key:"isFirstRowFill",value:function(){return this._tableGraphic.getUsefirstrow()&&this._tableGraphic.getStyle().getFristRow()&&0===this.getRowBegin()}},{key:"isLastRowFill",value:function(){return this._tableGraphic.getUselastrow()&&this._tableGraphic.getStyle().getLastRow()&&this.getRowEnd()===this._tableGraphic.getRowCount()}},{key:"isFirstColFill",value:function(){return this._tableGraphic.getUsefirstcol()&&this._tableGraphic.getStyle().getFristCol()&&0===this.getColBegin()}},{key:"isLastColFill",value:function(){return this._tableGraphic.getUselastcol()&&this._tableGraphic.getStyle().getLastCol()&&this.getColEnd()===this._tableGraphic.getColCount()}},{key:"isLastCol",value:function(){return this._tableGraphic&&this._tableGraphic.getRowCount()-1===this.getRowBegin()}},{key:"isLastRow",value:function(){return this._tableGraphic&&this._tableGraphic.getColCount()-1===this.getColBegin()}},{key:"isBandRowFill",value:function(){return this._tableGraphic.getUsebandrow()}},{key:"isBandColFill",value:function(){return this._tableGraphic.getUsebandcol()}},{key:"isTopBorderCell",value:function(){return 0===this.getCellGridData().m_startRow}},{key:"isLineValid",value:function(e,t,i,n){return this._isLineValid(e,n,t,i)}},{key:"_isLineValid",value:function(e,t,i,n){var r=this._tableGraphic.getTableProperties(),a=!1;switch(e){case Jo:a=r.getLeftLineProp(i,n,t);break;case Zo:a=r.getTopLineProp(i,n,t);break;case Qo:a=r.getRightLineProp(i,n,t);break;case $o:a=r.getBottomLineProp(i,n,t);break;case es:a=r.getRoutineTLToBRLineProp(i,n,t);break;case ts:a=r.getRoutineTRToBLLineProp(i,n,t)}return a}},{key:"getRightBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().right:null}},{key:"hasRightBorder",value:function(){return this._cell&&this.getRightBorder()}},{key:"getLeftBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().left:null}},{key:"hasLeftBorder",value:function(){return this._cell&&this.getLeftBorder()}},{key:"getTopBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().top:null}},{key:"hasTopBorder",value:function(){return this._cell&&this.getTopBorder()}},{key:"getBottomBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().bottom:null}},{key:"hasBottomBorder",value:function(){return this._cell&&this.getBottomBorder()}},{key:"getTL2BRBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().tl2br:null}},{key:"hasTL2BRBorder",value:function(){return this._cell&&this.getTL2BRBorder()}},{key:"getTR2BLBorder",value:function(){return this._cell&&this.getBorder()?this.getBorder().tr2bl:null}},{key:"hasTR2BLBorder",value:function(){return this._cell&&this.getTR2BLBorder()}},{key:"testRightBorder",value:function(){return this.hasRightBorder()}},{key:"testLeftBorder",value:function(){return this.hasLeftBorder()}},{key:"testTopBorder",value:function(){return this.hasTopBorder()}},{key:"testBottomBorder",value:function(){return this.hasBottomBorder()}},{key:"testTL2BRBorder",value:function(){return this.hasTL2BRBorder()}},{key:"testTR2BLBorder",value:function(){return this.hasTR2BLBorder()}},{key:"getMarginLeft",value:function(){return this.getMargin().left}},{key:"hasMarginLeft",value:function(){return this.getMargin()&&this.getMargin().left}},{key:"testMarginLeft",value:function(){return this.hasMarginLeft()}},{key:"getMarginRight",value:function(){return this.getMargin().right}},{key:"hasMarginRight",value:function(){return this.getMargin()&&this.getMargin().right}},{key:"testMarginRight",value:function(){return this.hasMarginRight()}},{key:"getTiRect",value:function(){var e=this.rect(),t=e.x(),i=e.y(),n=e.width(),r=e.height(),a=this._tableGraphic.getScale();return{x:t/=a,y:i/=a,width:n/=a,height:r/=a}}},{key:"getRect",value:function(){var e=this.rect();return{x:e.x(),y:e.y(),width:e.width(),height:e.height()}}}]),e}(),ns=function(){function e(t){r()(this,e),this._table=t,this._tableGraphic=new rs(t),this.token=this._tableGraphic.token}return o()(e,[{key:"isDirty",value:function(){var e=this.token===this._tableGraphic.token;return this.token=this._tableGraphic.token,e}},{key:"setDirty",value:function(){this._tableGraphic.setDirty()}},{key:"createCellEnum",value:function(e){var t=this;if(this._cellEnum)return this._cellEnum;var i=[];if(e.isEmptyCellRange())i.push(this.getCell(e.rowBegin,e.colBegin));else{if(!this.isValidRange(e))return i;var n,r,a,o;n=e.rowBegin,r=e.rowEnd,a=e.colBegin,o=e.colEnd;for(var s=new Map,l=r*o,h=r-1;h>=n;--h)for(var u=o-1;u>=a;--u,--l){var c=this.getCellIndex(h,u);s.set(c,l)}var d=new Map;s.forEach((function(e,t){d.set(e,t)})),(d=new Map([].concat(S()(d)).sort((function(e,t){return e[0]-t[0]})))).forEach((function(e){var n=t.getCellFromIndex(e);i.push(n)}))}return this._cellEnum=i,i}},{key:"getCellsRect",value:function(e){for(var t=this,i=e.startRow,n=e.endRow,r=e.startCol,a=e.endCol,o=void 0,s=i;s<n;s++)for(var l=function(e){var i=t.getTableGraphic().getIdxOfCell(s,e),n=t._cellEnum.find((function(e){return e.getIndex()===i})),r=n&&n.getCellGridData();if(!r)return"continue";var a=new window.Rect(r.x(),r.y(),r.width(),r.height());o=o?hs(o,a):a},h=r;h<a;h++)l(h);return new window.Rect(o.x(),o.y(),o.width()+1,o.height()+1)}},{key:"getCellGridDataCache",value:function(e,t){var i=this._cellGridDataCache||[],n=e*this.getColCount()+t;return i[n]?i[n]:null}},{key:"getCell",value:function(e,t){var i=this.getTableGraphic(),n=i.queryIndexTopLeft(e,t),r=f()(n,2);return e=r[0],t=r[1],i.getCell(e,t)}},{key:"getCellIndex",value:function(e,t){var i=this.getTableGraphic(),n=i.queryIndexTopLeft(e,t),r=f()(n,2);return e=r[0],t=r[1],i.getCellIndex(e,t)}},{key:"getCellFromIndex",value:function(e){return this.getTableGraphic().getCellFromIndex(e)}},{key:"getCellFromIdx",value:function(e){return this.getTableGraphic().getCellFromIdx(e)}},{key:"getTable",value:function(){return this._table}},{key:"getTableGraphic",value:function(){return this._tableGraphic}},{key:"getScale",value:function(){return this.getTableGraphic().getScale()}},{key:"getTableOffSet",value:function(){if(this._table.effectsRect){var e=this._table.effectsRect.topLeft();return new window.Point(e.x(),e.y())}return new window.Point(this._table.x,this._table.y)}},{key:"getTableEffectsRect",value:function(){return this._table.effectsRect?this._table.effectsRect:this._table.boundRect}},{key:"getRowCount",value:function(){return this.getHoriBorderPos().length-1}},{key:"getEffects",value:function(){return this._table.effects}},{key:"getColCount",value:function(){return this.getVertBorderPos().length-1}},{key:"getVertBorderPos",value:function(){return this._table.vertborderpos}},{key:"getHoriBorderPos",value:function(){return this._table.horiborderpos}},{key:"getMixHeight",value:function(){return this._table.mix_horiborderpos?this._table.mix_horiborderpos.splice(-1)[0]:0}},{key:"getHeight",value:function(){return this.getHoriBorderPos()[this.getRowCount()]}},{key:"getWidth",value:function(){return this.getVertBorderPos()[this.getColCount()]}},{key:"isValidRange",value:function(e){return e.colEnd-e.colBegin>=1&&e.rowEnd-e.rowBegin>=1&&e.colBegin<this.getColCount()&&e.colEnd<=this.getColCount()&&e.rowBegin<this.getRowCount()&&e.rowEnd<=this.getRowCount()}},{key:"resetVertBorders",value:function(e){this.getTableGraphic().updateVertBordersPosOfVisual(e)}},{key:"resetHoriBorders",value:function(e){this.getTableGraphic().updateHoriBordersPosOfVisual(e)}},{key:"getAutoFitRect",value:function(e){e.width()>this.getWidth()&&this.resetVertBorders(e.width()),e.height()>this.getHeight()&&this.resetHoriBorders(e.height())}},{key:"updateCell",value:function(e,t,i){if(!t)return!1;for(var n=this.getTable(),r=0,a=n.childs.length;r<a;r++)n.childs[r].idx===e&&(n.childs[r]=t);for(var o=this.getTableGraphic(),s=new is(t,o),l=0,h=this._cellEnum.length;l<h;l++)if(this._cellEnum[l].getIndex()===e)return this._cellEnum[l]=s,this.updateCellVisuals=this.updateCellVisuals||[],this.updateCellVisuals.push(s),this.updateCellVisuals.type=i,s}}]),e}(),rs=function(){function e(t){r()(this,e),this._table=t,this.token=Object(k.a)(),this._tableProperties=new ss(this)}return o()(e,[{key:"getTableProperties",value:function(){return this._tableProperties}},{key:"setDirty",value:function(){this._cellGridDataCache=[],this.token=Object(k.a)()}},{key:"queryIndexTopLeft",value:function(e,t){var i=this.getIdxOfCell(e,t);if(-1!==i){for(var n=t;n>=0;--n){if(this.getCell(e,n).getIndex()!==i)break;t=n}for(var r=e;r>=0;--r){if(this.getCell(r,t).getIndex()!==i)break;e=r}return[e,t]}}},{key:"queryIndexBottomRight",value:function(e,t){var i=this.getColCount(),n=this.getRowCount(),r=this.getIdxOfCell(e,t);if(-1!==r){for(var a=t;a<i&&this.getIdxOfCell(e,a)===r;++a)t=a;for(var o=e;o<n&&this.getIdxOfCell(o,t)===r;++o)e=o;return[e,t]}}},{key:"getCell",value:function(e,t){var i=this.getColCount();return e*i+t>=this.getChildCount()?null:new is(this.getChild(e*i+t))}},{key:"getCellFromIndex",value:function(e){return e>=this.getChildCount()?null:new is(this.getChild(e),this)}},{key:"getCellFromIdx",value:function(e){return new is(this.getChildByIdx(e),this)}},{key:"getCellIndex",value:function(e,t){var i=this.getColCount();return e*i+t>=this.getChildCount()?-1:e*i+t}},{key:"getIdxOfCell",value:function(e,t){var i=this.getCell(e,t);return i?i.getIndex():-1}},{key:"getRowCount",value:function(){return this.getHoriBorderPos().length-1}},{key:"getColCount",value:function(){return this.getVertBorderPos().length-1}},{key:"getVertBorderPos",value:function(){return this._table.vertborderpos}},{key:"getHoriBorderPos",value:function(){return this._table.horiborderpos}},{key:"getMixHoriBorderPos",value:function(){if(!this._table.mix_horiborderpos){this._table.mix_horiborderpos=[];for(var e=0;e<=this.getRowCount();e++)this._table.mix_horiborderpos[e]=116840*e}return this._table.mix_horiborderpos}},{key:"getVertBorderPosVisual",value:function(){var e=this._table.vertborderposVisual;return e&&e.length>0?e:this.getVertBorderPos()}},{key:"getHoriBorderPosVisual",value:function(){var e=this._table.horiborderposVisual;return e&&e.length>0?e:this.getHoriBorderPos()}},{key:"getChild",value:function(e){return this.getChilds()[e]}},{key:"getChildByIdx",value:function(e){return this.getChilds().find((function(t){return t.idx===e}))}},{key:"getChilds",value:function(){return this._table.childs}},{key:"getFill",value:function(){return this._table.fill?this._table.fill:this.getStyle().getFill()?this.getStyle().getFill():void 0}},{key:"getChildCount",value:function(){return this.getChilds().length}},{key:"getCellGridData",value:function(e,t){for(var i=this.getRowCount(),n=this.getColCount(),r=0;r<i;++r)for(var a=0;a<n;++a){var o=this.getCell(r,a);if(o&&o.getIndex()===e)return void this.getCellGridData_3(r,a,t)}}},{key:"getCellGridData_3",value:function(e,t,i){if(i&&i.isCellGridData){this._cellGridDataCache=this._cellGridDataCache||[];var n=this.getCell(e,t);if(i.m_index=n?n.getIndex():-1,-1!==i.m_index){var r=i.m_index;if(this._cellGridDataCache[r])i.setFromGridData(this._cellGridDataCache[r]);else{i.m_startRow=e,i.m_startCol=t;var a=this.queryIndexTopLeft(i.m_startRow,i.m_startCol),o=f()(a,2);i.m_startRow=o[0],i.m_startCol=o[1],i.m_endRow=e,i.m_endCol=t;var s=this.queryIndexBottomRight(i.m_endRow,i.m_endCol),l=f()(s,2);i.m_endRow=l[0],i.m_endCol=l[1],++i.m_endRow,++i.m_endCol,i.m_x=this.GetVertBorderPos(i.m_startCol),i.m_y=this.GetHoriBorderPos(i.m_startRow),i.m_width=this.GetVertBorderPos(i.m_endCol)-this.GetVertBorderPos(i.m_startCol),i.m_height=this.GetHoriBorderPos(i.m_endRow)-this.GetHoriBorderPos(i.m_startRow),this._cellGridDataCache[r]=i}}}else console.log("ERROR!!!!"+i+" is not instance of CellGridData! ")}},{key:"GetVertBorderPos",value:function(e){if(this.getVertBorderPos().length>0)return window.Emu2Ti(this.getVertBorderPos()[e])*this.getScale()}},{key:"GetHoriBorderPos",value:function(e){if(this.getHoriBorderPos().length>0)return window.Emu2Ti(this.getHoriBorderPos()[e])*this.getScale()}},{key:"updateHoriBordersPos",value:function(e,t,i){if(e>t||t>this.getRowCount()||0===t)console.warn("rowIndex  error!");else{var n=635*i-(this.getHoriBorderPos()[t]-this.getHoriBorderPos()[e]);if(n<=0)return;for(var r=t;r<=this.getRowCount()&&!(r>t&&this.getHoriBorderPos()[r]>this.getHoriBorderPos()[r-1]);r++)this.getHoriBorderPos()[r]+=n;this.setDirty()}}},{key:"updateMixHoriBordersPos",value:function(e,t,i){if(e>t||t>this.getRowCount()||0===t)console.warn("rowIndex  error!");else{var n=635*i-(this.getMixHoriBorderPos()[t]-this.getMixHoriBorderPos()[e]);if(n<=.001)return;for(var r=t;r<=this.getRowCount()&&!(r>t&&this.getMixHoriBorderPos()[r]>this.getMixHoriBorderPos()[r-1]);r++)this.getMixHoriBorderPos()[r]+=n;this.setDirty()}}},{key:"updateVertBorderPos",value:function(e,t){if(e>this.getColCount())console.log("rowIndex over HoriBorders length!");else{var i=635*t-(this.getVertBorderPos()[e]-this.getVertBorderPos()[e-1]);if(i<0)return;for(var n=e;n<=this.getColCount();n++)this.getVertBorderPos()[n]+=i;this.setDirty()}}},{key:"updateHoriBordersPosOfVisual",value:function(e){var t=this.getHoriBorderPos()[this.getRowCount()]-this.getHoriBorderPos()[0];if(!(Math.abs(t-e)<1e-5)){var i=!0,n=this.getHoriBorderPos(),r=this.getHoriBorderPosVisual();if(r.length>2){i=!0;for(var a=r[1]-r[0],o=1;o<r.length-1;++o)if(Math.abs(a-(r[o+1]-r[o]))>1){i=!1;break}}for(var s=1;s<n.length-1;++s)n[s]=Math.round(n[s]/t*e+.5);if(n[n.length-1]=n[0]+e,i){for(var l=!0,h=n[1]-n[0],u=1;u<n.length-1;++u){var c=n[u+1]-n[u];l&&c===h||(l=!1,c>h&&(h=c))}if(!l)for(var d=0;d<n.length-1;++d)for(var p=h-(n[d+1]-n[d]),f=d+1;f<n.length;++f)n[f]+=p}this.setDirty()}}},{key:"updateVertBordersPosOfVisual",value:function(e){var t=this.getVertBorderPos(),i=t[this.getColCount()]-t[0];if(!(Math.abs(i-e)<1e-5)){for(var n=Array(this.getColCount()).fill(1),r=0;r<this.getColCount();++r)for(var a=0;a<this.getRowCount();++a){var o=new zo;if(this.getCellGridData_3(a,r,o),!(o.m_endCol>r+1)){var s=this.getCell(o.m_startRow,o.m_startCol),l=0;s?(l+=s.testMarginLeft()?s.getMarginLeft():91440,l+=s.testMarginRight()?s.getMarginRight():91440):l+=182880;for(var h=o.m_startCol;h<r;++h)l-=n[h];n[r]=Math.max(l,n[r])}}for(var u=0,c=0;c<this.getColCount();++c)u+=n[c];if(e<(u=window.Emu2Ti(u)))for(var d=1;d<t.length;++d)t[d]=t[d-1]+window.Emu2Ti(n[d-1]);else{var p=!1;if(t.length>2){p=!0;for(var f=t[1]-t[0],g=1;g<t.length-1;++g)if(Math.abs(f-(t[g+1]-t[g]))>1){p=!1;break}}for(var y=1;y<t.length-1;++y)t[y]=Math.round(t[y]/i*e+.5);if(t[t.length-1]=t[0]+e,p){for(var v=!0,m=t[1]-t[0],_=1;_<t.length-1;++_){var w=t[_+1]-t[_];v&&w===m||(v=!1,w>m&&(m=w))}if(!v)for(var S=0;S<t.length-1;++S)for(var x=m-(t[S+1]-t[S]),T=S+1;T<t.length;++T)t[T]+=x}for(var k=1;k<t.length;++k)if(t[k]-t[k-1]<window.Emu2Ti(n[k-1]))for(var C=window.Emu2Ti(n[k-1])-(t[k]-t[k-1]),b=k;b<t.length;++b)t[b]=t[b]+C;this.setDirty()}}}},{key:"getScale",value:function(){return this._table.scale||1}},{key:"getStyle",value:function(){return this._tableStyle=this._tableStyle||new as(this._table.style),this._tableStyle}},{key:"getEffects",value:function(){return this._table.effects}},{key:"getHeight",value:function(){return window.Emu2Ti(this.getHoriBorderPos()[this.getRowCount()])*this.getScale()}},{key:"getWidth",value:function(){return window.Emu2Ti(this.getVertBorderPos()[this.getColCount()])*this.getScale()}},{key:"getStyleid",value:function(){return this._table.styleid}},{key:"getLayer",value:function(){return this._table.layer}},{key:"getVertborderpos",value:function(){return this._table.vertborderpos}},{key:"getHoriborderpos",value:function(){return this._table.horiborderpos}},{key:"getUsebandcol",value:function(){return this._table.usebandcol}},{key:"getUsebandrow",value:function(){return this._table.usebandrow}},{key:"getUsefirstcol",value:function(){return this._table.usefirstcol}},{key:"getUsefirstrow",value:function(){return this._table.usefirstrow}},{key:"getUselastcol",value:function(){return this._table.uselastcol}},{key:"getUselastrow",value:function(){return this._table.uselastrow}},{key:"getUsenecell",value:function(){return this._table.usenecell}},{key:"getUsesecell",value:function(){return this._table.usesecell}},{key:"getUseswcell",value:function(){return this._table.useswcell}},{key:"getUsewwcell",value:function(){return this._table.usewwcell}},{key:"isEmpty",value:function(){return!this._table}}]),e}(),as=function(){function e(t){r()(this,e),this._style=t}return o()(e,[{key:"getFristRow",value:function(){return this.getStyle().firstRow?new os(this.getStyle().firstRow):null}},{key:"getLastRow",value:function(){return this.getStyle().lastRow?new os(this.getStyle().lastRow):null}},{key:"getFristCol",value:function(){return this.getStyle().firstColumn?new os(this.getStyle().firstColumn):null}},{key:"getLastCol",value:function(){return this.getStyle().lastColumn?new os(this.getStyle().lastColumn):null}},{key:"getBand1V",value:function(){return this.getStyle().band1V?new os(this.getStyle().band1V):null}},{key:"getBand2V",value:function(){return this.getStyle().band2V?new os(this.getStyle().band2V):null}},{key:"getBand1H",value:function(){return this.getStyle().band1H?new os(this.getStyle().band1H):null}},{key:"getBand2H",value:function(){return this.getStyle().band2H?new os(this.getStyle().band2H):null}},{key:"getWholeTable",value:function(){return this.getStyle().wholeTable?new os(this.getStyle().wholeTable):null}},{key:"getNeCell",value:function(){return this.getStyle().neCell?new os(this.getStyle().neCell):null}},{key:"getNwCell",value:function(){return this.getStyle().nwCell?new os(this.getStyle().nwCell):null}},{key:"getSeCell",value:function(){return this.getStyle().seCell?new os(this.getStyle().seCell):null}},{key:"getSwCell",value:function(){return this.getStyle().swCell?new os(this.getStyle().swCell):null}},{key:"getWwCell",value:function(){return this.getStyle().wwCell?new os(this.getStyle().wwCell):null}},{key:"getFill",value:function(){return this.getStyle().fill?this.getStyle().fill:null}},{key:"getStyle",value:function(){return this._style.private?this._style.private:null}},{key:"getBand1HTopBorderLineProp",value:function(e){var t=this.getBand1H();return!(!t||!t.getTopBorder())&&(e.setLine(t.getTopBorder()),!0)}},{key:"getBand1HBottomBorderLineProp",value:function(e){var t=this.getBand1H();return!(!t||!t.getBottomBorder())&&(e.setLine(t.getBottomBorder()),!0)}},{key:"getBand2HTopBorderLineProp",value:function(e){var t=this.getBand2H();return!(!t||!t.getTopBorder())&&(e.setLine(t.getTopBorder()),!0)}},{key:"getBand2HBottomBorderLineProp",value:function(e){var t=this.getBand2H();return!(!t||!t.getBottomBorder())&&(e.setLine(t.getBottomBorder()),!0)}},{key:"getBand1VLeftBorderLineProp",value:function(e){var t=this.getBand1V();return!(!t||!t.getLeftBorder())&&(e.setLine(t.getLeftBorder()),!0)}},{key:"getBand2VRightBorderLineProp",value:function(e){var t=this.getBand2V();return!(!t||!t.getRightBorder())&&(e.setLine(t.getRightBorder()),!0)}},{key:"getBand2VLeftBorderLineProp",value:function(e){var t=this.getBand2V();return!(!t||!t.getLeftBorder())&&(e.setLine(t.getLeftBorder()),!0)}},{key:"getBand1VRightBorderLineProp",value:function(e){var t=this.getBand1V();return!(!t||!t.getRightBorder())&&(e.setLine(t.getRightBorder()),!0)}},{key:"getFirstRowBottomBorderLineProp",value:function(e){var t=this.getFristRow();return!(!t||!t.getBottomBorder())&&(e.setLine(t.getBottomBorder()),!0)}},{key:"getFirstRowVertBorderLineProp",value:function(e){var t=this.getFristRow();return!(!t||!t.getInsideVBorder())&&(e.setLine(t.getInsideVBorder()),!0)}},{key:"getLastRowTopBorderLineProp",value:function(e){var t=this.getLastRow();return!(!t||!t.getTopBorder())&&(e.setLine(t.getTopBorder()),!0)}},{key:"getLastRowVertBorderLineProp",value:function(e){var t=this.getLastRow();return!(!t||!t.getInsideVBorder())&&(e.setLine(t.getInsideVBorder()),!0)}},{key:"getFirstColRightBorderLineProp",value:function(e){var t=this.getFristCol();return!(!t||!t.getRightBorder())&&(e.setLine(t.getRightBorder()),!0)}},{key:"getFirstColHoriBorderLineProp",value:function(e){var t=this.getFristCol();return!(!t||!t.getInsideHBorder())&&(e.setLine(t.getInsideHBorder()),!0)}},{key:"getLastColLeftBorderLineProp",value:function(e){var t=this.getLastCol();return!(!t||!t.getLeftBorder())&&(e.setLine(t.getLeftBorder()),!0)}},{key:"getLastColHoriBorderLineProp",value:function(e){var t=this.getLastCol();return!(!t||!t.getInsideHBorder())&&(e.setLine(t.getInsideHBorder()),!0)}},{key:"getNeCellBottomBorderLineProp",value:function(e){var t=this.getNeCell();return t&&t.getBottomBorder()?(e.setLine(t.getBottomBorder()),!0):!!this.getFirstRowBottomBorderLineProp(e)||this.getLastColHoriBorderLineProp(e)}},{key:"getNeCellLeftBorderLineProp",value:function(e){var t=this.getNeCell();return t&&t.getLeftBorder()?(e.setLine(t.getLeftBorder()),!0):!!this.getFirstRowVertBorderLineProp(e)||this.getLastColLeftBorderLineProp(e)}},{key:"getNwCellBottomBorderLineProp",value:function(e){var t=this.getNwCell();return t&&t.getBottomBorder()?(e.setLine(t.getBottomBorder()),!0):!!this.getFirstRowBottomBorderLineProp(e)||this.getFirstColHoriBorderLineProp(e)}},{key:"getNwCellRightBorderLineProp",value:function(e){var t=this.getNwCell();return t&&t.getRightBorder()?(e.setLine(t.getRightBorder()),!0):!!this.getFirstRowVertBorderLineProp(e)||this.getFirstColRightBorderLineProp(e)}},{key:"getSeCellTopBorderLineProp",value:function(e){var t=this.getSeCell();return t&&t.getTopBorder()?(e.setLine(t.getTopBorder()),!0):!!this.getLastRowTopBorderLineProp(e)||this.getLastColHoriBorderLineProp(e)}},{key:"getSeCellLeftBorderLineProp",value:function(e){var t=this.getSeCell();return t&&t.getLeftBorder()?(e.setLine(t.getLeftBorder()),!0):!!this.getLastRowVertBorderLineProp(e)||this.getLastColLeftBorderLineProp(e)}},{key:"getSwCellTopBorderLineProp",value:function(e){var t=this.getSwCell();return t&&t.getTopBorder()?(e.setLine(t.getTopBorder()),!0):!!this.getLastRowTopBorderLineProp(e)||this.getFirstColHoriBorderLineProp(e)}},{key:"getSwCellRightBorderLineProp",value:function(e){var t=this.getSwCell();return t&&t.getRightBorder()?(e.setLine(t.getRightBorder()),!0):!!this.getLastRowVertBorderLineProp(e)||this.getFirstColRightBorderLineProp(e)}},{key:"getWholeTableHoriBorderLineProp",value:function(e,t,i){var n=this.getWholeTable();if(!n)return!1;if(0===e){if(n.getTopBorder())return i.setLine(n.getTopBorder()),!0}else if(e===t){if(n.getBottomBorder())return i.setLine(n.getBottomBorder()),!0}else if(n.getInsideHBorder())return i.setLine(n.getInsideHBorder()),!0;return!1}},{key:"getWholeTalbeVertBorderLineProp",value:function(e,t,i){var n=this.getWholeTable();if(!n)return!1;if(0===e){if(n.getLeftBorder())return i.setLine(n.getLeftBorder()),!0}else if(e===t){if(n.getRightBorder())return i.setLine(n.getRightBorder()),!0}else if(n.getInsideVBorder())return i.setLine(n.getInsideVBorder()),!0;return!1}}]),e}(),os=function(){function e(t){r()(this,e),this._partStyle=t}return o()(e,[{key:"getCellStyle",value:function(){var e=this.getStyle();return e&&e.cellStyle?e.cellStyle:null}},{key:"getTextStyleStyle",value:function(){var e=this.getStyle();return e?e.textStyle:null}},{key:"getStyle",value:function(){return this._partStyle?this._partStyle.private:null}},{key:"getBottomBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("bottomBorder")?e.bottomBorder:null}},{key:"getRightBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("rightBorder")?e.rightBorder:null}},{key:"getLeftBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("leftBorder")?e.leftBorder:null}},{key:"getTopBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("topBorder")?e.topBorder:null}},{key:"getInsideVBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("insideVBorder")?e.insideVBorder:null}},{key:"getInsideHBorder",value:function(){var e=this.getCellStyle();return!Object.isEmpty(e)&&e.hasOwnProperty("insideHBorder")?e.insideHBorder:null}}]),e}(),ss=function(){function e(t){if(r()(this,e),!(t instanceof rs))return console.log("ERROR!!"+t+" is not instanceof TableGraphic"),null;this.m_pTable=t}return o()(e,[{key:"getTopLineProp",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.isValidRowAndCol(e,t))return!1;if(this._getTopLineProp(e,t,i))return n&&(n=!1),!0;n&&(n=!1);var r=this.getStyle();if(!r)return!1;var a=new zo;return this.m_pTable.getCellGridData_3(e,t,a),!(0!==a.m_startRow||a.m_endRow!==this.getRowCount()||!this.useLastRow()||!this.getLastRowTopBorderLineProp(a,i))||(!(!this.useBandRow()||!r.getBand1HTopBorderLineProp(i))||r.getWholeTableHoriBorderLineProp(e,this.getRowCount(),i))}},{key:"getLeftLineProp",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.isValidRowAndCol(e,t))return!1;if(this._getLeftLineProp(e,t,i))return n&&(n=!1),!0;n&&(n=!0);var r=this.getStyle();return!!r&&(!(t+1!==this.getColCount()||!this.useLastCol()||!this.getLastColLeftBorderLineProp(e,i))||(!(!this.useBandCol()||!r.getBand1VLeftBorderLineProp(i))||r.getWholeTalbeVertBorderLineProp(t,this.getColCount(),i)))}},{key:"getRightLineProp",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.isValidRowAndCol(e,t))return!1;var r=new zo;if(this.m_pTable.getCellGridData_3(e,t,r),this._getRightLineProp(e,t,i))return n&&(n=!1),!0;var a=this.getStyle();if(!a)return!1;if(this.useFirstRow()){if(this.needUseFirstRowVertBorder(e,t)&&a.getFirstRowVertBorderLineProp(i))return!0;if(this.neelUseFirstRowBotomBorder(e,t)&&a.getFirstRowBottomBorderLineProp(i))return!0}if(this.useLastRow()){if(this.needUseLastRowVertBorder(e,t)&&a.getLastRowVertBorderLineProp(i))return!0;if(this.needUseLastRowTopBorder(e,t)&&a.getLastRowTopBorderLineProp(i))return!0}if(this.useFirstCol()&&0===r.m_startCol&&this.getFirstColRightBorderLineProp(e,i))return!0;if(t+1!==this.getColCount()){var o=new zo;if(this.m_pTable.getCellGridData_3(e,t+1,o),o.m_endCol===this.getColCount()&&this.useLastCol()&&this.getLastColLeftBorderLineProp(e,i))return!0;if(0===e&&this.useFirstRow()&&a.getFirstRowVertBorderLineProp(i))return!0;if(e+1===this.getRowCount()&&this.useLastRow()&&a.getLastRowVertBorderLineProp(i))return!0}return!(!this.useBandCol()||!this.getBandColRightBorderLineProp(t,i))||a.getWholeTalbeVertBorderLineProp(t+1,this.getColCount(),i)}},{key:"getBottomLineProp",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.isValidRowAndCol(e,t))return!1;var r=new zo;if(this.m_pTable.getCellGridData_3(e,t,r),this._getBottomLineProp(e,t,i))return n&&(n=!1),!0;n&&(n=!0);var a=this.getStyle();if(!a)return!1;if(this.useFirstRow()&&0===r.m_startRow&&this.getFirstRowBottomBorderLineProp(r,i))return!0;if(e+1!==this.getRowCount()){var o=new zo;if(this.m_pTable.getCellGridData_3(e+1,t,o),o.m_endRow===this.getRowCount()&&this.useLastRow()&&this.getLastRowTopBorderLineProp(o,i))return!0}if(this.useFirstCol()&&this.needUseFirstColRightBorder(e,t)&&a.getFirstColRightBorderLineProp(i))return!0;if(this.useLastCol()&&this.needUssLastColLeftBorder(e,t)&&a.getLastColLeftBorderLineProp(i))return!0;if(r.m_endRow!==this.getRowCount()){if(r.m_endCol===this.getColCount()&&this.useLastCol()&&a.getLastColHoriBorderLineProp(i))return!0;if(0===r.m_startCol&&this.useFirstCol()&&a.getFirstColHoriBorderLineProp(i))return!0}return!(!this.useBandRow()||!this.getBandRowBottomBorderLineProp(e,i))||a.getWholeTableHoriBorderLineProp(e+1,this.getRowCount(),i)}},{key:"getRoutineTLToBRLineProp",value:function(e,t,i){if(!this.isValidRowAndCol(e,t))return!1;var n=this.m_pTable.getCell(e,t);return!(!n||!n.testTL2BRBorder())&&(i.setLine(n.getTL2BRBorder()),!0)}},{key:"getRoutineTRToBLLineProp",value:function(e,t,i){if(!this.isValidRowAndCol(e,t))return!1;var n=this.m_pTable.getCell(e,t);return!(!n||!n.testTR2BLBorder())&&(i.setLine(n.getTR2BLBorder()),!0)}},{key:"getLastRowTopBorderLineProp",value:function(e,t){var i=this.getStyle();return 0===e.m_startCol&&this.useFirstCol()?i.getSwCellTopBorderLineProp(t):e.m_endCol===this.getColCount()&&this.useLastCol()?i.getSeCellTopBorderLineProp(t):i.getLastRowTopBorderLineProp(t)}},{key:"getStyle",value:function(){return this.m_pTable.getStyle()}},{key:"getRowCount",value:function(){return this.m_pTable.getRowCount()?this.m_pTable.getRowCount():0}},{key:"getColCount",value:function(){return this.m_pTable.getColCount()?this.m_pTable.getColCount():0}},{key:"useFirstRow",value:function(){return this.m_pTable.getUsefirstrow()}},{key:"useFirstCol",value:function(){return this.m_pTable.getUsefirstcol()}},{key:"useLastRow",value:function(){return this.m_pTable.getUselastrow()}},{key:"useLastCol",value:function(){return this.m_pTable.getUselastcol()}},{key:"useSeCell",value:function(){return this.m_pTable.getUsesecell()}},{key:"useSwCell",value:function(){return this.m_pTable.getUseswcell()}},{key:"useNeCell",value:function(){return this.m_pTable.getUsenecell()}},{key:"useNwCell",value:function(){return this.m_pTable.getUseNwcell()}},{key:"useBandRow",value:function(){return this.m_pTable.getUsebandrow()}},{key:"useBandCol",value:function(){return this.m_pTable.getUsebandcol()}},{key:"_getTopLineProp",value:function(e,t,i){var n=new zo;this.m_pTable.getCellGridData_3(e,t,n);var r=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(n.m_startRow>0){var a=new zo;if(this.m_pTable.getCellGridData_3(e-1,t,a),a.m_startCol>n.m_startCol){var o=this.m_pTable.getCell(a.m_startRow,a.m_startCol);if(o&&o.testBottomBorder())return i.setLine(o.getBottomBorder()),!0}else if(r&&r.testTopBorder())return i.setLine(r.getTopBorder()),!0}else if(r&&r.testTopBorder())return i.setLine(r.getTopBorder()),!0;return!1}},{key:"_getBottomLineProp",value:function(e,t,i){var n=new zo;this.m_pTable.getCellGridData_3(e,t,n);var r=this.m_pTable.getCell(n.m_endRow-1,n.m_startCol);if(n.m_endRow!==this.getRowCount()){var a=new zo;this.m_pTable.getCellGridData_3(e+1,t,a);var o=this.m_pTable.getCell(n.m_endRow-1,n.m_startCol);if(a.m_startCol>n.m_startCol){if((o=this.m_pTable.getCell(a.m_startRow,a.m_startCol)).testTopBorder())return i.setLine(o.getTopBorder()),!0}else{o=this.m_pTable.getCell(n.m_endRow-1,n.m_startCol);var s=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(s&&s.testBottomBorder())return i.setLine(s.getBottomBorder()),!0;if(o.testBottomBorder())return i.setLine(o.getBottomBorder()),!0}}else if(r){var l=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(l&&l.testBottomBorder())return i.setLine(l.getBottomBorder()),!0;if(r.testBottomBorder())return i.setLine(r.getBottomBorder()),!0}return!1}},{key:"_getLeftLineProp",value:function(e,t,i){var n=new zo;this.m_pTable.getCellGridData_3(e,t,n);var r=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(n.m_startCol>0){var a=new zo;if(this.m_pTable.getCellGridData_3(e,t-1,a),n.m_startRow<a.m_startRow){var o=this.m_pTable.getCell(a.m_startRow,a.m_startCol);if(o&&o.testRightBorder())return i.setLine(o.getRightBorder()),!0}else if(r&&r.testLeftBorder())return i.setLine(r.getLeftBorder()),!0}else if(r&&r.testLeftBorder())return i.setLine(r.getLeftBorder()),!0;return!1}},{key:"_getRightLineProp",value:function(e,t,i){var n=new zo;this.m_pTable.getCellGridData_3(e,t,n);var r=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(n.m_endCol<this.getColCount()){var a=new zo;if(this.m_pTable.getCellGridData_3(e,t+1,a),n.m_startRow<a.m_startRow){if((r=this.m_pTable.getCell(a.m_startRow,a.m_startCol)).testLeftBorder())return i.setLine(r.getLeftBorder()),!0}else{r=this.m_pTable.getCell(n.m_startRow,n.m_endCol-1);var o=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(o&&o.testRightBorder())return i.setLine(o.getRightBorder()),!0;if(r.testRightBorder())return i.setLine(r.getRightBorder()),!0}}else{r=this.m_pTable.getCell(n.m_startRow,n.m_endCol-1);var s=this.m_pTable.getCell(n.m_startRow,n.m_startCol);if(s&&s.testRightBorder())return i.setLine(s.getRightBorder()),!0;if(r.testRightBorder())return i.setLine(r.getRightBorder()),!0}return!1}},{key:"getBandRowBottomBorderLineProp",value:function(e,t){var i=this.useFirstRow()?1:0,n=this.getStyle();return ls(i,e)?!!n.getBand1HBottomBorderLineProp(t)||n.getBand2HTopBorderLineProp(t):!!n.getBand2HBottomBorderLineProp(t)||n.getBand1HTopBorderLineProp(t)}},{key:"getBandColRightBorderLineProp",value:function(e,t){var i=this.useFirstCol()?1:0,n=this.getStyle();return ls(i,e)?!!n.getBand1VRightBorderLineProp(t)||n.getBand2VLeftBorderLineProp(t):!!n.getBand2VRightBorderLineProp(t)||n.getBand2VLeftBorderLineProp(t)}},{key:"getFirstRowBottomBorderLineProp",value:function(e,t){var i=this.getStyle();return e.m_endCol===this.getColCount()&&this.useLastCol()?i.getNeCellBottomBorderLineProp(t):0===e.m_startCol&&this.useFirstCol()?i.getNwCellBottomBorderLineProp(t):i.getFirstRowBottomBorderLineProp(t)}},{key:"getFirstColRightBorderLineProp",value:function(e,t){var i=this.getStyle();return 0===e&&this.useFirstRow()?i.getNwCellRightBorderLineProp(t):e+1===this.getRowCount()&&this.useLastRow()?i.getSwCellRightBorderLineProp(t):i.getFirstColRightBorderLineProp(t)}},{key:"getLastColLeftBorderLineProp",value:function(e,t){var i=this.getStyle();return 0===e&&this.useFirstRow()?i.getNeCellLeftBorderLineProp(t):e+1===this.getRowCount()&&this.useLastRow()?i.getSeCellLeftBorderLineProp(t):i.getLastColLeftBorderLineProp(t)}},{key:"isValidRowAndCol",value:function(e,t){return!!this.m_pTable&&!(e<0||e>=this.m_pTable.getRowCount()||t<0||t>=this.m_pTable.getColCount())}},{key:"needUseFirstColRightBorder",value:function(e,t){if(e+1===this.getRowCount())return!1;var i=new zo;this.m_pTable.getCellGridData_3(e,t,i);var n=new zo;return this.m_pTable.getCellGridData_3(e+1,t,n),0===i.m_startCol?0!==n.m_startCol:0===n.m_startCol}},{key:"needUssLastColLeftBorder",value:function(e,t){if(e+1===this.getRowCount())return!1;var i=new zo;this.m_pTable.getCellGridData_3(e,t,i);var n=new zo;this.m_pTable.getCellGridData_3(e+1,t,n);var r=this.getColCount();return i.m_endCol===r?n.m_endCol!==r:n.m_endCol===r}},{key:"neelUseFirstRowBotomBorder",value:function(e,t){if(t+1===this.getColCount())return!1;var i=new zo;this.m_pTable.getCellGridData_3(e,t,i);var n=new zo;return this.m_pTable.getCellGridData_3(e,t+1,n),0===i.m_startRow?0!==n.m_startRow:0===n.m_startRow}},{key:"needUseLastRowTopBorder",value:function(e,t){if(t+1===this.getColCount())return!1;var i=new zo;this.m_pTable.getCellGridData_3(e,t,i);var n=this.getRowCount(),r=new zo;return this.m_pTable.getCellGridData_3(e,t+1,r),i.m_endRow===n?r.m_endRow!==n:r.m_endRow===n}},{key:"needUseFirstRowVertBorder",value:function(e,t){var i=new zo;if(this.m_pTable.getCellGridData_3(e,t,i),0!==i.m_startRow||i.m_endCol===this.getColCount())return!1;var n=new zo;return this.m_pTable.getCellGridData_3(e,t+1,n),i.m_startRow===n.m_startRow&&i.m_endRow<=n.m_endRow}},{key:"needUseLastRowVertBorder",value:function(e,t){var i=new zo;if(this.m_pTable.getCellGridData_3(e,t,i),i.m_endRow!==this.getRowCount()||i.m_endCol===this.getColCount())return!1;var n=new zo;return this.m_pTable.getCellGridData_3(e,t+1,n),e>=n.m_startRow&&n.m_endRow===this.getRowCount()}}]),e}();function ls(e,t){return(t-e)%2==0}function hs(e,t){if(!e.isQRect||!t.isQRect)return console.error("not rect"),!1;var i=e.left()<t.left()?e.left():t.left(),n=e.right()>t.right()?e.right():t.right(),r=e.top()<t.top()?e.top():t.top(),a=e.bottom()>t.bottom()?e.bottom():t.bottom();return new window.Rect(i,r,n-i,a-r)}var us=i(1536),cs=function(){function e(){r()(this,e),this.m_dashOffset=0,this.m_dashPattern=[],this.m_width=1}return o()(e,[{key:"getWidth",value:function(){return this.m_width}},{key:"getDashOffset",value:function(){return this.m_dashOffset}},{key:"getDashPatternCount",value:function(){return this.m_dashPattern.length}},{key:"getDashPattern",value:function(e,t){if(Object.isEmpty(e))return!1;if(e instanceof Array||(e=[]),t>this.m_dashPattern.length)throw new Error("this count "+t+" is Over DashPatterb Length");for(var i=0;i<t;++i)e[i]=this.m_dashPattern[i];return!0}},{key:"setDashPattern",value:function(e,t){if(Object.isEmpty(e)||t<=1||1==(1&t))return!1;for(var i=0;i<t;){if(e[i]<=0)return!1;++i}for(this.m_dashPattern.length=t;t-- >0;)this.m_dashPattern[t]=e[t];return!0}},{key:"setDashOffset",value:function(e){this.m_dashOffset=e}},{key:"setWidth",value:function(e){this.m_width=e<=0?1:e}},{key:"getClipRect",value:function(){return this.m_clipRect}},{key:"setClipRect",value:function(e){this.m_clipRect=e||new window.Rect}},{key:"getDashedPath",value:function(e,t,i){var n=e.toSubpathPolygons(null,i);if(n)for(var r=0;r<n.length;++r)this.getDashedPath_2(n[r],t);else console.log("DashedPath is Empty!")}},{key:"getDashedPath_5",value:function(e,t,i,n,r){var a=e.toSubpathPolygons(null,r);if(a)for(var o=window,s=o.Point,l=o.QPainterPath,h=0;h<a.length;++h){var u=a[h],c=u[0],d=u[u.length-1],p=new l;this.getDashedPath_2(u,p);for(var f=p.toSubpathPolygons(null,r),g=f.length,y=0;y<g;++y)0===y?s["=="](f[y][0],c)?t.addPolygon(f[y]):i.addPolygon(f[y]):g-1===y&&s["=="](f[y][f[y].length-1],d)?n.addPolygon(f[y]):i.addPolygon(f[y])}else console.log("DashedPath is Empty!")}},{key:"getDashedPath_2",value:function(e,t){if(0===this.m_dashPattern.length)t.addPolygon(e);else{var i=new ys(e);this.generateDash(i,t)}}},{key:"generateDash",value:function(e,t){Object(us.c)(this.m_dashPattern.length>0,"",""),Object(us.c)(0==(1&this.m_dashPattern.length),"","need evenNumber"),Object(us.c)(this.m_width>0,"","");var i=0,n=0,r=0,a=0,o=1;for(e.isclosed()&&(a=e.getSize()-1,o=0);o<e.getSize();){var s=e.getVertices(),l=new window.Line(s[a].pt,s[o].pt);if(this.m_clipRect.isEmpty()||ds(l,this.m_clipRect)){var h=this.calcDashStart(i,n,r+new window.Line(s[a].pt,l.p1()).length()),u=f()(h,2);i=u[0],n=u[1];for(var c=0,d=l.length();d>0;){(1|n)!==n&&(this.addStart(new vs(l.p1(),l.p2()),new vs(l.p2(),l.p1()),c,t),this.addPoint(new vs(l.p1(),l.p2()),new vs(l.p2(),l.p1()),c+Math.min(i,d),t)),c+=i,d-=i;var p=this.incCurrentDash(n,i,this.m_dashPattern,this.m_width),g=f()(p,2);n=g[0],i=g[1]}r+=s[a].dist,a=o++}else r+=s[a].dist,a=o++}}},{key:"calcDashStart",value:function(e,t,i){for(var n=0,r=this.m_dashPattern.length,a=0;a<r;++a)n+=this.m_dashPattern[a]*this.m_width;Object(us.b)(!ps(n)&&!ps(this.m_width));var o=i-Math.floor(i/n)*n;o+=this.m_dashOffset*this.m_width,o-=Math.floor(o/n)*n,o/=this.m_width;for(var s=0;s<r;++s){if(o<this.m_dashPattern[s])return[(this.m_dashPattern[s]-o)*this.m_width,s];o-=this.m_dashPattern[s]}Object(us.c)(0,"","Should never run here")}},{key:"addStart",value:function(e,t,i,n){if(n.isQPainterPath){var r=new window.Point(e.pt.x()+i/e.dist*(t.pt.x()-e.pt.x()),e.pt.y()+i/e.dist*(t.pt.y()-e.pt.y())),a=n.length,o=n.getPathElementAt(a-1);a>0&&o&&ps(r.x()-o.x)&&ps(r.y()-o.y)||n.moveTo(r)}else console.error("qPathDasher add start error!!")}},{key:"addPoint",value:function(e,t,i,n){if(n.isQPainterPath){var r=new window.Point(e.pt.x()+i/e.dist*(t.pt.x()-e.pt.x()),e.pt.y()+i/e.dist*(t.pt.y()-e.pt.y()));n.lineTo(r)}else console.error("qPathDasher add addPoint error!!")}},{key:"incCurrentDash",value:function(e,t,i,n){return++e>=i.length&&(e=0),[e,i[e]*n]}}]),e}();function ds(e,t){for(var i=0,n=1,r=e.p1().x(),a=e.p1().y(),o=e.p2().x(),s=e.p2().y(),l=[r-o,o-r,a-s,s-a],h=[r-t.left(),t.right()-r,a-t.top(),t.bottom()-a],u=0;u<4;++u)if(ps(l[u])){if(h[u]<0)return!1}else{var c=h[u]/l[u];if(l[u]<0){if((i=Math.max(i,c))>n)return!1}else if(i>(n=Math.min(n,c)))return!1}var d=r+i*l[1],p=r+n*l[1],f=a+i*l[3],g=a+n*l[3];return e.setP1(new window.Point(d,f)),e.setP2(new window.Point(p,g)),!0}function ps(e){return Math.abs(e)<=1e-12}var fs=function(){function e(){r()(this,e),this.width=1,this.dashPattern=[],this.joinStyle=_e.LineJoinTypeMiter,this.dashOffset=0,this.miterLimit=4,this.compoundArray=[],this.startAnchorStyle=Se,this.startAnchor=null,this.endAnchorStyle=Se,this.endAnchor=null,this.alignment=0,this.startCap=ue.LineCapFlat,this.endCap=ue.LineCapFlat,this.dashCap=ue.LineCapFlat,this.clipRect=new window.Rect,this.ref=1,this.penScale=1}return o()(e,[{key:"prepareMathStroker",value:function(){var e=new gs;return e.setWidth(this.width),e.setLineJoin(this.joinStyle),e.setMiterLimit(this.miterLimit),this.isSolid()?(e.setStartCap(this.startCap),e.setEndCap(this.endCap)):(e.setStartCap(this.dashCap),e.setEndCap(this.dashCap)),0!==this.compoundArray.length&&e.setCompoundArray(this.compoundArray,this.compoundArray.length),e.setAlignment(this.alignment),e.setPenScale(this.penScale),e}},{key:"prepareDasher",value:function(){var e=new cs;e.setDashOffset(this.dashOffset);var t=this.dashPattern;if(this.dashCap===ue.LineCapRound||this.dashCap===ue.LineTriangleCap)for(var i=t.length,n=0;n!==i;)1&n?t[n]+=.99:t[n]-=.99,++n;return e.setDashPattern(t,t.length),e.setWidth(this.width),e}},{key:"isSolid",value:function(){return 0===this.dashPattern.length}},{key:"alignmentOffset",value:function(){if(void 0===this.alignment)return 0;switch(this.alignment){case ye:return 0;case me:return this.width/2;case ve:return-this.width/2;default:return 0}}}]),e}(),gs=function(){function e(){r()(this,e),this.m_width=1,this.m_lineJoin=_e.LineJoinTypeMiter,this.m_miterLimit=10,this.m_startCap=ue.LineCapFlat,this.m_endCap=ue.LineCapFlat,this.m_compoundArray=[],this.m_penAlignment=ye,this.m_scaleX=1,this.m_scaleY=1}return o()(e,[{key:"strokePath",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.25;if(e){var n=e.toSubpathPolygons(null,i);if(n instanceof Array)for(var r=0;r<n.length;r++)this.strokeSubPath(n[r],t)}else console.error("path2stroke is not Array ")}},{key:"strokeSubPath",value:function(e,t){0!==e.length?e.isClosed?this.strokeCloseSubPath(e,t):this.strokeOpenSubPath(e,t):console.log("subPath is Empty")}},{key:"strokeCloseSubPath",value:function(e,t){var i=new ys(e),n=i.getSize();if(!(n<2)){i=i.getVertices();for(var r=[],a=[],o=[],s=0;s<this.m_compoundArray.length;s++)o.push([]);for(var l=0;l<n-2;++l)this.calcPoints(i,l,l+1,l+2,r,a,o);if(this.calcPoints(i,n-2,n-1,0,r,a,o),this.calcPoints(i,n-1,0,1,r,a,o),0===this.m_compoundArray.length)t.addPolygon(r),t.closeSubpath(),a.reverse(),t.addPolygon(a),t.closeSubpath();else for(var h=0;h<this.m_compoundArray.length;h+=2)t.addPolygon(o[h]),t.closeSubpath(),o[h+1].reverse(),t.addPolygon(o[h+1]),t.closeSubpath()}}},{key:"strokeOpenSubPath",value:function(e,t){var i=new ys(e),n=i.getSize();if(!(n<2)){i=i.getVertices();for(var r=[],a=[],o=[],s=0;s<this.m_compoundArray.length;s++)o.push([]);var l=[],h=[];this.calcStartPoints([i,r,a,o,l]);for(var u=0;u<n-2;++u)this.calcPoints(i,u,u+1,u+2,r,a,o);if(this.calcEndPoints([i,r,a,o,h]),0===this.m_compoundArray.length)t.addPolygon(r),t.connectPolygon(h),a.reverse(),t.connectPolygon(a),t.connectPolygon(l);else{for(var c=0;c<this.m_compoundArray.length;c+=2)t.addPolygon(o[c]),o[c+1].reverse(),t.connectPolygon(o[c+1]),t.closeSubpath();t.addPolygon(l),t.closeSubpath(),t.addPolygon(h),t.closeSubpath()}}}},{key:"calcPoints",value:function(e,t,i,n,r,a,o){var s=[],l=[];if(this.calcJoin(s,l,e[t].pt,e[i].pt,e[n].pt,e[t].dist,e[i].dist),this.scalePoints(s,s.length,e[i].pt),this.scalePoints(l,l.length,e[i].pt),r.push.apply(r,s),a.push.apply(a,l),0!==o.length){for(var h=[],u=0;u<this.m_compoundArray.length;u++)h.push([]);this.calcCompoundPoints(s,l,h);for(var c=0;c<this.m_compoundArray.length;++c){var d;(d=o[c]).push.apply(d,S()(h[c]))}}}},{key:"calcJoin",value:function(e,t,i,n,r,a,o){var s=_s(i,n,r),l=this.m_width/2,h=l/a,u=l/o,c=h*(n.y()-i.y()),d=h*(n.x()-i.x()),p=u*(r.y()-n.y()),f=u*(r.x()-n.x());s>0?(this.calcInnerJoin([e,i,n,r,c,d,p,f,a,o]),this.calcOuterJoin([t,r,n,i,-p,-f,-c,-d])):s<0?(this.m_penAlignment===ve?this.calcLineJoinMiter(e,i,n,r,c,d,p,f):this.calcOuterJoin([e,i,n,r,c,d,p,f]),this.calcInnerJoin([t,r,n,i,-p,-f,-c,-d,o,a])):this.calcStraightJoin([e,t,i,n,r,c,d,p,f]),t.reverse()}},{key:"calcInnerJoin",value:function(e){var t,i=f()(e,10),n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],l=i[5],h=i[6],u=i[7],c=i[8],d=i[9],p=window.Point;if(void 0!==c&&void 0!==d||console.error(c+","+d+" was undefined!"),0===this.m_compoundArray.length)n.push(new window.Point(a.x()+s,a.y()-l)),n.push(new window.Point(a.x()+h,a.y()-u));else{var g=new window.Line(r,a),y=new window.Line(a,o);g.translate(s,-l),y.translate(h,-u);var v=g.angleTo(y);if((t=v)>=170&&t<=190){var m=p["*"](.5,p["+"](g.p2(),y.p1()));return void n.push(m)}var _=new window.Point;if(!ws(g.p1(),g.p2(),y.p1(),y.p2(),_))return void console.error(a+","+o+" has no intersection!");n.push(_)}}},{key:"calcOuterJoin",value:function(e){var t=f()(e,8),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7];switch(this.m_lineJoin){case _e.LineJoinTypeMiter:this.calcLineJoinMiter([i,n,r,a,o,s,l,h]);break;case _e.LineJoinTypeBevel:this.calcLineJoinBevel([i,n,r,a,o,s,l,h]);break;case _e.LineJoinTypeRound:this.calcLineJoinRound([i,n,r,a,o,s,l,h]);break;default:console.warn("Errpr LineJoinType:"+_e+"!!")}}},{key:"calcLineJoinMiter",value:function(e){var t=f()(e,8),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7],u=new window.Point(n.x()+o,n.y()-s),c=new window.Point(r.x()+o,r.y()-s),d=new window.Point(r.x()+l,r.y()-h),p=new window.Point(a.x()+l,a.y()-h),g=new window.Point;ws(u,c,d,p,g);var y=ms(r,g),v=this.m_width/2*this.m_miterLimit;if(y>v){var m=new window.Point;if(ws(c,d,r,g,m),ms(r,m)>v)i.push(c),i.push(d);else{var _=(y-v)/ms(g,m)*ms(c,m),w=v/y,S=new window.Point(r.x()+(g.x()-r.x())*w,r.y()+(g.y()-r.y())*w),x=_/ms(r,S),T=x*(S.y()-r.y()),k=x*(S.x()-r.x());i.push(new window.Point(S.x()+T,S.y()-k)),i.push(new window.Point(S.x()-T,S.y()+k))}}else i.push(g)}},{key:"calcLineJoinBevel",value:function(e){var t=f()(e,8),i=t[0],n=t[2],r=t[4],a=t[5],o=t[6],s=t[7],l=new window.Point(n.x()+r,n.y()-a),h=new window.Point(n.x()+o,n.y()-s);i.push(l),i.push(h)}},{key:"calcLineJoinRound",value:function(e){var t=f()(e,8),i=t[0],n=t[2],r=t[4],a=t[5],o=t[6],s=t[7];i.push(new window.Point(n.x()+r,n.y()-a));var l=Math.atan2(-a,r),h=Math.atan2(-s,o),u=this.m_width/2,c=2*Math.acos(u/(u+.125));l>h&&(h+=2*Math.PI);var d=Math.floor((h-l)/c);l+=c=(h-l)/(d+1);for(var p=0;p<d;++p){var g=new window.Point;g.setX(n.x()+Math.cos(l)*u),g.setY(n.y()+Math.sin(l)*u),i.push(g),l+=c}i.push(new window.Point(n.x()+o,n.y()-s))}},{key:"scalePoints",value:function(e,t,i){if(1!==this.m_scaleX&&1!==this.m_scaleY)for(var n=0;n<t;++n)e[n].setX(i.x()+(e[n].x()-i.x())*this.m_scaleX),e[n].setY(i.y()+(e[n].y()-i.y())*this.m_scaleY)}},{key:"calcCompoundPoints",value:function(e,t,i){if(0!==this.m_compoundArray.length){var n=e.length,r=t.length;if(n>1&&r>1);else if(n>1&&1===r)for(var a=0;a<n;++a)for(var o=e[a],s=t[0],l=s.x()-o.x(),h=s.y()-o.y(),u=this.m_compoundArray.length,c=0;c<u;++c){var d=this.m_compoundArray[c];i[c].push(new window.Point(o.x()+d*l,o.y()+d*h))}else if(r>1&&1===n)for(var p=0;p<r;++p)for(var f=e[0],g=t[p],y=g.x()-f.x(),v=g.y()-f.y(),m=this.m_compoundArray.length,_=0;_<m;++_){var w=this.m_compoundArray[_];i[_].push(new window.Point(f.x()+w*y,f.y()+w*v))}else if(1===n&&1===r)for(var S=e[0],x=t[0],T=x.x()-S.x(),k=x.y()-S.y(),C=this.m_compoundArray.length,b=0;b<C;++b){var E=this.m_compoundArray[b];i[b].push(new window.Point(S.x()+E*T,S.y()+E*k))}else console.error("ERROR!")}}},{key:"calcStraightJoin",value:function(e){var t=f()(e,9),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=t[7],u=t[8],c=new window.Point(a.x()+s,a.y()-l);if(_s(r,c,a)>0===_s(o,c,a)>0){var d=new window.Point(a.x()+h,a.y()-u);i.push(c),i.push(d),n.push(c),n.push(d)}else i.push(c),n.push(new window.Point(a.x()-s,a.y()+l))}},{key:"calcStartPoints",value:function(e){var t=f()(e,5),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=i;!(i instanceof Array)&&i instanceof ys&&(s=i.getVertices());var l=new window.Point,h=new window.Point;if(i instanceof ys&&i.getSize()>2||i instanceof Array&&i.length>2?this.calcStartPoints_p([l,h,s[0].pt,s[1].pt,s[2].pt,s[0].dist,s[1].dist]):this.calcStartPoints_p1([s[0].pt,s[1].pt,s[0].dist,l,h]),n.push(Object(us.d)(l)),r.push(Object(us.d)(h)),this.scalePoints(n,n.length,s[0].pt),this.scalePoints(r,r.length,s[0].pt),0!==a.length){for(var u=[],c=0;c<this.m_compoundArray.length;c++)u.push([]);this.calcCompoundPoints(n,r,u);for(var d=0;d<this.m_compoundArray.length;++d){var p;(p=a[d]).push.apply(p,S()(u[d]))}}var g=[];this.calcCap(s[1].pt,s[0].pt,s[0].dist,this.m_startCap,g),this.scalePoints(g,g.length,s[0].pt),o.push.apply(o,g)}},{key:"calcEndPoints",value:function(e){var t=f()(e,5),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=[],l=[];s.push(new window.Point),l.push(new window.Point);var h=i.length,u=i;if(!(i instanceof Array)&&i instanceof ys&&(u=i.getVertices(),h=i.getSize()),i instanceof ys&&i.getSize()>2||i instanceof Array&&i.length>2?this.calcEndPoints_p([s[0],l[0],u[h-3].pt,u[h-2].pt,u[h-1].pt,u[h-3].dist,u[h-2].dist]):this.calcEndPoints_p1([u[h-2].pt,u[h-1].pt,u[h-2].dist,s[0],l[0]]),this.scalePoints(s,s.length,u[h-1].pt),this.scalePoints(l,l.length,u[h-1].pt),n.push.apply(n,s),r.push.apply(r,l),0!==a.length){for(var c=[],d=0;d<this.m_compoundArray.length;d++)c.push([]);this.calcCompoundPoints(s,l,c);for(var p=0;p<this.m_compoundArray.length;++p){var g;(g=a[p]).push.apply(g,S()(c[p]))}}var y=[];this.calcCap(u[h-2].pt,u[h-1].pt,u[h-2].dist,this.m_endCap,y),this.scalePoints(y,y.length,u[h-1].pt),o.push.apply(o,y)}},{key:"calcStartPoints_p1",value:function(e){var t=f()(e,5),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=this.m_width/2/r,l=(n.y()-i.y())*s,h=(n.x()-i.x())*s;a.setX(i.x()+l),a.setY(i.y()-h),o.setX(i.x()-l),o.setY(i.y()+h)}},{key:"calcStartPoints_p",value:function(e){var t=f()(e,7),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=this.m_width/2,u=h/s,c=u*(a.y()-r.y()),d=u*(a.x()-r.x()),p=_s(r,a,o);if(Ss(p))return i.setX(r.x()+c),i.setY(r.y()-d),n.setX(r.x()-c),void n.setY(r.y()+d);var g=h/l,y=window.Point,v=new window.Line(r,a),m=new window.Line(a,o),_=g*(o.y()-a.y()),w=g*(o.x()-a.x()),S=new window.Point;if(p>0?(v.translate(c,-d),m.translate(_,-w)):(v.translate(-c,d),m.translate(-_,w)),ws(v.p1(),v.p2(),m.p1(),m.p2(),S)||console.error("has no intersection!"),p>0&&_s(v.p1(),S,m.p2())<0||p<0&&_s(v.p1(),S,m.p2())>0){var x=y["-"](v.p2(),v.p1()),T=y["-"](S,v.p1()),k=!1;Ss(x.x())||Ss(T.x())?Ss(x.y())||Ss(T.y())||(k=x.y()*T.y()<0):k=x.x()*T.x()<0,k?p>0?(i.setX(S.x()),i.setY(S.y()),n.setX(r.x()-c),n.setY(r.y()+d)):(i.setX(r.x()+c),i.setY(r.y()-d),n.setX(S.x()),n.setY(S.y())):(i.setX(r.x()+c),i.setY(r.y()-d),n.setX(r.x()-c),n.setY(r.y()+d))}else i.setX(r.x()+c),i.setY(r.y()-d),n.setX(r.x()-c),n.setY(r.y()+d)}},{key:"calcEndPoints_p1",value:function(e){var t=f()(e,5),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=this.m_width/2/r,l=(n.y()-i.y())*s,h=(n.x()-i.x())*s;a.setX(n.x()+l),a.setY(n.y()-h),o.setX(n.x()-l),o.setY(n.y()+h)}},{key:"calcEndPoints_p",value:function(e){var t=f()(e,7),i=t[0],n=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],h=this.m_width/2,u=h/l,c=u*(o.y()-a.y()),d=u*(o.x()-a.x()),p=_s(r,a,o);if(Ss(p))return i.setX(o.x()+c),i.setY(o.y()-d),n.setX(o.x()-c),void n.setY(o.y()+d);var g=h/s,y=window.Point,v=g*(a.y()-r.y()),m=g*(a.x()-r.x()),_=new window.Line(r,a),w=new window.Line(a,o),S=new window.Point;if(p>0?(_.translate(v,-m),w.translate(c,-d)):(_.translate(-v,m),w.translate(-c,d)),ws(_.p1(),_.p2(),w.p1(),w.p2(),S)||console.error("has no intersection!"),p>0&&_s(_.p1(),S,w.p2())<0||p<0&&_s(_.p1(),S,w.p2())>0){var x=y["-"](w.p2(),w.p1()),T=y["-"](w.p2(),S),k=!1;Ss(x.x())||Ss(T.x())?Ss(x.y())||Ss(T.y())||(k=x.y()*T.y()<0):k=x.x()*T.x()<0,k?p>0?(i.setX(S.x()),i.setY(S.y()),n.setX(o.x()-c),n.setY(o.y()+d)):(i.setX(o.x()+c),i.setY(o.y()-d),n.setX(S.x()),n.setY(S.y())):(i.setX(o.x()+c),i.setY(o.y()-d),n.setX(o.x()-c),n.setY(o.y()+d))}else i.setX(o.x()+c),i.setY(o.y()-d),n.setX(o.x()-c),n.setY(o.y()+d)}},{key:"calcCap",value:function(e,t,i,n,r){var a=this.m_width/2/i,o=a*(t.y()-e.y()),s=a*(t.x()-e.x());switch(n){case ue.LineCapFlat:this.calcCapFlat(e,t,o,s,r);break;case ue.LineCapSquare:this.calcCapSquare(e,t,o,s,r);break;case ue.LineCapRound:this.calcCapRound(e,t,o,s,r);break;default:console.log("wrong lineCap Type "+n+"!Is this a simple stroke?")}}},{key:"calcCapFlat",value:function(e,t,i,n,r){for(var a=r.length,o=0;o<a+2;o++)r.push(new window.Point);r[a].setX(t.x()+i),r[a++].setY(t.y()-n),r[a].setX(t.x()-i),r[a].setY(t.y()+n)}},{key:"calcCapSquare",value:function(e,t,i,n,r){for(var a=r.length,o=0;o<a+4;o++)r.push(new window.Point);r[a].setX(t.x()+i),r[a++].setY(t.y()-n),r[a].setX(t.x()+i+n),r[a++].setY(t.y()-n+i),r[a].setX(t.x()-i+n),r[a++].setY(t.y()+n+i),r[a].setX(t.x()-i),r[a].setY(t.y()+n)}},{key:"calcCapRound",value:function(e,t,i,n,r){var a=this.m_width/2,o=2*Math.acos(a/(a+.125)),s=Math.floor(Math.PI/o);o=Math.PI/(s+1);var l=Math.PI+Math.atan2(n,i);l-=o;for(var h=r.length,u=0;u<h+s+2;u++)r.push(new window.Point);r[h].setX(t.x()+i),r[h++].setY(t.y()-n);for(var c=0;c<s;++c){var d=Math.cos(l)*a,p=Math.sin(l)*a;r[h].setX(t.x()-d),r[h++].setY(t.y()+p),l-=o}r[h].setX(t.x()-i),r[h].setY(t.y()+n)}},{key:"getWidth",value:function(){return this.m_width}},{key:"setWidth",value:function(e){this.m_width=e<=0?1:e}},{key:"getLineJoin",value:function(){return this.m_lineJoin}},{key:"setLineJoin",value:function(e){this.m_lineJoin=e}},{key:"getMiterLimit",value:function(){return this.m_miterLimit}},{key:"setMiterLimit",value:function(e){this.m_miterLimit=e}},{key:"getStartCap",value:function(){return this.m_startCap}},{key:"setStartCap",value:function(e){this.m_startCap=e}},{key:"getEndCap",value:function(){return this.m_endCap}},{key:"setEndCap",value:function(e){this.m_endCap=e}},{key:"setLineCap",value:function(e,t){this.setEndCap(t),this.setStartCap(e)}},{key:"getCompoundArrayCount",value:function(){return this.m_compoundArray.length}},{key:"getCompoundArray",value:function(e,t){if(!(e instanceof Array&&e))return!1;for(var i=0;i<t;++i)e[i]=this.m_compoundArray[i];return!0}},{key:"setCompoundArray",value:function(e,t){if(!(e instanceof Array&&e))return!1;if(1&t)return!1;for(var i=0;i<t-1;){if(e[i]<0||e[i]>1||e[i]>=e[i+1])return!1;++i}if(e[i]<0||e[i]>1)return!1;this.m_compoundArray.length=0;for(var n=0;n<t;++n)this.m_compoundArray.push(e[n]);return!0}},{key:"getAlignment",value:function(){return this.m_penAlignment}},{key:"setAlignment",value:function(e){this.m_penAlignment=e}},{key:"getPenScale",value:function(){return this.m_penScale}},{key:"setPenScale",value:function(e){this.m_penScale=e}},{key:"setScale",value:function(e,t){this.m_scaleX=e,this.m_scaleY=t}},{key:"getScale",value:function(){return{scaleX:this.m_scaleX,scaleY:this.m_scaleY}}}]),e}(),ys=function(){function e(t){r()(this,e),this.reset(t)}return o()(e,[{key:"reset",value:function(e){this.m_pVertices=[];for(var t=0;t<e.length-1;++t){var i=new vs(e[t],e[t+1]);1e-6<i.dist&&this.m_pVertices.push(i)}var n=new vs(e[e.length-1],e[0]);this.m_bClosed=e.isClosed,this.m_bClosed?1e-6<n.dist&&this.m_pVertices.push(n):this.m_pVertices.push(n)}},{key:"getSize",value:function(){return this.m_pVertices.length}},{key:"getVertices",value:function(){return this.m_pVertices}},{key:"isclosed",value:function(){return this.m_bClosed}}]),e}(),vs=function e(t,i){r()(this,e),this.pt=t,this.dist=ms(t,i)};function ms(e,t){if(e&&e.isQPoint&&t&&t.isQPoint){var i=e.x(),n=e.y(),r=t.x()-i,a=t.y()-n;return Math.sqrt(r*r+a*a)}console.error("this is not instanceof Point!")}function _s(e,t,i){var n=e.x(),r=e.y(),a=t.x(),o=t.y();return(i.x()-a)*(o-r)-(i.y()-o)*(a-n)}function ws(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new window.Point,a=e.x(),o=e.y(),s=t.x(),l=t.y(),h=i.x(),u=i.y(),c=n.x(),d=n.y(),p=(o-u)*(c-h)-(a-h)*(d-u),f=(s-a)*(d-u)-(l-o)*(c-h);if(Math.abs(f)<1e-20)return!1;var g=p/f;return r.setX(a+g*(s-a)),r.setY(o+g*(l-o)),!0}function Ss(e){return Math.abs(e)<=1e-12}var xs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r()(this,e),this.m_cap=this.createLineCapState(t,i),this.isValid()&&(this.m_cap.setBaseCap(n),this.m_cap.setBaseInset(a))}return o()(e,[{key:"createLineCapState",value:function(t,i){return i===e.AnchorPathUsage.PathFill?new ks(t):i===e.AnchorPathUsage.PathStroke?new Cs(t):null}},{key:"reset",value:function(e){this.m_cap&&delete this.m_cap,this.m_cap=e}},{key:"isValid",value:function(){return!Object.isEmpty(this.m_cap)}},{key:"strokeStartCap",value:function(){return this.m_cap.strokeStartCap()}},{key:"setStrokeStartCap",value:function(e){return this.m_cap.setStrokeStartCap(e)}},{key:"strokeEndCap",value:function(){return this.m_cap.strokeEndCap()}},{key:"setStrokeEndCap",value:function(e){return this.m_cap.setStrokeEndCap(e)}},{key:"baseCap",value:function(){return this.isValid()?this.m_cap.baseCap():ue.LineCapFlat}},{key:"baseInset",value:function(){return this.isValid()?this.m_cap.baseInset():0}},{key:"strokeJoin",value:function(){return this.isValid()?this.m_cap.strokeJoin():_e.LineJoinTypeMiter}},{key:"widthScale",value:function(){return this.isValid()?this.m_cap.widthScale():1}},{key:"setBaseCap",value:function(e){this.isValid()&&this.m_cap.setBaseCap(e)}},{key:"setBaseInset",value:function(e){this.isValid()&&this.m_cap.setBaseInset(e)}},{key:"setStrokeJoin",value:function(e){this.isValid()&&this.m_cap.setStrokeJoin(e)}},{key:"setWidthScale",value:function(e){this.isValid()&&this.m_cap.setWidthScale(e)}},{key:"setFlatness",value:function(e){this.isValid()&&this.m_cap.setFlatness(e)}},{key:"capPath",value:function(){return this.isValid()?this.m_cap.GetCapPath():[]}}]),e}();xs.AnchorPathUsage={PathFill:0,PathStroke:1};var Ts=function(){function e(t){r()(this,e),this.m_capPath=t,this.m_baseInset=0,this.m_widthScale=1,this.m_strokeStartCap=ue.LineCapFlat,this.m_strokeEndCap=ue.LineCapFlat,this.m_strokeLineJoin=_e.LineJoinTypeMiter,this.m_baseCap=ue.LineCapFlat,this.m_flatness=.25}return o()(e,[{key:"getDevidePoint",value:function(e,t,i,n,r){for(var a=this.getDevideDistance(e),o=0,s=1;s<i;++s){var l=Ps(t[0],t[s]);if(l>=a)return r[0]=s-1,Es(t[0],a,t[r[0]],t[s],o,l,n),!0;o=l}return!1}},{key:"getDevideDistance",value:function(e){var t=[];return this.calcCrossYPts(this.m_capPath,t,e)?t[0]>=0?0:-t[0]:0}},{key:"calcCrossYPts",value:function(e,t,i){var n=new window.QMatrix,r=i*this.widthScale();n=new window.QMatrix(r,0,0,r,0,0)["*"](n);for(var a=e.toSubpathPolygons(n,this.m_flatness),o=0;o<a.length;++o){for(var s=a[o],l=s.length,h=s,u=[],c=0;c<l;++c){var d=h[c].x();u[c]=d>0?1:d<0?-1:0}for(var p=0;p<l-1;++p)this.calcCrossYPt(h[p],h[p+1],u[p],u[p+1],t)}return t.sort((function(e,t){return e-t})),0!==t.length}},{key:"calcCrossYPt",value:function(e,t,i,n,r){var a=i*n;if(a<0){var o=(t.x()*e.y()-e.x()*t.y())/(t.x()-e.x());r.push(o)}else if(0===a)return 0===i&&r.push(e.y()),void(0===n&&r.push(t.y()))}},{key:"calcTransform",value:function(e,t,i,n,r){var a=Ps(t,i),o=(i.y()-t.y())/a,s=-(i.x()-t.x())/a;r.setMatrix(o,s,-s,o,0,0);var l=new window.QMatrix(e*this.m_widthScale,0,0,e*this.m_widthScale,0,0);r=r["*"](l);var h=new window.QMatrix(1,0,0,1,n.x(),n.y());r=r["*"](h)}},{key:"calcInsetScale",value:function(e){return e*this.m_baseInset*this.m_widthScale/this.getDevideDistance(e)}},{key:"baseInset",value:function(){return this.m_baseInset}},{key:"widthScale",value:function(){return this.m_widthScale}},{key:"strokeStartCap",value:function(){return this.m_strokeStartCap}},{key:"setStrokeStartCap",value:function(e){this.m_strokeStartCap=e}},{key:"strokeEndCap",value:function(){return this.m_strokeEndCap}},{key:"setStrokeEndCap",value:function(e){this.m_strokeEndCap=e}},{key:"strokeJoin",value:function(){return this.m_strokeLineJoin}},{key:"baseCap",value:function(){return this.m_baseCap}},{key:"setBaseInset",value:function(e){this.m_baseInset=e}},{key:"setWidthScale",value:function(e){this.m_widthScale=e}},{key:"setStrokeJoin",value:function(e){this.m_strokeLineJoin=e}},{key:"setBaseCap",value:function(e){this.m_baseCap=e}},{key:"setFlatness",value:function(e){this.m_flatness=e}}]),e}();Ts.AnchorType={AnchorTypeFill:0,AnchorTypeStroke:1};var ks=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.m_capPath=e,i}return u()(t,e),o()(t,[{key:"generateCap",value:function(e,t,i,n,r){var a=new window.QMatrix;this.calcTransform(e,t,i,n,a);var o=a.Map(this.m_capPath);r.addPath(o)}},{key:"getDevideDistance",value:function(e){var t=[];return this.calcCrossYPts(this.m_capPath,t,e)?t[0]>=0?0:-t[0]:0}},{key:"getMaxDistance",value:function(e){throw new Error("getMaxDistance Function not implemented")}},{key:"getCapPath",value:function(){return this.m_capPath}},{key:"getAnchorType",value:function(){return Ts.AnchorType.AnchorTypeFill}}]),t}(Ts),Cs=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.m_capPath=e,i}return u()(t,e),o()(t,[{key:"generateCap",value:function(e,t,i,n,r){var a=window,o=a.QPainterPath,s=a.Point,l=new gs;l.setWidth(this.widthScale()*e),l.setLineCap(this.strokeStartCap(),this.strokeEndCap()),l.setLineJoin(this.strokeJoin());var h=this.m_capPath,u=new window.QMatrix;this.calcTransform(e,t,i,n,u),h=u.Map(h);var c=new o;l.strokePath(h,c),Object(us.b)(3===this.m_capPath.elementCount());var d=this.m_capPath.elementAt(1).toPoint();d=u.map_point(new window.Point(d.x(),d.y()+2)),c.isEmpty()||(d=this.findNestestPoint(d,c)),c.translate(s["-"](n,d)),r.addPath(c)}},{key:"findNestestPoint",value:function(e,t){var i=window.Point;Object(us.b)(0!==t.elementCount());for(var n=i["-"](e,t.elementAt(0).toPoint()).manhattanLength(),r=0,a=1;a<t.elementCount();++a){var o=i["-"](e,t.elementAt(a).toPoint()).manhattanLength();n>o&&(n=o,r=a)}return t.elementAt(r).toPoint()}},{key:"getDevideDistance",value:function(e){Object(us.b)(3===this.m_capPath.elementCount());var t=e*this.widthScale(),i=window.Line,n=.5*t,r=new window.QMatrix(t,0,0,t,0,0).Map(this.m_capPath),a=r.elementAt(1).toPoint(),o=new window.Line(a,r.elementAt(0).toPoint()),s=new window.Line(a,r.elementAt(2).toPoint()),l=o.normalVector(),h=s.normalVector();l.setLength(n),h.setLength(-n),o.translate(l.dx(),l.dy()),s.translate(h.dx(),h.dy());var u=new window.Point;return i.IntersectType.NoIntersection!==o.intersect(s,u)?new window.Line(a,u).length():(Object(us.b)(!1),t)}},{key:"getMaxDistance",value:function(e){throw new Error("getMaxDistance Function not implemented")}},{key:"getCapPath",value:function(){return this.m_capPath}},{key:"getAnchorType",value:function(){return Ts.AnchorType.AnchorTypeStroke}}]),t}(Ts),bs=function(){function e(t,i,n){r()(this,e),this.m_width=n<1?1:n,this.m_pCustomStartCap=t.m_cap,this.m_pCustomEndCap=i.m_cap}return o()(e,[{key:"generate",value:function(e,t,i,n){for(var r=e.toSubpathPolygons(new window.QMatrix,n),a=0;a<r.length;++a)r[a].isClosed?t.addPolygon(r[a]):this.m_pCustomStartCap||this.m_pCustomEndCap?this.generateCap(r[a],r[a].length,t,i):t.addPolygon(r[a])}},{key:"generateCap",value:function(e,t,i,n){Object(us.b)(t>1);var r=window.QPainterPath,a=new r,o=[];if(o=Object(us.d)(e),this.m_pCustomStartCap){var s=new window.Point,l=[];if(this.m_pCustomStartCap.getDevidePoint(this.m_width,e,t,s,l)){var h=e[0];if(this.m_pCustomStartCap.generateCap(this.m_width,s,h,h,a),this.m_pCustomStartCap.getAnchorType()===Ts.AnchorType.AnchorTypeStroke)o.splice(0,0+l[0]+1,s);else{var u=new window.Point;Rs(h,s,this.m_pCustomStartCap.calcInsetScale(this.m_width),u),o.splice(0,0+l[0]+1,u)}}else{var c=e[0],d=e[t-1];this.m_pCustomStartCap.generateCap(this.m_width,d,c,c,a),o.length=0}}if(this.m_pCustomEndCap)if(0!==o.length){var p=Object(us.d)(o);p.reverse();var f=new window.Point,g=[];if(this.m_pCustomEndCap.getDevidePoint(this.m_width,p,p.length,f,g)){var y=p[0];if(this.m_pCustomEndCap.generateCap(this.m_width,f,y,y,a),this.m_pCustomEndCap.getAnchorType()===Ts.AnchorType.AnchorTypeStroke)p.splice(0,0+g[0]+1,f);else{var v=new window.Point;Rs(y,f,this.m_pCustomEndCap.calcInsetScale(this.m_width),v),p.splice(0,0+g[0]+1,v)}p.reverse(),o=p}else this.m_pCustomStartCap&&t>2?a=new r:this.m_pCustomEndCap.generateCap(this.m_width,o[0],o[o.length-1],o[o.length-1],a),o.length=0}else{for(var m=[],_=1;_<t-1;++_)m.push(e[_]);var w=new window.Point,S=this.m_pCustomStartCap.baseInset()*this.m_pCustomStartCap.widthScale();Rs(e[0],e[t-1],S,w),m.push(w);var x=new window.Point;this.m_pCustomEndCap.getDevidePoint(this.m_width,m,m.length,x,[0])?this.m_pCustomEndCap.generateCap(this.m_width,x,w,e[t-1],a):this.m_pCustomStartCap.baseInset()>0&&this.m_pCustomEndCap.generateCap(this.m_width,e[0],e[t-1],e[t-1],a),o.length=0}i.addPolygon(o),a.isEmpty()||n.addPath(a)}}]),e}();function Es(e,t,i,n,r,a,o){if(Object(us.c)(r<=t&&a>=t,"",""),0!==r)if(s=a,l=t,Math.abs(s-l)<=1e-12*Math.min(Math.abs(s),Math.abs(l)))o=n;else{var s,l,h=function(e,t,i){var n=e.x(),r=e.y(),a=t.x(),o=t.y(),s=i.x(),l=i.y(),h=a-n,u=o-r,c=Math.sqrt(h*h+u*u);if(c<1e-13)return Ps(new window.Point(n,r),new window.Point(s,l));return((s-a)*u-(l-o)*h)/c}(i,n,e);if(u=h,Math.abs(u)<=1e-12)Rs(e,n,t/a,o);else{var u,c=Ps(i,n);Rs(n,i,(Math.sqrt(a*a-h*h)-Math.sqrt(t*t-h*h))/c,o)}}else Rs(i,n,t/a,o)}function Rs(e,t,i,n){var r=t.x()-e.x(),a=t.y()-e.y();n.setX(e.x()+r*i),n.setY(e.y()+a*i)}function Ps(e,t){return e.isQPoint&&t.isQPoint?new window.Line(e,t).length():(console.log("calc_distance error",e,t),0)}var Is=function(){function e(){r()(this,e),this.d_ptr=new fs}return o()(e,[{key:"createStroke",value:function(e,t){var i=window.QPainterPath,n=new i,r=new i;this.d_ptr.startAnchor.setFlatness(t),this.d_ptr.endAnchor.setFlatness(t),new bs(this.d_ptr.startAnchor,this.d_ptr.endAnchor,this.d_ptr.width).generate(e,r,n,t);var a=new i,o=new Ls(this.d_ptr.alignmentOffset());0===o.getOffSet()?a=r:o.zoomPath(r,a,t);var s=this.d_ptr.prepareMathStroker();if(this.d_ptr.isSolid())s.strokePath(a,n,t);else{var l=this.d_ptr.prepareDasher();l.setClipRect(this.d_ptr.clipRect);var h=this.dashCapStyle(),u=this.startCapStyle(),c=this.endCapStyle();if(h===u&&u===c){var d=new i;l.getDashedPath(a,d,t),s.strokePath(d,n,t)}else{var p=new i,f=new i,g=new i;l.getDashedPath_5(a,p,f,g,t),s.setStartCap(u),s.strokePath(p,n,t),s.setStartCap(h),s.strokePath(f,n,t),s.setEndCap(c),s.strokePath(g,n,t)}}return this.outBound=n.boundingRect(),n}},{key:"createStrokerFromPen",value:function(e){this.setDashPattern(e.dashPattern||[]),this.setDashOffset(e.dashOffset||0),this.setMiterLimit(e.miterLimit),this.setWidth(e.width),this.setJoinStyle(e.joinStyle),this.setCompoundArray(e.compoundArray||[]),this.setStartAnchorStyle(e.startAnchorStyle),this.setStartAnchor(e.startAnchor),this.setEndAnchorStyle(e.endAnchorStyle),this.setEndAnchor(e.endAnchor),this.setAlignment(e.alignment),this.setStartCapStyle(e.startCapStyle),this.setEndCapStyle(e.endCapStyle),this.setDashCapStyle(e.dashCapStyle),this.setPenScale(e.scale)}},{key:"dashPattern",value:function(){return this.d_ptr.dashPattern}},{key:"setDashPattern",value:function(e){this.d_ptr.dashPattern!==e&&(this.detach(),this.d_ptr.dashPattern=e)}},{key:"dashOffset",value:function(){return this.d_ptr.dashOffset}},{key:"setPenScale",value:function(e){var t;(t=e,Math.abs(t)<=1e-12)||(this.d_ptr.penScale=e)}},{key:"penScale",value:function(){return this.d_ptr.penScale}},{key:"setDashOffset",value:function(e){Bs(this.d_ptr.dashOffset,e)||(this.detach(),this.d_ptr.dashOffset=e)}},{key:"miterLimit",value:function(){return this.d_ptr.miterLimit}},{key:"setMiterLimit",value:function(e){Bs(this.d_ptr.miterLimit,e)||(this.detach(),this.d_ptr.miterLimit=e)}},{key:"width",value:function(){return this.d_ptr.width}},{key:"setWidth",value:function(e){Bs(this.d_ptr.width,e)||(this.detach(),this.d_ptr.width=e,this.d_ptr.width<=0&&(this.d_ptr.width=1))}},{key:"joinStyle",value:function(){return this.d_ptr.joinStyle}},{key:"setJoinStyle",value:function(e){this.d_ptr.joinStyle!==e&&(this.detach(),this.d_ptr.joinStyle=e)}},{key:"compoundArray",value:function(){return this.d_ptr.compoundArray}},{key:"setCompoundArray",value:function(e){(e instanceof Array||this.d_ptr.compoundArray!==e)&&(this.detach(),this.d_ptr.compoundArray=e)}},{key:"startAnchorStyle",value:function(){return this.d_ptr.startAnchorStyle}},{key:"setStartAnchorStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xs;this.d_ptr.startAnchorStyle!==e&&(this.detach(),this.d_ptr.startAnchorStyle=e,this.d_ptr.startAnchor=e)}},{key:"startAnchor",value:function(){return this.d_ptr.startAnchor}},{key:"setStartAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xs;this.detach(),this.d_ptr.startAnchor=e}},{key:"endAnchorStyle",value:function(){return this.d_ptr.endAnchorStyle}},{key:"setEndAnchorStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xs;this.d_ptr.endAnchorStyle!==e&&(this.detach(),this.d_ptr.endAnchorStyle=e,this.d_ptr.endAnchor=e)}},{key:"endAnchor",value:function(){return this.d_ptr.endAnchor}},{key:"setEndAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xs;this.detach(),this.d_ptr.endAnchor=e}},{key:"alignment",value:function(){return this.d_ptr.alignment}},{key:"setAlignment",value:function(e){this.d_ptr.alignment!==e&&(this.detach(),this.d_ptr.alignment=e)}},{key:"startCapStyle",value:function(){return this.d_ptr.startCap}},{key:"setStartCapStyle",value:function(e){this.d_ptr.startCap!==e&&(this.detach(),this.d_ptr.startCap=e)}},{key:"endCapStyle",value:function(){return this.d_ptr.endCap}},{key:"setEndCapStyle",value:function(e){this.d_ptr.endCap!==e&&(this.detach(),this.d_ptr.endCap=e)}},{key:"dashCapStyle",value:function(){return this.d_ptr.dashCap}},{key:"setDashCapStyle",value:function(e){this.d_ptr.dashCap!==e&&(this.detach(),this.d_ptr.dashCap=e)}},{key:"getClipRect",value:function(){return this.d_ptr.clipRect}},{key:"setClipRect",value:function(e){this.d_ptr.clipRect!==e&&(this.detach(),this.d_ptr.clipRect=e)}},{key:"detach",value:function(){if(1!==this.d_ptr.ref)throw new Error("this.d_ptr.ref error!")}}]),e}(),Ls=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r()(this,e),this.m_offset=t}return o()(e,[{key:"setOffset",value:function(e){this.m_offset=e}},{key:"getOffSet",value:function(){return this.m_offset}},{key:"zoomPath",value:function(e,t,i){if(0!==this.m_offset)if(this.m_offset>0)for(var n=e.toSubpathPolygons(null,i),r=this.m_offset,a=0;a<n.length;++a){var o=new As(n[a]);if(o.isValid()){0===a&&(o.isClockWise()||(r=-this.m_offset));var s=[];o.getZoomPoints(s,r),t.moveTo(s[0]),t.connectPolygon(s),o.isClosed()&&t.closeSubpath()}else{var l=n[a];t.connectPolygon(l),l.isClosed&&t.closeSubpath()}}else for(var h=e.toSubpathPolygons(null,i),u=this.m_offset,c=0,d=h.length;c<d;++c){var p=new As(h[c]);if(p.isValid()){var f=[];p.getZoomPoints(f,u),t.moveTo(f[0]),t.connectPolygon(f),p.isClosed()&&t.closeSubpath()}else{var g=h[c],y=new window.Line(new window.Point,new window.Point);this.getEdgeOffsetPts(g[0],g[1],u,y),t.moveTo(y.p1()),t.lineTo(y.p2()),g.isClosed&&(t.closeSubpath(),t.closeSubpath())}}else t=e}}]),e}(),As=function(){function e(t){r()(this,e),this.m_bClosed=!1,this.m_bClockWise=!1,this.m_pts=t,this.eraseStraightPointsOnPolygon(this.m_pts)?(this.m_bClosed=t.isClosed,this.m_bClockWise=function(e,t){for(var i=e[0].x(),n=0,r=1;r<t;++r)e[r].x()<i&&(i=e[r].x(),n=r);var a=void 0,o=void 0,s=n;a=n-1,o=n+1,0===s&&(a=t-1);s===t-1&&(o=0);return Ds(e[a],e[s],e[o])<0}(this.m_pts,this.m_pts.length)):(console.log("polygon is Clear!!!"),this.m_pts.length=0)}return o()(e,[{key:"eraseStraightPointsOnPolygon",value:function(e){var t=e.length;if(t<3)return!1;if(3===t)return 3!==Ds(e[0],e[1],e[2]);for(var i=0;i<t-2;++i)0===Ds(e[i],e[i+1],e[i+2])&&(e.splice(0+i+1,1),--t,--i);return!(t<3)&&(0===Ds(e[t-2],e[t-1],e[0])&&(e.splice(e.length-1,1),--t),!(t<3)&&(0===Ds(e[t-1],e[0],e[1])&&(e.splice(0,1),--t),!(t<3)))}},{key:"getZoomPoints",value:function(e,t){e.length=0;var i=new window.Line(new window.Point,new window.Point),n=new window.Line(new window.Point,new window.Point),r=0,a=new window.Point(this.m_pts[0].x(),this.m_pts[0].y());this.m_bClosed?(this.getEdgeOffsetPts(this.m_pts[this.m_pts.length-1],this.m_pts[0],t,i),this.getEdgeOffsetPts(this.m_pts[0],this.m_pts[1],t,n),i.intersect(n,a),Os(r=i.angleTo(n))?e.push(i.p2()):Ms(r)?(e.push(i.p2()),e.push(n.p1())):e.push(new window.Point(a.x(),a.y()))):(this.getEdgeOffsetPts(this.m_pts[0],this.m_pts[1],t,i),n=i,e.push(i.p1()));for(var o=this.m_pts.length,s=1;s<o-1;++s)if(!(new window.Line(this.m_pts[s],this.m_pts[s+1]).length()<.01)){var l=new window.Line(n.p1(),n.p2());this.getEdgeOffsetPts(this.m_pts[s],this.m_pts[s+1],t,n),l.intersect(n,a),Os(r=l.angleTo(n))?e.push(l.p2()):Ms(r)?(e.push(l.p2()),e.push(n.p1())):e.push(new window.Point(a.x(),a.y()))}if(this.m_bClosed){var h=new window.Line(n.p1(),n.p2());this.getEdgeOffsetPts(this.m_pts[o-1],this.m_pts[0],t,n),h.intersect(n,a),Os(r=h.angleTo(n))?e.push(h.p2()):Ms(r)?(e.push(h.p2()),e.push(n.p1())):e.push(new window.Point(a.x(),a.y()))}else this.getEdgeOffsetPts(this.m_pts[o-2],this.m_pts[o-1],t,n),e.push(n.p2());return!0}},{key:"getEdgeOffsetPts",value:function(e,t,i,n){var r=new window.Line(e,t),a=r.normalVector();if(!(Math.abs(a.dx())<.01&&Math.abs(a.dy())<.01)){var o=a.unitVector();o.setLength(i),r.translate(o.dx(),o.dy()),n.setNewLine(r)}}},{key:"isValid",value:function(){return 0!==this.m_pts.length}},{key:"isClosed",value:function(){return this.m_bClosed}},{key:"isClockWise",value:function(){return this.m_bClockWise}},{key:"getPointsCount",value:function(){return this.m_pts.length}},{key:"getPoints",value:function(){return this.m_pts}}]),e}();function Bs(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function Ds(e,t,i){var n=e.x(),r=e.y(),a=t.x(),o=t.y();return(i.x()-a)*(o-r)-(i.y()-o)*(a-n)}function Ms(e){return e>=170&&e<=190}function Os(e){return e<.1||e>359.9}var Ns=i(2722);function Fs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=Object(Ns.b)(e,t,"canvas","geomerty"),n=i.getElem();return n.width=e<1?1:e,n.height=t<1?1:t,i}var Vs=i(1017),Us=function(){function e(){r()(this,e),this.shadowRange=[[102,255],[50,255],[0,153],[0,205]]}return o()(e,[{key:"fillShadowTransform",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.shadowRange;if(t>=0&&t<r.length){var a=r[t][1],o=r[t][0],s=a-o;e.map((function(e){var t=o*e[3]*255;e[0]=t+s*e[0]>>8,e[1]=t+s*e[1]>>8,e[2]=t+s*e[2]>>8}))}var l=e.map((function(e){return"rgba("+(e=i.colorLightControl(e,n))[0]+","+e[1]+","+e[2]+","+e[3]+")"}));return l}},{key:"colorLightControl",value:function(e,t){var i=f()(e,3),n=i[0],r=i[1],a=i[2];return t>=0?(n+=(255-n)*t,r+=(255-r)*t,a+=(255-a)*t):t<0&&(n+=n*t,r+=r*t,a+=a*t),[n=n<255?n:255,r=r<255?r:255,a=a<255?a:255,e[3]]}},{key:"transformFillData",value:function(){}},{key:"setFillColorRgba",value:function(e){this.rgba=e}},{key:"getFillColorRgba",value:function(){return this.rgba}},{key:"setShadowRangeIndex",value:function(e){this.shadowRangeIndex=e}},{key:"getShadowRangeIndex",value:function(){return this.shadowRangeIndex}},{key:"solidFill",value:function(e,t,i){var n=t.slice(5,t.length-1).split(",").map(Number);if(i>=0&&i<this.shadowRange.length){var r=this.fillShadowTransform([n],i);e.fillStyle=r}else e.fillStyle=this.fillShadowTransform([n])}},{key:"backGroundColorFill",value:function(e,t){var i=void 0,n=void 0,r=void 0;t>=0&&t<this.shadowRange.length?(n=(i="rgba(0,0,0,0.2)").slice(5,i.length-1).split(",").map(Number),r=this.fillShadowTransform([n],t),e.fillStyle=r):(n=(i="rgba(255,255,255,0)").slice(5,i.length-1).split(",").map(Number),e.fillStyle=this.fillShadowTransform([n]))}},{key:"render",value:function(e){return this.getFillColorRgba()?this.solidFill(e,this.getFillColorRgba(),this.getShadowRangeIndex()):this.backGroundColorFill(this.getShadowRangeIndex()),!0}}]),e}(),Gs=function(){function e(t,i,n,a,o,s,l,h,u,c,d,p,f,g,y,v){r()(this,e),this.m=[[],[],[],[]],0===arguments.length?this.setToIdentity():(this.m[0][0]=t,this.m[0][1]=o,this.m[0][2]=u,this.m[0][3]=f,this.m[1][0]=i,this.m[1][1]=s,this.m[1][2]=c,this.m[1][3]=g,this.m[2][0]=n,this.m[2][1]=l,this.m[2][2]=d,this.m[2][3]=y,this.m[3][0]=a,this.m[3][1]=h,this.m[3][2]=p,this.m[3][3]=v),this.flagBits=2}return o()(e,[{key:"data",value:function(){return this.flagBits=2,this.m}},{key:"constData",value:function(){return this.flagBits=2,this.m}},{key:"setToIdentity",value:function(){var e=this.m;e[0][0]=1,e[0][1]=0,e[0][2]=0,e[0][3]=0,e[1][0]=0,e[1][1]=1,e[1][2]=0,e[1][3]=0,e[2][0]=0,e[2][1]=0,e[2][2]=1,e[2][3]=0,e[3][0]=0,e[3][1]=0,e[3][2]=0,e[3][3]=1,this.flagBits=1}},{key:"isIdentity",value:function(){if(1===this.flagBits)return!0;var e=this.m;return 1===e[0][0]&&0===e[0][1]&&0===e[0][2]&&(0===e[0][3]&&0===e[1][0]&&1===e[1][1]&&(0===e[1][2]&&0===e[1][3]&&0===e[2][0]&&(0===e[2][1]&&1===e[2][2]&&0===e[2][3]&&(0===e[3][0]&&0===e[3][1]&&0===e[3][2]&&1===e[3][3]))))}},{key:"isMatrix4x4",get:function(){return!0}}],[{key:"multiply",value:function(e,t){return e.isMatrix4x4&&"number"==typeof t?this.m1Multiplyn(e,t):e.isMatrix4x4&&t.isMatrix4x4?this.m1Multiplym2(e,t):void 0}},{key:"m1Multiplym2",value:function(t,i){if(1===t.flagBits)return i;if(1===i.flagBits)return t;var n=new e;return n.m[0][0]=t.m[0][0]*i.m[0][0]+t.m[1][0]*i.m[0][1]+t.m[2][0]*i.m[0][2]+t.m[3][0]*i.m[0][3],n.m[0][1]=t.m[0][1]*i.m[0][0]+t.m[1][1]*i.m[0][1]+t.m[2][1]*i.m[0][2]+t.m[3][1]*i.m[0][3],n.m[0][2]=t.m[0][2]*i.m[0][0]+t.m[1][2]*i.m[0][1]+t.m[2][2]*i.m[0][2]+t.m[3][2]*i.m[0][3],n.m[0][3]=t.m[0][3]*i.m[0][0]+t.m[1][3]*i.m[0][1]+t.m[2][3]*i.m[0][2]+t.m[3][3]*i.m[0][3],n.m[1][0]=t.m[0][0]*i.m[1][0]+t.m[1][0]*i.m[1][1]+t.m[2][0]*i.m[1][2]+t.m[3][0]*i.m[1][3],n.m[1][1]=t.m[0][1]*i.m[1][0]+t.m[1][1]*i.m[1][1]+t.m[2][1]*i.m[1][2]+t.m[3][1]*i.m[1][3],n.m[1][2]=t.m[0][2]*i.m[1][0]+t.m[1][2]*i.m[1][1]+t.m[2][2]*i.m[1][2]+t.m[3][2]*i.m[1][3],n.m[1][3]=t.m[0][3]*i.m[1][0]+t.m[1][3]*i.m[1][1]+t.m[2][3]*i.m[1][2]+t.m[3][3]*i.m[1][3],n.m[2][0]=t.m[0][0]*i.m[2][0]+t.m[1][0]*i.m[2][1]+t.m[2][0]*i.m[2][2]+t.m[3][0]*i.m[2][3],n.m[2][1]=t.m[0][1]*i.m[2][0]+t.m[1][1]*i.m[2][1]+t.m[2][1]*i.m[2][2]+t.m[3][1]*i.m[2][3],n.m[2][2]=t.m[0][2]*i.m[2][0]+t.m[1][2]*i.m[2][1]+t.m[2][2]*i.m[2][2]+t.m[3][2]*i.m[2][3],n.m[2][3]=t.m[0][3]*i.m[2][0]+t.m[1][3]*i.m[2][1]+t.m[2][3]*i.m[2][2]+t.m[3][3]*i.m[2][3],n.m[3][0]=t.m[0][0]*i.m[3][0]+t.m[1][0]*i.m[3][1]+t.m[2][0]*i.m[3][2]+t.m[3][0]*i.m[3][3],n.m[3][1]=t.m[0][1]*i.m[3][0]+t.m[1][1]*i.m[3][1]+t.m[2][1]*i.m[3][2]+t.m[3][1]*i.m[3][3],n.m[3][2]=t.m[0][2]*i.m[3][0]+t.m[1][2]*i.m[3][1]+t.m[2][2]*i.m[3][2]+t.m[3][2]*i.m[3][3],n.m[3][3]=t.m[0][3]*i.m[3][0]+t.m[1][3]*i.m[3][1]+t.m[2][3]*i.m[3][2]+t.m[3][3]*i.m[3][3],n}},{key:"m1Multiplyn",value:function(t,i){var n=new e;return n.m[0][0]=t.m[0][0]*i,n.m[0][1]=t.m[0][1]*i,n.m[0][2]=t.m[0][2]*i,n.m[0][3]=t.m[0][3]*i,n.m[1][0]=t.m[1][0]*i,n.m[1][1]=t.m[1][1]*i,n.m[1][2]=t.m[1][2]*i,n.m[1][3]=t.m[1][3]*i,n.m[2][0]=t.m[2][0]*i,n.m[2][1]=t.m[2][1]*i,n.m[2][2]=t.m[2][2]*i,n.m[2][3]=t.m[2][3]*i,n.m[3][0]=t.m[3][0]*i,n.m[3][1]=t.m[3][1]*i,n.m[3][2]=t.m[3][2]*i,n.m[3][3]=t.m[3][3]*i,n}}]),e}(),Hs=i(1717),Ws=window.imageEffectsPool=window.imageEffectsPool||new Hs.a(50),js=function(e){function t(e){var i=e.rect,n=e.fill,a=e.shadowRangeIndex,o=e.preloadSource,s=e.scale,h=e.clip;r()(this,t);var u=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),c=i.width,d=i.height,p=i.x,f=i.y;return u.rect=i||{},u.nRect=new window.Rect(p,f,c,d),u.fill=n||{},u.clip=h||!1,u.scale=15*s,u.shadowRangeIndex=void 0===a?-1:a,u.preloadSource=o||{},u._init(),u}return u()(t,e),o()(t,[{key:"transformFillData",value:function(e){if(e.isStretched)return e.stretchRectangle?e.stretchRectangle:{left:0,right:0,top:0,bottom:0};var t=e.tileHorizontalOffset,i=e.tileVerticalOffset,n=e.tileFlip,r=e.tileVerticalRatio,a=e.tileHorizontalRatio;return{tx:t?t*(1/635)*(1/15):0,ty:i?i*(1/635)*(1/15):0,sy:r||1,sx:a||1,tileAlignment:e.tileAlignment,tileFlip:n,imageHeight:e.blip.blipAtom.imageHeight,imageWidth:e.blip.blipAtom.imageWidth}}},{key:"_init",value:function(){var e=this,t=this.fill;this.rotateAngle=0,t.hasOwnProperty("rotateWithShape")&&!t.rotateWithShape&&(this.rotateAngle=-this.rect.rotation,this.rect.horizontalFlipped&&(this.horizontalFlipped=!0),this.rect.verticalFlipped&&(this.verticalFlipped=!0));var i=1;if(t.blip&&t.blip.effects){var n=[];t.blip.effects.forEach((function(t){t.type===Be.c.AlphaModulateFixed?i="number"==typeof t.amount?t.amount:1:e.supportImageEffect(t)&&e.isLegalImageEffect(t)&&n.push(new Ys(t))})),this.imageEffects=n}this.alpha=i}},{key:"supportImageEffect",value:function(e){return e&&(e.type===Be.c.Duotone||e.type===Be.c.Luminance)}},{key:"isLegalImageEffect",value:function(e){var t=e.brightness,i=e.contrast;return e.type!==Be.c.Luminance||!(0===t&&0===i)}},{key:"render",value:function(e){var t=this.fill,i=this.preloadSource,n=t.blip&&t.blip.blipAtom&&t.blip.blipAtom.imageId;if(!i[n])return!1;var r=i[n];if(!(r.width>0&&r.height>0||r.data_url))return!1;if(this.imageEffects&&this.imageEffects.length>0){var a=Ws.get(n);if(a&&this.isEqualImageEffects(a.imageEffects)&&(a.image.width||e.isSvg))this.image=a.image;else{var o=this.makeImageEffects(r),s=o.img,l=o.canvas;this.image=e.isSvg?s:l,e.isSvg&&Ws.set(n,{image:s,imageEffects:this.imageEffects})}}else this.image=r;this.ctx=e;var h=void 0;if(t.isStretched){var u=this.transformFillData(t);h=this.createStretchTexture(u)}else{if(0===t.tileHorizontalRatio||0===t.tileVerticalRatio)return!1;var c=this.transformFillData(t);h=this.createTileTexture(c)}return e.fillStyle=h,!0}},{key:"isEqualImageEffects",value:function(e){return e&&this.imageEffects&&this.imageEffects.every((function(t,i){return t.isEqual(e[i])}))}},{key:"makeImageEffects",value:function(e){if(!this.imageEffects||0===this.imageEffects.length||!e.width||!e.height||e.src.includes("data:image/gif;"))return{img:e,canvas:e};if(e.width*e.height>3686400)return{img:e,canvas:e};var t=Fs(e.width,e.height).getElem(),i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);var n=i.getImageData(0,0,e.width,e.height);this.imageEffects.forEach((function(e){e.makeEffects(n.data)})),i.putImageData(n,0,0);var r=new Image;return r._logicWidth=e._logicWidth||e.width,r._logicHeight=e._logicHeight||e.height,r.data_url=r.src=t.toDataURL(),{img:r,canvas:t}}},{key:"createStretchTexture",value:function(e){var t=this.nRect,i=this.ctx,n=this.rotateAngle,r=this.shadowRangeIndex,a=this.alpha,o=this.image,s=!1;i.__defs||(s=!0);var l=t.width()+Math.abs(t.x()),h=t.height()+Math.abs(t.y()),u=s?Fs(l,h).getElem():new Vs.default(l,h),c=u.getContext("2d");i.globalAlpha=a;var d=0+e.left*u.width,p=0+e.top*u.height,f=u.width*(1-e.left-e.right),g=u.height*(1-e.top-e.bottom);(n||this.horizontalFlipped||this.verticalFlipped)&&(c.translate(l/2,h/2),this.horizontalFlipped&&c.scale(-1,1),this.rect.verticalFlipped&&c.scale(1,-1),c.rotate(n*Math.PI/180),c.translate(-l/2,-h/2)),e.left+e.right>1&&(c.translate(d+f/2,p+g/2),c.scale(-1,1),c.translate(-d-f/2,-p-g/2),d+=f,f=Math.abs(f)),e.top+e.bottom>1&&(c.translate(d+f/2,p+g/2),c.scale(1,-1),c.translate(-d-f/2,-p-g/2),p+=g,g=Math.abs(g));var y=this.getBlipAtom(),v=o._logicWidth||o.width||y&&y.imageWidth,m=o._logicHeight||o.height||y&&y.imageHeight;if(this.clip?c.drawImage(o,t.x(),t.y(),t.width(),t.height()):c.drawImage(o,0,0,v,m,d,p,f,g),s&&r>=0&r<=3){var _=c.getImageData(d,p,f,g);this.fillImageTransform(_.data),c.clearRect(d,p,f,g);var w=d,S=p;f<0&&(w=d+f),g<0&&(S=p+g),c.putImageData(_,w,S)}return i.createPattern(u,"no-repeat")}},{key:"createTileTexture",value:function(e){var t=this.nRect,i=this.ctx,n=this.alpha,r=this.image,a=!1;i.__defs||(a=!0);var o=this.getBlipAtom(),s=o?o.imageWidth:r._logicWidth||r.width,l=o?o.imageHeight:r._logicHeight||r.height,h=this.scale,u=s*h*e.sx,c=l*h*e.sy;if(o){var d=o.dpiX,p=o.dpiY;u*=Object.isEmpty(d)?1:96/d,c*=Object.isEmpty(p)?1:96/p}var f=new window.Rect(0,0,u,c),g=this.alignSrcPosition(f,t,e.tileAlignment),y=g.moveLeft,m=g.moveTop,_=a?Fs(u,c).getElem():new Vs.default(u,c),w=_.getContext("2d");i.globalAlpha=n,w.drawImage(r,0,0,_.width,_.height),_=this.createImageTexture(_,u,c,e);var S=i.createPattern(_,"repeat"),x=v.userAgent.chromeVS<96&&v.userAgent.chromeVS>70?4:1,T=new window.QMatrix;if(T.scale(x,x),this.rotateAngle){var k=new(0,window.QMatrix);k.rotate(this.rect.rotation);var C=k.mapRect(t);T.rotate(-this.rect.rotation),T.scale(this.horizontalFlipped?-1:1,this.verticalFlipped?-1:1),T.translate(C.x(),C.y())}else T.translate(e.tx*h-y+t.x(),e.ty*h-m+t.y());if(T.scale(1/x,1/x),a){if(window.DOMMatrix){var b=new DOMMatrix;b.setMatrixValue(T.toString()),S.setTransform&&S.setTransform(b)}}else S.setTransform&&S.setTransform(T.toString());return S}},{key:"alignSrcPosition",value:function(e,t,i){var n=0,r=0;if(e.size()===t.size())return{moveLeft:n,moveTop:r};switch(i){case Be.g.RectangleAlignmentTop:n=.5*(e.left()+e.right()-t.width());break;case Be.g.RectangleAlignmentTopRight:n=e.right()-t.width();break;case Be.g.RectangleAlignmentLeft:r=.5*(e.top()+e.bottom()-t.height());break;case Be.g.RectangleAlignmentCenter:n=.5*(e.left()+e.right()-t.width()),r=.5*(e.top()+e.bottom()-t.height());break;case Be.g.RectangleAlignmentRight:n=e.right()-t.width(),r=.5*(e.top()+e.bottom()-t.height());break;case Be.g.RectangleAlignmentBottomLeft:r=e.bottom()-t.height();break;case Be.g.RectangleAlignmentBottom:n=.5*(e.left()+e.right()-t.width()),r=e.bottom()-t.height();break;case Be.g.RectangleAlignmentBottomRight:n=e.right()-t.width(),r=e.bottom()-t.height()}return{moveLeft:n,moveTop:r}}},{key:"createImageTexture",value:function(e,t,i,n){var r=this.image,a=this.shadowRangeIndex,o=e;if(a>=0&&a<=3||n.tileFlip&&0!==n.tileFlip){var s=!1;e.__defs||(s=!0);var l=(o=s?Fs(2*t,2*i).getElem():new Vs.default(2*t,2*i)).getContext("2d");if(l.fillStyle=l.createPattern(e,"repeat"),s&&a>=0&&a<=3){var h=[0,0,o.width,o.height],u=h[0],c=h[1],d=h[2],p=h[3],f=l.getImageData(u,c,d,p);this.fillImageTransform(f.data),l.clearRect(u,c,d,p);var g=u,y=c;d<0&&(g=u+d),p<0&&(y=c+p),l.putImageData(f,g,y)}switch(l.fillRect(0,0,o.width,o.height),n.tileFlip){case Be.h.TileFlipVertical:l.translate(t,2*i),l.scale(1,-1),l.fillRect(-t,0,o.width,i);break;case Be.h.TileFlipHorizontal:l.translate(2*t,i),l.scale(-1,1),l.fillRect(0,-i,t,o.height);break;case Be.h.TileFlipBoth:l.drawImage(r,0,0,t,i),l.save(),l.translate(t,i/2),l.scale(-1,1),l.translate(-t,-i/2),l.drawImage(r,0,0,t,i),l.restore(),l.save(),l.translate(t/2,i),l.scale(1,-1),l.translate(-t/2,-i),l.drawImage(r,0,0,t,i),l.restore(),l.translate(t,i),l.scale(-1,-1),l.translate(-t,-i),l.drawImage(r,0,0,t,i)}}return o}},{key:"fillImageTransform",value:function(e){var t=this.shadowRange,i=this.shadowRangeIndex;if(i>=0&&i<t.length)for(var n=t[i][1],r=t[i][0],a=n-r,o=0;o<e.length;o+=4){var s=e[o+3],l=e[o],h=e[o+1],u=e[o+2],c=r*s;e[o]=(c+a*l)/256,e[o+1]=(c+a*h)/256,e[o+2]=(c+a*u)/256}}},{key:"getBlipAtom",value:function(){return this.fill.blip&&this.fill.blip.blipAtom}}]),t}(Us),Ys=function(){function e(t){r()(this,e),this.effectMode=e.DmlModel,this._init(t)}return o()(e,[{key:"_init",value:function(e){var t=e.color1,i=e.color2,n=e.shadowLow,r=e.shadowHight,a=e.type,o=e.brightness,s=e.contrast,l=e.colorKey;if(this.type=a,t&&t.rgba){var h=t.rgba;this.duotoneColor1=h.slice(5,-1).split(",").map(Number)}if(i&&i.rgba){var u=i.rgba;this.duotoneColor2=u.slice(5,-1).split(",").map(Number)}this.shadowLow=n,this.shadowHight=r,this.colorKey=l,this.contrast=s?1+s:1,this.brightness=o||0,this.brightContrastParas=[],this.hasColorMatrix=!1,this.colorMatrix=new Gs,this._pTransformMatrixAndBilevel=this.transformMatrixAndBilevel,this._pTransformFunc=this.transform_cpp,this._pInToleranceFunc=this.painter_inTolerance_noAlpha}},{key:"isEqual",value:function(e){return!!(e&&e.type===this.type&&this.type===Be.c.Duotone&&this.duotoneColor1&&e.duotoneColor1&&this.duotoneColor1.toString()===e.duotoneColor1.toString()&&this.duotoneColor2&&e.duotoneColor2&&this.duotoneColor2.toString()===e.duotoneColor2.toString())}},{key:"makeEffects",value:function(e){if(e)return this.prepare(),this.transformEffects(e)}},{key:"transformEffects",value:function(e){var t=e.length;this.ignoreColorKey||this.handleColorKey(e,t),this.handleColorMap(e,t),this._pTransformMatrixAndBilevel(e,t),this.handleShadowTransform(e,t)}},{key:"transformMatrixAndBilevel",value:function(e,t){this.transformMatrixAndBilevel_vml(e,t),this.handleBrightContrastTransfrom(e,t)}},{key:"transform",value:function(e,t){this._pTransformFunc(e,t)}},{key:"prepare",value:function(){if(this.effectMode!==e.VmlModel){var t=this.brightness;(t<-1||t>1)&&(console.warn("the brightness's value is out of range!"),t=this.qBound(-1,t,1));var i=this.contrast;i<0&&(console.warn("The contrast should not be less than 0!"),i=0),0!==t||1!==i?this.updateBrightContrastParas():this.brightContrastParas[0]=this.brightContrastParas[1]=256,this.hasColorMatrix||this.updateColorMatrix()}else this.prepare_vml()}},{key:"prepare_vml",value:function(){if(this.effectMode===e.VmlModel){var t=this.colorMatrix;if((this.brightness<-1||this.brightness>1)&&(console.warn("the brightness's value is out of range!"),this.brightness=this.qBound(-1,this.brightness,1)),this.contrast<0&&(console.warn("The contrast should not be less than 0!"),this.contrast=0),this.hasColorMatrix){var i=t.constData();this.colorMatrixInt=[[],[],[],[]];for(var n=0;n<4;n++)for(var r=0;r<4;r++)this.colorMatrixInt[n][r]=this.qRound(256*i[4*n+r])}else this.updateColorMatrix_vml();this.checkBound=this.hasDuotone||this.hasColorMatrix||0!==this.brightness||1!==this.contrast}}},{key:"updateColorMatrix_vml",value:function(){var e=this.colorMatrix;e.setToIdentity();var t=e.data(),i=new Gs;if(this.hasDuotone&&(i=this.createDuotoneMatrix(this.duotoneColor1,this.duotoneColor2,.299,.587,.114)),0!==this.brightness||1!==this.contrast){var n=this.contrast,r=this.brightness/2,a=0;a=n<1&&r>0?.15*(n-1):.5*(n-1)-r*(n-1);var o=this.brightness-a;this.hasBilevel?(t[0]=t[1]=t[2]=.299*n,t[4]=t[5]=t[6]=.587*n,t[8]=t[9]=t[10]=.114*n,t[12]=t[13]=t[14]=o):(t[0]=t[5]=t[10]=n,t[12]=t[13]=t[14]=o,this.hasDuotone&&(e=Gs.multiply(e,i)))}else this.hasBilevel?(t[0]=t[1]=t[2]=.299,t[4]=t[5]=t[6]=.587,t[8]=t[9]=t[10]=.114):this.hasDuotone&&(e=i);this.updateColorMatrixInt()}},{key:"updateBrightContrastParas",value:function(){var e=this.contrast,t=this.brightness/2,i=0;i=e<1&&t>0?.15*(e-1):.5*(e-1)-t*(e-1);var n=this.brightness-i;this.brightContrastParas[0]=Math.round(256*e),this.brightContrastParas[1]=Math.round(256*n)}},{key:"updateColorMatrix",value:function(){var e=this.colorMatrix;if(e.setToIdentity(),this.hasBilevel){var t=e.data();t[0]=t[1]=t[2]=.2157,t[4]=t[5]=t[6]=.7137,t[8]=t[9]=t[10]=.0706}else this.hasDuotone&&(this.colorMatrix=this.createDuotoneMatrix(this.duotoneColor1,this.duotoneColor2,.2157,.7137,.0706));this.updateColorMatrixInt()}},{key:"updateColorMatrixInt",value:function(){var e=Gs.multiply(this.colorMatrix,256).data();this.colorMatrixInt=[[],[],[],[]];for(var t=this.colorMatrixInt,i=0;i<4;i++)for(var n=0;n<e.length;n++)t[i][n]=Math.round(e[i][n])}},{key:"createDuotoneMatrix",value:function(e,t,i,n,r){var a=new Gs(i,n,r,0,i,n,r,0,i,n,r,0,0,0,0,1),o=e[0]/255,s=e[1]/255,l=e[2]/255,h=t[0]/255,u=t[1]/255,c=t[2]/255,d=new Gs(h-o,0,0,o,0,u-s,0,s,0,0,c-l,l,0,0,0,1);return Gs.multiply(d,a)}},{key:"handleShadowTransform",value:function(e,t){}},{key:"painter_shadowTransform",value:function(e,t,i,n){}},{key:"handleColorMap",value:function(e,t){}},{key:"handleColorKey",value:function(t,i){if(t&&this.hasColorKey)if(0===this.tolerance)if(this.effectMode===e.VmlModel)for(var n=0;n<i;n++)this.colorKey===t[n]&&(t[n]=0);else for(var r=0;r<i;r++)(16777215&this.colorKey)==(16777215&t[r])&&(t[r]=0);else for(var a=0;a<i;a++)this._pInToleranceFunc(t[a],this.colorKeyLow,this.colorKeyHight)&&(t[a]=0)}},{key:"painter_inTolerance_noAlpha",value:function(e,t,i){}},{key:"painter_setbilevel",value:function(e,t){}},{key:"transformMatrixAndBilevel_vml",value:function(e,t){this.colorMatrix.isIdentity()||this.transform(e,t),this.hasBilevel&&this.painter_setbilevel(e,t,this.bilevelThreshold)}},{key:"handleBrightContrastTransfrom",value:function(e,t){if(e){var i=this.brightness,n=this.contrast,r=this.brightContrastParas;if(0!==i||1!==n)if(i<-.99)for(var a=0;a<t;a+=4)e[a+2]=e[a+1]=e[a]=0;else if(i>.99)for(var o=0;o<t;o+=4)e[o+2]=e[o+1]=e[o]=e[o+3];else for(var s=0;s<t;s+=4){var l=e[s+2]*r[0]+e[s+3]*r[1]>>8,h=e[s+1]*r[0]+e[s+3]*r[1]>>8,u=e[s]*r[0]+e[s+3]*r[1]>>8;e[s+2]=this.qBound(0,l,e[s+3]),e[s+1]=this.qBound(0,h,e[s+3]),e[s]=this.qBound(0,u,e[s+3])}}}},{key:"transform_cpp",value:function(e,t){for(var i=0;i<t;)this._transform_cpp(e,i),i+=4}},{key:"_transform_cpp",value:function(e,t){var i=e,n=void 0,r=void 0,a=void 0,o=this.colorMatrixInt;if(this.hasColorMatrix||this.hasDuotone)n=i[t+2]*o[0][0]+i[t+1]*o[1][0]+i[t+0]*o[2][0]+i[t+3]*o[3][0]>>8,r=i[t+2]*o[0][1]+i[t+1]*o[1][1]+i[t+0]*o[2][1]+i[t+3]*o[3][1]>>8,a=i[t+2]*o[0][2]+i[t+1]*o[1][2]+i[t+0]*o[2][2]+i[t+3]*o[3][2]>>8;else{if(this.hasBilevel)return n=i[t+2]*o[0][0]+i[t+1]*o[1][0]+i[t+0]*o[2][0]+i[t+3]*o[3][0]>>8,void(i[t+2]=i[t+1]=i[t+0]=this.qBound(0,n,i[t+3]));n=i[t+2]*o[0][0]+i[t+3]*o[3][0]>>8,r=i[t+1]*o[1][1]+i[t+3]*o[3][1]>>8,a=i[t+0]*o[2][2]+i[t+3]*o[3][2]>>8}i[t+2]=this.qBound(0,a,i[t+3]),i[t+1]=this.qBound(0,r,i[t+3]),i[t+0]=this.qBound(0,n,i[t+3])}},{key:"qBound",value:function(e,t,i){return Math.max(e,Math.min(t,i))}},{key:"hasDuotone",get:function(){return this.type===Be.c.Duotone}}]),e}();Ys.DmlModel=0,Ys.VmlModel=1;var zs=function(){function e(t){r()(this,e),this.pts=[];for(var i=0,n=t.length;i<n;i++)for(var a=t[i],o=0,s=a.length;o<s;o++)this.pts.push(a[o].x(),a[o].y());var l=this.pts,h=l.slice(l.length-2);l[0]===h[0]&&l[1]===h[1]||this.pts.push(l[0],l[1])}return o()(e,[{key:"boundsRect",value:function(){if(!this.bounds){for(var e=this.pts,t=[e[0],e[1],e[0],e[1]],i=t[0],n=t[1],r=t[2],a=t[3],o=0;o<e.length;o+=2){var s=e[o],l=e[o+1];s<i&&(i=s),s>r&&(r=s),l<n&&(n=l),l>a&&(a=l)}this.bounds={l:i,t:n,r:r,b:a}}return this.bounds}},{key:"center",value:function(){var e=this.boundsRect();return{x:.5*(e.r+e.l),y:.5*(e.b+e.t)}}},{key:"toPath2D",value:function(){var e=this.pts,t=new Path2D;t.moveTo(e[0],e[1]);for(var i=2;i<this.pts.length;i+=2)t.lineTo(e[i],e[i+1]);return t.closePath(),t}}]),e}();function Ks(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)}function qs(e){return Math.abs(e)<.001}var Xs=function(){function e(){r()(this,e),this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}return o()(e,[{key:"scale",value:function(e,t,i,n){this.m11=e,this.m12=0,this.m21=0,this.m22=t,this.dx=i-e*i,this.dy=n-t*n}},{key:"map",value:function(e,t){return[this.m11*e+this.dx,this.m22*t+this.dy]}}]),e}(),Js=function(){function e(t,i,n,a){r()(this,e),this.path=t,this.focus=i,this.focusScale=n,this.gradientStops=a}return o()(e,[{key:"generateOutput",value:function(){var e=function(e){var t=Math.round(e.l),i=Math.round(e.r),n=Math.round(e.t);return{x:t,y:n,w:i-t,h:Math.round(e.b)-n}}(this.path.boundsRect()),t=Ns.b(e.w+2,e.h+2,Ns.a.WEBGL,"geomerty"),i=t.getElem();return i.width=e.w+2,i.height=e.h+2,{image:i,bounds:e,gl:this.drawGradient(i,e,t)}}},{key:"drawGradient",value:function(e,t,i){var n=i.getContext();if(!Object.isEmpty(n)){n.viewport(0,0,e.width,e.height);var r=this.prepareProgram(n),a=this.prepareVertices(n,r);this.prepareGradient(n);var o=this.prepareMatrix(t);return this.draw(n,o,r,a),n}console.error("Unable to initialize WebGL. Your browser or machine may not support it.")}},{key:"prepareProgram",value:function(e){var t=function(e,t,i){var n=Ks(e,e.VERTEX_SHADER,t),r=Ks(e,e.FRAGMENT_SHADER,i),a=e.createProgram();return e.attachShader(a,n),e.attachShader(a,r),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(a)),null)}(e,"\n            attribute vec4 aVertexPosition;\n            attribute float aVertexGradient;\n\n            uniform mat4 uModelViewMatrix;\n\n            varying lowp float vGradient;\n            \n            void main() {\n              gl_Position =  uModelViewMatrix * aVertexPosition;\n              vGradient = aVertexGradient;\n            }\n        ","\n            precision mediump float;\n            \n            varying lowp float vGradient;\n            \n            uniform sampler2D uGradientSampler;\n            \n            // const float a = -0.9041;\n            // const float b = 1.914;\n            // const float c = -0.003862;\n            //\n            // float interpolate(float v) {\n            //   return clamp(a*v*v + b*v + c, 0.0, 1.0);\n            // }\n            \n            void main() {\n              // float grad = interpolate(vGradient);\n              // gl_FragColor = vec4(grad, grad, grad, 1.0);\n              gl_FragColor = texture2D(uGradientSampler, vec2(vGradient, 0.5));\n            }\n        ");return{program:t,attribLocations:{vertexPosition:e.getAttribLocation(t,"aVertexPosition"),vertexGradient:e.getAttribLocation(t,"aVertexGradient")},uniformLocations:{modelViewMatrix:e.getUniformLocation(t,"uModelViewMatrix"),gradientSampler:e.getUniformLocation(t,"uGradientSampler")}}}},{key:"prepareVertices",value:function(e,t){for(var i=this.path.pts,n=this.path.boundsRect(),r=n.l+(n.r-n.l)*this.focus.x,a=n.t+(n.b-n.t)*this.focus.y,o=this.isFocusScaled()?0:1,s=[r,a,0],l=0;l<i.length;l+=2)s.push(i[l],i[l+1],o);var h=s.length/3,u=[{mode:e.TRIANGLE_FAN,first:0,count:h}];if(this.isFocusScaled()){var c=new Xs;c.scale(this.focusScale.width,this.focusScale.height,r,a);for(var d=0;d<i.length;d+=2){var p=i[d],f=i[d+1];s.push(p,f,1),s.push.apply(s,S()(c.map(p,f)).concat([0]))}u.push({mode:e.TRIANGLE_STRIP,first:h,count:s.length/3-h})}return this.setupVertexBuffer(e,s,t),u}},{key:"prepareGradient",value:function(e){var t,i,n,r=(t=512,i=1,(n=document.createElement("canvas")).width=t,n.height=i,n),a=r.getContext("2d"),o=a.createLinearGradient(0,0,r.width,0);this.gradientStops.forEach((function(e){o.addColorStop(e.pos,e.color)})),a.fillStyle=o,a.fillRect(0,0,r.width,r.height);var s=e.createTexture();return e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.activeTexture(e.TEXTURE0),s}},{key:"prepareMatrix",value:function(e){var t=-1/e.w,i=1/e.h,n=new Float32Array(16);return n[0]=-2*t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=(e.x+e.x+e.w)*t,n[13]=(e.y+e.y+e.h)*i,n[14]=0,n[15]=1,n}},{key:"setupVertexBuffer",value:function(e,t,i){var n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.vertexAttribPointer(i.attribLocations.vertexPosition,2,e.FLOAT,!1,12,0),e.enableVertexAttribArray(i.attribLocations.vertexPosition),e.vertexAttribPointer(i.attribLocations.vertexGradient,1,e.FLOAT,!1,12,8),e.enableVertexAttribArray(i.attribLocations.vertexGradient)}},{key:"isFocusScaled",value:function(){return this.focusScale&&(!qs(this.focusScale.width)||!qs(this.focusScale.height))}},{key:"draw",value:function(e,t,i,n){e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(i.program),e.uniformMatrix4fv(i.uniformLocations.modelViewMatrix,!1,t),n.forEach((function(t){e.drawArrays(t.mode,t.first,t.count)}))}}]),e}();function Zs(e,t,i,n){var r=new zs(i),a=e.left,o=e.right,s=e.bottom,l=e.top;return new Js(r,{x:a+0*o,y:l+0*s},{width:0,height:0},n).generateOutput()}var Qs=i(360),$s=function(e){function t(){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return u()(t,e),o()(t,[{key:"calNewRectBoundFromTileRect",value:function(e,t){if(!t||!e||!e.isQRect)return console.log("gradFill calNewRectBoundFromTileRect error!!",e,t),e;var i=e.width(),n=e.height(),r=e.topLeft(),a=e.bottomRight(),o=r.x()+i*t.left,s=r.y()+n*t.top,l=a.x()+i*-t.right,h=a.y()+n*-t.bottom,u=Math.abs(l-o),c=Math.abs(h-s);return u=u<1?1:u,c=c<1?1:c,new window.Rect(o,s,u,c)}},{key:"getIntersectPoint_m",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.isQRect)return console.log("gradFill getIntersectPoint_m error!!",e),e;i&&(t=180*(t=Math.atan(e.width()/e.height()*Math.tan(t*Math.PI/180)))/Math.PI);var n=Math.tan(t*Math.PI/180),r=e.topLeft().y()-n*e.topLeft().x(),a=-Math.tan((90-t)*Math.PI/180),o=e.bottomRight().y()-a*e.bottomRight().x(),s=(o-r)/(n-a),l=n*s+r;return new window.Point(s,l)}},{key:"getPointTransform",value:function(e,t,i,n){var r=t.center();if(i&&!n){var a=Math.abs(r.x()-e.x()),o=this.getFlipTransform(e.x(),r.x(),a);return new window.Point(o,e.y())}if(i&&n){var s=Math.abs(r.x()-e.x()),l=Math.abs(r.y()-e.y()),h=this.getFlipTransform(e.x(),r.x(),s),u=this.getFlipTransform(e.y(),r.y(),l);return new window.Point(h,u)}if(!i&&n){var c=Math.abs(r.y()-e.y()),d=this.getFlipTransform(e.y(),r.y(),c);return new window.Point(e.x(),d)}return e}},{key:"getFlipTransform",value:function(e,t,i){return e<t?t+i:t-i}},{key:"calcFocusInfo",value:function(e,t){var i=new window.Rect(t.left,t.top,Math.max(0,1-t.right-t.left),Math.max(0,1-t.bottom-t.top)),n=i.width(),r=i.height(),a=n,o=r,s=i.topLeft(),l=isNaN(1-n)?s.x()+.5*n:s.x()/(1-n),h=e.topLeft(),u=isNaN(1-r)?h.y()+.5*r:s.y()/(1-r),c=h.x()+l*e.width(),d=h.y()+u*e.height();return{focusCenter:new window.Point(c,d),scaleX:a,scaleY:o}}},{key:"convertColorStops",value:function(e){if(e instanceof Array||console.error("Wrong colorStops!"),!(e.length<2)){if(e.sort((function(e,t){var i=e.pos,n=t.pos;return i>n?1:i<n?-1:0})),Object(Qs.k)(e[0].pos)&&this.gradientStopEqual(e[0],e[1]))for(var t=1;t<e.length;t++)this.gradientStopEqual(e[t],e[0])&&e.shift();var i=e.length;if(1!==i){!Object(Qs.k)(e[i-1].pos,1)&&this.gradientStopEqual(e[i-1],e[i-2])&&(e[i-1].pos=1);for(var n=0;n<e.length;n++)for(var r=e[n],a=n+1;a<e.length;a++){var o=e[a];this.gradientStopEqual(r,o)&&e.splice(a,1)}this.headtailGradientManage(e),this.headmiddletailGradientManage(e)}}}},{key:"calcHeadtailGrandientColor",value:function(e,t,i){var n=-.9041*i*i+1.914*i-.003862,r=1-i,a=1-(-.9041*r*r+1.914*r-.003862);e=e.toString(),t=t.toString();var o=e.length,s=e.slice(5,o-1).split(","),l=Number(s[0],10)||0,h=Number(s[1],10)||0,u=Number(s[2],10)||0,c=Number(s[3],10)||0;c=Math.ceil(255*c)||0;var d=t.length,p=t.slice(5,d-1).split(","),f=Number(p[0],10)||0,g=Number(p[1],10)||0,y=Number(p[2],10)||0,v=Number(p[3],10)||0;v=Math.ceil(255*v);for(var m=[l,h,u],_=[f,g,y],w=0;w<3;++w){var S=m[w],x=_[w]-m[w],T=x>0?n:a;_[w]=Math.max(0,Math.min(S+x*T,255))||0}return"rgba("+Math.round(_[0])+","+Math.round(_[1])+","+Math.round(_[2])+","+Math.round(c+(v-c)*i)/255+")"}},{key:"headtailGradientManage",value:function(e){if(2===e.length&&0===e[0].pos&&1===e[e.length-1].pos){var t=e.shift(),i=e.pop();e.length=0,e.push(t),e.push({pos:.25,color:this.calcHeadtailGrandientColor(t.color,i.color,.25)}),e.push({pos:.5,color:this.calcHeadtailGrandientColor(t.color,i.color,.5)}),e.push({pos:.75,color:this.calcHeadtailGrandientColor(t.color,i.color,.75)}),e.push(i)}}},{key:"headmiddletailGradientManage",value:function(e){if(3===e.length&&0===e[0].pos&&1===e[e.length-1].pos&&e[0].color.toString()===e[e.length-1].color.toString()){var t=e[0],i=e[1],n=e[e.length-1],r=1-i.pos;e.length=0,e.push(t),e.push({pos:.334*i.pos,color:this.calcHeadtailGrandientColor(t.color,i.color,.334)}),e.push({pos:.667*i.pos,color:this.calcHeadtailGrandientColor(t.color,i.color,.667)}),e.push(i),e.push({pos:i.pos+.334*r,color:this.calcHeadtailGrandientColor(i.color,t.color,.334)}),e.push({pos:i.pos+.667*r,color:this.calcHeadtailGrandientColor(i.color,t.color,.667)}),e.push(n)}}},{key:"transformFillData",value:function(e,t){var i=this,n=e.stops;return e.linearAngle&&(e.linearAngle/=6e4),e.stops=n&&n.map((function(e){var n=e.color.hex,r=e.color.alpha,a=e.position;(!n||7!==n.length&&"#"!==n[0])&&console.error("fill Error Color！！！"+n);var o=parseInt(n.slice(1,3),16),s=parseInt(n.slice(3,5),16),l=parseInt(n.slice(5,7),16),h=r||0;return{color:n=i.fillShadowTransform([[o,s,l,h]],t)||"#000000",pos:a,alpha:r}})),e.cache=!0,e}},{key:"getAngle",value:function(e){return e<=90?e:e<=180?180-e:e<=270?e-180:360-e}},{key:"needConvertToPathGradient",value:function(e,t,i,n,r){var a=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y),s=Math.sqrt(a*a+o*o);return 0!==e||0!==t||s>r}},{key:"normalizeAngle",value:function(e){var t=Math.round(e)%360;return t<0&&(t+=360),t}},{key:"gradientStopEqual",value:function(e,t){return Object(Qs.l)(e.pos-t.pos)}}]),t}(Us);var el=function e(t,i,n,a,o){r()(this,e),this.shapeType=t,this.bDmlCircle=i,this.bDmlRectangle=n,this.bVmlCircle=a,this.bVmlRectangle=o},tl={Line:new el("Line",!1,!1,!1,!1),LineInv:new el("LineInv",!1,!1,!1,!1),Triangle:new el("Triangle",!1,!1,!1,!1),RtTriangle:new el("RtTriangle",!1,!1,!1,!1),Rect:new el("Rect",!1,!1,!1,!1),Diamond:new el("Diamond",!1,!1,!1,!1),Parallelogram:new el("Parallelogram",!1,!1,!1,!1),Trapezoid:new el("Trapezoid",!1,!1,!1,!1),NonIsoscelesTrapezoid:new el("NonIsoscelesTrapezoid",!1,!1,!1,!1),Pentagon:new el("Pentagon",!1,!1,!1,!1),Hexagon:new el("Hexagon",!1,!1,!1,!1),Heptagon:new el("Heptagon",!1,!1,!1,!1),Octagon:new el("Octagon",!1,!1,!1,!1),Decagon:new el("Decagon",!1,!1,!1,!1),Dodecagon:new el("Dodecagon",!1,!1,!1,!1),Star4:new el("Star4",!1,!1,!1,!1),Star5:new el("Star5",!1,!1,!1,!1),Star6:new el("Star6",!1,!1,!1,!1),Star7:new el("Star7",!1,!1,!1,!1),Star8:new el("Star8",!1,!1,!1,!1),Star10:new el("Star10",!1,!1,!1,!1),Star12:new el("Star12",!1,!1,!1,!1),Star16:new el("Star16",!1,!1,!1,!1),Star24:new el("Star24",!1,!1,!1,!1),Star32:new el("Star32",!1,!1,!1,!1),RoundRect:new el("RoundRect",!1,!1,!1,!1),Round1Rect:new el("Round1Rect",!1,!1,!1,!1),Round2SameRect:new el("Round2SameRect",!1,!1,!1,!1),Round2DiagRect:new el("Round2DiagRect",!1,!1,!1,!1),SnipRoundRect:new el("SnipRoundRect",!1,!1,!1,!1),Snip1Rect:new el("Snip1Rect",!1,!1,!1,!1),Snip2SameRect:new el("Snip2SameRect",!1,!1,!1,!1),Snip2DiagRect:new el("Snip2DiagRect",!1,!1,!1,!1),Plaque:new el("Plaque",!1,!1,!1,!1),Ellipse:new el("Ellipse",!1,!1,!1,!1),Teardrop:new el("Teardrop",!1,!1,!1,!1),HomePlate:new el("HomePlate",!1,!1,!1,!1),Chevron:new el("Chevron",!0,!1,!1,!0),PieWedge:new el("PieWedge",!1,!1,!1,!1),Pie:new el("Pie",!1,!1,!1,!1),BlockArc:new el("BlockArc",!0,!1,!1,!0),Donut:new el("Donut",!0,!1,!1,!0),NoSmoking:new el("NoSmoking",!0,!1,!1,!0),RightArrow:new el("RightArrow",!0,!1,!1,!0),LeftArrow:new el("LeftArrow",!0,!1,!1,!0),UpArrow:new el("UpArrow",!0,!1,!1,!0),DownArrow:new el("DownArrow",!0,!1,!1,!0),StripedRightArrow:new el("StripedRightArrow",!0,!1,!1,!0),NotchedRightArrow:new el("NotchedRightArrow",!0,!1,!1,!0),BentUpArrow:new el("BentUpArrow",!0,!1,!1,!0),LeftRightArrow:new el("LeftRightArrow",!0,!1,!1,!0),UpDownArrow:new el("UpDownArrow",!0,!1,!1,!0),LeftUpArrow:new el("LeftUpArrow",!0,!1,!1,!0),LeftRightUpArrow:new el("LeftRightUpArrow",!0,!1,!1,!0),QuadArrow:new el("QuadArrow",!0,!1,!1,!0),LeftArrowCallout:new el("LeftArrowCallout",!0,!1,!1,!0),RightArrowCallout:new el("RightArrowCallout",!0,!1,!1,!0),UpArrowCallout:new el("UpArrowCallout",!0,!1,!1,!0),DownArrowCallout:new el("DownArrowCallout",!0,!1,!1,!0),LeftRightArrowCallout:new el("LeftRightArrowCallout",!0,!1,!1,!0),UpDownArrowCallout:new el("UpDownArrowCallout",!0,!1,!1,!0),QuadArrowCallout:new el("QuadArrowCallout",!0,!1,!1,!0),BentArrow:new el("BentArrow",!0,!1,!1,!0),UTurnArrow:new el("UTurnArrow",!0,!1,!1,!0),CircularArrow:new el("CircularArrow",!0,!1,!1,!0),LeftCircularArrow:new el("LeftCircularArrow",!1,!1,!1,!1),LeftRightCircularArrow:new el("LeftRightCircularArrow",!1,!1,!1,!1),CurvedRightArrow:new el("CurvedRightArrow",!0,!1,!1,!0),CurvedLeftArrow:new el("CurvedLeftArrow",!0,!1,!1,!0),CurvedUpArrow:new el("CurvedUpArrow",!0,!1,!1,!0),CurvedDownArrow:new el("CurvedDownArrow",!0,!1,!1,!0),SwooshArrow:new el("SwooshArrow",!1,!1,!1,!0),Cube:new el("Cube",!1,!0,!1,!0),Can:new el("Can",!1,!1,!1,!1),LightningBolt:new el("LightningBolt",!0,!1,!1,!0),Heart:new el("Heart",!1,!1,!1,!1),Sun:new el("Sun",!0,!1,!1,!0),Moon:new el("Moon",!0,!1,!1,!0),SmileyFace:new el("SmileyFace",!0,!1,!0,!1),IrregularSeal1:new el("IrregularSeal1",!1,!1,!1,!1),IrregularSeal2:new el("IrregularSeal2",!1,!1,!1,!1),FoldedCorner:new el("FoldedCorner",!1,!1,!1,!1),Bevel:new el("Bevel",!1,!0,!1,!0),Frame:new el("Frame",!1,!1,!1,!1),HalfFrame:new el("HalfFrame",!1,!1,!1,!1),Corner:new el("Corner",!1,!1,!1,!1),DiagStripe:new el("DiagStripe",!1,!1,!1,!1),Chord:new el("Chord",!1,!1,!1,!1),Arc:new el("Arc",!1,!1,!1,!1),LeftBracket:new el("LeftBracket",!1,!1,!1,!1),RightBracket:new el("RightBracket",!1,!1,!1,!1),LeftBrace:new el("LeftBrace",!0,!1,!1,!0),RightBrace:new el("RightBrace",!0,!1,!1,!0),BracketPair:new el("BracketPair",!1,!1,!1,!1),BracePair:new el("BracePair",!0,!1,!1,!0),StraightConnector1:new el("StraightConnector1",!1,!1,!1,!1),BentConnector2:new el("BentConnector2",!1,!1,!1,!1),BentConnector3:new el("BentConnector3",!1,!1,!1,!1),BentConnector4:new el("BentConnector4",!1,!1,!1,!1),BentConnector5:new el("BentConnector5",!1,!1,!1,!1),CurvedConnector2:new el("CurvedConnector2",!1,!1,!1,!1),CurvedConnector3:new el("CurvedConnector3",!1,!1,!1,!1),CurvedConnector4:new el("CurvedConnector4",!1,!1,!1,!1),CurvedConnector5:new el("CurvedConnector5",!1,!1,!1,!1),Callout1:new el("Callout1",!1,!1,!1,!1),Callout2:new el("Callout2",!1,!1,!1,!1),Callout3:new el("Callout3",!1,!1,!1,!1),AccentCallout1:new el("AccentCallout1",!1,!1,!1,!1),AccentCallout2:new el("AccentCallout2",!1,!1,!1,!1),AccentCallout3:new el("AccentCallout3",!1,!1,!1,!1),BorderCallout1:new el("BorderCallout1",!1,!1,!1,!1),BorderCallout2:new el("BorderCallout2",!1,!1,!1,!1),BorderCallout3:new el("BorderCallout3",!1,!1,!1,!1),AccentBorderCallout1:new el("AccentBorderCallout1",!1,!1,!1,!1),AccentBorderCallout2:new el("AccentBorderCallout2",!1,!1,!1,!1),AccentBorderCallout3:new el("AccentBorderCallout3",!1,!1,!1,!1),WedgeRectCallout:new el("WedgeRectCallout",!0,!1,!1,!0),WedgeRoundRectCallout:new el("WedgeRoundRectCallout",!0,!1,!1,!0),WedgeEllipseCallout:new el("WedgeEllipseCallout",!0,!1,!1,!0),CloudCallout:new el("CloudCallout",!0,!1,!1,!0),Cloud:new el("Cloud",!1,!1,!1,!1),Ribbon:new el("Ribbon",!0,!1,!1,!0),Ribbon2:new el("Ribbon2",!0,!1,!1,!0),EllipseRibbon:new el("EllipseRibbon",!0,!1,!1,!0),EllipseRibbon2:new el("EllipseRibbon2",!0,!1,!1,!0),LeftRightRibbon:new el("LeftRightRibbon",!1,!1,!1,!1),VerticalScroll:new el("VerticalScroll",!0,!1,!1,!0),HorizontalScroll:new el("HorizontalScroll",!0,!1,!1,!0),Wave:new el("Wave",!0,!1,!1,!0),DoubleWave:new el("DoubleWave",!0,!1,!1,!0),Plus:new el("Plus",!1,!1,!1,!1),FlowChartProcess:new el("FlowChartProcess",!1,!1,!1,!1),FlowChartDecision:new el("FlowChartDecision",!1,!1,!1,!1),FlowChartInputOutput:new el("FlowChartInputOutput",!1,!1,!1,!1),FlowChartPredefinedProcess:new el("FlowChartPredefinedProcess",!1,!1,!1,!1),FlowChartInternalStorage:new el("FlowChartInternalStorage",!1,!1,!1,!1),FlowChartDocument:new el("FlowChartDocument",!0,!1,!1,!0),FlowChartMultidocument:new el("FlowChartMultidocument",!0,!1,!1,!0),FlowChartTerminator:new el("FlowChartTerminator",!1,!1,!1,!1),FlowChartPreparation:new el("FlowChartPreparation",!1,!1,!1,!1),FlowChartManualInput:new el("FlowChartManualInput",!1,!1,!1,!1),FlowChartManualOperation:new el("FlowChartManualOperation",!1,!1,!1,!1),FlowChartConnector:new el("FlowChartConnector",!1,!1,!1,!1),FlowChartPunchedCard:new el("FlowChartPunchedCard",!1,!1,!1,!1),FlowChartPunchedTape:new el("FlowChartPunchedTape",!0,!1,!1,!0),FlowChartSummingJunction:new el("FlowChartSummingJunction",!1,!1,!1,!1),FlowChartOr:new el("FlowChartOr",!1,!1,!1,!1),FlowChartCollate:new el("FlowChartCollate",!1,!1,!1,!1),FlowChartSort:new el("FlowChartSort",!1,!1,!1,!1),FlowChartExtract:new el("FlowChartExtract",!1,!1,!1,!1),FlowChartMerge:new el("FlowChartMerge",!1,!1,!1,!1),FlowChartOfflineStorage:new el("FlowChartOfflineStorage",!1,!1,!1,!1),FlowChartOnlineStorage:new el("FlowChartOnlineStorage",!1,!1,!1,!1),FlowChartMagneticTape:new el("FlowChartMagneticTape",!1,!1,!1,!0),FlowChartMagneticDisk:new el("FlowChartMagneticDisk",!0,!1,!1,!1),FlowChartMagneticDrum:new el("FlowChartMagneticDrum",!1,!1,!1,!0),FlowChartDisplay:new el("FlowChartDisplay",!0,!1,!1,!0),FlowChartDelay:new el("FlowChartDelay",!1,!1,!1,!1),FlowChartAlternateProcess:new el("FlowChartAlternateProcess",!1,!1,!1,!1),FlowChartOffpageConnector:new el("FlowChartOffpageConnector",!1,!1,!1,!1),ActionButtonBlank:new el("ActionButtonBlank",!1,!1,!1,!1),ActionButtonHome:new el("ActionButtonHome",!1,!0,!1,!0),ActionButtonHelp:new el("ActionButtonHelp",!1,!0,!1,!0),ActionButtonInformation:new el("ActionButtonInformation",!1,!0,!1,!0),ActionButtonForwardNext:new el("ActionButtonForwardNext",!1,!0,!1,!0),ActionButtonBackPrevious:new el("ActionButtonBackPrevious",!1,!0,!1,!0),ActionButtonEnd:new el("ActionButtonEnd",!1,!0,!1,!0),ActionButtonBeginning:new el("ActionButtonBeginning",!1,!0,!1,!0),ActionButtonReturn:new el("ActionButtonReturn",!1,!0,!1,!0),ActionButtonDocument:new el("ActionButtonDocument",!1,!0,!1,!0),ActionButtonSound:new el("ActionButtonSound",!1,!0,!1,!0),ActionButtonMovie:new el("ActionButtonMovie",!1,!0,!1,!0),Gear6:new el("Gear6",!1,!1,!1,!1),Gear9:new el("Gear9",!1,!1,!1,!1),Funnel:new el("Funnel",!1,!1,!1,!1),MathPlus:new el("MathPlus",!1,!1,!1,!1),MathMinus:new el("MathMinus",!1,!1,!1,!1),MathMultiply:new el("MathMultiply",!1,!1,!1,!1),MathDivide:new el("MathDivide",!0,!1,!1,!0),MathEqual:new el("MathEqual",!1,!1,!1,!1),MathNotEqual:new el("MathNotEqual",!0,!1,!1,!0),CornerTabs:new el("CornerTabs",!1,!1,!1,!1),SquareTabs:new el("SquareTabs",!1,!1,!1,!1),PlaqueTabs:new el("PlaqueTabs",!1,!1,!1,!1),ChartX:new el("ChartX",!1,!1,!1,!1),ChartStar:new el("ChartStar",!1,!1,!1,!1),ChartPlus:new el("ChartPlus",!1,!1,!1,!1)},il=function(e){function t(e){var i=e.rect,n=e.fill,a=e.shadowRangeIndex,o=e.path,s=e.shapeType;e.isAngleScalable;r()(this,t);var h=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return h.rect=i,h.fill=h.transformFillData(Object(us.d)(n),h.shadowRangeIndex),h.path=o,h.shadowRangeIndex=a,h.shapeType=s,h}return u()(t,e),o()(t,[{key:"render",value:function(e){if(!this.fill.stops)return!1;var t=this.rect,i=this.fill;this.ctx=e;var n=t.width,r=t.height,a=t.x,o=t.y,s=window.Rect,l=new s(0,0,n,r),h=void 0,u=void 0;e.isSvg?h=(u=new Vs.default(l.width()+3,l.height()+3)).canvas:u=(h=Fs(l.width()+3,l.height()+3).getElem()).getContext("2d");i.focusRectangle=i.focusRectangle||{left:.5,right:.5,top:.5,bottom:.5},this.convertColorStops(i.stops);var c=t.rotation||0,d=i.hasOwnProperty("rotateWithShape")&&!i.rotateWithShape,p=d?-c:0,f=new window.QMatrix;f.translate(t.width/2,t.height/2),f.rotate(p),f.translate(-t.width/2,-t.height/2);var g=f.mapRect(new s(a,o,n,r));l=new s(-g.x(),-g.y(),g.width(),g.height());var y=this._renderGradient(l);return!!y&&(d?(h.width=Math.ceil(g.width())||1,h.height=Math.ceil(g.height())||1,u.fillStyle=y,u.fillRect(0,0,2*h.width,2*h.height),e.fillGradinet=h):e.fillStyle=y,!0)}},{key:"_renderGradient",value:function(e){var t=this.fill,i=this.path,n=t.shadeType,r=i.painterPath||i.path,a=void 0,o=void 0,s=window.QPainterPath;switch(n){case Be.d.LinearShade:o=this.createLinearGradient(e,!1);break;case Be.d.CircleShade:o=this.createRadialGradient(e);break;case Be.d.ShapeShade:var l=function(e){if(!e)return new el("default",!0,!1,!1,!1);var t=e.slice(0,1).toLocaleUpperCase()+e.slice(1);return tl[t]}(this.shapeType);l.bDmlCircle?o=this.createRadialGradient(e):l.bDmlRectangle?((a=new s).addRect(e),o=this.createShapeGradient(e,a)):o=this.createShapeGradient(e,r);break;case Be.d.RectangleShade:(a=new s).addRect(e),o=this.createShapeGradient(e,a);break;default:o=this.createLinearGradient(e,!1)}return o}},{key:"createLinearGradient",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.fill,n=i.stops,r=i.tileRectangle,a=this.fill.linearAngle?this.fill.linearAngle:0,o=this.ctx;r&&(e=this.calNewRectBoundFromTileRect(e,r));var s=this.normalizeAngle(a),l=Math.floor(s/90),h=void 0;if((l<0||l>3)&&console.error("Angle Error!"),s%90==0){var u=[e.topLeft(),e.topRight(),e.bottomRight(),e.bottomLeft()];h=o.createLinearGradient(u[l].x(),u[l].y(),u[(l+1)%4].x(),u[(l+1)%4].y())}else{var c=this.getAngle(s),d=this.getIntersectPoint_m(e,c,t),p=1===l||2===l,f=2===l||3===l,g=this.getPointTransform(e.topLeft(),e,p,f),y=this.getPointTransform(d,e,p,f);h=o.createLinearGradient(g.x(),g.y(),y.x(),y.y())}return n.forEach((function(e){var t=e.color,i=e.pos;h.addColorStop(i,t)})),h}},{key:"createRadialGradient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=this.fill,n=i.tileRectangle,r=i.stops,a=i.focusRectangle,o=this.ctx,s=n,l=a;a=a||{left:.5,right:.5,top:.5,bottom:.5};var h=e;s&&(h=this.calNewRectBoundFromTileRect(e,s));var u=this.calcFocusInfo(e,l),c=u.focusCenter,d=u.scaleX,p=u.scaleY,f=h.center(),g=h.width(),y=h.height(),v=Math.sqrt(g*g+y*y)/2,m=d,_=void 0;if(this.needConvertToPathGradient(d,p,c,f,v)){var w=new window.QPainterPath;w.ellipse(f.x()*(1+d),f.y()*(1+p),v*(1+d),v*(1+p)),_=this.createShapeGradient(e,w)}else{if(t){var S=(c.x()-f.x())*Math.cos(t*Math.PI/180)-(c.y()-f.y())*Math.sin(t*Math.PI/180)+f.x(),x=(c.x()-f.x())*Math.sin(t*Math.PI/180)+(c.y()-f.y())*Math.cos(t*Math.PI/180)+f.y();c=new window.Point(S,x)}_=o.createRadialGradient(c.x(),c.y(),m,f.x(),f.y(),v),r.forEach((function(e){var t=e.color,i=e.pos;t=t||"#000000",_.addColorStop(i,t.toString())}))}return _}},{key:"createShapeGradient",value:function(e,t){var i=1,n=new window.QMatrix;if(t){var r=t.boundingRect();r.width()*r.height()>1e6&&(i=1e3/r.width(),n.scale(i,i),t=n.Map(t),e=new window.Rect(e.x(),e.y(),e.width()*i,e.height()*i))}var a=t&&t.toSubpathPolygons()||[],o=this.fill,s=(o.tileRectangle,o.stops),l=o.focusRectangle,h=this.ctx,u=Zs(l,0,a,s),c=document.createElement("canvas");c.width=e.width()+3,c.height=e.height()+3,c.getContext("2d").drawImage(u.image,u.bounds.x,u.bounds.y,u.image.width+2,u.image.height+2),u.image&&u.image._canvasPoolItem.release();var d=h.createPattern(c,"no-repeat");if(1!==i)if(h.isSvg)d.setTransform&&d.setTransform(n.inverted().toString());else if(window.DOMMatrix){var p=new DOMMatrix;p.setMatrixValue(n.inverted().toString()),d.setTransform&&d.setTransform(p)}return d}}]),t}($s),nl=window.imageEffectsPool=window.imageEffectsPool||new Hs.a(50),rl=function(e){function t(e){var i=e.rect,n=e.fill,a=e.shadowRangeIndex;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n=n||{};var s=i.width,h=i.height;return o.nRect=new window.Rect(0,0,s,h),o.frontColor=n.color&&n.color.rgba||"rgba(91,155,213,1)",o.backgroundColor=n.backgroundColor&&n.backgroundColor.rgba||"rgba(255,255,255,1)",o.patternType=n.pattern||55,o.shadowRangeIndex=a,o._init(),o}return u()(t,e),o()(t,[{key:"_init",value:function(){this.transformFillData()}},{key:"transformFillData",value:function(){var e=this.shadowRangeIndex,t=this.shadowRange;if(e>=0&&e<t.length){var i=this.frontColor.slice(5,this.frontColor.length-1).split(",").map(Number);this.frontColor=this.fillShadowTransform([i],e);var n=this.backgroundColor.slice(5,this.backgroundColor.length-1).split(",").map(Number);this.backgroundColor=this.fillShadowTransform([n],e)}}},{key:"render",value:function(e){var t=this.createImageData(),i=e.createPattern(t,"repeat");return e.fillStyle=i,!0}},{key:"createImageData",value:function(){var e=this.frontColor,t=this.backgroundColor,i=this.patternType;(!i||i<0||i>=al.length)&&(i=55,console.warn("Unkonwn PatternType "+i)),t||(t="red",console.warn("Unkonwn backgroundColor. use red"));var n=i+e+t,r=Fs(8,8).getElem();r.width=8,r.height=8;var a=r.getContext("2d");nl.get(n);for(var o=al[i].slice(0),s=a.createImageData(8,8),l=s.data,h="",u=o.length-4;u>=0;u-=4){var c=o[u].toString(2);if(c.length<8)c=Array.apply(null,Array(8-c.length)).map((function(){return 0})).toString().replace(/,/g,"")+c;h+=c}for(var d=(e=e.toString()).slice(5,e.length-1).split(",").map(Number),p=(t=t.toString()).slice(5,t.length-1).split(",").map(Number),f=0;f<l.length;f+=4){"0"===h[Math.floor(f/4)]?(l[f]=d[0],l[f+1]=d[1],l[f+2]=d[2],l[f+3]=255*d[3]):(l[f]=p[0],l[f+1]=p[1],l[f+2]=p[2],l[f+3]=255*p[3])}return a.putImageData(s,0,0),r}}]),t}(Us),al=[[255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0],[254,0,0,0,253,0,0,0,251,0,0,0,247,0,0,0,239,0,0,0,223,0,0,0,191,0,0,0,127,0,0,0],[127,0,0,0,191,0,0,0,223,0,0,0,239,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0],[126,0,0,0,189,0,0,0,219,0,0,0,231,0,0,0,231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,127,0,0,0],[255,0,0,0,247,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,127,0,0,0],[255,0,0,0,221,0,0,0,255,0,0,0,119,0,0,0,255,0,0,0,221,0,0,0,255,0,0,0,119,0,0,0],[221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0,221,0,0,0,119,0,0,0],[238,0,0,0,85,0,0,0,187,0,0,0,85,0,0,0,238,0,0,0,85,0,0,0,187,0,0,0,85,0,0,0],[234,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,174,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[170,0,0,0,68,0,0,0,170,0,0,0,17,0,0,0,170,0,0,0,68,0,0,0,170,0,0,0,17,0,0,0],[34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0,34,0,0,0,136,0,0,0],[0,0,0,0,34,0,0,0,0,0,0,0,136,0,0,0,0,0,0,0,34,0,0,0,0,0,0,0,136,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,16,0,0,0],[128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0,238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0],[119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0,119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0],[102,0,0,0,204,0,0,0,153,0,0,0,51,0,0,0,102,0,0,0,204,0,0,0,153,0,0,0,51,0,0,0],[102,0,0,0,51,0,0,0,153,0,0,0,204,0,0,0,102,0,0,0,51,0,0,0,153,0,0,0,204,0,0,0],[124,0,0,0,248,0,0,0,241,0,0,0,227,0,0,0,199,0,0,0,143,0,0,0,31,0,0,0,62,0,0,0],[62,0,0,0,31,0,0,0,143,0,0,0,199,0,0,0,227,0,0,0,241,0,0,0,248,0,0,0,124,0,0,0],[119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0],[170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0,170,0,0,0],[255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0],[51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0,51,0,0,0],[255,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0,255,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0],[255,0,0,0,255,0,0,0,238,0,0,0,221,0,0,0,187,0,0,0,119,0,0,0,255,0,0,0,255,0,0,0],[255,0,0,0,255,0,0,0,119,0,0,0,187,0,0,0,221,0,0,0,238,0,0,0,255,0,0,0,255,0,0,0],[255,0,0,0,255,0,0,0,255,0,0,0,240,0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,15,0,0,0],[247,0,0,0,247,0,0,0,247,0,0,0,247,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0],[251,0,0,0,223,0,0,0,254,0,0,0,239,0,0,0,253,0,0,0,191,0,0,0,247,0,0,0,127,0,0,0],[114,0,0,0,243,0,0,0,63,0,0,0,39,0,0,0,228,0,0,0,252,0,0,0,207,0,0,0,78,0,0,0],[231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0,231,0,0,0,219,0,0,0,189,0,0,0,126,0,0,0],[63,0,0,0,218,0,0,0,231,0,0,0,255,0,0,0,63,0,0,0,218,0,0,0,231,0,0,0,255,0,0,0],[126,0,0,0,189,0,0,0,219,0,0,0,231,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[247,0,0,0,247,0,0,0,247,0,0,0,0,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0],[174,0,0,0,221,0,0,0,235,0,0,0,119,0,0,0,186,0,0,0,221,0,0,0,171,0,0,0,119,0,0,0],[15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,170,0,0,0,85,0,0,0,170,0,0,0,85,0,0,0],[127,0,0,0,254,0,0,0,127,0,0,0,255,0,0,0,239,0,0,0,247,0,0,0,239,0,0,0,255,0,0,0],[255,0,0,0,127,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,127,0,0,0,255,0,0,0,85,0,0,0],[255,0,0,0,221,0,0,0,255,0,0,0,247,0,0,0,255,0,0,0,221,0,0,0,255,0,0,0,127,0,0,0],[254,0,0,0,254,0,0,0,253,0,0,0,243,0,0,0,207,0,0,0,183,0,0,0,123,0,0,0,252,0,0,0],[102,0,0,0,0,0,0,0,153,0,0,0,0,0,0,0,102,0,0,0,0,0,0,0,153,0,0,0,0,0,0,0],[7,0,0,0,7,0,0,0,103,0,0,0,136,0,0,0,112,0,0,0,112,0,0,0,118,0,0,0,136,0,0,0],[119,0,0,0,119,0,0,0,119,0,0,0,0,0,0,0,119,0,0,0,119,0,0,0,119,0,0,0,0,0,0,0],[102,0,0,0,153,0,0,0,153,0,0,0,102,0,0,0,102,0,0,0,153,0,0,0,153,0,0,0,102,0,0,0],[240,0,0,0,240,0,0,0,240,0,0,0,240,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0],[254,0,0,0,125,0,0,0,187,0,0,0,215,0,0,0,239,0,0,0,215,0,0,0,187,0,0,0,125,0,0,0],[255,0,0,0,239,0,0,0,199,0,0,0,131,0,0,0,1,0,0,0,131,0,0,0,199,0,0,0,239,0,0,0],[254,0,0,0,253,0,0,0,251,0,0,0,247,0,0,0,239,0,0,0,223,0,0,0,191,0,0,0,127,0,0,0],[127,0,0,0,191,0,0,0,223,0,0,0,239,0,0,0,247,0,0,0,251,0,0,0,253,0,0,0,254,0,0,0],[127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,127,0,0,0,0,0,0,0]],ol=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.ctx=t.ctx,this.fill=t.fill,this.path=t.pa||t.path,this.layout=t.layout||{},this.preloadSource=t.preloadSource||{},this.parentLayout=t.parentLayout||{},this.matrix=t.matrix}return o()(e,[{key:"render",value:function(e){var t=e||this.ctx,i=this.fill,n=this.path||this.pa,r=this.layout,a=this.matrix;if(!i)return!1;var o=n.attributes,s=n.pathCache,l={};i.rect?l=i.rect:r.drawRect&&(l=M(r.drawRect),r.fillOff||(l.x=0,l.y=0));var h=new window.Rect(l.x,l.y,l.width,l.height);if(r.paths&&(h=r.paths.srcBoundRect),i.originRect=h,i.matrix=a,o.hasOwnProperty("fill"))if(o.hasOwnProperty("fill")&&o.fill>Be.f.Normal){var u=o.fill-Be.f.Lighten;if(this.fillStyleSwitch(t,l,u,s))return!0}else o.hasOwnProperty("fill")&&(o.fill,Be.f.None);else if(this.fillStyleSwitch(t,l,-1,s))return!0;return!1}},{key:"fillStyleSwitch",value:function(e,t,i,n){var r=this.fill,a=this.preloadSource,o=this.layout,s=void 0;switch(r.type){case Be.e.FillTypeNone:return!1;case Be.e.FillTypeGradient:s=new il({rect:t,fill:r,shadowRangeIndex:i,path:this.path,shapeType:o.shapeType});break;case Be.e.FillTypePattern:s=new rl({rect:t,fill:r,shadowRangeIndex:i});break;case Be.e.FillTypeBlip:s=new js({rect:t,fill:r,shadowRangeIndex:i,preloadSource:a,scale:o.scale});break;case Be.e.FillTypeSolidColor:s=new Us;var l=r.color&&r.color.rgba||"rgba(255,255,255,1)";s.setFillColorRgba(l),s.setShadowRangeIndex(i);break;case Be.e.FillTypeBackground:(s=new Us).setShadowRangeIndex(i)}return!!s&&s.render(e)}}]),e}(),sl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.ctx=t.ctx,this.outline=t.outline,this.path=t.path,this.layout=t.layout,this.scale=t.scale}return o()(e,[{key:"render",value:function(e){var t=e||this.ctx,i=this.outline,n=this.path,r=this.layout,a=this.scale,o=i.fill||{},s={path:n.outLinePath,attributes:{}},l=i.width?window.Ti2Px(window.Emu2Ti(i.width),a):1;l=l<1?1:Math.round(l);var h=r.shapeRealyRect,u={drawRect:{width:h.width(),height:h.height(),x:-r.scale*r.offX,y:-r.scale*r.offY,fillOff:!0},offX:r.offX,offY:r.offY,scale:r.scale,fillOff:!0},c=o.shadeType;if(o.type===Be.e.FillTypeGradient&&c===Be.d.RectangleShade){var d=h.width()+l/2,p=h.height()+l/2;u.drawRect.width=d,u.drawRect.height=p}new ol({fill:o,path:s,layout:u}).render(t);var f=ll(i,a);t.strokeStyle=t.fillStyle,t.lineWidth=l;var g=f.dashCapStyle;!function(e,t){switch(t){case ue.LineCapFlat:e.lineCap="butt";break;case ue.LineCapRound:e.lineCap="round";break;case ue.LineCapSquare:e.lineCap="square";break;default:e.lineJoin="butt"}}(t,g),t.miterLimit=f.miterLimit,function(e,t){switch(t){case _e.LineJoinTypeMiter:e.lineJoin="miter";break;case _e.LineJoinTypeBevel:e.lineJoin="bevel";break;case _e.LineJoinTypeRound:e.lineJoin="round";break;default:e.lineJoin="miter"}}(t,f.joinStyle);var y=this.prepareDasher(f).map((function(e){return e*t.lineWidth}));return t.setLineDash(y),!0}},{key:"prepareDasher",value:function(e){var t=hl(e.dashType);if(e.dashType===we&&e.dashPattern&&(t=[].concat(S()(e.dashPattern))),e.dashCapStyle===ue.LineCapRound||e.dashCapStyle===ue.LineTriangleCap)for(var i=t.length,n=0;n!==i;)1&n?t[n]+=.99:t[n]-=.99,++n;return t}},{key:"measureOutLine",value:function(e,t,i,n,r){var a=e||this.path,o=t||this.outline,s=i||this.scale;return this.useComplexStroker(a,o,s,n,r)?this.complexStrokePath(a,o,s,r):this.simpleStrokePath(a)}},{key:"useComplexStroker",value:function(e,t,i,n,r){if(n)return!0;var a=ll(t,i);return 0!==a.compoundArray.length&&a.width>=2||(!(!a.startAnchor.isValid()&&!a.endAnchor.isValid())||(!!r||a.width>450))}},{key:"complexStrokePath",value:function(e,t,i,n){var r=e.attributes,a=ll(t,i),o=r.isClosePath||!1;if(o&&a.capStyle===ue.LineCapSquare&&(a.capStyle=ue.LineCapFlat,a.startCapStyle=ue.LineCapFlat,a.endCapStyle=ue.LineCapFlat,a.dashCapStyle=ue.LineCapFlat,a.startAnchor=new xs,a.endAnchor=new xs),!n||r.hasOwnProperty("stroke")&&!r.stroke||r.fill===Be.f.None||(a.alignment=me),!(e=e.painterPath)||e.elementCount()<2)return console.log(e+" is to Short cannot draw!"),{};e.isClosed=o;var s=new Is;return s.createStrokerFromPen(a),s.createStroke(e,1/4)}},{key:"simpleStrokePath",value:function(e){return e.painterPath}}]),e}();function ll(e,t){var i=e.width?window.Ti2Px(window.Emu2Ti(e.width),t):1;i=Math.round(i);var n=e.miterLimit||8,r=void 0!==e.joinType?e.joinType:_e.LineJoinTypeRound;if(e.joinType===_e.LineJoinTypeMiter){n*=.432432}var a=function(e){var t=[];switch(e){case ce:break;case ge:t.push.apply(t,[0,.1666666716337204,.3333333432674408,.6666666865348816,.8333333134651184,1]);break;case de:t.push.apply(t,[0,.3333333432674408,.6666666865348816,1]);break;case pe:t.push.apply(t,[0,.6000000238418579,.800000011920929,1]);break;case fe:t.push.apply(t,[0,.20000000298023224,.4000000059604645,1])}return t}(e.compoundLine),o=void 0!==e.endingCap?e.endingCap:ue.LineCapSquare,s=void 0!==e.endingCap?e.endingCap:ue.LineCapSquare,l=void 0!==e.endingCap?e.endingCap:ue.LineCapSquare,h=void 0!==e.endingCap?e.endingCap:ue.LineCapSquare,u=hl(e.dashType);u||(u=e.dashPattern),0!==u.length&&o===ue.LineCapSquare&&(o=ue.LineCapFlat,s=ue.LineCapFlat,l=ue.LineCapFlat,h=ue.LineCapFlat);var c=void 0===e.alignment?e.alignment:ye,d=ul(e.headEnd,i,t),p=ul(e.tailEnd,i,t);return d.isValid()&&(s=ue.LineCapFlat),p.isValid()&&(l=ue.LineCapFlat),{width:i,miterLimit:n,compoundArray:a,joinStyle:r,capStyle:o,startCapStyle:s,endCapStyle:l,dashCapStyle:h,scale:t,dashPattern:u,alignment:c,startAnchor:d,endAnchor:p,dashType:e.dashType}}function hl(e){var t=[[],[1,3],[4,3],[8,3],[4,3,1,3],[8,3,1,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];return e<we?t[e]:t[0]}function ul(e,t,i){if(!e)return new xs;var n=function(e){var t=[new window.Point(-.5,-1),new window.Point(0,-1),new window.Point(.5,-1),new window.Point(0,0),new window.Point(-.5,-1)],i=[new window.Point(-.5,-1),new window.Point(0,-.5),new window.Point(.5,-1),new window.Point(0,0),new window.Point(-.5,-1)],n=[new window.Point(-.5,0),new window.Point(0,-.5),new window.Point(.5,0),new window.Point(0,.5),new window.Point(-.5,0)],r=[new window.Point(-.5,-1),new window.Point(0,0),new window.Point(.5,-1)];if(e){var a=new window.QPainterPath;switch(e){case Se:break;case xe:a=cl(t);break;case Te:a=cl(i);break;case ke:a=cl(n);break;case Ce:a=function(e,t,i,n){var r=new window.QPainterPath;return r.ellipse(e,t,i/2,n/2),r}(0,0,1,1);break;case be:a=cl(r)}return a}}(e.type);if(!n||!n.isQPainterPath||n.isEmpty())return new xs;var r=e.type,a=Object.isEmpty(e.width)?Re:e.width,o=Object.isEmpty(e.length)?Ie:e.length,s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=[2,3,4.5],n=[2,3,5];return e===be?i[t]:n[t]}(r,o),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=[2.5,3.5,5],n=[2,3,5];return e===be?i[t]:n[t]}(r,a),h=l,u=s,c=40*i,d=t>1?t:1;if(d<c){var p=d/c;h/=p,u/=p}var f=new xs;r===be?(n=new window.QMatrix(h,0,0,u,0,0).Map(n),f=new xs(n,xs.AnchorPathUsage.PathStroke,ue.LineCapRound)):(n=new window.QMatrix(1,0,0,u/h,0,0).Map(n),(f=new xs(n,xs.AnchorPathUsage.PathFill,ue.LineCapRound)).setWidthScale(h),r===xe?s>=l?a===Pe&&o===Le?f.setBaseInset(.125*s):f.setBaseInset(.25*s):f.setBaseInset(.125*s):r===Te&&(a===Ee?f.setBaseInset(.25*s):a===Re?f.setBaseInset(.125*s):f.setBaseInset(.075*s)));return f.isValid()&&(f.setStrokeStartCap(ue.LineCapRound),f.setStrokeEndCap(ue.LineCapRound)),f}function cl(e){var t=new window.QPainterPath;t.moveTo(e[0]);for(var i=1,n=e.length;i<n;i++)t.lineTo(e[i]);return t}var dl=function(){function e(t){r()(this,e),this.m_cellBacks=[],this.m_rightBorders=[],this.m_bottomBorders=[],this.m_cellBorders=[],this.m_cellHypotenuse=[],this.m_leftBorder=null,this.m_topBorder=null}return o()(e,[{key:"addCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.getCellGridData(),n=i.m_startRow,r=i.m_endRow,a=i.m_startCol,o=i.m_endCol;if(0===n)for(var s=a;s<o;++s)this.m_topBorder=this.addCellTopBorder(this.m_topBorder,e,n,s);for(var l=a;l<o;++l)this.m_bottomBorders[r-1]=this.addCellBottomBorder(this.m_bottomBorders[r-1],e,r-1,l);if(0===a)for(var h=n;h<r;++h)this.m_leftBorder=this.addCellLeftBorder(this.m_leftBorder,e,h,a);for(var u=n;u<r;++u)this.m_rightBorders[o-1]=this.addCellRightBorder(this.m_rightBorders[o-1],e,u,o-1);this.addBackGroundFill(e),t||(this.addCellTLToBRBorder(null,e),this.addCellTRToBLBorder(null,e))}},{key:"addBackGroundFill",value:function(e){var t=e.getFill(),i=e.getCellGridData();if(t&&t.type!==Be.e.FillTypeNone){var n=new pl(e,t),r=e.rect();n.addFillPath(r,i.m_x,i.m_y),this.m_cellBacks.push(n)}}},{key:"addCellTopBorder",value:function(e,t,i,n){var r=Zo;return t.hasLine(r,i,n)&&(e&&this.sameOutLine(e,t,r,i,n)&&e.getColEnd()===n?this.updateHoriBorder(e,n+1):e=this.addBorder(t,r,i,n)),e}},{key:"addCellBottomBorder",value:function(e,t,i,n){var r=$o;return t.hasLine(r,i,n)&&(e&&this.sameOutLine(e,t,r,i,n)&&e.getColEnd()===n?this.updateHoriBorder(e,n+1):e=this.addBorder(t,r,i,n)),e}},{key:"addCellLeftBorder",value:function(e,t,i,n){var r=Jo;return t.hasLine(r,i,n)&&(e&&this.sameOutLine(e,t,r,i,n)&&e.getRowEnd()===i?this.updateVertBorder(e,i+1):e=this.addBorder(t,r,i,n)),e}},{key:"addCellRightBorder",value:function(e,t,i,n){var r=Qo;return t.hasLine(r,i,n)&&(e&&this.sameOutLine(e,t,r,i,n)&&e.getRowEnd()===i?this.updateVertBorder(e,i+1):e=this.addBorder(t,r,i,n)),e}},{key:"addCellTLToBRBorder",value:function(e,t){var i=es,n=t.getCellGridData(),r=n.m_startRow,a=n.m_startCol;t.hasLine(i,r,a)&&this.addBorder(t,i,r,a)}},{key:"addCellTRToBLBorder",value:function(e,t){var i=ts,n=t.getCellGridData(),r=n.m_startRow,a=n.m_startCol;t.hasLine(i,r,a)&&this.addBorder(t,i,r,a)}},{key:"addBorder",value:function(e,t,i,n){var r=new fl(e,i,n,t);return t===es||t===ts?this.m_cellHypotenuse.push(r):this.m_cellBorders.push(r),r}},{key:"updateHoriBorder",value:function(e,t){e.setColEnd(t)}},{key:"updateVertBorder",value:function(e,t){e.setRowEnd(t)}},{key:"sameOutLine",value:function(e,t,i,n,r){var a=t.line(i,n,r),o=e.getOutline();if(!a||!o)return!1;if(this._sameOutLine(a,o)){var s=a.fill||{},l=o.fill||{};if(s.type===Be.e.FillTypeSolidColor&&s.type===l.type){var h=s.color,u=l.color;if(h.rgba===u.rgba)return!0}}return!1}},{key:"_sameOutLine",value:function(e,t){if(e===t)return!0;if(e&&t)for(var i in e)if(e.hasOwnProperty(i)&&"object"!==I()(e[i])&&t[i]!==e[i])return!1;return!0}}]),e}(),pl=function(){function e(t,i){r()(this,e),this.m_pCell=t,this.m_fill=i,this.m_fillPath}return o()(e,[{key:"addFillPath",value:function(e,t,i){var n=new us.a,r=window.QPainterPath;n.hasStroke=!1;var a=new r;a.addRect(e);var o=new r,s=void 0;s=(this.m_pCell.isLastCol()&&this.m_pCell.isLastRow()||this.m_pCell.isLastCol()||this.m_pCell.isLastRow(),new window.Rect(0,0,e.width(),e.height())),this.m_fill&&this.m_fill.type===Be.e.FillTypePattern?(o.addRect(e),t=0,i=0):o.addRect(s),this.m_fillPaths={attributes:n,fillPath:a,path:o},this.addFillLayout(e,t,i)}},{key:"addFillLayout",value:function(e,t,i){var n={drawRect:{width:e.width(),height:e.height(),fillOff:!0,rotation:0},offX:Math.round(100*t)/100,offY:Math.round(100*i)/100,scale:1,fillOff:!0,shapeType:"rect",shapeRealyRect:new window.Rect(0,0,e.width(),e.height())};this.m_layout=n}}]),e}(),fl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new is,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xo;if(r()(this,e),this.m_part=a,this.m_pCell=t,this.m_rowBegin=i,this.m_colBegin=n,this.m_rowEnd=i+1,this.m_colEnd=n+1,this.m_part===es||this.m_part===ts){var o=t.getCellGridData();this.m_rowEnd=o.m_endRow,this.m_colEnd=o.m_endCol}this.m_part>=Jo&&this.m_part<=ts&&(this.m_outLineFetcher=t.line(this.m_part,i,n))}return o()(e,[{key:"getCellLayout",value:function(){void 0!==this.layoutHeight&&void 0!==this.layoutWidth&&void 0!==this.layoutX&&void 0!==this.layoutY||this.getPath();var e=this.layoutWidth,t=this.layoutHeight;return new window.Rect(this.layoutX-this.getOutlineWidth(),this.layoutY-this.getOutlineWidth(),e+3*this.getOutlineWidth()+2,t+3*this.getOutlineWidth()+2)}},{key:"getPath",value:function(){var e=new window.QPainterPath,t=this.getCell().getTableGraphic(),i=t.GetVertBorderPos(this.m_colBegin),n=t.GetVertBorderPos(this.m_colEnd),r=t.GetHoriBorderPos(this.m_rowBegin),a=t.GetHoriBorderPos(this.m_rowEnd);switch(this.m_part){case Jo:e.moveTo(i+0,r),e.lineTo(i+0,a),this.layoutWidth=0,this.layoutHeight=a-r,this.layoutX=i,this.layoutY=r;break;case Zo:e.moveTo(i,r+0),e.lineTo(n,r+0),this.layoutWidth=n-i,this.layoutHeight=0,this.layoutX=i,this.layoutY=r;break;case Qo:e.moveTo(n+0,r),e.lineTo(n+0,a),this.layoutWidth=0,this.layoutHeight=a-r,this.layoutX=n,this.layoutY=r;break;case $o:e.moveTo(i,a+0),e.lineTo(n,a+0),this.layoutWidth=n-i,this.layoutHeight=0,this.layoutX=i,this.layoutY=a;break;case es:e.moveTo(i,r),e.lineTo(n,a),this.layoutWidth=n-i,this.layoutHeight=a-r,this.layoutX=i,this.layoutY=r;break;case ts:e.moveTo(n,r),e.lineTo(i,a),this.layoutWidth=n-i,this.layoutHeight=a-r,this.layoutX=n,this.layoutY=r}var o=this.getOutline(),s={attributes:{},painterPath:e},l=o.fill||{};if(o&&l.type!==Be.e.FillTypeNone&&o.compoundLine){var h=new sl({path:s,outline:o,scale:this.getScale()}).measureOutLine();s.strokerPath=h}return s}},{key:"pathAttributes",value:function(){return{fillMode:Be.e.FillTypeNone,extrusionOk:!1}}},{key:"getScale",value:function(){return this.m_pCell.getTableGraphic().getScale()||1}},{key:"getOutline",value:function(){return this._outline||(this._outline=Object(us.d)(this.m_outLineFetcher)),this._outline}},{key:"getOutlineWidth",value:function(){var e=this.getScale(),t=(this.m_outLineFetcher&&this.m_outLineFetcher.width)/635*e;return t>0&&t<1?1:parseInt(t,10)}},{key:"getOutlineLayout",value:function(){var e=this.layoutWidth+this.getOutlineWidth(),t=this.layoutHeight+this.getOutlineWidth();return{drawRect:{width:e,height:t,x:0,y:0,fillOff:!0},shapeRealyRect:new window.Rect(0,0,e,t),offX:0,offY:0,scale:1,fillOff:!0}}},{key:"getRowEnd",value:function(){return this.m_rowEnd}},{key:"getColEnd",value:function(){return this.m_colEnd}},{key:"setRowEnd",value:function(e){this.m_rowEnd=e}},{key:"setColEnd",value:function(e){this.m_colEnd=e}},{key:"getCell",value:function(){return this.m_pCell}}]),e}(),gl=0,yl=1,vl=3,ml=4,_l=5,wl=6,Sl=7,xl=9,Tl=10,kl=11,Cl=27,bl=20,El=23,Rl=25,Pl=26,Il=39,Ll=55,Al=43,Bl=function(){function e(t){r()(this,e),this._context=null}return o()(e,[{key:"init",value:function(e){return this._context=e,this}},{key:"save",value:function(e){var t=this._context;return this.svgNode=t&&t.save(e),this}},{key:"initStroke",value:function(e){this._context&&(this._context.strokeStyle=this.getFillStyle(e,this.getOpacity()));return this}},{key:"drawLine0",value:function(e,t,i,n){if(this._context){var r=this._context;r.beginPath(),i<18&&(i=18);var a=[],o=i;if(null!=n)switch(n){case gl:break;case ml:i*=1.5;case yl:a.push({startPos:e,endPos:t});break;case vl:var s=1.5*-i;a.push({startPos:e,endPos:t}),(e=Object.assign({},e)).y+=s,(t=Object.assign({},t)).y+=s,a.push({startPos:e,endPos:t}),i/=2;break;case bl:i*=1.5;case _l:for(var l=e.x;l<t.x;){var h=l+i;h>t.x&&(h=t.x),a.push({startPos:{x:l,y:e.y},endPos:{x:h,y:t.y}}),l+=2*i}break;case wl:i/=1.5;break;case El:i*=1.5,o/=1.5;case Sl:for(var u=e.x;u<t.x;){var c=u+4*o;c>t.x&&(c=t.x),a.push({startPos:{x:u,y:e.y},endPos:{x:c,y:t.y}}),u+=6*o}break;case Rl:i*=1.5,o/=1.5;case xl:o*=2;for(var d=e.x;d<t.x;){var p=d+2*o;if(p>t.x&&(p=t.x),a.push({startPos:{x:d,y:e.y},endPos:{x:p,y:t.y}}),(d+=4*o)>t.x)break;(p=d+o)>t.x&&(p=t.x),a.push({startPos:{x:d,y:e.y},endPos:{x:p,y:t.y}}),d+=3*o}break;case Pl:i*=1.5,o/=1.5;case Tl:for(var f=e.x;f<t.x;){var g=f+o;g>t.x&&(g=t.x),a.push({startPos:{x:f,y:e.y},endPos:{x:g,y:t.y}}),f+=2*o}break;case Ll:i*=1.5,o/=1.5;case Il:for(var y=e.x;y<t.x;){var v=y+10*o;v>t.x&&(v=t.x),a.push({startPos:{x:y,y:e.y},endPos:{x:v,y:t.y}}),y+=15*o}break;case Cl:i*=1.5;case kl:i/=4;for(var m=2*o,_=e.x;_<t.x;){var w=_+m;if(w>t.x)break;if(a.push({startPos:{x:_,y:e.y-m},endPos:{x:w,y:t.y}}),(w=_+2*m)>t.x)break;a.push({startPos:{x:_+m,y:t.y},endPos:{x:_+2*m,y:t.y-m}}),_+=2*m}break;case Al:for(var S=1.5*o,x=-1.3*i,T=e.x;T<t.x;){var k=T+S;if(k>t.x)break;if(a.push({startPos:{x:T,y:e.y-S},endPos:{x:T+S,y:t.y}}),a.push({startPos:{x:T,y:e.y-S+x},endPos:{x:T+S,y:t.y+x}}),(k=T+2*S)>t.x)break;a.push({startPos:{x:T+S,y:t.y},endPos:{x:T+2*S,y:t.y-S}}),a.push({startPos:{x:T+S,y:t.y+x},endPos:{x:T+2*S,y:t.y+x-S}}),T+=2*S}i/=4;break;default:a.push({startPos:e,endPos:t})}i<15&&(i=15),r.lineWidth=i,a.forEach((function(e){var t=e.startPos,i=e.endPos;r.moveTo(Math.ceil(t.x),Math.ceil(t.y)),r.lineTo(Math.ceil(i.x),Math.ceil(i.y))})),r.stroke()}return this}},{key:"drawLine",value:function(e,t,i,n,r,a){if(this._context){var o=this._context;o.beginPath();var s=[],l=i;if(null!=r)switch(r){case gl:break;case ml:i*=1.5;case yl:s.push({startPos:e,endPos:t});break;case vl:var h=1.5*-i;s.push({startPos:e,endPos:t}),(e=Object.assign({},e)).y+=h,(t=Object.assign({},t)).y+=h,s.push({startPos:e,endPos:t}),i*=.85;break;case bl:i*=1.5;case _l:s.push({startPos:e,endPos:t}),o.setLineDash([i,i]);break;case wl:i/=1.5;break;case El:i*=1.5;case Sl:s.push({startPos:e,endPos:t}),o.setLineDash([3*l,2*l]);break;case Rl:i*=1.5;case xl:s.push({startPos:e,endPos:t}),o.setLineDash([3*l,2*l,l,2*l]);break;case Pl:i*=1.5;case Tl:s.push({startPos:e,endPos:t}),o.setLineDash([3*l,2*l,l,2*l,l,2*l]);break;case Ll:i*=1.5;case Il:s.push({startPos:e,endPos:t}),o.setLineDash([6*l,4*l]);break;case Cl:i*=1.5;case kl:for(var u=2*l,c=e.x;c<t.x;){var d=c+u;if(d>t.x)break;if(s.push({startPos:{x:c,y:e.y-u},endPos:{x:d,y:t.y}}),(d=c+2*u)>t.x)break;s.push({startPos:{x:c+u,y:t.y},endPos:{x:c+2*u,y:t.y-u}}),c+=2*u}i*=.65;break;case Al:for(var p=1.5*l,f=-1.5*i,g=e.x;g<t.x;){var y=g+p;if(y>t.x)break;if(s.push({startPos:{x:g,y:e.y-p},endPos:{x:g+p,y:t.y}}),s.push({startPos:{x:g,y:e.y-p+f},endPos:{x:g+p,y:t.y+f}}),(y=g+2*p)>t.x)break;s.push({startPos:{x:g+p,y:t.y},endPos:{x:g+2*p,y:t.y-p}}),s.push({startPos:{x:g+p,y:t.y+f},endPos:{x:g+2*p,y:t.y+f-p}}),g+=2*p}i*=.65;break;default:s.push({startPos:e,endPos:t})}r===yl||r===ml||r===vl?(o.lineWidth=Math.ceil(i),s.forEach((function(e){var t=e.startPos,r=e.endPos,s=void 0,l=void 0,h=void 0;if(a===C.TextDirectionType.Vertical||a===C.TextDirectionType.EastAsianVer?(s={x:t.x,y:t.y},l={x:t.x+i,y:t.y},h={x:r.x,y:r.y}):a===C.TextDirectionType.Vertical270||a===C.TextDirectionType.WordArtVer?(s={x:r.x,y:r.y},l={x:r.x+i,y:r.y},h={x:t.x,y:t.y}):a===C.TextDirectionType.VerticalWordArtRightToLeft?(s={x:t.x,y:t.y},l={x:t.x+i,y:t.y},h={x:r.x,y:r.y}):(s={x:t.x,y:t.y},l={x:r.x,y:r.y},h={x:t.x,y:t.y}),s.x>l.x||s.y>l.y){var u=l;l=s,s=u}var c=s.x,d=s.y,p=l.x-s.x,f=h.y-s.y,g=i/2;o.moveTo(c-g,d-g),o.lineTo(c+p+g,d-g),o.lineTo(c+p+g,d+f+g),o.lineTo(c-g,d+f+g),o.lineTo(c-g,d-g),o.fill(),n>0&&(o.lineWidth=n,o.stroke())}))):(o.lineWidth=n,s.forEach((function(e){var t=e.startPos,i=e.endPos;o.moveTo(t.x,t.y),o.lineTo(i.x,i.y)})),o.stroke())}return this}},{key:"strokeRect",value:function(e,t){if(this._context){var i=this._context;t>0&&(this.save(),i.lineWidth=t,i.strokeRect(e.x,e.y,e.width,e.height),this.restore())}return this}},{key:"initFill",value:function(e,t,i){if(this._context){var n=this._context,r=this.getFillStyle(e,this.getOpacity());r&&(n.fillStyle=r),t&&(n.font=t)}return this}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"getOpacity",value:function(){return this.opacity||1}},{key:"getFillStyle",value:function(e,t){var i=this._context,n=void 0;if(e){var r=e.color,a=e.backgroundColor,o=e.rgba;switch(e.type){case C.FillType.FillTypeNone:return"transparent";case C.FillType.FillTypeBackground:case C.FillType.FillTypeSolidColor:o=r&&r.rgba;break;case C.FillType.FillTypePattern:o=a&&a.rgba;break;case C.FillType.FillTypeGroup:case C.FillType.FillTypeBlip:break;case C.FillType.FillTypeGradient:var s=e.shadeType,l=void 0;return l=0===s?i.createLinearGradient(0,0,10,10):i.createRadialGradient(10,10,10,20,20,20),e.stops.forEach((function(e){l.addColorStop(e.position,e.color.rgba)})),l}n=o||r&&r.rgba||e}return n&&-1!==n.indexOf("rgba")&&(n=n.substring(0,n.lastIndexOf(","))+","+t+")"),n||"rgba(0,0,0,"+t+")"}},{key:"initFont",value:function(e){if(this._context){var t=this._context;e&&(t.font=e)}return this}},{key:"drawText",value:function(e,t,i){if(this._context){var n=this._context;i&&(n.textBaseline=i),n.fillText(t,e.x,e.y)}return this}},{key:"strokeText",value:function(e,t,i,n){if(this._context){var r=this._context;n&&(r.textBaseline=n),r.lineWidth=i,r.strokeText(t,e.x,e.y,e.width)}return this}},{key:"fillRect",value:function(e){this._context&&this._context.fillRect(e.x,e.y,e.width,e.height);return this}},{key:"initShadow",value:function(e){if(this._context){var t=this._context;t.shadowBlur=e.blur,t.shadowOffsetX=e.OffsetX,t.shadowOffsetY=e.OffsetY,t.shadowColor=e.color}return this}},{key:"transform",value:function(){if(this._context){var e=this._context;e.transform.apply(e,arguments)}return this}},{key:"translate",value:function(){if(this._context){var e=this._context;e.translate.apply(e,arguments)}return this}},{key:"scale",value:function(){if(this._context){var e=this._context;e.scale.apply(e,arguments)}return this}},{key:"rotate",value:function(){if(this._context){var e=this._context;e.rotate.apply(e,arguments)}return this}},{key:"restore",value:function(){var e=this._context;e&&e.restore()}},{key:"createSvgNodeByTag",value:function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return this.setSvgNodeAttrs(i,t),i}},{key:"setSvgNodeAttrs",value:function(e,t){for(var i in t){var n=t[i];null!=n&&e.setAttribute(i,n)}}},{key:"objToStyle",value:function(e){var t="";for(var i in e){var n=e[i];null!=n&&(t+="font-size"===i?i+":"+n+"px;":i+":"+n+";")}return t}}]),e}(),Dl=i(432),Ml=new function e(){r()(this,e),this.isFrontendMode="frontend"===localStorage.getItem("mode"),this.debug_Axis_Linewidth="true"===Object(Dl.default)("showAxis")?1:0,this.isLogOn="false"!==Object(Dl.default)("showLog")};Ml.isLogOn||(console.log=function(){});var Ol=Ml;function Nl(e,t){for(var i in t){var n=t[i];Object.isEmpty(n)||e.setAttribute(i,n)}}function Fl(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return console.error("has circle reference"),!1}}var Vl=4,Ul=5;function Gl(e){return e===Ul}function Hl(e){return e===Vl}function Wl(e){if(!e)return!0;if(e.type===Be.e.FillTypeNone)return!0;if(e.type===Be.e.FillTypeSolidColor)return 0===e.color.alpha;if(e.type===Be.e.FillTypeBlip){var t=1;return e.blip&&e.blip.effects&&e.blip.effects.forEach((function(e){e.type===Be.c.AlphaModulateFixed&&(t="number"==typeof e.amount?e.amount:1)})),0===t||(0===e.tileHorizontalRatio||0===e.tileVerticalRatio)}if(e.type===Be.e.FillTypeGradient){var i=[];e.stops.forEach((function(e){0===e.color.alpha?i.push(!0):i.push(!1)}));var n=!0;return i.forEach((function(e){e||(n=!1)})),n}}var jl=function(e){function t(e){var i=e.fill,n=e.lineRect,a=e.rotate,o=e.verticalType,s=e.isSvg,h=void 0===s||s;r()(this,t);var u=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.fill=i||{},u.lineRect=n,u.rotate=a||0,u.verticalType=o||6,u.shadeType=i.shadeType||0,u.focusRectangle=i.focusRectangle||{top:.5,left:.5,right:.5,bottom:.5},u.tileRectangle=i.tileRectangle,u.isSvg=h,u._init(),u}return u()(t,e),o()(t,[{key:"_init",value:function(){var e=this.fill.stops||[];this.stops=this._gradientFillDataTransform(e),this.convertColorStops(this.stops)}},{key:"render",value:function(e){var t=this._renderGradient(e);t&&(e.fillStyle=t)}},{key:"_renderGradient",value:function(e){var t=void 0;if(0===this.stops.length)return!1;switch(this.shadeType){case Be.d.LinearShade:t=this._createLinearGradient(e);break;case Be.d.CircleShade:t=this._createRadialGradient(e);break;case Be.d.ShapeShade:case Be.d.RectangleShade:t=this._createRectangleGradient(e)}return t}},{key:"_gradientFillDataTransform",value:function(e){return e=e.map((function(e){var t=e.color.hex,i=e.color.alpha,n=e.position;if(7!==t.length&&"#"!==t[0])return{color:t,pos:n,alpha:i};var r=parseInt(t.slice(1,3),16),a=parseInt(t.slice(3,5),16),o=parseInt(t.slice(5,7),16);return{color:t="rgba("+r+","+a+","+o+","+(i||0)+")",pos:n,alpha:i}}))}},{key:"_createLinearGradient",value:function(e){var t=this.lineRect,i=this.fill,n=i.linearAngle,r=i.isAngleScaled,a=void 0;n=n&&n/6e4||0;var o=0;!Hl(this.verticalType)||90!==n&&270!==n||(o=90);var s=n+this.rotate+o;s%=360;var l=new window.Point(0,t.height()/2),h=new window.Point(t.width()/2,t.height()/2);if(!Object.isEmpty(s)){var u=this._calcLinearGradientPoint(s,r),c=f()(u,2);l=c[0],h=c[1]}return this.isSvg?(a=e.createLinearGradient(l.x(),l.y(),h.x(),h.y()),this.stops.forEach((function(e){var t=e.pos,i=e.color;a.addColorStop(t,i)})),Gl(this.verticalType)?this._setSvgNodeAttrs(a.__root,{gradientTransform:"translate("+t.x()+","+t.y()+")rotate(-"+this.rotate+")rotate("+this.rotate+")translate("+-t.x()+","+-t.y()+")"}):Hl(this.verticalType)&&0!==o?this._setSvgNodeAttrs(a.__root,{gradientTransform:"translate("+t.x()+","+t.y()+")rotate(-"+o+")translate("+-t.x()+","+-t.y()+")"}):0!==this.rotate&&this._setSvgNodeAttrs(a.__root,{gradientTransform:"translate("+t.x()+","+t.y()+")rotate(-"+this.rotate+")translate("+-t.x()+","+-t.y()+")"})):(a=e.createLinearGradient(l.x(),l.y(),h.x(),h.y()),this.stops.forEach((function(e){var t=e.pos,i=e.color;a.addColorStop(t,i)}))),a}},{key:"_calcLinearGradientPoint",value:function(e,t){var i=this.lineRect,n=new window.Point,r=new window.Point,a=this.normalizeAngle(e),o=Math.floor(a/90);if(o<0||o>3)throw new Error("Angle Error!");if(a%90==0){var s=[i.topLeft(),i.topRight(),i.bottomRight(),i.bottomLeft()];n.setX(s[o].x()),n.setY(s[o].y()),r.setX(s[(o+1)%4].x()),r.setY(s[(o+1)%4].y())}else{var l=this.getAngle(a),h=new window.Rect(i.x(),i.y(),i.width(),i.height()),u=this.getIntersectPoint_m(h,l,t),c=1===o||2===o,d=2===o||3===o,p=this.getPointTransform(h.topLeft(),h,c,d),f=this.getPointTransform(u,h,c,d);n.setX(p.x()),n.setY(p.y()),r.setX(f.x()),r.setY(f.y())}return[n,r]}},{key:"_createRadialGradient",value:function(e){var t=new window.Rect(this.lineRect.x(),this.lineRect.y(),this.lineRect.width(),this.lineRect.height()),i=this.lineRect,n=this.tileRectangle,r=this.rotate;if(Hl(this.verticalType)&&(t=new window.Rect(i.x(),i.y()-i.height(),i.width(),i.height())),n)for(;r>0;){r-=90,n={bottom:n.right,left:n.bottom,right:n.top,top:n.left}}var a=this.calNewRectBoundFromTileRect(t,n),o=a.center(),s=Math.sqrt(a.width()*a.width()+a.height()*a.height())/2,l=void 0;return this.isSvg?(l=e.createRadialGradient(o.x(),o.y(),0,o.x(),o.y(),s),this.stops.forEach((function(e){var t=e.pos,i=e.color;l.addColorStop(t,i)})),Gl(this.verticalType)?this._setSvgNodeAttrs(l.__root,{gradientTransform:"translate("+i.x()+","+i.y()+")rotate("+-this.rotate+")rotate("+this.rotate+")translate("+-i.x()+","+-i.y()+")"}):0!==this.rotate&&this._setSvgNodeAttrs(l.__root,{gradientTransform:"translate("+i.x()+","+i.y()+")rotate("+-this.rotate+")translate("+-i.x()+","+-i.y()+")"})):(l=e.createRadialGradient(o.x(),o.y(),0,o.x(),o.y(),s),this.stops.forEach((function(e){var t=e.pos,i=e.color;l.addColorStop(t,i)}))),l}},{key:"_createRectangleGradient",value:function(e){if(this.isSvg){var t=2/this.lineRect.height(),i=new window.Rect(0,0,this.lineRect.width()*t,this.lineRect.height()*t),n=new window.QPainterPath;n.addRect(i);var r=n.toSubpathPolygons()||[],a=this.lineRect.width(),o=this._createShapeGradient(e,i,r),s=o.__root,l=a/parseInt(s.getAttribute("width"),10);return s.setAttribute("patternTransform","scale("+l+")"),o}var h=new window.Rect(this.lineRect.x(),this.lineRect.y(),this.lineRect.width(),this.lineRect.height()),u=new window.QPainterPath;u.addRect(h);var c=u.toSubpathPolygons()||[];return this._createShapeGradient(e,h,c)}},{key:"_createShapeGradient",value:function(e,t,i){var n=this.fill,r=(n.tileRectangle,Zs(n.focusRectangle,0,i,this.stops)),a=document.createElement("canvas");return a.width=t.width()+3,a.height=t.height()+3,a.getContext("2d").drawImage(r.image,r.bounds.x,r.bounds.y,r.image.width+2,r.image.height+2),e.createPattern(a,"no-repeat")}},{key:"_setSvgNodeAttrs",value:function(e,t){for(var i in t){var n=t[i];Object.isEmpty(n)||e.setAttribute(i,n)}}}]),t}($s),Yl=function(){function e(t){var i=t.lineRect,n=t.fill,a=t.shadowRangeIndex,o=void 0===a?-1:a,s=t.isSvg;r()(this,e),this.lineRect=i,this.fill=n,this.shadowRangeIndex=o,this.isSvg=s}return o()(e,[{key:"render",value:function(e){var t={x:this.lineRect.x(),y:this.lineRect.y(),width:this.lineRect.width(),height:this.lineRect.height()};new rl({rect:t,fill:this.fill,shadowRangeIndex:this.shadowRangeIndex}).render(e)}}]),e}(),zl=function(e){function t(e){var i=e.rect,n=e.fill,a=e.shadowRangeIndex,o=void 0===a?-1:a,s=e.preloadSource,h=e.scale,u=e.isSvg;r()(this,t);var c=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{rect:i,fill:n,shadowRangeIndex:o,preloadSource:s,scale:h}));return c.isSvg=u,c}return u()(t,e),o()(t,[{key:"render",value:function(e){if(e){this.ctx=e;var t=this.fill;if(!t.blip)return!1;var i=t.blip&&t.blip.blipAtom,n=i&&i.imageId;if(!this.preloadSource[n])return!1;var r=this.preloadSource[n];if(!r.width||!r.height)return!1;this.image=r;var a=new window.Rect(0,0,this.rect.width(),this.rect.height());t.hasOwnProperty("rotateWithShape")&&t.rotateWithShape,a.scale=1,this.nRect=a;var o=void 0;t.tileVerticalOffset||(t.tileVerticalOffset=t.tileHorizontalOffset);var s=this.transformFillData(t);if(t.isStretched)o=this.createStretchTexture(s);else{if(0===t.tileHorizontalRatio||0===t.tileVerticalRatio)return;o=this.createTileTexture(s)}if(delete e.fillGradinet,this.isSvg&&o){var l=this.rect.x(),h=this.rect.y(),u=new window.QMatrix;u.translate(l,h),o.setTransform(u)}e.fillStyle=o}}}]),t}(js),Kl=function(){function e(t){var i=t.fill;r()(this,e),this.fill=i}return o()(e,[{key:"render",value:function(e){var t=new Us;this.fill.color&&this.fill.color.rgba&&t.setFillColorRgba(this.fill.color.rgba),t.setShadowRangeIndex(-1),t.render(e)}}]),e}(),ql=function(){function e(t){var i=t.span,n=t.lineRect,a=t.scale,o=t.preloadSource,s=t.rotate,l=t.verticalType,h=t.isSvg,u=void 0===h||h,c=t.isOutLine,d=void 0!==c&&c;r()(this,e),this.lineRect=n,this.scale=a||.1,this.preloadSource=o||{},this.rotate=s||0,this.verticalType=l||6,this.isSvg=u,this.isOutLine=d,this.fill=i&&i.getGradientColor()||{},this.hasInnerShadow=i&&this._hasInnerShadow(i),this.span=i}return o()(e,[{key:"setParam",value:function(e){this.lineRect=e.lineRect,this.scale=e.scale||.1,this.preloadSource=e.preloadSource||{},this.rotate=e.rotate||0,this.verticalType=e.verticalType||6,this.isSvg=e.isSvg||!0,this.fill=e.span&&e.span.getGradientColor()||{}}},{key:"setFill",value:function(e){this.fill=e||{}}},{key:"render",value:function(e,t){if(this.setFieldId(t),Wl(this.fill))return this.isOutLine||(e.fillStyle="rgba(255,255,255,0)",t&&t.setAttribute("fill","rgba(255,255,255,0)")),void(this.fillStyle="rgba(255,255,255,0)");this.fillStyleSwitch(e),this.fillStyle=e.fillStyle,this._setStyle(this.isOutLine,this.fillStyle,t)}},{key:"setFieldId",value:function(e){var t=this.span.getStyle();e&&t&&!Object.isEmpty(t.fieldType)&&(e.id="fieldText")}},{key:"fillStyleSwitch",value:function(e){var t=void 0,i=this.fill,n=this.preloadSource,r=this.scale,a=this.isSvg;switch(this.fill.type){case Be.e.FillTypeNone:return void(e.fillStyle="rgba(255, 255, 255, 0)");case Be.e.FillTypeGradient:t=new jl({fill:i,lineRect:this.lineRect,rotate:this.rotate,verticalType:this.verticalType,isSvg:this.isSvg});break;case Be.e.FillTypePattern:t=new Yl({lineRect:this.lineRect,fill:i,isSvg:a});break;case Be.e.FillTypeBlip:t=new zl({rect:this.lineRect,fill:i,shadowRangeIndex:-1,preloadSource:n,scale:r,isSvg:a});break;case Be.e.FillTypeSolidColor:case Be.e.FillTypeBackground:t=new Kl({fill:i});break;default:return void(this.fill&&this.fill.rgba&&(e.fillStyle=this.fill.rgba))}t.render(e)}},{key:"_setStyle",value:function(e,t,i){if(this.isSvg&&t&&i){var n=e?"stroke":"fill";if(this.hasInnerShadow)return void i.setAttribute(n,"rgba(255, 255, 255, 0)");if(t.__root?i.setAttribute(n,"url(#"+t.__root.id+")"):i.setAttribute(n,t),this.fill.type===Be.e.FillTypeBlip){var r=1;this.fill.blip&&this.fill.blip.effects&&this.fill.blip.effects.forEach((function(e){e.type===Be.c.AlphaModulateFixed&&(r="number"==typeof e.amount?e.amount:1)})),i.setAttribute("fill-opacity",r)}}}},{key:"getStyle",value:function(){return this.fillStyle&&this.fillStyle.__root?"url(#"+this.fillStyle.__root.id+")":this.fillStyle||""}},{key:"_hasInnerShadow",value:function(e){var t=e.getArtTextEffectList&&e.getArtTextEffectList();return!!(t&&t).innerShadow}}]),e}(),Xl=function(){function e(t,i,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];r()(this,e),this.lineRect=n,this.span=t,this.isSvg=a,this.scale=i||.1,this._init(t)}return o()(e,[{key:"_init",value:function(e){var t=e.artTextOutLineFill();this.artTextOutLineFill=t,this.outLineFill=t.fill||"rgba(255, 255, 255, 0)",this.dashType=t.dashType||0;var i=t.width&&window.Emu2Ti(t.width)*window.ti2pxRatio;this.outlineWidth=i<1?1:Math.round(i);var n=e.getGradientColor(),r=n&&n.fill;this.fillType=r&&r.type||0,this.hasInnerShadow=this._hasInnerShadow(e)}},{key:"hasOutLine",value:function(){return this.outLineFill&&this.outLineFill.type&&0!==this.outLineFill.type}},{key:"render",value:function(e,t){return!this.hasOutLine()||this.hasInnerShadow&&this.isSvg?"rgba(255,255,255,0)":(this.style=this._getOutLineStyle(t),this.style)}},{key:"_getOutLineStyle",value:function(e){if(this.isSvg){var t=new Vs.default(1,1),i=new ql({span:this.span,lineRect:this.lineRect,scale:this.scale,isOutLine:!0});i.setFill(this.outLineFill),i.render(t,e);var n=i.getStyle();if(!n)return"rgba(255,255,255,0)";var r=this._getDashStr();return this._setStrokeStyle(e,n,r),t.__defs&&t.__defs.childElementCount>0&&t.__defs.children.forEach((function(e){window.domTools.addSvgDefs(e)})),n}var a=Fs(1,1),o=a.getContext(),s=new ql({span:this.span,lineRect:this.lineRect,scale:this.scale,isSvg:this.isSvg,isOutLine:!0});s.setFill(this.outLineFill),s.render(o);var l=s.getStyle();return a.release(),l}},{key:"getDashArr",value:function(){var e=this;return hl(this.dashType).map((function(t){return t*e.outlineWidth}))}},{key:"_getDashStr",value:function(){return this.getDashArr().join(" ")}},{key:"_setStrokeStyle",value:function(e,t,i){e&&(Nl(e,{stroke:t,"stroke-width":this.outlineWidth,"stroke-dasharray":i}),this._setLineJoinType(e))}},{key:"_setLineJoinType",value:function(e){var t=void 0;switch(this.artTextOutLineFill.joinType){case _e.LineJoinTypeMiter:t="miter";break;case _e.LineJoinTypeBevel:t="bevel";break;case _e.LineJoinTypeRound:default:t="round"}Nl(e,{"stroke-linejoin":t})}},{key:"getLineWidth",value:function(){return this.hasOutLine()&&this.outlineWidth||0}},{key:"getStyle",value:function(){return this.style&&this.style.__root?"url(#"+this.style.__root.id+")":this.style||""}},{key:"_hasInnerShadow",value:function(e){var t=e.getArtTextEffectList&&e.getArtTextEffectList();return!!(t&&t).innerShadow}}]),e}(),Jl=function(){function e(t,i,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r()(this,e),this.textNode=i,this.glyph=t,this.scale=n,this.preloadSource=a,this.span=t.getParent()}return o()(e,[{key:"init",value:function(e){var t=e.lineRect,i=e.textRect,n=e.rotate,r=void 0===n?0:n,a=e.verticalType,o=void 0===a?6:a;this.lineRect=t,this.textRect=i,this.rotate=r,this.verticalType=o}},{key:"render",value:function(e,t){this._renderFill(e),this._renderOutLine(e),Nl(this.textNode,{x:this.textRect.x(),y:this.textRect.y()}),t.appendChild(this.textNode)}},{key:"_renderFill",value:function(e){var t=this.span,i=this.scale,n=this.lineRect,r=this.textRect,a=this.preloadSource;new ql({span:t,lineRect:n,textRect:r,scale:i,preloadSource:a}).render(e,this.textNode)}},{key:"_renderOutLine",value:function(e){var t=this.span,i=this.scale,n=this.lineRect,r=this.textRect;new Xl(t,i,n,r).render(e,this.textNode)}}]),e}(),Zl=0,Ql=1,$l=2,eh=3,th=4,ih=5,nh=6,rh=7,ah=8,oh=0,sh=1,lh=2,hh=3,uh=4,ch=5,dh=6,ph=7,fh=8,gh=9,yh=10,vh=11,mh=12,_h=13,wh=14,Sh=15,xh=16,Th=17,kh=18,Ch=19,bh=i(724),Eh=function(){function e(){r()(this,e),this.m_dist=0,this.m_dir=0,this.m_sx=1,this.m_sy=1,this.m_kx=0,this.m_ky=0,this.m_alignment=rh}return o()(e,[{key:"setEffectPathList",value:function(e){this.effectPathList=e}},{key:"getEffectPathList",value:function(){return this.effectPathList}},{key:"calcTransform",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0,o=0;switch(this.m_alignment){case Zl:break;case Ql:a=.5;break;case $l:a=1;break;case eh:o=.5;break;case th:a=o=.5;break;case ih:a=1,o=.5;break;case nh:o=1;break;case rh:a=.5,o=1;break;case ah:a=o=1}var s=e(this.m_dist),l=t.width()*a+n,h=t.height()*o+r,u=s*Math.cos(Rh(this.m_dir)),c=s*Math.sin(Rh(this.m_dir)),d=Math.tan(Rh(this.m_kx));Ph(this.m_sx)||(d/=this.m_sx);var p=Math.tan(Rh(this.m_ky));Ph(this.m_sy)||(p/=this.m_sy);var f=l+u,g=h+c,y=-l,v=-h;if(f+=y*this.m_sx+v*d*this.m_sx,g+=v*this.m_sy+y*p*this.m_sy,!i){var m=new window.QMatrix(this.m_sx,p*this.m_sy,d*this.m_sx,this.m_sy,f,g),_=m.mapRect(t),w=this.getEffectPathList();return w instanceof Array&&0!==w.length&&(_=this.calcTransfromPath(w,m)),_}i.transform(this.m_sx,p*this.m_sy,d*this.m_sx,this.m_sy,f,g)}},{key:"calcTransfromPath",value:function(e,t){for(var i={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},n=0,r=e.length;n<r;n++){var a=e[n];if(a){for(var o=new window.Point,s={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},l=0,h=a.length;l<h;l++){var u=a[l];switch(u.type){case bh.d.MoveTo:case bh.d.LineTo:o=t.map_point(new window.Point(u.x,u.y)),this.updateBoundsFromPt(s,o);break;case bh.d.ArcTo:console.error(u+" can ArcTo FIXME");break;case bh.d.Close:}}s.l<i.l&&(i.l=s.l),s.r>i.r&&(i.r=s.r),s.t<i.t&&(i.t=s.t),s.b>i.b&&(i.b=s.b)}}return i.width=i.r-i.l,i.height=i.b-i.t,new window.Rect(i.l,i.t,i.width,i.height)}},{key:"updateBoundsFromPt",value:function(e,t){e.l>t.x()&&(e.l=t.x()),e.r<t.x()&&(e.r=t.x()),e.t>t.y()&&(e.t=t.y()),e.b<t.y()&&(e.b=t.y()),e.width=e.r-e.l,e.height=e.b-e.t}},{key:"calcAabb",value:function(){}}]),e}();function Rh(e){return e*Math.PI/180}function Ph(e){return Math.abs(e)<=1e-12}var Ih=function(){function e(t,i){r()(this,e),this._init(),this.imageData=t,this.width=t.width,this.height=t.height,this.radius=i}return o()(e,[{key:"_init",value:function(){this.defaults={radius:1,mul_table:[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table:[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]}}},{key:"render",value:function(){var e=this.radius||this.defaults.radius,t=this.width||this.defaults.width,i=this.height||this.defaults.height,n=this.imageData;if(isNaN(e)||e<1)return this.imageData;e|=0;var r=n.data,a=void 0,o=void 0,s=void 0,l=void 0,h=void 0,u=void 0,c=void 0,d=void 0,p=void 0,f=void 0,g=void 0,y=void 0,v=void 0,m=void 0,_=void 0,w=void 0,S=void 0,x=void 0,T=void 0,k=void 0,C=void 0,b=void 0,E=void 0,R=void 0,P=e+e+1,I=t-1,L=i-1,A=e+1,B=A*(A+1)/2,D=this.BlurStack(),M=D,O=void 0;for(s=1;s<P;s++)M=M.next=this.BlurStack(),s===A&&(O=M);M.next=D;var N=null,F=null;c=u=0;var V=this.defaults.mul_table[e],U=this.defaults.shg_table[e];for(o=0;o<i;o++){for(w=S=x=T=d=p=f=g=0,y=A*(k=r[u]),v=A*(C=r[u+1]),m=A*(b=r[u+2]),_=A*(E=r[u+3]),d+=B*k,p+=B*C,f+=B*b,g+=B*E,M=D,s=0;s<A;s++)M.r=k,M.g=C,M.b=b,M.a=E,M=M.next;for(s=1;s<A;s++)l=u+((I<s?I:s)<<2),d+=(M.r=k=r[l])*(R=A-s),p+=(M.g=C=r[l+1])*R,f+=(M.b=b=r[l+2])*R,g+=(M.a=E=r[l+3])*R,w+=k,S+=C,x+=b,T+=E,M=M.next;for(N=D,F=O,a=0;a<t;a++)r[u+3]=E=g*V>>U,0!==E?(E=255/E,r[u]=(d*V>>U)*E,r[u+1]=(p*V>>U)*E,r[u+2]=(f*V>>U)*E):r[u]=r[u+1]=r[u+2]=0,d-=y,p-=v,f-=m,g-=_,y-=N.r,v-=N.g,m-=N.b,_-=N.a,l=c+((l=a+e+1)<I?l:I)<<2,d+=w+=N.r=r[l],p+=S+=N.g=r[l+1],f+=x+=N.b=r[l+2],g+=T+=N.a=r[l+3],N=N.next,y+=k=F.r,v+=C=F.g,m+=b=F.b,_+=E=F.a,w-=k,S-=C,x-=b,T-=E,F=F.next,u+=4;c+=t}for(a=0;a<t;a++){for(S=x=T=w=p=f=g=d=0,y=A*(k=r[u=a<<2]),v=A*(C=r[u+1]),m=A*(b=r[u+2]),_=A*(E=r[u+3]),d+=B*k,p+=B*C,f+=B*b,g+=B*E,M=D,s=0;s<A;s++)M.r=k,M.g=C,M.b=b,M.a=E,M=M.next;for(h=t,s=1;s<=e;s++)u=h+a<<2,d+=(M.r=k=r[u])*(R=A-s),p+=(M.g=C=r[u+1])*R,f+=(M.b=b=r[u+2])*R,g+=(M.a=E=r[u+3])*R,w+=k,S+=C,x+=b,T+=E,M=M.next,s<L&&(h+=t);for(u=a,N=D,F=O,o=0;o<i;o++)r[(l=u<<2)+3]=E=g*V>>U,E>0?(E=255/E,r[l]=(d*V>>U)*E,r[l+1]=(p*V>>U)*E,r[l+2]=(f*V>>U)*E):r[l]=r[l+1]=r[l+2]=0,d-=y,p-=v,f-=m,g-=_,y-=N.r,v-=N.g,m-=N.b,_-=N.a,l=a+((l=o+A)<L?l:L)*t<<2,d+=w+=N.r=r[l],p+=S+=N.g=r[l+1],f+=x+=N.b=r[l+2],g+=T+=N.a=r[l+3],N=N.next,y+=k=F.r,v+=C=F.g,m+=b=F.b,_+=E=F.a,w-=k,S-=C,x-=b,T-=E,F=F.next,u+=t}return n}},{key:"BlurStack",value:function(){return{r:0,g:0,b:0,a:0,next:null}}}]),e}(),Lh=function(){function e(t,i,n,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];r()(this,e),this.ltd=a,this._init(t),this.transform=this.createEffectTransform(),this.lineWidth=0,this.pathList=n,this.boundRect=i,this.horizontalFlipped=o,this.verticalFlipped=s,this.shadowRect=new window.Rect(i.x(),i.y(),i.width(),i.height()),this.offX=i.x(),this.offY=i.y()}return o()(e,[{key:"_init",value:function(e){this.shadow=e,e.type===Be.c.PresetShadow?this._initPresetShadow(e):this._initOuterShadow(e)}},{key:"_initPresetShadow",value:function(e){this.blurRadius=0,this.distance=window.Emu2Ti(e.distance)||0,this.skewX=0,this.skewY=0,this.scaleY=1,this.scaleX=1,this.direction=e.direction*(1/6e4)||0,this.color=e.color,this.rotateWithShape=!1,this._initPresetType(e)}},{key:"_initOuterShadow",value:function(e){this.blurRadius=window.Emu2Ti(e.blurRadius)*this.ltd*.5||0,this.distance=window.Emu2Ti(e.distance)||0,this.skewX=e.skewX*(1/6e4)||0,this.skewY=e.skewY*(1/6e4)||0,this.scaleY=void 0!==e.scaleY?e.scaleY:1,this.scaleX=void 0!==e.scaleX?e.scaleX:1,this.direction=e.direction*(1/6e4)||0,this.alignment=e.alignment,this.color=e.color,this.rotateWithShape=void 0===e.rotateWithShape||e.rotateWithShape}},{key:"createEffectTransform",value:function(){var e=new Eh;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e.m_sx=this.getScaleX(),e.m_sy=this.getScaleY(),e.m_kx=this.getSkewX(),e.m_ky=this.getSkewY(),e.m_alignment=this.getAlignment(),e}},{key:"measure",value:function(){var e=this;this.transform.setEffectPathList(this.pathList);var t=this.transform.calcTransform((function(t){return t*e.ltd}),this.shadowRect,null,this.offX,this.offY),i=1.5*this.blurRadius;if(this.blurRadius<=10&&this.blurRadius>3?i*=2:this.blurRadius<=3&&(i*=5),t=t.adjust(-i,-i,i,i),this._hasOuterShadow2()){this._setupShadow2();var n=this.transform.calcTransform((function(t){return t*e.ltd}),this.shadowRect,null,this.offX,this.offY);n=n.adjust(-i,-i,i,i);var r=t.left()<n.left()?t.left():n.left(),a=t.right()>n.right()?t.right():n.right(),o=t.top()<n.top()?t.top():n.top(),s=t.bottom()>n.bottom()?t.bottom():n.bottom();t=new window.Rect(r,o,a-r,s-o)}return this.destShadowBoundRect=new window.Rect(t.x(),t.y(),t.width(),t.height()),t}},{key:"render",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=Fs(t,i),o=a.getElem();this.measure();var s=o.getContext("2d");return Ol.debug_Axis_Linewidth>0&&s.strokeRect(0,0,o.width,o.height),this._renderShadow(s,e,t,i,n,r),this._hasOuterShadow2()&&(this._setupShadow2(),this._renderShadow(s,e,t,i,n,r)),o}},{key:"_renderShadow",value:function(e,t,i,n,r,a){var o=this;e.save(),e.shadowColor=this.color.rgba,e.shadowBlur=this.blurRadius,e.shadowOffsetX=2*i+2*this.blurRadius,e.shadowOffsetY=2*n+2*this.blurRadius,e.translate(-e.shadowOffsetX,-e.shadowOffsetY);var s=this.destShadowBoundRect.x()-this.boundRect.x(),l=this.destShadowBoundRect.y()-this.boundRect.y();s=s<0?-s:0,l=l<0?-l:0,this.transform.calcTransform((function(e){return e*o.ltd}),this.shadowRect,e,s,l),e.drawImage(t,0,0),e.restore()}},{key:"getColor",value:function(){return this.color}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"setDistance",value:function(e){this.distance=e}},{key:"getDirection",value:function(){return this.direction}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"getSkewX",value:function(){return this.skewX}},{key:"getSkewY",value:function(){return this.skewY}},{key:"getAlignment",value:function(){return this.alignment}},{key:"rotateWithShape",value:function(){return this.rotateWithShape}},{key:"_initPresetType",value:function(e){switch(e.presetType){case oh:case sh:this.alignment=Be.g.RectangleAlignmentCenter;break;case lh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewY=40.89,this.scaleY=.5;break;case hh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewY=-40.89,this.scaleY=.5;break;case uh:case ch:this.alignment=Be.g.RectangleAlignmentCenter;break;case dh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=-.5;break;case ph:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=-.5;break;case fh:this.alignment=Be.g.RectangleAlignmentTopLeft,this.scaleX=.75,this.scaleY=.75;break;case gh:this.alignment=Be.g.RectangleAlignmentBottomRight,this.scaleX=1.25,this.scaleY=1.25;break;case yh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=.5;break;case vh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=.5;break;case mh:this.alignment=Be.g.RectangleAlignmentBottom;break;case _h:this.alignment=Be.g.RectangleAlignmentCenter;break;case wh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=40.89,this.scaleY=-.5;break;case Sh:this.alignment=Be.g.RectangleAlignmentBottom,this.skewX=-40.89,this.scaleY=-.5;break;case xh:case Th:this.alignment=Be.g.RectangleAlignmentBottom;break;case kh:this.alignment=Be.g.RectangleAlignmentBottom,this.scaleY=.5;break;case Ch:this.alignment=Be.g.RectangleAlignmentBottom,this.scaleY=-1}}},{key:"_hasOuterShadow2",value:function(){return mh===this.shadow.presetType||xh===this.shadow.presetType||Th===this.shadow.presetType}},{key:"_setupShadow2",value:function(){switch(this._calcShadow2Color(this.color),this.shadow.presetType){case mh:this.distance*=2;break;case xh:case Th:this.direction=(this.direction+180)%360;break;default:return}}},{key:"_calcShadow2Color",value:function(){var e=this.color.rgba;if(e&&!(e.indexOf("rgba")<0)){var t=Number(e.slice(5,-1).split(",")[0]),i=Number(e.slice(5,-1).split(",")[1]),n=Number(e.slice(5,-1).split(",")[2]),r=Number(e.slice(5,-1).split(",")[3]);t=t+102<255?t+102:255,i=i+102<255?i+102:255,n=n+102<255?n+102:255,this.color.rgba="rgba("+t+", "+i+", "+n+", "+r+")"}}}]),e}(),Ah=function(){function e(t,i,n,a,o){r()(this,e),this._init(t,a),this.transform=this.createEffectTransform(),this.paths=i,this.boundRect=n,this.ltd=a,this.fill=o.fill,this.layout=o.layout,this.preloadSource=o.preloadSource,this.parentLayout=o.parentLayout,this.picture=o.picture}return o()(e,[{key:"_init",value:function(e,t){this.blurRadius=window.Emu2Ti(e.blurRadius)*t*this.blurScale(t)||0,this.distance=window.Emu2Ti(e.distance)*this.distanceScale(t)||0,this.direction=e.direction*(1/6e4)||0,this.color=e.color||"rgab(0,0,0,0.2)"}},{key:"distanceScale",value:function(e){return e<.03?1.1789:1}},{key:"blurScale",value:function(e){return e<.03?1.4:1}},{key:"createEffectTransform",value:function(){var e=new Eh;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e}},{key:"render",value:function(e){var t=this,i=this.boundRect.x(),n=this.boundRect.y(),r=Fs(this.boundRect.width(),this.boundRect.height()).getElem(),a=this.transform.calcTransform((function(e){return e*t.ltd}),this.boundRect,null),o=r.getContext("2d"),s=Fs(r.width,r.height).getElem(),l=s.getContext("2d");if(l.fillStyle=this.color.rgba||"rgba(0,0,0,0.5)",this.ltd<.03){var h=this.color.rgba.split(",");if("0)"!==h[3]){var u=isNaN(Number(h[3].split(")")[0]))?.5:Number(h[3].split(")")[0]);l.fillStyle=h[0]+","+h[1]+","+h[2]+","+(u+.2)+")"}}var c=1;this.picture?(this.picture.blip&&this.picture.blip.effects&&this.picture.blip.effects.forEach((function(e){e.type===Be.c.AlphaModulateFixed&&(c="number"==typeof e.amount?e.amount:1)})),this.paths.resetMatrix.mapContext(o),this.paths.resetMatrix.mapContext(l),o.save(),o.globalAlpha=c,o.drawImage(e,this.boundRect.x(),this.boundRect.y()),o.restore(),l.shadowColor=l.fillStyle,l.drawImage(e,this.boundRect.x(),this.boundRect.y()),l.globalCompositeOperation="source-in",l.save(),l.globalAlpha=c,l.fillRect(this.boundRect.x(),this.boundRect.y(),s.width,s.height),l.restore(),l.globalCompositeOperation="source-over"):(this.fill&&(this.fill.type===Be.e.FillTypeBlip?this.fill&&this.fill.blip&&this.fill.blip.effects&&this.fill.blip.effects.forEach((function(e){e.type===Be.c.AlphaModulateFixed&&(c="number"==typeof e.amount?e.amount:1)})):this.fill.color&&(c=this.fill.color.alpha)),l.save(),l.globalAlpha=c,this.paths.forEach((function(e){t.fill&&t.fill.type&&(new ol({fill:t.fill,path:e,layout:t.layout,preloadSource:t.preloadSource,parentLayout:t.parentLayout}).render(o)&&(o.beginPath(),e.painterPath.toContextPath(o),o.fill(),l.beginPath(),e.painterPath.toContextPath(l),l.fill()))})),l.restore());var d=this.createInnerShadowImage(r,s,-a.x()+i,-a.y()+n);return s._canvasPoolItem.release(),this.picture&&this.paths.matrix.mapContext(o),d}},{key:"createInnerShadowImage",value:function(e,t,i,n){i=Math.round(i),n=Math.round(n);var r=Fs(this.boundRect.width(),this.boundRect.height()).getElem(),a=r.getContext("2d");a.drawImage(t,0,0),a.translate(i,n),a.globalCompositeOperation="destination-out";var o=Fs(e.width,e.height),s=o.getElem();if(s.getContext("2d").drawImage(e,0,0),this.blurRadius>0){var l=this.createShadowBlur(s,t);a.drawImage(l,-this.blurRadius,-this.blurRadius),l._canvasPoolItem.release()}else a.drawImage(s,0,0);return o.release(),r}},{key:"createShadowBlur",value:function(e){var t=Fs(this.boundRect.width()+2*this.blurRadius,this.boundRect.height()+2*this.blurRadius).getElem(),i=t.getContext("2d");i.translate(this.blurRadius,this.blurRadius),i.drawImage(e,0,0),e._canvasPoolItem.release();var n=i.getImageData(0,0,t.width,t.height),r=new Ih(n,this.blurRadius).render();return i.putImageData(r,0,0),t}},{key:"_innerShadowBlend",value:function(e,t,i){for(var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),a=e.width,o=e.height,s=n.createImageData(e.width,e.height),l=Fs(a,o).getElem(),h=l.getContext("2d"),u=0;u<s.data.length;u+=4){var c=4*(Math.floor(Math.floor(u/4)/a)+t)*a+4*(Math.floor(u/4)%a+i),d=r.data[u],p=r.data[u+1],f=r.data[u+2],g=r.data[u+3];d&p&f&g&&(d=r.data[c],p=r.data[c+1],f=r.data[c+2],g=r.data[c+3]),s.data[u]=d,s.data[u+1]=p,s.data[u+2]=f,s.data[u+3]=g}return h.putImageData(s,0,0),l}},{key:"getColor",value:function(){return this.color}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"getDirection",value:function(){return this.direction}},{key:"setDistance",value:function(e){this.distance=e}}]),e}(),Bh=function(){function e(){r()(this,e),this.zoomScale=1/15}return o()(e,[{key:"_calcRect",value:function(e,t){var i=void 0,n=void 0,r=void 0,a=void 0;return i=e.left()<t.left()?e.left():t.left(),n=e.right()>t.right()?e.right():t.right(),r=e.top()<t.top()?e.top():t.top(),a=e.bottom()>t.bottom()?e.bottom():t.bottom(),new window.Rect(i,r,n-i,a-r)}},{key:"_getShadowScale",value:function(e){var t=1;if(e){e instanceof String&&e.indexOf("px")>-1&&(e=e&&e.slice(0,-2)||10);var i=e/20;i<=5?t=.1243*i+.1394:i>5&&i<=15?t=.0836*i+.3611:i>15&&(t=.0652*i+.6435)}return t*window.ti2pxRatio}}]),e}(),Dh=function(e){function t(e,i){r()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.effects=e,n.scale=i;var a=e.innerShadow,o=e.outerShadow,s=e.reflection,h=e.glow;return n.innerShadow=a,n.outerShadow=o,n.reflection=s,n.glow=h,n}return u()(t,e),o()(t,[{key:"initCanvas",value:function(e,t,i){this.textRect=e,this.scale=i,this.realShapeRect=t}},{key:"renderCanvas",value:function(e,t){var i=this.effects.outerShadow,n=new window.Rect(this.textRect.x(),this.textRect.y(),this.textRect.width(),this.textRect.height()),r=this._getShadowScale(t),a=new Lh(i,n,{},r);a.blurRadius*=1.5;var o=a.render(e,this.realShapeRect.width(),this.realShapeRect.height());return this.shadowCanvas=o,o}},{key:"release",value:function(){var e=this.shadowCanvas&&this.shadowCanvas._canvasPoolItem;e.release&&e.release()}}]),t}(Bh),Mh=function(e){function t(e,i,n){r()(this,t);var a=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));a.effects=e,a.scale=n,a.typoGlyph=i;var o=e.innerShadow,s=e.outerShadow,h=e.reflection,u=e.glow;return a.innerShadow=o,a.outerShadow=s,a.reflection=h,a.glow=u,a}return u()(t,e),o()(t,[{key:"initCanvas",value:function(e,t,i){this.scale=t,this.realShapeRect=e,this.typoGlyph=i,this.textColor=i.getGradientColor();var n=i.artTextOutLineFill();this.artTextOutLineFill=n,this.outlineColor=n.fill,this.lineWidth=.05*window.Emu2Ti(n.width)||0;var r=this.effects.innerShadow;this.blurRadius=.05*window.Emu2Ti(r.blurRadius)||0,this.distance=.05*window.Emu2Ti(r.distance)||0,this.direction=r.direction*(1/6e4)||0,this.direction=this.direction-180,this.color=r.color}},{key:"renderCanvas",value:function(e,t){var i=this.lineWidth,n=this.realShapeRect.width()+2*i,r=this.realShapeRect.height()+2*i,a=new window.Rect(0,0,n,r),o=Fs(a.width(),a.height()),s=o.getElem(),l=o.getContext("2d");if(0===t.length)return s;var h=e.getContext("2d"),u=t[0].font.fontSize,c=this.getDisScale(u),d=this.distance*Math.cos(this.direction*Math.PI/180)*c,p=this.distance*Math.sin(this.direction*Math.PI/180)*c;l.textBaseline=h.textBaseline,l.textAlign=h.textAlign,l.lineWidth=this.lineWidth;var f=t[0],g=f?-f.x:0,y=this.createTextCanvas(h,a,t,g),v=this.createShadowCanvas(h,a,t,g);return l.drawImage(y.getElem(),0,0),l.globalCompositeOperation="source-atop",l.drawImage(v.getElem(),d,p),y.release(),v.release(),this.innerShadowCanvas=s,s}},{key:"release",value:function(){var e=this.innerShadowCanvas&&this.innerShadowCanvas._canvasPoolItem;e.release&&e.release()}},{key:"createTextCanvas",value:function(e,t,i,n){var r=this,a=this.lineWidth,o=Fs(t.width(),t.height()),s=o.getContext("2d");return this._setLineJoin(s),s.textBaseline=e.textBaseline,s.textAlign=e.textAlign,s.lineWidth=this.lineWidth,s.fillStyle=e.fillStyle,s.strokeStyle=e.strokeStyle,this.typoGlyph.isRightChar&&s.direction&&(s.direction="rtl"),i.forEach((function(e){var t=e.x,i=e.y,o=e.text,l=e.font,h=t+n+a,u=i+a,c=l.fontStyle+" normal "+l.fontWeight+" "+l.fontSize+"px "+l.fontFamily;(s.font=c,r.typoGlyph.isRightChar&&s.direction)&&(h+=s.measureText(o).width);s.fillText(o,h,u),s.strokeText(o,h,u)})),s.globalCompositeOperation="source-atop",s.fillStyle="rgba(0, 0, 0, 1)",this.typoGlyph.isRightChar&&s.direction&&(s.direction="rtl"),i.forEach((function(e){var t=e.x,i=e.y,o=e.text,l=e.font,h=(t+n)*r.scale+a,u=i*r.scale+a,c=l.fontStyle+" normal "+l.fontWeight+" "+l.fontSize*r.scale+"px "+l.fontFamily;(s.font=c,r.typoGlyph.isRightChar&&s.direction)&&(h+=s.measureText(o).width);s.fillText(o,h,u),s.strokeText(o,h,u)})),s.fillStyle=this.color&&this.color.rgba||"rgba(0,0,0,0.2)",s.strokeStyle=this.color&&this.color.rgba||"rgba(0,0,0,0.2)",this.typoGlyph.isRightChar&&s.direction&&(s.direction="rtl"),i.forEach((function(e){var t=e.x,i=e.y,o=e.text,l=e.font,h=t+n+a,u=i+a,c=l.fontStyle+" normal "+l.fontWeight+" "+l.fontSize+"px "+l.fontFamily;(s.font=c,r.typoGlyph.isRightChar&&s.direction)&&(h+=s.measureText(o).width);!Wl(r.textColor)&&s.fillText(o,h,u),s.strokeText(o,h,u)})),o}},{key:"createShadowCanvas",value:function(e,t,i,n){var r=this,a=this.lineWidth,o=Fs(t.width(),t.height()),s=o.getContext("2d");return this._setLineJoin(s),s.textBaseline=e.textBaseline,s.textAlign=e.textAlign,s.lineWidth=this.lineWidth,s.fillStyle=e.fillStyle,s.strokeStyle=e.strokeStyle,this.typoGlyph.isRightChar&&s.direction&&(s.direction="rtl"),i.forEach((function(e){var t=e.x,i=e.y,o=e.text,l=e.font,h=t+n+a,u=i+a,c=l.fontStyle+" normal "+l.fontWeight+" "+l.fontSize+"px "+l.fontFamily;(s.font=c,r.typoGlyph.isRightChar&&s.direction)&&(h+=s.measureText(o).width);s.fillText(o,h,u),s.strokeText(o,h,u)})),o}},{key:"_setLineJoin",value:function(e){switch(this.artTextOutLineFill.joinType){case _e.LineJoinTypeMiter:e.lineJoin="miter";break;case _e.LineJoinTypeBevel:e.lineJoin="bevel";break;case _e.LineJoinTypeRound:default:e.lineJoin="round"}}},{key:"getDisScale",value:function(e){var t=1;return e&&("string"==typeof e&&e.indexOf("px")>-1&&(e=e&&e.slice(0,-2)),t=e/100),t}}]),t}(Bh),Oh=function(e){function t(e,i,n){r()(this,t);var a=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));a.effects=e,a.tScale=n,a.typoGlyph=i;var o=e.innerShadow,s=e.outerShadow,h=e.reflection,u=e.glow;return a.innerShadow=o,a.outerShadow=s,a.reflection=h,a.glow=u,a}return u()(t,e),o()(t,[{key:"initCanvas",value:function(e,t,i,n){var r=this.effects.glow;this.color=r.color||"#000000",this.radius=window.Emu2Ti(r.radius)*t*.843,this.textRect=e,this.outlineWidth=i*t,this.texts=n}},{key:"renderCanvas",value:function(e,t){var i=this;if(this.texts){var n=new window.Rect(t.x(),t.y(),t.width(),t.height()),r=this.radius,a=Fs(n.width(),n.height());this.canvasItem=a;var o=a.getElem(),s=o.getContext("2d");s.lineJoin="round",s.lineCap="round",s.textBaseline=e.textBaseline,s.textAlign=e.textAlign;var l=r+this.outlineWidth;l=l>40?l/2:l,v.userAgent.isIos&&(l=(l/=2)>25?25:l),s.lineWidth=l,s.shadowColor=this.color.rgba,s.shadowOffsetX=Math.round(n.width()+Math.abs(n.x())),s.shadowOffsetY=Math.round(n.height()+Math.abs(n.y())),s.translate(-s.shadowOffsetX,-s.shadowOffsetY);var h=Math.abs(this.textRect.x()-n.x()),u=Math.abs(this.textRect.y()-n.y());s.translate(h,u);var c=this.texts[0],d=c?-c.x:0,p=this.texts;return this.typoGlyph.isRightChar&&s.direction&&(s.direction="rtl"),p.forEach((function(e){var t=e.x,n=e.y,a=e.text,o=e.font,l=o.fontStyle+" normal "+o.fontWeight+" "+o.fontSize+"px "+o.fontFamily,h=i.getDisScale(o.fontSize);(s.shadowBlur=.843*r*h,s.font=l,i.typoGlyph.isRightChar&&s.direction)&&(t+=s.measureText(a).width);s.strokeText(a,t+d,n)})),o}}},{key:"release",value:function(){this.canvasItem&&this.canvasItem.release()}},{key:"getDisScale",value:function(e){var t=1;return e&&("string"==typeof e&&e.indexOf("px")>-1&&(e=e&&e.slice(0,-2)),t=e/2e3/window.ti2pxRatio),t}}]),t}(Bh),Nh=function(){function e(t,i,n,a){r()(this,e),this.ltd=n,this._init(t),this.transform=this.createEffectTransform(),this.boundRect=i,this.reflectionRect=a||i}return o()(e,[{key:"_init",value:function(e){this.blurRadius=window.Emu2Ti(e.blurRadius)*this.ltd*.85||0,this.distance=window.Emu2Ti(e.distance)*this.ltd||0,this.skewX=e.skewX*(1/6e4)||0,this.skewY=e.skewY*(1/6e4)||0,this.scaleY=void 0!==e.scaleY?e.scaleY:1,this.scaleX=void 0!==e.scaleX?e.scaleX:1,this.direction=e.direction*(1/6e4)||0,this.alignment=e.alignment,this.rotateWithShape=void 0===e.rotateWithShape||e.rotateWithShape,this.startAlpha=void 0!==e.startAlpha?e.startAlpha:1,this.startPosition=void 0!==e.startPosition?e.startPosition:0,this.endAlpha=void 0!==e.endAlpha?e.endAlpha:.1,this.endPosition=void 0!==e.endPosition?e.endPosition:.7,this.fadeDirection=e.fadeDirection*(1/6e4)||0}},{key:"measure",value:function(){var e=this.getDistance()+this.getEndPosition()*this.reflectionRect.height();if(this.reflectionRect.bottom()>this.boundRect.bottom()){var t=this.reflectionRect.bottom()-this.boundRect.bottom();this.reflectionOff=this.getDistance()+this.boundRect.height()-t}else this.reflectionOff=this.getDistance()+this.reflectionRect.height();return new window.Rect(this.boundRect.x()-this.blurRadius,this.boundRect.y()-this.blurRadius,this.boundRect.width()+2*this.blurRadius,this.boundRect.height()+e+2*this.blurRadius)}},{key:"render",value:function(e,t,i){this.measure();var n=Fs(this.reflectionRect.width()+2*this.getBlurRadius(),this.reflectionRect.height()+2*this.getBlurRadius()).getElem(),r=n.getContext("2d");return Ol.debug_Axis_Linewidth>0&&r.strokeRect(0,0,n.width,n.height),r.translate(0,this.reflectionRect.height()),r.scale(1,-1),this.createImage(r,e.canvas,n.width,n.height),n}},{key:"createImage",value:function(e,t,i,n){var r=i,a=n;e.translate(0,2*-this.getBlurRadius()),e.drawImage(t,0,0);var o=new window.Point,s=new window.Point;!function(e,t,i,n,r){for(;t<0;)t+=360;var a=Math.PI,o=parseInt(t,10)%360,s=t/180*a;if(i){var l=Math.atan(Math.abs(Math.tan(s)*(0===e.height()?1:e.width()/e.height())));o>0&&o<90?(t=l/a*180,s=l):o>90&&o<180?(t=180-l/a*180,s=a-l):o>180&&o<270?(t=180+l/a*180,s=a+l):o>270&&o<360&&(t=360-l/a*180,s=2*a-l)}var h=void 0;t>=0&&t<90?(n.setX(e.x()),n.setY(e.y()),h=Math.cos(s)*e.width()+Math.sin(s)*e.height()):t>=90&&t<180?(n.setX(e.x()+e.width()),n.setY(e.y()),h=Math.cos(a-s)*e.width()+Math.sin(a-s)*e.height()):t>=180&&t<270?(n.setX(e.x()+e.width()),n.setY(e.y()+e.height()),h=Math.cos(s-a)*e.width()+Math.sin(s-a)*e.height()):t>=270&&t<360&&(n.setX(e.x()),n.setY(e.y()+e.height()),h=Math.cos(2*a-s)*e.width()+Math.sin(2*a-s)*e.height());r.setX(n.x()+h*Math.cos(s)),r.setY(n.y()+h*Math.sin(s))}(new window.Rect(0,0,r,a),this.getDirection(),!0,o,s);var l=e.createLinearGradient(o.x(),o.y(),s.x(),s.y()),h="rgba(255,255,255,"+this.getStartAlpha()+")",u="rgba(255,255,255,"+this.getEndAlpha()+")";l.addColorStop(this.getStartPosition(),h),l.addColorStop(this.getEndPosition(),u);var c=e.getImageData(0,0,r,a);this.getBlurRadius()>0&&new Ih(c,this.getBlurRadius()).render();!function(e,t,i){for(var n=function(e,t){var i=Fs(t.width(),t.height()).getElem(),n=i.getContext("2d");return n.fillStyle=e,n.fillRect(0,0,t.width(),t.height()),i}(t,i),r=n.getContext("2d").getImageData(0,0,n.width,n.height).data,a=e.data,o=0;o<r.length;o+=4){var s=r[o+3];a[o+3]=a[o+3]*s>>8}n._canvasPoolItem.release()}(c,l,new window.Rect(0,0,r,a)),e.putImageData(c,0,0)}},{key:"createEffectTransform",value:function(){var e=new Eh;return e.m_dist=this.getDistance(),e.m_dir=this.getDirection(),e.m_sx=this.getScaleX(),e.m_sy=this.getScaleY(),e.m_kx=this.getSkewX(),e.m_ky=this.getSkewY(),e.m_alignment=this.getAlignment(),e}},{key:"getBoundRect",value:function(){return new window.Rect(this.boundRect.x(),this.boundRect.y(),this.boundRect.width(),this.boundRect.height())}},{key:"getEndPosition",value:function(){return this.endPosition}},{key:"getEndAlpha",value:function(){return this.endAlpha}},{key:"getStartPosition",value:function(){return this.startPosition}},{key:"getStartAlpha",value:function(){return this.startAlpha}},{key:"getfadeDirection",value:function(){return this.fadeDirection}},{key:"getBlurRadius",value:function(){return this.blurRadius}},{key:"setBlurRadius",value:function(e){this.blurRadius=e}},{key:"getDistance",value:function(){return this.distance}},{key:"setDistance",value:function(e){this.distance=e}},{key:"getDirection",value:function(){return this.direction}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"getSkewX",value:function(){return this.skewX}},{key:"getSkewY",value:function(){return this.skewY}},{key:"getAlignment",value:function(){return this.alignment}},{key:"rotateWithShape",value:function(){return this.rotateWithShape}}]),e}();var Fh=function(e){function t(e,i){r()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.effects=e,n.tScale=i;var a=e.innerShadow,o=e.outerShadow,s=e.reflection,h=e.glow;return n.innerShadow=a,n.outerShadow=o,n.reflection=s,n.glow=h,n}return u()(t,e),o()(t,[{key:"initCanvas",value:function(e,t){this.scale=t,this.realShapeRect=e}},{key:"renderCanvas",value:function(e,t){var i=this.effects.reflection,n=t.height()/18*this.tScale,r=new window.Rect(this.realShapeRect.x(),this.realShapeRect.y(),this.realShapeRect.width()*this.tScale,this.realShapeRect.height()*this.tScale),a=new Nh(i,r,this.scale);a.blurRadius=0;var o=a.render(e,Math.round(this.realShapeRect.width()*this.tScale),Math.round(this.realShapeRect.height()*this.tScale));return this.reflectionOff=a.reflectionOff||0,this.reflectionDis=a.getDistance()*n/2||0,this.reflectionCanvas=o,o}},{key:"release",value:function(){var e=this.reflectionCanvas&&this.reflectionCanvas._canvasPoolItem;e.release&&e.release()}}]),t}(Bh),Vh=function(){function e(t,i,n,a,o,s,l){r()(this,e),this.drawRect=t,this.typoGlyph=a,this.realShapeRect=o,this.preloadSource=s,this.lineRect=i,this.texts=l,this.offX=(this.realShapeRect.x()-this.drawRect.x())*n,this.offY=(this.realShapeRect.y()-this.drawRect.y())*n,this._init()}return o()(e,[{key:"_init",value:function(){var e=this.realShapeRect.width(),t=this.realShapeRect.height(),i=this.typoGlyph.artTextOutLineFill();this.lineWidth=i.width&&window.Emu2Ti(i.width)||0,this.canvasItem=Fs(e,t),this._canvas=this.canvasItem.getElem(),this._ctx=this.canvasItem.getContext()}},{key:"draw",value:function(){var e=this;this.setFill(),this.setOutLine();var t=this._ctx;t.textBaseline="alphabetic",t.lineJoin="round",t.lineCap="round",t.save(),t.translate(-this.offX,-this.offY);var i=this.texts;t.lineWidth=this.lineWidth,this.typoGlyph.isRightChar&&t.direction&&(t.direction="rtl");var n=i[0].x?-i[0].x:0;return i.forEach((function(i){var r=i.x,a=i.y,o=i.text,s=i.font,l=r+n,h=a,u=s.fontStyle+" normal "+s.fontWeight+" "+s.fontSize+"px "+s.fontFamily;(t.font=u,e.typoGlyph.isRightChar&&t.direction)&&(l+=t.measureText(o).width);t.fillText(o,l,h),t.strokeText(o,l,h)})),t.restore(),this._canvas}},{key:"setFill",value:function(){var e=this.typoGlyph.getParent(),t=new window.Rect(this.lineRect.x(),this.lineRect.y(),this.lineRect.width(),this.lineRect.height()),i=new ql({span:e,lineRect:t,scale:this.scale,preloadSource:this.preloadSource,isSvg:!1});i.render(this._ctx);var n=i.getStyle();this._ctx.fillStyle=n}},{key:"setOutLine",value:function(){var e=this.typoGlyph.getParent(),t=new window.Rect(this.lineRect.x(),this.lineRect.y(),this.lineRect.width(),this.lineRect.height()),i=new Xl(e,this.scale,t,!1),n=i.render(this._ctx);this.lineWidth=i.getLineWidth(),this._ctx.strokeStyle=n}},{key:"getContext",value:function(){return this._ctx}},{key:"getCanvas",value:function(){return this._canvas}},{key:"release",value:function(){this.canvasItem.release()}}]),e}(),Uh=function(){function e(t,i,n,a){r()(this,e),this.color=t.color||"#000000",this.radius=window.Emu2Ti(t.radius)*n,this.scale=n,this.boundRect=i,this.lineWidth=a}return o()(e,[{key:"measure",value:function(){var e=.843*this.radius+this.lineWidth-this.lineWidth,t=this.boundRect.adjusted(-e,-e,e,e);return this.destBoundRect=new window.Rect(t.x(),t.y(),t.width(),t.height()),t}},{key:"render",value:function(e,t,i,n,r,a){var o=.843*this.radius+this.lineWidth;this.measure();var s=Fs(a.width(),a.height()).getElem(),l=s.getContext("2d");l.lineWidth=o,l.shadowBlur=o-this.lineWidth,l.shadowColor=this.color.rgba,l.shadowOffsetX=a.width()+Math.abs(a.x()),l.shadowOffsetY=a.height()+Math.abs(a.y()),l.translate(-l.shadowOffsetX,-l.shadowOffsetY),l.translate(-a.x(),-a.y()),r.mapContext(l);for(var h=0;h<e.length;h++){var u=e[h].attributes,c=u.fill;i&&i.fill&&i.fill.type&&(!u.hasOwnProperty("stroke")||u.stroke)&&((i.headEnd||i.tailEnd)&&e[h].strokerPath?(e[h].strokerPath.toContextPath(l),l.lineWidth=o/2,l.stroke()):e[h].painterPath&&(l.lineWidth=o/2,l.shadowBlur=o/2,e[h].painterPath.toContextPath(l),l.stroke())),(t&&t.type&&c!==bh.e.None||n)&&e[h].painterPath&&(e[h].painterPath.toContextPath(l),l.stroke())}return s}}]),e}(),Gh=function(e){function t(e){var i=e.scale,n=e.verticalType,a=e.preloadSource,o=e.descent;r()(this,t);var s=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.preloadSource=a,s.verticalType=n,s.layoutScale=i,s.descent=o,s}return u()(t,e),o()(t,[{key:"_initCanvas",value:function(e,t,i,n){this.texts=t,this.typoGlyph=e,this.drawRect=i,this.effects=e.getArtTextEffectList(),this.lineRect=n}},{key:"_renderCanvas",value:function(e){if(!this.isRenderEffect()||!this.effects||0===this.texts.length)return!1;var t=this.effects,i=t.innerShadow,n=t.outerShadow,r=t.reflection,a=t.glow;this.measure(),this.offX=this.realShapeRect.x()-this.drawRect.x(),this.offY=this.realShapeRect.y()-this.drawRect.y();var o=new Vh(this.drawRect,this.lineRect,1,this.typoGlyph,this.realShapeRect,this.preloadSource,this.texts),s=o.draw(),l=o.getContext(),h=Fs(this.realShapeRect.width(),this.realShapeRect.height()),u=h.getContext();u.drawImage(s,0,0),this._renderGlow(e,l,u,a),this._renderInnerShadow(e,s,u,i),u.globalCompositeOperation="destination-over",this._renderOutShadow(e,u,n),this._renderReflection(e,u,r),h.release(),o.release()}},{key:"_renderGlow",value:function(e,t,i,n){if(n&&n.radius>0){e.save();var r=this.typoGlyph.artTextOutLineFill(),a=r.width&&window.Emu2Ti(r.width)*window.ti2pxRatio||1,o=new Oh(this.effects,this.typoGlyph,1);o.initCanvas(this.drawRect,this.layoutScale,a,this.texts);var s=o.renderCanvas(t,this.realShapeRect);e.drawImage(s,this.drawRect.x()+this.offX,this.offY),i.drawImage(s,0,0),o.release(),e.restore()}}},{key:"_renderInnerShadow",value:function(e,t,i,n){if(n){e.save();var r=new Mh(this.effects,this.typoGlyph,1);r.initCanvas(this.realShapeRect,this.layoutScale,this.typoGlyph);var a=r.renderCanvas(t,this.texts),o=r.lineWidth||0;e.drawImage(a,this.drawRect.x()-o,-o),i.drawImage(a,-this.offX,-this.offY),r.release(),e.restore()}}},{key:"_renderOutShadow",value:function(e,t,i){if(i){e.save();var n=new Dh(this.effects,1),r=this.texts[0]&&this.texts[0].font.fontSize;n.initCanvas(this.lineRect,this.realShapeRect,this.layoutScale);var a=n.renderCanvas(t.canvas,r);e.drawImage(a,this.drawRect.x()+this.offX,this.offY),t.drawImage(a,0,0),n.release(),e.restore()}}},{key:"_renderReflection",value:function(e,t,i){if(i&&i.startPosition===i.endPosition!==0){e.save();for(var n=t.canvas.width,r=t.canvas.height,a=0,o=r,s=t.getImageData(0,0,n,r).data,l=s.length-4;l>0;l-=4)if(0!==s[l]||0!==s[l+1]||0!==s[l+2]||0!==s[l+3]){o=Math.ceil(l/4/n);break}for(var h=0;h<s.length-4;h+=4)if(0!==s[h]||0!==s[h+1]||0!==s[h+2]||0!==s[h+3]){a=Math.ceil(h/4/n);break}var u=(o+=1)-(a-=1),c=n,d=Fs(n,u),p=d.getContext("2d");p.drawImage(t.canvas,0,a,c,u,0,0,c,u);var f=new window.Rect(this.realShapeRect.x(),this.realShapeRect.x(),this.realShapeRect.width(),u),g=new Fh(this.effects,1);g.initCanvas(f,this.layoutScale);var y=g.renderCanvas(p,this.lineRect),v=g.reflectionDis,m=y.height-(this.drawRect.y()+this.drawRect.height()-this.descent)-Math.abs(this.offY)-v+a;m=m>0?m:0;var _=this.drawRect.x()+this.offX,w=v>a?a:0,S=this.drawRect.y()+this.drawRect.height()-this.descent+v-w,x=m,T=y.width,k=y.height-x,C=y.getContext("2d");C.save();var b=Fs(T,k),E=b.getElem();b.getContext("2d").drawImage(y,0,x,T,k,0,0,T,k),e.drawImage(E,_,S),C.restore(),b.release(),g.release(),d.release(),e.restore()}}},{key:"measure",value:function(){var e=this.effects,t=e.outerShadow,i=(e.reflection,e.glow),n=(this.typoGlyph.getFont()||{}).fontStyle,r=this.drawRect.x(),a=this.drawRect.y(),o=this.drawRect.width(),s=this.drawRect.height()+this.descent;"italic"===n&&(o+=.4*this.typoGlyph.width,s+=.4*this.typoGlyph.height);var l=new window.Rect(r,a,o,s),h=new window.Rect(r,a,o,s);if(t){var u=this.typoGlyph.getCssStyle().fontSize,c=this._getShadowScale(u),d=new Lh(t,this.lineRect,{},c).measure();h=this._calcRect(h,d)}if(i){var p=this.typoGlyph.artTextOutLineFill(),f=p.width&&window.Emu2Ti(p.width)*window.ti2pxRatio||1,g=new Uh(i,l,this.layoutScale,f).measure();h=this._calcRect(h,g)}this.realShapeRect=h}},{key:"isRenderEffect",value:function(){var e=this.typoGlyph.getGradientColor();if(4===e.type){0===e.tileHorizontalRatio||e.tileVerticalRatio;var t=1;if(e.blip&&e.blip.effects&&e.blip.effects.forEach((function(e){e.type===Be.c.AlphaModulateFixed&&(t="number"==typeof e.amount?e.amount:1)})),0===t&&!this.hasOutLine())return!1}return!0}},{key:"hasOutLine",value:function(){var e=this.typoGlyph.artTextOutLineFill();return!(!e||!e.fill||0===e.fill.type)}}]),t}(Bh),Hh=function(e){function t(e,i,n){r()(this,t);var a=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.typoBodyData=e,a.scale=i,a.preloadSource=n||{},a._init(),a}return u()(t,e),o()(t,[{key:"_init",value:function(){var e=this.typoBodyData.getChildren(),t=e&&e[0],i=t&&t.getGlyphs()[0],n=i&&i.x||0,r=e[this.typoBodyData.getChildCount()-1],a=r&&r.getGlyphs()[r.getChildCount()-1],o=(a&&a.x||0)-n,s=this.typoBodyData.height;this.realRect=new window.Rect(n,0,o,s),this._measure()}},{key:"_measure",value:function(){var e=this,t=this.typoBodyData.getChildren();if(t){var i=!1,n=!1;t.forEach((function(t){e._measureAutonum(t)&&(i=!0),e._measureText(t)&&(n=!0)})),this.hasEffect=i||n}else this.hasEffect=!1}},{key:"_measureAutonum",value:function(e){var t=e.getTypoAutoNum();if(!t)return!1;var i=new window.Rect(e.x+t.x,e.y+t.y,t.width,t.height),n=t.getArtTextEffectList();if(!n||0===Object.keys(n).length)return!1;var r=this._measureEffect(n,t,i,i,i.height());return this.realRect=this._calcRect(this.realRect,r),!0}},{key:"_measureText",value:function(e){var t=this,i=!1;return e.getGlyphs().forEach((function(n){var r=n.getArtTextEffectList();if(!r||0===Object.keys(r).length)return!1;i=!0;var a=n.parent;if(!a)return!1;var o=(n.getFont()||{}).fontStyle,s=e.x+a.x+n.x,l=e.y+a.y+n.y-n.height,h=n.width,u=n.height;"italic"===o&&(h*=1.4,u*=1.4);var c=new window.Rect(s,l,h,u),d=new window.Rect(e.x,e.y,a.width+a.x,a.height+a.y),p=t._measureEffect(r,n,c,d,a.height);t.realRect=t._calcRect(t.realRect,p)})),i}},{key:"_measureEffect",value:function(e,t,i,n,r){var a=e.outerShadow,o=e.reflection,s=e.glow,l=i.clone();if(a){var h=t.getFont().fontSize,u=this._getShadowScale(h),c=new Lh(a,n,{},u).measure();l=this._calcRect(l,c)}if(s){var d=t.artTextOutLineFill(),p=d.width&&window.Emu2Ti(d.width)*window.ti2pxRatio||1,f=new Uh(s,i,this.scale,p).measure();l=this._calcRect(l,f)}if(o){var g=r/18/2*this.scale,y=new Nh(o,l,g).measure();l=this._calcRect(l,y)}return l}},{key:"render",value:function(e){var t=this;if(e&&this.hasEffect){var i=Fs(this.realRect.width(),this.realRect.height()),n=i.getContext("2d"),r=this.typoBodyData.getChildren();r&&0!==r.length&&(r.forEach((function(e){for(var i=e.getTypoTextLines(),r=e.getTypoAutoNum(),a=0,o=0;o<i.length;o++){var s=i[o],l=s.getVerticalType();0===o&&r&&(n.save(),n.translate(e.x-t.realRect.x(),e.y-t.realRect.y()),t._renderAutonumEffect(n,s,r,e,l),n.restore(),a=s.x-r.x),n.save(),n.translate(e.x+a-t.realRect.x(),e.y+s.y-t.realRect.y()),t._renderEffect(n,s,l,a),n.restore()}})),e.save(),e.translate(this.realRect.x(),this.realRect.y()),e.drawImage(n.canvas,0,0),e.restore(),i.release())}}},{key:"_renderAutonumEffect",value:function(e,t,i,n,r){if(r!==C.TextDirectionType.Horizontal||t.isEmptyLine()&&!n.isFocus())return!1;var a=new window.Rect(i.x,0,i.width,i.y+i.height),o=new window.Rect(t.x,0,t.width,t.height),s=new Gh({scale:this.scale,verticalType:r,preloadSource:this.preloadSource,descent:t.descent}),l=[{x:i.x,y:i.y+i.height-i.descent,text:i.getText(),font:i.getFont()}];s._initCanvas(i,l,a,o),s._renderCanvas(e)}},{key:"_renderEffect",value:function(e,t,i,n){var r=this,a=this.scale,o=this.preloadSource,s=new Gh({scale:a,verticalType:i,preloadSource:o,descent:t.descent}),l=new window.Rect(t.x,t.y,t.width,t.height),h=void 0,u=void 0,c=void 0,d=[],p=t.getGlyphs();p&&p.forEach((function(a){var o=a.getRect();if(!r._hasEffect(a)||r._isSpace(a))return!1;if(i===C.TextDirectionType.Horizontal){u=a,c||(c=new window.Rect(u.x,u.y-u.height,u.width,u.height)),!Fl(u.getArtTextEffectList(),h&&h.getArtTextEffectList())&&h&&(r._renderSpan(e,s,h,d,c,l,n),d=[],c=new window.Rect(u.x,u.y-u.height,u.width,u.height)),h=u,c=r._calcRect(c,new window.Rect(u.x,u.y-u.height,u.width,u.height)),d.push({x:u.x+t.x,y:u.y-t.descent,font:u.getFont(),text:u.getChar()})}else{i===C.TextDirectionType.EastAsianVer?a.isVerticalRightChar()||a.isVerticalTopRightCornerChar()?(e.save(),e.restore()):a.isVerticalRotateChar()?(o.x+=t.descent,e.save(),e.translate(o.x,o.y-o.height),e.rotate(Math.PI/2),e.translate(-o.x,-o.y+o.height),e.restore()):(o.y-=t.descent,e.save(),e.restore()):i===C.TextDirectionType.Vertical?(o.x+=t.descent,e.save(),e.translate(o.x,o.y),e.rotate(Math.PI/2),e.translate(-o.x,-o.y),e.restore()):i===C.TextDirectionType.Vertical270?(o.x-=t.descent,e.save(),e.translate(o.x,o.y),e.rotate(Math.PI/2*3),e.translate(-o.x,-o.y),e.restore()):i===C.TextDirectionType.VerticalWordArtRightToLeft&&((o=Object.assign({},o)).y+=o.height,e.save(),e.restore())}})),u&&this._renderSpan(e,s,u,d,c,l,n)}},{key:"_renderSpan",value:function(e,t,i,n,r,a,o){r=new window.Rect(r.x()+a.x()-o,r.y(),r.width(),r.height()),a=new window.Rect(o,a.y(),a.width()+a.x()-o,a.height()),t._initCanvas(i,n,r,a),t._renderCanvas(e)}},{key:"_isSpace",value:function(e){var t=e.getChar().charCodeAt();return 13===t||11===t}},{key:"_hasEffect",value:function(e){var t=e.getArtTextEffectList();if(0===Object.keys(t).length)return!1;var i=e.artTextOutLineFill(),n=i&&i.fill&&0!==i.fill.type,r=e.getGradientColor(),a=!0;switch(r.type){case Be.e.FillTypeNone:a=!1;break;case Be.e.FillTypeSolidColor:if(r.fill&&r.fill.color&&r.fill.color.rgba){var o=r.fill.color.rgba;0===parseFloat(o.split(",")[3].split(")")[0])&&(a=!1)}break;case Be.e.FillTypeBlip:0!==r.tileHorizontalRatio&&0!==r.tileVerticalRatio||(a=!1);break;case Be.e.FillTypePattern:}return!(!n&&!a)}}]),t}(Bh),Wh=0,jh=.4,Yh=Ol.debug_Axis_Linewidth,zh=function(){function e(){r()(this,e),this._addHighLight=function(e){var t=e.highlightList,i=e.typoPara,n=e.typoLine,r=e.typoGlyph,a=e.highlightColor,o=e.index,s=e.hex,l=e.highlightHeight;if(!r.isLineBreak()){var h=void 0,u=void 0;switch(n.getVerticalType()){case C.TextDirectionType.Horizontal:var c=l?Math.min(n.height,l):r.descent+r.ascent+.025*r.height,d=Math.max(r.width+r.spacing,0);h={x:i.x+n.x+r.x,y:i.y+n.y+r.y-n.descent+r.descent-c},u={x:i.x+n.x+r.x+d,y:i.y+n.y+r.y-n.descent+r.descent};break;case C.TextDirectionType.EastAsianVer:h={x:i.x+n.x+r.x,y:i.y+n.y+r.y-r.height},u={x:i.x+n.x+r.x+n.width,y:i.y+n.y+r.y},r.isVerticalRotateChar()||n.height>n.width&&(u.y-=r.height-r.width);break;case C.TextDirectionType.Vertical:h={x:i.x+n.x+r.x,y:i.y+n.y+r.y},u={x:i.x+n.x+r.x+n.width,y:i.y+n.y+r.y+r.height};break;case C.TextDirectionType.Vertical270:h={x:i.x+n.x+r.x-r.width,y:i.y+n.y+r.y-r.height},u={x:i.x+n.x+r.x,y:i.y+n.y+r.y};break;case C.TextDirectionType.VerticalWordArtRightToLeft:h={x:i.x+n.x+r.x,y:i.y+n.y+r.y+r.descent},u={x:i.x+n.x+r.x+r.width,y:i.y+n.y+r.y+r.descent+r.height};break;default:return}t[a]=[{begin:h,end:u,lastIndex:o}],t[a].hex=s}},this._updateHighLight=function(e){var t=e.items,i=e.typoPara,n=e.typoLine,r=e.typoGlyph,a=e.nextGlyph,o=e.index,s=e.continuous,l=e.highlightHeight;if(!r.isLineBreak()){var h=n.getVerticalType(),u=t[t.length-1];switch(h){case C.TextDirectionType.Horizontal:if(s)u.end.x=a?Math.max(u.end.x,i.x+n.x+a.x):Math.max(u.end.x,u.end.x+r.width+r.spacing),u.lastIndex=o;else{var c=l||r.descent+r.ascent+.025*r.height,d=Math.max(r.width+r.spacing,0);t.push({begin:{x:i.x+n.x+r.x,y:i.y+n.y+r.y-n.descent+r.descent-c},end:{x:i.x+n.x+r.x+d,y:i.y+n.y+r.y-n.descent+r.descent},lastIndex:o})}break;case C.TextDirectionType.EastAsianVer:if(s){var p=r.height;r.isVerticalRotateChar()||n.height>n.width&&(p=r.width),u.end.y=Math.max(u.end.y,u.end.y+p+r.spacing),u.lastIndex=o}else{var f={x:i.x+n.x+r.x,y:i.y+n.y+r.y-r.height},g={x:i.x+n.x+r.x+n.width,y:i.y+n.y+r.y};r.isVerticalRotateChar()||n.height>n.width&&(g.y-=r.height-r.width),t.push({begin:f,end:g,lastIndex:o})}break;case C.TextDirectionType.Vertical:s?(u.end.y=Math.max(u.end.y,u.end.y+r.height+r.spacing),u.lastIndex=o):t.push({begin:{x:i.x+n.x+r.x,y:i.y+n.y+r.y},end:{x:i.x+n.x+r.x+n.width,y:i.y+n.y+r.y+r.height},lastIndex:o});break;case C.TextDirectionType.Vertical270:s?(u.begin.y=Math.min(u.begin.y,u.begin.y-r.height+r.spacing),u.lastIndex=o):t.push({begin:{x:i.x+n.x+r.x-r.width,y:i.y+n.y+r.y-r.height},end:{x:i.x+n.x+r.x,y:i.y+n.y+r.y},lastIndex:o});break;case C.TextDirectionType.VerticalWordArtRightToLeft:s?(u.end.y=Math.max(u.end.y,u.end.y+r.height+r.spacing),u.lastIndex=o):t.push({begin:{x:i.x+n.x+r.x,y:i.y+n.y+r.y+r.descent},end:{x:i.x+n.x+r.x+r.width,y:i.y+n.y+r.y+r.descent+r.height},lastIndex:o})}}},this._view=new Kh}return o()(e,[{key:"renderBG",value:function(e,t){}},{key:"render",value:function(e,t,i){var n=this,r=e,a=t.getScaleXY(),o=+t.x.toFixed(8),s=+t.y.toFixed(8),l=r.save("text_highlight_bg");if(r.translate(o,s),r.scale(a.x,a.y),t.txt_hlg_node?l.innerHTML=t.txt_hlg_node.innerHTML:this._renderHighlightBg(r,t),t.txt_hlg_node=l,r.restore(),t.findResults&&t.findResults.length){var h=r.save("findHightLight");r.translate(o,s),r.scale(a.x,a.y),t.find_hlg_node?h.innerHTML=t.find_hlg_node.innerHTML:this._renderHighlightRect(r,t),t.find_hlg_node=h,r.restore()}var u=r.save("text_body"),c=t.isDefText();this._view.setSvgNodeAttrs(u,{style:c?"display:none":"",class:c?"e_show_phtxt":""}),r.translate(o,s),r.scale(a.x,a.y);var d=t.txt_node;if(d)return window.domTools.cloneChildNodes(d,u),r.restore(),void(t.txt_node=u);new Hh(t,this.getScale(),i).render(r),t.getChildren().forEach((function(t,r){n._view.render(e,t,i,r)})),r.restore(),t.txt_node=u}},{key:"setScale",value:function(e){this.scale=e,this._view.setScale(e)}},{key:"getScale",value:function(){return this.scale||.1}},{key:"_renderHighlightRect",value:function(e,t){t.findResults&&t.findResults.length&&t.findResults.forEach((function(i){var n=i.lightRect,r=[];n.forEach((function(e){e.forEach((function(e){var i=e.x,n=e.y,a=e.width,o=e.height;r.push(new window.Rect(i-t.x,n-t.y,a,o))}))}));var a=new window.QPainterPath;r.forEach((function(e){return a.addRect(e)})),a.toContextPath(e),e.fillStyle="rgba(244, 109, 67, 0.39)",e.fill("nonzero")}))}},{key:"_renderHighlightBg",value:function(e,t){var i=this,n=t.getChildren();n&&n.length&&n.forEach((function(t,n){var r=t.getTypoTextLines();r&&r.length&&r.forEach((function(r,a){var o={},s=r.getGlyphs();if(!r.hasVisibleChar&&s&&s.length){var l=r.maxHighLightHeight;s.forEach((function(e,n){var a=e.getParent(),h=a.getHightLightColor();if(h)if(o[h]){var u=o[h],c=u[u.length-1],d=s[n+1];i._updateHighLight({items:u,typoPara:t,typoLine:r,typoGlyph:e,nextGlyph:d,index:n,continuous:n-1===c.lastIndex,highlightHeight:l})}else{var p=a.getHightLightHex();i._addHighLight({highlightList:o,typoPara:t,typoLine:r,typoGlyph:e,highlightColor:h,index:n,hex:p,highlightHeight:l})}})),i._drawHighLightBg(e,o,"para"+n+"_line"+a)}}))}))}},{key:"_drawHighLightBg",value:function(e,t,i){Object.entries(t).forEach((function(t){var n=f()(t,2),r=n[0],a=n[1],o=new window.QPainterPath;a.forEach((function(e){var t=e.begin,i=e.end,n=new window.Rect;n.setTopLeft(new window.Point(t.x,t.y)),n.setBottomRight(new window.Point(i.x,i.y)),0===n.width()&&n.setLeft(n.left()-3),o.addRect(n)}));var s=a.hex?a.hex.slice(1):"";e.save(i+"_"+s),e.beginPath(),o.toContextPath(e),e.fillStyle=r,e.fill(),e.restore()}))}}],[{key:"getInstance",value:function(t){return this._instance=this._instance||new e,this._instance.setScale(t),this._instance}}]),e}(),Kh=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._view=new Zh,i._autoNumRender=new Qh,i}return u()(t,e),o()(t,[{key:"drawBgColor",value:function(e,t){this.init(e).initFill(t.getBgColor(),null).fillRect(t)}},{key:"render",value:function(e,t,i,n){var r=e;this.init(r).save("text_paragraph_"+n).initStroke("black").strokeRect(t,Yh);var a=+t.x.toFixed(8),o=+t.y.toFixed(8);r.translate(a,o);for(var s=t.getTypoAutoNum(),l=t.getTypoTextLines(),h=0;h<l.length;h++){var u=l[h];0===h&&s&&this._autoNumRender.render(e,s,u,t.isFocus(),i),this._view.render(e,u,i,h)}this.restore()}},{key:"setScale",value:function(e){this.scale=e,this._view.setScale(e),this._autoNumRender.setScale(e)}}]),t}(Bl),qh=String.fromCharCode(10),Xh=String.fromCharCode(11);function Jh(e){var t="";if(e)for(var i=0;i<e.length;i++){var n=e[i];t+=n===qh||"\t"===n||" "===n||n===Xh?"&nbsp;":"<"===n?"&lt;":">"===n?"&gt;":"&"===n?"&amp;":n}return t}var Zh=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._view=new $h,i}return u()(t,e),o()(t,[{key:"drawBgColor",value:function(e,t){this.init(e).initFill(t.getBgColor(),null).fillRect(t)}},{key:"setScale",value:function(e){this.scale=e,this._view.setScale(e)}},{key:"getScale",value:function(){return this.scale||.1}},{key:"isDifferentSpan",value:function(e,t,i,n){if(!i||!n)return!0;var r=e.getCssStyle(),a=t.getCssStyle();if(!window.sameCmp(r,a))return!0;var o=i.getGradientColor(),s=n.getGradientColor();if(!window.sameCmp(o,s))return!0;var l=i.artTextOutLineFill(),h=n.artTextOutLineFill();return!window.sameCmp(l,h)||i.isFieldType!==n.isFieldType}},{key:"render",value:function(e,t,i,n){var r=this,a=e,o=t.getVerticalType();this.init(a).save("text_line_"+n),a.translate(+t.x.toFixed(8),+t.y.toFixed(8));var s=[],l=[],h=void 0,u=void 0,c=null,d=-2,p=-2,f=void 0,g=void 0,y=void 0,v=void 0,m=[],w=[],S=[],x=void 0,T=!1,k=this.getScale(),b={},E=t.getGlyphs()||[],R=E[0],P=R&&R.x,I=new window.Rect(P,0,t.width-P,t.height);if(E.forEach((function(n,C){var E=window.rightToLeft&&"end",R=window.rightToLeft&&"rtl";if(r._canUseSpanRender(o,n)){var P=n;if(P.isLineBreak())return;if(x||(x=r.createSvgNodeByTag("text",{"writing-mode":"","text-orientation":"","white-space":"pre","text-anchor":E,"text-rendering":"auto","alignment-baseline":"alphabetic",direction:R}),r.svgNode.appendChild(x)),g=P.getParent(),r.isDifferentSpan(P,c,g,y)){if(y)new ql({span:y,lineRect:I,scale:k,preloadSource:i}).render(a,v),new Xl(y,k,I).render(a,v),r.setSvgNodeAttrs(v,{x:m.join(" "),y:w.join(" "),gcps:S.join(" ")}),""!==f&&(v.innerHTML=Jh(f),x&&x.appendChild(v)),m=[],w=[],S=[];var L=P.getTxtStyle();"normal"===L["font-weight"]&&(L["font-weight"]=null),v=r.createSvgNodeByTag("tspan",_()({},L)),f=P.getChar(),y=g}else f+=P.getChar();var A=t.descent;m.push(+P.x.toFixed(8)),w.push(+(P.y-A).toFixed(8)),S.push(P.getGcp()),T=!1}else T=!0,r._view.render(e,n,I,i,t.descent);var B=n.getUnderline(),D=n.getDeleteline(),M=n.getUnderlineFill(),O=void 0,N=void 0,F=void 0,V=void 0,U=void 0,G=n.getParent(),H=new Xl(G,k,I),W=new ql({span:G,lineRect:I,scale:k,preloadSource:i});if(c=c||n,D){var j=b&&b.deleteline;c.getParent()===n.getParent()&&Fl(D,j)?N=b&&b.deleteLineStyle:(W.render(a),H.hasOutLine()&&(H.render(a),F=H.getStyle(),V=H.getDashArr(),U=H.getLineWidth()),N={lineStyle:W.getStyle(),strokeStyle:F,lineDash:V,outLineWidth:U})}if(B||n.needLayoutUnderLine){var Y=b&&b.underline;if(c.getParent()===n.getParent()&&Fl(B,Y))O=b&&b.underLineStyle;else{var z=void 0;!M||M.useTextFill?(W.render(a),z=W.getStyle()):z=M&&M.font&&M.font.color&&M.font.color.rgba||B.lineStyle||"#000000",H.hasOutLine()&&(H.render(a),F=H.getStyle(),V=H.getDashArr(),U=H.getLineWidth()),O={lineStyle:z,strokeStyle:F,lineDash:V,outLineWidth:U}}}b={underline:B,deleteline:D,deleteLineStyle:N,underLineStyle:O};var K=null,q=null;if(c.getParent()!==n.getParent()){if(h&&B){var X=!1;d+1===C&&(n.isLowerPosition!==h.isLowerPosition||r._isDiffUnderLine(O,h)?X=!1:(X=!0,B.lineWidth<h.lineWidth&&(h.lineWidth=B.lineWidth),K=h)),X||(h=null)}u&&D&&(p+1===C&&(q=u),u=null)}if(B||n.needLayoutUnderLine){var J=n.height,Z=n.width,Q=n.isLowerPosition;h?(h.endPos.x=n.x+n.width+n.spacing,h.endPos.y=n.isThaiChar?n.y-t.descent+n.descent/2:n.y-t.descent+n.descent,h.endPos.height=J,h.endPos.width=Z):((h=_()({verticalType:o},B,{prev:K,delt:t.height*Wh,isLowerPosition:Q,onlyLayout:n.needLayoutUnderLine})).startPos={x:n.x,y:n.isThaiChar?n.y-t.descent+n.descent/2:n.y-t.descent+n.descent,height:J,width:Z},h.endPos={x:n.x+n.width+n.spacing,y:n.isThaiChar?n.y-t.descent+n.descent/2:n.y-t.descent+n.descent,height:J,width:Z},r._setLineStyle(h,O),h.typoGlyph=n,s.push(h)),d=C}if(D){var $=n.height,ee=n.width;u?(u.endPos.x=n.x+n.width+n.spacing,u.endPos.y=n.y-t.descent+n.descent,u.endPos.height=$,u.endPos.width=ee):((u=_()({height:$,verticalType:o},D,{prev:q})).startPos={x:n.x,y:n.y-t.descent+n.descent,height:$,width:ee},u.endPos={x:n.x+n.width+n.spacing,y:n.y-t.descent+n.descent,height:$,width:ee},r._setLineStyle(u,N),u.typoGlyph=n,l.push(u)),p=C}T||(c=n)})),s){for(var L=s.length-1;L>=0;L--){var A=s[L];if(!A.onlyLayout){if(!A.isUpdate){var B=A,D=A.lineWidth,M=A.startPos.y;do{B.lineWidth<D&&(D=B.lineWidth),o===C.TextDirectionType.Horizontal&&B.startPos.y>M&&(M=B.startPos.y),B=B.prev}while(B);B=A;do{B.lineWidth=D,o===C.TextDirectionType.Horizontal&&(B.startPos.y=M),B.isUpdate=!0,B=B.prev}while(B)}this.drawUnderLine(e,A)}}t.mUnderLineVector=s}(l.forEach((function(t){r.drawDeleteLine(e,t)})),this.restore(),g)&&(""!==f&&(x&&x.appendChild(v),this.setSvgNodeAttrs(v,{x:m.join(" "),y:w.join(" "),gcps:S.join(" ")}),v.innerHTML=Jh(f),new Xl(g,k,I).render(a,v),new ql({span:g,lineRect:I,scale:k,preloadSource:i}).render(a,v)))}},{key:"_isDiffUnderLine",value:function(e,t){return!(Fl(e.lineStyle,t.lineStyle)&&Fl(e.strokeStyle,t.strokeStyle)&&Fl(e.lineDash,t.lineDash)&&Fl(e.outLineWidth,t.outLineWidth))}},{key:"_canUseSpanRender",value:function(e,t){return e===C.TextDirectionType.Horizontal&&(!(t.getChar().length>1)&&!t.isEmojiFragment)}},{key:"drawDeleteLine",value:function(e,t){var i=t.startPos,n=t.endPos,r=t.lineWidth,a=t.verticalType,o=t.lineStyle,s=t.strokeStyle,l=t.outLineWidth,h=t.lineDash,u=t.height,c=t.strikeThrough;r<1&&(r=1);var d=i,p=n;if(a===C.TextDirectionType.Horizontal){var f=u*jh,g=parseInt(d.y-f);d.y=g,p.y=d.y}else{var y=u*jh,v=parseInt(d.x+y);d.x=v,a===C.TextDirectionType.Vertical270?(d.x-=.6*d.width,p.x=d.x,p.y-=p.height):a===C.TextDirectionType.Vertical?(d.x+=.2*d.width,p.x=d.x,p.y+=p.height):a===C.TextDirectionType.EastAsianVer?(d.x+=.2*d.width,p.x=d.x,d.y-=d.height,p.y-=d.height,p.y+=p.height):(p.x=d.x,p.y+=p.height)}if(e.setLineDash(h),this.init(e).initFill(o).initStroke(s).drawLine(d,p,r,l,1,a),c>1&&(a===C.TextDirectionType.Horizontal?(d.y-=3*r,p.y=d.y):(d.x+=3*r,p.x=d.x),this.init(e).initFill(o).initStroke(s).drawLine(d,p,r,l,1,a)),e.isSvg){var m=e.getCurrentElement();m&&m.setAttribute("class","text_path")}}},{key:"drawUnderLine",value:function(e,t){var i=t.startPos,n=t.endPos,r=t.delt,a=t.lineWidth,o=t.verticalType,s=t.lineStyle,l=t.strokeStyle,h=t.outLineWidth,u=t.lineDash,c=t.underlineType,d=t.underlineType_custom;a<1&&(a=1),r=r||0;var p=i,f=n;if(o===C.TextDirectionType.Horizontal?(p.y+=r,f.y=p.y):o===C.TextDirectionType.Vertical270?(f.x=p.x,f.y-=f.height):o===C.TextDirectionType.Vertical?(f.x=p.x,f.y+=f.height):o===C.TextDirectionType.EastAsianVer?(f.x=p.x,p.y-=p.height,f.y-=p.height,f.y+=f.height):(f.x=p.x,f.y+=f.height),e.setLineDash(u),this.init(e).initFill(s).initStroke(l).drawLine(p,f,a,h,d||c,o),e.isSvg){var g=e.getCurrentElement();g&&g.setAttribute("class","text_path")}}},{key:"_setLineStyle",value:function(e,t){if(t){var i=t.lineStyle,n=t.strokeStyle,r=t.lineDash,a=t.outLineWidth;e.lineStyle=i,e.strokeStyle=n,e.lineDash=r,e.outLineWidth=a}}}]),t}(Bl),Qh=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),o()(t,[{key:"renderBG",value:function(e,t){this.init(e).initFill(t.getBgColor(),null).fillRect(t)}},{key:"render",value:function(e,t,i,n,r){var a=i.isEmptyLine(),o=i.getRect(),s=e,l=t.getRect(),h=Object.assign({},l),u=t.getText(),c=t.getCssStyle(),d=t.getFontColor();if(a){if(!n)return;-1!==d.indexOf("rgba")&&(d=d.substring(0,d.lastIndexOf(","))+",0.5)")}var p=t.getVerticalType(),f=v.userAgent.isIos,g=window.rightToLeft&&"end",y=window.rightToLeft&&"rtl",m=t.getArtTextEffectList();(window.rightToLeft||t.isR2L)&&u.indexOf(".")>-1&&(u="."+u.slice(0,-1)),s.textAlign=window.rightToLeft&&"end";var w="text_autoNum";if(p===C.TextDirectionType.Horizontal){h.y=i.y+i.height-i.descent,this.init(s).save(w);var S=this.createSvgNodeByTag("text",_()({},t.getStyle(),{class:a&&n&&"g_empty_autonum",opacity:a?0:1,"white-space":"pre","text-rendering":"auto","alignment-baseline":"alphabetic","text-anchor":g,direction:y}));this.setSvgNodeAttrs(S,{x:h.x,y:h.y}),S.innerHTML=Jh(u);var x=this.getScale(),T=t.getParent(),k=new window.Rect(o.x,o.y,o.width,o.height),b=new ql({span:T,lineRect:k,scale:x,preloadSource:r}),E=t.getbulletColor();E&&b.setFill({type:C.FillType.FillTypeSolidColor,color:E}),b.render(s,S),new Xl(T,x,k).render(s,S),m.innerShadow||this.svgNode.appendChild(S),this.restore()}else if(p===C.TextDirectionType.VerticalWordArtRightToLeft){var R=Object.assign({},l);f&&(R.x+=.2*R.width),this.init(s).save().initStroke("blue").strokeRect(l,Yh).restore(),R.y+=R.width;for(var P=0;P<u.length;P++)this.save(w).initFill(d,c).drawText(R,u[P],"alphabetic").restore(),R.y+=R.width}else{var I=1,L=0,A=0;p===C.TextDirectionType.Vertical270?(I=3,A+=l.width,L-=.8*l.height,f&&(L-=.4*l.height)):f&&(A-=.4*l.height),this.init(s).save(w).initFill(d,c).initStroke("blue").strokeRect(l,Yh).translate(l.x,l.y).rotate(Math.PI/2*I).initStroke("green").strokeRect({x:L,y:A,width:l.width,height:l.height},Yh).drawText({x:L,y:A},u,"alphabetic").restore()}}},{key:"setScale",value:function(e){this.scale=e}},{key:"getScale",value:function(){return this.scale||.1}}]),t}(Bl),$h=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),o()(t,[{key:"renderBG",value:function(e,t){this.init(e).initFill(t.getBgColor()).fillRect(t)}},{key:"setScale",value:function(e){this.scale=e}},{key:"getScale",value:function(){return this.scale||.1}},{key:"render",value:function(e,t,i,n,r){var a=e,o=Object.assign({},t.getRect()),s=t.getChar(),l=t.getTxtStyle(),h=t.getVerticalType(),u=t.getFontColor();this.init(a).initFill(u);var c=window.rightToLeft&&"end",d=window.rightToLeft&&"rtl",p=this.createSvgNodeByTag("text",{"white-space":"pre","text-rendering":"auto","alignment-baseline":"alphabetic",direction:d});p.innerHTML=Jh(s),"normal"===l["font-weight"]&&(l["font-weight"]=null),this.setSvgNodeAttrs(p,_()({},l,{"dominant-baseline":"alphabetic","text-anchor":c}));var f=this.getScale(),g=new Jl(t,p,f,n),y=t.descent,v=t.getScriptPosition();if(0!==v&&(y*=1-v/100),h===C.TextDirectionType.Horizontal){var m=new window.Rect(t.x,t.y-r,o.width,o.height);this.save("gcp_"+t.getGcp()),g.init({lineRect:i,textRect:m}),g.render(a,this.svgNode),this.restore()}else if(h===C.TextDirectionType.EastAsianVer)if(t.isVerticalRightChar()){var w=o.y-y,S=o.x+o.width/2;this.save("gcp_"+t.getGcp());var x=new window.Rect(S,w,o.width,o.height);g.init({lineRect:i,textRect:x}),g.render(a,this.svgNode),this.restore()}else if(t.isVerticalTopRightCornerChar()){var T=o.y-o.height/2,k=o.x+o.width/2;this.save("gcp_"+t.getGcp());var b=new window.Rect(k,T,o.height,o.width);g.init({lineRect:i,textRect:b}),g.render(a,this.svgNode),this.restore()}else if(t.isVerticalRotateChar()){o.x+=y,this.save("gcp_"+t.getGcp()).translate(o.x,o.y-o.height).rotate(Math.PI/2).translate(-o.x,-o.y+o.height);var E=new window.Rect(o.x,o.y-o.height,o.height,o.width);g.init({lineRect:i,textRect:E,rotate:90}),g.render(a,this.svgNode),this.restore()}else{o.y-=y+(t.height-t.width)/2,v<0?(o.x+=.3*o.width,o.x+=y):v>0&&(o.x+=y),this.save("gcp_"+t.getGcp());var R=new window.Rect(o.x,o.y,o.width,o.height);g.init({lineRect:i,textRect:R,rotate:90,verticalType:Ul}),g.render(a,this.svgNode),this.restore()}else if(h===C.TextDirectionType.Vertical){o.x+=y,this.save("gcp_"+t.getGcp()).translate(o.x,o.y).rotate(Math.PI/2).translate(-o.x,-o.y);var P=new window.Rect(o.x,o.y,o.height,o.width);g.init({lineRect:i,textRect:P,rotate:90}),g.render(a,this.svgNode),this.restore()}else if(h===C.TextDirectionType.Vertical270){o.x-=y,this.save("gcp_"+t.getGcp()).translate(o.x,o.y).rotate(Math.PI/2*3).translate(-o.x,-o.y);var I=new window.Rect(o.x,o.y,o.height,o.width);g.init({lineRect:i,textRect:I,rotate:270}),g.render(a,this.svgNode),this.restore()}else if(h===C.TextDirectionType.VerticalWordArtRightToLeft){(o=Object.assign({},o)).y+=o.height,this.save("gcp_"+t.getGcp());var L=new window.Rect(o.x,o.y,o.width,o.height);g.init({lineRect:i,textRect:L,verticalType:Vl}),g.render(a,this.svgNode),this.restore()}}}]),t}(Bl),eu=function(e){function t(e,i){r()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._textbodyRender=zh.getInstance(i),n}return u()(t,e),o()(t,[{key:"render",value:function(e,t,i){var n=t.typodata,r=n.overflowLeft,a=n.overflowTop;r<0&&(n.x+=r),a<0&&(n.y+=a);var o=n;o&&this._textbodyRender.render(e,o,i),this.restore()}}]),t}(Bl),tu=function(){function e(t,i){r()(this,e),this.mTypoTextBodys=t&&t.typoTextBodys||[],this.m_table=t&&t.tableVisual||new ns(t),this.preloadSource=i}return o()(e,[{key:"render",value:function(e){if(this.hasEffects()){var t=new Vs.default;this._context=t.getContext("2d"),this.createOriginCanvas()}else this._context=e;this._context.save(),this.scale(this._context);var i=this.m_table.getTableOffSet();this._context.translate(-i.x()*this.getScale(),-i.y()*this.getScale()),this.addTableLayer(),this.addCellLayer(),this._context.translate(i.x()*this.getScale(),i.y()*this.getScale()),this.hasEffects()&&(this.addInnerShadowLayer(),this.addOuterShadowLayer(e),this.addReflectionLayer(e),e.save(),e.drawImage(this._context,0,0),e.restore()),this._context.restore(),this.orginlCtx&&this.orginlCtx.canvas._canvasPoolItem.release()}},{key:"addTableLayer",value:function(){this._context.save();var e=new iu(this.m_table);e.render(this._context,this.preloadSource),this.orginlCtx&&e.render(this.orginlCtx),this._context.restore()}},{key:"addCellLayer",value:function(){var e=this.cellEnum;if(!e){var t=new Ko(0,this.m_table.getRowCount(),0,this.m_table.getColCount());e=this.m_table.createCellEnum(t)}var i=new dl,n=Date.now();if(e&&e.length>0)for(var r=e.length,a=0;a<r;a++){var o=e[a];i.addCell(o)}console.log("table cellLayer",Date.now()-n),this.cellRender(i)}},{key:"cellRender",value:function(e){var t=this;this._context.save("table_fill");var i=e.m_cellBacks,n=[];n.push.apply(n,S()(e.m_cellBorders)),n.push.apply(n,S()(e.m_cellHypotenuse));for(var r=function(e,t,i,n){if(e.render(t)&&i){t.fillStyle=t.fillGradinet&&t.fillGradinet.fillStyle||t.fillStyle,delete t.fillGradinet;var r=n.offX,a=n.offY;t.translate(r,a),t.beginPath(),i.toContextPath(t),t.fill("evenodd"),t.translate(-r,-a)}},a=0,o=i.length;a<o;a++){var s=i[a],l=s.m_fill,h=s.m_fillPaths,u=s.m_layout;u.scale=this.getScale();var c=new ol({fill:l,path:h,layout:u,preloadSource:this.preloadSource}),d=s.m_pCell.getIndex();this._context.save(C.PartOfShapeName.TableCell(d)),r(c,this._context,h.path,u),this._context.restore(),this.orginlCtx&&r(c,this.orginlCtx,h.path,u)}this._context.restore(),this._context.save("table_border");for(var p=function(e,t,i,n){t.save(),t.beginPath(),e.render(t)&&(i?(i.toContextPath(t),t.fill("evenodd")):n&&(n.toContextPath(t),t.stroke())),t.restore()},f=0,g=n.length;f<g;f++){var y=n[f],v=y.getPath(),m=y.getOutline(),_=y.getOutlineLayout(),w=m.fill;if(w&&w.type!==Be.e.FillTypeNone){var x=new sl({outline:m,path:v,layout:_,scale:this.getScale()});p(x,this._context,v.strokerPath,v.painterPath),this.orginlCtx&&p(x,this.orginlCtx,v.strokerPath,v.painterPath)}}this._context.restore();var T=this._context;T.save("table_text");for(var k=0,b=this.mTypoTextBodys.length;k<b;k++){this.cellTextRender=this.cellTextRender||new eu({},this.getScale());var E=this.mTypoTextBodys[k];E&&function(){var e=E.cellVisual.getRect();E.isSetTableXY||(E.x+=e.x,E.y+=e.y),E.isSetTableXY=!0;var i=E.cellVisual.getIndex(),n=t.m_table.getTable();n.findResults&&(E.findResults=n.findResults.filter((function(e){return e.cellIndex===i}))),T.save(C.PartOfShapeName.TableText(i)),t.cellTextRender.render(T,{typodata:E,rect:e},t.preloadSource),T.restore()}()}T.restore()}},{key:"scale",value:function(e){var t=this.m_table.getTableOffSet();e.translate(t.x()*this.getScale(),t.y()*this.getScale())}},{key:"createOriginCanvas",value:function(){var e=this.getScale(),t=Fs(this.m_table.getTableEffectsRect().width()*e+10,this.m_table.getTableEffectsRect().height()*e+10).getElem();this.orginlCtx=t.getContext("2d");var i=this.m_table.getTableOffSet();this.orginlCtx.translate(-i.x()*this.getScale(),-i.y()*this.getScale())}},{key:"getScale",value:function(){return this.m_table.getScale()||1}},{key:"hasReflection",value:function(){var e=this.m_table.getEffects();return!(!e||!e.reflection)}},{key:"hasEffects",value:function(){var e=this.m_table.getEffects();return!(!e||!e.reflection&&!e.outerShadow)}},{key:"addInnerShadowLayer",value:function(){}},{key:"addOuterShadowLayer",value:function(e){var t=this.m_table.getEffects().outerShadow;if(t&&this.orginlCtx){e.save();var i=this.getScale();this.scale(e);var n=this.m_table.getTableEffectsRect().width()*i,r=this.m_table.getTableEffectsRect().height()*i,a=this.m_table.getTableGraphic().getWidth(),o=this.m_table.getTableGraphic().getHeight(),s=this.m_table.getTableOffSet(),l=new window.Rect(-1,-1,a+2,o+2),h=new Lh(t,l,null,i).render(this.orginlCtx.canvas,n,r,-s.x()*i,-s.y()*i);if(e.drawImage(h,0,0),this.hasReflection()){var u=this.orginlCtx.canvas.width,c=this.orginlCtx.canvas.height,d=Fs(u,c).getElem().getContext("2d");d.drawImage(h,0,0,u,c),d.drawImage(this.orginlCtx.canvas,0,0,u,c),this.orginlCtx&&this.orginlCtx.canvas._canvasPoolItem.release(),this.orginlCtx=d}h._canvasPoolItem.release(),e.restore()}}},{key:"addReflectionLayer",value:function(e){var t=this.m_table.getEffects();if(t&&t.reflection){var i=t.reflection;e.save();var n=this.getScale(),r=this.m_table.getTableGraphic().getWidth(),a=this.m_table.getTableGraphic().getHeight(),o=new window.Rect(-1,-1,r+2,a+2),s=this.m_table._table.reflectionRect,l=new window.Rect(s.x()*n,s.y()*n,s.width()*n,s.height()*n),h=new Nh(i,o,n,l),u=h.render(this.orginlCtx,Math.round(l.width()),Math.round(l.height())),c=h.reflectionOff;this.scale(e),e.drawImage(u,0,c),u._canvasPoolItem.release(),e.restore()}}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),iu=function(){function e(t){r()(this,e),this.m_table=t}return o()(e,[{key:"render",value:function(e,t){e.save();var i=this.getFill();if(i){this.getPath();var n=this.m_fillPaths,r=this.m_layout;new ol({fill:i,path:n,layout:r,preloadSource:t}).render(e)&&n.path&&(n.path.toContextPath(e),e.fill("evenodd"))}e.restore()}},{key:"getFill",value:function(){return this.m_table.getTableGraphic().getFill()}},{key:"getPath",value:function(){var e=new us.a;e.hasStroke=!1;var t=new window.QPainterPath;t.addRect(this.rect()),this.m_fillPaths={attributes:e,path:t},this.addFillLayout(this.rect(),0,0)}},{key:"rect",value:function(){var e=this.m_table.getTableGraphic().getWidth(),t=this.m_table.getTableGraphic().getHeight();return new window.Rect(0,0,e,t)}},{key:"addFillLayout",value:function(e,t,i){var n={drawRect:{width:e.width(),height:e.height(),x:t,y:i,fillOff:!0,rotation:0},offX:0,offY:0,scale:1,fillOff:!0};this.m_layout=n}}]),e}(),nu=i(268),ru=i(388),au=function(){function e(t,i,n,a){r()(this,e),ou.call(this),this._data=t,this.visible=i||{},this.transform2D=n,this.m_table=new ns(t),this._shape=a,this.wppColorManager=window.APP&&window.APP.wppColorManager}return o()(e,[{key:"update",value:function(e){this._data=e}},{key:"measure",value:function(e){var t=this.measureTablecell(e);return this.measureTableShadow(t.tableBounds),e&&(e.length=0),t}},{key:"isExceedTablecell",value:function(e,t){if(!e||!this.oldTableLayout||t!==C.UpdatePartOfShape.UpdateText)return this.m_table=new ns(this._data),!1;var i=this.m_table.getCellFromIndex(e),n=this._data.childs.find((function(t){return t.idx===e})),r=n.textBody,a=i.getTiRect(),o=new Yo({data:r});o.setAutoFit(C.AutoFit.None),o.setWrapText(1),this.typoTextBodyLayouter=vo.getInstance(),this.typoTextBodyLayouter.update(o),this.typoTextBodyLayouter.measure({rect:{x:0,y:0,width:a.width,height:a.height}}),0!==o.overflowLeft&&(o.x+=o.overflowLeft,o.overflowLeft=0),o.overflowTop=0,o.cellIndex=i.getIndex(),o.rect=i.getTiRect();var s=this.oldTableLayout.typoTextBodys.find((function(t){return t.cellIndex===e})),l=Math.round(o.y+o.height+o.getMargin().bottom),h=Math.round(s.y+s.height+s.getMargin().bottom-a.y);if(Math.round(a.height)!==l&&l!==h)return this.m_table=new ns(this._data),console.log("update table",h,l),!1;o.cellVisual=this.m_table.updateCell(e,n,t);for(var u=0,c=this.oldTableLayout.typoTextBodys.length;u<c;u++)if(this.oldTableLayout.typoTextBodys[u].cellIndex===e){this.oldTableLayout.typoTextBodys[u]=o;break}return console.log("update cell",h,l),!0}},{key:"measureTablecell",value:function(e){var t=this,i=[],n=new Ko(0,this.m_table.getRowCount(),0,this.m_table.getColCount());i.push.apply(i,S()(this.m_table.createCellEnum(n)));var r={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},a=void 0,o=[],s=i.length,l=this.getScale();if(i&&i.length>0){this.typoTextBodyLayouter=vo.getInstance();var h=new Map;e instanceof Array&&e.forEach((function(e){h[e.getToken()]=e}));var u=function(e){for(var n=[],r=0;r<s;r++){var a=i[r];if(t.wppColorManager&&!e){var u=a.getFill();u&&u.color&&u.color.hex&&t.wppColorManager.addFillColor(u.color.hex,t._shape);var c=a.getBorder()||{};for(var d in c)if(c.hasOwnProperty(d)){var p=c[d];p&&p.fill&&p.fill.color&&t.wppColorManager.addLineColor(p.fill.color.hex,t._shape)}}var f=a._cell.textBody,g=a.getRect();if(!e||!window.sameCmp(g,o[r].rect)){var y=e?o[r]:h[f.data_token],v=y&&y.getVerticalType();if(y&&v===C.TextDirectionType.Horizontal&&g.width===y.rect.width&&y.sameData(f)){y.isSetTableXY=!1;var m=y.getMargin(),_=g.height-(m.top+m.bottom),w=g.width-(m.left+m.right);t.typoTextBodyLayouter.update(y);var S=t.typoTextBodyLayouter.getVerticalDeltXY({height:_,width:w},y.realRect);y.y=m.top,S.y>0&&(y.y+=S.y),y.x=m.left,S.x>0&&(y.x+=S.x)}else(y=new Yo({data:f})).setAutoFit(C.AutoFit.None),y.setWrapText(1),t.typoTextBodyLayouter.update(y),t.typoTextBodyLayouter.measure({rect:{x:0,y:0,width:g.width,height:g.height}}),0!==y.overflowLeft&&(y.x+=y.overflowLeft,y.overflowLeft=0),y.overflowTop>0&&(y.y+=y.overflowTop),y.overflowTop=0;y.cellIndex=a.getIndex(),o.splice(r,1,y);var x=a.getRange(),T=x.rowEnd,k=x.rowBegin,b=y.getMargin(),E=y.y+y.height+b.bottom;n.push({rowBegin:k,rowEnd:T,newHeight:E/l}),t.m_table.getTableGraphic().updateMixHoriBordersPos(k,T,(b.top+y.height+b.bottom)/l),y.cellVisual=a,y.rect=a.getRect()}}return n},c=this.m_table.getTableGraphic(),d=[].concat(c.getHoriBorderPos());u().forEach((function(e){var t=e.rowBegin,i=e.rowEnd,n=e.newHeight,r=(d[i]-d[t])/635,a=r>n?r:n;c.updateHoriBordersPos(t,i,a)})),u(!0);var p=this.m_table.getTableGraphic().getWidth()/l,f=this.m_table.getTableGraphic().getHeight()/l;r.l=0,r.t=0,r.r=0+p,r.b=0+f,r.width=p,r.height=f}a=this.m_table.getMixHeight()/635*l,Math.abs(a-r.height*l)<1&&(a=r.height*l);var g=new window.Rect(r.l,r.t,r.r-r.l,r.b-r.t);return{tableBounds:r,typoTextBodys:o,tableVisual:this.m_table,boundRect:g,mixTableHieght:a}}},{key:"measureTableShadow",value:function(e){var t=this.m_table.getEffects();if(t&&e){var i=t.outerShadow,n=t.reflection,r=Object(nu.a)(e),a=new window.Rect(e.l,e.t,e.r-e.l,e.b-e.t);e.boundRect=a;var o=new window.Rect;if(i)o=new Lh(i,a,null,1).measure();if(e.outerShadowBoundRect=o,lu([o],r),n){var s=new window.Rect(r.l,r.t,r.r-r.l,r.b-r.t);e.reflectionRect=s;var l=new Nh(n,a,1,s).measure();e.destReflectionRect=l,lu([l],r)}e.effectsRect=new window.Rect(r.l,r.t,r.r-r.l,r.b-r.t)}}},{key:"getScale",value:function(){return this.m_table.getScale()||1}},{key:"measureTable",value:function(){return new tu(this._data).measure()}},{key:"hitTest",value:function(e){var t=this._data,i=Object.assign({},e);i.x=i.x||0,i.y=i.y||0;var n=t.typoTextBodys;return this.hitestTable(n,i,this.hitestTextBody.bind(this))}},{key:"hitestTextBody",value:function(e,t){this.typoTextBodyLayouter.update(e);var i=this.typoTextBodyLayouter.hitTest(t);return i&&(i.type=i.type||C.CursorType.TableCell),i}},{key:"hitestTable",value:function(e,t,i){for(var n=0;n<e.length;n++){var r=e[n];if(r){var a=r.cellVisual,o=new Ja(a.getRect());if(o.pointInRect(t.x,t.y)){if(r.x>t.x&&(t.x=r.x),r.x+r.width<t.x&&(t.x=r.x+r.width),r.y>t.y&&(t.y=r.y),r.y+r.height<t.y){var s=r.height<144?144:0;t.y=r.y+r.height-s}var l=i(r,t);return r.selectIndex=n,l?(l.cell={typodata:r,index:a.getIndex(),range:a.getRange()},l.type=C.CursorType.CellText,l):{cell:{typodata:r,index:a.getIndex(),range:a.getRange()},type:C.CursorType.TableCell}}var h=a._tableGraphic,u=h.getWidth(),c=h.getHeight();if(t.x>4&&t.x<u-4&&t.y>4&&t.y<c-4){var d=o.pointOnBorder(t.x,t.y);if("left"===d||"right"===d)return{type:C.CursorType.TableBorderVert,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}};if("top"===d||"bottom"===d)return{type:C.CursorType.TableBorderHori,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}}}if("arrowtop"===o.pointOnTop(t.x,t.y,c))return{type:C.CursorType.TableTop,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}};if("arrowbottom"===o.pointOnTop(t.x,t.y,c))return{type:C.CursorType.TableBottom,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}};if("selectShape"===o.pointOnTop(t.x,t.y,c)||"selectShape"===o.pointOnLeft(t.x,t.y,u))return{type:C.CursorType.Table,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}};if("arrowLeft"===o.pointOnLeft(t.x,t.y,u))return{type:C.CursorType.TableLeft,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}};if("arrowRight"===o.pointOnLeft(t.x,t.y,u))return{type:C.CursorType.TableRight,cell:{typodata:r,index:a.getIndex(),range:a.getRange()}}}}return{type:C.CursorType.Table}}},{key:"getSelectCell",value:function(e){var t=this._data;t.selectIndex=e;for(var i=t.typoTextBodys,n=0;n<i.length;n++)if(i[n].cellIndex===e)return i[n];return null}},{key:"getCellRectByIndex",value:function(e){var t=this.m_table.getCellFromIndex(e);return t&&t.rect()}},{key:"getCellRectByIdx",value:function(e){var t=this.m_table.getCellFromIdx(e);return t&&t.rect()}},{key:"getCellRangeByIdx",value:function(e){var t=this.m_table.getCellFromIdx(e);return t&&t.getRange()}},{key:"getSelectRectByGcp",value:function(e,t,i,n){return this.typoTextBodyLayouter&&this.typoTextBodyLayouter.update(this.getSelectCell(i)).getSelectRectByGcp(e,t,n)}},{key:"getNextGcpByDirectionKeys",value:function(e,t,i){return this.typoTextBodyLayouter&&this.typoTextBodyLayouter.update(this.getSelectCell(i)).getNextGcpByDirectionKeys(e,t)}},{key:"getSelectStyleByRange",value:function(e,t,i){return this.typoTextBodyLayouter&&this.typoTextBodyLayouter.update(this.getSelectCell(i)).getSelectStyleByRange(e,t,i)}},{key:"destroy",value:function(){delete this._data,delete this.visible,delete this.transform2D,delete this.m_table,delete this._shape,delete this.wppColorManager}}]),e}(),ou=function(){var e=this;this.isChangeCellIndex=function(t,i,n){if(void 0!==n){var r=e.typoTextBodyLayouter&&e.typoTextBodyLayouter.update(e.getSelectCell(n)),a=r&&r._data&&r._data.getAllTextLinesCcp(),o=e.getCellRangeByIdx(n),s=e.m_table.getColCount(),l=e.m_table.getRowCount();switch(i){case ru.a.LEFT:if(0===t&&(0!==o.rowBegin||0!==o.colBegin))return!0;break;case ru.a.RIGHT:if(a&&t===a[a.length-1].ccp&&(o.colEnd!==s||o.rowEnd!==l))return!0;break;case ru.a.UP:if(a&&t>=a[0].begin&&t<=a[0].ccp&&(0!==o.rowBegin||0!==o.colBegin))return!0;break;case ru.a.DOWN:if(a&&t>=a[a.length-1].begin&&t<=a[a.length-1].ccp&&(o.colEnd!==s||o.rowEnd!==l))return!0;break;default:return!1}}}},su=au;function lu(e,t){var i=window.Rect;e.forEach((function(e){e instanceof i&&e.left()<t.l&&(t.l=e.left()),e instanceof i&&e.right()>t.r&&(t.r=e.right()),e instanceof i&&e.top()<t.t&&(t.t=e.top()),e instanceof i&&e.bottom()>t.b&&(t.b=e.bottom())})),t.width=t.r-t.l,t.height=t.b-t.t}var hu=function(){function e(t){var i=t.drawRect,n=t.geometry2D,a=t.extParam,o=t.lineWidth,s=t.shapeData;r()(this,e),this._drawRect=Object.assign({},i),this._geometry2D=n,this._scale=a.scale,this._lineWidth=void 0!==o?o:0,this._outLine=a.outline||{},this._shapeData=s,this._effects=a.effects,this._shape3d=a.shape3d,this._scene3d=a.scene3d,this._fill=a.fill,this.isComplexEffect=!(!this.hasEffect()&&!this.has3D())}return o()(e,[{key:"measure",value:function(){var e=this.getScale();this.setDrawRectScale(e);var t=this.getDrawRect(),i=t.width,n=t.height;if(!(0===i&&0===n||i<0||n<0)){var r=this.getGeometry2D().interpretPath(i,n),a=this.getGeometryType(),o=!!this.getShapeData().getProperty().picture&&this.getShapeData().getProperty().picture,s=this.measureLine(r,o);this.calcMatrix(r,s);var l=new window.Rect(s.l,s.t,s.width,s.height);r.srcBoundRect=l.clone();var h=this.measureShadow(r,l);h&&(r.shadowRect=h,cu(h,s));var u=this.measureReflection(r,l,h);u&&cu(u,s);var c=new window.Rect(s.l,s.t,s.width,s.height),d=this.getDrawRect(),p=d.x,f=d.y;p=this.getDrawRect().x+s.l,f=this.getDrawRect().y+s.t,p/=e,f/=e;var g=s.l<0?g=Math.abs(s.l)/e:0,y=s.t<0?y=Math.abs(s.t)/e:0;this._lineWidth<0&&(g=0,y=0);var v=r.originBoundRect,m=bh.b/e,_=new window.Rect(v.x()/e,v.y()/e,v.width()/e,v.height()/e);return _.adjust(-m,-m,m,m),{paths:r,geomertyBoundRect:_,x:p,y:f,drawRect:this.getDrawRect(),scale:e,shapeType:a,offX:g,offY:y,shapeRealyRect:c}}}},{key:"measureLine",value:function(e,t){if(e){var i=this._initBounds();this.isComplexStroke=!1,this.needStroke=!1;for(var n=0;n<e.length;n++){var r=this.getOutLine(),a=e[n].attributes,o=r&&r.fill&&r.fill.type;if((!a.hasOwnProperty("stroke")||a.stroke)&&(o||this.has3D())||t){this.needStroke=!0;var s=new sl,l=this.isComplexEffect,h=s.measureOutLine(e[n],r,this.getScale(),l,t);if(!h||!h.isQPainterPath)continue;cu(h.boundingRect(),e[n].bounds),h!==e[n].painterPath&&(this.isComplexStroke=!0),h.isEmpty()||(e[n].strokerPath=h),uu(i,e[n].bounds)}else uu(i,e[n].bounds)}if(i.r!==i.l&&i.b!==i.t||(i.l=0,i.r=this.getDrawRect().width,i.t=0,i.b=this.getDrawRect().height),!this.isComplexStroke||this.isComplexEffect){var u=this.getLineWidth()/2;i.l-=u,i.t-=u,i.r+=u,i.b+=u,uu(i,{l:-u,t:-u,r:this.getDrawRect().width+u,b:this.getDrawRect().height+u})}return e.originBoundRect=new window.Rect(i.l,i.t,i.width,i.height),i}}},{key:"measureShadow",value:function(e,t){if(Math.abs(t.width())!==1/0&&Math.abs(t.height())!==1/0&&this.hasEffect()&&e){var i=this.getEffects(),n=i.outerShadow,r=i.presetShadow,a=i.glow,o=n||r,s=t;if(a){var l=new Uh(a,t,this.getScale(),this.getLineWidth());s=l.measure(),e.glowEffect=l}var h=void 0;if(o){h=new Lh(o,t,[],this.getScale()).measure()}return s=function(e){for(var t={l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY},i=e.length,n=0;n<i;n++){var r=e[n];r&&r.isQRect&&(r.left()<t.l&&(t.l=r.left()),r.right()>t.r&&(t.r=r.right()),r.top()<t.t&&(t.t=r.top()),r.bottom()>t.b&&(t.b=r.bottom()))}return t.width=t.r-t.l,t.height=t.b-t.t,new window.Rect(t.l,t.t,t.width,t.height)}([s,h])}}},{key:"measureReflection",value:function(e,t,i){if(Math.abs(t.width())!==1/0&&Math.abs(t.height())!==1/0&&this.hasEffect()&&e){var n=this.getEffects().reflection;if(n)return e.reflectionRect=function(e,t){var i=e.left(),n=e.right(),r=e.top(),a=e.bottom();i>t.left()&&(i=t.left());n<t.right()&&(n=t.right());r>t.top()&&(r=t.top());a<t.bottom()&&(a=t.bottom());var o=n-i,s=a-r;return new window.Rect(i,r,o,s)}(i,t),new Nh(n,t,this.getScale(),e.reflectionRect).measure()}}},{key:"getNormalAngel",value:function(e){var t=e;return t<0&&(t+=360),Math.round(t)%360}},{key:"calcMatrix",value:function(e){var t=new window.Point(0+this.getDrawRect().width/2,0+this.getDrawRect().height/2),i=void 0,n=this.getNormalAngel(this.getRotation());i=new window.QMatrix(1,0,0,1,0,0);var r=this.getDrawRect(),a=r.overflowLeft,o=r.overflowTop;i.translate(isNaN(a)?0:a,isNaN(o)?0:o);var s=new window.QMatrix(1,0,0,1,0,0),l=this.getHorizontalFlipped(),h=this.getVerticalFlipped();i.translate(t.x(),t.y()),i.rotate(n),i.scale(l?-1:1,h?-1:1),i.translate(-t.x(),-t.y()),e.matrix=i,s.translate(t.x(),t.y()),s.rotate(-n),s.scale(l?-1:1,h?-1:1),s.translate(-t.x(),-t.y()),e.resetMatrix=s,e.isComplexStroke=this.isComplexStroke}},{key:"getScale",value:function(){return this._scale}},{key:"getEffects",value:function(){return this._effects}},{key:"hasEffect",value:function(){var e=this.getEffects();return e&&Object.keys(e).length>0}},{key:"has3D",value:function(){return this._scene3d&&Object.keys(this._scene3d).length>0||this._shape3d&&Object.keys(this._shape3d).length>0}},{key:"getFill",value:function(){return this._fill}},{key:"getShapeData",value:function(){return this._shapeData}},{key:"getRotation",value:function(){return this._drawRect.rotation||0}},{key:"getHorizontalFlipped",value:function(){return this._drawRect.horizontalFlipped}},{key:"getVerticalFlipped",value:function(){return this._drawRect.verticalFlipped}},{key:"getLineWidth",value:function(){return this._lineWidth>0&&this._lineWidth<1?1:Math.round(this._lineWidth)}},{key:"getDrawRect",value:function(){return this._drawRect}},{key:"setDrawRect",value:function(e,t,i,n){this._drawRect.x=e,this._drawRect.y=t,this._drawRect.width=i,this._drawRect.height=n}},{key:"setDrawRectScale",value:function(e){}},{key:"getGeometry2D",value:function(){return this._geometry2D}},{key:"getGeometryType",value:function(){return this._geometry2D?this._geometry2D.geometry.geometryType:null}},{key:"getOutLine",value:function(){return this._outLine}},{key:"_initBounds",value:function(){return{l:Number.POSITIVE_INFINITY,t:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,width:Number.NEGATIVE_INFINITY,height:Number.NEGATIVE_INFINITY}}}]),e}();function uu(e,t){e.l>=t.l&&(e.l=t.l),e.r<=t.r&&(e.r=t.r),e.t>=t.t&&(e.t=t.t),e.b<=t.b&&(e.b=t.b),e.width=e.r-e.l,e.height=e.b-e.t}function cu(e,t){e.isQRect&&e.left()<t.l&&(t.l=e.left()),e.isQRect&&e.right()>t.r&&(t.r=e.right()),e.isQRect&&e.top()<t.t&&(t.t=e.top()),e.isQRect&&e.bottom()>t.b&&(t.b=e.bottom()),t.width=t.r-t.l,t.height=t.b-t.t}var du=i(1284),pu=i(2240),fu=function(){function e(){r()(this,e),this.pathList=[],this.maxWidth=Number.POSITIVE_INFINITY,this.maxHeight=Number.POSITIVE_INFINITY}return o()(e,[{key:"beginNewPath",value:function(e){this.attributes=e,this.previous={x:0,y:0},this.painterPath=new window.QPainterPath}},{key:"endPath",value:function(){var e=this.painterPath.boundingRect();this.bounds={l:e.left(),t:e.top(),r:e.right(),b:e.bottom()},this.pathList.push({attributes:this.attributes,bounds:this.bounds,painterPath:this.painterPath})}},{key:"moveTo",value:function(e,t){this.previous.x=e,this.previous.y=t,this.painterPath.moveTo(new window.Point(e,t))}},{key:"lineTo",value:function(e,t){gu(this.previous.x-e)&&gu(this.previous.y-t)||(this.previous.x=e,this.previous.y=t,this.painterPath.lineTo(new window.Point(e,t)))}},{key:"arcTo",value:function(e,t,i,n,r,a){this.previous=function(e){e.result;var t=e.previous,i=e.widthRadius,n=e.heightRadius,r=e.startAngle,a=e.swingAngle,o=e.scaleW,s=e.scaleH,l=(e.pathCache,e.bounds,e.painterPath),h=function(e,t,i,n){var r=e,a=t;(r-=360*Math.floor(r/360))<0&&(r+=360);e=yu(r,i,n);var o=r+a,s=Math.floor(o/360),l=1;(o-=360*s)<0&&(o=-o,l=-1);return o=l*yu(o,i,n),[e,t=(o+=360*s)-e]}(r=360-r,a=-a,i/o,n/s),u=f()(h,2);r=u[0],a=(a=u[1])<.5&&a>=0?.5:a;var c=function(e,t,i){for(var n=[],r=0;r<15;r++)n[r]=new window.Point;var a=Object(pu.a)(e,t,i,n,0),o=f()(a,2),s=o[0],l=o[1],h=[],u={type:bh.d.LineTo,parameter:[s.x(),s.y()]};h.push(u);for(var c=0;c<l;c+=3){var d={type:bh.d.CubicBezierTo,parameter:[n[c].x(),n[c].y(),n[c+1].x(),n[c+1].y(),n[c+2].x(),n[c+2].y()]};h.push(d)}return h}(new window.Rect(0,0,2*i,2*n),r,a),d=window.Point;if(0===c.length)return;for(var p=new window.Point(c[0].parameter[0],c[0].parameter[1]),g=d["-"](t,p),y={},v=1;v<c.length;v++){var m=c[v],_=m.parameter;if(m.type===bh.d.CubicBezierTo){var w=new window.Point(_[0],_[1]),S=new window.Point(_[2],_[3]),x=new window.Point(_[4],_[5]),T=d["+"](g,w),k=d["+"](g,S),C=d["+"](g,x);y.x=C.x(),y.y=C.y(),l&&l.cubicTo(T,k,C)}}return y}({previous:new window.Point(this.previous.x,this.previous.y),widthRadius:e,heightRadius:t,startAngle:i,swingAngle:n,scaleW:r,scaleH:a,painterPath:this.painterPath})}},{key:"quadraticBezierTo",value:function(e,t,i,n){this.painterPath.quadTo(new window.Point(e,t),new window.Point(i,n)),this.previous.x=i,this.previous.y=n}},{key:"cubicBezierTo",value:function(e,t,i,n,r,a){this.painterPath.cubicTo(new window.Point(e,t),new window.Point(i,n),new window.Point(r,a)),this.previous.x=r,this.previous.y=a}},{key:"closeCurrentpath",value:function(){this.painterPath.closeSubpath(),this.attributes.isClosePath=!0}},{key:"calcPathBounds",value:function(e,t){e<this.bounds.l&&(this.bounds.l=e),e>this.bounds.r&&(this.bounds.r=e),t<this.bounds.t&&(this.bounds.t=t),t>this.bounds.b&&(this.bounds.b=t)}}]),e}();function gu(e){return Math.abs(e)<=1e-12}function yu(e,t,i){if(gu(e-90)||gu(e-270)||gu(i))return e;var n=Math.PI,r=void 0;return r=Math.atan(Math.tan(e/180*n)*t/i),r*=180/n,e>90&&e<270?r+=180:e>270&&(r+=360),r}var vu=i(1711),mu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.m_width=t.width,this.m_height=t.height,this.m_widthUnit=t.widthUnit,this.m_heightUnit=t.heightUnit,this.m_color=t.color,this.m_tip=t.tip,this.m_rasterOp=t.rasterOp,this.m_antiAliased=t.antiAliase,this.m_fitToCurve=t.fitToCurve,this.m_ignorePressure=this.ignorePressure}return o()(e,[{key:"getTip",value:function(){return this.m_tip}},{key:"fitToCurve",value:function(){return this.m_fitToCurve}},{key:"antiAliased",value:function(){return this.m_antiAliased}},{key:"getWidthBy",value:function(e){return Ru(this.m_widthUnit,e)*this.m_width}},{key:"getHeightBy",value:function(e){return Ru(this.m_heightUnit,e)*this.m_height}},{key:"getColor",value:function(){return this.m_color&&this.m_color.rgba?this.m_color:{rgba:"rgba(255,0,0,1)"}}}]),e}(),_u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.m_traceFormat=new wu(t.traceFormat),this.m_timeStamp=t.timeStamp}return o()(e,[{key:"getTraceFormat",value:function(){return this.m_traceFormat}},{key:"getTimeStamp",value:function(){return this.m_timeStamp}}]),e}(),wu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.m_channelX=t.channelX,this.m_channelY=t.channelY}return o()(e,[{key:"getChannelX",value:function(){return this.m_channelX}},{key:"getChannelY",value:function(){return this.m_channelY}}]),e}(),Su=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.m_brushRef=t.brushRef,this.m_vecPoints=t.vecPoints,this.m_vecTime=t.vecTime,this.timeStamp=t.timestamp,this.m_vecForce=t.vecForce}return o()(e,[{key:"getPtVec",value:function(){return this.m_vecPoints}},{key:"getBrushRef",value:function(){return this.m_brushRef}},{key:"getTimeVec",value:function(){return this.m_vecTime}},{key:"getForceVec",value:function(){return this.m_vecForce}},{key:"getTimeStamp",value:function(){return this.timeStamp}},{key:"flipPtVec",value:function(e){}}]),e}(),xu=0,Tu=1,ku=2,Cu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,e),this.m_context=new _u(t.context),this.m_brushMap=t.brushMap||{},this.m_vecTrace=t.vecTrace||[],this.m_coordCache,this._init()}return o()(e,[{key:"_init",value:function(){if(this.m_brushMap){var e=this.m_brushMap;for(var t in e)e.hasOwnProperty(t)&&(e[t]=new mu(e[t]))}Array.isArray(this.m_vecTrace)&&(this.m_vecTrace=this.m_vecTrace.map((function(e){return new Su(e)})))}},{key:"getContext",value:function(){return this.m_context}},{key:"getBrushMap",value:function(){return this.m_brushMap||{}}},{key:"getTraceVec",value:function(){return this.m_vecTrace||[]}},{key:"getCoord",value:function(){return this.m_coordCache||(this.m_coordCache=this.calcTraceCoord()),this.m_coordCache}},{key:"calcTraceCoord",value:function(){var e=this.m_vecTrace;if(!e.length||!e[0].getPtVec().length)return new window.Rect;for(var t=e[0].getPtVec()[0].px,i=e[0].getPtVec()[0].py,n=t,r=i,a=0,o=e.length;a<o;a++)for(var s=e[a].getPtVec(),l=0,h=s.length;l<h;l++){var u=s[l],c=u.px,d=u.py;c>n?n=c:c<t&&(t=c),d>r?r=d:d<i&&(i=d)}return new window.Rect(t,i,n-t,r-i)}},{key:"mapTraceBy",value:function(e,t){if(e.width&&e.height){var i=[],n=window.QMatrix,r=new window.QMatrix;r.translate(e.x,e.y);var a=e.width,o=e.height,s=e.rotation;if(r.translate(a/2,o/2),r.rotate(s||0),r.translate(-a/2,-o/2),1===t.getPtVec().length)return i.push(r.map_point(new window.Point(.5*e.width,.5*e.height))),i;var l=this.getCoord();if(0===l.width()&&0===l.height())return i.push(r.map_point(new window.Point(.5*e.width,.5*e.height))),i;r=n.multiply(r,this.calcMapTrans(e));for(var h=t.getPtVec(),u=0,c=h.length;u<c;u++){var d=r.map_point(new window.Point(h[u].px,h[u].py));i.push(d)}return i}console.warn("this extent is error",e)}},{key:"calcMapTrans",value:function(e){if(e.width&&e.height){var t=window.QMatrix,i=new window.QMatrix,n=this.getCoord();if(0===n.width()&&0===n.height())return i;i.translate(n.left(),n.top());var r=Eu(n.width())?1:n.width()/e.width,a=Eu(n.height())?1:n.height()/e.height;return i.scale(r,a),t.inverted(i)}}},{key:"getBrushFrom",value:function(e){return this.m_brushMap[e.getBrushRef()]}},{key:"getMaxBrushWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.UnitsLength.ti,t=this.m_brushMap;if(!this.maxBrushWidth){var i=0;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n].getWidthBy(e);r>i&&(i=r)}this.maxBrushWidth=i}return this.maxBrushWidth}}]),e}(),bu=function(){function e(){r()(this,e),this.m_formulaMap=new Map,this._init()}return o()(e,[{key:"_init",value:function(){this.addUnitConvertFormula(C.UnitsLength.m,C.UnitsLength.cm,100),this.addUnitConvertFormula(C.UnitsLength.m,C.UnitsLength.mm,1e3),this.addUnitConvertFormula(C.UnitsLength.m,C.UnitsLength.in,100/2.54),this.addUnitConvertFormula(C.UnitsLength.m,C.UnitsLength.pt,7200/2.54),this.addUnitConvertFormula(C.UnitsLength.m,C.UnitsLength.ti,144e3/2.54),this.addUnitConvertFormula(C.UnitsLength.cm,C.UnitsLength.mm,10),this.addUnitConvertFormula(C.UnitsLength.cm,C.UnitsLength.in,1/2.54),this.addUnitConvertFormula(C.UnitsLength.cm,C.UnitsLength.pt,72/2.54),this.addUnitConvertFormula(C.UnitsLength.cm,C.UnitsLength.ti,1440/2.54),this.addUnitConvertFormula(C.UnitsLength.mm,C.UnitsLength.in,.1/2.54),this.addUnitConvertFormula(C.UnitsLength.mm,C.UnitsLength.pt,7.2/2.54),this.addUnitConvertFormula(C.UnitsLength.mm,C.UnitsLength.ti,144/2.54),this.addUnitConvertFormula(C.UnitsLength.in,C.UnitsLength.pt,72),this.addUnitConvertFormula(C.UnitsLength.in,C.UnitsLength.ti,1440),this.addUnitConvertFormula(C.UnitsLength.pt,C.UnitsLength.ti,20)}},{key:"convert",value:function(e,t){if(e===t)return 1;var i=this.m_formulaMap.get(this.getKey(e,t));return i||(console.warn("has no formula",e,t),1)}},{key:"getKey",value:function(e,t){return[e,t].join("_")}},{key:"addUnitConvertFormula",value:function(e,t,i){this.m_formulaMap.set(this.getKey(e,t),i),this.m_formulaMap.set(this.getKey(t,e),1/i)}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}();function Eu(e){return Math.abs(e)<=1e-12}function Ru(e,t){return bu.getInstance().convert(e,t)}var Pu=i(262),Iu=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.props=e,i._textBodyLayouter=vo.getInstance(),i}return u()(t,e),o()(t,[{key:"update",value:function(e){var t=e.shapeData,i=e.parentLayout,n=void 0===i?null:i,r=e.scale;this.shapeData=t,this.parentLayout=n,this.scale=r,this.props=e,this._init()}},{key:"getShapeAgent",value:function(){return this._shapeAgent}},{key:"measure",value:function(){var e=this.props,t=e.shapeData,i=e.isLocalShape,n=void 0,r=void 0,a=void 0,o=this._shapeAgent;if(i&&o&&!t.isGroupShape())if(o.showNotesBody()){if(this.shapeData.getPlaceHolder().type===C.PlaceholderType.Body){var s=o.getTextBody();n=this.notesPageTextBodyMeasure(s),this.extendList={typoTextBody:n},this._updateRealRect()}}else{var l=o.getTextBody(),h=null;if(!t.isBackground()&&o.getProperty().geometry2D)h=o.getProperty().geometry2D;else{var u=void 0;if(o.getProperty().geometry2D){var c=o.getProperty().geometry2D;u=c.type||c._type}else u={data:{presetType:"rect"}};this.shapeData.getTableFrame()||(h=new du.a(u))}if(h){var d=window.CustomGeometry.createGeometryFromPreset(h.type,this.transform2D),p=new fu;d.setEnv(this.scale),h.setEnv(d,p),this.geometry2D=h}var f=o.getProperty(),g=void 0;if(this.advancedAutoFit=l&&l.style&&l.style.autoFit===he.e.AdvancedAutoFit,this.advancedAutoFit){var y=M(this.getRealRectBeforeRotation());if(h&&h.geometry){var v=h.clone(),m=window.CustomGeometry.createGeometryFromPreset(v.type,this.transform2D);m.setEnv(this.scale),v.setEnv(m,new fu),v.interpretPath(y.width,y.height),this.shapeData.textBoxRect=v.geometry.textBoxRect}var _=(g=this.textBodyMeasure(l)).getMargin(),w=g.y+g.height+_.bottom,S=g.x+g.width+_.right;if(g.hasText&&(!this.shapeData.isPlaceHolder()||!g.isEmpty())){var x=g.getWrapText(),T=g.getVerticalType();T===C.TextVerticalType.EastAsianVer||T===C.TextVerticalType.Vertical||T===C.TextVerticalType.Vertical270?x?y.width=Math.max(y.width,isNaN(S)?0:S):y.height=Math.max(y.height,isNaN(w)?0:w):x?y.height=Math.max(y.height,isNaN(w)?0:w):y.width=Math.max(y.width,isNaN(S)?0:S),this.layoutRect.width=y.width,this.layoutRect.height=y.height,y.overflowLeft=0,y.overflowTop=0}r=h&&this.geometryMeasure(h,{fill:f.fill,picture:f.picture,outline:f.outline,rotation:f.transform2D?f.transform2D.rotation:0,scale:this.scale,effects:f.effects,shape3d:f.shape3d,scene3d:f.scene3d,drawRect:y,isBackground:t.isBackground()}),f.shape3d&&r&&(r.shape3d=f.shape3d),f.scene3d&&r&&(r.scene3d=f.scene3d)}else r=h&&this.geometryMeasure(h,{fill:f.fill,picture:f.picture,outline:f.outline,scale:this.scale,effects:f.effects,shape3d:f.shape3d,scene3d:f.scene3d,drawRect:M(this.getRealRectBeforeRotation()),isBackground:t.isBackground()}),f.shape3d&&r&&(r.shape3d=f.shape3d),f.scene3d&&r&&(r.scene3d=f.scene3d),f.picture&&this.currentSlideData.isNormalSlide||(g=this.textBodyMeasure(l));this.getConnectionSites();var k=o.getTableBody();a=this.tableMeasure(k),this.shapeProperty=f;var b=void 0;f.inkData&&(b=this.inkMeasure(f.inkData)),this.extendList={typoTextBody:g,measureShapeBody:r,typoTableBody:a,inkBody:b};var E=this.getFindTextResults();g&&E?g.findResults=E:k&&E&&(k.findResults=E),this._updateRealRect(),this._mapExactRect()}else if(t.isGroupShape()){this.groupMeasure();var R=o.getProperty();this.shapeProperty=R,this._updateRealRect()}else i||this.calcShapeMatrix();var P=(this.props.prevLayoutResult||{}).shapeVisual;if(P){var I=P.layout,L=I&&I.getExtendList();L&&P.updateMeasureShapeBody(L.measureShapeBody),P.layout.destroy(),P.updateLayout(this)}return this.shapeVisual=P,this}},{key:"textBodyMeasure",value:function(e){if(e){var t=Object.assign({},this.layoutRect);if(t.x=0,t.y=0,0===t.width&&0===t.height)return null;var i=this.geometry2D;if(i&&i.getGeometry()){var n=this.shapeData.textBoxRect||i.getGeometry().textBoxRect;!n||0===n.x&&0===n.y&&0===n.width&&0===n.height||(t.x+=n.x/635,t.y+=n.y/635,Object.isEmpty(n.width)||(t.width=n.width/635),Object.isEmpty(n.height)||(t.height=n.height/635))}var r=this.props.prevLayoutResult,a=r&&r.extendList,o=a&&a.typoTextBody;if(o&&window.sameCmp(t,o.rect)&&o.sameData(e))return a.typoTextBody=null,o.x=o._x,o.y=o._y,o.overflowTop=o._top,o;var s=new Yo({parent:this,data:e}),l=this._textBodyLayouter;return l.update(s),l.measure({rect:_()({},t)}),s.rect=t,s._top=s.overflowTop,s._x=s.x,s._y=s.y,s}}},{key:"notesPageTextBodyMeasure",value:function(e){if(e){var t=new Yo({parent:this,data:e}),i=this._textBodyLayouter;i&&i.update(t);var n=Object.assign({},this.getLayoutRect());return i.measure({rect:n}),t}}},{key:"tableMeasure",value:function(e){if(e){var t=this.props.slideEnvLayout&&this.props.slideEnvLayout.svgLayout,i=this.transform2D;e.transform2D=i,e.visible=t,e.scale=this.scale,this._TableLayouter=new su(e,t,i,this.shapeData);var n=this.props.prevLayoutResult,r=n&&n.extendList,a=r&&r.typoTableBody,o=this._TableLayouter.measure(a&&a.typoTextBodys),s=o.tableBounds,l=o.typoTextBodys,h=o.tableVisual,u=o.boundRect,c=o.mixTableHieght;return e.width=s.width,e.height=s.height,e.x=s.l,e.y=s.t,e.typoTextBodys=l,e.tableVisual=h,e.boundRect=u,e.mixTableHieght=c,e.reflectionRect=s.reflectionRect&&s.reflectionRect,e.outerShadowBoundRect=s.outerShadowBoundRect,e.destReflectionRect=s.destReflectionRect,e.effectsRect=s.effectsRect,i.height<e.height&&(i.height=e.height),e}}},{key:"geometryMeasure",value:function(e,t){if(e&&this.getUpdatePartOfShape()!==C.UpdatePartOfShape.UpdateText){var i=t.drawRect;if(t.scale){var n=0,r=this.props.shapeData;if(r.isBackground()?n=-1:t.outline&&(n=t.outline.width?window.Ti2Px(window.Emu2Ti(t.outline.width),t.scale):1),!(0===i.width&&0===i.height||i.width<0||i.height<0)){var a,o,s,l=new hu({drawRect:i,geometry2D:e,extParam:t,lineWidth:n,shapeData:r}).measure(),h=void 0;h=M(t.fill),M(t.outLine),a=M(t.picture),o=M(t.outline),s=M(t.effects);var u=this.shapeData.getFill();if(u&&this.parentLayout&&u.type===Be.e.FillTypeGroup){h=h||{};var c=this.parentLayout.getRealRect();h.rect={x:this.realRect.x-c.x,y:this.realRect.y-c.y,width:c.width,height:c.height}}var d={layout:l,fill:h,picture:a,outline:o,effects:s};return l.paths&&(this.geomertyBoundRect=l.geomertyBoundRect),this.shapeRealyRect=l.shapeRealyRect,this.shapeData.textBoxRect=e.getGeometry().textBoxRect,this.shapeData.adjustHandles=e.getGeometry().adjustHandles,d}}}else this.prepUpdatePartOfText(e,t.drawRect)}},{key:"prepUpdatePartOfText",value:function(e,t){var i=this.props&&this.props.prevLayoutResult&&this.props.prevLayoutResult.shapeVisual,n=i&&i.measureShapeBody,r=n&&n.layout;r&&(r.geomertyBoundRect&&(this.geomertyBoundRect=r.geomertyBoundRect),r.shapeRealyRect&&(this.shapeRealyRect=r.shapeRealyRect));var a=e.getGeometry();if(e&&a){var o=t.width,s=t.height;a.updateNameTable(o,s)}}},{key:"inkMeasure",value:function(e){return new Cu(e)}},{key:"groupMeasure",value:function(){var e=0;this.shapeData.childShapes.forEach((function(t){var i=t.getOutline();if(i&&i.width&&i.fill&&0!==i.fill.type){var n=i.width/635;n>e&&(e=n)}})),this.exactRect&&(this.exactRect.overflowLeft=2*e,this.exactRect.overflowTop=2*e,this.exactRect.width+=4*e,this.exactRect.height+=4*e)}},{key:"calcShapeMatrix",value:function(){var e=new window.QMatrix,t=this.transform2D,i=t.rotation,n=t.horizontalFlipped,r=t.verticalFlipped,a=t.width,o=t.height;e.translate(a/2,o/2),e.rotate(i),e.scale(n?-1:1,r?-1:1),e.translate(-a/2,-o/2),this.shapeMatrix=e;var s=new window.Rect(0,0,a,o),l=bh.b/window.ti2pxRatio;return s.adjust(-l,-l,l,l),this.geomertyBoundRect=s,e}},{key:"calcHitTestMatrix",value:function(){var e=this.viewRect||this.realRect,t=e.x,i=e.y,n=e.width,r=e.height,a=this.transform2D,o=a.rotation,s=a.horizontalFlipped,l=a.verticalFlipped,h=new window.QMatrix;return h.translate(t,i),h.translate(n/2,r/2),h.rotate(o),h.scale(s?-1:1,l?-1:1),h.translate(-n/2,-r/2),h}},{key:"getHitTestMatrix",value:function(){return this.hitTestMatrix=this.hitTestMatrix||this.calcHitTestMatrix(),this.hitTestMatrix}},{key:"calcBackendTransform",value:function(e){var t=new window.QMatrix;if(!e||Object.isEmpty(e.width))return t.translate(this.realRect.x,this.realRect.y),_()({matrix:t},this.realRect);var i=e.width,n=e.height,r=e.x,a=e.y,o=i*this.scale,s=n*this.scale;r*=this.scale,a*=this.scale;var l=Lu.get(e,this.realRect);if(l){var h=l.rotation,u=l.horizontalFlipped,c=l.verticalFlipped,d=this.transform2D,p=d.rotation,f=d.horizontalFlipped,g=d.verticalFlipped;r+=this.realRect.x-l.x,a+=this.realRect.y-l.y,o*=this.realRect.width/l.width,s*=this.realRect.height/l.height,t.translate(r,a),t.translate(o/2,s/2),t.rotate(p-h),t.scale(f===u?1:-1,g===c?1:-1),t.translate(-o/2,-s/2)}else t.translate(r,a);return{matrix:t,width:o,height:s}}},{key:"getGroupShapeTransform",value:function(){if(this._groupShapeTransform)return this._groupShapeTransform;for(var e=this.shapeData.parent,t=[],i=void 0;e&&e.isGroupShape&&e.isGroupShape()&&!e.isShapeTree;){var n=e.getTransform2D(),r=n||{},a=r.horizontalFlipped,o=r.verticalFlipped,s=r.rotation;i=this.getShapeLayout(e),(s||a||o)&&t.unshift(i),e=e.parent}return this._groupShapeTransform=t,t}},{key:"getShapeLayout",value:function(e){if(e.isShapeTree)return null;var i=this.props.scale;return new t({shapeData:e,parentLayout:this.getShapeLayout(e.parent),scale:i,slideEnvLayout:this.slideEnvLayout,isLocalShape:!0}).measure()}},{key:"hitTest",value:function(e){if(this.shapeData&&!this.isHidden()){this.typoRect||(this.typoRect=new Ja);var t=e.isConnectorHitTest,i=this.viewRect||this.realRect,n=i.x,r=i.y,a=i.width,o=i.height,s=this.getHitTestMatrix(),l=new window.QTransform(s),h=0,u=0,c=new window.Rect(h,u,a,o),d=void 0;if(this.geomertyBoundRect){h+=this.geomertyBoundRect.x()*window.ti2pxRatio,u+=this.geomertyBoundRect.y()*window.ti2pxRatio;var p=this.geomertyBoundRect.width()*window.ti2pxRatio,f=this.geomertyBoundRect.height()*window.ti2pxRatio;a=p>a?p:a,o=f>o?f:o,d=new window.Rect(h,u,p,f)}var g=new window.Point(e.x,e.y);if(t){var y=this.getShapeMvpMatrix(1).inverted().Map(g);return d&&d.isInside(y)?{type:C.CursorType.Shape,isHit:!0}:null}this.shapeData.hasTable()&&(h-=10,u-=10,a+=20,o+=20);var m=new window.Rect(h,u,a,o),_=window.APP&&window.APP.shell.doc.getMode()===C.ViewModes.PlayView,w=new window.QMatrix;if(_){var S=this.shapeData.getId(),x=this.shapeData.getSlide(),T=x&&x.getCategory(),k=window.APP&&window.APP.shell.doc.getShapeCurrentRect(S,T);if(k){var b=k.width()/c.width(),E=k.height()/c.height();w.translate(c.width()/2,c.height()/2),w.scale(b,E),w.translate(-c.width()/2,-c.height()/2),m=l.inverted().Map(k)}}var R=l.inverted().Map(g);this.typoRect.setRect(n,r,a,o);var P={x:this.realRect.x+this.realRect.width/2,y:this.realRect.y+this.realRect.height/2},I=this.typoRect.pointInRotateRect(e,this.getFrameRotation(),P);if(m.isInside(R)){if(this.inkVisual&&this.shapeData.isInk())return this.inkVisual.hitTest(new window.Point(e.x,e.y))?{type:C.CursorType.Shape,isHit:!0}:void 0;var L=Object.assign(e,I);L.x-=this.typoRect.x,L.y-=this.typoRect.y;var A=null,B=this.getExtendList(),D=B.typoTextBody,M=B.typoTableBody;if(_&&D&&D.isDefText())return;if(D){if(c.isInside(R)){var O=this._textBodyLayouter;O&&O.update(D),A=O.hitTest(L)}}else if(M){var N=this._TableLayouter;N&&N.update(M),A=N.hitTest(L)}if(A&&A.type!==C.CursorType.TextBorder)return A.target=this,A.isHit=!0,A.hitInPath=!0,A;if(_)return this.isLocalShape?(R=w.inverted().Map(R),{type:C.CursorType.Shape,isHit:!0,hitInPath:this.shapeVisual&&this.shapeVisual.hitTest(R)}):{type:C.CursorType.Shape,isHit:!0,hitInPath:!0};if(!this.shapeVisual||this.shapeData.getPlaceHolderType()===C.PlaceholderType.Picture)return{type:C.CursorType.Shape,isHit:!0};if(this.shapeVisual.hitTest(R,v.userAgent.isMobile||v.userAgent.isTouchScreen?20:10))return{type:C.CursorType.Shape,isHit:!0}}}}},{key:"isHidden",value:function(){return this.shapeData&&this.shapeData.isHidden()}},{key:"_mokeDrawRect",value:function(e,t){if(this.shapeVisual&&this.shapeVisual.hitTestPath){var i=document.querySelector("#mock_draw_canvas");if(!i){var n=document.querySelector("#uil-content .slide-editor");(i=document.createElement("canvas")).setAttribute("id","mock_draw_canvas"),i.setAttribute("width",n.offsetWidth+"px"),i.setAttribute("height",n.offsetHeight+"px"),n.appendChild(i)}var r=window.APP.shell.doc.coreView.getZoom(),a=i.getContext("2d");a.clearRect(0,0,i.width,i.height);var o=this.getUilGeometryRect(1)||this.viewRect||this.realRect,s=o.x,l=o.y,h=o.width,u=o.height;a.clearRect(0,0,i.width,i.height),a.save(),a.scale(r,r),a.fillRect(s,l,h,u),a.restore()}}},{key:"hitSelectObjectsByRect",value:function(e){this.typoRect||(this.typoRect=new Ja);var t=this.getLayoutRectAfterRotation(),i=t.x,n=t.y,r=t.width,a=t.height;if(this.typoRect.setRect(i,n,r,a),this.typoRect.inRect(e))return{type:"shapeSelect",isHit:!0}}},{key:"getSelectRectByGcp",value:function(e){var t=e.begin,i=e.end,n=e.cellIndex,r=e.isHitRight,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.getExtendList(),s=o.typoTextBody,l=o.typoTableBody,h=[];if(s){var u=this._textBodyLayouter;u&&u.update(s),h=u.getSelectRectByGcp(t,i,r)}else if(l){var c=this._TableLayouter;c&&c.update(l),h=c.getSelectRectByGcp(t,i,n,r)}var d=this.viewRect||this.realRect,p=d.x,f=d.y,g=this.ratio;return a&&(p=0,f=0,g=1),h&&h.forEach((function(e){e.forEach((function(e){e.x+=p,e.y+=f,e.x*=g,e.y*=g,e.width=e.width*g,e.height=e.height*g,e.beginPos.x+=p,e.beginPos.y+=f,e.endPos.x+=p,e.endPos.y+=f,e.beginPos.x*=g,e.beginPos.y*=g,e.endPos.x*=g,e.endPos.y*=g,e.cursorX+=p,e.cursorX*=g}))})),h}},{key:"getNextGcpByDirectionKeys",value:function(e){var t=e.gcp,i=e.keyCode,n=this.getExtendList(),r=n.typoTextBody,a=n.typoTableBody;if(r){var o=this._textBodyLayouter;return o&&o.update(r),o.getNextGcpByDirectionKeys(t,i)}if(a){var s=this._TableLayouter;return s&&s.update(a),s.getNextGcpByDirectionKeys(t,i,a.selectIndex)}}},{key:"isChangeCellIndex",value:function(e,t){var i=this.getExtendList().typoTableBody;if(i){var n=this._TableLayouter;return n&&n.update(i),n.isChangeCellIndex(e,t,i.selectIndex)}}},{key:"getSelectStyleByRange",value:function(e){var t=e.begin,i=e.end,n=e.cellIndex,r=this.getExtendList(),a=r.typoTextBody,o=r.typoTableBody,s=_()({},this.shapeProperty);if(a){var l=this._textBodyLayouter;l&&l.update(a);var h=l.getSelectStyleByRange(t,i);s.textBodyStyle=h}else if(o){var u=this._TableLayouter;if(u&&(u.update(o),!Object.isEmpty(n))){var c=u.getSelectStyleByRange(t,i,n);s.textBodyStyle=c}}return s}},{key:"getVerticalType",value:function(){var e=this.typoTextBody;return e&&e.getVerticalType()}},{key:"updateRatio",value:function(e){this.ratio=e}},{key:"getUilLayoutRect",value:function(e){this.updateRatio(e);var t=this._rect2Px(_()({},this.getLayoutRect()),this.ratio);return t.rotate=this.getFrameRotation(),t}},{key:"getUilGeometryRect",value:function(e){this.updateRatio(e);var t=this.getShapeRealyRect();if(t){var i=this._rect2Px(_()({},t),this.ratio),n=this.getUilLayoutRect(e);return Object.assign(n,i)}return this.getUilLayoutRect(e)}},{key:"getShapeRealyRect",value:function(){if(this.shapeRealyRect){var e=this.shapeRealyRect;return this.getHitTestMatrix().Map(e).getRect()}}},{key:"getUilRotatedLayoutRect",value:function(e){var t=_()({},this.realRect),i={x:t.x+t.width/2,y:t.y+t.height/2},n=Object(vu.b)(t,i,this.realRect.rotation);return Object(vu.c)(n,e)}},{key:"getRotatedRect",value:function(e){var t=Object(vu.c)(this.realRect,this.ratio),i={x:t.x+t.width/2,y:t.y+t.height/2},n=this.getFrameRotation();return Object(vu.b)(e,i,n)}},{key:"getShapeMvpMatrix",value:function(e){var t=this.getUilLayoutRect(e),i=new window.QMatrix;return i.translate(t.x,t.y),i.translate(t.width/2,t.height/2),i.rotate(t.rotation),i.scale(t.horizontalFlipped?-1:1,t.verticalFlipped?-1:1),i.translate(-t.width/2,-t.height/2),i}},{key:"calcBackendRotatePosPx",value:function(e){this.typoRect||(this.typoRect=new Ja);var t=this.getBackendRectPx(),i=t.x,n=t.y,r=t.width,a=t.height;this.typoRect.setRect(i,n,r,a);var o={x:i+r/2,y:n+a/2};return this.typoRect.getRotatePoint(o,e,this.getFrameRotation())}},{key:"getCellRectByIndex",value:function(e){var t=this._TableLayouter;return t&&t.getCellRectByIndex(e)}},{key:"getCellRectByIdx",value:function(e){var t=this._TableLayouter;return t&&t.getCellRectByIdx(e)}},{key:"getCellRangeByIdx",value:function(e){var t=this._TableLayouter;return t&&t.getCellRangeByIdx(e)}},{key:"setBackendShapeRect",value:function(e){this.backendShapeRect=e}},{key:"getUpdatePartOfShape",value:function(){return this.shapeData.isGroupShape()?C.UpdatePartOfShape.UpdateShape:this.isOnlyUpdateText()?C.UpdatePartOfShape.UpdateText:this.isOnlyUpdatePicture()?C.UpdatePartOfShape.UpdateShapePic:this.isOnlyUpdatePicFill()?C.UpdatePartOfShape.UpdateShapePicFill:C.UpdatePartOfShape.UpdateShape}},{key:"isOnlyUpdateText",value:function(){var e=this.props&&this.props.updateEvent&&this.props.updateEvent.event,t=this.shapeData.parent,i=this.props.updateEvent&&this.props.updateEvent.isNewParentNode&&t&&!t.isShapeTree;return!!this.shapeData.isTextShape()&&(!this.advancedAutoFit&&!i&&(e&&e===Pu.default.insert_text||e===Pu.default.delete_text||e===Pu.default.modify_fmt))}},{key:"isOnlyUpdatePicture",value:function(){var e=this.extendList&&this.extendList.measureShapeBody;return e&&e.picture}},{key:"isOnlyUpdatePicFill",value:function(){var e=this.extendList&&this.extendList.measureShapeBody,t=e&&e.fill;return(t&&t.type)===Be.e.FillTypeBlip}},{key:"getFindTextResults",value:function(){var e=this;if(this.shapeData){var t=window.APP&&window.APP.presentation,i=t&&t.searcherMgr.getSearcher("text");if(i&&i.count>0){var n=this.shapeData.getId(),r=this.shapeData.getSlideId(),a=i.getResultByParams({slideId:r,shapeId:n});if(a&&a.length){var o=[],s=this._TableLayouter;return a.forEach((function(t){var i=t.getState(),n=e.shapeData.getTableFrame(),r=n&&n.collectCellsIdx(i.cellRange),a=r&&r[0],l=e.getSelectRectByGcp({begin:i.begin,end:i.end,cellIndex:a},!0),h=s&&!Object.isEmpty(a)&&s.getSelectCell(a);if(h&&l){var u=h.cellVisual.getRect();l.forEach((function(e){e.forEach((function(e){e.x+=u.x,e.y+=u.y}))}))}o.push({lightRect:l,cellIndex:a})})),o}}}}},{key:"destroy",value:function(){if(y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),delete this.props,delete this._textBodyLayouter,delete this._shapeAgent,this.extendList){var e=this.extendList.typoTextBody;e&&e.destroy()}delete this._TableLayouter,delete this.extendList,delete this.shapeVisual}},{key:"calcTransFromCurrent2Layer",value:function(e){if(this.shapeData&&this.dataToken===this.shapeData.getDataToken()){var t=new window.QTransform,i=this.scale*e;t.scale(i,i);var n=this.shapeData.visual.calcTransFromCurrent2Layer().multiply(t);return n.scale(1/i,1/i),n}}},{key:"getConnectionSites",value:function(){var e=this.geometry2D;if(!this.connectionSites&&e){var t=e.getGeometry(),i=t&&t.getConnectionSites();if(i&&i.length)this.connectionSites=M(i),(this._originShapeData||this.shapeData).visual.setConnectionSites(M(i))}return this.connectionSites}},{key:"getTi2PxConnectionSites",value:function(e){var t=this.getConnectionSites();if(t){var i=this.getUilLayoutRect(e),n=i.x,r=i.y,a=i.width,o=i.height,s=i.rotation,l=i.horizontalFlipped,h=i.verticalFlipped,u=new window.QMatrix;u.translate(n+a/2,r+o/2),u.rotate(s),u.scale(l?-1:1,h?-1:1),u.translate(-a/2,-o/2);var c=window.Ti2Px;return t.map((function(t){var i=t.x,n=t.y,r=new window.Point(c(i/635)*e,c(n/635)*e),a=u.Map(r);return _()({},t,{x:a.x(),y:a.y()})}))}}},{key:"getAnimationRect",value:function(e){var t=this.extendList&&this.extendList.measureShapeBody,i=t&&t.layout,n=i&&i.shapeRealyRect;if(!n){var r=window.Rect.create(this.viewRect);return r.adjust(-3,-3,3,3),r.getRect()}n=n.translated(new window.Point(this.layoutRect.x,this.layoutRect.y));var a=window.Rect.create(this.viewRect),o=n.left()<a.left()?n.left()-3:a.left()-3,s=n.right()>a.right()?n.right()+3:a.right()+3,l=n.top()<a.top()?n.top()-3:a.top()-3,h=n.bottom()>a.bottom()?n.bottom()+3:a.bottom()+3,u=window.Rect.create({left:o,right:s,top:l,bottom:h}),c=this.transform2D.rotation;return u=u.getRect(),e?((u=this._rect2Px(u,e)).rotation=c,u):(u.rotation=c,u)}},{key:"getOriginDataToken",value:function(){return this._originShapeData&&this._originShapeData.getDataToken()}},{key:"typoTextBody",get:function(){var e=this.getExtendList(),t=e.typoTextBody,i=e.typoTableBody;if(t)return t;if(i){var n=this._TableLayouter;n&&n.update(i);var r=this.getShapeAgent(),a=r&&r.getSelection(),o=a&&a.getActiveTableCells();if(1===o.length){var s=o[0];return i.typoTextBodys&&i.typoTextBodys.find((function(e){return e.cellIndex===s.getIdx()}))}}return null}},{key:"isFieldPlaceholderShapes",get:function(){var e=this.getShapeAgent();return e&&e.isFieldPlaceholderShapes}}]),t}(ze),Lu=function(){function e(){r()(this,e)}return o()(e,null,[{key:"set",value:function(e,t){(e.token||e.sha1)&&(this._dataMap[e.token||e.sha1]=t)}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],i=this._dataMap[e.token||e.sha1];if(i)return i;this.set(e,Object.assign({},t))}}]),e}();Lu._dataMap={};var Au=i(2718),Bu=function(){function e(t,i,n){r()(this,e),this.ltd=n,this.boundRect=i&&i.isQRect?(new window.Rect).assign(i):null,this.radius=window.Emu2Ti(t.radius)*this.ltd*2||0}return o()(e,[{key:"render",value:function(e,t,i){var n=Math.floor(.843*this.getRadius());if(!(n<=0)){var r=e.getImageData(0,0,t,i);!function(e,t){var i=[0,0,0,0],n=e.width,r=e.height,a=[],o=[];(function(e,t){for(var i=e.width,n=e.height,r=4*e.width,a=e.data,o=0;o<i;++o)for(var s=0;s<n;++s){var l=Nu(e,o,s);Du(a,l)&&(0===o||o===i-1||0===s||s===n-1?t.push(new window.Point(o,s)):l+4!==0&&l-4!=0&&l-r!=0&&l+r!==0||t.push(new window.Point(o,s)))}})(e,o),function(e,t){if(t<=0)return;var i=function(e){return e-1}(t);e.push(new Mu(-i,0,2*t-1));for(var n=i*i,r=1;r<=i;++r){var a=Math.round(Math.sqrt(n-r*r)),o=2*Ou(a)-1;e.push(new Mu(-a,-r,o)),e.push(new Mu(-a,r,o))}}(a,t);for(var s=0;s<o.length;++s)for(var l=0;l<a.length;++l){var h=o[s].x()+a[l].xoff,u=o[s].y()+a[l].yoff,c=a[l].ilen;u<0||u>=r||(h<0&&(c+=h,h=0),h+c>n&&(c=n-h),Fu(e,h,u,c,i))}}(r,n),new Ih(r,n/2).render(),e.putImageData(r,0,0)}}},{key:"getRadius",value:function(){return this.radius}},{key:"getBoundRect",value:function(){return this.boundRect}}]),e}();function Du(e,t){return e[t+0]&&e[t+1]&&e[t+2]&&e[t+3]}var Mu=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r()(this,e),this.xoff=t,this.yoff=i,this.ilen=n},Ou=function(e){return e+1};function Nu(e,t,i){var n=e.width,r=e.height;return(t>n||i>r)&&console.error("Over width or height , cannot get imageData pix from x y!"),i*n*4+4*t}function Fu(e,t,i,n,r){for(var a=e.data,o=e.width,s=i*o*4+4*t;n--&&i<o;)a[s+0]=r[0],a[s+1]=r[1],a[s+2]=r[2],a[s+3]=r[3],i++,s+=4}var Vu=function(){function e(t){r()(this,e),this.props=t}return o()(e,[{key:"render",value:function(e){var t=this.props,i=t.orginlCanvasImage,n=t.effects,r=t.layout,a=t.fill,o=t.outline,s=t.preloadSource,l=t.parentLayout,h=t.picture;if(!n)return!1;var u=r.scale,c=r.paths,d=r.shapeRealyRect,p=d.height(),f=d.width(),g=n.outerShadow,y=n.presetShadow,v=n.innerShadow,m=n.reflection,_=n.glow,w=n.softEdges,S=g||y,x=o&&o.width?o.width:0,T=isNaN(window.Emu2Ti(x)*u)?0:window.Emu2Ti(x)*u;e.save();var k=c.matrix,C=!!h,b=i.getContext("2d");if(k&&k.mapContext(b),v){var E=r.scale,R=new Ah(v,c,d,E,{fill:a,layout:r,preloadSource:s,parentLayout:l,picture:h}).render(i);e.save(),b.save(),e.drawImage(R,0,0),b.drawImage(R,0,0),e.restore(),b.restore()}if(b.globalCompositeOperation="destination-over",S){var P=c.srcBoundRect,I=new Lh(S,P,[],u).render(i,f,p,d);e.drawImage(I,d.x(),d.y()),b.drawImage(I,d.x(),d.y())}if(_){var L=c.srcBoundRect,A=new Uh(_,L,u,T).render(c,a,o,C,k,d);e.drawImage(A,d.x(),d.y()),b.drawImage(A,d.x(),d.y())}if(w){var B=n.softEdges;new Bu(B,null,u).render(b,f,p)}if(m){var D=c.reflectionRect,M=c.srcBoundRect,O=c.reflectionRect,N=new Nh(m,M,u,O),F=N.render(b,Math.round(D.width()),Math.round(D.height())),V=N.reflectionOff;if(_)V-=4*(window.Emu2Ti(_.radius)*u/2);var U=c.originBoundRect;e.drawImage(F,d.x(),V+U.y())}e.restore()}}]),e}(),Uu=i(4953),Gu=i.n(Uu),Hu=function(){function e(t){var i=t.layout,n=t.outline,a=t.picture,o=t.preloadSource,s=t.shape;r()(this,e),this.outline=n,this.paths=i.paths,this.scale=i.scale,this.preloadSource=o,this.shape=s,this.layout=i,this._init(a,o)}return o()(e,[{key:"_init",value:function(e,t){var i=e&&e.blip&&e.blip.blipAtom&&e.blip.blipAtom.imageId;this.imageId=i,this.picture=e,this.image=t[i]}},{key:"render",value:function(e,t,i,n){if(!this.paths||!this.image||!this.picture)return!1;this.imgRect=this.calcImgRect(),this.clipImage(e),this.renderOutline(e,t,i,n)}},{key:"_renderBackgroundImage",value:function(e){if(this.imageId>0){this.backgroundImageGroup=e.save("clip_image_background");var t=this.imgRect.clone();t.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y));var i=new window.QPainterPath;i.addRect(t),i.toContextPath(e),e.clip(),this._clipImage(e),i.toContextPath(e),this.paths.forEach((function(t){var i=t.attributes,n=i&&i.fill,r=t.strokerPath?t.strokerPath.data:t.painterPath.data;r&&r.isClosed()&&n!==Be.f.None&&t.painterPath.toContextPath(e)})),e.fillStyle="rgba(0, 0, 0, "+.4*this.pictureFull.alpha+")",e.fill("evenodd"),e.restore()}}},{key:"clipImage",value:function(e){var t=this;if(window.APP.isClipMode){var i=window.APP.isClipMode,n=i.shapeId,r=i.slideId;n===this.shape.getId()&&r===this.shape.getSlideId()&&this._renderBackgroundImage(e)}this.paths.forEach((function(i,n){var r=i.attributes,a=r&&r.fill,o=i.strokerPath?i.strokerPath.data:i.painterPath.data;o&&o.isClosed()&&a!==Be.f.None&&(e.save("clip_image_"+t.imageId+"_"+(n+1)),t._clipImage(e,i),t._addShadowLayer(e,i),e.restore())}))}},{key:"_addShadowLayer",value:function(e,t){var i=t.attributes,n=i&&i.fill;if(n&&0!==n){var r=this.imgRect.clone();r.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y));var a=new window.QPainterPath;a.addRect(r),a.toContextPath(e),e.clip(),e.beginPath(),t.painterPath.toContextPath(e),this._setAlpha(e,n),e.fill()}}},{key:"calcImgRect",value:function(){var e=this.picture,t=e.sourceRectangle,i=e.blip,n=this.image._logicWidth||this.image.width,r=this.image._logicHeight||this.image.height;if(!n||!r)return new window.Rect(this.layout.drawRect.x,this.layout.drawRect.y,this.layout.drawRect.width,this.layout.drawRect.height);var a=new window.Rect(0,0,n,r),o=this.layout.drawRect,s=this.calcClosePathBound();s.translate({x:o.x,y:o.y});var l=s.x(),h=s.y(),u=s.width(),c=s.height(),d=i&&i.blipAtom&&i.blipAtom.size,p=this.imageId>0&&d>0;if(t&&p){var f=t.left,g=t.right,y=t.top,v=t.bottom,m=a.adjusted(n*f,r*y,n*-g,r*-v);if(isNaN(f)||isNaN(y)||isNaN(g)||isNaN(v)||m.width()<0||m.height()<0)return console.error("Error SourceRectangle"),new window.Rect(l,h,u,c);var _=m.width()/s.width(),w=m.height()/s.height();if(0===_||0===w)return window.Rect.setFromPoint(s.center(),s.center());var S=n/_,x=r/w;l=s.left()-S*f,h=s.top()-x*y,u=S,c=x}return new window.Rect(l,h,u,c)}},{key:"renderOutline",value:function(e,t,i,n){if(t&&t.fill&&t.fill.type){var r=e.save("clip_image_outline");if(window.APP.isClipMode&&this.backgroundImageGroup){var a=window.APP.isClipMode,o=a.shapeId,s=a.slideId;o===this.shape.getId()&&s===this.shape.getSlideId()&&this.backgroundImageGroup.parentElement.insertBefore(r,this.backgroundImageGroup)}this.paths.forEach((function(r){var a=r.attributes;a.hasOwnProperty("stroke")&&!a.stroke||new sl({outline:t,path:r,layout:i,scale:n}).render(e)&&(r.strokerPath&&r.strokerPath!==r.painterPath?(e.beginPath(),r.strokerPath.toContextPath(e),e.isSvg?e.fill("nonzero",C.PartOfShapeName.ShapeOutlinePath()):e.fill("nonzero")):(e.beginPath(),r.painterPath.toContextPath(e),e.stroke(C.PartOfShapeName.ShapeOutlinePath())))})),e.restore()}if(window.APP.isClipMode){var l=window.APP.isClipMode,h=l.shapeId,u=l.slideId;h===this.shape.getId()&&u===this.shape.getSlideId()&&(e.save("clip_image_shape_outline"),this.paths.forEach((function(t){e.strokeStyle="rgba(255, 255, 255, 1)",e.lineWidth=1,e.setLineDash([3,3]),e.beginPath(),t.painterPath.toContextPath(e),e.stroke()})),e.restore())}}},{key:"calcClosePathBound",value:function(){var e=this,t=void 0;return this.paths.forEach((function(i){var n=i.painterPath.boundingRect();t||(t=new window.Rect.create(n)),i.painterPath.data&&i.painterPath.data.isClosed()&&(t=e._calcRect(t,new window.Rect.create(n)))})),t}},{key:"_clipImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.imgRect.clone();i.translate(new window.Point(-this.layout.drawRect.x,-this.layout.drawRect.y)),e.save("image_clip"),t&&(t.painterPath.toContextPath(e),e.clip());var n=Object.assign({},this.picture),r=i.getRect();n.originRect=i,n.isStretched=!0,n.sourceRectangle={};var a=new js({rect:r,clip:!0,fill:n,shadowRangeIndex:-1,preloadSource:this.preloadSource,scale:this.scale});this.pictureFull=a;var o=a.makeImageEffects(this.image),s=o.img,l=o.canvas;if(this.image=e.isSvg?s:l,e.drawImageAlpha=a.alpha,e.isSvg&&this.preloadSource&&Object.keys(this.preloadSource).includes(""+window.wppDefaultImageId)){var h=e.getCurrentElement();h&&h.setAttribute("class","content-placeholder-default-image")}this.image&&("IMG"===this.image.tagName||"CANVAS"===this.image.tagName)&&r.width>0&&r.height>0&&e.drawImage(this.image,r.x,r.y,r.width,r.height),e.restore()}},{key:"_setAlpha",value:function(e,t){var i=0;switch(t){case Be.f.Lighten:i=.4;break;case Be.f.LightenLess:i=.2;break;case Be.f.Darken:i=.4;break;case Be.f.DarkenLess:i=.2}t===Be.f.Lighten||t===Be.f.LightenLess?(e.fillStyle="rgba(255,255,255,"+i+")",e.strokeStyle="rgba(255,255,255,"+(1-i)+")"):t!==Be.f.Darken&&t!==Be.f.DarkenLess||(e.fillStyle="rgba(0,0,0,"+i+")",e.strokeStyle="rgba(255,255,255,"+(1-i)+")")}},{key:"_calcRect",value:function(e,t){if(!e.isQRect||!t.isQRect)return console.error("not rect"),!1;var i=e.left()<t.left()?e.left():t.left(),n=e.right()>t.right()?e.right():t.right(),r=e.top()<t.top()?e.top():t.top(),a=e.bottom()>t.bottom()?e.bottom():t.bottom();return new window.Rect(i,r,n-i,a-r)}}]),e}(),Wu=function(e){return e&&e.innerShadow},ju=function(e){return e&&(e.outerShadow||e.presetShadow)},Yu=function(e){return e&&e.reflection},zu=function(e){return e&&e.softEdges},Ku=function(e){return e&&e.glow&&e.glow.radius>0},qu=function(){function e(t){if(r()(this,e),this.layout=t,t){var i=this.layout.getExtendList().measureShapeBody;this.measureShapeBody=i}}return o()(e,[{key:"updateLayout",value:function(e){return!!e&&(this.layout=e,!0)}},{key:"updateMeasureShapeBody",value:function(e){return!!e&&(this.measureShapeBody=e,!0)}},{key:"render",value:function(e,t,i){var n=this;if(this.context=e,this.preloadSource=i,this.scale=t,this.layout.shapeVisual=this,this.has3DRender()&&!this.unSuportShape3d()){var r=this.measureShapeBody,a=r.shape3d,o=r.scene3d,s=r.layout,l=r.fill,h=r.outline,u=r.effects;this.shape3d=a,this.scene3d=o,this.rootSvg=this.context.getLastGroup&&this.context.getLastGroup(),Gu()((function(e){n.Visual3DRender=e.default;var t=new Vs.default,i=new n.Visual3DRender(t,o,a,s,{fill:Object(us.d)(l),outline:Object(us.d)(h),effects:Object(us.d)(u)},n.shapeData),r=i.get3DCache();if(r)i.draw3DCache(r);else{console.log("3dRender start",Date.now());var c=n.parpareFor3D(i);n.isFlatText(),i.setFrontTexture(c),i.render(),console.log("3dRender end",Date.now())}var d=t.getSvg();n.rootSvg&&n.rootSvg.firstElementChild&&n.rootSvg.firstElementChild.appendChild(d.lastElementChild);for(var p=n.shapeData;p&&p.getParent()&&!p.getParent().isShapeTree;)p=p.getParent();window.SlidePool.getInstance().reRender({slideId:n.shapeData.getSlideId(),shape:p,type:"updateShape"})}))}else this.draw2DShape(this.context);Ns.c("geomerty")}},{key:"parpareFor3D",value:function(e){var t=e.get3DBound(),i=Fs(t,t).getElem(),n=i.getContext("2d"),r=t/2-e.getRect().width()*this.scale/2+e.getRect().x()*this.scale,a=t/2-e.getRect().height()*this.scale/2+e.getRect().y()*this.scale;return n.translate(r,a),n.save(),this.draw2DShape(n,!0),n.restore(),i}},{key:"isMedia",value:function(){return!!(this.shapeData&&this.shapeData.private.name).includes(".")}},{key:"draw2DContour",value:function(e,t,i,n){var r={};r.width=i,r.joinType=_e.LineJoinTypeRound,r.endingCap=ue.LineCapRound;for(var a=0;a<n.length;a++){var o=n[a],s=o.attributes;s.hasOwnProperty("stroke")&&!s.stroke||(o.strokerPath.toContextPath(e),e.fillStyle=t.getRgbString(),e.fill("nonzero"))}}},{key:"isFlatText",value:function(){var e=this.layout.shapeData;if(e&&e.private&&e.private.childs){var t=e.private.childs[0];if(t&&t.private&&t.private.prop)return!!t.private.prop.flatText}return!1}},{key:"has3DRender",value:function(){var e=this.measureShapeBody,t=e.shape3d,i=e.scene3d;return i&&Object.keys(i).length>0||t&&Object.keys(t).length>0}},{key:"unSuportShape3d",value:function(){var e=this.measureShapeBody,t=(e.shape3d,e.scene3d);if(this.shapeData.isPlaceHolder())return!0;if(t){var i=t&&t.camera,n=i&&i.type;if(n&&n>=29&&n<=37||n>=47&&n<=61)return!0}}},{key:"converterScene3d",value:function(e){e.converter()}},{key:"draw2DText",value:function(e){var t=this.layout,i=t.getExtendList().typoTextBody,n=t.getRotation(),r=0,a=0;if(0!==n){var o=t.getRealRect();r=o.width/2,a=o.height/2,e.translate(r,a),e.rotate(n*Math.PI/180)}var s=i.getScaleXY(),l=i.overflowLeft,h=i.overflowTop;l<0&&(r-=l*s.x),h<0&&(a-=h*s.y),e.translate(-r,-a),zh.getInstance().render(e,i)}},{key:"hitTest",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=new window.QMatrix,n=i.Map(e),r=this.hitTestPath||this.calcHitTestPath(t),a=0;a<r.length;a++){var o=r[a];if(r[a].painterPath){var s=o.painterPath;if(s.containsPoint(n))return!0}if(r[a].strokerPath){var l=r[a].strokerPath;if(l.containsPointNearly(n))return!0}}return!1}},{key:"calcHitTestPath",value:function(e){for(var t=this.measureShapeBody,i=t.fill,n=t.layout,r=t.picture,a=t.outline,o=n.paths,s=this.scale,l=[],h=0;h<o.length;h++){var u=o[h],c=u.attributes,d=u.painterPath,p=u.strokerPath,f=c.fill,g={};if((r||i&&i.type&&f!==Be.f.None&&d||this.shapeData.isPlaceHolder()||this.shapeData.getShapeType()===v.ShapeType.TextBox)&&(g.painterPath=d,d.setFillRule(1)),p&&a&&a.fill&&a.fill.type&&(!c.hasOwnProperty("stroke")||c.stroke)){var y=Object(us.d)(a);y.width+=635*e/this.scale;var m=(new sl).complexStrokePath(u,y,s,r);if(!m.isQPainterPath)continue;m.data?(m.setFillRule(1),g.strokerPath=m):d&&(g.strokerPath=d,d.setFillRule(1))}else{var _=new sl,w=635*e/this.scale,S=_.complexStrokePath(u,{width:w},s,r);S.isQPainterPath&&(S.setFillRule(1),g.strokerPath=S)}l.push(g)}return this.hitTestPath=l,l}},{key:"draw2DShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.preloadSource,n=this.parentLayout,r=this.measureShapeBody,a=r.fill,o=r.layout,s=r.picture,l=r.outline,h=r.effects,u=o.paths,c=o.drawRect,d=o.shapeRealyRect,p=o.shapeRealyRect.height(),f=o.shapeRealyRect.width();if(c.height=u.outScaleY?c.height/u.outScaleY:c.height,0!==p||0!==f){var g=u.matrix||new window.QMatrix,y=void 0,v=void 0,m=d.width()>2e4||d.height()>2e4;if(!m&&ju(h)||Yu(h)||zu()||Wu(h)||Ku(h)){var _=Fs(d.width(),d.height());if((v=(y=_.getElem()).getContext("2d")).translate(-d.x(),-d.y()),this.shapeRender(v,t),!Wu(h)){var w=new Vu({orginlCanvasImage:y,effects:h,layout:o,fill:a,outline:l,preloadSource:i,parentLayout:n,matrix:g,picture:s});w.render(e)}}if(this.shapeRender(e,t),Wu(h)){var S=new Vu({orginlCanvasImage:y,effects:h,layout:o,fill:a,outline:l,preloadSource:i,parentLayout:n,matrix:g,picture:s});S.render(e)}}}},{key:"shapeRender",value:function(e,t){var i=this,n=this.measureShapeBody,r=this.scale,a=this.preloadSource,o=this.parentLayout,s=n.fill,l=n.layout,h=n.picture,u=n.outline,c=l.paths,d=c.matrix||new window.QMatrix,p=c.resetMatrix||new window.QMatrix;if(t||d.mapContext(e),c.forEach((function(t){var n=t.attributes,c=t.painterPath,d=t.strokerPath,f=n.fill,g=!1;s&&s.type&&f!==Be.f.None&&(new ol({fill:s,path:t,layout:l,preloadSource:a,parentLayout:o,matrix:p}).render(e)&&(i.clipFillShape(e,s,l,t,p)||(e.beginPath(),c.toContextPath(e),e.isSvg?e.fill("evenodd",C.PartOfShapeName.ShapeFillPath()):e.fill("evenodd"),g=!0)));u&&u.fill&&u.fill.type&&(!n.hasOwnProperty("stroke")||n.stroke)&&!h&&(new sl({outline:u,path:t,layout:l,scale:r}).render(e)&&(d&&d!==c?(e.beginPath(),d.toContextPath(e),e.isSvg?e.fill("nonzero",C.PartOfShapeName.ShapeOutlinePath()):e.fill("nonzero")):g&&d===c?e.stroke():(e.beginPath(),c.toContextPath(e),e.stroke(C.PartOfShapeName.ShapeOutlinePath()))))})),h&&!h.isDefaultPic&&a){var f=h&&h.blip&&h.blip.blipAtom&&h.blip.blipAtom.imageId;e.save(C.PartOfShapeName.ShapeImage(this.shapeData.getId(),f)),new Hu({layout:l,outline:u,picture:h,preloadSource:a,shape:this.shapeData}).render(e,u,l,r),e.restore()}}},{key:"clipFillShape",value:function(e,t,i,n,r){if(t.hasOwnProperty("rotateWithShape")&&!t.rotateWithShape&&e.fillGradinet&&i&&i.drawRect){var a=new window.QMatrix,o=new window.Rect(0,0,i.drawRect.width,i.drawRect.height),s=i.drawRect.rotation?i.drawRect.rotation:0;a.translate(o.center().x(),o.center().y()),a.rotate(s),a.translate(-o.center().x(),-o.center().y());var l=a.mapRect(o);return e.save(),n.painterPath.toContextPath(e),e.clip(),r.mapContext(e),e.drawImage(e.fillGradinet,l.x(),l.y()),e.restore(),delete e.fillGradinet,!0}return delete e.fillGradinet,!1}},{key:"parentLayout",get:function(){return this.layout.parentLayout}},{key:"shapeData",get:function(){return this.layout.shapeData}}]),e}(),Xu=i(1012),Ju=function(){function e(t){r()(this,e),this._inkData=t,this.inkPath=[],this.inkMapTrace=[]}return o()(e,[{key:"render",value:function(e,t,i){if(t){this.layout=t;var n=t.getRealRectPx();if(n.width&&n.height){t.inkVisual=this;var r=e;r.translate(-n.x,-n.y);var a=!!i,o=this.layout.shapeData&&this.layout.shapeData.getId();if(a&&o<0)this.useInkPrevRender(e,i);else{var s=this.layout.shapeData&&this.layout.shapeData.isNiteInk();r.save("ink_"+o,s?"multiply":null);var l=Date.now();this._ctx=r;for(var h=this.getTraceVec(),u=0,c=h.length;u<c;u++){var d=this.mapTraceBy(n,h[u],u);if(d.length){var p=h[u].getTimeStamp();p&&r.save(p),this.drawInk(r,d,this.getBrushFrom(h[u])),p&&r.restore()}}r.restore(),console.log("inkRenderTimer 1",Date.now()-l)}}else console.warn("this extent is error",n)}}},{key:"mapInkContxtMatrix",value:function(e,t){var i=new window.QMatrix;if(t){var n=t.width,r=t.height,a=t.rotation;i.translate(n/2,r/2),i.rotate(a||0),i.translate(-n/2,-r/2)}i.mapContext(e)}},{key:"useInkPrevRender",value:function(e,t){var i=this.layout,n=i.shapeData&&i.shapeData.getId(),r=n&&t.querySelector("#ink_"+n);if(r){for(var a=i.getRealRectPx(),o=this.getTraceVec(),s=r.childNodes,l=0,h=o.length-1;h>=0;h--){var u=s[h],c=o[h]&&o[h].getTimeStamp();if(u&&Number(u.id)===Number(c)){l=h+1;break}}for(var d=new Vs.default,p=l;p<o.length;p++){var f=s[p],g=o[p].getTimeStamp();f&&f.remove();var y=this.mapTraceBy(a,o[p],p);y.length&&(g&&d.save(g),this.drawInk(d,y,this.getBrushFrom(o[p])),g&&d.restore())}for(var v=d.getSvg().lastElementChild||{};v.childNodes&&v.childNodes[0];)r.appendChild(v.childNodes[0]);e.__currentElement.appendChild(r)}}},{key:"drawInk",value:function(e,t,i){0!==t.length&&(i.getTip()===Tu?this.drawNiteInk(e,t,i):i.getTip()===xu?this.drawEllipseInk(e,t,i):console.warn("Brush::drop类型目前不支持"))}},{key:"drawNiteInk",value:function(e,t,i){var n=i.getWidthBy(C.UnitsLength.ti),r=i.getHeightBy(C.UnitsLength.ti);n<5&&(n=5),r<10&&(r=10);var a=i.getColor(),o=this.layout.scale;e.save(),e.fillStyle=a.rgba,e.beginPath(),this.generateFillPathFrom(e,t,n*o,r*o,i),e.fill(),e.restore()}},{key:"drawEllipseInk",value:function(e,t,i){var n=i.getWidthBy(C.UnitsLength.ti),r=i.getColor(),a=this.layout.scale;e.save(),e.lineWidth=n<10?10*a:n*a,e.strokeStyle=r.rgba,e.lineJoin="round",e.lineCap="round",1===t.length?this.drawPoint(e,t[0]):(e.beginPath(),i.fitToCurve()?this.fitToCuve(t,e):this.fitToLine(t,e),e.stroke()),e.restore()}},{key:"generateFillPathFrom",value:function(e,t,i,n,r){var a=r.getTip();if(a===Tu)if(1===t.length){var o=new window.Rect(t[0].x()-.5*i,t[0].y()-.5*n,i,n);e.addRect?e.addRect(o):function(e,t){e.moveTo(t.x(),t.y()),e.lineTo(t.x()+t.width(),t.y()),e.lineTo(t.x()+t.width(),t.y()+t.height()),e.lineTo(t.x(),t.y()+t.height()),e.lineTo(t.x(),t.y())}(e,o)}else{var s=new window.QPainterPath;r.fitToCurve()?this.fitToCuve(t,s):this.fitToLine(t,s);var l=[];this.appendNiteInkPolygons(s,i,n,l);for(var h=0,u=l.length;h<u;h++)e.addPolygon?e.addPolygon(l[h]):Qu(e,l[h])}else a===xu?console.warn("not implement,use drawpolygon parint"):a===ku&&console.warn("not implement");return e}},{key:"fitToCuve",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(e.length<=2&&e.length>0){t.moveTo(e[0].x(),e[0].y());for(var i=0;i<e.length;i++){var n=e[i];t.lineTo(n.x(),n.y())}return t}var r=Object(Xu.a)(e,e.length);if(!r||!r.length||r.length%3!=1)return console.warn("convert2Beziers curve is fail",r),null;if(t.moveTo(e[0].x(),e[0].y()),1===e.length)return t.lineTo(e[0].x()+1e-4,e[0].y()),t;for(var a=window.Point,o=1,s=r.length;o<s-2;){var l=r[o++],h=r[o++],u=r[o++];a["=="](l,h)&&a["=="](u,h)&&u.x()===u.y()&&0===u.x()||t.bezierCurveTo(l.x(),l.y(),h.x(),h.y(),u.x(),u.y())}return t}},{key:"fitToLine",value:function(e,t){if(!e||!e.length||!t)return console.warn("pts is Empty",e),null;if(t.moveTo(e[0].x(),e[0].y()),1===e.length)return t.lineTo(e[0].x()+1e-4,e[0].y()),t;for(var i=1,n=e.length;i<n;i++)t.lineTo(e[i].x(),e[i].y());return t}},{key:"appendNiteInkPolygons",value:function(e,t,i,n){var r=e.toSubpathPolygons();if(Array.isArray(r))for(var a=0,o=r.length;a<o;a++)for(var s=r[a],l=0,h=s.length;l<h-1;l++)this.appendNiteInkPolygon(s[l],s[l+1],t,i,n)}},{key:"appendNiteInkPolygon",value:function(e,t,i,n,r){if(e&&t){var a=new window.Rect(e.x()-i/2,e.y()-n/2,i,n),o=new window.Rect(t.x()-i/2,t.y()-n/2,i,n);if(e.x()===o.x()&&e.y()===o.y())r.push(Zu(a));else if(e.x()===t.x()){var s=void 0,l=void 0;e.y()<t.y()?(s=o.bottomRight().x()-a.x(),l=o.bottomRight().y()-a.y(),r.push(Zu(new window.Rect(a.x(),a.y(),s,l)))):(s=a.bottomRight().x()-o.x(),l=a.bottomRight().y()-o.y(),r.push(Zu(new window.Rect(o.x(),o.y(),s,l))))}else if(e.y()===t.y()){var h=void 0,u=void 0;e.x()<t.x()?(h=o.bottomRight().x()-a.x(),u=o.bottomRight().y()-a.y(),r.push(Zu(new window.Rect(a.x(),a.y(),h,u)))):(h=a.bottomRight().x()-o.x(),u=a.bottomRight().y()-o.y(),r.push(Zu(new window.Rect(o.x(),o.y(),h,u))))}else{var c=void 0,d=void 0;e.y()<t.y()?(c=a,d=o):(c=o,d=a);var p;p=[c.topLeft(),c.topRight(),d.topRight(),d.topLeft(),c.topLeft()];var f;f=[c.bottomLeft(),c.bottomRight(),d.bottomRight(),d.bottomLeft(),c.bottomLeft()];var g=void 0,y=void 0;e.x()<t.x()?(g=a,y=o):(g=o,y=a);var v;v=[g.topLeft(),y.topLeft(),y.bottomLeft(),g.bottomLeft(),g.topLeft()];var m;m=[g.topRight(),y.topRight(),y.bottomRight(),g.bottomRight(),g.topRight()],r.push(v),r.push(m),r.push(p),r.push(f)}}}},{key:"drawPoint",value:function(e,t){e.beginPath(),e.moveTo(t.x(),t.y()),e.lineTo(t.x()+1e-4,t.y()),e.stroke()}},{key:"getTraceVec",value:function(){return this._inkData.getTraceVec()}},{key:"mapTraceBy",value:function(e,t,i){return this.inkMapTrace[i]||(this.inkMapTrace[i]=this._inkData.mapTraceBy(e,t)),this.inkMapTrace[i]}},{key:"getBrushFrom",value:function(e){return this._inkData.getBrushFrom(e)}},{key:"hitTest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(!e||!this.layout)return!1;var i=this.layout,n=i.getRealRectPx();this.expandHitTestDisTance=t/i.scale;for(var r=this.getTraceVec(),a=0,o=r.length;a<o;a++){var s=this.mapTraceBy(n,r[a],a);if(s.length&&this.hitTestInk(s,this.getBrushFrom(r[a]),e,a))return!0}return!1}},{key:"hitTestInk",value:function(e,t,i,n){return t.getTip()===Tu?this.hitTestNiteInk(e,t,i,n):t.getTip()===xu?this.hitTestEllipseInk(e,t,i,n):(console.error(!1),!1)}},{key:"hitTestEllipseInk",value:function(e,t,i,n){var r=this.inkPath[n];return r||(this.inkPath[n]=r=this.createEllipseInkPath(e,t)),r.contains(i)}},{key:"hitTestNiteInk",value:function(e,t,i,n){var r=window.QPainterPath,a=this.inkPath[n];if(!a){(a=new r).setFillRule(1);var o=this.expandHitTestDisTance,s=t.getWidthBy(C.UnitsLength.ti)+o,l=t.getHeightBy(C.UnitsLength.ti)+o;s<5&&(s=5),l<10&&(l=10);var h=this.layout.scale;this.generateFillPathFrom(a,e,s*h,l*h,t),this.inkPath[n]=a}return a.contains(i)}},{key:"createEllipseInkPath",value:function(e,t){var i=new window.QPainterPath;1===e.length?(i.moveTo(e[0]),i.lineTo(new window.Point(e[0].x()+1,e[0].y()+1))):t.fitToCurve()?this.fitToCuve(e,i):this.fitToLine(e,i);var n=this.layout.scale,r=this.expandHitTestDisTance,a={width:(t.getWidthBy(C.UnitsLength.ti)+r)*n,capStyle:ue.LineCapRound,joinStyle:_e.LineJoinTypeRound};a.endCapStyle=a.capStyle,a.startCapStyle=a.capStyle;var o=new Is;o.createStrokerFromPen(a);var s=o.createStroke(i,.25)||[];return s.setFillRule(1),s}}]),e}();function Zu(e){var t=[];return t.push(new window.Point(e.x(),e.y())),t.push(new window.Point(e.x()+e.width(),e.y())),t.push(new window.Point(e.x()+e.width(),e.y()+e.height())),t.push(new window.Point(e.x(),e.y()+e.height())),t.push(new window.Point(e.x(),e.y())),t}function Qu(e,t){e.moveTo(t[0].x(),t[0].y());for(var i=0,n=t.length;i<n;i++){var r=t[i];e.lineTo(r.x(),r.y())}}function $u(e,t,i,n,r){if(i){if(Ol.debug_Axis_Linewidth>0){e.save();var a=i.getRealRect();e.strokeStyle="blue",e.lineWidth=Ol.debug_Axis_Linewidth,e.strokeRect(a.x,a.y,a.width,a.height),e.restore()}var o=i.getExtendList()||{},s=o.measureShapeBody,l=o.typoTextBody,h=o.typoTableBody,u=o.inkBody,c=t.getId();if(s){var d=C.PartOfShapeName.Geomerty(c);n&&(n.isHD?d+="_HD":n.isLD&&(d+="_LD")),e.clearDefById(d),e.save(d,null,!0);var p=i.scale,f=Date.now(),g=s.fill,y=g&&g.type;e.save(C.PartOfShapeName.ShapeFill(c,y)),r&&r.mapContext(e);var v=new qu(i);window.shapeTime+=Date.now()-f,v.render(e,p,n),e.restore(),e.restore()}if(u)e.save(),r&&r.mapContext(e),new Ju(u).render(e,i,n.inkPrevNode),e.restore();if(l){var m=Date.now(),_=C.PartOfShapeName.Text(c);if(e.clearDefById(_),e.save(_,null,!0),e.isSvg&&n&&Object.keys(n).includes(""+window.wppDefaultImageId)){var w=e.getCurrentElement();w&&w.setAttribute("class","content-placeholder-text-default-image")}var S=i.getFrameRotation(),x=i.getRealRect(),T=l.overflowLeft,k=l.overflowTop;e.save();var b=x.width/2,E=x.height/2;e.translate(+(x.x+b).toFixed(8),+(x.y+E).toFixed(8)),e.rotate(S*Math.PI/180),T<0&&(b-=T),k<0&&(E-=k),e.translate(+(-b).toFixed(8),+(-E).toFixed(8)),zh.getInstance(i.scale).render(e,l,n),e.restore(),e.restore(),window.textTime+=Date.now()-m}else if(h){var R=C.PartOfShapeName.Table(c);e.clearDefById(R),e.save(R,null,!0),r&&r.mapContext(e),new tu(h,n).render(e),e.restore()}}}$u.getUploadId=function(e,t){var i=function(e){for(;e&&!e.getPresentation;)e=e.getParent();return e&&e.getPresentation&&e.getPresentation()}(e);return i&&i.getUploadId(t)};var ec=function(e){if(!e)return[];for(var t=e.getChilds(),i=[],n=0;n<t.length;n++){var r=t[n],a=r.getTextFrame();a&&i.push.apply(i,S()(tc(a)));var o=r.visual.getFill();if(o&&o.blip&&o.blip.hasOwnProperty("blipAtom")){var s=o.blip.blipAtom.imageId?o.blip.blipAtom.imageId:null,l=!o.isStretched;i.push({imageId:s,isNoCompressor:l})}}var h=e.visual.getStyle(),u=h&&h.getWholeTable(),c=u&&u.getCellStyle(),d=c&&c.fill;if(d&&d.blip&&d.blip.hasOwnProperty("blipAtom")){var p=d.blip.blipAtom.imageId?d.blip.blipAtom.imageId:null,f=!d.isStretched;i.push({imageId:p,isNoCompressor:f})}var g=e.visual.getFill();if(g&&g.blip&&g.blip.hasOwnProperty("blipAtom")){var y=g.blip.blipAtom.imageId?g.blip.blipAtom.imageId:null,v=!g.isStretched;i.push({imageId:y,isNoCompressor:v})}return i},tc=function(e){if(!e)return[];var t=[];if(e.getProperty().textWarp)return t;for(var i=e.visual,n=i&&i.getCompleteTextProps(),r=0,a=n?n.length:0;r<a;++r){var o=n[r]&&n[r].chpProps;if(o)for(var s=0,l=o.length;s<l;s++){var h=o[s];if(h){var u=h.props,c=u&&u.textColor;if(c&&c.blip&&c.blip.hasOwnProperty("blipAtom"))if("continue"===function(){var e=c.blip.blipAtom.imageId?c.blip.blipAtom.imageId:null,i=!c.isStretched;if(t.find((function(t){return t.imageId===e})))return"continue";t.push({imageId:e,isNoCompressor:i})}())continue}}}return t},ic=function(e){if(e&&e.blip&&e.blip.hasOwnProperty("blipAtom")){var t=e.blip.blipAtom.imageId?e.blip.blipAtom.imageId:null,i=!e.isStretched,n=e.blip.blipAtom.size?e.blip.blipAtom.size:0;return e.isObjectPlaceholder&&Array.isArray(t)?t.map((function(t){return{imageId:t,isNoCompressor:i,size:n,imageWidth:e.blip.blipAtom.imageWidth||0,imageHeight:e.blip.blipAtom.imageHeight||0}})):[{imageId:t,isNoCompressor:i,size:n,imageWidth:e.blip.blipAtom.imageWidth||0,imageHeight:e.blip.blipAtom.imageHeight||0}]}return[]};function nc(e,t,i,n,r){if(e.isTextFrame){if(e.getProperty().textWarp)return!1;var a=e.getTextStream();if(a){if(e.isMath)return!1;var o=a.getAllText();if(!o||!o[0]||o[0]===String.fromCharCode(13)&&o.length<2)return!0;if(rc(i))return!1;if(n||r)return!1}return!0}return!1}function rc(e){return e&&Object.keys(e)>0}$u.getImageIdArr=function(e,t){var i=e,n=[];if(!i||!i.private)return n;var r=i.private.fill||t;if(r)if(r.type===Be.e.FillTypeGroup){var a=i.parent,o=a&&a.private.fill;o&&n.push.apply(n,S()(ic(o)))}else n.push.apply(n,S()(ic(r)));var s=i.private.picture;s&&n.push.apply(n,S()(ic(s)));for(var l=i.private.childs,h=0;h<l.length;h++){var u=l[h];u&&u.isTableFrame?n.push.apply(n,S()(ec(u))):u&&u.isTextFrame&&n.push.apply(n,S()(tc(u)))}var c=[];return n.forEach((function(e){c.find((function(t){return t.imageId===e.imageId}))||c.push(e)})),c},$u.isSupportRenderShape=function(e,t,i){if(e.isMath())return!1;var n=e.getScene3D(),r=e.getShape3D(),a=e.getEffects(),o=e.parent&&e.parent.private.effects,s=e.private.geometry2D;for(var l in a){if(!s)return!1;if("softEdges"===l)return!1;if(n||r)return!1}if(rc(o))return!1;var h=e.getChilds();if(window.ShapeUtil.showNotesBody(e))return!0;if(h instanceof Array)for(var u=0;u<h.length;u++){var c=h[u];if(c){var d=c.private.scene3D;if(rc(d))return!1;if(c.isTableFrame)for(var p=c.getChilds(),f=0,g=p.length;f<g;f++){var y=p[f].getTextFrame();if(y&&y.isTextFrame&&!nc(y,t,r,d))return!1}else{if(!c.isTextFrame)return!1;if(!nc(c,t,a))return!1}}}for(var v=$u.getImageIdArr(e,i),m=0;m<v.length;m++){if("string"==typeof v[m].imageId)return!0;if($u.getUploadId(e,v[m].imageId))return!0}var _=e.getPicture();return!_||!function(e){var t=e.blip;if(!t)return!1;var i=t.colorMap,n=t.effects,r=t.fillMap,a=t.imageLayer;if(i&&i.length>0||r&&r.length>0)return!0;if(n&&n.length>0&&(1!==n.length||6!==n[0].type))return!0;if(a&&a.effects.length>0)return!0;return!1}(_)},window.shapeTime=0,window.textTime=0;var ac=i(2268),oc=i(344),sc=window.mediaPool=new Hs.a(1/0),lc=function(e){return[void 0,void 0,e.mediaId,"media"].join("_")},hc=function(e){function t(e){var i=this;r()(this,t);var n,a,o,s,h=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return h._requestMediaTrans=(n=st()(regeneratorRuntime.mark((function e(t){var n,r,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.dispatch(Object(ac.b)(h._map[t]));case 2:n=e.sent,console.log(t,"request media transform",n,h._map[t]),n.type===oc.HTTP_SUCCESS?"err"===(r=n.response||{}).result||"close"===r.result?(console.log("request media transform error, server close"),"close"===r.result&&(h.isServerClose=!0),h.setMediaData({mediaId:t,data:{serverError:r.result}}),h._next()):(a=0,o=function(e){return(a+=1)>=30&&clearInterval(e),console.log("trans degree 100 times:",a),a},s=setInterval((function(){h._requestMediaTranspeed(t,s,o)}),1e3)):(console.log("request media transform error",t),h.onError(t));case 5:case"end":return e.stop()}}),e,i)}))),function(e){return n.apply(this,arguments)}),h._requestMediaTranspeed=(a=st()(regeneratorRuntime.mark((function e(t,n,r){var a,o,s,l,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.dispatch(Object(ac.c)(h._map[t]));case 2:if(a=e.sent,console.log("media requestTranspeed",a),a.type!==oc.HTTP_SUCCESS){e.next=24;break}if("err"!==(o=a.response||{}).result&&"close"!==o.result){e.next=12;break}return console.log("trans check speed result err, server close"),"close"===o.result&&(h.isServerClose=!0),h.setMediaData({mediaId:t,data:{serverError:o.result}}),h._next(),e.abrupt("return");case 12:if(s=o.results,l=s&&s[0]){e.next=17;break}return console.log("check media trans speed error, return data is undefine"),e.abrupt("return");case 17:u=!(void 0!==l.degree||!l.url),100==l.degree&&(u=1===r(n)),(u||-1==l.degree||l.err)&&h._next(),l.url||-1==l.degree||l.err?(-1==l.degree&&(l.err=!0),clearInterval(n),h.setMediaData({mediaId:t,data:l})):h.fire("get_media_trans_degree_"+t,l.degree),console.log(t,"check media trans speed: ",l.degree,l),e.next=27;break;case 24:console.log("media requestTranspeed error",a),clearInterval(n),h.onError(t);case 27:case"end":return e.stop()}}),e,i)}))),function(e,t,i){return a.apply(this,arguments)}),h._checkMediaExist=(o=st()(regeneratorRuntime.mark((function e(t){var n,r,a,o,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.isArray(t)?[].concat(S()(t)):[t],r=n.map((function(e){return h._map[e].sha1})),e.next=4,h.dispatch(Object(ac.a)(r,!1,!0));case 4:(a=e.sent).type===oc.HTTP_SUCCESS?(o=a.response.urls,console.log(n,"check media exist",o),r.forEach((function(e,t){var i=n[t];if(o&&!o[e])h._requestMediaUrl({mediaId:i});else if(s){var r={sha1:e,url:o[e]};h.setMediaData({mediaId:n[t],data:r})}else h._requestMediaTrans(i)})),s&&!l&&h._next()):(console.log(n,"media queryMediaExist error",a),r.forEach((function(e,t){h._requestMediaTrans(n[t])})));case 6:case"end":return e.stop()}}),e,i)}))),function(e){return o.apply(this,arguments)}),h._refreshMediaUrl=(s=st()(regeneratorRuntime.mark((function e(t,n,r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.dispatch(Object(ac.a)([t],n));case 2:a=e.sent,console.log("update media url",a),o=void 0,a.type===oc.HTTP_SUCCESS&&(o=a.response&&a.response.urls&&a.response.urls[t]),r&&r(o);case 7:case"end":return e.stop()}}),e,i)}))),function(e,t,i){return s.apply(this,arguments)}),h._map={},h._keyArr=[],h.target=null,h.isWorking=!1,h.errorTime=null,h.isServerClose=!1,h._uploadIds=[],h}return u()(t,e),o()(t,[{key:"dispatch",value:function(e){return window.APP.dispatch(e)}},{key:"_getKey",value:function(e){var t=this.doc.getMediaUploadId(e),i=this._uploadIds.indexOf(t);return i>=0&&this._uploadIds.splice(i,0),e}},{key:"_canTrans",value:function(){return!this.errorTime||Date.now()-this.errorTime>6e5}},{key:"onError",value:function(e){this.errorTime=Date.now(),this.isWorking=!1,this.setMediaData({mediaId:e,data:{serverError:!0}})}},{key:"addMedia",value:function(e){var t=this;if(e&&!e.isHidden()){if(e.isMedia()){var i=e.getMedia();if(i){var n=e.isVideo()?"video":"audio";this._addMedia(i,n)}else console.log("shape media undefine",e.getId())}var r=e.getActions&&e.getActions();r&&this._addActionMeida(r);var a=e.getTextFrame(),o=a&&a.getTextStream(),s=o&&o.getChpTbl(),l=s&&s.getItemsArray();l&&l.forEach((function(e){var i=e.getProp(),n=i&&i.getActions&&i.getActions();n&&t._addActionMeida(n)}))}}},{key:"_addActionMeida",value:function(e){var t=this,i=e.mouseClick,n=e.mouseOver,r=function(e){var i=e.soundEffect,n=i&&i.media;n&&t._addMedia(n,"audio")};i&&r(i),n&&r(n)}},{key:"addAnimSound",value:function(e){var t=this;if(e){var i=e.getTiming(),n=i&&i.mainSequence,r=n&&n.getEffects();r&&r.forEach((function(e){var i=e.private.soundEffect,n=i&&i.media,r=n&&n.sha1;n&&t.isPresetSound(r)&&t._addMedia(n,"audio")}));var a=e.getTransition(),o=a&&a.data,s=o&&o.soundEffect,l=s&&s.media,h=l&&l.sha1;l&&this.isPresetSound(h)&&this._addMedia(l,"audio")}}},{key:"isPresetSound",value:function(e){return!this.isServerClose||e&&cc[e]}},{key:"_addMedia",value:function(e,t){var i=e.isEmbed,n=e.mediaId,r=e.sha1;if(!i)return this.setMediaData({mediaId:n,data:{err:!0}}),void console.log("shape media not exist",n);if(!this._uploadIds.includes(n)){var a=this._getKey(n);this._map[a]||this._keyArr.includes(a)||(this._keyArr.push(a),this._map[a]={sha1:r,type:t}),this.isWorking||this._next()}}},{key:"transFirst",value:function(e){var t=e.key,i=e.data,n=this._getKey(t);console.log("media transFirst",n,this.target,this.target===n),this.target!==n&&this._keyArr[0]!==n&&(this._map[n]||(this._map[n]=i),this._delete(n),this._keyArr.unshift(n),this.isWorking||this._next())}},{key:"_delete",value:function(e){var t=this._keyArr.indexOf(e);-1!==t&&this._keyArr.splice(t,1)}},{key:"_next",value:function(){if(this.target=this._keyArr[0],this.target)if(this._canTrans()){this._keyArr.shift(),this.isWorking=!0;var e=this._map[this.target].noNeedTrans;if(this.isServerClose&&!e)this.setMediaData({mediaId:this.target,data:{serverError:"close"}}),this._next();else{var t=this._map[this.target].noNeedTrans;if(t){var i=[];i.push(this.target);for(var n=this._keyArr[0],r=this._map[n];r&&r.noNeedTrans;)i.push(n),this._keyArr.shift(),n=this._keyArr[0],r=this._map[n];this.target=i}this._checkMediaExist(this.target,t)}}else{var a=Date.now()-this.errorTime/60/1e3;console.log("server trans error, try after "+(10-a)+" minutes later"),this.setMediaData({mediaId:this.target,data:{serverError:!0}}),this.isWorking=!1}else 0===this._keyArr.length&&(this.isWorking=!1,console.log("----------media trans done---------"))}},{key:"_requestMediaUrl",value:function(e){var t=this,i=e.mediaId,n=lc({mediaId:i});window.backendImageManager.requestMediaUrl({key:n,mediaId:i},(function(e){console.log(i,"use getImages before media trans",e);var n=t._map[i].noNeedTrans;n?t._checkMediaExist(i,n,!0):(t._map[i].sha1=e.sha1,t._requestMediaTrans(i))}))}},{key:"getMediaData",value:function(e,t){var i=e.mediaId,n=e.data,r=e.isReTransErr;this.getMediasData({mediaIds:[i],dataMap:d()({},i,n),isReTransErr:r},t)}},{key:"getMediasData",value:function(e,t){var i=this,n=e.mediaIds,r=e.dataMap,a=e.isReTransErr;n.forEach((function(e){var n=lc({mediaId:e}),o=sc.get(n),s=o&&o.data,l=i._getKey(e),h=s&&s.err&&a;s&&s.url?i.updateMediaUrl({mediaId:e,cb:function(e){t(e||s)}}):s&&(s.serverError||s.err&&!h)?t(s):i._uploadIds.includes(e)||(i.once("get_media_data_"+l,t),!h&&i._map[l]||i._keyArr.includes(l)||(i._map[l]=r[e],i._keyArr.push(l)))})),this.isWorking||this._next()}},{key:"getMediaDataSync",value:function(e){var t=lc({mediaId:e}),i=sc.get(t);return i&&i.data}},{key:"getMediaDuration",value:function(e,t,i){var n=e.mediaId,r=this,a=lc({mediaId:n}),o=sc.get(a);o&&o.data&&o.data.duration?t(o.data):(this.once("get_media_duration_"+n,t),this.doc.session.execSimpleQuery("queryMediaDuration",{mediaId:n},(function(e){e&&!e.error?r.setMediaDuration({mediaId:n,duration:e.duration/1e3}):i&&i(e)})))}},{key:"setMediaDuration",value:function(e){var t=e.mediaId,i=e.duration,n=lc({mediaId:t}),r=sc.get(n);i&&!r?(sc.set(n,{data:{duration:i}}),this.fire("get_media_duration_"+t,{duration:i})):i&&!r.data.duration&&(r.data.duration=i,sc.set(n,r),this.fire("get_media_duration_"+t,{duration:i}))}},{key:"setMediaData",value:function(e){var t=e.mediaId,i=e.data;e.insert&&(this._map[t]=!0);var n=lc({mediaId:t});!i.expires&&i.url&&(i.expires=this._getExpires(i.url));var r=Number(i.duration);isNaN(r)||(i.duration=r),i.mediaId=t,sc.set(n,{data:i}),this.fire("get_media_data_"+t,i),i.duration&&this.fire("get_media_duration_"+t,i)}},{key:"_getExpires",value:function(e){var t=Date.now()+3e5;if(e){var i=e.split("?")[1],n=i&&i.split("&");if(n)for(var r=0;r<n.length;r++){var a=n[r].split("=");if(a[0]&&"expires"===a[0].toLowerCase())return isNaN(a[1])?t:1e3*Number(a[1])}}return t}},{key:"_isTranscodeKey",value:function(e){if(e)return e.split("?")[0].toLowerCase().split("/").includes("transcode")}},{key:"updateMediaUrl",value:function(e){var t=this,i=e.mediaId,n=e.cb,r=this._getKey(i),a=lc({mediaId:r}),o=sc.get(a)||{},s=o.data||{},l=s.sha1,h=s.expires,u=s.url;if(h&&l&&this.isOverdue(h)){var c=this._isTranscodeKey(u);this._refreshMediaUrl(l,c,(function(e){e&&(o.data.expires=t._getExpires(e),o.data.url=e,sc.set(a,o)),n&&n(o.data)}))}else n&&n()}},{key:"isOverdue",value:function(e){return Date.now()>e}},{key:"getOnDegreeName",value:function(e){return"get_media_trans_degree_"+this._getKey(e)}},{key:"setUploadId",value:function(e){e&&!this._uploadIds.includes(e)&&this._uploadIds.push(e)}},{key:"doc",get:function(){return window.APP.shell.doc}},{key:"isServerClose",set:function(e){this._isServerClose=e},get:function(){return this._isServerClose}}]),t}(x.a);window.mediaManager=new hc;var uc=window.mediaManager,cc={"47c2bcb070b43e56086550a9286020c3c8773cfa":!0,d9ecab36eae62d2fa314402da59f5d13f490a157:!0,"659c5661b16b1bcc3d709e645e4adec17dfe84bd":!0,a9bd7db166a83242b05f42f1f82604fb0fe420a0:!0,"19cc2aee09ae7f0103a096ab7e22d88c2ac376f8":!0,"2b74b3651d8f672803691bd157dc4cc11eb8cc2c":!0,"6c036ba0eb3400393d5770954cf26dbaa130e4c4":!0,af3a454a49e701f6174ef7bc64fa38fe4b558b28:!0,"3d13223f180eb151f915752afbdb70b6c6745344":!0,"7f21d13e2422db382813d46b131c70f5de10841d":!0,"9706dc40183fe3f418f39569609dedb043a8266a":!0,d35ca6b60e75b2fbf4c84f54168b44deedfbcffd:!0,"08b55112db0325d8c8016ba48e1b136afdc403de":!0,"8bc09a788b48041e786b5739f425737de52f6a31":!0,"05353548a4d5e3a03d88fd9bd7e6840d87583935":!0,c9fae0bd3a971376db19b7d1e3e6e5a8b09379f3:!0,"1a187de64b3afa9350ce192ebecabab93b2144b3":!0,"0e6dc85800660fc2428e514ac6b38dec09f2f1ca":!0,"1b1a3a0afdcd468e338e65200cc673d18767e850":!0},dc=function(){function e(t){var i=t.parent,n=t.shapeData;r()(this,e),this.shapeData=n,this.parent=i,this.gid=Object(k.a)(),this.slideEnvLayout=null,this.fetchImageTokens=[],this.dataToken=n.data_token,this.getResourceSuccess=!0,this.preloading=!1;var a=this.getSlide();a&&a.root&&a.root.viewMode===C.ViewModes.PreView?this.needRenderAfterPreload=!1:this.needRenderAfterPreload=!0}return o()(e,[{key:"getData",value:function(){return this.shapeData}},{key:"getSlide",value:function(){return this.slide}},{key:"getPresentation",value:function(){return this.getSlide().getPresentation()}},{key:"getId",value:function(){return this.shapeData.getId()}},{key:"isGroupShape",value:function(){return this.shapeData.isGroupShape()}},{key:"isPlaceHolder",value:function(){return this.shapeData.isPlaceHolder()}},{key:"isRendered",value:function(){return!!this._finished}},{key:"isShapeTree",value:function(){return this.shapeData.isShapeTree}},{key:"getShapeType",value:function(){return this.shapeData.getShapeType()}},{key:"isNiteInk",value:function(){return this.shapeData.isNiteInk()}},{key:"clean",value:function(){this.stopRender()}},{key:"getGroupShapeTransform",value:function(e){for(var t=this.parent,i=[];t&&t.isGroupShape&&t.isGroupShape();){var n=t.shapeData.getTransform2D(),r=n||{},a=r.horizontalFlipped,o=r.verticalFlipped;(r.rotation||a||o)&&i.unshift(t.layout(e)),t=t.parent}return i}},{key:"isSlideLayoutChanged",value:function(e){if(!this.slideEnvLayout)return!0;for(var t in e){var i=e[t];for(var n in i)if(!Au.a.equals(i[n],this.slideEnvLayout[t][n]))return!0}return!1}},{key:"_getUpdateEvent",value:function(e){var t=this,i=e.filter((function(e){return e&&e.id===t.getId()})),n=i.find((function(e){return e&&e.e&&e.e.event===Pu.default.modify_shape}));return n||i[i.length-1]}},{key:"render",value:function(e,t,i){var n=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments[4];try{var o=this.shapeData.getSlide();if(this.isDestroy||!this.shapeData.parent||o&&!o.parent)return!0;this.slideCtx=e,this.slideEnvLayout=t,this.scale=i,this.prevNode=this.svgNode;var s=this._getUpdateEvent(r),l=s&&s.e,h=this.dataToken!==this.shapeData.data_token||!this._finished||!this._hasRendered||s;if(this.prevNode&&(this.event=l,this.event&&(this.event.isNewParentNode=a)),this.shapeTree.cacheIds.push("c_"+this.getId()),!h&&!a)return this.updateRect(),!0;var u=this.label||"s_"+this.getId();this.preloading=!1,this.svgNode=e.save(u),!h&&this.parent.isShapeTree()||(this.parent.tokenMap&&(this.parent.tokenMap.delete(this.dataToken),this.parent.tokenMap.set(this.shapeData.data_token,this)),this.layoutResult=null),this.dataToken=this.shapeData.data_token,this.addMediaResource();var c=this.getResourceSync();if(this.shapeData.isInk()&&this.prevNode&&(c.inkPrevNode=this.prevNode),c&&this.isResourceValid(c)?(h||a&&!this.parent.isShapeTree()?(e.save(),this._draw(e,i,c),e.restore(),this._finished=!0,this._hasRendered=!0):a&&window.domTools.appendChildNodes(this.prevNode,this.svgNode),this.updateRect()):this.preloading||(this.event?this.addLoading():this._loadingTimer=setTimeout((function(){n.preloading&&n.addLoading()}),500),this.preload()),this.prevNode!==this.svgNode&&e.restore(),a){var d=this.getUpdatePartOfShape();d&&d!==C.UpdatePartOfShape.UpdateShape?(this._partialUpdate(l),window.domTools.appendChildNodes(this.prevNode,this.svgNode)):this.prevNode&&this.prevNode.remove()}else h&&this.prevNode&&(this._partialUpdate(l),this.svgNode.remove(),this.svgNode=this.prevNode);return this._finished=!0,this.saveLayoutResult(),!0}catch(t){this.prevNode!==this.svgNode&&e.restore(),console.error(t)}}},{key:"_partialUpdate",value:function(e){if(e){var t=this.getUpdatePartOfShape();e.updatePartName=[],e.updateAttrName=[];var i=this.layoutResult&&this.layoutResult.getExtendList(),n=i&&i.measureShapeBody,r=n||{},a=r.shape3d,o=r.scene3d;if(o&&Object.keys(o).length>0||a&&Object.keys(a).length>0)window.domTools.appendChildNodes(this.svgNode,this.prevNode);else{var s=this.getId();if(t===C.UpdatePartOfShape.UpdateText){if(!this.shapeData.hasTable()){var l=C.PartOfShapeName.Text(s),h=this.svgNode&&this.svgNode.querySelector("g#"+l),u=this.prevNode&&this.prevNode.querySelector("g#"+l);return window.domTools.appendChildNodes(h,u),void e.updatePartName.push(l)}var c=e.cellIdx;if(this._updatePartOfTable(c)){var d=C.PartOfShapeName.TableText(c),p=this.svgNode&&this.svgNode.querySelector("g#"+d),f=this.prevNode&&this.prevNode.querySelector("g#"+d);return window.domTools.appendChildNodes(p,f),void e.updatePartName.push(d)}}else if(t===C.UpdatePartOfShape.UpdateShapePic){var g=n&&n.picture,y=g&&g.blip&&g.blip.blipAtom&&g.blip.blipAtom.imageId,v=this.slideCtx.__defs;if(window.domTools.updateChildNodes(this.svgNode,this.prevNode,v,v)){var m=C.PartOfShapeName.ShapeImage(s,y);return void e.updateAttrName.push(m)}}else if(t===C.UpdatePartOfShape.UpdateShapePicFill){var _=n&&n.fill,w=_&&_.type,S=C.PartOfShapeName.ShapeFill(s,w),x=this.svgNode&&this.svgNode.querySelector("g#"+S),T=this.prevNode&&this.prevNode.querySelector("g#"+S),k=this.slideCtx.__defs;if(window.domTools.updateChildNodes(x,T,k,k)){var b=C.PartOfShapeName.Text(s),E=this.svgNode&&this.svgNode.querySelector("g#"+b),R=this.prevNode&&this.prevNode.querySelector("g#"+b);return window.domTools.appendChildNodes(E,R),e.updateAttrName.push(S),void e.updatePartName.push(b)}}e.updatePartName&&delete e.updatePartName,e.updateAttrName&&delete e.updateAttrName,window.domTools.appendChildNodes(this.svgNode,this.prevNode)}}else window.domTools.appendChildNodes(this.svgNode,this.prevNode)}},{key:"_updatePartOfTable",value:function(e){var t=this.layoutResult&&this.layoutResult.getExtendList(),i=(t&&t.typoTableBody).tableVisual;return!(!i.updateCellVisuals||!i.updateCellVisuals.find((function(t){return t.getIndex()===e})))&&(delete i.updateCellVisuals,!0)}},{key:"_stopPreload",value:function(){this.preloading=!1,this.fetchImageTokens&&(this.fetchImageTokens.forEach((function(e){e&&e.stop()})),this.fetchImageTokens=[])}},{key:"addPreloadCb",value:function(e){this.preloadCallBacks=this.preloadCallBacks||[],this.preloadCallBacks.push(e)}},{key:"stopRender",value:function(){this._stopPreload(),this.stoped=!0}},{key:"_draw",value:function(e,t,i){this._render(e,t,i)}},{key:"renderShapeBlip",value:function(e,t){var i=this.layout(this.scale),n=new window.QMatrix;e.save(),e.scale(this.scale,this.scale),$u(e,this.shapeData,i,t,n),e.restore()}},{key:"_render",value:function(){console.error(new Error("method must be implemented!"))}},{key:"isShapeInVisibleArea",value:function(e,t){return!0}},{key:"layout",value:function(e){try{if(!e||this.layoutResult&&this.shapeData.data_token===this.dataToken)return this.layoutResult;if(this.isShapeTree())return null;var t=null;this.parent&&this.parent.isGroupShape&&this.parent.isGroupShape()&&(t=this.parent.layout(e));var i=this.getSlide(),n=i&&i.getData(),r=this.event;return this.layoutResult=(a={shapeData:this.shapeData,parentLayout:t,scale:e,slideEnvLayout:this.slideEnvLayout,shapeLayout:this.layoutResult,isLocalShape:this.isLocalShape(),currentSlideData:n,updateEvent:r,prevLayoutResult:this.prevLayoutResult},new Iu(a).measure()),this.scale=e,this.layoutResult}catch(e){console.error(e)}var a}},{key:"saveLayoutResult",value:function(){var e=this.prevLayoutResult;if(e!==this.layoutResult){if(this.getUpdatePartOfShape()===C.UpdatePartOfShape.UpdateText){var t=(this.prevLayoutResult||{}).shapeVisual;if(t){this.layoutResult.shapeVisual=t;var i=t.layout,n=i&&i.getExtendList();n&&t.updateMeasureShapeBody(n.measureShapeBody),t.updateLayout(this.layoutResult)}}if(this.layoutResult){var r="c_"+this.getId();this.shapeTree.layoutCache[r]=this.layoutResult,e&&e.destroy(),this.layoutResult.props.prevLayoutResult=null}}}},{key:"requestRenderAll",value:function(e){this.updateRect(),this.parent&&this.parent.requestRenderAll(e)}},{key:"isLocalShape",value:function(){return!0}},{key:"setHitInVisible",value:function(e){this._isHitInVisible=e}},{key:"hitTest",value:function(e,t,i,n){if((!this.getResourceSuccess||this.preloading)&&!this.isShowOriginGIFLoad())return null;if(this._isHitInVisible)return null;var r=this.layoutResult&&this.layoutResult.hitTest({x:e,y:t,isConnectorHitTest:n}),a=void 0,o=!1;return r&&(o=r.isHit,a=r),{shape:this,isHit:o,hitTestInfo:a}}},{key:"hitSelectObjectsByRect",value:function(e){return this.layoutResult&&this.layoutResult.hitSelectObjectsByRect(_()({},e))}},{key:"destroy",value:function(){this.isDestroy=!0}},{key:"getImageIdArr",value:function(){var e,t=this.shapeData,i=this.layout(this.scale);return e=i&&i.getShapeFill(),t=i&&i.shapeData,$u.getImageIdArr(t||this.shapeData,e)}},{key:"isHidden",value:function(){return this.shapeData.isHidden()}},{key:"isInk",value:function(){return this.shapeData.isInk()}},{key:"getUilLayoutRect",value:function(e){var t=this.layout(),i=window.Ti2Px;if(t)return t.getUilLayoutRect(e);var n=this.shapeData.visual.getTransform2D();if(n){var r=n.rotation,a=n.x,o=n.y,s=n.width,l=n.height;return window.zoomRect({rotate:r,x:i(a/635),y:i(o/635),width:i(s/635),height:i(l/635)},e)}return{x:0,y:0,width:0,height:0,horizontalFlipped:!1,rotate:0,verticalFlipped:!1}}},{key:"getUilGeometryRect",value:function(e){var t=this.layout();return t?t.getUilGeometryRect(e):this.getUilLayoutRect(e)}},{key:"getUpdatePartOfShape",value:function(){return this.layoutResult&&this.layoutResult.getUpdatePartOfShape()}},{key:"renderLoadImage",value:function(e){if(this.shapeData.isVideo()){var t=this.layout(this.scale),i=this.slideCtx.save();return this.renderMedia(this.slideCtx,t),i.remove(),window.domTools.appendChildNodes(i,this.svgNode),void this.requestRenderAll({shapeIds:this.getId(),shape:this,type:"updateShape"})}if(e){if(!e)return;this.removeImageError();var n=this.slideCtx.save(),r=this.layout(this.scale);if(!r)return;var a=r.getLayoutRect(),o=r.calcHitTestMatrix(),s=a.width,l=a.height,h="s_"+this.getId()+"_load";this.slideCtx.save(h),o.mapContext(this.slideCtx),this.slideCtx.fillStyle="#F5F7F9",this.slideCtx.fillRect(0,0,s,l);var u=s/2-50,c=l/2-50;s>=100&&l>=100&&this.slideCtx.drawImage(e,u,c,100,100),this.slideCtx.restore(),this.slideCtx.restore(),n.remove(),window.domTools.appendChildNodes(n,this.svgNode),this.requestRenderAll({shapeIds:this.getId(),shape:this,type:"updateShape"})}else{this.getResourceSuccess=!1,this.addImageError();for(var d=this.svgNode.childNodes;d[0];)d[0].remove();var p=this.getSlide(),f=p&&p.getData();"p"===window.officeType&&f&&(f.isMasterSlide||f.isLayoutSlide)&&window.collection("newui","value",window.pcTrack.newui.pic_load_fail_layout),this.requestRenderAll({shapeIds:this.getId(),shape:this,type:"updateShape"})}}},{key:"reloadResource",value:function(){if(this.getResourceSuccess=!0,this.preloadingOriginURL){var e=this.getResourceSync();this.renderResource(e),this.loadOriginGIF()}else this.addLoading(),this.preload()}},{key:"renderResource",value:function(e,t){if(this._loadingTime&&(clearTimeout(this._loadingTimer),this._loadingTimer=null),this.getResourceSuccess&&(e||t)){var i=e.shape;if(this.removeLoading(!1),this.removeImageError(),i&&"updateShapes"===e.type){var n=this.slideCtx.save();this._draw(this.slideCtx,this.scale,e),this.slideCtx.restore(),n.remove(),this.svgNode.appendChild(n)}else{for(var r=this.svgNode.childNodes;r[0];)r[0].remove();if(e&&e.isLD&&Object.keys(e).length>1){var a=this.slideCtx.save();this._draw(this.slideCtx,this.scale,e),this.slideCtx.restore(),a.remove(),this.svgNode.appendChild(a)}if(t&&t.isHD&&Object.keys(t).length>1){var o=this.slideCtx.save();this._draw(this.slideCtx,this.scale,t),this.slideCtx.restore(),o.remove(),this.svgNode.appendChild(o)}}this.getResourceSuccess=!0,this.requestRenderAll({shapeIds:this.getId(),shape:this,type:"updateShape"})}else this.renderLoadImage();this._hasRendered=!0,this.imageLoading=!1}},{key:"getSlideView",value:function(){return this.slide}},{key:"addLoading",value:function(){if(this.preloadingOriginURL);else if(!this.imageLoading){var e=window.imagePool.get("loading");e&&e.image&&(this.renderLoadImage(e.image),this.imageLoading=!0,"p"===window.officeType&&window.collection("newui","value","pic_loading"))}}},{key:"removeLoading",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t="s_"+this.getId()+"_load",i=this.svgNode&&this.svgNode.querySelector("#"+t);i&&(i.remove(),e&&this.requestRenderAll({shapeIds:this.getId(),shape:this,type:"updateShape"}))}},{key:"removeImageError",value:function(){var e=this,t=this.getSlideView(),i=t&&t.getImageLoadErrorShapes();if(i){var n=i.findIndex((function(t){return t===e}));if(-1!==n)return i.splice(n,1),!0}return!1}},{key:"addImageError",value:function(){var e=this.getSlideView();e?e.imageLoadError(this):console.warn("renderLoadImage error!!")}},{key:"addMediaResource",value:function(){uc.addMedia(this.shapeData)}},{key:"renderMedia",value:function(e,t){var i=this.shapeData,n=t.getRealRectBeforeRotation(),r=n.width,a=n.height;i&&i.isVideo()&&(e.save(C.PartOfShapeName.Media(i.getId())),e.save(),e.fillStyle="rgba(0,0,0,0.2)",t.calcHitTestMatrix().mapContext(e),e.fillRect(0,0,r,a),e.restore(),e.restore())}},{key:"updateRect",value:function(e){if(this.parent&&this.parent.updateRect){if(!e&&this.layoutResult){var t=this.layoutResult.getShapeRealyRect(),i=this.layoutResult.getViewRectAfterRotate();e=t?{x:Math.min(t.x,i.x),y:Math.min(t.y,i.y),width:Math.max(t.x+t.width,i.x+i.width)-Math.min(t.x,i.x),height:Math.max(t.y+t.height,i.y+i.height)-Math.min(t.y,i.y)}:i}if(e){var n=e,r=n.x,a=n.y,o=n.width,s=n.height,l=function(e){return Math.round(100*e)/100};this.parent.updateRect({x:l(r),y:l(a),width:l(o),height:l(s)})}}}},{key:"_clearGIFLoadStatus",value:function(){this.hasLoadOriginURL=!0,this.preloadingOriginURL=!1}},{key:"loadOriginGIF",value:function(e){var t=this;this.addPreloadCb((function(i,n,r){if(r)return t._clearGIFLoadStatus(),e&&e(),!0})),this.preloadingOriginURL||(this.preloadingOriginURL=!0,this.preload(!0))}},{key:"isShowOriginGIFLoad",value:function(){var e=this.shapeData.getPicture(),t=e&&e.blip&&e.blip.blipAtom;if(t){var i=t.size,n=t.format;if(i<209715200&&i>20971520&&"gif"===n&&(!this.preloading&&!this.hasLoadOriginURL||this.preloadingOriginURL))return!0}return!1}},{key:"isBrokenPicShape",value:function(){var e=this.shapeData.getPicture(),t=e&&e.blip&&e.blip.blipAtom;if(t){var i=t.size,n=t.imageId,r=t.imageWidth,a=t.imageHeight;if(n>0&&i<=0&&r<=0&&a<=0)return!0}return!1}},{key:"getTi2PxConnectionSites",value:function(e){var t=this.layout();if(t)return t.getTi2PxConnectionSites(e)}},{key:"slide",get:function(){return this.parent.slide}},{key:"shapeTree",get:function(){return this.isShapeTree()?this:this.parent.shapeTree}},{key:"prevLayoutResult",get:function(){var e="c_"+this.getId();return this.shapeTree.layoutCache[e]}}]),e}(),pc={},fc=function(){function e(t,i){r()(this,e),this.url=t,this.cb=i}return o()(e,[{key:"setTimer",value:function(e){this.timer=e}},{key:"setImage",value:function(e){this.image=e}},{key:"stop",value:function(){this.timer&&window.clearTimeout(this.timer);for(var e=pc[this.url]||[],t=0,i=e.length;t<i;t++){e[t]===this.cb&&e.splice(t,1)}0===e.length&&(this.image.complete||(this.image.src="")),this.stoped=!0}},{key:"isValid",value:function(){return!this.stoped}}]),e}();function gc(e){var t=e.image,i=e.url,n=e.retryNum,r=e.intervalTime,a=e.cb,o=e.key,s=t.data_url||t.src||i,l=new fc(s,a);if(t||(t=new Image),t.crossOrigin="anonymous","image"===t.nodeName&&t.setAttribute("crossOrigin","anonymous"),l.setImage(t),pc[o])pc[o].push(a);else{pc[o]=[a];!function e(t){var i=t.image,n=t.url,r=t.retryNum,a=void 0===r?3:r,o=t.intervalTime,s=void 0===o?3e3:o,l=t.token,h=t.cb;i.onload=function(){h(null,i)},i.onerror=function(t){if(a>0){var r=setTimeout((function(){e({image:i,url:n,retryNum:a-1,intervalTime:s,token:l,cb:h})}),s);l.setTimer(r)}else h(t)},i.src=n}({image:t,url:i,retryNum:n,intervalTime:r,token:l,cb:function(e,t){var i=pc[o];delete pc[o],i&&i.forEach((function(i){i(e,t)}))}})}return l}var yc=i(45),vc=i(292),mc=i(162),_c=i(1718),wc="ON_DISCONNECTED",Sc="ON_CONNECTED",xc="offline",Tc="online",kc=window.officeType===mc.default.presentation,Cc={WPP_REQ_IMG_SHA1:kc?"wpp_req_img_sha1":"kw_req_img_sha1",WPP_REQ_IMG_SHA1_CONNECT_ERROR:kc?"wpp_req_img_sha1_connect_error":"kw_req_img_sha1_connect_error",WPP_REQ_IMG_SHA1_RESPONSE_ERROR:kc?"wpp_req_img_sha1_response_error":"kw_req_img_sha1_response_error",WPP_REQ_IMG_SHA1_ARGS_ERROR:kc?"wpp_req_img_sha1_args_error":"kw_req_img_sha1_args_error",WPP_REQ_IMG_URI:kc?"wpp_req_img_uri":"kw_req_img_uri",WPP_REQ_IMG_URI_ERROR:kc?"wpp_req_img_uri_error":"kw_req_img_uri_error",WPP_REQ_IMG_URI_4XX_ERROR:kc?"wpp_req_img_uri_4xx_error":"kw_req_img_uri_4xx_error",WPP_REQ_IMG_URI_5XX_ERROR:kc?"wpp_req_img_uri_5xx_error":"kw_req_img_uri_5xx_error",WPP_IMG_LOAD_ERROR:kc?"wpp_img_load_error":"kw_img_load_error",WPP_REQ_IMG_RETRY_ERROR_4:kc?"wpp_req_img_retry_error_4":"kw_req_img_retry_error_4",WPP_IMG_DOWNLOAD_TIME:kc?"wpp_img_download_time":"kw_img_download_time",WPP_WEBP_IMG_DOWNLOAD_TIME:kc?"wpp_webp_img_download_time":"kw_webp_img_download_time"},bc=window.imagePool=new Hs.a(1/0);bc.deleteImage=function(e){var t=e.slideId,i=e.shapeId,n=e.imageId,r=e.origin,a=e.thumbnail,o=e.requestBolb,s=e.base64,l=e.noNeedLoad,h=e.download,u=Ec({slideId:t,shapeId:i,imageId:n,origin:r,thumbnail:a,requestBolb:o,base64:s,noNeedLoad:l,download:h}),c=bc.get(u);c&&c.image&&!c.image.hasLoaded&&window.backendImageManager.removeReqObj(),bc.delete(u),window.backendImageManager.fetchNextImage()};var Ec=function(e){var t=e.slideId,i=e.shapeId,n=e.imageId,r=e.origin,a=e.thumbnail,o=e.requestBolb,s=(e.base64,e.noNeedLoad),l=e.download,h=n?[void 0,void 0,n].join("_"):[t,i,n].join("_");return r&&(h+="_origin"),a&&(h+="_thumbnail"),o&&(h+="_blob"),s||(h+="_base64"),l&&(h+="_download"),h},Rc=function(e){var t=window.location.search.substr(1);return t&&(-1===e.indexOf("?")?e+="?"+t:e+="&"+t),e},Pc=function(){function e(t,i){r()(this,e),this.backendImageManager=t,this.key=i}return o()(e,[{key:"setCmdEventName",value:function(e){this.cmdName=e}},{key:"setLoadImageToken",value:function(e){this.loadImageToken=e}},{key:"stop",value:function(){this.stoped=!0,this.cmdName&&this.backendImageManager.off(this.cmdName),this.loadImageToken&&this.loadImageToken.stop()}},{key:"isValid",value:function(){return!this.stoped}}]),e}(),Ic=function(e){function t(){r()(this,t);var e=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleOffline=function(){e.onLine=!1},e.handleOnline=function(){e.onLine=!0},e.queryURL=Object(Cn.throttle)((function(){var t=[],i=[];e.svgReqs.forEach((function(e){!e.hasPost&&!e.download&&t.push(e.sha1),e.hasPost=!0})),e.rasterReqs.forEach((function(e){!e.hasPost&&!e.download&&i.push(e.sha1),e.hasPost=!0})),e._postRequest(i,e.rasterReqs,window.__WPSENV__.isSupportWebp),e._postRequest(t,e.svgReqs)}),100),e._cacheResQueue=[],e.bandWidth=5,e.reqCnt=0,e.reqEnqueue=[],Object(yc.hasQuery)("imgExpire")?e.expire=Object(yc.getNumberQuery)("imgExpire"):e.expire=28800,e.quality=75,e.threshold=5242880,e.thumbnailThreshold=1048576,e.thumbnailQuality=10,"b"===window.officeType&&(e.threshold=null),e.onLine=!0,e.loadingImagecb={},e.reqURLEnqueue=[],e.sha1URLMap={},e.sha1BlobMap={},e.timeOut=12e4,e._expiresObj=new Map,e._init(),e._startTime=Date.now(),e.fetchInFirstRenderImageCount=0,e}var i,n;return u()(t,e),o()(t,[{key:"destroy",value:function(){this.loadingImagecb={},this.reqURLEnqueue=[],this.sha1URLMap={},this.sha1BlobMap={},this._startTime=Date.now(),this.expire=28800,this._cacheResQueue=[],this.bandWidth=2,this.reqCnt=0,this.reqEnqueue=[]}},{key:"isOverdue",value:function(){if((Date.now()-this._startTime)/1e3>this.expire){console.error("image is Overdue"),this.destroy();var e=["__2","loading","__"+window.wppDefaultChartImageId,"__"+window.wppDefaultTableImageId,"__"+window.wppDefaultPictureImageId].map((function(e){return{key:e,val:bc.get(e)}}));return bc.destroy(),e.forEach((function(e){var t=e.key,i=e.val;bc.set(t,i)})),this._expiresObj.forEach((function(e){var t=e.slideId,i=e.shapeId;window.SlidePool.getInstance().reRender({type:"hasShapeFocus",slideId:t,shapeIds:[i]})})),!0}return!1}},{key:"_init",value:function(){window.addEventListener(xc,this.handleOffline),window.addEventListener(Tc,this.handleOnline),window.addEventListener(Sc,this.handleOnline),window.addEventListener(wc,this.handleOffline)}},{key:"setSocketReady",value:function(){var e=this;this._isSocketReady=!0,this._cacheResQueue&&this._cacheResQueue.forEach((function(t){e.fire("get_url_cmd",t)})),this._cacheResQueue=[]}},{key:"onGetUrlCmd",value:function(e){this.on("get_url_cmd",e)}},{key:"fireGetUrlSucceed",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.shapes||t.images||[];i.length<1?console.log("receive fireGetUrl fail"):i.forEach((function(t){e.fire("get_url_succeed_"+t.token,t)}))}},{key:"fetchImageSync",value:function(e){var t=e.slideId,i=e.shapeId,n=e.imageId,r=e.origin,a=e.thumbnail,o=e.noNeedLoad,s=Ec({slideId:t,shapeId:i,imageId:n,origin:r,thumbnail:a,noNeedLoad:o});return bc.get(s)}},{key:"addLoadingUrlsCallBack",value:function(e,t,i,n){if(e){var r=t.cb,a=t.noNeedLoad;if(e.loadError)return r("image loadError");if(e.isLoading){var o=n.key;this.loadingImagecb[o]?this.loadingImagecb[o].push({cb:r,obj:t}):this.loadingImagecb[o]=[{cb:r,obj:t}],a&&r(null,e,i)}else(e.hasLoaded||e.width>0||t.imageId<0)&&r(null,e,i)}else i&&i.err===Cc.WPP_REQ_IMG_SHA1_RESPONSE_ERROR&&t.cb&&t.cb(null,{})}},{key:"fetchImage",value:function(e){var t=this;if(e&&e.cb){var i=e.slideId,n=e.shapeId,r=e.imageId,a=e.origin,o=e.thumbnail,s=e.requestBolb,l=e.base64,h=e.getUrl,u=e.noNeedLoad,c=e.download,d=Ec({slideId:i,shapeId:n,imageId:r,origin:a,thumbnail:o,requestBolb:s,base64:l,noNeedLoad:u,download:c});window.SlideRenderManager.getInstance().isFirstRenderAction&&(this.fetchInFirstRenderImageCount++,Lc&&!Lc[d]&&(Lc[d]=!0));var p=i+"_"+n;this._expiresObj.get(p)||this._expiresObj.set(p,{slideId:i,shapeId:n,key:d,imageId:r});var f=bc.get(d),g=new Pc(this,d);if(f&&!e.rn&&!h)return this.addLoadingUrlsCallBack(f.image,e,f.data,g),void this.fetchNextImage();var y=this.reqCnt,v=this.bandWidth,m=this.getImageURL(e,g).catch((function(i){i.tokenKey=d,t.handleFetchError(e,i),delete e.urlPromise}));e.urlPromise=m,y<v?this.loadUrlPromise(e):e.origin?this.reqEnqueue.unshift(e):this.reqEnqueue.push(e)}else console.error("params error")}},{key:"fetchImageBySha1",value:function(e,t){var i=this;if(e&&e.cb){var n=e.slideId,r=e.shapeId,a=Ec({slideId:n,shapeId:r,noNeedLoad:!0}),o=new Pc(this,a),s=this.getImageURLBySha1(e,t,o).catch((function(t){t.tokenKey=a,i.handleFetchError(e,t),delete e.urlPromise}));e.urlPromise=s,this.reqCnt<this.bandWidth?this.loadUrlPromise(e):this.reqEnqueue.push(e)}else console.error("params error")}},{key:"getImageURLBySha1",value:(n=st()(regeneratorRuntime.mark((function e(t,i,n){var r,a,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){s.getURL(i,e,n,t)}));case 2:return r=e.sent,a=r.url,o=r.originURL,e.abrupt("return",{url:a,data:i,token:n,originURL:o});case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})},{key:"loadUrlPromise",value:function(e){var t=this;if(e&&e.urlPromise){var i=e.getUrl,n=e.urlPromise,r=e.backendShapePictureToken;this.addReqObj(e),n.then((function(n){if(n){var a=n.url,o=n.data,s=n.token,l=n.originURL;o.originURL=l,o.url=a,Object.isEmpty(r)||(o.backendShapePictureToken=r);var h=s.key;if(e.requestBolb){var u=Date.now();t.getBlob(a,o,e.download).then((function(i){t.removeReqObj(e),i._tokenKey=s.key,i.hasLoaded=!0,bc.set(h,{image:i,data:o}),e.cb(null,i,o),i.startTime=u,i.fileSize=o.size,Mc(s.key)})).catch((function(i){delete t.sha1BlobMap[o.sha1],t.handleFetchError(e,{err:i,sha1:o.sha1,tokenKey:s.key})}))}else{var c=s&&bc.get(s.key),d=c&&c.image;if(d&&!i)t.addLoadingUrlsCallBack(d,e,o,s),t.removeReqObj(e),t.fetchNextImage();else if(e.noNeedLoad)d=t.unLoadImageURL(a,s,o,e),e.cb(null,d,o);else{var p=s.key;t.loadImageByBase64URL(a,s,o,e).then((function(i){t.removeReqObj(e),e.cb(null,i),t.loadingImagecb[p]&&t.loadingImagecb[p].forEach((function(e){var t=e.cb;t&&t(null,i)})),delete t.loadingImagecb[p],t.fetchNextImage(),Mc(s.key)})).catch((function(i){i.uri&&(t.loadingImagecb[p]&&t.loadingImagecb[p].forEach((function(e){var i=e.obj;t.fetchImage(i)})),delete t.loadingImagecb[p]),t.handleFetchError(e,{err:i,sha1:o.sha1,tokenKey:s.key})}))}}}})).catch((function(i){t.handleFetchError(e,i)}))}}},{key:"handleFetchError",value:function(e,t){var i=this;e.rn=e.rn||0;var n=1e3*Math.pow(e.rn%4+2,2);if(this.removeReqObj(e),t&&t.detail&&t.detail.type===Cc.WPP_REQ_IMG_SHA1_RESPONSE_ERROR)return e.cb(null,{}),window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_SHA1_RESPONSE_ERROR,1),t.token&&bc.set(t.token.key,{image:null,data:{err:Cc.WPP_REQ_IMG_SHA1_RESPONSE_ERROR}}),void Oc(t.token.key);if(t&&delete t.token,e.rn<4){e.rn++,e.cb();var r=t&&(t.uri||t.err&&t.err.uri);r&&(r.includes("data:image/webp;")||r.includes(".webp"))&&(e.webpLoadError=!0,n=0),setTimeout((function(){i.fetchImage(e)}),n),console.error("I will try again after "+n/1e3+" second :  "+e.rn,t,e.slideId,e.shapeId,e.imageId)}else console.error("fetch images error 4 times!",t,e.slideId,e.shapeId,e.imageId),window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_RETRY_ERROR_4,1),e.cb(t),Oc(t.tokenKey);if(this.fetchNextImage(),kc&&window.collection("newui","fileid",window.fileInfo.id),t){kc&&window.collection("wpperror","value","pic_error: "+JSON.stringify(t)),t.sha1&&(delete this.sha1BlobMap[t.sha1],delete this.sha1URLMap[t.sha1]),t.tokenKey&&(bc.delete(t.tokenKey),delete t.tokenKey),t.retrytimes=e.rn,t.detail=t.detail||{},t.detail.fileId=window.fileInfo.id;var a=_()({},t,{detail:JSON.stringify(t.detail)});window.sendToService("imgerror",a),this.reportError(t)}}},{key:"fetchNextImage",value:function(){var e=this;this.reqCnt=this.reqCnt<0?0:this.reqCnt;for(var t=function(){var t=e.reqEnqueue,i=window.SlideRenderManager.getInstance()._activeSlide,n=void 0;if(i){var r=t.findIndex((function(e){var t=e.slideId;return e.origin||t===i.getId()}));-1!==r&&(n=t[r],t.splice(r,1))}else{for(var a=window.SlideRenderManager.getInstance().viewSlides,o=[],s=function(e){var i=a[e].slide;if(!i)return"continue";for(var n=t.findIndex((function(e){var t=e.slideId;return i.getId()===t}));-1!==n;)o.push(t[n]),t.splice(n,1),n=t.findIndex((function(e){var t=e.slideId;return i.getId()===t}))},l=0;l<a.length;l++)s(l);o.push.apply(o,S()(t)),e.reqEnqueue=o,t=e.reqEnqueue}n||(n=t.shift()),n&&e.loadUrlPromise(n)};this.reqCnt<this.bandWidth&&this.reqEnqueue.length>0;)t();this._fetchNextImageTimer&&clearTimeout(this._fetchNextImageTimer),this.reqEnqueue.length>0&&this.addFetchNextImage()}},{key:"addFetchNextImage",value:function(){var e=this;this._fetchNextImageTimer=setTimeout((function(){e._fetchNextImageTimer=null,e.bandWidth=1/0,e._fetchNextImageErrorCnt++,console.warn("fetch image may be has a error!"),e.fetchNextImage()}),6e4)}},{key:"getSha1",value:function(e,t){var i=this;return new Promise((function(n,r){var a=e.slideId,o=e.shapeId,s=e.imageId,l=e.width,h=e.height,u=e.origin,c=e.thumbnail,d=e.originFileSize,p=e.imageWidth,f=e.imageHeight;("string"==typeof s||s<0)&&r({detail:{type:Cc.WPP_REQ_IMG_SHA1_ARGS_ERROR,content:"imageid is error: "+s}});var g=Object(k.a)(),y={},m=c?i.thumbnailQuality:i.quality,_=c?i.thumbnailThreshold:i.threshold;if(s)if(u)y.images=[{image_id:s,token:g}];else{var w=isNaN(l)?0:Math.floor(l),S=isNaN(h)?0:Math.floor(h);if(c)y.images=[{image_id:s,token:g,quality:m,threshold:_,vWidth:w,vHeight:S}];else{var x=Math.max(p,f)/2560;(v.userAgent.chromeVS||v.userAgent.isPad||v.userAgent.isMobile)&&x>1&&(_=Math.floor(d/(x*x)),_=Math.max(_,1)),y.images=[{image_id:s,token:g,threshold:_,vWidth:w,vHeight:S}]}}else y.shapes=[{visible_size:-1,shape_id:o,slide_id:a,token:g,zoom:2}];var T="get_url_succeed_"+g;(t.setCmdEventName(T),i.once(T,(function(e){!e||e.error?r({sha1:e.sha1,token:t,detail:{type:Cc.WPP_REQ_IMG_SHA1_RESPONSE_ERROR,content:e.error}}):n({data:e,token:t})})),i.onLine)?i._isSocketReady?(window.APP&&window.APP.session).isConnected()?(i.fire("get_url_cmd",y),window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_SHA1,1)):r({detail:{type:Cc.WPP_REQ_IMG_SHA1_CONNECT_ERROR,content:"session is not connect"}}):(window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_SHA1,1),i._cacheResQueue.push(y)):r({detail:{type:Cc.WPP_REQ_IMG_SHA1_CONNECT_ERROR,content:"network is offline"}});setTimeout((function(){r({detail:{type:Cc.WPP_REQ_IMG_SHA1_CONNECT_ERROR,content:"socket timeout "+i.timeOut/1e3+"s"}})}),i.timeOut)}))}},{key:"getBlob",value:function(e,t,i){var n=t.sha1;return i?this.blobApi(e,null,n,!0):(this.sha1BlobMap[n]=this.sha1BlobMap[n]||this.blobApi(e,null,n,!0),this.sha1BlobMap[n])}},{key:"getImageURL",value:(i=st()(regeneratorRuntime.mark((function e(t,i){var n,r,a,o,s,l,h,u,c,d,p=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSha1(t,i);case 2:if(n=e.sent,r=n.data,a=r.sha1,!this.sha1URLMap[a]||t.getUrl||!t.noNeedLoad){e.next=9;break}return(o=this.sha1URLMap[a].image)&&bc.set(i.key,{image:o,data:r}),e.abrupt("return",_()({},this.sha1URLMap[a]));case 9:return e.next=11,new Promise((function(e,i){p.getURL(r,e,i,t)}));case 11:if(s=e.sent,l=s.url,h=s.originURL,t.removeLDResource&&(u=i.key,this.loadingImagecb[u]?this.loadingImagecb[u].push({cb:t.removeLDResource}):this.loadingImagecb[u]=[{cb:t.removeLDResource}]),t.noNeedLoad||t.requestBolb||t.origin){e.next=26;break}return this.sha1URLMap[a]={url:l,data:r,token:i},e.next=19,this.getBlob(l,r);case 19:return c=e.sent,e.next=22,this._fileReader(c);case 22:return d=e.sent,e.abrupt("return",{url:d,data:r,token:i,originURL:h});case 26:return e.abrupt("return",{url:l,data:r,token:i,originURL:h});case 27:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"loadImageByBase64URL",value:function(e,t,i){return new Promise((function(n,r){var a=null;bc.isFull()?a=bc.pop().image:(a=new Image).crossOrigin="anonymous",a.isLoading=!0,i&&(a._logicWidth=i.width,a._logicHeight=i.height),a.data_url=e,a._tokenKey=t.key,bc.set(t.key,{image:a,data:i}),a.startTime=Date.now(),a.fileSize=i.size;var o=gc({image:a,url:e,cb:function(e){a.isLoading=!1,e?(a.loadError=!0,bc.delete(t.key),r({detail:{type:Cc.WPP_IMG_LOAD_ERROR,content:"image base64 uri load error"},uri:a.data_url})):(a.hasLoaded=!0,n(a))},key:t.key});t&&t.setLoadImageToken(o)}))}},{key:"unLoadImageURL",value:function(e,t,i,n){var r=null;return bc.isFull()?r=bc.pop().image:(r=new Image).crossOrigin="anonymous",i&&(r._logicWidth=i.width,r._logicHeight=i.height),r.isLoading=!0,r.data_url=e,r.fileSize=i.size,r._onerrorcbs=[n],r._tokenKey=t.key,bc.set(t.key,{image:r,data:i}),i.sha1&&this.sha1URLMap[i.sha1]&&(this.sha1URLMap[i.sha1].image=r),r}},{key:"_fileReader",value:function(e){return new Promise((function(t,i){var n=new FileReader;n.onloadend=function(){t(n.result)},n.onerror=function(e){i({detail:{type:Cc.WPP_IMG_LOAD_ERROR,content:"blob fileReader error"}})},e?n.readAsDataURL(e):i({detail:{type:Cc.WPP_IMG_LOAD_ERROR,content:"blob fileReader error"}})}))}},{key:"_fileReaderText",value:function(e){var t=this;return new Promise((function(i,n){var r=new FileReader;r.onloadend=function(){i({requestid:e.getResponseHeader&&e.getResponseHeader("x-kss-request-id"),status:e.status,uri:e.responseURL,detail:r.result})},e.response?r.readAsText(e.response):n(t._collectXhrInfo(e))}))}},{key:"getURL",value:function(e,t,i,n){if(e){var r="svg"===e.format;this.svgReqs=this.svgReqs||[],this.rasterReqs=this.rasterReqs||[];var a={sha1:e.sha1,reslove:t,reject:i,obj:n};if(r||n.webpLoadError?this.svgReqs.push(a):this.rasterReqs.push(a),n.download){var o=this.svgReqs.concat(this.rasterReqs);this._postRequest([e.sha1],o)}else this.queryURL()}}},{key:"_collectXhrInfo",value:function(e){return{requestid:e.getResponseHeader&&e.getResponseHeader("x-kss-request-id"),status:e.status}}},{key:"_postRequest",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(e.length<1)){window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_URI,e.length),this._api=this._api||Rc("/api/v3/office/file/"+window.APP.fileId+"/shapes");var n={ids:e,expire:this.expire};i&&(n.support_webp=i),this.postApi(this._api,JSON.stringify(n)).then((function(i){var n=i.urls,r=i.webp_urls;e.forEach((function(e){var i=t.findIndex((function(t){return t.sha1===e}));if(-1!==i){var a=t[i],o=a.reslove,s=a.reject,l=n&&n[e],h=r&&r[e]||l;h?o({url:h,originURL:l}):s({detail:{type:Cc.WPP_REQ_IMG_URI_ERROR}}),t.splice(i,1)}else console.log("may be has a error ",e)}))})).catch((function(i){e.forEach((function(e){var n=t.findIndex((function(t){return t.sha1===e}));-1!==n&&((0,t[n].reject)(i),t.splice(n,1))}))}))}}},{key:"requestMediaUrl",value:function(e,t){var i=e.mediaId,n=e.key,r=Object(k.a)(),a={};a.medias=[{media_id:i,token:r}];var o="get_url_succeed_"+r;new Pc(this,n).setCmdEventName(o),this.once(o,t),this._isSocketReady?this.fire("get_url_cmd",a):this._cacheResQueue.push(a)}},{key:"addReqObj",value:function(){this.reqCnt++}},{key:"removeReqObj",value:function(){this.reqCnt--}},{key:"isAllImageLoaded",value:function(){var e=!0;return this._expiresObj.forEach((function(t){var i=t.key,n=t.imageId,r=bc.get(i),a=r&&r.image;n>0&&a&&!a.hasLoaded&&(e=!1)})),e}},{key:"reportError",value:function(e){switch(e&&e.detail&&e.detail.type){case Cc.WPP_REQ_IMG_SHA1_CONNECT_ERROR:window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_SHA1_CONNECT_ERROR,1);break;case Cc.WPP_REQ_IMG_URI_ERROR:var t=Number(e.status);t&&4===Math.floor(e.status/100)?window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_URI_4XX_ERROR,1):t&&5===Math.floor(e.status/100)?window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_URI_5XX_ERROR,1):window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_URI_ERROR,1);break;case Cc.WPP_IMG_LOAD_ERROR:window.report(vc.TYPE.COUNT,Cc.WPP_IMG_LOAD_ERROR,1);break;case Cc.WPP_REQ_IMG_SHA1_ARGS_ERROR:window.report(vc.TYPE.COUNT,Cc.WPP_REQ_IMG_SHA1_ARGS_ERROR,1)}}},{key:"postApi",value:function(e,t){var i=this,n=Date.now();return this._callHttpRequest("POST",e,t,"json",(function(t){return _()({},i._collectXhrInfo(t),{cost:(Date.now()-n)/1e3,uri:e,detail:{type:Cc.WPP_REQ_IMG_URI_ERROR,content:t.response}})}))}},{key:"blobApi",value:function(e,t,i,n){var r=this,a=Date.now();return this._callHttpRequest("GET",e,t,"blob",(function(t){return _()({},r._collectXhrInfo(t),{uri:e,sha1:i,cost:(Date.now()-a)/1e3,detail:{type:Cc.WPP_IMG_LOAD_ERROR,content:"image uri get blob error"}})}),n)}},{key:"_callHttpRequest",value:function(e,t,i,n,r){var a=this,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return new Promise((function(s,l){window.__WPSENV__.callAPI({method:e,url:t,body:i,responseType:n}).then((function(e){if(200!==e.status&&304!==e.status||200===e.status&&"blob"===n&&0===e.body.size)l(r(e.target));else{var t=e.body;s(t)}})).catch((function(h){if(o){var u=t+(t.split("?")[1]?"&":"?")+"ignoreCache";a._callHttpRequest(e,u,i,n,r).then((function(e){return s(e)})).catch((function(e){return l(e)}))}else l(r(h.target))}))}))}}]),t}(x.a);window.backendImageManager=new Ic,window.imageMgrTask&&(window.imageMgrTask.forEach((function(e){window.backendImageManager[e.key](e.data)})),window.imageMgrTask=[]);var Lc={},Ac=0,Bc=0,Dc=0,Mc=function(e){var t=bc.get(e),i=t&&t.image;if(Lc&&Lc[e]){var n=i.fileSize?i.fileSize:0,r=i.startTime?Date.now()-i.startTime:0,a=r?8*n/r/1e3:0;isNaN(r)||(Ac+=r),isNaN(a)||(Bc+=a),Lc[e]=!1,Dc++,r&&n&&window.collection("experience",{event:"reading_pic1",times:r,value:n})}Nc()},Oc=function(e){Lc&&Lc[e]&&(Lc[e]=!1,window.collection("experience",{event:"reading_pic0"})),Nc()},Nc=function(){if(!Object.isEmpty(Ac)&&!Object.isEmpty(Bc)&&Lc&&Object.keys(Lc).length>0&&Object.values(Lc).every((function(e){return!e}))){Object(_c.a)();var e=0===Dc?0:Number((Bc/Dc).toFixed(2));window.collection("experience",{event:"reading_pic1_speed",times:Ac,value:e}),Lc=null,Ac=null,Bc=null,Dc=null}};window.svgImageLoad=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){e.outTimer&&clearTimeout(e.outTimer);var i=e.getAttribute("tokenKey"),n=window.imagePool,r=n.get(i),a=r&&r.image;if(a&&a.data_url&&a.isLoading){a.isLoading=!1;var o=a.startTime,s=(Date.now()-o)/1e3,l=(a.fileSize<<3)/s>>10>>10;Mc(i),v.userAgent.isIos&&(l=5),t&&(l=1/0),l=l>10?10:l;var h=window.backendImageManager;h.bandWidth=l<5?5:l,h.removeReqObj(),a.hasLoaded=!0,h.loadingImagecb[i]&&h.loadingImagecb[i].forEach((function(e){var t=e.cb;t&&t(null,a,r.data)})),v.userAgent.isIos&&!t?setTimeout((function(){delete h.loadingImagecb[i]}),3e5):(a.data_url&&-1!==a.data_url.indexOf(".webp")?window.report(vc.TYPE.DURATION,Cc.WPP_WEBP_IMG_DOWNLOAD_TIME,Date.now()-o):window.report(vc.TYPE.DURATION,Cc.WPP_IMG_DOWNLOAD_TIME,Date.now()-o),delete h.loadingImagecb[i]),h.fetchNextImage(),delete a._onerrorcbs}}},window.svgImageError=function(e){if(e){e.outTimer&&clearTimeout(e.outTimer);var t=e.getAttribute("tokenKey"),i=window.imagePool.get(t),n=i&&i.image;if(n&&n.data_url&&n.isLoading){n.isLoading=!1;var r=n.startTime;Oc(t);var a=window.backendImageManager;console.log("svgImage onerror:",Date.now()-r),a.removeReqObj(),n.loadError=!0;var o=i.data,s=n.src||n.data_url;n._onerrorcbs&&n._onerrorcbs.forEach((function(e){a.handleFetchError(e,{detail:{type:Cc.WPP_IMG_LOAD_ERROR,content:"image uri error"},uri:s,tokenKey:t,sha1:o.sha1})})),a.loadingImagecb[t]&&a.loadingImagecb[t].forEach((function(e){var t=e.obj;a.fetchImage(t)})),delete a.loadingImagecb[t],a.fetchNextImage(),delete n._onerrorcbs}}};var Fc=window.backendImageManager,Vc=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.removeLDResource=function(){var e=C.PartOfShapeName.Geomerty(i.getId())+"_LD",t=i.svgNode&&i.svgNode.querySelector("#"+e);t&&(i.slideCtx&&i.slideCtx.clearDefById(e,!0),t.parentNode.remove(),i.requestRenderAll({shapeIds:i.getId(),shape:i,type:"updateShape"}))},i}return u()(t,e),o()(t,[{key:"preload",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.preloading=!0;var i=this.getImageIdArr(),n={isLD:!0},r={isHD:!0},a=0,o=this.isNeedHDResource(),s=0,l=0;this.getResourceSuccess=!1;var h=function(o,h,u,c){if(e.getImageIdArr().find((function(e){return e.imageId===o}))){if(u)s++;else if(c&&o&&h)a++,r[o]=h,h.isHD=!0,h.hasLoaded&&(n.isLD=!1,n[o]=null);else if(o&&h)a++,n[o]=h,h.isLD=!0;else if(l===i.length&&(!e.isResourceGetSuccess(n[o])||a<l)||l>i.length&&!e.isResourceGetSuccess(n[o])&&!e.isResourceGetSuccess(r[o]))return void e.addLoading();if(l===s)e.getResourceSuccess=!1,e.renderResource();else if(e.preloading=!1,n.shape=e,e.getResourceSuccess=!0,n.type="getImages",e.renderResource(n,r),e.preloadCallBacks)for(var d=e.preloadCallBacks.length;d--;)e.preloadCallBacks[d]&&e.preloadCallBacks[d](n,r,t)&&e.preloadCallBacks.splice(d,1)}else window.imagePool.deleteImage({imageId:o,noNeedLoad:!0})},u=this.getId(),c=this.getSlide()&&this.getSlide().getId();i.forEach((function(i){var n=i.imageId,r=i.size,a=i.imageWidth,s=i.imageHeight,d=void 0;if(n=Number(n),0===r&&n>0)return l++,void h(n,{});n<0&&(o=!0);var p=(o=o&&!t)&&r>1048576,f=e.layoutResult&&e.layoutResult.getRealRectPx(),g=f.width,y=f.height;isNaN(n)?e.addLoading():(l++,d=Fc.fetchImage({shapeId:u,slideId:c,originFileSize:r,imageWidth:a,imageHeight:s,width:g,height:y,imageId:n,thumbnail:p,noNeedLoad:o,origin:t,cb:function(e,t){h(n,t,e)}}),e.fetchImageTokens.push(d),p&&(l++,d=Fc.fetchImage({shapeId:u,slideId:c,imageWidth:a,imageHeight:s,width:g,height:y,thumbnail:!1,noNeedLoad:o,originFileSize:r,imageId:n,cb:function(e,t){h(n,t,e,!0)},removeLDResource:e.removeLDResource}),e.fetchImageTokens.push(d)))})),0===i.length&&h()}},{key:"isResourceGetSuccess",value:function(e){return e&&!e.loadError}},{key:"isNeedHDResource",value:function(){var e=this.layout(this.scale),t=e&&e.getShapeAgent(),i=t&&t.getProperty();if(i){var n=i.scene3d,r=i.shape3d,a=i.effects,o=function(e){return e&&Object.keys(e).length>0};if(o(n)||o(r)||o(a))return!1;var s=i&&i.fill;if(s&&s.type===Be.e.FillTypeBlip&&s.blip)return!(s.blip.effects&&s.blip.effects.length>0)}var l=e&&e.shapeData.getPicture();if(l&&l.blip){var h=l.blip.effects;return(!(h&&h.length>0)||1===h.length&&6===h[0].type)&&!(l.blip.colorMap&&l.blip.colorMap.length>0)}return!!l}},{key:"getResourceSync",value:function(){var e=this,t=this.getImageIdArr(),i={},n=this.isNeedHDResource();return t.forEach((function(t){var r=t.imageId,a=void 0;(a=Fc.fetchImageSync({imageId:r,noNeedLoad:!1,origin:!0}))?a.image&&a.image.hasLoaded&&e._clearGIFLoadStatus():a=Fc.fetchImageSync({imageId:r,noNeedLoad:n})||{},a.image&&a.image.hasLoaded?(e.getResourceSuccess=!0,i[r]=a.image):i[r]=null})),i}},{key:"isResourceValid",value:function(e){for(var t=this.getImageIdArr(),i=0,n=t.length;i<n;i++){if(!e[t[i].imageId])return!1}return!0}},{key:"_render",value:function(e,t,i){var n=this.layout(t);if(!n)return!1;var r=n&&n.getRealRectBeforeRotation()||{x:0,y:0},a=r.x,o=r.y,s=new window.QMatrix,l=Number(a.toFixed(8)),h=Number(o.toFixed(8));if(s.translate(l,h),n&&n.isFieldPlaceholderShapes){var u=e.getCurrentElement();u&&u.setAttribute("class","field-placeholder-shape")}if($u(e,this.shapeData,n,i,s),n.slideEnvLayout.editMode!==C.EditMode.slide&&this.shapeData.isPlaceHolder()){var c=this.shapeData.getPlaceHolder(),d=Object.isEmpty(c.type)?C.PlaceholderType.Object:c.type,p="placeholder-group";[C.PlaceholderType.Table,C.PlaceholderType.Chart,C.PlaceholderType.Picture,C.PlaceholderType.Diagram,C.PlaceholderType.ClipArt,C.PlaceholderType.Media,C.PlaceholderType.SlideImage].includes(d)&&(p+=" hide-text");var f=e.getCurrentElement(),g=f&&f.querySelector("#"+C.PartOfShapeName.Text(this.getId()));g&&g.setAttribute("class",p);var y=e.save();y&&y.setAttribute("class","placeholder-shade"),this._renderPlaceholder(e,n,i),e.restore()}this.shapeData.isMedia()&&this.renderMedia(e,n)}},{key:"_renderPlaceholder",value:function(e,t,i){if(this.shapeData){var n=t.calcHitTestMatrix(),r=this.slideEnvLayout.ratio;if(r){var a=t.getRealRectPx(r),o=a.width,s=a.height,l=this.shapeData.getPlaceHolder(),h=Object.isEmpty(l.type)?C.PlaceholderType.Object:l.type,u=function(e,t,i,n,r,a){var o=a.lineWidth,s=a.color;e.lineWidth=o,e.strokeStyle=s,e.setLineDash([1.5*o,1.5*o]),e.strokeRect(t,i,n,r)};if(e.save(),n.mapContext(e),e.scale(1/r,1/r),h===C.PlaceholderType.Object){u(e,0,0,o,s,{lineWidth:1,color:"#aeaeae"});var c=[window.wppDefaultPictureImageId,window.wppDefaultChartImageId,window.wppDefaultTableImageId];o>=26&&s>=26&&c.forEach((function(t,n){var r=i[t];if(r){var a=o/2-12,l=s/2-12,h=n%2*13,u=13*Math.floor(n/2);e.drawImage(r,Math.floor(a+h),Math.floor(l+u),Math.floor(11),Math.floor(11))}}))}else if(h===C.PlaceholderType.Table||h===C.PlaceholderType.Chart||h===C.PlaceholderType.Picture||h===C.PlaceholderType.Diagram){u(e,0,0,o,s,{lineWidth:1,color:"#aeaeae"});var d=t&&t.extendList&&t.extendList.measureShapeBody&&t.extendList.measureShapeBody.picture,p=d&&d.blip&&d.blip.blipAtom&&d.blip.blipAtom.imageId,f=i[p];if(f){if(o>=18&&s>=18){var g=o/2-8,y=s/2-8;e.drawImage(f,g,y,16,16)}}}else h===C.PlaceholderType.ClipArt||h===C.PlaceholderType.Media||C.PlaceholderType.SlideImage,u(e,0,0,o,s,{lineWidth:1,color:"#aeaeae"});e.restore()}}}},{key:"destroy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._finished&&this.slideCtx){var i=C.PartOfShapeName.Geomerty(this.getId());this.slideCtx.clearDefById(i,e),this.slideCtx.clearDefById(i+"_HD",e),this.slideCtx.clearDefById(i+"_LD",e),i=C.PartOfShapeName.Table(this.getId()),this.slideCtx.clearDefById(i,e),i=C.PartOfShapeName.Text(this.getId()),this.slideCtx.clearDefById(i,e)}y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(dc),Uc=function(e){function t(e){var i=e.parent,n=e.shapeData;r()(this,t);var a=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{parent:i,shapeData:n}));return a.genSvgImage=function(e,t){var i=t.data,n=t.image;if(i){var r=a.layout(a.scale);if(r){var o=r.calcBackendTransform(i),s=o.width,l=o.height;o.matrix.mapContext(e),e.drawImage(n,0,0,s,l),a.innerHTML=a.svgNode.innerHTML}}},a}return u()(t,e),o()(t,[{key:"getId",value:function(){return this.shapeData.getId()}},{key:"preload",value:function(){var e=this;this.preloading=!0;var t=window.ShapeUtil.getSlide(this.shapeData).getId(),i=this.getId(),n=this.shapeData.getPicture(),r=n&&n.blip&&n.blip.blipAtom,a=r&&r.imageId;this.imageId=a;var o=this.shapeData.getBackendShapePictureToken();this.fetchImageTokens=[Fc.fetchImage({slideId:t,shapeId:i,backendShapePictureToken:o,noNeedLoad:!0,cb:function(n,r,a){if(!(n||r||a))return e.addLoading();if(e.getResourceSuccess=!n,a&&e.shapeData.getBackendShapePictureToken()!==a.backendShapePictureToken)return e.deleteChartPicCache({slideId:t,shapeId:i}),void window.SlidePool.getInstance().reRender({slideId:t,shapeIds:[i]});e.preloading=!1;var o={image:r,data:a,shape:e,type:"updateShapes"};e.renderResource(o)}})]}},{key:"getResourceSync",value:function(){var e=this.shapeData.getBackendShapePictureToken();if(!Object.isEmpty(e)){var t=this.shapeData.getSlideId(),i=this.getId(),n=window.imagePool.get(t+"_"+i+"_"),r=n&&n.data,a=this.shapeData.getPicture(),o=a&&a.blip&&a.blip.blipAtom,s=o&&o.imageId;if(r&&r.backendShapePictureToken!==e||this.imageId!==s)return this.deleteChartPicCache({slideId:t,shapeId:i}),null}var l=window.ShapeUtil.getSlide(this.shapeData).getId(),h=this.shapeData.private.orgShapeId||this.getId();return Fc.fetchImageSync({slideId:l,shapeId:h,noNeedLoad:!0})}},{key:"isResourceValid",value:function(e){return!!e&&e.data&&e.image}},{key:"_render",value:function(e,t,i){e.save(),this._draw(e,t,i),e.restore()}},{key:"_draw",value:function(e,t,i){var n=i.data,r=i.image;if(n&&!this.isDestroy){var a=this.layout(this.scale);if(a){var o=a.calcBackendTransform(n),s=o.width,l=o.height,h=o.matrix,u=this.svgNode&&this.svgNode.querySelector("image");u&&u.remove(),e.save(C.PartOfShapeName.BackendShape(this.getId())),e.save(),h.mapContext(e),e.drawImage(r,0,0,s,l),e.restore(),e.restore()}}}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"isLocalShape",value:function(){return!1}},{key:"deleteChartPicCache",value:function(e){var t=e.slideId,i=e.shapeId;window.imagePool.deleteImage({slideId:t,shapeId:i,noNeedLoad:!0})}}]),t}(dc);function Gc(e){var t=e.parent,i=e.shapeData,n=e.isTopLayer;if(i.isGroupShape()){if(!function e(t){return!!t.isGroupShape()&&(!(!t.getScene3D()&&!t.getShape3D())||(t.getChilds()||[]).some((function(t){return e(t)})))}(i))return new Hc({parent:t,shapeData:i,isTopLayer:n})}else if($u.isSupportRenderShape(i)||Ol.isFrontendMode)return new Vc({parent:t,shapeData:i,isTopLayer:n});return new Uc({parent:t,shapeData:i,isTopLayer:n})}(function(){function e(){r()(this,e)}return o()(e,null,[{key:"set",value:function(e,t){e.token&&(this._dataMap[e.token]=t)}},{key:"get",value:function(e,t){var i=t.layout,n=t.ratio,r=this._dataMap[e.token],a=i.scale,o=i.getRealRectBeforeRotation();if(r){var s=Object.assign({},e);n=1;var l=o,h=r;return s.x+=l.x-h.x*n,s.y+=l.y-h.y*n,s.width*=o.width/(r.width*n),s.height*=o.height/(r.height*n),s}return this.set(e,_()({},o,{scale:a})),e}}]),e}())._dataMap={};var Hc=function(e){function t(e){var i=e.parent,n=e.shapeData,a=e.isTopLayer;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{parent:i,shapeData:n}));return o.render=regeneratorRuntime.mark((function e(t,i,n,r,a){var o,s,l,h,u,c,d,p,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.shapeData.getSlide(),!(this.isDestroy||o&&!o.parent)){e.next=3;break}return e.abrupt("return");case 3:if(this.shapeData.isShapeTree&&(this.cacheIds=[]),(!this.svgNode||this.isUpdate()||r.find((function(e){return e.id===f.getId()}))&&!this.isNewNode)&&(this.prevNode=this.svgNode,this.svgNode=t.save("s_"+this.getId()),this.svgNode.setAttribute("g",1),this.isNewNode=!0),this.isNewNode||!a){e.next=13;break}return this.prevNode=this.svgNode,this.svgNode=t.save("s_"+this.getId()),this.svgNode.setAttribute("g",1),t.restore(),window.domTools.appendChildNodes(this.prevNode,this.svgNode),this.prevNode=this.svgNode,e.abrupt("return",!0);case 13:this._finished=!1,this.update(r),s=0,l=this.shapes.concat([]),-1!==(h=l.findIndex((function(e){return e.shapeData.needMoveToTop})))&&(u=l.splice(h,1),l.push(u[0])),this.stoped=!1,this._rect=null;case 21:if(!(s<l.length)){e.next=51;break}if(c=l[s],d=c.getShapeType(),!(c.isPlaceHolder()&&!this.isTopLayer&&d!==C.ShapeType.Chart&&d!==C.ShapeType.Table||c.isHidden())){e.next=27;break}c._finished=!0,e.next=46;break;case 27:if(this.stoped){e.next=44;break}if(e.prev=28,!window.SlideRenderManager.getInstance().isFirstRenderAction){e.next=34;break}p=c.render(t,i,n,r,this.isNewNode),c.isGroupShape()&&p.next&&p.next(),e.next=36;break;case 34:return e.next=36,c.render(t,i,n,r,this.isNewNode);case 36:e.next=42;break;case 38:return e.prev=38,e.t0=e.catch(28),console.error(e.t0),e.abrupt("continue",48);case 42:e.next=46;break;case 44:return console.log("shape render stop",this),e.abrupt("break",51);case 46:if(!this.isDestroy){e.next=48;break}return e.abrupt("return");case 48:s++,e.next=21;break;case 51:return this.isNewNode&&t.restore(),this.isNewNode&&!a&&this.prevNode&&(window.domTools.appendChildNodes(this.svgNode,this.prevNode),this.svgNode.remove(),this.svgNode=this.prevNode),this.isNewNode=!1,this._finished=!0,this.notifySvgUpdate&&this.notifySvgUpdate(r),this.shapeData.isShapeTree&&Object.keys(this.layoutCache).forEach((function(e){f.cacheIds.includes(e)||delete f.layoutCache[e]})),e.abrupt("return",!0);case 58:case"end":return e.stop()}}),e,this,[[28,38]])})),o.isTopLayer=a,o._init(),o}return u()(t,e),o()(t,[{key:"_init",value:function(){this.shapes=[],this.tokenMap=new Map,this.currentRenderIndex=0;for(var e=0,t=this.shapeData.getChildCount();e<t;e++){var i=this.shapeData.getChildAt(e);if(i){var n=Gc({parent:this,shapeData:i,isTopLayer:this.isTopLayer});this.shapes.push(n),this.tokenMap.set(i.getDataToken(),n)}else console.warn("groupShape has empty child!")}}},{key:"clean",value:function(){this.shapes.forEach((function(e){e.clean()}))}},{key:"update",value:function(e){if(this.isUpdate()){this.shapes=[];for(var t=new Map,i=0,n=this.shapeData.getChildCount();i<n;i++){var r=this.shapeData.getChildAt(i),a=r.getDataToken(),o=void 0;this.shapeData.isShapeTree&&this.tokenMap&&(o=this.tokenMap.get(a),this.tokenMap.delete(a)),o||((o=Gc({parent:this,shapeData:r,isTopLayer:this.isTopLayer}))._isUpdate=!0),this.shapes.push(o),t.set(a,o)}if(this.drawingShapes)for(var s=this.drawingShapes,l=0;l<s.length;l++){var h=Gc({parent:this,shapeData:s[l],isTopLayer:this.isTopLayer});this.shapes.push(h)}this.parent.tokenMap&&(this.parent.tokenMap.delete(this.dataToken),this.parent.tokenMap.set(this.shapeData.data_token,this)),this.tokenMap.forEach((function(e){e.destroy(!1)})),this.tokenMap=t,this.dataToken=this.shapeData.getDataToken(),this.treeToken=this.shapeData.getTreeToken(),this.layoutResult=null,this.shapeData.isShapeTree||(this.currentRenderIndex=0)}}},{key:"isUpdate",value:function(){return this.shapeData.getDataToken()!==this.dataToken}},{key:"isRenderFinish",value:function(){return this._finished}},{key:"isAllRenderFinish",value:function(){if(this._finished&&this.shapeData.getDataToken()===this.dataToken)return!0;for(var e=0;e<this.shapes.length;e++){var t=this.shapes[e];if(t.isGroupShape()){if(!t.isAllRenderFinish())return!1}else if(!t._finished)return!1}return this._finished=!0,!0}},{key:"stopRender",value:function(){for(var e=0;e<this.shapes.length;e++){this.shapes[e].stopRender()}this.stoped=!0;for(var t=[],i=this.currentRenderIndex;i<this.shapes.length;i++){var n=this.shapes[i];n&&t.push(n.getId())}this.cancelRendShapeIds=t}},{key:"getCancelRendShapeIds",value:function(){for(var e=this.cancelRendShapeIds&&[].concat(S()(this.cancelRendShapeIds))||[],i=0;i<this.shapes.length;i++){var n=this.shapes[i];n instanceof t&&e.push.apply(e,S()(n.getCancelRendShapeIds()))}return e}},{key:"getShape",value:function(e){if(this.getId()===e)return this;for(var i=null,n=0,r=this.shapes.length;n<r;n++){var a=this.shapes[n];if(a instanceof t){if(i=a.getShape(e))return i}else if(a.getId()===e)return a}return i}},{key:"hitTest",value:function(e,t,i,n){if(window.APP&&window.APP.shell.doc.getMode()===C.ViewModes.PlayView&&!this.isShapeTree()){var r=this.shapeData.getSlide(),a=r&&r.getCategory(),o=window.APP&&window.APP.shell.doc.getShapeCurrentRect(this.getId(),a);if(o){var s=new window.Point(e,t);if(o.containsPoint(s)){for(var l=void 0,h=this.shapes.length-1;h>=0;h--){var u=this.shapes[h];if((!i||!i.includes(u.getId()))&&(l=u.hitTest(e,t,i,n))&&l.isHit)break}return{shape:this,childShapeHit:l,isHit:!0,hitTestInfo:{type:C.CursorType.Shape,isHit:!0}}}return}}for(var c=this.shapes.length-1;c>=0;c--){var d=this.shapes[c];if(!i||!i.includes(d.getId())){var p=d.hitTest(e,t,i,n);if(p&&p.isHit)return p}}}},{key:"hitSelectObjectsByRect",value:function(e){for(var i=[],n=this.shapes.length-1;n>=0;n--){var r=this.shapes[n];if(r instanceof t){var a=r.layoutResult&&r.layoutResult.hitSelectObjectsByRect(_()({},e));a&&a.isHit&&i.push(r)}else{var o=r.hitSelectObjectsByRect(e);o&&o.isHit&&i.push(r)}}return i}},{key:"destroy",value:function(e){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this);for(var i=0;i<this.shapes.length;i++){var n=this.shapes[i];n&&n.destroy(e)}this.shapes.length=0}},{key:"requestRenderAll",value:function(e){if(e&&this.parent){var t=this.parent;t&&t.shapeData&&t.shapeData.isShapeTree&&(e.shapeIds=this.getId(),e.shape=this)}this.parent&&this.parent.requestRenderAll(e)}},{key:"updateRect",value:function(e){var t=e.x,i=e.y,n=t+e.width,r=i+e.height;if(this._rect){var a=this._rect;a.x>t&&(a.x=t),a.y>i&&(a.y=i),a.r<n&&(a.r=n),a.b<r&&(a.b=r)}else this._rect={x:t,y:i,r:n,b:r};this._rect.width=this._rect.r-this._rect.x,this._rect.height=this._rect.b-this._rect.y,!this.isShapeTree()&&this.parent.updateRect(this._rect)}},{key:"getRect",value:function(){if(this._finished)return this._rect}},{key:"getGIFLoadShapes",value:function(){for(var e=[],i=0,n=this.shapes.length;i<n;i++){var r=this.shapes[i];r instanceof t?e.push.apply(e,S()(r.getGIFLoadShapes())):r.isShowOriginGIFLoad()&&e.push(r)}return e}},{key:"getBrokenPicShapes",value:function(){for(var e=[],i=0,n=this.shapes.length;i<n;i++){var r=this.shapes[i];r instanceof t?e.push.apply(e,S()(r.getBrokenPicShapes())):r.isBrokenPicShape()&&e.push(r)}return e}},{key:"getChildShapesRecurse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=[],n=this.shapes.length,r=0;r<n;r++){var a=this.shapes[r];if(a instanceof t){var o=a.getChildShapesRecurse(e);i=i.concat(o)}else e&&!e(a)||i.push(a)}return i}}]),t}(dc),Wc=Hc,jc=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.treeToken=i.shapeData.getTreeToken(),i.cacheIds=[],i.layoutCache=new Map,i}return u()(t,e),o()(t,[{key:"measure",value:function(e,t){var i=this,n={x:0,y:0,width:0,height:0};return this.shapes.forEach((function(r){if(r.isPlaceHolder()&&!i.isTopLayer);else{r.slideEnvLayout=e;var a=r.layout(t).getViewRectPx();n.x>a.x?(n.x=a.x,n.width+=n.x-a.x,a.width>n.width&&(n.width=a.width)):n.x+n.width<a.x+a.width&&(n.width=a.x+a.width-n.x),n.y>a.y?(n.y=a.y,n.height+=n.y-a.y,a.height>n.height&&(n.height=a.height)):n.y+n.height<a.y+a.height&&(n.height=a.y+a.height-n.y)}})),n}},{key:"getSelection",value:function(){if(!this.localSlt){var e=this.parent.slideData;if(e){var t=e.getPresentation();if(t){var i=t.getSelectionsMgr();i&&(this.localSlt=i.getLocalSelection())}}}return this.localSlt}},{key:"hitTest",value:function(e,i,n,r,a){if(n){var o=this.getSelection();if(o)for(var s=o.getActiveShapes()||[],l=s.length-1;l>=0;l--){var h=this.getViewShape(s[l]),u=h&&h.hitTest(e,i,a);if(u&&u.isHit)return u}}return y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"hitTest",this).call(this,e,i,r,a)}},{key:"getViewShape",value:function(e){for(var t=this.shapes.length-1;t>=0;t--)if(this.shapes[t].shapeData===e)return this.shapes[t]}},{key:"notifySvgUpdate",value:function(e){var t=this;-1!==e.findIndex((function(e){return e.id===t.getId()}))||0===e.length?this.requestRenderAll({shape:this,type:"updateShape"}):this.requestRenderAll({shapeIds:e,type:"hasUpdateShapes"})}},{key:"addDrawingShapes",value:function(e){this.drawingShapes=e}},{key:"addShapeViewToRealPos",value:function(e){var t=e.shapeData,i=this.shapeData.findIndex((function(e){return t===e}));return-1!==i&&(this.shapes.splice(i,0,e),this.requestRenderAll({shape:this,type:"updateShape"}),!0)}},{key:"requestRenderAll",value:function(e){this.parent&&this.parent.requestRenderAll(e)}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),delete this.layoutCache}},{key:"slide",get:function(){return this.parent}}]),t}(Wc),Yc=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));i.renderBackgroundShape=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.backgroundShape){e.next=4;break}return e.next=3,this.backgroundShape.render(this.backgroundCtx,this.envLayoutResult,this.scale);case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)})),i.render=regeneratorRuntime.mark((function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.update(t),this.prevUpdateShapeIds=this.prevUpdateShapeIds||[],!(this.updateShapeIds.length>0)){e.next=7;break}this.prevUpdateShapeIds=this.updateShapeIds,this.updateShapeIds=[],e.next=9;break;case 7:if(!this._finished){e.next=9;break}return e.abrupt("return",this._finished);case 9:return this._addAnimSoundResource(),e.next=12,this.renderBackgroundShape();case 12:return e.next=14,this.shapeTree&&this.shapeTree.render(this.ctx,this.envLayoutResult,this.scale,this.prevUpdateShapeIds);case 14:if(0===this.updateShapeIds.length){e.next=17;break}return e.next=17,this.render(!0);case 17:return this._finished=!0,e.abrupt("return",this._finished);case 19:case"end":return e.stop()}}),e,this)}));var n=e.slideData,a=e.topLayer;return i.props=e,i.slideData=n,i.isTopLayer=a,i.updateShapeIds=[],i._startTime=Date.now(),i._init(),i}return u()(t,e),o()(t,[{key:"getData",value:function(){return this.slideData}},{key:"getBackgroundShapeData",value:function(){return this.slideData.visual.getBackgroundShape()}},{key:"_init",value:function(){this.id=this.slideData.getId();var e=this.slideData.getSpTree(),t=this.isTopLayer,i=this.getBackgroundShapeData();e?this.shapeTree=new jc({parent:this,shapeData:e,isTopLayer:t}):console.error("core data error!!cannot get shapeTree data from slideData"),i&&(this.backgroundShape=new Vc({parent:this,shapeData:i,isTopLayer:t}),this.backgroundShape.label=this.getBackgroundShapeType()),this.data_token=this.slideData.data_token,this.tree_token=this.slideData.tree_token;var n=this.slideData.drawingShapes;this.followingDataToken=this.getFollowingDataToken(),n&&this.shapeTree&&this.shapeTree.addDrawingShapes(n)}},{key:"isUpdateFollowing",value:function(){return this.followingDataToken!==this.getFollowingDataToken()}},{key:"getFollowingDataToken",value:function(){for(var e=this.slideData&&this.slideData.getFollowing(),t="";e;)t+=e.data_token,e=e.getFollowing();return t}},{key:"updateSlide",value:function(){var e=this;this._init(),this._finished=!1,this.shapeTree&&!this.updateShapeIds.find((function(t){return t.id===e.shapeTree.getId()}))&&this.updateShapeIds.push({id:this.shapeTree.getId()}),this.envLayoutResult&&(this.ctx&&this.ctx.clearRect(0,0,this.envLayoutResult.svgLayout.width,this.envLayoutResult.svgLayout.height),this.backgroundCtx=new Vs.default(this.envLayoutResult.svgLayout.width,this.envLayoutResult.svgLayout.height))}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.isTopLayer,i=this.getBackgroundShapeData();if(i){var n=this.updateShapeIds.find((function(e){return e&&e.id===i.getId()})),r=n&&n.e&&n.e.event===Pu.default.modify_page_setup;(!this.backgroundShape||this.backgroundShape&&this.backgroundShape.dataToken!==i.data_token||r)&&(this.backgroundShape&&this.backgroundShape.destroy(),this.backgroundShape=new Vc({parent:this,shapeData:i,isTopLayer:t}),this.backgroundShape.label=this.getBackgroundShapeType(),this.backgroundCtx=new Vs.default(this.envLayoutResult.svgLayout.width,this.envLayoutResult.svgLayout.height))}else this.backgroundShape&&(this.backgroundShape&&this.backgroundShape.destroy(),this.backgroundShape=null,this.backgroundCtx=null);if(this.data_token!==this.slideData.data_token||this.tree_token!==this.slideData.tree_token){this.id=this.slideData.getId();var a=this.slideData.drawingShapes;a&&this.shapeTree.addDrawingShapes(a),this._finished=!1,e||(this.prevUpdateShapeIds=[]),this.data_token=this.slideData.data_token,this.tree_token=this.slideData.tree_token}}},{key:"hasBackgroundShape",value:function(){return!!this.backgroundShape}},{key:"getBackgroundShapeType",value:function(){if(this.backgroundShape){var e=this.backgroundShape.getData(),i=e&&e.getParent();return i?i.isMasterSlide?t.SLIDE_LAYERS.SLIDE_MASTER_BG:i.isLayoutSlide?t.SLIDE_LAYERS.SLIDE_LAYOUT_BG:t.SLIDE_LAYERS.SLIDE_BG:void 0}}},{key:"equalsLayout",value:function(e,t){if("object"===(void 0===e?"undefined":I()(e))){for(var i in e)if(!this.equalsLayout(e[i],t[i]))return!1;return!0}return Au.a.equals(e,t)}},{key:"setENV",value:function(e){var t=e.layout,i=e.ctx,n=t.scale;this.envLayoutResult=t,this.envLayoutResult.viewMode=this.props.viewMode,this.scale!==n&&(this.scale=n),this.hasBackgroundShape()&&(this.backgroundCtx=new Vs.default(this.envLayoutResult.svgLayout.width,this.envLayoutResult.svgLayout.height)),this.ctx=i||this.ctx}},{key:"getCanvas",value:function(){return this.ctx.canvas}},{key:"getId",value:function(){return this.id}},{key:"getDataToken",value:function(){return-1}},{key:"equals",value:function(e){return!!e&&e.getId()===this.getId()}},{key:"isAllRenderFinish",value:function(){return this.hasBackgroundShape()?this.shapeTree&&this.shapeTree.isAllRenderFinish()&&this.backgroundShape._finished:this.shapeTree&&this.shapeTree.isAllRenderFinish()}},{key:"addUpdateShapeIds",value:function(e){var t=this;e=e||[];for(var i=function(i){var n=e[i],r=n.id,a=n.e;if(a&&"hasShapeFocus"===a.type){var o=t.updateShapeIds.findIndex((function(e){return e.id===r&&a&&"hasShapeFocus"===a.type&&e.e&&e.e.type===a.type}));-1!==o&&t.updateShapeIds[o].e&&t.updateShapeIds[o].e.event===a.event?(t.updateShapeIds.splice(o,1),t.updateShapeIds.unshift(e[i])):-1===o&&t.updateShapeIds.unshift(e[i])}else{var s=t.updateShapeIds.findIndex((function(e){return e.id===r&&(a===e.e||a&&a.op&&e.e&&a.op===e.e.op)}));-1!==s&&t.updateShapeIds.splice(s,1),t.updateShapeIds.push(e[i]),a&&"hasShapeReview"===a.type&&(t.shapeTree.layoutCache["c_"+r]=null)}},n=0;n<e.length;n++)i(n)}},{key:"renderSync",value:function(){if(this.shapeTree){var e=this.shapeTree.render(this.ctx,this.envLayoutResult,this.scale);return this.isTopLayer?e:void 0}}},{key:"stopRender",value:function(){this.backgroundShape&&this.backgroundShape.stopRender(),this.shapeTree&&this.shapeTree.stopRender()}},{key:"requestRenderAll",value:function(e){window.SlidePool.getInstance().reRender(_()({slideId:this.slideData.getId()},e))}},{key:"hitTest",value:function(){var e;return _()({},this.shapeTree&&(e=this.shapeTree).hitTest.apply(e,arguments),{slide:this})}},{key:"hitSelectObjectsByRect",value:function(e){return{shapes:this.shapeTree&&this.shapeTree.hitSelectObjectsByRect(e),slide:this}}},{key:"layout",value:function(){return this.envLayoutResult||console.error(this.constructor.name,"envLayoutResult is NULL"),this.envLayoutResult.slide}},{key:"measure",value:function(){return this.shapeTree&&this.shapeTree.measure(this.envLayoutResult,this.scale)}},{key:"getCancelRendShapes",value:function(){return this.shapeTree&&this.shapeTree.getCancelRendShapeIds()}},{key:"getShape",value:function(e){if(this.shapeTree)return e===this.shapeTree.getId()?this.shapeTree:this.shapeTree.getShape(e)}},{key:"destroy",value:function(e){this.stopRender(),this.backgroundShape&&this.backgroundShape.destroy(e),this.shapeTree&&this.shapeTree.destroy(e),this.removeDefs(this.ctx),this.removeDefs(this.backgroundCtx),y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"removeDefs",value:function(e){if(e){var t=e.getSvg(),i=t&&t.querySelector("defs");if(i&&i.childElementCount>0&&i.childNodes){var n=window.domTools.getCommonSvg();i.childNodes.forEach((function(e){var t=n&&n.querySelector("#"+e.id);t&&t.remove()}))}}}},{key:"showMasterShape",value:function(){return this.slideData.showMasterShape()}},{key:"isRenderFinish",value:function(){return this._finished||this.shapeTree&&this.shapeTree.isRenderFinish()}},{key:"imageLoadError",value:function(e){this._imageLoadErrorShapes=this._imageLoadErrorShapes||[],this._imageLoadErrorShapes.includes(e)||this._imageLoadErrorShapes.push(e),this.fire(t.EVENT_TYPES.SLIDE_CHANGE,new T({slideId:this.getId()}))}},{key:"hasImageLoadError",value:function(){return this._imageLoadErrorShapes&&this._imageLoadErrorShapes.length>0}},{key:"getImageLoadErrorShapes",value:function(){return this._imageLoadErrorShapes&&(this._imageLoadErrorShapes=this._imageLoadErrorShapes.filter((function(e){return e.shapeData&&e.shapeData.parent}))),this._imageLoadErrorShapes||[]}},{key:"getGIFLoadShapes",value:function(){var e=[];this.shapeTree&&e.push.apply(e,S()(this.shapeTree.getGIFLoadShapes())),this.backgroundShape&&this.backgroundShape.isShowOriginGIFLoad()&&e.push(this.backgroundShape);var t=this.getImageLoadErrorShapes();return e.filter((function(e){return!t.includes(e)}))}},{key:"getBrokenPicShapes",value:function(){var e=[];return this.shapeTree&&e.push.apply(e,S()(this.shapeTree.getBrokenPicShapes())),this.backgroundShape&&this.backgroundShape.isBrokenPicShape()&&e.push(this.backgroundShape),e}},{key:"_addAnimSoundResource",value:function(){uc.addAnimSound(this.slideData)}},{key:"isSlide",get:function(){return!0}}]),t}(x.a);Yc.EVENT_TYPES={SLIDE_CHANGE:"slide_change",SLIDE_RENDERED:"slide_rendered",SLIDE_RESIZE:"slide_resize"},Yc.SLIDE_LAYERS={SLIDE_MASTER:"m_s",SLIDE_LAYOUT:"l_s",SLIDE:"s_t",SLIDE_BG:"s_bg",SLIDE_MASTER_BG:"m_s_bg",SLIDE_LAYOUT_BG:"l_s_bg",SLIDE_SLIDE_BG:"s_t_bg"};var zc=Yc,Kc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r()(this,e),this._arr=new Array(t)}return o()(e,[{key:"push",value:function(e){this._arr.push(e)}},{key:"toBoolean",value:function(){for(var e=0,t=this._arr.length;e<t;e++)if(!this._arr[e])return!1;return!0}}]),e}(),qc="wait",Xc="running",Jc="stop",Zc="restart",Qc={PLAYER:"playerView",SLIDELAYOUT:"slideLayoutView",THUMBNAIL:"thumbnailView",PREVIEW:"preView",ACTIVESLIDE:"activeSlide",SNAPSHOTVIEW:"SnapshotView"},$c=function(e){function t(e){var i=this;r()(this,t);var n,a=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.run=Object(Cn.debounce)((function(e){var t=a.viewSlides;if(0!==t.length){console.log("running");for(var i=a.finishBoolean,n=0;n<t.length;n++){var r=t[n],o=r.slide,s=r.callback,l=r.idx,h=r.envLayout,u=r.lable;if(o&&void 0===i._arr[n]){a._createSlideCtx(o,h,u);var c=o.getProxyGid();s&&s({idx:l,finished:!1,gid:c,slideSvg:o.ctx.getSvg(),slideView:o})}i._arr[n]=!1}if(a._runStatus===Xc||a._runStatus===Zc)a._runStatus=Zc;else{!function i(){a._runStatus=Xc,a._sliceRender(a.viewSlides).then((function(n){switch(console.log("running _sliceRender",n),n){case Zc:i();break;case Jc:break;default:console.log("slidelist render finish"),e&&e(t),a._runStatus=qc}}))}()}}}),3),a._sliceRender=(n=st()(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.backendImageManager&&window.backendImageManager.isOverdue(),n=regeneratorRuntime.mark((function e(n){var r,o,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t[n],o=r.slide,s=r.envLayout,l=r.lable,!o||!o.isDestroy){e.next=4;break}return console.warn("slide has destroy need del "),e.abrupt("return","continue");case 4:if(!o){e.next=21;break}return e.prev=5,a._createSlideCtx(o,s,l),o.renderOverTime=25,e.next=10,new Promise((function(e,t){a.pauseRender=t;var i=o.curPromise&&o.resumeRender;i||(o.curPromise=a.execGenerator(o.updateRender())),o.curPromise.then((function(t){o.resumeRender=null,e(t)})),i&&i()})).catch((function(e){e instanceof Function&&(o.resumeRender=e)}));case 10:if(o.waitFinished((function(e){if(a._firstRenderAction&&e&&(Object(_c.b)(),a._firstRenderAction=!1),e&&!a.finishBoolean._arr[n]&&a.viewSlides[n]===t[n]){var i=t[n],r=i.slide,o=i.callback,s=i.idx,l=i.lable,h=r.getProxyGid();r.ctx&&o&&o({idx:s,finished:!0,gid:h,slideSvg:r.ctx.getSvg(),slideView:r}),a.getViewMode()===C.ViewModes.PlayView&&l===Qc.ACTIVESLIDE&&a.activeSlide,a.finishBoolean._arr[n]=e}})),a._runStatus===Xc){e.next=13;break}return e.abrupt("return",{v:a._runStatus});case 13:e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(5),console.log(a._runStatus),a._runStatus===Xc){e.next=20;break}return e.abrupt("return",{v:a._runStatus});case 20:return e.abrupt("return","continue");case 21:case"end":return e.stop()}}),e,i,[[5,15]])})),r=0;case 3:if(!(r<t.length)){e.next=15;break}return e.delegateYield(n(r),"t0",5);case 5:o=e.t0,e.t1=o,e.next="continue"===e.t1?9:10;break;case 9:return e.abrupt("continue",12);case 10:if("object"!==(void 0===o?"undefined":I()(o))){e.next=12;break}return e.abrupt("return",o.v);case 12:r++,e.next=3;break;case 15:return e.abrupt("return",a._runStatus);case 16:case"end":return e.stop()}}),e,i)}))),function(e){return n.apply(this,arguments)}),a._viewSlides=[],a._activeSlideChange=!1,a._firstRenderAction=!(e&&!Object.isEmpty(e.firstRenderAction))||!!e.firstRenderAction,a.finishBoolean=new Kc,a.isRendering=!1,a._slideLazyCallbacks=[],a}return u()(t,e),o()(t,[{key:"addSlide",value:function(e){var t=e.slide,i=e.idx,n=e.callback,r=e.envLayout,a=e.lable;this._viewSlides.length>500&&(this._viewSlides.pop(),console.warn("viewSlide Array too long!")),this._viewSlides.unshift({slide:t,idx:i,callback:n,envLayout:r,lable:a,finished:!1}),this.finishBoolean?this.finishBoolean._arr.unshift(void 0):this.finishBoolean=new Kc}},{key:"addSlideAtLast",value:function(e){var t=e.slide,i=e.idx,n=e.callback,r=e.envLayout,a=e.lable;this._hasSlide(t)||(this._viewSlides.length>500&&(this._viewSlides.pop(),console.warn("viewSlide Array too long!")),this._viewSlides.push({slide:t,idx:i,callback:n,envLayout:r,lable:a}),this.finishBoolean?this.finishBoolean._arr.push(void 0):this.finishBoolean=new Kc)}},{key:"setActiveSlide",value:function(e){var t=e.activeSlide,i=e.callback,n=e.idx,r=e.envLayout;if(!t||this._activeSlide&&t===this._activeSlide)i&&this._activeSlide&&(this.activeSlide.callback=i);else{if(this._activeSlide){var a=this.viewSlides.findIndex((function(e){return e.lable===Qc.ACTIVESLIDE}));-1!==a&&this._viewSlides.splice(a,1)}this.activeSlideIdx=n,this._activeSlide=t,this.activeSlide={slide:this._activeSlide,idx:n,envLayout:r,lable:Qc.ACTIVESLIDE,finished:!1,callback:i},this._viewSlides.unshift(this.activeSlide),this.finishBoolean._arr.unshift(void 0)}}},{key:"setViewSlide",value:function(e){this._viewSlides=[].concat(S()(e||[])),this.activeSlide&&this._viewSlides.unshift(this.activeSlide),this.finishBoolean=new Kc(this._viewSlides.length);for(var t=0;t<this._viewSlides.length;t++)this._viewSlides[t].finished=!1,0===this._viewSlides[t].idx&&(this.homeSlide=this._viewSlides[t])}},{key:"getViewMode",value:function(){return window.APP&&window.APP.workspace.core.view.mode}},{key:"execGenerator",value:function(e){var t=this;if("object"!==(void 0===e?"undefined":I()(e)))return!0;var i=Date.now(),n=1;return new Promise((function(r,a){!function e(r,a){if(n++,r||console.trace(),n>1e3)setTimeout((function(){n=0,e(r,a)}));else{var o=r.next();if(o.done)++n>1e3?setTimeout((function(){a(!0)})):a(!0);else{var s=r;if("object"===I()(o.value)&&(s=o.value),t._runStatus!==Xc&&!t._firstAction&&t.pauseRender)return void t.pauseRender((function(){console.log("restart render task"),e(s,(function(){return e(r,a)}))}));n>1e3||Date.now()-i>25&&!t._firstRenderAction?(n=0,setTimeout((function(){i=Date.now(),e(s,(function(){return e(r,a)}))}),0)):e(s,(function(){return e(r,a)}))}}}(e,r)}))}},{key:"stopRunning",value:function(){}},{key:"_hasSlide",value:function(e){return-1!==this._viewSlides.findIndex((function(t){return t.slide===e}))}},{key:"_createSlideCtx",value:function(e,t,i){if(!e.ctx&&t){var n=t.svgLayout,r=t.viewBox,a=n.width||500,o=n.height||500,s=void 0,l=a/r.width;return i===Qc.THUMBNAIL&&v.userAgent.isSafari||(i===Qc.THUMBNAIL||i===Qc.SLIDELAYOUT)&&v.userAgent.chromeVS&&v.userAgent.chromeVS<60?(s=new Vs.default(r.width,r.height)).setAttribute("style","transform-origin:top left;transform:scale("+l+")"):s=new Vs.default(a,o),s.setViewBox(r),e.render(s,t),!0}return!1}},{key:"destroy",value:function(){this._viewSlides=[],this.activeSlide=null}},{key:"isWait",value:function(){return this._runStatus===qc}},{key:"viewSlides",get:function(){return this._viewSlides=this._viewSlides.filter((function(e){return!(e&&e.slide&&e.slide.isDestroy)})),this._viewSlides}},{key:"isFirstRenderAction",get:function(){return this._firstRenderAction}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new t,this._instance}}]),t}(x.a);$c.ViewLable=Qc,window.SlideRenderManager=$c;var ed=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.updateSlideById=function(e){var t=i.taskMap[e];if(t){var n=t.slideData,r=t.shapeIds;delete i.taskMap[e];for(var a=[],o=function(e){var t=r[e],n=t.id,o=t.e;t&&!a.find((function(e){return e.id===n&&i.canMerge(e.e,o)}))&&a.unshift(t)},s=r.length-1;s>=0;s--)o(s);i.fireDirect("update",{slideData:n,shapeIds:a})}},i.props=e,i.svgMap=[],i}return u()(t,e),o()(t,[{key:"destroy",value:function(){this.svgMap.forEach((function(e){var t=e.slide;t&&t.destroy()})),delete this.svgMap,this.svgMap=[]}},{key:"getSvg",value:function(e){var t=e.slideData,i=e.topLayer,n=e.layout;if(!t||t.isNormalSlide&&!t.parent)return null;var r=this.svgMap.find((function(e){if(e.slideData===t&&e.topLayer===i&&n&&e.slide.envLayoutResult&&n.ratio===e.slide.envLayoutResult.ratio)return!0}));return r&&r.slide||this.update(e)}},{key:"removeSvg",value:function(e){if(e){var t=e.mapIdx,i=this.svgMap[t];if(i&&i.slide===e)this.svgMap.splice(e.mapIdx,1);else{var n=this.svgMap.find((function(t){if(t.slide===e)return!0}));n&&this.svgMap.remove(n)}}}},{key:"update",value:function(e){var t=new zc(e),i=e.slideData,n=e.layout,r=e.topLayer,a=new Vs.default(n.svgLayout.width,n.svgLayout.height);a.clearRect(0,0,a.width,a.height),t.setENV({layout:n,ctx:a});var o={slideData:i,slide:t,topLayer:r};return this.svgMap.push(o),t.mapIdx=this.svgMap.length-1,t}},{key:"reRender",value:function(e){var t=this,i=this.svgMap.filter((function(t){if(t.slideData.getId()===e.slideId&&t.slideData.parent)return!0}));i.length&&(e.category&&"slides"!==e.category&&!e.name&&this.reRenderFollowedSlide(e),i.forEach((function(i){var n=i.slideData,r=i.slide,a=!1,o=e.op,s=e.shapeIds,l=e.vals,h=e.isDrawingShape,u=e.flags;switch(e.type){case"updateImage":e.shape.genSvgImage(e.data),s=[{id:e.shape.getId(),e:e}];break;case"updateShape":s=[{id:e.shape.getId(),e:e}];break;case"hasUpdateShapes":break;case"hasShapeFocus":s=s&&s.map((function(t){return{id:t,e:e}})),r.addUpdateShapeIds(s),$c.getInstance().run(),a=!0;break;default:if(o===Pu.default.op_add||o===Pu.default.op_remove){s=[];for(var c=0;c<l.length;c++){var d=l[c];if(d.isShape){var p=d.getId(),f=d.getShapeTree();if(f)if(h)e.treeIdx=f.getChildCount();else{var g=e.data;if(g.isShapeTree){var y=f.getChildIdxById(d.getId());e.treeIdx=y}else s.push({id:g&&g.getId(),e:e,shape:d})}s.push({id:p,e:e,shape:d})}}}else if(Object.isEmpty(e.modifiedShapeId))if(s&&s.length>0)s=s&&s.map((function(t){return{id:t,e:e}}));else if(e.event===Pu.default.modify_master_text_style)s=[],t.reRenderMasterTextStyle(e);else if(e.event===Pu.default.modify_slide&&r.isUpdateFollowing())r.updateSlide();else if(e.event===Pu.default.modify_page_setup||r.backgroundShape&&r.backgroundShape.getData()!==n.visual.getBackgroundShape()){var v=n.visual.getBackgroundShape();v&&(s=[{id:v.getId(),e:e}])}else s=[],(u&&u.hiddenInkChanged||e.data&&e.data.isShapeTree)&&(s=[{id:r.shapeTree.getId(),e:e}]);else s=[{id:e.modifiedShapeId,e:e}];r.addUpdateShapeIds(s),$c.getInstance().run(),t.updateSlideLayoutView(e.data),a=!0}if(!a){t.taskMap=t.taskMap||{};var m,_,w="t"+n.getId();if(t.taskMap[w])(m=t.taskMap[w].shapeIds).push.apply(m,S()(s));else if(t.taskMap[w]={slideData:n,shapeIds:(_=[]).concat.apply(_,S()(s))},window.APP.firRenderEnd){var x=void 0,T=void 0,k=function(){clearTimeout(x),cancelAnimationFrame(T),t.updateSlideById(w)};x=setTimeout(k,1e3),T=requestAnimationFrame(k)}else t.updateSlideById(w)}})))}},{key:"reRenderFollowedSlide",value:function(e){var t=this,i=e.data,n=e.slideId,r=e.category,a=e.vals,o=void 0;if(i){if(i.isShapeTree&&a)o=a;else{for(;i&&!i.isShape;)i=i.parent;o=[i]}o.forEach((function(e){if(e&&(e.isPlaceHolder()||e.isBackground()))for(var i=window.APP.presentation.getFollowedSlidesById(n,r)||[],a=function(n){var r=i[n],a=r.category,o=[e];if(e.isPlaceHolder()){var s=e.getSlide();o=r.matchPhShapeByFollowing(e,s&&s.isMasterSlide)}o&&o.forEach((function(e){t.reRender({category:a,type:"hasShapeFocus",data:e,shapeIds:[e.getId()],slideId:r.getId()})}))},o=0;o<i.length;o++)a(o)}))}}},{key:"reRenderMasterTextStyle",value:function(e){for(var t=e.slideId,i=e.category,n=window.APP.presentation.getFollowedSlidesById(t,i)||[],r=0;r<n.length;r++){for(var a=n[r],o=a.category,s=a.getSpTree(),l=0,h=s.getChildCount();l<h;l++){var u=s.getChildAt(l);u&&u.visual.useMasterTextStyle()&&this.reRender({category:o,type:"hasShapeFocus",data:u,shapeIds:[u.getId()],slideId:a.getId()})}a.isNormalSlide||this.reRenderMasterTextStyle({slideId:a.getId(),category:o})}}},{key:"reRenderSlides",value:function(e){[].concat(S()(this.svgMap)).forEach((function(t){var i=t.slideData,n=t.slide,r=i.visual.getBackgroundShape();if(r){var a=[{id:r.getId(),e:e}];n.addUpdateShapeIds(a)}}))}},{key:"updateSlideLayoutView",value:function(e){if(e){for(var t=e;t&&!t.isSlideType;)t=t.parent;if(t&&(t.isMasterSlide||t.isLayoutSlide)){var i=window.APP.workspace&&window.APP.workspace.core,n=i&&i.view;clearTimeout(this._slideLayoutViewTimer),this._slideLayoutViewTimer=setTimeout((function(){n.slideLayoutView&&n.slideLayoutView.slideRenderMgr.run()}),200)}}}},{key:"canMerge",value:function(e,t){if(!(e&&t&&e.data&&t.data))return!0;var i=[Pu.default.op_add,Pu.default.op_remove,Pu.default.op_move];return!(t&&t.data&&t.data.isShapeTree&&i.includes(t.op))&&(!(e&&e.data&&e.data.isShapeTree&&i.includes(e.op))&&(t&&e&&t.updatePartName&&!e.updatePartName&&(e.updatePartName=t.updatePartName),t&&e&&t.updateAttrName&&!e.updateAttrName&&(e.updateAttrName=t.updateAttrName),!0))}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new t,this._instance}}]),t}(x.a);window.SlidePool=ed;var td=function(){function e(t){var i=t.x,n=t.y,a=t.width,o=t.height;r()(this,e),this.x=i,this.y=n,this.width=a,this.height=o}return o()(e,[{key:"contains",value:function(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height}}]),e}(),id=function(){function e(){r()(this,e),this.enableSVGgArr=[],this.enableDivArr=[],this._init()}return o()(e,[{key:"_init",value:function(){this.container=this._createContainerDiv(),this.rootDiv=this._createDivElement(),this._currentIndex=0}},{key:"_createDomArr",value:function(){this.containerArr=[],this.rootArr=[];for(var t=0;t<e.ContainerCount;t++){var i=this._createDivElement();i.setAttribute("class","play_svg_container");var n=this.getLayout();n&&window.domTools.setStyle(i,{width:n.viewBox.width,height:n.viewBox.height});var r=document.createElement("div");r.setAttribute("class","play_root"),this.rootArr.push(r),this.containerArr.push(i)}}},{key:"_createContainerDiv",value:function(){var e=this._createDivElement();e.setAttribute("class","play_svg_container");var t=this.getLayout();return t&&window.domTools.setStyle(e,{width:t.viewBox.width+1,height:t.viewBox.height+1}),e}},{key:"_createRootDiv",value:function(){var e=document.createElement("div");e.setAttribute("class","play_root");var t={position:"absolute",top:0,left:0};return window.rightToLeft&&Object.assign(t,{direction:"ltr"}),window.domTools.setStyle(e,t),e}},{key:"resize",value:function(e){window.domTools.setStyle(this.container,{"transform-origin":"left top",transform:"scale("+e+","+e+")"}),this.containerScale=e}},{key:"setLayout",value:function(e){!e||this.layout&&e.scale===this.layout.scale&&e.viewBox.width===this.layout.viewBox.width&&e.viewBox.height===this.layout.viewBox.height||(window.domTools.setStyle(this.container,{width:e.viewBox.width,height:e.viewBox.height}),this.layout=e,this.updateViewBox())}},{key:"getLayout",value:function(){return this.layout}},{key:"_createSVGElement",value:function(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");return t.setAttribute("version",1.1),t.setAttribute("xmlns",e),t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),t.setAttribute("overflow","visible"),t}},{key:"_createGroupElement",value:function(){return document.createElementNS("http://www.w3.org/2000/svg","g")}},{key:"_createDivElement",value:function(){return document.createElement("div")}},{key:"_getDivElement",value:function(){return this.enableDivArr.length?this.enableDivArr.pop():this._createDivElement()}},{key:"_getSVGElement",value:function(){return this.enableSVGgArr.length?this.enableSVGgArr.pop():this._createSVGElement()}},{key:"_splitShapeTree",value:function(t,i,n){for(var r=0,a=t.childElementCount;r<a;r++){var o=t.childNodes[r],s=o.id,l=void 0,h=i;switch(s){case"s_bg":l=o;break;case"l_s":h=i._layoutSlide,this._layoutId=h&&h.getId();break;case"m_s":h=i._masterSlide,this._masterId=h&&h.getId();break;case"s_t":h=i._curSlide}if(h){if("s_bg"!==s){var u=h.slideData.getSpTree(),c=u&&u.getId();l=o&&o.querySelector("#s_"+c)}var d=this.getLayout(),p=this._createDivElement();if(p.id=s,p.setAttribute("class","slide_layer"),window.domTools.setStyle(p,{width:d.viewBox.width,height:d.viewBox.height,left:0,top:0}),this.container.appendChild(p),l){var f=this._createDivElement();this.clearDom(f),f.id=e.SplitNodeName+l.id,p.appendChild(f),window.domTools.setStyle(f,{width:d.viewBox.width,height:d.viewBox.height,left:0,top:0}),this._splitShape(l,h,d,f,n)}}}}},{key:"_splitShape",value:function(t,i,n,r,a){for(var o=0,s=t.childElementCount;o<s;o++){var l=t.childNodes[o],h=this._getDivElement();this.clearDom(h);var u=this._getSVGElement();this.clearDom(u),h.id=e.SplitNodeName+l.id;var c=Number(l.id.split("_")[1]),d=l.cloneNode(!0);if(isNaN(c))this._splitBackgroundShape(i,n,r,h,d,u);else{var p=i&&i.getShape(c),f=p&&p.layout(p.scale);if(!f)continue;var g=f.getAnimationRect(),y=f.getAnimationRect();d.setAttribute("transform","translate("+-y.x+","+-y.y+")");var v=window.Rect.create(g),m=v.rotationAtCenter(y.rotation),_=v.x()-m.x(),w=v.y()-m.y(),S=g.x-_,x=g.y-w,T=Math.max(1,m.width()),k=Math.max(1,m.height());window.domTools.setStyle(h,{left:S,top:x,width:T,height:k}),p&&p.isNiteInk()&&window.domTools.setStyle(h,{"mix-blend-mode":"multiply"}),window.domTools.setStyle(u,{left:_,top:w,"transform-origin":"left top"}),u.appendChild(d),h.appendChild(u),r.appendChild(h);var C=p&&p.getData(),b=p.getSlideView(),E=f.extendList.typoTextBody,R=a[b.getId()+"_"+C.getId()];R&&E&&E.hasText&&(this._splitText(u,h,r,p,R),h.isSplit=!0)}}}},{key:"_splitBackgroundShape",value:function(e,t,i,n,r,a){var o=e.getCurSlide()&&e.getCurSlide().backgroundShape;if(o&&o.layout()){r.setAttribute("transform","translate(0,0)"),window.domTools.setStyle(n,{width:t.viewBox.width,height:t.viewBox.height,left:0,top:0,transform:"scale(1,1)","transform-origin":"left top"}),window.domTools.setStyle(a,{width:t.viewBox.width,height:t.viewBox.height,left:0,top:0}),a.appendChild(r),n.appendChild(a),i.appendChild(n)}}},{key:"_splitText",value:function(e,t,i,n,r){var a=n&&n.getData(),o=n&&n.layout(),s=o&&o.extendList&&o.extendList.typoTextBody,l=s&&s.getChilds();if(l&&0!==l.length)for(var h=o.getRealRectPx(),u=a.getId(),c=t.querySelector("#"+v.PartOfShapeName.Text(u)),d=0;d<l.length;++d){var p=c.querySelector("#text_paragraph_"+d),f=l[d];r[d]?this._splitByGlyph({shapeData:a,typoTextBody:s,typoParagraph:f,shapeTree_wapper:i,svg_wapper:t,svg:e,para_group:p,realyRectPx:h}):(this._splitByParagraph({shapeData:a,typoTextBody:s,typoParagraph:f,shapeTree_wapper:i,svg_wapper:t,svg:e,para_group:p,realyRectPx:h}),c.remove())}}},{key:"_splitByParagraph",value:function(t){var i=t.shapeData,n=t.typoTextBody,r=t.typoParagraph,a=t.shapeTree_wapper,o=t.svg_wapper,s=t.svg,l=t.para_group,h=t.realyRectPx,u=o.cloneNode(),c=s.cloneNode(),d=l.cloneNode(!0);u.appendChild(c),a.appendChild(u);var p=r.getBeginCcp(),f=p.begin,g=p.ccp;u.id=e.SplitNodeName+"s_"+i.getId()+"_"+f+"_"+(f+g);var y=n.overflowLeft,v=n.overflowTop,m=y<0?-y:0,_=v<0?-v:0,w=n.x+r.x-m,S=n.y+r.y-_,x=new window.Rect(w,S,r.width,r.height),T=window.Rect.create(x),k=T.rotationAtCenter(h.rotation,new window.Point(h.width/2,h.height/2)),C=k.width(),b=k.height(),E=T.x()-k.x(),R=T.y()-k.y(),P=new window.QMatrix;P.translate(-w,-S),P.translate(h.width/2,h.height/2),P.rotate(h.rotation),P.translate(-h.width/2,-h.height/2),P.translate(w,S),d.setAttribute("transform",P.toString()),c.appendChild(d),window.domTools.setStyle(u,{left:h.x+w-E,top:h.y+S-R,width:C+"px",height:b+"px"}),window.domTools.setStyle(c,{left:E,top:R})}},{key:"_splitByGlyph",value:function(e){var t=e.shapeData,i=e.typoTextBody,n=e.typoParagraph,r=e.shapeTree_wapper,a=e.svg_wapper,o=e.svg,s=e.para_group,l=e.realyRectPx,h=n.getTypoTextLines(),u=n.getTypoAutoNum();if(s&&n&&h&&!(h.length<1))for(var c=u&&s.querySelector("#text_autoNum"),d=0;d<h.length;++d){var p=h[d],f=s.querySelector("#text_line_"+d),g=f.childNodes;if(f&&p&&!(g.length<1))for(var y=0;y<g.length;++y){var v=g[y];"text"===v.tagName?(this._splitSpan({typoAutonum:u,autonum_group:c,realyRectPx:l,shapeData:t,typoTextBody:i,typoParagraph:n,typoLine:p,shapeTree_wapper:r,svg_wapper:a,svg:o,glyph_node:v}),v.remove(),y--):"g"===v.tagName?(this._splitGlyph({typoAutonum:u,autonum_group:c,realyRectPx:l,shapeData:t,typoTextBody:i,typoParagraph:n,typoLine:p,shapeTree_wapper:r,svg_wapper:a,svg:o,glyph_node:v}),v.remove(),y--):v.tagName,c=null}}}},{key:"_splitSpan",value:function(t){var i=t.typoAutonum,n=t.autonum_group,r=t.realyRectPx,a=t.shapeData,o=t.typoTextBody,s=t.typoParagraph,l=t.typoLine,h=t.shapeTree_wapper,u=t.svg_wapper,c=t.svg,d=t.glyph_node,p=d.childNodes;if(!(p.length<1))for(var f=0;f<p.length;f++){var g=p[f],y=g.getAttribute("x"),v=g.getAttribute("y"),m=g.getAttribute("gcps");y=y?y&&y.split(" ").map((function(e){return Number(e)})):[],v=v?v&&v.split(" ").map((function(e){return Number(e)})):[],m=m?m&&m.split(" ").map((function(e){return Number(e)})):[];for(var _=this._covSvgText2Str(g.textContent),w=0;w<_.length;w++){var S=_[w],x=d.cloneNode(),T=g.cloneNode(),k=this._createGroupElement(),C=o.overflowLeft,b=o.overflowTop,E=C<0?-C:0,R=b<0?-b:0,P=o.x+s.x+l.x-E+y[w],I=o.y+s.y+l.y-R,L=n&&0===f&&0===w;if(L){var A=n.firstElementChild.cloneNode(!0);A.setAttribute("x",y[w]),A.setAttribute("y",i.height-i.descent),P-=l.x,A.id="text_autonum",k.appendChild(A),n.remove()}var B=document.createTextNode(S);T.setAttribute("class","clone_text"),T.appendChild(B),T.setAttribute("x",L?l.x:0),T.setAttribute("y",v[w]);var D=m[w],M=void 0,O=void 0;if(!isNaN(D)){var N=s.getBeginCcp().begin,F=s.getGlyphByGcp(D-N);if(F){var V=F.height-F.y+l.descent-F.descent;I-=V,T.setAttribute("y",V+F.y-l.descent),M=L?l.x+F.width:F.width,O=Math.max(F.y,F.height)}}var U=new window.Rect(P,I,M,O),G=window.Rect.create(U),H=G.rotationAtCenter(r.rotation,new window.Point(r.width/2,r.height/2));M=H.width(),O=H.height();var W=G.x()-H.x(),j=G.y()-H.y(),Y=u.cloneNode();window.domTools.setStyle(Y,{left:r.x+P-W,top:r.y+I-j,width:M+"px",height:O+"px"}),Y.id=e.SplitNodeName+"s_"+a.getId()+"_"+D+"_"+D;var z=new window.QMatrix;z.translate(-P+r.width/2,-I+r.height/2),z.rotate(r.rotation),z.translate(P-r.width/2,I-r.height/2),k.setAttribute("transform",z.toString());var K=c.cloneNode();window.domTools.setStyle(K,{left:W,top:j}),x.appendChild(T),k.appendChild(x),K.appendChild(k),Y.appendChild(K),h.appendChild(Y)}}}},{key:"_splitGlyph",value:function(t){var i=t.typoAutonum,n=t.autonum_group,r=t.realyRectPx,a=t.shapeData,o=t.typoTextBody,s=t.typoParagraph,l=t.typoLine,h=t.shapeTree_wapper,u=t.svg_wapper,c=t.svg,d=t.glyph_node,p=u.cloneNode(),f=d.cloneNode(!0),g=this._createGroupElement(),y=c.cloneNode(),v=Number(f.id.slice(4));p.id=e.SplitNodeName+"s_"+a.getId()+"_"+v+"_"+v;var m=o.overflowLeft,_=o.overflowTop,w=m<0?-m:0,S=_<0?-_:0,x=o.x+s.x+l.x-w,T=o.y+s.y+l.y-S,k=f.firstElementChild;k.setAttribute("class","clone_text");var b=0,E=0,R=void 0;if(n){R=n.firstElementChild.cloneNode(!0);var P=i.getVerticalType();P===C.TextVerticalType.Horizontal?(R.setAttribute("x",-l.x-Number(k.getAttribute("x"))),R.setAttribute("y",Number(k.getAttribute("y")))):P===C.TextVerticalType.EastAsianVer||P===C.TextVerticalType.Vertical?(R.setAttribute("transform","rotate(90, 0, 0)"),R.setAttribute("x",-Number(k.getAttribute("y"))),R.setAttribute("y",l.x+Number(k.getAttribute("x"))),E+=l.y,T-=l.y):P===C.TextVerticalType.Vertical270?(R.setAttribute("transform","rotate(270, 0, 0)"),R.setAttribute("x",-i.width-.8*i.height),R.setAttribute("y",i.width),E+=i.width):P===C.TextVerticalType.VerticalWordArtRightToLeft&&(R.setAttribute("x",0),R.setAttribute("y",i.width-i.descent),E+=l.y,T-=l.y),R.id="text_autonum",g.appendChild(R),n.remove()}if(!isNaN(v)){var I=s.getBeginCcp().begin,L=s.getGlyphByGcp(v-I);if(L){var A=L.getVerticalType(),B=L.descent;if(A===C.TextVerticalType.Horizontal){x+=Number(k.getAttribute("x")),k.setAttribute("x",0);var D=L.height-L.y+l.descent-L.descent;T-=D,k.setAttribute("y",D+L.y-l.descent)}else A===C.TextVerticalType.EastAsianVer?(x+=Number(k.getAttribute("x")),L.isVerticalRotateChar()?(f.setAttribute("transform","rotate(90, 0, 0)"),T+=Number(k.getAttribute("y")),k.setAttribute("x",n?l.y:0),k.setAttribute("y",0)):(T+=Number(k.getAttribute("y")-L.height+B),k.setAttribute("y",n?l.y:0),k.setAttribute("y",n?L.height-B+l.y:L.height-B),R&&R.setAttribute("x",2*i.descent))):A===C.TextVerticalType.Vertical?(x+=Number(k.getAttribute("x"))-B,k.setAttribute("x",n?l.y:0),T+=Number(k.getAttribute("y")),k.setAttribute("y",-B),f.setAttribute("transform","rotate(90, 0, 0)")):A===C.TextVerticalType.Vertical270?(x+=Number(k.getAttribute("x"))-L.width+B,k.setAttribute("x",-L.height),T+=Number(k.getAttribute("y"))-L.height,k.setAttribute("y",L.width-B),f.setAttribute("transform","rotate(270, 0, 0)")):A===C.TextVerticalType.VerticalWordArtRightToLeft&&(x+=Number(k.getAttribute("x")),k.setAttribute("x",0),T+=Number(k.getAttribute("y"))-L.height+B,k.setAttribute("y",n?L.height-B+l.y:L.height-B));b+=L.width,E+=L.height}}var M=new window.Rect(x,T,b,E),O=window.Rect.create(M),N=O.rotationAtCenter(r.rotation,new window.Point(r.width/2,r.height/2));b=N.width(),E=N.height();var F=O.x()-N.x(),V=O.y()-N.y();window.domTools.setStyle(p,{left:r.x+x-F,top:r.y+T-V,width:b+"px",height:E+"px"});var U=new window.QMatrix;U.translate(-x,-T),U.translate(r.width/2,r.height/2),U.rotate(r.rotation),U.translate(-r.width/2,-r.height/2),U.translate(x,T),g.setAttribute("transform",U.toString()),window.domTools.setStyle(y,{left:F,top:V}),g.appendChild(f),y.appendChild(g),p.appendChild(y),h.appendChild(p)}},{key:"_covSvgText2Str",value:function(e){var t=e;return t=(t=(t=(t=t.replace(/&nbsp;/g," ")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&")}},{key:"_splitWaterMark",value:function(e,t,i){if(t){this.disconnectWatermarkObserver();var n=this._getDivElement(),r=this._getSVGElement();this.clearDom(n),this.clearDom(r),n.id="g_wmk",n.setAttribute("class","slide_layer");var a=e.parentElement.parentElement;if(a){var o=a.firstElementChild;o&&o.childNodes&&o.childNodes.forEach((function(e){window.domTools.addSvgDefs(e)}))}window.domTools.setStyle(n,{"z-index":99999,width:2*i.viewBox.width,height:2*i.viewBox.height,left:0,top:0}),window.domTools.setStyle(r,{left:0,top:0,"transform-origin":"left top"}),r.id="svg_wmk",r.appendChild(t.cloneNode(!0)),n.appendChild(r),this.container.appendChild(n),this._createWatermarkObserver()}}},{key:"split",value:function(e,t){this._slideId=e.getId();var i=e.ctx.getSvg().lastElementChild.firstElementChild,n=this.getLayout();if(i&&e&&n){var r=this._createRootDiv(),a=this._createContainerDiv();this.rootDiv=r,this.container=a,a.innerHTML="",a.id=this._slideId,r.innerHTML="";var o=this.containerScale||1,s=v.userAgent.isIos?{zoom:o}:{"transform-origin":"left top",transform:"scale("+o+","+o+")"};window.domTools.setStyle(this.container,s),r.appendChild(a),this._splitShapeTree(i,e,t);var l=i.parentElement&&i.parentElement.querySelector("#g_wmk");return this._splitWaterMark(i,l,n),r}}},{key:"updateWaterMark",value:function(e){if(e&&e.lastElementChild&&this.container){var t=e.lastElementChild.firstElementChild;if(t){var i=e.querySelector("#g_wmk"),n=this.getLayout(),r=this.container.querySelector("#g_wmk");r&&r.remove(),this._splitWaterMark(t,i,n)}}else;}},{key:"_createWatermarkObserver",value:function(){var e=this,t=function(e){return"g_wmk"===e||"wmk_text_wrapper"===e||"svg_wmk"===e},i=function(e){return e&&e.indexOf("wmk_text")>-1},n=function(e){return!!e&&(t(e.id)||i(e.getAttribute("class")))},r=new MutationObserver((function(r,a){for(var o=!1,s=function(a){var s=r[a],l=s.target;if("childList"===s.type&&Array.prototype.find.call(s.removedNodes,(function(e){return"#text"===e.nodeName?n(l):n(e)})))return o=!0,"break";if("attributes"===s.type)if(n(l)){if("style"===s.attributeName)return o=!0,"break";e.disconnectWatermarkObserver(),s.oldValue&&l.setAttribute(s.attributeName,s.oldValue),e.observeWatermark(e.container)}else("id"===s.attributeName&&t(s.oldValue)||"class"===s.attributeName&&i(s.oldValue))&&(e.disconnectWatermarkObserver(),s.oldValue&&l.setAttribute(s.attributeName,s.oldValue),e.observeWatermark(e.container));else"characterData"===s.type&&"#text"===l.nodeName&&n(l.parentElement)&&(e.disconnectWatermarkObserver(),l.nodeValue=s.oldValue,e.observeWatermark(e.container))},l=0;l<r.length;++l){if("break"===s(l))break}o&&(e.disconnectWatermarkObserver(),window.APP.openAPI.updateWatermark(),e.observeWatermark(e.container))}));this.watermarkObserver=r,this.observeWatermark(this.container)}},{key:"observeWatermark",value:function(e){e?this.watermarkObserver&&this.watermarkObserver.observe(e,{attributes:!0,childList:!0,subtree:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}):console.warn("no watermark group")}},{key:"disconnectWatermarkObserver",value:function(){this.watermarkObserver&&this.watermarkObserver.disconnect()}},{key:"updateViewBox",value:function(){var e=this.getLayout();if(e&&this.container){var t=e.viewBox,i=t.width,n=t.height;window.domTools.setStyle(this.container,{width:i,height:n});for(var r=0,a=this.container.childElementCount;r<a;r++){var o=this.container.childNodes[r];if("s_bg"===o.id)for(var s=o;s&&"svg"!==s.parentElement.tagName;)window.domTools.setStyle(s,{width:i,height:n}),s=s.firstElementChild;else{window.domTools.setStyle(o,{width:i,height:n});var l=o.firstElementChild;window.domTools.setStyle(l,{width:i,height:n})}}}}},{key:"update",value:function(t,i,n){if(t&&i){var r=n.id,a=n.shape,o=t.ctx.getSvg(),s=t.slideData.getSpTree(),l=s&&s.getId();if(r===l){var h=t.shapeTree.shapes,u=i.querySelector("#"+e.SplitNodeName+"s_"+r);this.clearPlayerdom(r,i);for(var c=0,d=h.length;c<d;c++){var p=h[c],f=p.getId();this.update(t,i,{id:f,shape:p.getData()})}this.clearEmptyDom(u)}else{if(r<0&&this.updateInkDom(t,r,i)){var g=o.querySelector("#ink_"+r),y=i.querySelector("#ink_"+r);if(g&&y){for(var m=g.childNodes,_=y.childNodes,w=m.length-1;w>=0;w--)if(_[w]){if(m[w].id===_[w].id)break;window.domTools.cloneChildNodes(m[w],_[w]),_[w].id=m[w].id}else y.appendChild(m[w].cloneNode(!0));return}}var S=o.querySelector("g#s_"+r),x=!1,T=i.querySelector("#"+e.SplitNodeName+"s_"+r);if(!S)return void(T?!(r<0)||T.isNiteInk||a&&a.bLocalNoTransact?T.remove():setTimeout((function(){T&&T.remove()}),1e3):console.warn("cannot update player svg",r));var k=t.getShape(r),C=k&&k.layout(k.scale);if(!C)return;if(!T){var b=i.querySelector("#s_"+r);if(b)return void window.domTools.cloneChildNodes(S,b);x=!0,(T=this._createDivElement()).id=e.SplitNodeName+"s_"+r,k&&k.isNiteInk()&&(window.domTools.setStyle(T,{"mix-blend-mode":"multiply"}),T.isNiteInk=!0)}for(;T.childNodes[0];)T.childNodes[0].remove();var E=!0,R=window.APP.shell.doc.animePlayer;R&&(E=R.getAnimationTargetVisible(t.getId(),r));var P=S.cloneNode(!0),I=C.getRealRectPx(),L=C.getRealRect();P.setAttribute("transform","translate("+-L.x+","+-L.y+")");var A=1*I.width,B=1*I.height;window.domTools.setStyle(T,{width:A<1?1:A,height:B<1?1:B,left:1*I.x,top:1*I.y,opacity:E?1:0}),v.userAgent.isEdge&&window.domTools.setStyle(T,{filter:"opacity(1)"});var D=this._createSVGElement();if(window.domTools.setStyle(D,{left:0,top:0,transform:"scale(1,1)","transform-origin":"left top"}),T.isSplit&&this._updateText(P,i,l,r,I,1),D.appendChild(P),T.innerHTML="",T.appendChild(D),x){var M=i.querySelector("#"+e.SplitNodeName+"s_"+l);M&&M.appendChild(T)}}}}},{key:"updateInkDom",value:function(t,i,n){var r=t.ctx.getSvg().querySelector("#ink_"+i),a=n.querySelector("#ink_"+i);if(!r||!a)return!1;for(var o=r.childNodes,s=a.childNodes,l=o.length-1;l>=0;l--)if(s[l]){if(o[l].id===s[l].id)break;window.domTools.cloneChildNodes(o[l],s[l]),s[l].id=o[l].id}else a.appendChild(o[l].cloneNode(!0));var h=t.getShape(i);if(!(h&&h.layout()))return!1;var u=n.querySelector("#"+e.SplitNodeName+"s_"+i);return u&&u.childNodes[0]&&window.domTools.setStyle(u.childNodes[0],{left:0,top:0,transform:"scale(1,1)","transform-origin":"left top"}),!0}},{key:"_updateText",value:function(t,i,n,r,a,o){var s=t.querySelector("#s_"+r+"_text"),l=(s=s&&s.firstElementChild)&&s.firstElementChild;if(l){for(var h=0,u=l.childElementCount;h<u;h++){var c=l.childNodes[h],d=i.querySelector("#"+e.SplitNodeName+"s_"+n),p=d&&d.querySelector("#"+e.SplitNodeName+"s_"+r+"_"+h);if(p){window.domTools.setStyle(p,{width:a.width*o||1,height:a.height*o||1,left:a.x*o,top:a.y*o});var f=p.querySelector("#s_"+r+"_text"),g=f&&f.firstElementChild,y=g&&g.firstElementChild;window.domTools.cloneChildNodes(c,y)}}s&&s.remove()}}},{key:"insertNodeAfterShapeById",value:function(t,i,n){var r=void 0;switch(t){case this._slideId:r=this.container.querySelector("#s_t");break;case this._layoutId:r=this.container.querySelector("#l_s");break;case this._masterId:r=this.container.querySelector("#m_s")}if(!r||!n)return console.warn("this slide is not playing! ",t),!1;var a=r.querySelector("#"+e.SplitNodeName+"s_"+i);if(!a)return console.warn("this slide cannot find shape",t,i),!1;var o=a.parentElement,s=a.nextSibling;return s?o.insertBefore(n,s):o.appendChild(n),!0}},{key:"removeShapeNode",value:function(e){e&&e.remove()}},{key:"clearPlayerdom",value:function(t,i){var n=i.querySelector("#"+e.SplitNodeName+"s_"+t);if(!n){var r=this._createDivElement();return r.id=e.SplitNodeName+"s_"+t,void i.appendChild(r)}var a=n.childNodes;a&&a.forEach((function(e){for(;e.childNodes[0];)e.childNodes[0].remove()}))}},{key:"clearEmptyDom",value:function(e){if(e){var t=e.childNodes;if(t)for(var i=0;i<t.length;){var n=t[i];n.childNodes[0]?i++:n.remove()}}}},{key:"clearDom",value:function(e){e&&(e.removeAttribute("style"),e.removeAttribute("class"),e.removeAttribute("id"),e.innerHTML="")}},{key:"destroy",value:function(){this.enableDivArr=[],this.enableSVGgArr=[],this.rootDiv=null,this.container=null,this.rootArr=[],this.containerArr=[],this.containerScale=1,this.disconnectWatermarkObserver(),this.watermarkObserver=null}}],[{key:"getInstance",value:function(){return this._splitSVG=this._splitSVG||new e,this._splitSVG.rootDiv||this._splitSVG._init(),this._splitSVG}}]),e}();id.SplitNodeName="play_view_",id.ContainerCount=5;var nd=id,rd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.scale=1,i}return u()(t,e),o()(t,[{key:"getData",value:function(){return window.APP?window.APP.watermark||{}:(console.warn(this.constructor.name+" window.APP is undefined, watermark not support!"),{})}},{key:"saveTextLine",value:function(e,t,i){this._textline=this._textline||[],this._textline[e]=_()({},i,{text:t})}},{key:"getTextLines",value:function(){return this._textline||[]}},{key:"type",get:function(){return this.getData().type}},{key:"text",get:function(){return this.getData().value}},{key:"font",get:function(){var e=this.fontObj,t=e.fontWeight,i=e.fontFamily;return t+" "+e.fontSize+"px '"+i.trim()+"'"}},{key:"fontObj",get:function(){if(!this._fontObj){var e=this.getData().font,t=e.match(/\d+/g);t&&(t=parseInt(t[0])),-1!==e.indexOf(t+"pt")?(e=e.replace(t+"pt",""),t*=1.333):e=e.replace(t+"px","");var i="";-1!==e.indexOf("bold ")&&(i="bold",e=e.replace("bold","")),e=e.replace("normal",""),this._fontObj={fontStyle:"normal",fontVariant:"normal",fontWeight:i,fontFamily:e,fontSize:t*this.scale}}return this._fontObj}},{key:"fillStyle",get:function(){var e=this.getData(),t=e.fillStyle,i=e.fillstyle;return t||i}},{key:"rotate",get:function(){return this.getData().rotate}},{key:"horizontal",get:function(){return this.getData().horizontal*this.scale}},{key:"vertical",get:function(){return this.getData().vertical*this.scale}},{key:"textAlign",get:function(){return"center"}}]),t}(mo),ad=function(){function e(t){r()(this,e)}return o()(e,null,[{key:"measure",value:function(e){var t=e.scale;if(this.data&&t===this.data.scale)return this.data;this.data=new rd;var i=this.data;if(1===i.type){var n=i.text.split(/\n/g),r=0;n.length>1&&(""!==n[n.length-1]&&" "!==n[n.length-1]||(n=n.slice(0,n.length-1)));for(var a=0;a<n.length;a++){var o=wr(n[a],i.fontObj),s=o.width,l=o.height;s>r&&(r=s),i.saveTextLine(a,n[a],{width:s,height:l}),i.height+=l}return i.width=r,i}return null}}]),e}(),od=function(){function e(t){r()(this,e),this.props=t}return o()(e,null,[{key:"render",value:function(e,t,i){if(t&&1===Number(t.type)){var n=i.viewBox;e.save("g_wmk"),e.beginPath(),e.rect(0,0,n.width,n.height),e.clip(),e.getCurrentElement().id="wmk_text_wrapper",e.translate(n.width/2,n.height/2),e.rotate(t.rotate),e.translate(-n.width,-n.height),e.textAlign=t.textAlign;var r=t.font;e.font=r,e.fillStyle=t.fillStyle;for(var a=0,o=t.getTextLines(),s=0;s<2*n.height;){var l=0;for(a%2==0?l+=t.horizontal/2:l-=t.horizontal/2;l<2*n.width;){for(var h=0,u=0;u<o.length;u++){var c=o[u];if(c)h+=c.height,e.fillText(c.text,l,s+h,t.width),e.getCurrentElement().classList.add("wmk_text")}var d=t.horizontal+t.width;if(d<=0)break;l+=d}var p=t.vertical+t.height;if(p<=0)break;s+=p,a++}return e.restore(),"wmk"}}}]),e}(),sd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i._onSlideResize=function(e){i.fire(t.EVENT_TYPES.SLIDE_RESIZE,new T({slideId:i.getId()}))},i._onSlideChange=function(){i.fire(t.EVENT_TYPES.SLIDE_CHANGE,new T({slideId:i.getId()}))},i.onShapeUpdate=function(e){var t=e.slideData,n=e.shapeIds;if(i.domSvgRef&&i.slideData.parent){var r=i.getId(),a=i.domSvgRef;if(0!==a.length){i._update();var o=i._curSlide&&i._curSlide.getData(),s=o&&o.getFollowing()||i._layoutSlide&&i._layoutSlide.slideData,l=s&&s.getFollowing()||i._masterSlide&&i._masterSlide.slideData,h=t.getId()===(i._masterSlide&&l&&l.getId()),u=t.getId()===(i._layoutSlide&&s&&s.getId()),c=t.getId()===(i._curSlide&&o&&o.getId());if(h||u||c){var d=c&&i._curSlide.ctx.getSvg(),p=u&&i._layoutSlide.ctx.getSvg(),f=h&&i._masterSlide.ctx.getSvg();a.forEach((function(e){if("svg"!==e.nodeName||e.curSlideId===r){if(h){window.domTools.addCommonDefs(f);var a=e.querySelector("#m_s"),o=l.getSpTree(),g=o&&o.getId();i.copySvgElement(f,a,n,g),i.updateFieldTextShapes(a,l.fieldShapes),i.updatePlayViewElement(i._masterSlide,a,n)}if(u){window.domTools.addCommonDefs(p);var y=e.querySelector("#l_s"),v=s.getSpTree(),m=v&&v.getId();i.copySvgElement(p,y,n,m),i.updateFieldTextShapes(y,s.fieldShapes),i.updatePlayViewElement(i._layoutSlide,y,n)}if(c){window.domTools.addCommonDefs(d);var _=e.querySelector("#s_t"),w=i.slideData.getSpTree(),S=w&&w.getId();i.copySvgElement(d,_,n,S),i.updatePlayViewElement(i._curSlide,_,n)}i._updateSlideBackground(e,n,t),e.onUpdate&&e.onUpdate(t.getId())}})),i.onRenderNotify(i._isRenderFinish),i._isSvgUpdateFinish=!0,i.onRenderFinish()}}}},i._fireSlideRenderFinishedEvent=Object(Cn.throttle)((function(){var e=i.getId(),n=i.getProxyGid(),r=i.getDataToken();i.fire(t.EVENT_TYPES.SLIDE_RENDER_FINISHED,new T({slideIndex:i.proxy&&i.proxy.idx,slideId:e,slidePGid:n,dataToken:r,finished:!0}))}),16),i.handlerProxyDataLoaded=function(e){if(i.slideData=i.slidesLoader.getSlideByIdxProxy(i.proxy),i._proxyTimer&&clearTimeout(i._proxyTimer),i._proxyTimer=null,!i.isDestroy&&(i._init(i.slideData),i._draw(e),i.isLazyload&&i.root)){i.isLazyload=!1;var t=i.root.slideRenderMgr;if(!t)return void console.error(i.root.constructor.name,"need slideRenderMgr method");t.viewSlides.find((function(e){return e.slide===i}))&&t.run()}},i.updateRender=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasInit&&this.domSvgRef){e.next=2;break}return e.abrupt("return",!1);case 2:if(this._update(),this.isRendering=!0,!this.renderSlideLable&&this.isFirstRender&&this.slideData&&(this.renderSlideLable="renderSlide_"+this.slideData.getId()+"_"+E(),R.timeStart(this.renderSlideLable)),this.isFirstRender=!1,!(t=this._masterSlide)){e.next=10;break}return e.next=10,t.render();case 10:if(!(t=this._layoutSlide)){e.next=14;break}return e.next=14,t.render();case 14:if(!(t=this._curSlide)){e.next=18;break}return e.next=18,t.render();case 18:this.renderSlideLable&&(R.timeEnd(this.renderSlideLable),this.renderSlideLable=null),this._isRenderFinish=!0,this.onRenderNotify(!0);case 21:case"end":return e.stop()}}),e,this)})),i.onRenderFinish=function(){var e=i.viewMode!==C.ViewModes.PlayView||i.isUpdateFinish();return i._isRenderFinish&&i._finishedCallbacks&&e&&(i._finishedCallbacks.forEach((function(e){e(!0)})),i._finishedCallbacks=null),i.renderSlideLable&&(R.timeEnd(i.renderSlideLable),i.renderSlideLable=null),!0},i.observeWatermark=function(e){var t=(e=e||i.ctx&&i.ctx.getSvg())&&e.querySelector("#g_wmk");t&&t.parentElement?e.watermarkObserver&&e.watermarkObserver.observe(t.parentElement,{subtree:!0,childList:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}):console.warn("no watermark group")},i.disconnectWatermarkObserver=function(e){e&&e.watermarkObserver&&e.watermarkObserver.disconnect()},i.reRenderWatermark=function(e,t){var n=e.getSvg();i.disconnectWatermarkObserver(n);var r=n.querySelector("#g_wmk");r&&r.remove(),i.waterTypoData&&od.render(e,i.waterTypoData,t),i.observeWatermark(n)},i.updateWaterMark=function(){if(i.ctx&&i.envLayout){var e=i.ctx.getSvg();i.disconnectWatermarkObserver(e);var t=e.querySelector("#g_wmk");t&&t.remove(),i.waterTypoData=ad.measure(i.envLayout),i.waterTypoData&&od.render(i.ctx,i.waterTypoData,i.envLayout);var n=i.domSvgRef.filter((function(e){return"play_root"===e.className}));(n[0]&&n[0].firstElementChild&&Number(n[0].firstElementChild.id))===i.getId()&&nd.getInstance().updateWaterMark(e),e.watermarkObserver?i.observeWatermark(e):i.createWatermarkObserver(i.ctx,i.envLayout)}},i.waitFinished=function(e){i._finishedCallbacks=i._finishedCallbacks||[],i._finishedCallbacks.push(e),i.onRenderFinish()};var n=e.slidesLoader,a=e.proxy,o=e.root,s=e.viewMode,h=e.editMode,u=e.style;i.props=e,i.gid=Object(k.a)(),i.root=o,i.proxy=a,i.slidesLoader=n;var c=C.EditMode.slide;return n&&"slideLayouts"===n.category?c=C.EditMode.layout:n&&"slideMasters"===n.category&&(c=C.EditMode.master),i.editMode=h||c,i.viewMode=s,i.style=u,i.hasInit=!1,i.needComDefs=!0,i.isFirstRender=!0,i.domSvgRef=[],i}return u()(t,e),o()(t,[{key:"genSlideCtx",value:function(e){return function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=t.slideTarSize,a=i.getCanvasStyle(),o=i.getSlideStyle(),s=t.canvas;for(var l in e.save(),e.globalAlpha=0,e.fillStyle=a.fillStyle,e.fillRect(0,0,s.width,s.height),e.globalAlpha=1,o)e[l]=o[l];e.fillRect(r.x,r.y,r.width,r.height),o.linewidth&&e.strokeRect(r.x-1,r.y-1,r.width+2,r.height+2),e.restore(),n&&e.transform(1,0,0,1,r.x,r.y)}(this.ctx,e,this.style),this.ctx}},{key:"getShape",value:function(e){for(var t=[this._curSlide,this._layoutSlide,this._masterSlide],i=0,n=t.length;i<n;i++){var r=t[i];if(r){var a=r.getShape(e);if(a)return a}}return null}},{key:"getSvgLayout",value:function(e){var t=e.viewBox,i=window.ti2pxRatio;return this.viewMode===C.ViewModes.NotesBody&&(i=e.scale),{svgLayout:new td(t),scale:i,ratio:e.scale/i,viewMode:this.viewMode,editMode:this.editMode}}},{key:"_init",value:function(e){this.slideData=e;var i=this.editMode,n=this.viewMode;if(this.hasInit=!0,this._curSlide||this._layoutSlide||this._masterSlide)return!0;var r=ed.getInstance(),a=this.getSvgLayout(_()({},this.envLayout));if(C.EditMode.slide===i){this._curSlide=r.getSvg({slideData:e,layout:a,topLayer:!0,root:this,viewMode:n});var o=e.getFollowing(),s=e.showMasterShape();if(o&&o.isLayoutSlide&&s){this._layoutSlide=r.getSvg({slideData:o,layout:a,topLayer:!1,root:this});var l=o.getFollowing(),h=o.showMasterShape();l&&h&&(this._masterSlide=r.getSvg({slideData:l,layout:a,topLayer:!1,root:this}))}}else if(C.EditMode.layout===i){this._layoutSlide=r.getSvg({slideData:e,topLayer:!0,layout:a,root:this,viewMode:n});var u=e.getFollowing(),c=e.showMasterShape();u&&c&&(this._masterSlide=r.getSvg({slideData:u,topLayer:!1,layout:a,root:this,viewMode:n}))}else this._masterSlide=r.getSvg({slideData:e,topLayer:!0,layout:a,root:this});this._curSlide,this._curSlide&&this._curSlide.on(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),this._masterSlide&&this._masterSlide.on(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),this._layoutSlide&&this._layoutSlide.on(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),this.dataToken=this.slideData.data_token,this.treeToken=this.slideData.tree_token,r.on("update",this.onShapeUpdate)}},{key:"cloneSvg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.domSvgRef.filter((function(e){return!e.parentNode&&e.isClone})),n=void 0;if(i.length>0&&(n=i[0]),!n){var r=this.ctx.getSvg();if(n=r.cloneNode(!0),t){window.domTools.addCommonDefs(n);var a=n.querySelector("defs");a&&a.remove()}n.curSlideId=r.curSlideId,n.isClone=!0,this.domSvgRef.push(n)}var o=+n.getAttribute("width"),s=e/o;return n.setAttribute("style","transform-origin:top left;transform:scale("+s+")"),n}},{key:"copySvgElement",value:function(e,t,i,n){var r=this;if(t&&e&&"slide_layer"!==t.className){var a=!1,o=[],s=function(s){var l=i[s],h=l.id,u=l.e;if(void 0===h)return"continue";var c="g#s_"+h,d=u&&u.treeIdx,p=t.querySelector("g#s_"+n),f=void 0;if(!p)return a=!0,"break";if(f=h===n?p:p.querySelector(c)){var g=e.lastElementChild.querySelector(c);if(!g||-1===d||g.parentNode.id&&f.parentNode.id&&g.parentNode.id!==f.parentNode.id)return f.remove(),"continue";var y=!1;if(u&&u.updatePartName&&u.updatePartName.length>0)for(var v=0,m=u.updatePartName.length;v<m;v++){var _=u.updatePartName[v];if(_){var w=g.querySelector("g#"+_),S=f.querySelector("g#"+_);if(!w||!S){o.push({sg:g,tg:f});break}S.setAttribute("transform","translate(0, 0)"),o.push({sg:w,tg:S,isPartialUpdate:!0}),y=!0}}if(u&&u.updateAttrName&&u.updateAttrName.length>0)for(var x=0,T=u.updateAttrName.length;x<T;x++){var k=u.updateAttrName[x];if(k){var C=g.querySelector("g#"+k),b=f.querySelector("g#"+k);if(!C||!b){o.push({sg:g,tg:f});break}o.push({sg:g,tg:f,isPartialUpdate:!0,updateAttr:!0}),y=!0}}if(y)return"continue";var E=!1;if(h<0){var R=g.querySelector("#ink_"+h),P=f.querySelector("#ink_"+h);if(R&&P)for(var I=R.childNodes,L=P.childNodes,A=I.length-1;A>=0;A--)if(L[A]){if(I[A].id===L[A].id)break;o.push({sg:I[A],tg:L[A]}),L[A].id=I[A].id,E=!0}else P.appendChild(I[A].cloneNode(!0)),E=!0}if(E)return"continue";var B=u.data;if(B&&B.isShape&&B.isGroupShape()&&!B.isShapeTree)if("1"===g.getAttribute("g")){var D=B.getId()===h?B:B.getChildById(h);r.addNeedCopyNodeGroup(o,D,h,g,f)}else g&&f&&g.firstElementChild&&!g.firstElementChild.isEqualNode(f.firstElementChild)&&o.push({id:h,sg:g,tg:f});o.find((function(e){return e.id===h}))||o.push({id:h,sg:g,tg:f})}else{var M=t.querySelector("g#s_"+n);if(h===n||!M)return a=!0,"break";var O=e.lastElementChild.querySelector(c);if(!O)return"continue";if(!Object.isEmpty(d)){if(M){var N=M.childNodes[d];N?M.insertBefore(O.cloneNode(!0),N):M.appendChild(O.cloneNode(!0))}return"continue"}var F=O.parentNode&&t.querySelector("g#"+O.parentNode.id);if(F){var V=O.previousElementSibling,U=V&&F.querySelector("#"+V.id);return U&&U.nextElementSibling?U.parentNode.insertBefore(O.cloneNode(!0),U.nextElementSibling):F.appendChild(O.cloneNode(!0)),"continue"}}};e:for(var l=0;l<i.length;l++){switch(s(l)){case"continue":continue;case"break":break e}}a?window.domTools.cloneChildNodes(e.lastElementChild,t):o.forEach((function(e){var t=e.sg,i=e.tg,n=e.isPartialUpdate;e.updateAttr&&window.domTools.updateChildNodes(t,i)||window.domTools.cloneChildNodes(t,i),!n&&i.setAttribute("transform","translate(0, 0)")}))}}},{key:"addNeedCopyNodeGroup",value:function(e,t,i,n,r){var a=this;n&&r&&t&&(e.find((function(e){return e.id===i}))||(this.isSameChildOrder(n,r)?t.getChilds().forEach((function(t){var i=t.getId();if(!e.find((function(e){return e.id===i}))){var o="g#s_"+i,s=n.querySelector(o),l=r.querySelector(o);if(s&&l)if(t.isGroupShape()){if(!a.isSameChildOrder(s,l))return void e.push({id:i,sg:s,tg:l});a.addNeedCopyNodeGroup(e,t,i,s,l)}else s&&l&&s.firstElementChild&&!s.firstElementChild.isEqualNode(l.firstElementChild)&&e.push({id:i,sg:s,tg:l})}})):e.push({id:i,sg:n,tg:r})))}},{key:"isSameChildOrder",value:function(e,t){if(!e||!t)return!1;if(e.childElementCount!==t.childElementCount)return!1;for(var i=0;i<e.childElementCount;i++)if(e.childNodes[i].id!==t.childNodes[i].id)return!1;return!0}},{key:"isSameLayerInShapeTree",value:function(e,t,i){for(;e&&t;){if(e.id!==t.id)return!1;if(e.id===i)return!0;e=e.parentNode,t=t.parentNode}return!0}},{key:"getSvgFromSpTreeChildNodes",value:function(e,t){if(e){var i="s_"+t;if(e.id===i)return e;for(var n=0;n<e.childNodes.length;n++)if(e.childNodes[n].id===i)return e.childNodes[n]}}},{key:"getIndexFormParentNode",value:function(e,t){if(!e||!t||!e.childNodes)return-1;for(var i=e.childNodes,n=0;n<i.length;n++)if(i[n]===t)return n;return-1}},{key:"updatePlayViewElement",value:function(e,t,i){if(e&&t&&"slide_layer"===t.className&&(!t||!t.parentElement||Number(t.parentElement.id)===Number(this.getId())))for(var n=0;n<i.length;n++)nd.getInstance().update(e,t,i[n])}},{key:"getId",value:function(){return this.slideData?this.slideData.getId():-1}},{key:"getDataToken",value:function(){return this.slideData?this.slideData.getDataToken():-1}},{key:"getTreeToken",value:function(){return this.slideData?this.slideData.getTreeToken():-1}},{key:"getProxyGid",value:function(){return this.proxy&&this.proxy.getGid()}},{key:"layout",value:function(){return this.envLayout.svgLayout}},{key:"onRenderNotify",value:function(e){this.isDestroy||e&&this._fireSlideRenderFinishedEvent()}},{key:"render",value:function(e,t){var i=this;e.gid=this.gid,this.ctx=e,this.envLayout=t||this.envLayout,this.envLayout||console.error("render parmas layout undefined"),this.slidesLoader.getSlideByIdxProxy(this.proxy)?this.handlerProxyDataLoaded(e):(this._proxyTimer&&clearTimeout(this._proxyTimer),this._proxyTimer=setTimeout((function(){"p"===window.officeType&&window.collection("newui","value",window.pcTrack.newui.slide_preloading_fail)}),12e4),this.proxy.once(this.proxy.constructor.EventTypes.DATA_LOADED,(function(){return i.handlerProxyDataLoaded(e)})),this.isLazyload=!0)}},{key:"_drawLayer",value:function(e,t,i,n,r){e.save(t),i&&i.ctx&&(this._isDrawComplete=this._isDrawComplete&&i.isAllRenderFinish(),e.drawImage(i.ctx.canvas,0,0,n.width,n.height,r),i.slideData&&i.slideData.fieldShapes&&this.updateFieldTextShapes(e.getCurrentElement(),i.slideData.fieldShapes),r&&window.domTools.addCommonDefs(i.ctx.getSvg())),e.restore()}},{key:"_draw",value:function(e){var i=this.envLayout,n=e.getSvg();if(e.gid===this.gid){n.curSlideId=this.getId(),e.clearRect(0,0,e.width,e.height),e.save(this.viewMode);var r=this._curSlide,a=this._layoutSlide,o=this._masterSlide,s=i.svgLayout,l=this.useComDefs;this._isDrawComplete=!0,C.EditMode.slide===this.editMode?(e.save(t.SLIDE_LAYERS.SLIDE_BG),r.backgroundCtx&&e.drawImage(r.backgroundCtx.canvas,0,0,s.width,s.height,l),e.restore(),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE_MASTER,o,s,l),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE_LAYOUT,a,s,l),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE,r,s,l)):C.EditMode.layout===this.editMode?(e.save(t.SLIDE_LAYERS.SLIDE_BG),a.backgroundCtx&&e.drawImage(a.backgroundCtx.canvas,0,0,s.width,s.height,l),e.restore(),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE_MASTER,o,s,l),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE_LAYOUT,a,s,l)):o&&(e.save(t.SLIDE_LAYERS.SLIDE_BG),o.backgroundCtx&&e.drawImage(o.backgroundCtx.canvas,0,0,s.width,s.height,l),e.restore(),this._drawLayer(e,t.SLIDE_LAYERS.SLIDE_MASTER,o,s,l)),e.restore();var h=this._isDrawComplete;this._isRenderFinish=h,this._isSvgUpdateFinish=h,h&&this.onRenderFinish(),this.onRenderNotify(h),this.domSvgRef.includes(n)||this.domSvgRef.push(n),C.EditMode.slide!==this.editMode&&this.viewMode!==C.ViewModes.MasterView&&this.viewMode!==C.ViewModes.MasterThumbnailView||(this.renderWaterMark(e,i),window.addEventListener(t.EVENT_TYPES.SLIDE_UPDATE_WATERMARK,this.updateWaterMark))}else this.domSvgRef.remove(n)}},{key:"updateFieldTextShapes",value:function(e,t){var i=this;e&&t&&this.slideData&&this.slideData.parent&&!this.slideData.isLayoutSlide&&!this.slideData.isMasterSlide&&t.forEach((function(t){var n=t.id,r=t.targetStyle,a=e.querySelector("#s_"+n+"_text"),o=a&&a.querySelector("#fieldText");if(o){var s=r.language,l=r.fieldType,h=o.innerText,u=window.APP.presentation.getPageSetup(),c=u&&u.getProps("firstSlideNum")||1,d=i.slideData.parent.getSlideIdxById(i.getId())+c,p=void 0;if(G===l){var f=String(le(s,l,d)),g=o.getAttribute("x");g&&(g=g.split(" ").map((function(e){return Number(e)})),p=1===f.length?String(g[1]):2===f.length?(g[0]+g[1])/2+" "+(g[1]+g[2])/2:g[0]+" "+(g[0]+g[2])/2+" "+g[2],h=(h+"").replace("<#>",f))}h!==o.innerText&&(o.innerHTML=""+h,p&&p.indexOf("NaN")<0&&o.setAttribute("x",p))}}))}},{key:"_update",value:function(){if(this.slideData&&(this.slideData.data_token!==this.dataToken||this.slideData.tree_token!==this.treeToken)){var e=this.slideData;this.hasInit=!0;var i=e.getFollowing(),n=e.showMasterShape();if(!i)return;if(i.isLayoutSlide&&n){if(!this._layoutSlide||this._layoutSlide.slideData.getId()!==i.getId()){var r=ed.getInstance(),a=this.getSvgLayout(_()({},this.envLayout));this._layoutSlide=r.getSvg({slideData:i,layout:a,topLayer:!1,root:this});var o=i.getFollowing(),s=i.showMasterShape();o&&s&&(this._masterSlide=r.getSvg({slideData:o,layout:a,topLayer:!1,root:this})),this._layoutSlide&&this._addSlide(t.SLIDE_LAYERS.SLIDE_LAYOUT,this._layoutSlide.ctx.getSvg()),this._masterSlide&&this._addSlide(t.SLIDE_LAYERS.SLIDE_MASTER,this._masterSlide.ctx.getSvg()),this.dataToken=this.slideData.data_token,this.treeToken=this.slideData.tree_token}}else!i.isMasterSlide&&this._layoutSlide&&(this._clearLayout(),this._clearMaster(),this.dataToken=this.slideData.data_token,this.treeToken=this.slideData.tree_token)}}},{key:"_clearMaster",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this._clearSlide(t.SLIDE_LAYERS.SLIDE_MASTER_BG),this._masterSlide=null),this._clearSlide(t.SLIDE_LAYERS.SLIDE_MASTER)}},{key:"_clearLayout",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this._clearSlide(t.SLIDE_LAYERS.SLIDE_LAYOUT_BG),this._masterSlide=null),this._clearSlide(t.SLIDE_LAYERS.SLIDE_LAYOUT)}},{key:"_clearSlide",value:function(e){this.domSvgRef.forEach((function(t){var i=t.querySelector("#"+e);i&&(i.innerHTML="")}))}},{key:"_addSlide",value:function(e,t){this.domSvgRef.forEach((function(i){var n=i.querySelector("#"+e);n&&t&&t.lastElementChild&&(n.innerHTML="",n.appendChild(t.lastElementChild.cloneNode(!0)))}))}},{key:"drawSnapshot",value:function(e,i){var n=i.svgLayout,r=this._curSlide,a=this._layoutSlide,o=this._masterSlide;e.save("snapshot");var s=!1!==i.useComDefs;o&&o.ctx&&(e.save(t.SLIDE_LAYERS.SLIDE_MASTER),o.hasBackgroundShape()&&o.backgroundCtx&&e.drawImage(o.backgroundCtx.canvas,0,0,n.width,n.height,s),e.drawImage(o.ctx.canvas,0,0,n.width,n.height,s),e.restore()),a&&a.ctx&&(e.save(t.SLIDE_LAYERS.SLIDE_LAYOUT),a.hasBackgroundShape()&&a.backgroundCtx&&e.drawImage(a.backgroundCtx.canvas,0,0,n.width,n.height,s),e.drawImage(a.ctx.canvas,0,0,n.width,n.height,s),e.restore()),r&&r.ctx&&(e.save(t.SLIDE_LAYERS.SLIDE),r.hasBackgroundShape()&&r.backgroundCtx&&e.drawImage(r.backgroundCtx.canvas,0,0,n.width,n.height,s),e.drawImage(r.ctx.canvas,0,0,n.width,n.height,s),e.restore()),e.restore()}},{key:"stopRender",value:function(e){if(this.domSvgRef){if(e&&e.ctx){var t=e.ctx.getSvg(),i=this.domSvgRef.indexOf(t);-1!==i&&this.domSvgRef.splice(i,1),this.disconnectWatermarkObserver(t)}this.viewMode===C.ViewModes.PlayView&&(this.domSvgRef=this.domSvgRef.filter((function(e){return e&&"play_root"!==e.className})))}}},{key:"hitTest",value:function(e,t,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.editMode,s=this.viewMode;if([C.ViewModes.EditView,C.ViewModes.PlayView,C.ViewModes.Review,C.ViewModes.MasterView].includes(s)&&this.envLayout){var l=void 0;if(n)o===C.EditMode.master&&(l=this._masterSlide&&this._masterSlide.hitTest(e,t,i,null,a)),o===C.EditMode.layout&&(l=this._layoutSlide&&this._layoutSlide.hitTest(e,t,i,null,a)),o===C.EditMode.slide&&(l=this._curSlide&&this._curSlide.hitTest(e,t,i,null,a));else for(var h=[this._curSlide,this._layoutSlide,this._masterSlide],u=0;u<h.length;u++){var c=h[u],d=r&&r[u];if((l=c&&c.hitTest(e,t,i,d,a))&&l.isHit)return c.isTopLayer?l:{otherLayerHitRestRet:l,slide:l.slide}}return l}}},{key:"getSlideIndex",value:function(){return this.proxy.idx}},{key:"setENV",value:function(e){var t=e.layout;this.envLayout=t;var i=this.getSvgLayout(_()({},t));this._masterSlide&&this._masterSlide.setENV({layout:i}),this._layoutSlide&&this._layoutSlide.setENV({layout:i}),this._curSlide&&this._curSlide.setENV({layout:i})}},{key:"destroy",value:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.stopRender();var n=ed.getInstance(),r=this.editMode;if(n.off("update",this.onShapeUpdate),this._curSlide&&this._curSlide.off(t.EVENT_TYPES.SLIDE_RESIZE,this._onSlideResize),this._curSlide&&this._curSlide.off(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),this._masterSlide&&this._masterSlide.off(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),this._layoutSlide&&this._layoutSlide.off(t.EVENT_TYPES.SLIDE_CHANGE,this._onSlideChange),window.removeEventListener(t.EVENT_TYPES.SLIDE_UPDATE_WATERMARK,this.updateWaterMark),i)if(C.EditMode.layout===r)n.removeSvg(this._layoutSlide);else if(C.EditMode.master===r)n.removeSvg(this._masterSlide);else if(n.removeSvg(this._curSlide),this._curSlide&&this._curSlide.getId()<0)this._curSlide.destroy();else if(this._curSlide){var a=this._curSlide;setTimeout((function(){a&&a.destroy()}),500)}var o=void 0;this.ctx&&(this.ctx.isActive?o=this.ctx.getSvg():this.ctx.destroy()),this.domSvgRef.forEach((function(t){o!==t&&(t.remove(),e.disconnectWatermarkObserver(t),t.watermarkObserver=null)}))}catch(e){console.error(e)}this.isDestroy=!0}},{key:"hitSelectObjectsByRect",value:function(e){var t=this.editMode;if((this.props.viewMode===C.ViewModes.EditView||this.props.viewMode===C.ViewModes.MasterView)&&this.envLayout){var i=void 0;return t===C.EditMode.master&&(i=this._masterSlide&&this._masterSlide.hitSelectObjectsByRect(e)),t===C.EditMode.layout&&(i=this._layoutSlide&&this._layoutSlide.hitSelectObjectsByRect(e)),t===C.EditMode.slide&&(i=this._curSlide&&this._curSlide.hitSelectObjectsByRect(e)),i}}},{key:"measure",value:function(){var e=this.editMode;return e===C.EditMode.master?this._masterSlide&&this._masterSlide.measure():e===C.EditMode.layout?this._layoutSlide&&this._layoutSlide.measure():e===C.EditMode.slide?this._curSlide&&this._curSlide.measure():void 0}},{key:"addShape",value:function(){var e;(e=this._curSlide.shapeTree).addShape.apply(e,arguments)}},{key:"deleteShape",value:function(){var e;(e=this._curSlide.shapeTree).deleteShape.apply(e,arguments)}},{key:"getCurSlide",value:function(){return this._curSlide||this._layoutSlide||this._masterSlide}},{key:"_updateSlideBackground",value:function(e,i,n){if(n){var r=n.getSpTree()&&n.getSpTree().getId(),a=n.visual.getBackgroundShape();if(i.some((function(e){var t=e.id;return a&&a.getId()===t||r===t}))||!this.hasUpdateSlideBg){var o=this._curSlide||this._layoutSlide||this._masterSlide,s=e.querySelector("#"+t.SLIDE_LAYERS.SLIDE_BG);if(s){if("slide_layer"===s.className)if(s.querySelector("g"))s=s.querySelector("g");else{var l=o.backgroundCtx&&o.backgroundCtx.getSvg();if(l){var h=nd.getInstance(),u=l.querySelector("#s_bg")||l.lastElementChild;if(!(u&&h&&a&&s.firstElementChild))return;var c=h.getLayout();if(!c)return;window.domTools.addCommonDefs(l);var d=h._getDivElement();h.clearDom(d);var p=h._getSVGElement();h.clearDom(p),d.id=nd.SplitNodeName+a.getId();var f=u.cloneNode(!0);return void h._splitBackgroundShape(this,c,s.firstElementChild,d,f,p)}}if(o.backgroundCtx){var g=o.backgroundCtx.getSvg();window.domTools.addCommonDefs(g);var y=g.querySelector("#s_bg")||g.lastElementChild;window.domTools.cloneChildNodes(y,s)}else s.firstElementChild.remove();this.hasUpdateSlideBg=!0}else console.warn("cannot find slidebg")}}}},{key:"renderWaterMark",value:function(e,t){this.waterTypoData=this.waterTypoData||ad.measure(t),this.waterTypoData&&(od.render(e,this.waterTypoData,t),this.createWatermarkObserver(e,t))}},{key:"createWatermarkObserver",value:function(e,t){var i=this,n=function(e){return"g_wmk"===e||"wmk_text_wrapper"===e},r=function(e){return e&&e.indexOf("wmk_text")>-1},a=function(e){return!!e&&(n(e.id)||r(e.getAttribute("class")))},o=e.getSvg(),s=new MutationObserver((function(s,l){for(var h=!1,u=function(e){var t=s[e],l=t.target;if("childList"===t.type&&Array.prototype.find.call(t.removedNodes,(function(e){return"#text"===e.nodeName?a(l):a(e)})))return h=!0,"break";if("attributes"===t.type)if(a(l)){if("style"===t.attributeName)return h=!0,"break";i.disconnectWatermarkObserver(o),t.oldValue&&l.setAttribute(t.attributeName,t.oldValue),i.observeWatermark(o)}else("id"===t.attributeName&&n(t.oldValue)||"class"===t.attributeName&&r(t.oldValue))&&(i.disconnectWatermarkObserver(o),t.oldValue&&l.setAttribute(t.attributeName,t.oldValue),i.observeWatermark(o));else"characterData"===t.type&&"#text"===l.nodeName&&a(l.parentElement)&&(i.disconnectWatermarkObserver(o),l.nodeValue=t.oldValue,i.observeWatermark(o))},c=0;c<s.length;++c){if("break"===u(c))break}h&&i.reRenderWatermark(e,t)}));o.watermarkObserver=s,this.observeWatermark(o)}},{key:"isRenderFinish",value:function(){return!!this._isRenderFinish}},{key:"isAllRenderFinish",value:function(){if(!this.isRenderFinish())return!1;var e=this._masterSlide&&this._masterSlide.isAllRenderFinish();return this._masterSlide&&!e?e:(e=this._layoutSlide&&this._layoutSlide.isAllRenderFinish(),this._layoutSlide&&!e?e:(e=this._curSlide&&this._curSlide.isAllRenderFinish(),!(this._curSlide&&!e)||e))}},{key:"resize",value:function(e){this.envLayout=e}},{key:"findShapeViews",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return this._curSlide&&i.push.apply(i,S()(this._findShapeViews(this._curSlide,e))),this._layoutSlide&&t&&i.push.apply(i,S()(this._findShapeViews(this._layoutSlide,e))),this._masterSlide&&t&&i.push.apply(i,S()(this._findShapeViews(this._masterSlide,e))),i}},{key:"_findShapeViews",value:function(e,t){var i=[];if(e){var n=e.shapeTree,r=e.backGroundShape;if(r&&i.push.apply(i,S()([r].filter(t))),n){n.shapes.filter((function(e){i.push.apply(i,S()(function e(t,i){var n=[];return t.isGroupShape()?t.shapes.forEach((function(t){n.push.apply(n,S()(e(t,i)))})):i(t)&&n.push(t),n}(e,t)))}))}}return i}},{key:"getImageLoadErrorShapes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return this._curSlide&&t.push.apply(t,S()(this._curSlide.getImageLoadErrorShapes())),this._layoutSlide&&e&&t.push.apply(t,S()(this._layoutSlide.getImageLoadErrorShapes())),this._masterSlide&&e&&t.push.apply(t,S()(this._masterSlide.getImageLoadErrorShapes())),t}},{key:"getGIFLoadShapes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return this._curSlide&&t.push.apply(t,S()(this._curSlide.getGIFLoadShapes())),this._layoutSlide&&e&&t.push.apply(t,S()(this._layoutSlide.getGIFLoadShapes())),this._masterSlide&&e&&t.push.apply(t,S()(this._masterSlide.getGIFLoadShapes())),t}},{key:"getBrokenPicShapes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return this._curSlide&&t.push.apply(t,S()(this._curSlide.getBrokenPicShapes())),this._layoutSlide&&e&&t.push.apply(t,S()(this._layoutSlide.getBrokenPicShapes())),this._masterSlide&&e&&t.push.apply(t,S()(this._masterSlide.getBrokenPicShapes())),t}},{key:"isUpdateFinish",value:function(){return this._isSvgUpdateFinish}},{key:"getRealRect",value:function(){var e=this._curSlide||this._layoutSlide||this._masterSlide;return e&&e.shapeTree.getRect()}},{key:"useComDefs",get:function(){return!1!==this.envLayout.useComDefs}}]),t}(x.a);sd.EVENT_TYPES={SLIDE_CHANGE:"slide_change",SLIDE_RESIZE:"slide_resize",SLIDE_RENDERED:"slide_rendered",SLIDE_RENDER_FINISHED:"slide_render_finished",SLIDE_UPDATE_WATERMARK:"slide_update_watermark"},sd.SLIDE_LAYERS={SLIDE_MASTER:"m_s",SLIDE_LAYOUT:"l_s",SLIDE:"s_t",SLIDE_BG:"s_bg",SLIDE_MASTER_BG:"m_s_bg",SLIDE_LAYOUT_BG:"l_s_bg",SLIDE_SLIDE_BG:"s_t_bg"};var ld=sd,hd=i(4954),ud=i.n(hd),cd=i(208),dd=function(){function e(t){var i=this,n=t.$container,a=t.coreData,o=t.viewMode,s=t.coreView,l=t.editMode;r()(this,e),this.bindUpdateTbEvent=function(e){var t=e.optype;"slides"===e.category===(i.coreView.getMode()!==cd.ViewModes.MasterView)&&(t===Pu.default.op_add?i.addSlide(e):t===Pu.default.op_remove?i.deleteSlide(e):t===Pu.default.op_modify||(t===Pu.default.op_move?i.moveSlide(e):Pu.default.op_replace))},this.$container=n,this.coreData=a,this.coreView=s,this.editMode=l,this.scrollTop=0,this.scrollTopPercentage=0,this.scrollLeft=0,this.scrollSlideH=0,this.scrollSlideV=0,this.slideViews=[],this.slideMap={},this.style={},this.viewMode=o,this.init(),this.thumbnailTimeoutMap={},this.loadAnimePlayer,this.scrollCenter={cx:0,cy:0}}return o()(e,[{key:"init",value:function(){this.setStyle(),this.eventBind()}},{key:"getSlideViewClass",value:function(){return ld}},{key:"handlerSlideChange",value:function(){this.onSlideChange&&this.onSlideChange.apply(this,arguments)}},{key:"handlerSlideRendered",value:function(){this.onSlideRendered&&this.onSlideRendered.apply(this,arguments)}},{key:"setStyle",value:function(){console.error(new Error("method must be implemented!"))}},{key:"hitTest",value:function(){console.error(new Error("method must be implemented!"))}},{key:"reRender",value:function(){console.error(new Error("method must be implemented!"))}},{key:"getFirstVisibleSlideIndex",value:function(){console.error(new Error("method must be called by Preview instance!"))}},{key:"setZoom",value:function(e,t){this.style.setZoom(e),this.layoutResult=this.slideLayout({});var i=this.layoutResult,n=i.svgLayout,r=i.containerSize,a=i.bestZoom,o=(n.width*a-r.width)/2,s=(n.height*a-r.height)/2;return t&&(this.scrollLeft=o,this.scrollTop=s),this.scrollCenter={cx:o,cy:s},a}},{key:"setShadowBlur",value:function(e){this.style.shadowBlur=e}},{key:"scrollTopTo",value:function(e){this.scrollTop=e,this._updateScroll()}},{key:"scrollLeftTo",value:function(e){this.scrollLeft=e,this._updateScroll()}},{key:"_updateScroll",value:function(){this.resetSvgRect()}},{key:"resetSvgRect",value:function(e){if(this.ctx){var t=this.ctx.getSvg();"b"===window.officeType?(e=e||this.getZoom(),t.style.transform="scale("+e+")"):(t.setAttribute("width",this.ctx.width+"px"),t.setAttribute("height",this.ctx.height+"px")),this.$shadowWrapper&&window.domTools.setStyle(this.$shadowWrapper,{width:this.ctx.width,height:this.ctx.height}),this.updateSvgClientRect()}}},{key:"getZoom",value:function(){return this.layoutResult=this.layoutResult||this.slideLayout({}),this.layoutResult&&this.layoutResult.bestZoom}},{key:"getAutoZoom",value:function(){return this.layoutResult=this.layoutResult||this.slideLayout({}),this.layoutResult&&this.layoutResult.autoZoom}},{key:"clearContainer",value:function(){for(var e=this.$container.getElementsByTagName("svg");e[0];)e[0].remove()}},{key:"getSlideById",value:function(e){return this.slideMap[e]}},{key:"getSlideCount",value:function(){return this.slidesLoader.getSlideCount()}},{key:"getSlideViewByIdx",value:function(e){var t=this;if(!Object.isEmpty(e)){var i=e.isSlideIdxProxy?e:this.slidesLoader.getSlideIdxProxy(e);if(i){var n=this.slideMap[i.getGid()];if(!n){var r=this.slidesLoader;"slideLayouts"===i.category?r=this.coreData.getLayouts():"slideMasters"===i.category&&(r=this.coreData.getMasters());var a=this.getSlideViewClass();this.slideMap[i.getGid()]=n=new a({slidesLoader:r,proxy:i,root:this,viewMode:this.viewMode,editMode:this.editMode,style:this.style}),n.on(a.EVENT_TYPES.SLIDE_RENDER_FINISHED,(function(e){t.handlerSlideRendered&&t.handlerSlideRendered(e)}))}return n}}}},{key:"getSlideViewById",value:function(e){var t=this.slidesLoader.getSlideIdxById(e);return this.getSlideViewByIdx(t)}},{key:"getSlideView",value:function(e,t){var i=this.slidesLoader.getSlideIdxById(e);return this.getSlideViewByIdx(i)}},{key:"getSlideIdxProxy",value:function(e){return this.slidesLoader.getSlideIdxProxy(e)}},{key:"addSlide",value:function(e){}},{key:"deleteSlide",value:function(e){var t=e.slideProxy;if(t){var i=t.getGid(),n=this.slideMap[i];n&&(delete this.slideMap[i],this.viewMode===cd.ViewModes.ThmubnailView||this.viewMode===cd.ViewModes.MasterThumbnailView?setTimeout((function(){n&&n.destroy(!0)}),1e3):n&&n.destroy(!0))}0===Object.keys(this.slideMap).length&&(this.activeSlide=null,this.handlerSlideChange&&this.handlerSlideChange({}))}},{key:"moveSlide",value:function(e){}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.containerSize,i=this.layoutResult=this.slideLayout({containerSize:t});this.activeSlide&&this.activeSlide.ctx&&(this.ctx=this.activeSlide.ctx,"b"!==window.officeType&&(this.ctx.width!==i.svgLayout.width&&(this.ctx.width=i.svgLayout.width),this.ctx.height!==i.svgLayout.height&&(this.ctx.height=i.svgLayout.height)),this.activeSlide.resize(i))}},{key:"slideLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.widthFirst,i=void 0!==t&&t,n=e.containerSize,r=this.style,a=r.getZoom(),o=r.getSlideStyle(),s=this.slidePxSize,l=s.width,h=s.height,u=l/h,c=(n=n||this.getContainerSize()).width,d=n.height;i&&(d=c/u);var p=o.lineWidth+o.shadowBlur,f=void 0,g=0;if(!g){var y=cd.userAgent.isMobile?2:4,v=c-y*p,m=d-2*p;u>v/m?m=v/u:v=m*u,f=v/l,(f=parseFloat(f.toFixed(4)))<.1&&(f=.1),g=f,0!==a?f=a:cd.userAgent.isAndroidPad&&r.setZoom(f)}var _=l*f,w=h*f,S={x:0,y:0,width:_,height:w},x={width:_,height:w,x:p,y:p};return{viewBox:this.slidePxSize,svgLayout:new td(S),slideFitLayout:x,containerSize:n,scale:window.ti2pxRatio,bestZoom:f,autoZoom:g}}},{key:"destroy",value:function(){var e=this;Object.keys(this.slideMap).forEach((function(t){e.slideMap[t].destroy()})),this.coreData.off("update_thumbnail",this.bindUpdateTbEvent),this.onSlideChange=null,this.onSlideRendered=null,console.log(this.constructor.name,"destroy --------------"),this.slideMap={}}},{key:"eventBind",value:function(){this.coreData.off("update_thumbnail",this.bindUpdateTbEvent),this.coreData.on("update_thumbnail",this.bindUpdateTbEvent)}},{key:"setSvgRootView",value:function(e){this.svgRootView=e}},{key:"getShapeSvgLayout",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.getSlideView(e);if(a){if(i){var o=a._curSlide.getShape(t),s=o.layout();return s}if(n){var l=a._layoutSlide.getShape(t),h=l.layout();return h}if(r){var u=a._masterSlide.getShape(t),c=u.layout();return c}}}},{key:"getShapeSvg",value:function(e,t,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=["#s_t","#l_s","#m_s"],l=void 0;r&&(l=e.querySelector(s[0])),a&&(l=e.querySelector(s[1])),o&&(l=e.querySelector(s[2]));var h="#play_view_s_"+t;i>-1&&n>-1&&(h+="_"+i+"_"+n);var u=l&&l.querySelector(h),c=u&&u.querySelector("#s_"+t);return c&&1===c.childElementCount&&c.querySelector("#s_"+t+"_load")?null:u}},{key:"getSlideSvg",value:function(e,t,i){var n=this,r=t||this.slideLayout({}),a=this.getSlideView(e,r);return this._genSvgSlideId=e,new Promise((function(e){var t=!1,o=function(a){var o=a.finished,s=a.slideView;if(!t&&o&&s.getId()===n._genSvgSlideId&&s.isUpdateFinish()){var l=nd.getInstance();l.setLayout(r);var h=l.split(s,i);s.domSvgRef.includes(h)||s.domSvgRef.push(h),n.coreView._startPlayTime&&(window.collection("experience",{event:"reading_play",times:Date.now()-n.coreView._startPlayTime}),n.coreView._startPlayTime=null),e(h),t=!0}};if(a.isAllRenderFinish())a._isSvgUpdateFinish=!0,o({finished:!0,slideView:a});else{var s=n.slideRenderMgr;s.setActiveSlide({activeSlide:a,callback:o,envLayout:r,lable:$c.ViewLable.PLAYER}),s.run()}}))}},{key:"getContainerSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$container;return window.domTools.getElementInnerSize(e)}},{key:"updateSvgClientRect",value:function(){console.warn("updateSvgClientRect not override")}},{key:"getSvgClientRect",value:function(){}},{key:"slidesLoader",get:function(){return this.coreData.getSlides()}},{key:"slideTiSize",get:function(){return this.coreData.getSlideSize()}},{key:"slidePxSize",get:function(){var e=this.slideTiSize;return{x:0,y:0,width:window.Ti2Px(e.width),height:window.Ti2Px(e.height)}}},{key:"loadAnimePlayer",get:function(){var e=this;return this._asyncPlayer=this._asyncPlayer||new Promise((function(t,i){try{window.AnimePlayer?t(window.AnimePlayer):ud()((function(e){t(e.default)}))}catch(t){e._asyncPlayer=null,i(t)}})),this._asyncPlayer}},{key:"slideRenderMgr",get:function(){return $c.getInstance()}}]),e}();dd.EVENT_TYPES={DOC_INIT:"doc_init",DOC_CHANGE:"doc_change",DOC_EDIT:"doc_edit",ERROR_READONLY:"error_readonly",ZOOM_CHANGE:"zoom_change",MODE_CHANGE:"mode_change",THUMBNAIL_DOC_CHANGE:"thumbnail_doc_change",THUMBNAIL_UPDATE:"thumbnail_update"};var pd=dd,fd=function(){function e(t){var i=t.zoom,n=void 0===i?0:i,a=t.canvasStyle,o=t.slideStyle;r()(this,e),this.zoom=n,this.canvasStyle=a,this.slideStyle=o}return o()(e,[{key:"setZoom",value:function(e){this.zoom=e}},{key:"getZoom",value:function(){return this.zoom}},{key:"getCanvasStyle",value:function(){return this.canvasStyle}},{key:"getSlideStyle",value:function(){return this.slideStyle}},{key:"shadowBlur",set:function(e){this.slideStyle.shadowBlur=e}}]),e}(),gd=new fd({slideStyle:{fillStyle:"rgba(255,255,255,1)",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:20,lineWidth:0,strokeStyle:"rgba(204,204,204,1)",defaultFill:"rgba(255,255,255,1)"},canvasStyle:{fillStyle:"rgba(230,230,230,1)"}}),yd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.onSvgUpdate=function(){},i.updateSvgClientRect=function(){if(i.ctx){var e=i.ctx.getSvg();i._svgClientRect=e.getBoundingClientRect(),console.log("updateSvgClientRect")}else console.warn("ctx not define")},i}return u()(t,e),o()(t,[{key:"stopRender",value:function(){this.stopSlideRender(this.activeSlide)}},{key:"stopSlideRender",value:function(e){e&&e.stopRender({ctx:this.ctx})}},{key:"reRender",value:function(e){if(this.activeSlide){this.stopRender(),this.ctx.clearRect(0,0,this.ctx.width,this.ctx.height);var t=this.layoutResult=this.slideLayout({});"b"!==window.officeType&&(this.ctx.width!==t.svgLayout.width&&(this.ctx.width=t.svgLayout.width),this.ctx.height!==t.svgLayout.height&&(this.ctx.height=t.svgLayout.height)),this.activeSlide.render(this.ctx,t,e)}}},{key:"setActiveSlide",value:function(e){this.activeSlideIdx=e;var t=this.getSlideViewByIdx(e);if(t){t!==this.activeSlide&&(this.stopRender(),this.activeSlide=t,this.viewMode===C.ViewModes.PlayView&&this.style.setZoom(0),this.reRender());var i=this.layoutResult,n=this.slideRenderMgr;n.setActiveSlide({activeSlide:t,idx:e,envLayout:i}),n.run()}}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this);try{this.ctx&&this.ctx.destroy(),delete this.ctx,this.$shadowWrapper&&this.$shadowWrapper.remove()}catch(e){console.log("svg is not child of $container")}this._svgRootViewObserver&&this._svgRootViewObserver.disconnect()}},{key:"clearContainer",value:function(){try{this.canvas&&this.canvas.remove(),this.ctx&&this.ctx.getSvg().remove(),this.$shadowWrapper&&this.$shadowWrapper.remove()}catch(e){console.log("this.canvas is not child of $container")}}},{key:"hitSelectObjectsByRect",value:function(e){if(this.activeSlide){var t=this.getZoom();return this.activeSlide.hitSelectObjectsByRect(window.zoomRect(e,1/t))}return null}},{key:"hitTest",value:function(e,t,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(this.activeSlide){if(this.prevHit&&this.prevHit.x===e&&this.prevHit.y===t&&window.sameCmp(i,this.prevHit.selShapeRect))return this.prevHit.data;var s=this.calcSlideAbsPos({x:e,y:t});if(i){var l=this.getZoom();s.x*=l,s.y*=l;var h=this.calcPointInSelRectDiff({left:s.x,top:s.y},i),u=h.dx,c=h.dy;s.x+=u,s.y+=c,s.x/=l,s.y/=l}var d=this.activeSlide.hitTest(s.x,s.y,n,r,a,o);return this.prevHit={x:e,y:t,data:d,time:Date.now(),selShapeRect:i},d}return null}},{key:"calcSlideAbsPos",value:function(e){var t=e.x,i=e.y,n=(e.width,e.height,this.getSvgRealClientRect());t-=n.x,i-=n.y;var r=1;return{x:t/=r=this.layoutResult?n.width/this.layoutResult.viewBox.width:this.getZoom(),y:i/=r}}},{key:"calcPointInSelRectDiff",value:function(e,t){var i=0,n=0;return e.left<t.x?i=t.x-e.left+5:e.left>t.x+t.width&&(i=t.x+t.width-e.left-5),e.top<t.y?n=t.y-e.top+5:e.top>t.y+t.height&&(n=t.y+t.height-e.top-5),{dx:i,dy:n}}},{key:"getSvgClientRect",value:function(e){!e&&this._svgClientRect&&0!==this._svgClientRect.width&&0!==this._svgClientRect.height&&window.scrollY===this.prevWindowScrollY||this.updateSvgClientRect();var t=this._svgClientRect;return t&&void 0===t.x&&(t.x=t.left),t&&void 0===t.y&&(t.y=t.top),this.prevWindowScrollY=window.scrollY,this._svgClientRect}},{key:"getSvgRealClientRect",value:function(e){if(window.__SCREEN_ROTATE__){var t=this.getSvgClientRect(e),i=t.width,n=t.height,r=t.y,a=t.right;return{width:n,height:i,x:r,y:(window._parent||window).innerWidth-a}}return this.getSvgClientRect(e)}}]),t}(pd),vd=new fd({slideStyle:{fillStyle:"#FFFFFF",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,lineWidth:0,strokeStyle:"#FFFFFF",defaultFill:"#eeeeee"},canvasStyle:{fillStyle:"#000000"}}),md=i(4955),_d=i.n(md),wd=i(4956),Sd=i.n(wd),xd="WPP_PLAY_FORWARD_SUCCESS",Td="WPP_PLAY_BACKWARD_SUCCESS",kd="WPP_PLAY_SWITCHTO_SUCCESS",Cd={},bd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.PlayView},e)));return i.onPlayerEvent=function(e){"forward"===e.action&&e.canGoforward?window.report(vc.TYPE.COUNT,xd,1):"backward"===e.action&&e.canGobackward?window.report(vc.TYPE.COUNT,Td,1):"switchTo"===e.action&&window.report(vc.TYPE.COUNT,kd,1),i.coreView.fire(C.VIEW_EVENT_TYPES.PLAYER_EVENT,_()({type:"play",animePlayer:i.animePlayer},e,i.getPlayInfo()))},i.calcSlideAbsPos=function(e){var t=e.x,n=e.y,r=i.getSvgRealClientRect();t-=r.x,n-=r.y;var a=i.getZoom();return{x:t/=a,y:n/=a}},i._initExplainPlayer=function(){return new Promise((function(e){_d()((function(t){i.isExplainPlayMode&&(i.explainPlayer=t.default()),i.coreView.fire(C.VIEW_EVENT_TYPES.EXPLAIN_PLAYER_INIT_DONE),e(i.explainPlayer)}))}))},i.destroyExplainPlayer=function(){i.explainPlayer&&(i.explainPlayer.destroy(),i.explainPlayer=null,i._initExplainPlayerPromise=null)},i.getExplainPlayer=function(){return i.explainPlayer||i._initExplainPlayerPromise},i.setAutoPlayPlayer=function(e){if(null===e)i.destroyAutoPlayer();else if(!i.autoplayPlayer)return new Promise((function(e){Sd()((function(t){i.autoplayPlayer=t.default(),e(i.autoplayPlayer)}))}))},i.getAutoplayPlayer=function(){return i.autoplayPlayer},i.destroyAutoPlayer=function(){i.autoplayPlayer&&(i.autoplayPlayer.destroy(),i.autoplayPlayer=null)},i.updateSvgClientRect=function(){if(i.playSvg)i._svgClientRect=i.playSvg.getBoundingClientRect();else{var e=i.$playerContainer;if(e){var t=e.getBoundingClientRect(),n=+e.style.zoom||1,r=+(e.style.width||"0px").split("px")[0];1===(window.__SCREEN_ROTATE__?Math.round(r/t.height):Math.round(r/t.width))&&(t=window.zoomRect(t,n)),i._svgClientRect=t}else i._svgClientRect={x:0,y:0,width:0,height:0}}},i.handleSlideRendered=function(e){var t=e.idx;i.preloadSlideSvg(t)},i}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=vd}},{key:"setActiveSlide",value:function(e){this.activeSlideIdx=e;var t=this.getSlideViewByIdx(e);t!==this.activeSlide&&(this.stopRender(),this.activeSlide=t,this.style.setZoom(0),this.reRender(),this.slideRenderMgr.setActiveSlide({activeSlide:t,idx:e,envLayout:this.layoutResult,lable:$c.ViewLable.PLAYER}),this.preloadSlides(e),this.slideRenderMgr.run())}},{key:"reRender",value:function(){this.layoutResult=this.slideLayout({}),this.activeSlide&&this.activeSlide.resize(this.layoutResult)}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.hasPlay=!1,this.$playerContainer&&this.$playerContainer.remove(),this.playSvg&&this.playSvg.remove(),this.animePlayer&&this.animePlayer.off("playEvent",this.onPlayerEvent),this.animePlayer&&this.animePlayer.destroy(),this.animePlayer=null,nd.getInstance().destroy(),this.destroyExplainPlayer()}},{key:"resize",value:function(){if(y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resize",this).call(this),this.$playerContainer){var e=this.layoutResult,i=e.viewBox,n=e.svgLayout,r=e.autoZoom;this.playSvg?window.domTools.setStyle(this.playSvg,{width:n.width,height:n.height,"flex-shrink":0}):v.userAgent.isIE?(window.domTools.setStyle(this.$playerContainer,{width:n.width,height:n.height,"flex-shrink":0}),nd.getInstance().resize(r)):v.userAgent.isFirefox||v.userAgent.isWps2019||v.userAgent.isMobileWpsClient?window.domTools.setStyle(this.$playerContainer,{width:i.width,height:i.height,transform:"scale("+r+","+r+")","flex-shrink":0}):window.domTools.setStyle(this.$playerContainer,{width:i.width,height:i.height,zoom:r,"flex-shrink":0}),this.updateSvgClientRect()}}},{key:"updateViewportSize",value:function(){this.resize(),nd.getInstance().setLayout(this.layoutResult),this.animePlayer&&this.animePlayer.updateViewportSize()}},{key:"_updateScroll",value:function(){}},{key:"resetSvgRect",value:function(){}},{key:"setSvgRootView",value:function(e){e&&(y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setSvgRootView",this).call(this,e),this.$container=e)}},{key:"play",value:function(e,t,i){var n=this;this.hasPlay=!0,this.loadAnimePlayer.then((function(r){n.createPlayerContainer(),n.animePlayer=new r({startIndex:e,baseView:n,$ctn:n.$playerContainer,cb:{onEffectPlayFinished:function(e,t,i){n.onPlayerEvent({action:"effectFinish",isLastEffect:e,advanceTime:t,isTriggerEffect:i})}}}),n.animePlayer.on("playEvent",n.onPlayerEvent),n.animePlayer.play(t,i).catch((function(e){window.collection("newui","value",window.pcTrack.newui.play_fail),console.error(e)}))})).catch((function(e){throw n.coreView.fire(C.VIEW_EVENT_TYPES.PLAYER_EVENT,{type:"error"}),window.collection("newui","value",window.pcTrack.newui.play_fail),e}))}},{key:"hasPlayer",value:function(){return this.hasPlay}},{key:"createPlayerContainer",value:function(){var e=this,i=this.slideLayout({}),n=i.viewBox,r=(i.svgLayout,window.domTools),a=document.createElement("div");r.setStyle(a,{position:"relative",width:n.width,height:n.height,overflow:"hidden"}),a.className=t.PlayContainerName,this.$playerContainer&&this.$playerContainer.remove(),this.$container.appendChild(a),this.$playerContainer=a,this.loadSvgNode=document.createElement("div"),r.setStyle(this.loadSvgNode,{position:"absolute",left:-1,width:1,"z-index":-1,opacity:0}),a.appendChild(this.loadSvgNode),Object.keys(Cd).forEach((function(t){e.preloadSlideSvg(+t)})),this.resize()}},{key:"stopSlideRender",value:function(e){e&&e.stopRender({})}},{key:"hitTestXX",value:function(){var e=Array.prototype.slice.call(arguments),t=e[0],i=e[1],n=e[3],r=e[4];if(this.activeSlide&&this.layoutResult){var a=this.calcSlideAbsPos({x:t,y:i});return this.activeSlide.hitTest(a.x,a.y,n,r)}return null}},{key:"insertNodeAfterShapeById",value:function(e,t,i){return nd.getInstance().insertNodeAfterShapeById(e,t,i)}},{key:"stepForward",value:function(){var e;return this.animePlayer&&(e=this.animePlayer).stepForward.apply(e,arguments)}},{key:"stepBackward",value:function(){var e;return this.animePlayer&&(e=this.animePlayer).stepBackward.apply(e,arguments)}},{key:"stepTo",value:function(e,t,i,n){return this.animePlayer&&this.animePlayer.stepTo(e,t,i,n)}},{key:"getPlayInfo",value:function(){return this.animePlayer&&this.animePlayer.getPlayInfo()}},{key:"playTriggerAnim",value:function(){var e;return this.animePlayer&&(e=this.animePlayer).playTriggerAnim.apply(e,arguments)}},{key:"stepToTriggerSeq",value:function(){var e;return this.animePlayer&&(e=this.animePlayer).stepToTriggerSeq.apply(e,arguments)}},{key:"setAutoPlay",value:function(){return this.animePlayer&&this.animePlayer.setAutoPlay()}},{key:"changeMediaPlay",value:function(e){this.onPlayerEvent({action:"changeMediaPlay",mediaPlayInfo:e})}},{key:"setRemarkView",value:function(e){this.remarkView=e}},{key:"setRemarkWin",value:function(e){this.remarkWin=e}},{key:"setExplainType",value:function(e){return this._explainType=e,!this.isExplainPlayMode||this.explainPlayer||this._initExplainPlayerPromise?!this.isExplainPlayMode&&this.explainPlayer&&this.destroyExplainPlayer():this._initExplainPlayerPromise=this._initExplainPlayer(),this.getExplainPlayer()}},{key:"getContainerSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$container,t=e.offsetHeight,i=e.offsetWidth,n=i,r=t;return v.userAgent.isMobile&&window.__SCREEN_ROTATE__&&i<t&&(n=t,r=i),{width:n,height:r}}},{key:"preloadSlides",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.layoutResult,n=5,r=2,a=[].concat(S()(this.getRangeSlides(e+1,e+n)),S()(this.getRangeSlides(e-r,e-1)));a.forEach((function(e){var n=e.slide,r=e.idx;n&&(n.isRenderFinish()||n.hasPreload||(console.log("Player rendering new slide :",r,n.getId(),"Player currentSlideIndex :",t.activeSlideIdx),i.useComDefs=!1,t.slideRenderMgr.addSlideAtLast({slide:n,idx:r,envLayout:i,lable:$c.ViewLable.PLAYER,callback:t.handleSlideRendered}),n.hasPreload=!0))}))}},{key:"preloadSlideSvg",value:function(e){if(this.loadSvgNode){if(e===this.activeSlideIdx+1&&!Cd[e]){var t=this.getSlideViewByIdx(e);if(!t.isRenderFinish())return void(Cd[e]=!1);var i=t.cloneSvg(100,!0);this.loadSvgNode.innerHTML="",this.loadSvgNode.appendChild(i),Cd[e]=!0}}else Cd[e]=!1}},{key:"getRangeSlides",value:function(e,t){for(var i=[],n=e;n<=t;n++){var r=this.getSlideViewByIdx(n);r&&i.push({slide:r,idx:n})}return i}},{key:"isSupportEffect",value:function(){var e;return this.animePlayer&&(e=this.animePlayer).isSupportEffect.apply(e,arguments)}},{key:"getShapeCurrentRect",value:function(e,t){return this.animePlayer&&this.animePlayer.getTargetCurrentRect(e,t)}},{key:"getInterSeqSteps",value:function(e,t){return this.animePlayer&&this.animePlayer.getInterSeqSteps(e,t)}},{key:"isRemarkView",get:function(){return!!this.remarkView}},{key:"isRemarkWin",get:function(){return!!this.remarkWin}},{key:"explainType",get:function(){return this._explainType}},{key:"isExplainEditMode",get:function(){return this.explainType===v.ExplainMode.edit}},{key:"isExplainPlayMode",get:function(){return this.explainType===v.ExplainMode.play}},{key:"isAutoPlayMode",get:function(){return!!this.autoplayPlayer}}]),t}(yd);bd.mode=C.ViewModes.PlayView,bd.PlayContainerName="play_root_container";var Ed=bd,Rd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.PreView},e)));return i._setLayout(),i}return u()(t,e),o()(t,[{key:"_setLayout",value:function(){this._containerLayout=this.slideLayout({}),this._slideLayout=this._containerLayout.svgLayout,this._docLayout=this.docLayout()}},{key:"setStyle",value:function(){this.style=gd}},{key:"stopRender",value:function(){}},{key:"isAllFinished",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t])return!1;return!0}},{key:"render",value:function(){}},{key:"resize",value:function(){var e=this.layoutResult=this.slideLayout({});v.userAgent.isIE?(window.domTools.setStyle(this.$playerContainer,{width:e.svgLayout.width,height:e.svgLayout.height,"flex-shrink":0}),nd.getInstance().resize(e.bestZoom)):v.userAgent.isFirefox||v.userAgent.isWps2019?window.domTools.setStyle(this.$playerContainer,{width:e.viewBox.width,height:e.viewBox.height,transform:"scale("+e.bestZoom+","+e.bestZoom+")","flex-shrink":0}):window.domTools.setStyle(this.$playerContainer,{width:e.viewBox.width,height:e.viewBox.height,zoom:e.bestZoom})}},{key:"slideLayout",value:function(){return y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"slideLayout",this).call(this,{})}},{key:"docLayout",value:function(){var e=this.getSlideViewByIdx(0);if(!e)return null;var i=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"slideLayout",this).call(this,{slide:e,widthFirst:!0}).svgLayout,n=(Math.floor(i.height)+t.CANVAS_PADDING_BOTTOM)*this.getSlideCount();return{width:i.width,height:n,x:0,y:0}}},{key:"reRender",value:function(e){this._setLayout(),this.render()}},{key:"hitTest",value:function(e,t){for(var i=Object.keys(this.slideMap),n=0,r=i.length;n<r;n++){var a=this.slideMap[i[n]].hitTest(e,t);if(a)return a}return null}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.stopRender(),this.previewWebglPlayer&&this.previewWebglPlayer.destroy(),this.$playerContainer&&this.$playerContainer.remove()}},{key:"startPreview",value:function(e,i,n){var r=this;return new Promise((function(a,o){try{r.createPlayerContainer(),r.loadAnimePlayer.then((function(o){r.previewWebglPlayer=new o({startIndex:e,baseView:r,$ctn:r.$playerContainer}),n===t.types.TRANSITION?r.previewWebglPlayer.previewTransitionEffect(e,(function(e){return a(e)})):n===t.types.SLIDE?r.previewWebglPlayer.preview(e,(function(e){return a(e)})):(n===t.types.EFFECT||i)&&r.previewWebglPlayer.previewEffect(e,i,(function(e){return a(e)}))}))}catch(e){o(e)}}))}},{key:"createPlayerContainer",value:function(){var e=this.$container,t=e.offsetHeight,i=e.offsetWidth,n=i,r=t;v.userAgent.isMobile&&i<t&&(n=t,r=i);var a={width:n,height:r},o=this.slideLayout({containerSize:a});this.layoutResult=o;var s=document.createElement("div");window.domTools.setStyle(s,{position:"relative",overflow:"hidden"}),s.className=Ed.PlayContainerName,this.$container.appendChild(s),this.$playerContainer&&this.$playerContainer.remove(),this.$playerContainer=s,this.resize()}},{key:"setZoom",value:function(){}}]),t}(pd);Rd.mode=C.ViewModes.PreView,Rd.CANVAS_PADDING_BOTTOM=12,Rd.types={EFFECT:"EFFECT",SLIDE:"SLIDE",TRANSITION:"TRANSITION"};var Pd=Rd,Id=new fd({slideStyle:{fillStyle:"#FFFFFF",shadowColor:"rgb(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,lineWidth:0,strokeStyle:"#cccccc",defaultFill:"#eeeeee"},canvasStyle:{fillStyle:"#E6E6E6"}}),Ld=v.ShapeType.Table,Ad=function(){function e(t){r()(this,e),this.doc=t}return o()(e,[{key:"extractTextFromSlideIdx",value:function(e){var t=this,i=this.doc.coreData.getSlideAt(e);if(i){var n=i.getShapeTree(),r=i.getFollowing(),a=null,o=null;if(r){a=r.getShapeTree();var s=r.getFollowing();s&&(o=s.getShapeTree())}var l=[],h=n.getChildShapesRecurse().filter((function(e){return e.hasContent()&&(e.getTextFrame()||e.getShapeType()===Ld)})),u=[];a&&(u=u.concat(a.getChildShapesRecurse())),o&&(u=u.concat(o.getChildShapesRecurse()));var c=u.filter((function(e){return e.hasContent()&&(e.getTextFrame()||e.getShapeType()===Ld)&&Object.isEmpty(e.getPlaceHolder())}));return[].concat(h,c).sort((function(e,t){var i=n.getShapeIndex(e.visual.getRootShape());return n.getShapeIndex(t.visual.getRootShape())-i})).forEach((function(e){var i=t.getShapeText(e,!0);Array.isArray(i)?l.push.apply(l,S()(i)):i&&l.push(i)})),l}}},{key:"getShapeText",value:function(e,t){var i=function(e){var i=e.getTextFrame();if(i){var n=i.getTextStream();if(!n)return null;var r=n.getAllText().join("").trim();return t&&"*"===r?null:(e.getPlaceHolder&&e.getPlaceHolder()&&r.startsWith("*")&&(r=r.slice(1)),r&&(r=r.replace(/\r/g,"\r\n")),r||null)}};if(e.getShapeType()===Ld){var n=e.getTableFrame(),r=n.getCells(0,0,n.getRowCount(),n.getColumnCount()),a=[];return r.forEach((function(e){var t=i(e);t&&a.push(t)})),a}return i(e)}}]),e}(),Bd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.PreView},e)));return i.dataHub=new Ad(i),i.setLayout(),i}return u()(t,e),o()(t,[{key:"resize",value:function(){console.log("Preview mode does not implement the resize method")}},{key:"getSlideLayout",value:function(){return this.containerLayout.svgLayout}},{key:"setLayout",value:function(){var e=this.getSlideViewByIdx(0),i=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"slideLayout",this).call(this,{slide:e,widthFirst:!0}),n=i.svgLayout;e&&(n.y=(Math.floor(n.height)+t.SVG_MARGIN_BOTTOM)*e.getSlideIndex()),this.containerLayout=i,this.layoutResult=i}},{key:"setStyle",value:function(){this.style=Id}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,this.slideCount-1],i=arguments[1];this._renderManager||(this._renderManager=window.SlideRenderManager.getInstance());for(var n=[],r=f()(t,2),a=r[0],o=r[1],s=function(t){var r=e.getSlideViewByIdx(t);r&&n.push({slide:r,idx:t,envLayout:e.containerLayout,label:window.SlideRenderManager.ViewLable.PREVIEW,callback:function(t){i(_()({},t,{slide:r})),e.updateSvgViewBox(r)}})},l=a;l<=o;l++)s(l);this.coreView.setVisibleSlide(a,o),this._renderManager.setViewSlide(n),this._renderManager.run()}},{key:"updateSvgViewBox",value:function(e){var t=this.layoutResult,i=t.svgLayout,n=t.viewBox,r=i.width,a=i.height;e.ctx.setAttribute("width",r),e.ctx.setAttribute("height",a),e.ctx.setViewBox(n)}},{key:"docLayout",value:function(){var e=this.getSlideViewByIdx(0);if(!e)return null;var i=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"slideLayout",this).call(this,{slide:e,widthFirst:!0}).svgLayout,n=(Math.floor(i.height)+t.SVG_MARGIN_BOTTOM)*this.getSlideCount();return{width:i.width,height:n,x:0,y:0}}},{key:"reRender",value:function(e){this.setLayout(),lt.default.dispatchEvent(lt.default.eventTypes.mobile.PREVIEW_THUMBNAIL_UPDATE,e)}},{key:"orientationChange",value:function(){this.setLayout()}},{key:"hitTest",value:function(e,t){for(var i=Object.keys(this.slideMap),n=0,r=i.length;n<r;n++){var a=this.slideMap[i[n]].hitTest(e,t);if(a)return a}return null}},{key:"destroy",value:function(){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.$container.style.display="block"}},{key:"slideCount",get:function(){var e=this.slidesLoader.getSlideCount(),t=this.coreData.slidesPreviewLimit();return t>0&&t<=e&&(e=t),e}}]),t}(pd);Bd.mode=C.ViewModes.PreView,Bd.SVG_MARGIN_BOTTOM=12;var Dd=Bd,Md=v.userAgent.isMobile?Dd:Pd,Od=i(144),Nd=new fd({slideStyle:{fillStyle:"rgba(255,255,255,1)",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:Od.isMobile?10:20,lineWidth:0,strokeStyle:"rgba(204,204,204,1)",defaultFill:"rgba(255,255,255,1)"},canvasStyle:{fillStyle:"rgba(230,230,230,1)"}}),Fd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.EditView},e)));i.onSvgUpdate=function(e){i.updateSvgLayout(e)},i.activeSlide=null,i.gid=Object(k.a)();var n=i.slideLayout({}),a=n.viewBox,o=n.svgLayout;if(i.ctx=new Vs.default(o.width,o.height),i.ctx.setViewBox(a),i.ctx.isActive=!0,"b"===window.officeType&&!v.userAgent.isMobile){var s=i.ctx.getSvg();s.id="whiteboard_svg",s.hide()}return v.userAgent.isMobile&&i.$container&&i.setSvgRootView(i.$container),i.resetSvgRect(),i}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=Nd,"b"===window.officeType?this.style.setZoom(1):this.style.setZoom(0)}},{key:"resetZoom",value:function(){var e=this.setZoom(this.style.getZoom());lt.default.dispatchEvent(lt.default.eventTypes.pc.ON_EDITVIEW_RESIZE_ZOOM,100*e)}},{key:"setZoom",value:function(e,i){var n=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setZoom",this).call(this,e,i);return this.resetSvgRect(e),n}},{key:"slideLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.widthFirst,n=void 0!==i&&i,r=e.containerSize;return v.userAgent.isMobile?this.$container.size=window.domTools.getElementInnerSize(this.$container):this.$container.size=this.$container.size||window.domTools.getElementInnerSize(this.$container),r=r||this.$container.size,y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"slideLayout",this).call(this,{widthFirst:n,containerSize:r})}},{key:"hitTestXX",value:function(e,t,i,n){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this.activeSlide){if(this.prevHit&&this.prevHit.x===e&&this.prevHit.y===t)return this.prevHit.data;var a=this.calcSlideAbsPos({x:e,y:t});if(i){var o=this.getZoom();a.x*=o,a.y*=o;var s=this.calcPointInSelRectDiff({left:a.x,top:a.y},i),l=s.dx,h=s.dy;a.x+=l,a.y+=h,a.x/=o,a.y/=o}var u=this.activeSlide.hitTest(a.x,a.y,n,r);return this.prevHit={x:e,y:t,data:u,time:Date.now()},u}return null}},{key:"calcSlideAbsPosXX",value:function(e){var t=e.x,i=e.y,n=(e.width,e.height,this.getSvgClientRect());t-=n.x,i-=n.y;var r=this.getZoom();return{x:t/=r,y:i/=r}}},{key:"calcPointInSelRectDiff",value:function(e,t){var i=0,n=0;return e.left<t.x?i=t.x-e.left+5:e.left>t.x+t.width&&(i=t.x+t.width-e.left-5),e.top<t.y?n=t.y-e.top+5:e.top>t.y+t.height&&(n=t.y+t.height-e.top-5),{dx:i,dy:n}}},{key:"resize",value:function(){var e;this.$container.size=window.domTools.getElementInnerSize(this.$container);for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];(e=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resize",this)).call.apply(e,[this].concat(n)),this.resetSvgRect()}},{key:"setSvgRootView",value:function(e){if(this.svgRootView!==e&&e){this._svgRootViewObserver&&this._svgRootViewObserver.disconnect();var i=new MutationObserver(this.updateSvgClientRect);i.observe(e,{attributes:!0}),this._svgRootViewObserver=i}y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setSvgRootView",this).call(this,e);var n=this.slideLayout({}).svgLayout,r=this.ctx.getSvg();if(!("b"===window.officeType)&&(v.userAgent.isSafari&&!v.userAgent.isMobile||v.userAgent.isIPad)){var a=this.$shadowWrapper||document.createElement("div");a.contains(r)||(a.className="shadowWrapper",a.appendChild(r),window.domTools.setStyle(a,{width:n.width,height:n.height})),this.svgRootView.contains(a)||(this.svgRootView.appendChild(a),this.updateSvgClientRect()),this.$shadowWrapper=a}else if(r.parentNode!==this.svgRootView){if(v.userAgent.isMobile){if(this.svgRootView&&"function"!=typeof this.svgRootView.prepend)throw new Error(this.svgRootView.toString()+", cls: "+this.svgRootView.className+", id: "+this.svgRootView.id);this.svgRootView.prepend(r)}else this.svgRootView.appendChild(r);this.updateSvgClientRect()}}},{key:"updateSvgLayout",value:function(e){if(!this.activeSlide||e===this.activeSlide.getId()){var t=this.slideLayout({}),i=t.svgLayout,n=t.viewBox;this.ctx.getSvg().getAttribute("viewBox")===n.x+" "+n.y+" "+n.width+" "+n.height&&this.ctx.width===i.width&&this.ctx.height===i.height||(this.ctx.setViewBox(n),this.ctx.width=i.width,this.ctx.height=i.height,this.getSvgClientRect(!0),this.resize())}}},{key:"isBestZoom",get:function(){return 0===this.style.getZoom()}}]),t}(yd);Fd.mode=C.ViewModes.EditView;var Vd=Fd,Ud=new fd({slideStyle:{fillStyle:"#FFFFFF",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,lineWidth:0,strokeStyle:"#CCCCCC"},canvasStyle:{fillStyle:"#E6E6E6"}}),Gd=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.ThmubnailView},e)))}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=Ud}},{key:"reRender",value:function(e){}},{key:"slideLayout",value:function(e,t){var i=this.slidePxSize;return{viewBox:i,svgLayout:{x:0,y:0,width:e,height:t},scale:e/i.width*window.ti2pxRatio}}},{key:"renderSlides",value:function(e){var t=this,i=e.start,n=e.end,r=e.width,a=e.height,o=e.callback,s=[],l=this.slideLayout(r,a);l.scale+=1e-4,this._thumbnailEnvLayout=l;for(var h=$c.getInstance(),u=2*n-i,c=function(e,i){o(_()({},e,{slide:i})),t.updateSvgViewBox(i,l)},d=function(e){var i=t.getSlideViewByIdx(e);i&&s.push({slide:i,idx:e,callback:function(e){return c(e,i)},envLayout:l,lable:$c.ViewLable.THUMBNAIL})},p=i;p<=u;p++)d(p);var f=function(e){var i=t.getSlideViewByIdx(e);i&&s.push({slide:i,idx:e,callback:function(e){return c(e,i)},envLayout:l,lable:$c.ViewLable.THUMBNAIL})};for(p=i-1;p>=2*i-n;p--)f(p);h.setViewSlide(s),h.run()}},{key:"updateSvgViewBox",value:function(e,t){var i=this;e.domSvgRef.forEach((function(e){"svg"===e.tagName&&i._updateSvgViewBox(e,t)}))}},{key:"_updateSvgViewBox",value:function(e,t){var i=t.svgLayout,n=t.viewBox,r=i.width,a=i.height,o=r/n.width;v.userAgent.isSafari||v.userAgent.chromeVS&&v.userAgent.chromeVS<60?(e.setAttribute("width",n.width),e.setAttribute("height",n.height),e.setAttribute("style","transform-origin:top left;transform:scale("+o+")")):(e.setAttribute("width",r),e.setAttribute("height",a)),e.setAttribute("viewBox",n.x+" "+n.y+" "+n.width+" "+n.height)}}]),t}(pd),Hd=new fd({slideStyle:{fillStyle:"#eff1f3",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:16,lineWidth:0,strokeStyle:"#CCCCCC",defaultFill:"#ffffff"},canvasStyle:{fillStyle:"#E6E6E6"}}),Wd=function(e){function t(){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u()(t,e),o()(t,[{key:"_init",value:function(e){var i=e.getNotesPage();y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_init",this).call(this,i)}},{key:"loadData",value:function(){var e=this,t=this.slidesLoader.getSlideByIdxProxy(this.proxy);t?(this.slideData=t,this._init(this.slideData)):this.proxy.once(this.proxy.constructor.EventTypes.DATA_LOADED,(function(){e.loadData()}))}}]),t}(ld),jd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.NotesBody},e)));return i.onSvgUpdate=function(){var e=i.ctx.getSvg();console.log("SingleView onSvgUpdate",e.getBBox())},i}return u()(t,e),o()(t,[{key:"getSlideViewClass",value:function(){return Wd}},{key:"getSlideDomId",value:function(e){return"notes_"+e.getId()}},{key:"setStyle",value:function(){this.style=Hd}},{key:"setActiveSlide",value:function(e){var t=this.getSlideViewByIdx(e);this.activeSlide=t,this.viewMode===C.ViewModes.PlayView&&this.style.setZoom(0),this.reRender(),window.SlideRenderManager.getInstance().setNoteSlide(t,this.layoutResult),window.SlideRenderManager.getInstance().run()}},{key:"slideLayout",value:function(){var e=0,t=0,i=this.scrollLeft||0,n=this.scrollTop||0,r=this.maxHeight||0,a=window.domTools.getElementInnerSize(this.$container),o=a.width-15,s=a.height-10;r>a.height&&(s=r);var l=e+t,h=1*(o-2*l),u=1*(s-2*l),c={x:l-i,y:l-n,width:h,height:u};o>=2*l+h&&(c.x=(o-h)/2),s>=2*l+u&&(c.y=(s-u)/2);return{viewBox:{x:0,y:0,width:c.width/.05,height:c.height/.05},svgLayout:new td(c),scale:.05}}}]),t}(yd);jd.mode=C.ViewModes.NotesBody;var Yd=jd,zd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.Review},e)));i.onSvgUpdate=function(){},i.activeSlide=null,i.gid=Object(k.a)();var n=i.slideLayout({}),a=n.viewBox,o=n.svgLayout;i.ctx=new Vs.default(o.width,o.height),i.ctx.setViewBox(a);var s=i.ctx.getSvg();return i.$container.appendChild(s),s.onUpdate=i.onSvgUpdate,i.resetSvgRect(),i}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=Nd,this.style.setZoom(0)}},{key:"resetZoom",value:function(){var e=this.setZoom(this.getZoom());lt.default.dispatchEvent(lt.default.eventTypes.pc.ON_EDITVIEW_RESIZE_ZOOM,100*e)}},{key:"setZoom",value:function(e,i){var n=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setZoom",this).call(this,e,i);return this.resetSvgRect(),n}},{key:"slideLayoutXX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.widthFirst,i=void 0!==t&&t,n=e.containerSize,r=this.style,a=r.getZoom(),o=r.getSlideStyle(),s=this.slideTiSize,l=(n=n||window.domTools.getElementInnerSize(this.$container)).width,h=n.height;i&&(h=l*s.height/s.width);var u=window.Ti2Px(s.width),c=window.Ti2Px(s.height),d=o.lineWidth+o.shadowBlur,p=a;if(0===a){var f=l-2*d,g=h-2*d;s.width/s.height>f/g?g=f*(s.height/s.width):f=g*(s.width/s.height),(p=f/u)<.1&&(f=.1*u,g=.1*c,p=.1)}var y={x:(l-u*p)/2,y:(h-c*p)/2,width:u,height:c},v=u/s.width,m=v/window.ti2pxRatio;return this.scale=m*p,{viewBox:this.slidePxSize,svgLayout:y,containerSize:n,scale:v,bestZoom:p}}},{key:"hitTestXX",value:function(e,t,i,n){if(this.activeSlide){var r=this.calcSlideAbsPos({x:e,y:t});if(i){var a=this.getZoom();r.x*=a,r.y*=a;var o=this.calcPointInSelRectDiff({left:r.x,top:r.y},i),s=o.dx,l=o.dy;r.x+=s,r.y+=l,r.x/=a,r.y/=a}return this.activeSlide.hitTest(r.x,r.y,n)}return null}},{key:"hitSelectObjectsByRectXX",value:function(e){return this.activeSlide?this.activeSlide.hitSelectObjectsByRect(this.calcSlideAbsPos(e)):null}},{key:"calcSlideAbsPos",value:function(e){var t=e.x,i=e.y,n=e.width,r=e.height,a=this.layoutResult.svgLayout,o=this.transformParams,s=o.zoom;return t-=a.x,i-=a.y,t-=o.x,i-=o.y,n&&(n/=s),r&&(r/=s),{x:t/=s,y:i/=s,width:n,height:r}}},{key:"calcPointInSelRectDiff",value:function(e,t){var i=0,n=0;return e.left<t.x?i=t.x-e.left+5:e.left>t.x+t.width&&(i=t.x+t.width-e.left-5),e.top<t.y?n=t.y-e.top+5:e.top>t.y+t.height&&(n=t.y+t.height-e.top-5),{dx:i,dy:n}}}]),t}(yd);zd.mode=C.ViewModes.Review;var Kd=zd,qd=new fd({slideStyle:{fillStyle:"#FFFFFF",shadowColor:"rgb(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:10,lineWidth:0,strokeStyle:"#cccccc",defaultFill:"#eeeeee"},canvasStyle:{fillStyle:"#E6E6E6"}}),Xd=i(3160),Jd=i.n(Xd),Zd=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.Review},e)));i.onSvgUpdate=function(){},i.activeSlide=null,i.gid=Object(k.a)();var n=i.slideLayout({}),a=n.viewBox,o=n.svgLayout;i.ctx=new Vs.default(o.width,o.height),i.ctx.setViewBox(a),i.ctx.isActive=!0;var s=i.ctx.getSvg();return i.$container.appendChild(s),s.onUpdate=i.onSvgUpdate,i.resetSvgRect(),i.svgShadow=new Jd.a(s),i.svgShadow.update(),i}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=qd,this.style.setZoom(0)}},{key:"resetZoom",value:function(){var e=this.setZoom(this.getZoom());lt.default.dispatchEvent(lt.default.eventTypes.pc.ON_EDITVIEW_RESIZE_ZOOM,100*e),this.svgShadow.update()}},{key:"resize",value:function(){var e;this.$container.size=window.domTools.getElementInnerSize(this.$container);for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];(e=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"resize",this)).call.apply(e,[this].concat(n)),this.resetSvgRect(),this.svgShadow.update()}},{key:"setZoom",value:function(e,i){var n=y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setZoom",this).call(this,e,i);return this.resetSvgRect(),n}},{key:"slideLayoutXX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.widthFirst,i=void 0!==t&&t,n=e.containerSize,r=this.style,a=r.getZoom(),o=r.getSlideStyle(),s=this.slideTiSize,l=(n=n||window.domTools.getElementInnerSize(this.$container)).width,h=n.height;i&&(h=l*s.height/s.width);var u=window.Ti2Px(s.width),c=window.Ti2Px(s.height),d=o.lineWidth+o.shadowBlur,p=a;if(0===a){var f=l-2*d,g=h-2*d;s.width/s.height>f/g?g=f*(s.height/s.width):f=g*(s.width/s.height),(p=f/u)<.1&&(f=.1*u,g=.1*c,p=.1)}var y={x:(l-u*p)/2,y:(h-c*p)/2,width:u,height:c},v=u/s.width,m=v/window.ti2pxRatio;return this.scale=m*p,{viewBox:this.slidePxSize,svgLayout:y,containerSize:n,scale:v,bestZoom:p}}},{key:"hitTestXX",value:function(e,t,i,n){if(this.activeSlide){var r=this.calcSlideAbsPos({x:e,y:t});if(i){var a=this.getZoom();r.x*=a,r.y*=a;var o=this.calcPointInSelRectDiff({left:r.x,top:r.y},i),s=o.dx,l=o.dy;r.x+=s,r.y+=l,r.x/=a,r.y/=a}return this.activeSlide.hitTest(r.x,r.y,n)}return null}},{key:"calcSlideAbsPos",value:function(e){var t=e.x,i=e.y,n=(e.width,e.height,this.getSvgClientRect());t-=n.x,i-=n.y;var r=this.getZoom();return{x:t/=r,y:i/=r}}},{key:"calcPointInSelRectDiff",value:function(e,t){var i=0,n=0;return e.left<t.x?i=t.x-e.left+5:e.left>t.x+t.width&&(i=t.x+t.width-e.left-5),e.top<t.y?n=t.y-e.top+5:e.top>t.y+t.height&&(n=t.y+t.height-e.top-5),{dx:i,dy:n}}},{key:"updateSvgLayout",value:function(){var e=this.slideLayout({}),t=e.svgLayout,i=e.viewBox;this.ctx.getSvg().getAttribute("viewBox")===i.x+" "+i.y+" "+i.width+" "+i.height&&this.ctx.width===t.width&&this.ctx.height===t.height||(this.ctx.setViewBox(i),this.ctx.width=t.width,this.ctx.height=t.height,this.getSvgClientRect(!0),this.resize()),this.svgShadow.update()}},{key:"destroy",value:function(){this.svgShadow.unmount(),y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(yd);Zd.mode=C.ViewModes.Review;var Qd=Zd,$d=v.userAgent.isMobile?Qd:Kd,ep=function(){function e(t){r()(this,e),this.editMode=C.EditMode.layout,this.viewMode=C.ViewModes.ThmubnailView,this.coreData=t,this.style=Ud,this.slideLayoutCache={}}return o()(e,[{key:"rendSlideByIdx",value:function(e,t){var i=this;return new Promise((function(n,r){var a=i.slidesLoader.getSlideIdxProxy(e),o=i.slideLayout(t),s=new ld({slidesLoader:i.slidesLoader,proxy:a,root:i,viewMode:i.viewMode,editMode:i.editMode,style:i.style});i.slideRenderMgr.addSlideAtLast({slide:s,callback:function(e){var t=e.finished,i=e.slideSvg,r=e.slideView;t&&n({slideSvg:i,slideId:r.getId(),slideView:r})},envLayout:o,lable:$c.ViewLable.SLIDELAYOUT}),i.slideRenderMgr.run()}))}},{key:"renderSlideLayout",value:function(e,t){var i=this.slidesLoader.getSlideIdxById(e),n=this.slideLayoutCache[e]||this.rendSlideByIdx(i,t);return this.slideLayoutCache[e]=n,n}},{key:"updateSlideLayoutCache",value:function(){if(this.slidesLoader.isAllLoaded())for(var e=Object.keys(this.slideLayoutCache),t=0;t<e.length;t++){var i=e[t],n=Number(i);if(-1===this.slidesLoader.getSlideIdxById(n)){var r=this.slideLayoutCache[i];r&&r.then((function(e){e.slideView.destroy()})),delete this.slideLayoutCache[i]}}}},{key:"slideLayout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.boxSize=e||this.boxSize,i=t.width,n=void 0===i?200:i,r=this.slidePxSize,a=n*r.height/r.width,o={x:0,y:0,width:n,height:a},s=n/r.width*window.ti2pxRatio;return{viewBox:_()({x:0,y:0},r),svgLayout:o,editMode:this.editMode,scale:s}}},{key:"destroy",value:function(){for(var e=Object.keys(this.slideLayoutCache),t=0;t<e.length;t++){var i=e[t],n=this.slideLayoutCache[i];n&&n.then((function(e){e.slideView.destroy()})),delete this.slideLayoutCache[i]}this.slideRenderMgr.destroy()}},{key:"slidesLoader",get:function(){return this.coreData.getLayouts()}},{key:"slideTiSize",get:function(){return this.coreData.getSlideSize()}},{key:"slidePxSize",get:function(){var e=this.slideTiSize;return{x:0,y:0,width:window.Ti2Px(e.width),height:window.Ti2Px(e.height)}}},{key:"slideRenderMgr",get:function(){return this._slideRenderManager||(this._slideRenderManager=new $c({firstRenderAction:!1})),this._slideRenderManager}}]),e}(),tp=function(e){function t(e){var i=e.workspace,n=e.$container,a=e.mode;r()(this,t);var o=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._regSelectionEvt=function(){var e=o.selection;e?(e.on(e.constructor.EventTypes.CHANGE,(function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];o.hitChangeRender.apply(o,t),o.fire.apply(o,[C.VIEW_EVENT_TYPES.SELECT_SHAPE_CHANGE].concat(t))})),e.on(e.constructor.EventTypes.SLIDE_CHANGE,(function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];o.fire.apply(o,[C.VIEW_EVENT_TYPES.SELECT_SLIDE_CHANGE].concat(t))}))):(console.warn("selection is null"),setTimeout(o._regSelectionEvt,10))},o.dispatchModifyEvent=function(e){var t=e.category,i=e.slideId;"slides"===t&&(o._modifySlideIds||(o._modifySlideIds=[]),o._modifySlideIds.includes(i)||o._modifySlideIds.push(i),clearTimeout(o.modifyTimer),o.modifyTimer=setTimeout((function(){o.fire(C.VIEW_EVENT_TYPES.MODIFY,{slideIds:o._modifySlideIds}),o._modifySlideIds=null}),100))},o.hitChangeRender=function(e){var t=o.selection,i=t.getActiveSlide(),n=t.getActiveShapes(),r=t.getActiveTableCells(),a=t.getRange(),s=a.begin,l=a.end,h=[],u=!1;if(t.state===C.SelectType.select_text)if(n[0].isEmptyTextStream())u=!0;else if(s>0){var c=t.getActiveTextStream(),d=c.getCharAt(s-1);"\n"!==d&&"\r"!==d||(u="\n"===(d=c.getCharAt(s))||"\r"===d)}if(u){h.push(n[0].getId());var p=o._prevHitRenderInfo;if(p&&i.getId()===p.slideId){if(!p.shapeIds.includes(h[0])){var f={slideId:i.getId(),type:"hasShapeFocus",event:Pu.default.modify_fmt};f.cpStart=s,f.cpEnd=l;var g=n[0];r&&(g=r[0],f.cellIdx=g&&g.getIdx()),f.data=g&&g.getTextFrame()&&g.getTextFrame().getTextStream(),f.shapeIds=h,o.updateSlide(f),o._prevHitRenderInfo=f}o.updateSlide(p),h.length>0?p.shapeIds=h:o._prevHitRenderInfo=null}else if(p&&(o.updateSlide(p),o._prevHitRenderInfo=null),h.length>0){o._prevHitRenderInfo={slideId:i.getId(),shapeIds:h,type:"hasShapeFocus",cpStart:s,cpEnd:l,event:Pu.default.modify_fmt};var y=n[0];r&&(y=r[0],o._prevHitRenderInfo.cellIdx=y&&y.getIdx()),o._prevHitRenderInfo.data=y&&y.getTextFrame()&&y.getTextFrame().getTextStream(),o.updateSlide(o._prevHitRenderInfo)}}else!o._prevHitRenderInfo||r&&1!==r.length?window.SlideRenderManager.getInstance().run():(o.updateSlide(o._prevHitRenderInfo),o._prevHitRenderInfo=null)},o._onSlideContainerChange=function(e){e&&"slideMasters"===e.category&&(o.slideLayoutView&&o.slideLayoutView.updateSlideLayoutCache(),o.fire(C.VIEW_EVENT_TYPES.MASTER_SLIDE_CHANGE,e))},o._onModifyPageSetup=function(e){var t=o.doc.slideLayout({});o.doc.activeSlide&&o.doc.activeSlide.setENV({layout:t}),window.SlidePool.getInstance().reRenderSlides(e),o.updateViewportSize(),o.slideLayoutView&&o.slideLayoutView.destroy(),o.fire(C.VIEW_EVENT_TYPES.MODIFY_PAGE_SETUP,e)},o.workspace=i,o.$container=n||document.getElementById("workspace"),o.mode=a,o}return u()(t,e),o()(t,[{key:"getSlideIdxProxy",value:function(e){return this.doc.getSlideIdxProxy(e)}},{key:"getProxyIdByIdx",value:function(e){var t=this.getSlideIdxProxy(e);return t&&t.getGid()}},{key:"getIndexBySlideId",value:function(e){return this.coreData.getSlideIdxById(e)}},{key:"getMode",value:function(){return this.mode}},{key:"setMode",value:function(e){this.mode=e,this.coreData.getLoaderMgr().updateMode(e)}},{key:"setActiveSlide",value:function(e){if(!Object.isEmpty(e)&&this.doc instanceof yd){var t=void 0,i=this.coreData.getLoaderMgr();if(e.isSlideIdxProxy?(i.setTopPriority(this.coreData.getLayouts()),i.updateActiveSlide(e.idx),t=this.selection.selectSlide(e)):(i.setTopPriority(this.coreData.getSlides()),t=this.selection.selectSlideAt(e),i.updateActiveSlide(e)),-1===t)return t;this.doc.setActiveSlide(e)}}},{key:"setActiveSlideByData",value:function(e){if(this.doc instanceof yd){this.selection.selectSlide(e),this.doc.setActiveSlide(e);var t=this.activeSlide,i=this.doc.slideLayout({}),n=window.SlideRenderManager.getInstance();n.setActiveSlide({activeSlide:t,envLayout:i}),n.run()}}},{key:"setVisibleSlide",value:function(e,t){this.coreData.getLoaderMgr().updateVisibleSlide(e,t)}},{key:"getSlideLayouts",value:function(){return this.coreData.getLayouts()}},{key:"setZoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1];this.doc.setZoom(e,t),this.fire(C.VIEW_EVENT_TYPES.ZOOM_CHANGE)}},{key:"resetZoom",value:function(){return this.doc.resetZoom&&this.doc.resetZoom()}},{key:"getZoom",value:function(){return this.doc.getZoom()}},{key:"resize",value:function(){var e;(e=this.doc).resize.apply(e,arguments),this.fire(C.VIEW_EVENT_TYPES.DOC_RESIZE)}},{key:"scrollLeftTo",value:function(e){this.doc.scrollLeftTo(e),this.fire(C.VIEW_EVENT_TYPES.DOC_RESIZE)}},{key:"scrollTopTo",value:function(e){this.doc.scrollTopTo(e),this.fire(C.VIEW_EVENT_TYPES.DOC_RESIZE)}},{key:"hitTest",value:function(e,t,i,n,r,a){var o,s=(o=this.doc).hitTest.apply(o,arguments);return window.event&&"mousedown"===window.event.type&&(this.curHitRet=s),s}},{key:"calcSlideAbsPos",value:function(e){return e&&this.doc.calcSlideAbsPos&&this.doc.calcSlideAbsPos(e)}},{key:"hitSelectObjectsByRect",value:function(e){return this.doc.hitSelectObjectsByRect(e)}},{key:"getSlideLayoutsByIndex",value:function(e){var t=this.getSlideLayouts(),i=t.getSlideCount(),n=void 0;if(i){i<=e&&(e=i);var r=t.getSlideAt(e);n=r&&r.getId()}return n}},{key:"getSlideLayoutsCount",value:function(){return this.getSlideLayouts().getSlideCount()}},{key:"getSlideLayoutsTypeLoader",value:function(){var e=this,t={progress:function(e){return this.progress_cb=e,this},then:function(e){return this.then_cb=e,this},exec:function(e){return this.exec_f=e,this},start:function(){var e=this;this.exec_f((function(t){e.then_cb&&e.then_cb(t)}),(function(e){}),(function(t){e.progress_cb&&e.progress_cb(t)}))}};return t.exec((function(t,i,n){var r=e.getSlideLayouts(),a=function(){for(var t=[],i=e.coreData.getMasters(),n=0;n<i.getSlideCount();n++){for(var a=i.getSlideIdxProxy(n),o=a&&a.followed||[],s=[],l=0;l<o.length;l++){var h=o[l]&&o[l].slideId,u=h&&r.getSlideById(h);s.push({id:h,name:u&&u.getName()})}t.push({index:n,id:a&&a.slideId,isDefault:0===n,layouts:s})}return t};if(r.getPendingBlocks().length<=0)t(a());else{n(a());var o=e.coreData.getLoaderMgr();o.setTopPriority(r);o.on(o.constructor.EventTypes.DATA_LOADED,(function e(i){i&&i.category===r.getCategory()&&(r.getPendingBlocks().length<=0?(t(a()),o.off(o.constructor.EventTypes.DATA_LOADED,e)):n(a()))}))}})),t}},{key:"renderSlideLayout",value:function(){var e;return this.slideLayoutView||(this.slideLayoutView=new ep(this.coreData)),(e=this.slideLayoutView).renderSlideLayout.apply(e,arguments)}},{key:"getShapeLayout",value:function(e){if(e&&e.isShape){var t=e.getId(),i=e.getSlideId(),n=this.getSlideView(i);if(n){var r=this.getShapeView(i,t),a=n.scale;if(r)return r.layout(a);var o=e.parent;return function(e){var t=e.parent,i=e.shapeData,n=e.isTopLayer;return i.isGroupShape()?new Wc({parent:t,shapeData:i,isTopLayer:n}):$u.isSupportRenderShape(i)||Ol.isFrontendMode?new Vc({parent:t,shapeData:i,isTopLayer:n}):new Uc({parent:t,shapeData:i,isTopLayer:n})}({parent:this.getShapeView(i,o.getId()),shapeData:e}).layout(a)}console.warn("slideView is null!cannot get shape layout!")}else console.warn("invalid  shapeData!!cannot get shape layout!")}},{key:"destroy",value:function(){this.coreData&&this.coreData.off(),this.selection&&this.selection.off()}},{key:"eventBind",value:function(){var e=this;this.coreData.on("modify",(function(t){e.dispatchModifyEvent(t),window.SlidePool.getInstance().reRender(t)})),this.coreData.on("notify_chart",(function(t){e.updateChart(t)})),this.coreData.on("error_readonly",(function(t){e.dispatchErrorReadonlyEvent(t)})),this.coreData.on("update_thumbnail",(function(t){e.bindUpdateTbEvent(t)})),this.coreData.on("modify_slide_container",this._onSlideContainerChange),this.coreData.on("error_core",(function(t){e.dispatchErrorCoreEvent(t)})),this.coreData.on(this.coreData.constructor.EventTypes.MULTI_SLIDE,(function(t){e.fire(C.VIEW_EVENT_TYPES.MULTI_SLIDE,t)})),this.coreData.on(this.coreData.constructor.EventTypes.MODIFY_PAGE_SETUP,this._onModifyPageSetup),this._regSelectionEvt(),this.coreData.on(this.coreData.constructor.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,(function(t,i){e.fire(C.VIEW_EVENT_TYPES.MODIFY_DOCUMENT_BEAUTIFY,t,i)}))}},{key:"dispatchErrorReadonlyEvent",value:function(e){this.fire(C.VIEW_EVENT_TYPES.ERROR_READONLY,e)}},{key:"dispatchErrorCoreEvent",value:function(e){this.fire(C.VIEW_EVENT_TYPES.ERROR_CORE,e)}},{key:"bindUpdateTbEvent",value:function(e){this.fireAsync(C.VIEW_EVENT_TYPES.THUMBNAIL_UPDATE,e);var t=e&&e.opvalue;if(t){var i=t.index,n=t.offset;Object.isEmpty(n)?this.updateSlidePageFooter(i):this.updateSlidePageFooter(Math.min(i,i+n),Math.max(i,i+n))}}},{key:"updateSlide",value:function(e){window.SlidePool.getInstance().reRender(e)}},{key:"getSlideSize",value:function(){return this.coreData.getSlideSize()}},{key:"updateSlidePageFooter",value:function(e,t){var i=this;t=t||this.coreData.getSlideCount();for(var n=e;n<t;n++){var r=this.coreData.getSlideAt(n);if(r){var a=r.getLayout(),o=a&&a.getFollowing();[r,a,o].forEach((function(e){var t=e&&e.fieldShapes;if(t&&t.length>0){var n={slideId:e.getId(),shapeIds:t.map((function(e){return e.id})),type:"hasShapeFocus"};i.updateSlide(n)}}))}}}},{key:"getAutoZoom",value:function(){return this.doc.getAutoZoom()}},{key:"updateChart",value:function(e){var t=this;if(e){this.chartUpdateEventMap||(this.chartUpdateEventMap={});var i=e.shapes;i&&i.forEach((function(e){var i=e.slideId,n=e.shapeId;t.chartUpdateEventMap[i+"_"+n]=e})),clearTimeout(this._updateChartTimer),this._updateChartTimer=setTimeout((function(){Object.values(t.chartUpdateEventMap).forEach((function(e){var t=e.slideId,i=e.shapeId;window.imagePool.deleteImage({slideId:t,shapeId:i,noNeedLoad:!0}),window.backendImageManager.fetchImageBySha1({slideId:t,shapeId:i,noNeedLoad:!0,cb:function(e,n,r){e?console.error("fetch image by sha1 err",e,window.backendImageManager.reqCnt):window.SlidePool.getInstance().reRender({slideId:t,shapeIds:[i]})}},e)})),t.chartUpdateEventMap={}}),300)}}},{key:"coreData",get:function(){return this.presData||console.warn(this.constructor.name,"presData is undefined"),this.presData}},{key:"selection",get:function(){return this.coreData&&this.coreData.getSelection()}}]),t}(x.a);tp.EVENT_TYPES=C.VIEW_EVENT_TYPES;var ip=tp,np=i(4957),rp=i.n(np),ap=i(4958),op=i.n(ap),sp=i(4959),lp=i.n(sp),hp=i(4960),up=i.n(hp),cp=new fd({slideStyle:{fillStyle:"#FFFFFF",shadowColor:"rgb(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,lineWidth:0,strokeStyle:"#CCCCCC"},canvasStyle:{fillStyle:"#000000"}});var dp=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.Snapshot},e)))}return u()(t,e),o()(t,[{key:"setStyle",value:function(){this.style=cp}},{key:"reRender",value:function(){}},{key:"genSlideImageSnapshot",value:function(e,t,i){var n=this,r=this.getSlideViewByIdx(e);if(r){var a=this.slideLayout(t,i);return this._renderManager||(this._renderManager=window.SlideRenderManager.getInstance()),new Promise((function(t,i){n._renderManager.addSlide({slide:r,idx:e,envLayout:a,callback:function(i){var n,r=i.finished,a=i.slideSvg,o=i.idx;if(r&&o===e){var s=new Image;s.onload=function(){t(s)},s.src=(n=a.outerHTML,"data:image/svg+xml; charset=utf8, "+encodeURIComponent(n.replace(/&nbsp/gi,"&#160")))}},lable:window.SlideRenderManager.ViewLable.SNAPSHOTVIEW}),n._renderManager.run()}))}}},{key:"genSlideSvgSnapshot",value:function(e,t,i){var n=this,r=this.getSlideViewByIdx(e);if(r){var a=this.slideLayout(t,i);return this._renderManager||(this._renderManager=window.SlideRenderManager.getInstance()),new Promise((function(t,i){var o=function(i){var n=i.finished,r=i.slideSvg,o=i.idx;if(n&&o===e){var s=a.svgLayout,l=s.width,h=s.height;l&&r.setAttribute("width",l),h&&r.setAttribute("height",h),t(r)}};r.isAllRenderFinish()&&r.ctx?o({finished:!0,slideSvg:r.ctx.getSvg(),idx:e}):(n._renderManager.addSlide({slide:r,idx:e,envLayout:a,callback:o,lable:window.SlideRenderManager.ViewLable.SNAPSHOTVIEW}),n._renderManager.run())}))}}},{key:"slideLayout",value:function(e,t){var i=this.slidePxSize,n=e,r=t;i.width/i.height>n/r?r=n*(i.height/i.width):n=r*(i.width/i.height);var a={x:(e-n)/2,y:(t-r)/2,width:n,height:r};return{viewBox:_()({x:0,y:0},i),svgLayout:a,scale:n/i.width,useComDefs:!1}}}]),t}(pd),pp=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.MasterView},e)))}return u()(t,e),o()(t,[{key:"getSlideCount",value:function(){return this.slidesLoader.getSlideCount()+this.coreData.getMasters().getSlideCount()}}]),t}(Vd);pp.mode=C.ViewModes.MasterView;var fp=pp,gp=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,_()({viewMode:C.ViewModes.MasterThumbnailView},e)))}return u()(t,e),o()(t,[{key:"renderSlides",value:function(e){for(var t=this,i=e.slideList,n=e.callback,r=$c.getInstance(),a=[],o=0;o<i.length;o++){var s=i[o],l=s.proxy,h=s.width,u=s.height;l&&function(){var e=t.getSlideViewByIdx(l),i=t.slideLayout(h,u);i.scale+=1e-4,a.push({slide:e,envLayout:i,lable:$c.ViewLable.THUMBNAIL,callback:function(r){n(_()({},r,{slide:e})),t.updateSvgViewBox(e,i)}})}()}r.setViewSlide(a),r.run()}},{key:"getSlideCount",value:function(){return this.coreData.getLayouts().getSlideCount()+this.coreData.getMasters().getSlideCount()}}]),t}(Gd),yp=i(502),vp={Chart:{id:-1,img:rp.a},Table:{id:-2,img:op.a},Picture:{id:-3,img:lp.a}},mp="b"===window.officeType,_p=function(e){function t(e){var i;r()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setDefaultImage=function(){var e=window.imagePool;if(e){Object.entries(vp).forEach((function(t){var i=f()(t,2);!function(t,i){var n=i.id,r=i.img;window["wppDefault"+t+"ImageId"]=n;var a=new Image;a.crossOrigin="anonymous",a.src=r,a.data_url=r,a.onload=function(){a.hasLoaded=!0},e.set("__"+n,{image:a,data:{}})}(i[0],i[1])}));var t=new Image;t.crossOrigin="anonymous",t.src=up.a,e.set("loading",{image:t,data:{}})}},n.setDefaultAudioImage=function(){var e=window,t=e.imagePool,i=e.APP.presentation.getPresetAudioIcons();for(var n in i){var r=i[n],a=new Image;a.crossOrigin="anonymous",a.src=yp.AudioIconUrlMap[n],a.data_url=yp.AudioIconUrlMap[n],a.hasLoaded=!0,a._logicWidth=168,a._logicHeight=168;var o=[void 0,void 0,r].join("_");t.set(o,{image:a,data:{}})}},n.stepToTriggerSeq=function(){var e;if(n.mode===C.ViewModes.PlayView)return(e=n.doc).stepToTriggerSeq.apply(e,arguments)},n.genSlideImageSnapshot=function(e){var t=e.idx,i=e.width,r=e.height;return n.snapshot.genSlideImageSnapshot(t,i,r)},n.genSlideSvgSnapshot=function(e){var t=e.idx,i=e.width,r=e.height;return n.snapshot.genSlideSvgSnapshot(t,i,r)},n.viewModeMap=(i={},d()(i,Ed.mode,Ed),d()(i,Vd.mode,Vd),d()(i,Md.mode,Md),d()(i,$d.mode,$d),d()(i,fp.mode,fp),i),n}return u()(t,e),o()(t,[{key:"init",value:function(e){this.destroy(),this.presData=e,this.clearCache(),this.setDefaultImage(),this.setDefaultAudioImage(),this._init(!0),this.eventBind()}},{key:"clearCache",value:function(){ed.getInstance().destroy();var e=window,t=e.imagePool,i=e.APP,n=e.imageEffectsPool;t&&t.destroy(),n&&n.destroy(),i&&i.wppColorManager&&i.wppColorManager.destroy(),window.backendImageManager&&window.backendImageManager.destroy()}},{key:"setMode",value:function(e){if(!(Object.values(C.ViewModes).indexOf(e)>-1))throw new Error("invalid mode!");e!==this.mode&&(y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setMode",this).call(this,e),this._init(),this.fire(t.EVENT_TYPES.MODE_CHANGE,e,!0))}},{key:"reRender",value:function(){this.doc&&this.doc.reRender()}},{key:"orientationChange",value:function(){this.doc&&this.mode===C.ViewModes.PreView&&this.doc.orientationChange()}},{key:"updateMediaDivStyle",value:function(){this.doc&&this.mode===C.ViewModes.PreView&&this.doc.updateMediaDivStyle()}},{key:"setActiveSlide",value:function(e){y()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setActiveSlide",this).call(this,e);var i=this.createNotesBody();i&&i.setActiveSlide(e),this.activeSlideIdx=e}},{key:"getActiveSlide",value:function(){return this.doc&&this.doc.activeSlide}},{key:"createNotesBody",value:function(){if(this.mode===C.ViewModes.EditView){var e=document.getElementById("notespage_container");if(e)if(window.domTools.getElementInnerSize(e).width>0){var t=this.coreData;return this.notesPage=this.notesPage||new Yd({coreData:t,$container:e,coreView:this}),this.notesPage}}}},{key:"rendNotesText",value:function(){var e=this.createNotesBody();e&&e.setActiveSlide(this.activeSlideIdx)}},{key:"_init",value:function(e){if(this.mode){if(!mp){this.notesPage&&this.notesPage.destroy(),this.notesPage=null,this.__snapshot&&this.__snapshot.destroy(),this.__snapshot=null,(this.mode===C.ViewModes.PlayView||e)&&(this.slideLayoutView&&this.slideLayoutView.destroy(),this.slideLayoutView=null);var t=this.mode!==C.ViewModes.MasterView?C.ViewModes.ThmubnailView:C.ViewModes.MasterThumbnailView;(this.__thumbnail&&this.__thumbnail.viewMode!==t||e)&&(this.__thumbnail&&this.__thumbnail.destroy(),this.__thumbnail=null),this.__miniThumbnailView&&this.__miniThumbnailView.destroy(),this.__miniThumbnailView=null}this.__doc&&this.__doc.destroy(),this.__doc=null}}},{key:"getSlideView",value:function(e,t){return this.doc.getSlideView(e,t)}},{key:"getShapeView",value:function(e,t){var i=this.getSlideView(e);return i&&i.getShape(t)}},{key:"playTriggerAnim",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).playTriggerAnim.apply(e,arguments)}},{key:"stepForward",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).stepForward.apply(e,arguments)}},{key:"stepBackward",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).stepBackward.apply(e,arguments)}},{key:"stepTo",value:function(e,t,i,n){if(this.mode===C.ViewModes.PlayView)return this.coreData&&this.coreData.getLoaderMgr().updateActiveSlide(e),this.doc.stepTo(e,t,i,n)}},{key:"getPlayInfo",value:function(){if(this.mode===C.ViewModes.PlayView)return this.doc.getPlayInfo()}},{key:"setAutoPlay",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).setAutoPlay.apply(e,arguments)}},{key:"play",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).play.apply(e,arguments)}},{key:"startPreview",value:function(e,t,i){return this.doc.startPreview(e,t,i)}},{key:"isSupportEffect",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.isSupportEffect(e)}},{key:"genMiniSlideThumbnail",value:function(){var e;(e=this.miniThumbnail).renderSlides.apply(e,arguments)}},{key:"genSlideThumbnail",value:function(){var e;(e=this.thumbnail).renderSlides.apply(e,arguments)}},{key:"setSvgRootView",value:function(e){this.doc&&this.doc.setSvgRootView(e)}},{key:"changeMediaPlay",value:function(e){return this.doc.changeMediaPlay(e)}},{key:"insertNodeAfterShapeById",value:function(){var e;if(this.mode===C.ViewModes.PlayView)return(e=this.doc).insertNodeAfterShapeById.apply(e,arguments)}},{key:"setRemarkView",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.setRemarkView(e)}},{key:"setRemarkWin",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.setRemarkWin(e)}},{key:"setExplainType",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.setExplainType(e)}},{key:"getExplainPlayer",value:function(){if(this.mode===C.ViewModes.PlayView)return this.doc.getExplainPlayer()}},{key:"getAutoplayPlayer",value:function(){if(this.mode===C.ViewModes.PlayView)return this.doc.getAutoplayPlayer()}},{key:"setAutoPlayPlayer",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.setAutoPlayPlayer(e)}},{key:"setPlayExplain",value:function(e){if(this.mode===C.ViewModes.PlayView)return this.doc.setPlayExplain(e)}},{key:"isPlayExplain",value:function(){return this.mode===C.ViewModes.PlayView&&this.doc.isPlayExplain()}},{key:"getShapeCurrentRect",value:function(e,t){if(this.mode===C.ViewModes.PlayView)return this.doc.getShapeCurrentRect(e,t)}},{key:"getInterSeqSteps",value:function(e,t){if(this.mode===C.ViewModes.PlayView)return this.doc.getInterSeqSteps(e,t)}},{key:"updateViewportSize",value:function(){this.mode===C.ViewModes.PlayView&&this.doc.updateViewportSize()}},{key:"doc",get:function(){var e=this,i=this.viewModeMap[this.mode];return this.__doc||(this.__doc=new i({coreData:this.coreData,$container:this.$container,coreView:this}),this.__doc.onSlideRendered=function(i){var n=[Vd.mode,Md.mode];window.APP.firRenderEnd||!mp&&n.includes(e.mode)||window.APP.handleFirRenderDone(),e.fire(t.EVENT_TYPES.DOC_CHANGE,i)}),this.__doc}},{key:"thumbnail",get:function(){var e=this;if(!this.__thumbnail){var i=this.mode!==C.ViewModes.MasterView?Gd:gp;this.__thumbnail=new i({coreData:this.coreData,$container:this.$container,coreView:this}),this.__thumbnail.onSlideRendered=function(i){e.fire(t.EVENT_TYPES.THUMBNAIL_DOC_CHANGE,i)}}return this.__thumbnail}},{key:"miniThumbnail",get:function(){var e=this;return this.__miniThumbnailView||(this.__miniThumbnailView=new Gd({coreData:this.coreData,$container:this.$container,coreView:this}),this.__miniThumbnailView.onSlideRendered=function(i){e.fire(t.EVENT_TYPES.THUMBNAIL_DOC_CHANGE,i)}),this.__miniThumbnailView}},{key:"snapshot",get:function(){return this.__snapshot=this.__snapshot||new dp({coreData:this.coreData,$container:this.$container,coreView:this}),this.__snapshot}},{key:"isRemarkView",get:function(){return this.mode===C.ViewModes.PlayView&&this.doc.isRemarkView}},{key:"isRemarkWin",get:function(){return this.mode===C.ViewModes.PlayView&&this.doc.isRemarkWin}},{key:"explainType",get:function(){return this.mode===C.ViewModes.PlayView?this.doc.explainType:null}},{key:"isAutoPlay",get:function(){return this.mode===C.ViewModes.PlayView?!!this.doc.autoplayPlayer:null}}]),t}(ip),wp=i(2269),Sp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.setRemarkWinMsg=function(e){var t="remark-win-"+i.app.fileId;window.sessionStorage&&window.sessionStorage.setItem(t,JSON.stringify({value:e})),i.fire(C.VIEW_EVENT_TYPES.REMARK_AUDIENCE_VIEW_OPENED,e)},i.getRemarkWinMsg=function(){var e="remark-win-"+i.app.fileId,t=window.sessionStorage&&window.sessionStorage.getItem(e);return(t?JSON.parse(t):{}).value},i.playAnimation=function(e){i.fire(C.VIEW_EVENT_TYPES.PREVIEW_ANIMATION,e)},i.setAutoForceRotate=function(e){i.fire(C.VIEW_EVENT_TYPES.SET_AUTO_FORECE_ROTATE,e)},i.app=e,i.session=e.session,i}var i;return u()(t,e),o()(t,[{key:"init",value:function(){var e=this;if(this._coreView&&this._coreView.off(),this._coreView=this.coreView,this._coreView){this.fire(C.VIEW_EVENT_TYPES.DOC_INIT),this._coreView.on(C.VIEW_EVENT_TYPES.MODIFY,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MODIFY].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.DOC_CHANGE,(function(t){var i=e.getActiveSlide();i&&t.slideId!==i.getId()||(window.APP.firRenderEnd?e.fireAsync(C.VIEW_EVENT_TYPES.ACTIVE_SLIDE_CHANGE,t):e.fire(C.VIEW_EVENT_TYPES.ACTIVE_SLIDE_CHANGE,t),e._hasSelChange&&(e.fire(C.VIEW_EVENT_TYPES.SELECT_SHAPE_CHANGE,t),e._hasSelChange=!1),e._selSlideChangeData&&(e.fire(C.VIEW_EVENT_TYPES.SLIDE_CHANGE_DONE,t),e._selSlideChangeData=null)),window.APP.firRenderEnd?e.fireAsync(C.VIEW_EVENT_TYPES.DOC_CHANGE,t):e.fire(C.VIEW_EVENT_TYPES.DOC_CHANGE,t),e.updateSvgLayout(t)})),this._slideSize=this.app.presentation.getSlideSize(),this._coreView.on(C.VIEW_EVENT_TYPES.ERROR_READONLY,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.ERROR_READONLY].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.THUMBNAIL_DOC_CHANGE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.THUMBNAIL_DOC_CHANGE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.THUMBNAIL_UPDATE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.THUMBNAIL_UPDATE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.PLAYER_EVENT,(function(t){e._animePlayer=t.animePlayer,t.animePlayer=null,e.fire(C.VIEW_EVENT_TYPES.PLAYER_EVENT,t)})),this._coreView.on(C.VIEW_EVENT_TYPES.DOC_RESIZE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.DOC_RESIZE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.MODE_CHANGE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MODE_CHANGE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.MULTI_SLIDE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MULTI_SLIDE].concat(i))}));var t=this.getSlideLayouts();this.layoutsLoaded=t&&t.isAllLoaded(),this.slideLayoutsListener.on(C.VIEW_EVENT_TYPES.DOC_LAYOUTS_LOADED,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.DOC_LAYOUTS_LOADED].concat(i)),e.layoutsLoaded=!0})),this._coreView.on(C.VIEW_EVENT_TYPES.ZOOM_CHANGE,(function(t){e.fire(C.VIEW_EVENT_TYPES.ZOOM_CHANGE,t)})),this._coreView.on(C.VIEW_EVENT_TYPES.SELECT_SHAPE_CHANGE,(function(){e._hasSelChange=!0})),this._coreView.on(C.VIEW_EVENT_TYPES.SELECT_SLIDE_CHANGE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.SELECT_SLIDE_CHANGE].concat(i)),e._selSlideChangeData=i})),this._coreView.on(C.VIEW_EVENT_TYPES.ERROR_CORE,(function(){window.__CONFIG__.wpp.isEnableCmdExceptionReload&&e.reduxDispatch(Object(wp.setCommonVar)(d()({},wp.coNames.isCoreError,!0)))})),this.cooperInfoMap={},this.selectionsMgr.on(this.selectionsMgr.constructor.EventTypes.SLIDE_SELECT_CHANGE,(function(t){t.selectionsList.filter((function(e){return!e.isLocal})).map((function(t){t.isLocal||(e.cooperInfoMap[t.getUid()]=t)})),e.fire(C.VIEW_EVENT_TYPES.COOPER_SELECTION_CHANGE,t)}));var i=this.app.presentation.getLoaderMgr();i.on(i.constructor.EventTypes.DATA_COMPLETED,(function(){e.fire(C.VIEW_EVENT_TYPES.SLIDE_CORE_DATA_COMPLETED)})),this._coreView.on(C.VIEW_EVENT_TYPES.MASTER_SLIDE_CHANGE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MASTER_SLIDE_CHANGE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.EXPLAIN_PLAYER_INIT_DONE,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.EXPLAIN_PLAYER_INIT_DONE].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.MODIFY_PAGE_SETUP,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MODIFY_PAGE_SETUP].concat(i))})),this._coreView.on(C.VIEW_EVENT_TYPES.MODIFY_DOCUMENT_BEAUTIFY,(function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];e.fire.apply(e,[C.VIEW_EVENT_TYPES.MODIFY_DOCUMENT_BEAUTIFY].concat(i))}))}else console.trace()}},{key:"getEffectNodeDurationByStep",value:function(e){var t=e.slideId,i=e.step,n=e.needCalcMediaDur;if(!t){var r=this.getActiveSlide();t=r&&r.getId()}return this.animePlayer&&this.animePlayer.getEffectNodeDurationByStep(t,i,n)}},{key:"getLayoutsLoadedStatus",value:function(){return this.layoutsLoaded}},{key:"getSlideLayoutsByIndex",value:function(e){return this.coreView.getSlideLayoutsByIndex(e)}},{key:"getSlideLayoutsTypeLoader",value:function(){return this.coreView.getSlideLayoutsTypeLoader()}},{key:"getSlideLayoutsCount",value:function(){return this.coreView.getSlideLayoutsCount()}},{key:"renderSlideLayout",value:function(){var e;return(e=this.coreView).renderSlideLayout.apply(e,arguments)}},{key:"getSlideLayouts",value:function(){return this.coreView.getSlideLayouts()}},{key:"genSlideImageSnapshot",value:function(){var e;return(e=this.coreView).genSlideImageSnapshot.apply(e,arguments)}},{key:"genSlideSvgSnapshot",value:function(){var e;return(e=this.coreView).genSlideSvgSnapshot.apply(e,arguments)}},{key:"genThumbnail",value:function(){var e;return(e=this.coreView).genSlideThumbnail.apply(e,arguments)}},{key:"genMiniThumbnail",value:function(){var e;return(e=this.coreView).genMiniSlideThumbnail.apply(e,arguments)}},{key:"getThumbnailSize",value:function(){return this.coreView.getSlideSize()}},{key:"getProxyIdByIdx",value:function(e){return this.coreView.getProxyIdByIdx(e)}},{key:"getSlideIdxProxy",value:function(e){return this.coreView.getSlideIdxProxy(e)}},{key:"getIndexBySlideId",value:function(e){return this.coreView.getIndexBySlideId(e)}},{key:"getSlideCount",value:function(){var e=this.coreView.__thumbnail;return e?e.getSlideCount():this.workspace.getSelection().getSlideCount()}},{key:"getSlideById",value:function(e){return this.app.presentation&&this.app.presentation.getSlideById(e)}},{key:"rendNotesText",value:function(e){return this.coreView.rendNotesText(e)}},{key:"getScale",value:function(){return this.coreView.getScale()}},{key:"setZoom",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.coreView.setZoom(e,t,i)}},{key:"getZoom",value:function(){return this.coreView.getZoom()}},{key:"getAutoZoom",value:function(){return this.coreView.getAutoZoom()}},{key:"getMode",value:function(){return this.coreView.getMode()}},{key:"setMode",value:function(e){this.coreView.setMode(e),this.app.storeReaderInfo()}},{key:"getFirstVisibleSlideIndex",value:function(){return this.coreView.doc.getFirstVisibleSlideIndex()}},{key:"setActiveSlide",value:function(e){if(!Object.isEmpty(e)){if(this.fire(C.VIEW_EVENT_TYPES.SET_ACTIVE_SLIDE),!e.isSlideIdxProxy&&this.getMode()===C.ViewModes.MasterView)return!1;var t=this.coreView.setActiveSlide(e);this.app.storeReaderInfo(),-1===t&&this.fire(C.VIEW_EVENT_TYPES.ON_PREVIEW_LIMIT)}}},{key:"setActiveSlideByData",value:function(e){this.fire(C.VIEW_EVENT_TYPES.SET_ACTIVE_SLIDE),this.coreView.setActiveSlideByData(e)}},{key:"setVisibleSlide",value:function(e,t){this.coreView.setVisibleSlide(e,t)}},{key:"getActiveSlide",value:function(){return this.coreView.getActiveSlide()}},{key:"getActiveSlideIdx",value:function(){return this.coreView.activeSlideIdx}},{key:"getActiveShapeViews",value:function(e){var t=this;e||(e=this.getLocalSelection().getActiveShapes());return e&&e.map((function(e){return t.getShapeInActiveSlide(e.getId())}))||[]}},{key:"getLocalSelection",value:function(){return this.selection}},{key:"haveShapeSelected",value:function(){var e=this.getLocalSelection();if(e){var t=e.getActiveShapes();return t&&t.length>0}return!1}},{key:"clearShapeSelect",value:function(){var e=this.getLocalSelection();e&&e.clearShapeSelect()}},{key:"resize",value:function(){var e;(e=this.coreView).resize.apply(e,arguments)}},{key:"getSlideAt",value:function(e){return this.workspace&&this.workspace.presentation.getSlides().getSlideAt(e)}},{key:"stepForward",value:function(){var e;return(e=this.coreView).stepForward.apply(e,arguments)}},{key:"stepBackward",value:function(){var e;return(e=this.coreView).stepBackward.apply(e,arguments)}},{key:"stepTo",value:function(e,t,i,n){return this.coreView.stepTo(e,t,i,n)}},{key:"playTriggerAnim",value:function(){var e;return(e=this.coreView).playTriggerAnim.apply(e,arguments)}},{key:"stepToTriggerSeq",value:function(){var e;return(e=this.coreView).stepToTriggerSeq.apply(e,arguments)}},{key:"getPlayInfo",value:function(){return this.coreView.getPlayInfo()}},{key:"syncByPlayInfo",value:(i=st()(regeneratorRuntime.mark((function e(t){var i,n,r,a,o,s,l,h,u,c,d=this,p=t.action,f=t.slideIndex,g=t.animateIndex,y=void 0===g?-1:g,v=t.skipTransition,m=void 0===v||v,_=t.allInterSeqSteps,w=void 0===_?[]:_,S=t.slideCategory,x=t.steps,T=t.targetShapeId;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getActiveSlideIdx(),(n=this.getMode())===C.ViewModes.PlayView){e.next=8;break}if(n!==C.ViewModes.PreView){e.next=6;break}return window.switchPageTo(n,f),e.abrupt("return");case 6:return i!==f&&this.setActiveSlide(f),e.abrupt("return");case 8:if(r=this.getPlayInfo(),a=r.animateIndex,o=r.allInterSeqSteps,s=i===f&&a-y==1||i+1===f&&(-1===y||0===y),l=i===f&&y-a==1,p){e.next=26;break}if(!s){e.next=17;break}return e.next=15,this.stepForward();case 15:e.next=24;break;case 17:if(!l){e.next=22;break}return e.next=20,this.stepBackward();case 20:e.next=24;break;case 22:return e.next=24,this.stepTo(f,y,m);case 24:e.next=54;break;case 26:if("trigger"!==p){e.next=38;break}if(!(h=o.find((function(e){return e.targetShapeId===T&&e.slideCategory===S})))){e.next=37;break}if(u=h.animateStepsAmount,x!==h.steps+1&&(h.steps!==u-1||0!==x)){e.next=35;break}return e.next=33,this.playTriggerAnim(T,S);case 33:e.next=37;break;case 35:return e.next=37,this.stepToTriggerSeq(T,S,x);case 37:return e.abrupt("return");case 38:if(!Object.isEmpty(f)&&!Object.isEmpty(y)){e.next=41;break}return console.warn("param wrong"),e.abrupt("return");case 41:if("forward"!==p){e.next=46;break}return e.next=44,this.stepForward();case 44:e.next=54;break;case 46:if("backward"!==p){e.next=51;break}return e.next=49,this.stepBackward();case 49:e.next=54;break;case 51:if("switchTo"!==p){e.next=54;break}return e.next=54,this.stepTo(f,y,m);case 54:if(c=this.getPlayInfo(),!(f&&y&&c.slideIndex!==f||c.animateIndex!==y)){e.next=58;break}return e.next=58,this.stepTo(f,y,m);case 58:w.forEach((function(e,t){var n=e.targetShapeId,r=e.slideCategory,a=e.steps,s=o[t];if(s){var l=s.steps;if(i===f){if(a===l)return;if(a===l+1)return void d.playTriggerAnim(n,r)}d.stepToTriggerSeq(n,r,a)}}));case 59:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setAutoPlay",value:function(){var e;return(e=this.coreView).setAutoPlay.apply(e,arguments)}},{key:"onEffectPlayFinished",value:function(){return this.coreView.onEffectPlayFinished()}},{key:"play",value:function(){var e;return(e=this.coreView).play.apply(e,arguments)}},{key:"startPreview",value:function(e,t,i){return this.coreView.startPreview(e,t,i)}},{key:"getShapeInActiveSlide",value:function(e){return this.coreView.doc.activeSlide&&this.coreView.doc.activeSlide.getShape(e)}},{key:"getLayout",value:function(){var e;return(e=this.coreView.doc).slideLayout.apply(e,arguments)}},{key:"hasPlayer",value:function(){if(this.getMode()===C.ViewModes.PlayView)return this.coreView.doc&&this.coreView.doc.hasPlayer()}},{key:"changeMediaPlay",value:function(e){return this.coreView.changeMediaPlay(e)}},{key:"getSlideViewByIdx",value:function(e){return this.coreView.doc.getSlideViewByIdx(e)}},{key:"fireMediaChange",value:function(e){e?this.fire(C.VIEW_EVENT_TYPES.MEDIA_PLAY_CHANGE,e):console.error("fireMediaChange error: Invalid argument")}},{key:"changeMediaVisible",value:function(e){e.id||(e.id=e.slideId+"_"+e.shapeId),this.fire(C.VIEW_EVENT_TYPES.MEDIA_VISIBLE_CHANGE,e)}},{key:"changeMediaStyle",value:function(e){e.id||(e.id=e.slideId+"_"+e.shapeId),this.fire(C.VIEW_EVENT_TYPES.MEDIA_STYLE_CHANGE,e)}},{key:"getMediaUploadId",value:function(e){return this.workspace&&this.workspace.presentation.getMediaUploadId(e)}},{key:"getImageUploadId",value:function(e){return this.workspace&&this.workspace.presentation.getUploadId(e)}},{key:"insertNodeAfterShapeById",value:function(e,t,i){return this.coreView.insertNodeAfterShapeById(e,t,i)}},{key:"setShadowBlur",value:function(e){return this.coreView.doc.setShadowBlur(e)}},{key:"setSvgRootView",value:function(e){this.coreView.doc.setSvgRootView(e),this.fire(C.VIEW_EVENT_TYPES.SVG_ROOT_VIEW_CHANGE,e)}},{key:"setUsersColor",value:function(e){var t=this;e instanceof Array&&(this._cooperUsesColor={},e.forEach((function(e){t._cooperUsesColor[e.userId]=e})))}},{key:"setRemarkView",value:function(e){this.coreView.setRemarkView(e),this.app.storeReaderInfo()}},{key:"setExplainType",value:function(e){this.coreView.setExplainType(e),this.app.storeReaderInfo()}},{key:"getExplainPlayer",value:function(){return this.coreView.getExplainPlayer()}},{key:"getAutoplayPlayer",value:function(){return this.coreView.getAutoplayPlayer()}},{key:"setAutoPlayPlayer",value:function(e){return this.coreView.setAutoPlayPlayer(e)}},{key:"setRemarkWin",value:function(e){this.coreView.setRemarkWin(e)}},{key:"getSvgClientRect",value:function(e){return this.coreView.doc.getSvgClientRect(e)}},{key:"getSvgRealClientRect",value:function(e){return this.coreView.doc.getSvgRealClientRect&&this.coreView.doc.getSvgRealClientRect(e)}},{key:"jumpToUser",value:function(e){var t=this.cooperInfoMap[e];if(t){var i=t.getActiveSlideIdx();-1!==i&&this.setActiveSlide(i)}}},{key:"destroyVideoBySlideId",value:function(e){this.fire(C.VIEW_EVENT_TYPES.DESTROY_SLIDE_VIDEO,e)}},{key:"isSupportEffect",value:function(e){return this.coreView.isSupportEffect(e)}},{key:"getShapeCurrentRect",value:function(e,t){return this.coreView.getShapeCurrentRect(e,t)}},{key:"getInterSeqSteps",value:function(e,t){return this.coreView.getInterSeqSteps(e,t)}},{key:"reduxDispatch",value:function(){var e;return(e=window.__WPSENV__).reduxDispatch.apply(e,arguments)}},{key:"updateSvgLayout",value:function(e){var t=e.slideId,i=this.getMode(),n=this.app.presentation.getSlideSize();if(this._slideSize.width===n.width&&this._slideSize.heigth===n.heigth)return!1;this._slideSize=n,i!==C.ViewModes.EditView&&i!==C.ViewModes.MasterView&&i!==C.ViewModes.Review||this.coreView.doc.updateSvgLayout(t)}},{key:"workspace",get:function(){return this.app.workspace}},{key:"selectionsMgr",get:function(){return this.workspace&&this.workspace.getSelectionsMgr()}},{key:"coreView",get:function(){return this.workspace&&this.workspace.core.view}},{key:"animePlayer",get:function(){return this._animePlayer}},{key:"slideLayoutsListener",get:function(){var e=this.getSlideLayouts();return e&&e.listener}},{key:"selection",get:function(){return this.workspace.getSelection()}},{key:"svgLayout",get:function(){var e=this.coreView.doc.layoutResult,t=e.svgLayout,i=e.bestZoom,n=e.scale;return _()({},t,{bestZoom:i,scale:n})}},{key:"slidePxSize",get:function(){return this.coreView.doc.slidePxSize}},{key:"customUsersColor",get:function(){return this._cooperUsesColor}},{key:"isRemarkView",get:function(){return this.coreView.isRemarkView}},{key:"explainType",get:function(){return this.coreView.explainType}},{key:"isAutoPlay",get:function(){return this.coreView.isAutoPlay}},{key:"isRemarkWin",get:function(){return this.coreView.isRemarkWin}}]),t}(x.a);Sp.EVENT_TYPES=C.VIEW_EVENT_TYPES;var xp=Sp,Tp=i(523),kp=i(940),Cp=function(){function e(t){r()(this,e),this.model=t}return o()(e,[{key:"exec",value:function(e){return!!this.model.isEnable()&&this[e.name](e.param)}},{key:"formatOp",value:function(e){}}]),e}(),bp=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),o()(t,[{key:"formatOp",value:function(e){switch(e.opType){case Tp.FormatOpType.Font_Bold:return this.setBold(e);case Tp.FormatOpType.Font_Italic:return this.setItalic(e);case Tp.FormatOpType.Font_Underline:return this.setUnderline(e);case Tp.FormatOpType.Font_StrikeThrough:return this.setStrikeThrough(e);case Tp.FormatOpType.Font_FontSize:return this.setSize(e);case Tp.FormatOpType.Font_GrowUp:return this.growUp(e);case Tp.FormatOpType.Font_Superscript:return this.setSuperscript(e);case Tp.FormatOpType.Font_Subscript:return this.setSubscript(e);case Tp.FormatOpType.Font_Name:return this.setName(e);case Tp.FormatOpType.Font_Color:return this.setColor(e);case Tp.FormatOpType.Font_AllCaps:return this.setAllCaps(e);case Tp.FormatOpType.Font_SmallCaps:return this.setSmallCaps(e);case Tp.FormatOpType.Font_DoubleStrikeThrough:return this.setDoubleStrikeThrough(e);case Tp.FormatOpType.Font_EmphasisMark:return this.setEmphasisMark(e);case Tp.FormatOpType.Font_Hidden:return this.setHidden(e);case Tp.FormatOpType.Font_Scaling:return this.setScaling(e);case Tp.FormatOpType.Font_Spacing:return this.setSpacing(e);case Tp.FormatOpType.Font_HighlightColor:return this.setHighlightColor(e);case Tp.FormatOpType.Font_Actions:return this.setActions(e)}}},{key:"setChpx",value:function(e,t,i){e.len<=0||e.pos;for(var n={},r=0;r<t.length;r++)n[t[r]]=i[r];return this.model._setChapterAttrs(n),!0}},{key:"setBold",value:function(e){var t=[e.value,e.value];return this.setChpx(e,["bold","bold_cs"],t)}},{key:"setItalic",value:function(e){var t=[e.value,e.value];return this.setChpx(e,["italic","italic_cs"],t)}},{key:"setUnderline",value:function(e){var t=[],i=[];return function(e,t,i,n){e!==Tp.UnderlineType.wpsUnderlineNone?(i.push("underline"),n.push(Tp.UnderlineMode.Normal),i.push("underlineType"),n.push(e),void 0!==t&&(i.push("underline_color"),n.push(function(e){var t=e.toString(16),i=t.substring(t.length>6?t.length-6:0);i.length<6&&(i=(Array(6).join(0)+i).slice(-6));return"#"+i}(t)))):(i.push("underline"),n.push(Tp.UnderlineMode.None),i.push("underlineType"),n.push(Tp.UnderlineMode.None))}(e.underlineType,e.underlineColor,t,i),this.setChpx(e,t,i)}},{key:"setStrikeThrough",value:function(e){var t=["strikeThrough"],i=[e.value?1:0];return function(e,t,i){t.push("strikeThrough"),i.push(e),i.push(e?1:0)}(e.value,t,i),this.setChpx(e,t,i)}},{key:"setSuperscript",value:function(e){var t=[e.value?e.value:0];window.APP.coreAPI.beginCommand(this),window.getTransaction().setUserData("fontScript","superscript");var i=this.setChpx(e,["position"],t);return window.APP.coreAPI.endCommand(),i}},{key:"setSubscript",value:function(e){var t=[e.value?e.value:0];window.APP.coreAPI.beginCommand(this),window.getTransaction().setUserData("fontScript","subscript");var i=this.setChpx(e,["position"],t);return window.APP.coreAPI.endCommand(),i}},{key:"setName",value:function(e){var t=[{name:e.value},{name:e.value},{name:e.value},{name:e.value}];return this.setChpx(e,["fontNameAscii","fontNameAsiaEast","fontNameSymbol","fontNameComplex"],t)}},{key:"setColor",value:function(e){var t=[],i=[];Ep("rgb",e.value,t,i),t=["textColor"];var n=i[0].replace("#","#FF");return i=[{color:window.CoreTypes.Color.fromString(n).data,type:Tp.FillType.FillTypeSolidColor}],this.setChpx(e,t,i)}},{key:"setHighlightColor",value:function(e){var t=[],i=[];if(-16777216===e.value)t.push("hightLightColor"),i=[{cancelHightLight:!0}];else{Ep("hightLightColor",e.value,t,i);var n=i[0].replace("#","#FF");i=[{color:window.CoreTypes.Color.fromString(n).data,type:Tp.FillType.FillTypeSolidColor}]}return this.setChpx(e,t,i)}},{key:"setSize",value:function(e){var t=[e.value.fontSize,e.value.fontSize,e.value.autoFit];return this.setChpx(e,["fontSize","font_size_cs","autoFit"],t)}},{key:"setSpacing",value:function(e){var t=[Math.round(100*e.value)];return this.setChpx(e,["spacing"],t)}},{key:"growUp",value:function(e){var t=this;e&&(this.model.beginTransact(),e.forEach((function(e){var i=e.fontSize,n=e.autoFit,r=e.range,a=e.isGrowUp,o=e.textFrame;t.model.cmdFmtChpx({fontSize:i,autoFit:n,isGrowUp:a},r.gcp,r.ccp,o)})),this.model.commit())}},{key:"setActions",value:function(e){var t=[e.value];return this.setChpx(e,["actions"],t)}}]),t}(Cp);function Ep(e,t,i,n){i.push(e);var r=t.toString(16),a=r.substring(r.length>6?r.length-6:0);a.length<6&&(a=(Array(6).join(0)+a).slice(-6)),n.push("#"+a)}var Rp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.cmdExec=new bp(i),i}return u()(t,e),o()(t,[{key:"_setProp",value:function(e,t){if(!this.updateInsertPointChpx(e,t)){var i=this.getNormalRange(),n={name:"formatOp",param:{pos:i.pos,len:i.len,opType:e,value:t,rgs:this.getNormalRanges()}};this.cmdExec.exec(n)&&this.onCmdExec(n)}}},{key:"getBold",value:function(){var e=this.getChpx();return e&&!!e.bold}},{key:"setBold",value:function(e){this._setProp(Tp.FormatOpType.Font_Bold,e)}},{key:"getItalic",value:function(){var e=this.getChpx();return e&&!!e.italic}},{key:"setItalic",value:function(e){this._setProp(Tp.FormatOpType.Font_Italic,e)}},{key:"getUnderline",value:function(){var e=this.getChpx();if(void 0!==e){var t=e.underlineType,i=e.underlineFill,n=e.color;if(void 0!==t&&t===Tp.UnderlineMode.Normal)return i&&(n=i.font&&i.font.color.rgba||n),{underlineType:e.underlineType,underlineColor:n}}}},{key:"setUnderline",value:function(e,t){if(!t){var i=this.getUnderline();i&&(t=i.underlineColor)}if(!this.updateInsertPointChpx(Tp.FormatOpType.Font_Underline,e,t)){var n=this.getNormalRange(),r=void 0;void 0!==t&&(r=parseInt(t.substring(1),16));var a={name:"formatOp",param:{pos:n.pos,len:n.len,opType:Tp.FormatOpType.Font_Underline,underlineType:e,underlineColor:r,rgs:this.getNormalRanges()}};this.cmdExec.exec(a)&&this.onCmdExec()}}},{key:"getStrikeThrough",value:function(){var e=this.getChpx();return e&&e.strikeThrough}},{key:"setStrikeThrough",value:function(e){this._setProp(Tp.FormatOpType.Font_StrikeThrough,e)}},{key:"getSize",value:function(){var e=this.getCoreSize();if(e){var t=this.getFontScale();return Math.round(e*t)}}},{key:"getCoreSize",value:function(){var e=this.getChpx();if(void 0!==e&&void 0!==e.fontSize)return Math.round(e.fontSize/20)}},{key:"setSize",value:function(e){this.checkIfNeedtransAutoFit()&&this.editor.shape.setAutoFit(0);e&&(e.fontSize*=20),this._setProp(Tp.FormatOpType.Font_FontSize,e),this.editor.setForbiddenScrollTime(performance.now()),this.isMasterView&&window.collection("newui","value",window.pcTrack.newui.masterview_fontsize)}},{key:"getSuperscript",value:function(){var e=this.getChpx();return void 0!==e&&void 0!==e.position&&e.position>0}},{key:"setSuperscript",value:function(e){this._setProp(Tp.FormatOpType.Font_Superscript,e)}},{key:"getSubscript",value:function(){var e=this.getChpx();return void 0!==e&&void 0!==e.position&&e.position<0}},{key:"setSubscript",value:function(e){this._setProp(Tp.FormatOpType.Font_Subscript,e)}},{key:"getScript",value:function(){var e=this.getChpx();return e&&e.position}},{key:"getFontList",value:function(){var e=this.getChpx();if(void 0!==e&&void 0!==e.fontList)return e.fontList}},{key:"getFontListMap",value:function(){var e=this.getBodyStyle();if(void 0!==e&&void 0!==e.fontListMap)return e.fontListMap}},{key:"checkIfNeedtransAutoFit",value:function(){var e=this.getAutoFit();if(e&&1!==e)return!1;var t=this.getLocalSelection(),i=t.state===Tp.SelectType.select_text,n=t.getActiveTextStream(),r=n&&n.getCharCount(),a=t.getRange(),o=0===a.begin&&a.end===r-1&&0!==a.end;return!(i&&!o)}},{key:"growUp",value:function(e){if(void 0!==this.getChpx()){var t=this.getCoreSize(),i=this.getAutoFit();if(this.checkIfNeedtransAutoFit()&&this.editor.shape.setAutoFit(0),isNaN(t)){var n=this.getFontListMap();if(n&&0!==n.length){for(var r=[],a=0;a<n.length;a++){var o=n[a],s=o.fontList,l=o.textFrame,h=this.diffFontGrowUp(e,s,l);h&&r.push.apply(r,S()(h))}r.length&&this.cmdExec.growUp(r)}else{var u=this.getFontList(),c=this.diffFontGrowUp(e,u);c.length&&this.cmdExec.growUp(c)}}else{if(e?(t=Ip(t))>4e3&&(t=4e3):(t=Lp(t))<1&&(t=1),t===this.getCoreSize())return;this.setSize({fontSize:t,autoFit:i})}}}},{key:"diffFontGrowUp",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t&&0!==t.length){for(var n=this.getNormalRange(),r=n.pos,a=0,o=0,s=Math.round(t[0].fontSize/20),l=void 0,h=t.length,u=0;u<h;u++){l=l||[];var c=Math.round(t[u].fontSize/20);if(s!==c){var d=s;(d=e?Ip(s):Lp(s))<8&&(d=8);var p=Math.round(20*d),f=u-a;l.push({fontSize:p,autoFit:o,range:{gcp:i?a:a+r,ccp:f},isGrowUp:e,textFrame:i}),a=u,s=c}if(u===t.length-1){var g=s=c;(g=e?Ip(s):Lp(s))<8&&(g=8);var y=Math.round(20*g),v=u-a+1;l.push({fontSize:y,autoFit:o,range:{gcp:i?a:a+r,ccp:v},isGrowUp:e,textFrame:i})}}return l}return[]}},{key:"getName",value:function(){return this.getChpx().fontFamily}},{key:"setName",value:function(e){this._setProp(Tp.FormatOpType.Font_Name,e)}},{key:"getColor",value:function(){var e=this.getChpx();if(void 0!==e&&void 0!==e.color)return this.rgbaToHex(e.color)}},{key:"rgbaToHex",value:function(e){if(-1!==e.indexOf("#"))return e;var t=e.substring(e.indexOf("(")+1,e.length-1).split(",").map((function(e){return parseInt(e).toString(16)}));return t.reduce((function(e,i,n){return i=1===i.length?"0"+i:i,n<t.length-1?""+e+i:e}),"#")}},{key:"setColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.updateInsertPointChpx(Tp.FormatOpType.Font_Color,e)){var i=this.getNormalRange(),n={pos:i.pos,len:i.len,opType:Tp.FormatOpType.Font_Color,value:parseInt(e.substring(1),16),isAuto:t,rgs:this.getNormalRanges()},r={name:"formatOp",param:n};this.cmdExec.exec(r)&&this.onCmdExec(),this.isMasterView&&window.collection("newui","value",window.pcTrack.newui.masterview_fontcolor)}}},{key:"getHighlightColor",value:function(){var e=this.getChpx(),t=e&&e.hightLightColor&&e.hightLightColor.color;if(t&&t.rgba)return this.rgbaToHex(t.rgba)}},{key:"setHighlightColor",value:function(e){var t=void 0;t="#ffffffffff000000"===e?-16777216:parseInt(e.substring(1),16),this._setProp(Tp.FormatOpType.Font_HighlightColor,t)}},{key:"getSpacing",value:function(){var e=this.getChpx();return void 0===e||void 0===e.spacing?0:-1===e.spacing?"":e.spacing/100}},{key:"setSpacing",value:function(e){this._setProp(Tp.FormatOpType.Font_Spacing,e)}},{key:"getActions",value:function(){var e=this.getChpx();return void 0===e||void 0===e.actions?null:e.actions}},{key:"setActions",value:function(e){this._setProp(Tp.FormatOpType.Font_Actions,e)}},{key:"getTextHyperlink",value:function(){var e=this.getChpx();return void 0===e||void 0===e.textHyperlink?null:e.textHyperlink}}]),t}(kp.default),Pp=[1,2,3,4,5,6,7,8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72,80];function Ip(e){var t=e;if(t<Pp[0])return Pp[0];if(t>=Pp[0]&&t<Pp[Pp.length-1]){for(var i=0;i<Pp.length;i++)if(!(t>=Pp[i])){t=Pp[i];break}}else t=10*parseInt((t+10)/10);return t>4e3?4e3:t}function Lp(e){var t=e;if(t<=Pp[0])return Pp[0];if(t>Pp[0]&&t<=Pp[Pp.length-1]){for(var i=Pp.length-1;i>=0;i--)if(!(t<=Pp[i])){t=Pp[i];break}}else t=10*parseInt((t-10)/10);return t}var Ap=function(e){function t(e){return r()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return u()(t,e),o()(t,[{key:"formatOp",value:function(e){switch(e.opType){case Tp.FormatOpType.Para_Alignment:return this.setAlignment(e);case Tp.FormatOpType.Para_LineSpacingRel:return this.setLineSpacingRelative(e);case Tp.FormatOpType.Para_ChangeIndent:return this.changeIndent(e);case Tp.FormatOpType.Para_ChangeFirstLineIndent:return this.changeFirstLineIndent(e);case Tp.FormatOpType.Para_RemoveIndent:return this.removeIndent(e);case Tp.FormatOpType.List_ApplyToRange:return this.setList(e);case Tp.FormatOpType.Para_ReadingOrder:return this.setReadingOrder(e);case Tp.FormatOpType.Para_LeftIndentAbsAndRef:return this.setLeftIndent(e);case Tp.FormatOpType.Para_FirstLineIndentAbsAndRef:return this.setFirstLineIndent(e);case Tp.FormatOpType.Para_RightIndentAbsAndRef:return this.setRightIndent(e);case Tp.FormatOpType.Para_SpaceBeforeAbsAndRef:return this.setSpaceBefore(e);case Tp.FormatOpType.Para_SpaceAfterAbsAndRef:return this.setSpaceAfter(e);case Tp.FormatOpType.Para_OutlineLevel:return this.setOutlineLevel(e);case Tp.FormatOpType.Para_FarEastLineBreakControl:return this.setFarEastLineBreakControl(e);case Tp.FormatOpType.Para_WordWrap:return this.setWordWrap(e);case Tp.FormatOpType.Para_HangingPunctuation:return this.setHangingPunctuation(e);case Tp.FormatOpType.Para_HalfWidthPunctuationOnTopOfLine:return this.setHalfWidthPunctuationOnTopOfLine(e);case Tp.FormatOpType.Para_AddSpaceBetweenFarEastAndAlpha:return this.setAddSpaceBetweenFarEastAndAlpha(e);case Tp.FormatOpType.Para_AddSpaceBetweenFarEastAndDigit:return this.setAddSpaceBetweenFarEastAndDigit(e);case Tp.FormatOpType.Style_ApplyToRange:return this.styleCmdExec.applyToRange(e);case Tp.FormatOpType.Para_Indentation:return this.setIndentation(e);default:console.log("大哥，param传错了！")}}},{key:"setPapx",value:function(e,t,i){for(var n={},r=0;r<t.length;r++)n[t[r]]=i[r];return this.model._setParagraphAttrs(n),!0}},{key:"setAlignment",value:function(e){var t=this.model.getPapx(e),i=e.value;if(void 0!==t&&t.alignMode===i)return;var n=[i];return this.setPapx(e,["alignMode"],n)}},{key:"setLineSpacingRelative",value:function(e){var t=[{rule:"auto",value:Math.round(100*e.value)}];return this.setPapx(e,["lineSpacing"],t)}},{key:"setList",value:function(e){var t=void 0,i=void 0,n=e.value.listType,r=e.value.val;if(1===n){var a=e.value.bulletFont;i=["listType","bulletChar","bBullet","bulletFont"],t=[wo.Bullet,r,!0,a]}else 2===n?(i=["listType","autoNumType","bBullet"],t=[wo.AutoNum,r,!1]):(i=["listType","bulletChar","bBullet"],t=[wo.None,null,!1]);return this.setPapx(e,i,t)}},{key:"setIndentation",value:function(e){this.model._setIndentation(e)}},{key:"setReadingOrder",value:function(e){var t=e.value,i=t.gcps,n=t.rightToLefts,r=t.alignments,a=t.textFrames,o=this.model.getLocalSelection();o.editBatchDatas((function(){i.forEach((function(e,t){var i={},s=a&&a[t];i.rightToLeft=n[t],i.alignMode=r[t],o.cmdFmtPapx(i,e.start,e.end-e.start,s)}))}))}}]),t}(Cp),Bp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.cmdExec=new Ap(i),i}return u()(t,e),o()(t,[{key:"_setProp",value:function(e,t){var i=this.getNormalRange(!0),n={name:"formatOp",param:{pos:i.pos,len:i.len,opType:e,value:t}};this.cmdExec.exec(n)&&this.onCmdExec(n)}},{key:"getAlignment",value:function(){var e=this.getPapx();if(void 0!==e)return e.alignMode}},{key:"setAlignment",value:function(e){this._setProp(Tp.FormatOpType.Para_Alignment,e)}},{key:"getLineSpacingRelative",value:function(){var e=this.getPapx();if(void 0===e)return 1;var t=e.lineSpacing;return Object.isEmpty(t)?1:-1===t||"auto"!==t.rule?-1:t.value/100}},{key:"getlineSpaceReduction",value:function(){return this.getBodyStyle().lineSpaceReduction||0}},{key:"getLineSpacing",value:function(){var e=this.getLineSpacingRelative();return-1!==e?(e-this.getlineSpaceReduction()).toFixed(2):""}},{key:"setLineSpacingRelative",value:function(e){var t=e+this.getlineSpaceReduction();this._setProp(Tp.FormatOpType.Para_LineSpacingRel,t)}},{key:"getOutLine",value:function(){return this.getPapx().outline}},{key:"getListType",value:function(){var e=this.getPapx();return Object.isEmpty(e.listType)?-1:e.listType}},{key:"setList",value:function(e,t,i){this._setProp(Tp.FormatOpType.List_ApplyToRange,{listType:e,val:t,bulletFont:i})}},{key:"getList",value:function(){var e=this.getPapx(),t=this.getListType();if(void 0!==e)return{listType:t,bulletChar:e.bulletChar,autoNumType:e.autoNumType}}},{key:"setIndentation",value:function(e){var t=this.getOutLine(),i=this.getListType();this._setProp(Tp.FormatOpType.Para_Indentation,{shift:e,outLine:t,listType:i})}},{key:"getReadingOrder",value:function(){var e=this.getPapx();return void 0===e||void 0===e.rightToLeft?null:e.rightToLeft}},{key:"setReadingOrder",value:function(e){var t=this.getNormalRange(),i=this.selection.getActiveShapes(),n=i&&i[0];if(this.selection.state!==v.SelectType.select_cell&&(-1===t.pos&&-1===t.len||n&&n.isGroupShape()||this.selection.state===v.SelectType.select_shape&&n.hasTable())){var r=this.getRightToLeftMapObj();if(!r)return;for(var a=[],o=[],s=[],l=[],h=0,u=r.length;h<u;h++){var c=r[h],d=c.rightToLeftMap,p=c.textFrame;if(d)for(var f=0,g=d.length;f<g;f++){var y=d[f],m=y.alignMode,_=y.rightToLeft,w=y.start,S=y.end,x=m;e!==_&&(1===x?x=3:3===x&&(x=1)),a.push({start:w,end:S}),o.push(e),s.push(x),l.push(p)}}this._setProp(Tp.FormatOpType.Para_ReadingOrder,{gcps:a,rightToLefts:o,alignments:s,textFrames:l})}else{var T=this.getRightToLeftMap();if(!T)return;for(var k=[],C=[],b=[],E=0,R=T.length;E<R;E++){var P=T[E],I=P.alignMode,L=P.rightToLeft,A=P.start,B=P.end,D=I;e!==L&&(1===D?D=3:3===D&&(D=1)),k.push({start:A,end:B}),C.push(e),b.push(D)}this._setProp(Tp.FormatOpType.Para_ReadingOrder,{gcps:k,rightToLefts:C,alignments:b})}}},{key:"getRightToLeftMap",value:function(){var e=this.getBodyStyle();return e&&e.rightToLeftMap?e.rightToLeftMap:null}},{key:"getRightToLeftMapObj",value:function(){var e=this.getBodyStyle();return e&&e.rightToLeftMapObj?e.rightToLeftMapObj:null}}]),t}(kp.default),Dp=i(1266),Mp=["Art::GVML ClipFormat","Art::Table ClipFormat","Art::Text ClipFormat","Et Internal Shape","WPS Drawing Shape Format","Office Drawing Shape Format","PowerPoint 14.0 Slides Package","kso slide package type","Art::Text ClipFormat","text/plain","text/html","image/png","Kingsoft Data Descriptor"],Op=function(){function e(){r()(this,e)}return o()(e,null,[{key:"hasClipboardData",value:function(){return window.clipboardData||navigator.clipboard}},{key:"getData",value:function(t){return new Promise((function(i,n){if(Od.isPCWpsClient())Object(Dp.pcWpsClientPaste)((function(t){e.readClipboardData(new Np(t),i,n)}));else{var r=window.clipboardData||t&&t.clipboardData||t&&t.originalEvent&&t.originalEvent.clipboardData;e.readClipboardData(r,i,n)}}))}},{key:"readCommonClipboardData",value:function(t){var i=t,n=i.text,r=i.html,a=r&&r.indexOf('<html xmlns:o="urn:schemas-microsoft-com:office:office"');a>0&&(0===r.indexOf("<html>")&&(i.html=r.substr(a,r.length-a-16)));if(!i.ksdocclipboardid&&(r||n)){var o=e.getKsclipboardIdFromHtml(r||n);o&&(i.ksdocclipboardid=o)}if(i.ksdocclipboardinfo&&"webwpp"!==i.ksdocclipboardinfo.from){var s=!1,l=null;if(i&&i.mimeTypes)for(var h=0;h<Mp.length;h++)if(i.mimeTypes.indexOf(Mp[h])>=0){l=Mp[h],s=!0;break}s?(i.ksDocInfo=i,i.ksDocServerType=l):i.ksdocclipboardinfo=null}return i.urls=[],r&&(i.urls=e.getHtmlImgUrls(r)),i}},{key:"readClipboardData",value:function(t){var i=e.readCommonClipboardData(t),n=i.bError,r=i.text,a=i.html,o=i.urls,s=i.ksdocclipboardinfo,l=i.ksdocclipboardid;if(n);else{if(l&&!s)return{type:"text/ksdocclipboardid",data:l,text:r,html:a};if(s&&("text/html"!==i.ksDocServerType||0===o.length))return{type:"text/ksdocclipboardinfo",data:{ksDocClipboardId:t.ksDocClipboardId,mimeTypes:t.mimeTypes,text:r,html:a,fromApp:t.fromApp}};if(t){var h=null,u=t.types,c=t.files;if(!u){var d=t.files;if(d)for(var p=0;p<d.length;p++){var f=d[p];if(!/ image\/.*/.test(f.type)){var g=f.getAsFile();o.push({file:g})}}return a&&0===o.length?{type:"html",data:a,text:r}:(r&&o.push({text:r}),o.length>0?{type:"image-text",data:o,ieText:r}:{type:"text",ieText:r,data:a||r})}if(-1!==u.indexOf("text/html")){if(1!==o.length||-1===u.indexOf("Files")){if(a&&0===o.length){var y=null;return-1!==u.indexOf("Files")&&(y=c),{type:"html",data:a,text:r,image:y}}return r&&o.push({text:r}),{type:"image-text",data:o}}if(c)return{type:"image",data:c}}else{if(-1!==u.indexOf("Files"))return c?{type:"image",data:c}:{type:"image",data:null};var v=null;if(u instanceof Array)for(var m=0;m<u.length;m++){var _=u[m];if(_.match(/^image\//i)){v=_;break}}else for(var w in u)if(w.match(/^image\//i)){v=w;break}if(v&&(h=t.getData(v)))return{type:"image",data:h=function(e,t){for(var i=atob(e),n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);return new Blob([r],{type:t})}(h,v)};if(r)return{type:"text",data:r}}}}}},{key:"readFiles",value:function(e,t){var i=e[t];if("file"!==i.kind)for(var n=e.length-1;n>0;n--)if("file"===e[n].kind){i=e[n];break}if(i&&"file"===i.kind&&i.type.match(/^image\//i))return i.getAsFile()}},{key:"getHtmlImgUrls",value:function(e){var t=e&&e.match(/<img.*?\>/gi),i=[];if(t)for(var n=0;n<t.length;n++){var r=void 0,a=0;if(/src=["|']/gi.test(t[n])?r=t[n].match(/(http|file:).*?\"/g):(r=t[n].match(/(http|file:).*?\s/g),a=1),r){var o=r[0];o&&('"'!==o[o.length-(a+1)]&&"'"!==o[o.length-(a+1)]||a++,o=o.slice(0,o.length-a).replace("http:","https:")),o=o.replace(/\&amp;/g,"&"),i.push({url:o})}}return i}},{key:"getKsclipboardIdFromHtml",value:function(e){var t=e&&e.match(/ksDocClipboardId:'.*'/gi),i=e&&e.match(/ksdocclipboardid=".*?"/);if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n],a=r.indexOf("ksDocClipboardId:'");if(a>=0){var o=r.slice(a+"ksDocClipboardId:'".length);return a=o.indexOf("'"),o.slice(0,a)}}else if(i&&i.length>0)for(var s=0;s<i.length;s++){var l=i[s],h=l.indexOf('ksdocclipboardid="');if(h>=0){var u=l.slice(h+'ksdocclipboardid="'.length);return h=u.indexOf('"'),u.slice(0,h)}}}},{key:"getImage",value:function(e){}},{key:"setImage",value:function(){}}]),e}(),Np=function(){function e(t){r()(this,e),this._data=t}return o()(e,[{key:"getData",value:function(e){return this._data.getData(e)}},{key:"items",get:function(){return this._data}},{key:"types",get:function(){return this._keys=this._keys||Object.keys(this._data),this._keys}}]),e}(),Fp=i(1874),Vp=i(2723),Up=i(559),Gp=i(1909),Hp=i(617),Wp=i(1018),jp=i(4961),Yp=i(261),zp="E_WPP_COPY_TOO_LARGE_DATA",Kp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.init=function(){i.addKeyDownListener({keyCode:ru.a.C,ctrlKey:!0},i.copy),i.addKeyDownListener({keyCode:"paste"},i.paste),i.addKeyDownListener({keyCode:ru.a.Y,ctrlKey:!0},i.redo),i.addKeyDownListener({keyCode:ru.a.Z,ctrlKey:!0},i.undo),i.addKeyDownListener({keyCode:ru.a.S,ctrlKey:!0},i.save),(v.userAgent.isIEPure||v.userAgent.isIPad)&&i.addKeyDownListener({keyCode:ru.a.V,ctrlKey:!0},i.paste),i.addKeyDownListener({keyCode:ru.a.T},i.insertShape),i.addKeyDownListener({keyCode:ru.a.R},i.insertShape),i.addKeyDownListener({keyCode:ru.a.L},i.insertShape),i.addKeyDownListener({keyCode:ru.a.O},i.insertShape),i.addKeyDownListener({keyCode:ru.a.C},i.insertShape)},i.destroy=function(e){i.removeKeyDownListener({keyCode:ru.a.C,ctrlKey:!0},i.copy),i.removeKeyDownListener({keyCode:"paste"},i.paste),i.removeKeyDownListener({keyCode:ru.a.Y,ctrlKey:!0},i.redo),i.removeKeyDownListener({keyCode:ru.a.Z,ctrlKey:!0},i.undo),i.removeKeyDownListener({keyCode:ru.a.S,ctrlKey:!0},i.save),i.removeKeyDownListener({keyCode:ru.a.V,ctrlKey:!0},i.paste),i.removeKeyDownListener({keyCode:ru.a.T},i.insertShape),i.removeKeyDownListener({keyCode:ru.a.R},i.insertShape),i.removeKeyDownListener({keyCode:ru.a.L},i.insertShape),i.removeKeyDownListener({keyCode:ru.a.O},i.insertShape),i.removeKeyDownListener({keyCode:ru.a.C},i.insertShape)},i.copy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t,r=r||window.WPSOpenApi.__HOOKS__,a=a||r&&r.KeyboardEventCopy;n||(n=a&&a.Action);var o=a&&a.Props&&a.Props.hiddenToast,s=window,l=s.APP;if(l&&!l.canCopy())return n&&n({error:"can not copy"}),void(window.__CONFIG__.isShowNoPermissionComponent&&(Yp.canRequestForAuthForSecurityDoc&&Object(Yp.isCopyLimitedSecurityDoc)()?Object(Yp.requestForAuth)({type:Yp.AUTH_TYPES.COPY}):!o&&i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.cannotOperate", "你没有此操作的权限，请联系所有者修改权限"))));var h=navigator.onLine;if(!h)return n&&n({error:"is not online"}),void(!o&&i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.offLineCopyFailed", "与服务器断开，无法进行该操作")));var u=i.getLocalSelection(),c=l.presentation.copypasteMgr;if(u){if(i.isMasterView&&!u.getActiveShapes())return n&&n({error:"isMasterView can not copy"}),void(!o&&i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.masterViewCannotCopy", "暂不支持复制母版中的幻灯片")));var d=window.getSelection&&window.getSelection().toString();if(d)return n&&n({copytext:d}),void Hp.a.copy(d,e);var p=null,f=(p=u.getText())?p.join(""):null,g=void 0,y=void 0;i.isCopyText=!1;var m=" ";if(i.isSelTextShape()){if(!f)return void(n&&n({error:"invalid range"}));window.copyTextStatus=!0,Hp.a.copy(l.copyControl()?"":f),i.isCopyText=!0,window.copyTextStatus=!1}else if(Od.isIE)Hp.a.copy(" ");else if(l.copyControl())Hp.a.copyShape("",!1,"","");else{var _=i.copyLocalImageHtml();g=_&&_.html,y=_&&_.originURL,g?Hp.a.copyShape(g,!1,m,y):Hp.a.copyShape("<html><body> </body></html>",!1,m)}i.clipInfo=Od.isIE?Hp.a.createClipboardInfo():"";var w=Od.isIE?i.clipInfo.id:Hp.a.getCurrentClipBoardInfo()&&Hp.a.getCurrentClipBoardInfo().id;l.canDelayCopy()&&u.copy((function(e){if(e&&e.errName===zp)n&&n({error:"copyTooMuch"}),!o&&window.Toast.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.copyTooMuch", "内容大小超出浏览器限制，无法粘贴，请分批复制"));else if(e&&0==e.error){var t="";if(v.userAgent.isIEPure){var r=_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessInLocal", "复制成功（由于{1}浏览器限制，只能在当前页面粘贴，建议使⽤Chrome浏览器）。").replace("{0}",v.userAgent.isMacOs?"⌘V":"Ctrl+V");t=r.replace("{1}","IE"),!o&&i.showToast("success",t)}else t=_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessPure", "复制成功");if(!g||Od.isIE||l.copyControl()){var a=Hp.a&&Hp.a.getCopyID();f=l.copyControl()?"":f,g=l.copyControl()?"<div></div>":e.copyHtml,Hp.a.asyncWrite({"text/plain":f,"text/html":g},a).then((function(e){i.isCopyText?!o&&window.Toast.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessPure", "复制成功")):!o&&lt.default.dispatchEvent(lt.default.pubNames.edit.COPY_NOTICE,{callBack:Hp.a.pasteToSys,msg:t,type:Up.a.SUCCESS_INCLUDE_DATA})}))}else{var s=e.images&&e.images[0]&&e.images[0].url;s&&Hp.a.copyShape(g,!0,m,s),!o&&window.Toast.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.copySuccessPure", "复制成功"))}n&&n({"text/plain":f,"text/html":e.copyHtml}),i.shapeCopy&&i.shapeCopy.update()}else n&&n({error:"copy fail"}),!o&&i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.copyFailed", "复制失败"))}),{clipboardId:w}),c.createClipboardDatas(f,g,w,null)}},i.handleMimeDatas=function(e){var t=e.mimeDatas,i=["text/html"];return t.map((function(e){return i.push(e.type)})),i},i.modifyWPPClipboardInfo=function(e){return{id:Hp.a.getCurrentClipBoardInfo().id,mimeTypes:e,from:"webwpp"}},i.cut=function(e){var t=window.APP;if(!t||t.canCopy()&&!t.isReadOnly()){var n=i.getLocalSelection(),r=t.presentation.copypasteMgr;if(n){if(i.isMasterView&&!n.getActiveShapes())return void i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.masterViewCannotCut", "暂不支持剪切母版中的幻灯片"));var a=null,o=(a=n.getText())?a.join(""):null;i.isCutText=!1;var s=void 0;if(i.isSelTextShape())window.copyTextStatus=!0,Hp.a.copy(t.copyControl()?"":o),i.isCutText=!0,window.copyTextStatus=!1;else if(Od.isIE)Hp.a.copy(" ");else if(t.copyControl())Hp.a.copyShape("",!1,"","");else{var l=i.copyLocalImageHtml();s=l&&l.html;var h=l&&l.originURL;s?Hp.a.copyShape(s,!1," ",h):Hp.a.copyShape("<html><body> </body></html>",!1," ")}i.clipInfo=Od.isIE?Hp.a.createClipboardInfo():"";var u=Od.isIE?i.clipInfo.id:Hp.a.getCurrentClipBoardInfo()&&Hp.a.getCurrentClipBoardInfo().id;n.cut((function(){return!0}),(function(e){if(e&&e.errName===zp)window.Toast.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutTooMuch", "内容大小超出浏览器限制，无法粘贴，请分批剪切"));else if(e&&0==e.error){i.isSelTextShape()&&n.deleteText();var r="";if(v.userAgent.isIEPure){var a=_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessInLocal", "剪切成功（由于{1}浏览器限制，只能在当前页面粘贴，建议使⽤Chrome浏览器）。").replace("{0}",v.userAgent.isMacOs?"⌘V":"Ctrl+V");return r=a.replace("{1}","IE"),void i.showToast("success",r)}if(r=_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessPure", "剪切成功"),!s||Od.isIE||t.copyControl()){var l=Hp.a&&Hp.a.getCopyID();o=t.copyControl()?"":o,s=t.copyControl()?"<div></div>":e.copyHtml,Hp.a.asyncWrite({"text/plain":o,"text/html":s},l).then((function(e){i.isCopyText?window.Toast.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessPure", "剪切成功")):lt.default.dispatchEvent(lt.default.pubNames.edit.COPY_NOTICE,{callBack:Hp.a.pasteToSys,msg:r,type:Up.a.SUCCESS_INCLUDE_DATA})}))}else{if(v.userAgent.chromeVS){var h=e.images&&e.images[0]&&e.images[0].url;h&&Hp.a.copyShape(s,!0," ",h)}window.Toast.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.cutSuccessPure", "剪切成功"))}i.shapeCopy&&i.shapeCopy.update()}else i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.cutFailed", "剪切失败"))}),{clipboardId:u}),r.createClipboardDatas(o,null,u,null)}}else window.__CONFIG__.isShowNoPermissionComponent&&(Yp.canRequestForAuthForSecurityDoc&&Object(Yp.isCopyLimitedSecurityDoc)()?Object(Yp.requestForAuth)({type:Yp.AUTH_TYPES.COPY}):Yp.canRequestForAuthForSecurityDoc&&Object(Yp.isEditLimitedSecurityDoc)()?Object(Yp.requestForAuth)({type:Yp.AUTH_TYPES.EDIT}):i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.cannotOperate", "你没有此操作的权限，请联系所有者修改权限")))},i.save=function(e){i.app.isReadOnlyComment()?window.Toast.success(_i18n("applications.presentation.app.shell.editor.model.commonModel.saveSuccess", "保存成功")):lt.default.dispatchEvent(lt.default.pubNames.file.ON_SAVE_VERSION,{triggerSave:!0})},i.paste=function(e){var t=Od.isIE?e:e.event;!v.userAgent.isIPad&&t&&t.preventDefault();var n=i.getLocalSelection(),r=window.APP.session.isConnected(),a=window.APP.isReadOnly(),o=navigator.onLine;if(r&&o&&!a){var s=window.APP.presentation.copypasteMgr.localClipboardID;Hp.a.getClipBoardData(t).then((function(e){if(v.userAgent.isPCWpsClient()){var r=e["text/html"],a=e["text/plain"],o=e.id;if(o)return void n.paste({ksDocClipboardId:o,text:a,html:r});if(r)return void n.paste(null,{"text/html":r})}if(!(e.Files||e["text/html"]||e["text/plain"]||e.id)){if("ok"===e.callstatus)return!1;if(v.userAgent.isIPad&&!t)return window.Toast.warn(_i18n("applications.presentation.app.shell.editor.model.commonModel.ipadPasteToast", "由于浏览器限制，不支持粘贴来自外部的复制")),!0;if(!v.userAgent.isMobile&&!t&&!v.userAgent.isPCWpsClient())return window.Toast.warn(v.userAgent.convertCtrl(_i18n("applications.presentation.app.shell.editor.model.commonModel.rbMenuPaste", "当前浏览器不支持，请使用Ctrl+V粘贴"))),!0}var l={};l.html=e["text/html"],l.text=e["text/plain"],l.files=e.Files,l.types=t&&t.clipboardData&&t.clipboardData.types,l.types=l&&l.types&&0!==l.types.length?l.types:l.files?["Files"]:l.html?["text/html"]:"";var h=Hp.a.getCurrentClipBoardInfo();l.ksDocClipboardId=e.id||h&&h.id,l.fromApp=h&&h.from,l.mimeTypes=h&&h.mimeTypes,l.ksdocclipboardinfo=h;var u=Op.readClipboardData(l);if(u){var c=u.type,d=u.data;switch(Od.isIE&&!e["text/plain"].trim()&&(c="tryLocalData"),c){case"image":i._insertImage(d);break;case"text":d&&d.trim()&&i._insertText(d);break;case"image-text":d=d||[];var p=0,f=0;!function e(){if(p<d.length){var t=d[p],n=t.url,r=t.text;n?i.loadImageBlob(n,(function(t,n){n?(n.origin="paste",i._insertImage(n)):t&&f++,p++,setTimeout(e,500)})):(!r||r!==he.d.Drawing&&r!==he.d.Embed||(r=void 0),r&&r.trim()&&i._insertText(r),p++)}p>=d.length&&f&&i._insertImage({origin:"paste",errCnt:f})}();break;case"html":if(u.text){if(u.text.length>3e3)return void i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.pasteTextMaximum", "粘贴字符个数太多"));n.paste(null,{"text/html":d,"text/plain":u.text,fromWPS:u.fromWPS})}else n.paste(null,{"text/html":d,fromWPS:u.fromWPS});break;case"text/ksdocclipboardid":u.smartText?n.paste({ksDocClipboardId:d,text:u.smartText}):n.paste({ksDocClipboardId:d,text:u.text,html:u.html});break;case"text/ksdocclipboardinfo":d.text=u.text||d.text,d.html=u.html||d.html,n.paste(d);break;case"tryLocalData":s&&n.paste({ksDocClipboardId:s,text:u.text,html:u.html})}}})).catch((function(e){e&&"image"===e.type&&i._insertImage({origin:"paste",errCnt:1})}))}},i.undo=function(e){window.APP.undo(),window.collection("newui","value",e?"undo_shortcut":"undo_toolbar")},i.redo=function(e){window.APP.redo(),window.collection("newui","value",e?"redo_shortcut":"redo_toolbar")},i.replace=function(e){},i.insertShape=function(e){if(!(document.activeElement&&["INPUT","TEXTAREA"].includes(document.activeElement.tagName))){var t=i.editor.slide;switch(e.keyCode){case ru.a.T:t.insertTextBox({data:{orientation:"horizontal"}});break;case ru.a.R:t.insertShape({data:{groupId:1,index:0}});break;case ru.a.L:t.insertShape({data:{groupId:0,index:0}});break;case ru.a.C:t.insertShape({data:{groupId:0,index:4},isShortcut:!0});break;case ru.a.O:t.insertShape({data:{groupId:2,index:2}})}}},i.init(),i.shapeCopy=null,i}var i;return u()(t,e),o()(t,[{key:"initShapeCopy",value:function(){this.shapeCopy=new Wp.a}},{key:"doIpadCutOrCopy",value:function(e){var t=this.getLocalSelection(),i=this.mobileClipboard.constructor.DataType;if(t.state===v.SelectType.select_text){var n=t.getRange(),r=n.begin;if(n.end>r){var a=t.getText().join("");this.mobileClipboard[e](i.Text,a)}}else{var o=i.Shape;t.state===v.SelectType.select_slide&&(o=i.Slide),this.mobileClipboard[e](o)}}},{key:"_insertImage",value:function(e){this.getLocalSelection().getActiveSlide()&&(e&&e.size>0&&!e.name&&(e.name="nw"+Date.now()+"."+e.type.replace("image/","")),e.origin="paste",lt.default.uilDispatcher.fire(Vp.a.picture.ON_PICTURE_FILE_UPLOAD,e))}},{key:"_insertText",value:function(e){if(this.getLocalSelection().getActiveSlide()){var t=e.replace(/(\r\n)|(\n)/g,"\r");if(t.length>3e3)this.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.commonModel.pasteTextMaximum", "粘贴字符个数太多"));else if(this.isSelTextShape()){var i=this.getLocalSelection();i&&i.insertText(t)}else this.editor.models[Tp.ModelNamesDef.slide].insertTextShape(t)}}},{key:"getPasteDataByEvent",value:function(e){return Op.getData(e)}},{key:"copyText",value:function(e){return Op.setText(e)}},{key:"isPlaceholder",value:function(e){return e===he.d.Drawing||e===he.d.Embed}},{key:"loadImageBlob",value:function(e,t){var i=this;e?"file:"===e.substr(0,5)?t("file read error"):(window.collection("experience",{event:window.pcTrack.experience.load_paste_image}),window.__WPSENV__.callAPI({method:"GET",url:e,responseType:"blob"}).then((function(n){if(200===n.status){var r=n.body;r.name="nw"+Date.now()+"."+r.type.replace("image/",""),t(null,r,e)}else t("Loading error:"+n.status),i._trackLoadImageError(n,e)})).catch((function(n){t("Loading error:"+n),i._trackLoadImageError(n,e)}))):t("url error")}},{key:"_trackLoadImageError",value:function(e,t){e&&e.target&&0===e.target.status&&4===e.target.readyState&&Object(jp.getOrigin)(t)!==window.location.origin&&window.collection("experience",{event:window.pcTrack.experience.load_paste_image_CORS_error})}},{key:"copyXClipBoard",value:function(e,t){return Hp.a.copy(e,t)}},{key:"getClipboardData",value:(i=st()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hp.a.getClipBoardData(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"copyLocalImageHtml",value:function(){var e=this.getLocalSelection().getActiveShapes();if(e&&1===e.length&&e[0].getPicture()&&!e[0].isVideo()&&!e[0].isAudio()){var t=e[0],i=this.shellDoc.coreView.getActiveSlide(),n=t.getPicture(),r=n.blip&&n.blip.blipAtom&&n.blip.blipAtom.imageId,a=window.backendImageManager.fetchImageSync,o=a({imageId:r,noNeedLoad:!0})||a({imageId:r,noNeedLoad:!1})||a({shapeId:t.getId(),slideId:i.getId(),noNeedLoad:!0})||a({shapeId:t.getId(),slideId:i.getId(),noNeedLoad:!1}),s=o&&o.data&&o.data.sha1,l=s&&this.shapeCopy&&this.shapeCopy.generateUrl(s),h=i&&i.getShape(t.getId());if(h){var u=h.getUilLayoutRect(1);return{html:"<html><body><img src='"+l+"' width="+u.width+" height="+u.height+' app="wpp"></body></html>',originURL:l}}}return null}},{key:"modelNames",get:function(){return[Fp.a.CONTAINER,Fp.a.SLIDE,Fp.a.SHAPE]}},{key:"mobileClipboard",get:function(){if(v.userAgent.isIPad){if(!this._mobileClipboard){var e=this.getLocalSelection();this._mobileClipboard=Gp.a.getInstance(e)}return this._mobileClipboard}return null}}]),t}(kp.default),qp=window.Px2Emu,Xp=(window.Emu2Ti,function(e,t){var i=e.x,n=e.y,r=e.left,a=e.top,o=e.width,s=e.height,l=e.rotate;return Object.isEmpty(a)||(a=qp(a,t)),Object.isEmpty(r)||(r=qp(r,t)),{left:r,top:a,x:window.Px2Emu(i,t),y:window.Px2Emu(n,t),width:window.Px2Emu(o,t),height:window.Px2Emu(s,t),rotate:l||0}});var Jp,Zp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.init=function(){i.addKeyDownListener({keyCode:ru.a.M,ctrlKey:!0},i.insertSlide),i.addKeyDownListener({keyCode:ru.a.ENTER},i.insertSlide),i.addKeyDownListener({keyCode:ru.a.A,ctrlKey:!0},i.selectAll),i.addKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut)},i.destroy=function(){i.removeKeyDownListener({keyCode:ru.a.M,ctrlKey:!0},i.insertSlide),i.removeKeyDownListener({keyCode:ru.a.ENTER},i.insertSlide),i.removeKeyDownListener({keyCode:ru.a.A,ctrlKey:!0},i.selectAll),i.removeKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut)},i.cut=function(e){i.editor.common.cut(e)},i.selectAll=function(e){var t=i.getLocalSelection();t.clearShapeSelect();var n=t.getActiveSlide(),r=n&&n.getShapeTree();r&&r.childShapes.forEach((function(e){!e.isHidden()&&t.addSelectShape(e)}))},i.insertSlide=function(e){i.editor.container.insertSlide(e)},i.insertTextBox=function(e){e.action=e.action||Ka.MouseAction.insertTextBox,i.fireMouseActionEvent(e),i.isMasterView&&window.collection("newui","value",window.pcTrack.newui.masterview_insert_text)},i.insertInk=function(e){e.action=e.action||Ka.MouseAction.insertInk,i.fireMouseActionEvent(e)},i.insertTextShape=function(e){i.getLocalSelection().insertTextBoxWithContent(e,{x:0,y:0,width:7315200,height:914400})},i.insertShape=function(e){e.action=e.action||Ka.MouseAction.insertShape,i.fireMouseActionEvent(e),i.isMasterView&&window.collection("newui","value",window.pcTrack.newui.masterview_insert_shape)},i.clearSlideSelect=function(){i.getLocalSelection().clearSlideSelect()},i._commonInsertPic=function(e,t){var n=t.uploadId,r=t.img,a=t.extParams,o=t.position,s=i.getLocalSelection(),l=i.shellDoc.svgLayout,h=l.width,u=l.height,c=l.bestZoom,d=l.scale;d*=c;var p=i._adjustWidthAndHeight(h,u,r),f=Xp({width:h,height:u},d),g=Xp({width:p.width,height:p.height},d),y=void 0;if(o){if(!(y=i.getOpenApiImgRect(f,o,d)))return}else y={x:f.width/2-g.width/2,y:f.height/2-g.height/2,width:g.width,height:g.height};if("processon"===e){var v=t.category,m=t.fileId,_=t.definition;return s.insertProcessOn(y,n,v,m,_)}return s.insertPicture(y,n,a)},i.insertPicture=function(e){var t=i.getLocalSelection().fetchAvailPh(v.PlaceholderType.Picture),n=i._commonInsertPic("picture",e);return t=n&&n.shape,i.isMasterView&&window.collection("newui","value",window.pcTrack.newui.masterview_insert_pic),t},i.insertProcessOn=function(e){i._commonInsertPic("processon",e)},i.insertMedia=function(e){var t=e.shapeSize,n=e.uploadId,r=e.mediaName,a=e.mediaDataType,o=e.mediaType,s=e.mediaSubType,l=e.extParams,h=i.getLocalSelection(),u=i.getCenterRectEmu(t);h.insertMedia(u,n,r,a,o,s,l)},i._commonModifyPic=function(e,t){var n=t.imageId,r=t.uploadId,a=t.svgData,o=t.img,s=t.reEditPictureData,l=t.extParams,h=t.shapeList,u=i.getLocalSelection(),c=void 0;"latexMath"===e||"qrcode"===e?s=i.getCenterRectEmu(o,!1,s):"processon"===e?s=i.getFixedRect(o,s):s&&!s.isKeepShapeSize&&(c=i.calcSourceRectangle(o,s));var d=i.createModifierByName("BlipFill",{}),p=[d],f={x:s.x/635,y:s.y/635,width:s.width/635,height:s.height/635},g=i.createModifierByName("Transform2D");g.modify("anchorRect",f);var y=u.getActiveShapes();if(y&&y[0]&&y[0].isPlaceHolder()&&p.push(g),c){p.push(g);var m=i.createModifierByName("BlipFill",{});m.setName("Modify_Picture_Props"),m.modify("sourceRectangle",c),p.push(m)}switch(e){case"qrcode":var _=i.createModifierByName("ShapeExtData");_.modify("qrCode",l),p.push(_),d.setFlag("svgData",a),d.setName("Modify_Picture"),p.push(g);break;case"latexMath":var w=i.createModifierByName("ShapeExtData");w.modify("latexMath",{latexStr:t.latexStr}),p.push(w),d.setFlag("svgData",a),d.setName("Modify_Picture"),p.push(g);break;case"processon":var S=t.category,x=t.fileId,T=t.definition;d.setName("Processon"),d.setFlag("category",S),d.setFlag("fileId",x),d.setFlag("definition",T);break;default:a&&d.setFlag("svgData",a),d.setName("Modify_Picture");var k=i.selection.getActiveShapes();(k[0]&&k[0].getShapeType())!==v.ShapeType.Picture&&d.setFlag("isInsertPic",!0),d.setFlag("actionType",v.actionType.Modify_Picture)}if(d.modify("imageId",r||n),d.setFlag("rect",s),d.setFlag("isStretched",!1),d.setFlag("imageWidth",o.width),d.setFlag("imageHeight",o.height),d.setFlag("uploadId",r),l&&d.setFlag("extParams",l),h)u.applyShapeModifiers(p,h);else{var C=u.getActiveShapes();C&&C[0]&&u.applyShapeModifiers(p,[C[0]])}["qrcode","latexMath"].includes(e)||i.fireMouseActionEvent({isModifyPic:!0})},i.modifyShapePicture=function(e){i._commonModifyPic("picture",e)},i.insertQRCode=function(e){var t=e.img,n=t.width,r=t.height,a=e.extParams,o=e.svgData,s=i.insertSvgPicture({width:n,height:r,svgData:o});if(s){var l=window.CoreUtils.createModifier("ShapeExtData");l.modify("qrCode",a),i.selection.applyShapeModifiers([l],[s])}},i.modifyQRCode=function(e){i._commonModifyPic("qrcode",e)},i.modifyShapeProcessOn=function(e){i._commonModifyPic("processon",e)},i.insertTable=function(e,t,n){var r=i.getLocalSelection(),a=i.shellDoc.svgLayout,o=a.width,s=a.height,l=a.scale,h=a.bestZoom,u=Xp({width:o,height:s},l*=h),c=381e3*e,d=.7*u.width,p={x:(u.width-d)/2,y:(u.height-c)/2,width:d,height:c};r.insertTable(p,e,t,null,n)},i.insertChart=function(e,t,n){var r=i.getLocalSelection(),a=i.shellDoc.svgLayout,o=a.width,s=a.height,l=a.scale,h=a.bestZoom,u=Xp({width:o,height:s},l*=h),c={x:Math.floor((u.width-635e4)/2),y:Math.floor((u.height-4762500)/2),width:635e4,height:4762500};if(n&&n.isPlaceHolder()){var d=n.visual.getRealTransform2D(),p=d.x,f=d.y,g=d.width,y=d.height;c.x=Math.floor(p),c.y=Math.floor(f),c.width=Math.floor(g),c.height=Math.floor(y)}r.insertChart(c,e,t,n)},i.setFormatBrush=function(e){(e||i.brushData)&&(i.brushData=e,e||i.selection.clearFormat(),lt.default.uilDispatcher.fire(lt.default.eventTypes.pc.ON_FORMAT_BRUSH_CHANGE,e))},i.applyFormatBrush=function(){if(i.brushData){i.selection.applyFormat(!1,!i.brushData.isContinue);var e=i.selection.getActiveShapes();i.brushData.isContinue&&e&&0!==e.length||i.setFormatBrush(null),i.editor.setForbiddenScrollTime(performance.now())}},i.getCenterRectEmu=function(e,t,n){var r=i.shellDoc.getLayout(),a=r.viewBox,o=r.scale,s=a.width,l=a.height;t&&(e=i._adjustWidthAndHeight(s,l,e));var h=Xp(e,o);if(n)return _()({},h,{x:n.x+(n.width-h.width)/2,y:n.y+(n.height-h.height)/2});var u=Xp({width:s,height:l},o);return _()({},h,{x:u.width/2-h.width/2,y:u.height/2-h.height/2})},i.insertSvgPicture=function(e){var t=e.width,n=e.height,r=e.svgData,a=i.getCenterRectEmu({width:t,height:n},!0),o=i.selection.insertSvgPicture(a,r);return o&&o.shape},i.insertLatexMath=function(e){var t=e.width,n=e.height,r=e.latexStr,a=e.svgData,o=i.insertSvgPicture({width:t,height:n,svgData:a});if(o){var s=window.CoreUtils.createModifier("ShapeExtData");s.modify("latexMath",{latexStr:r}),i.selection.applyShapeModifiers([s],[o])}},i.modifyLatexMath=function(e,t){t&&(e.shapeList=[t],e.reEditPictureData=t.visual.getRealTransform2D(),i._commonModifyPic("latexMath",e))},i.init(),i}return u()(t,e),o()(t,[{key:"_adjustWidthAndHeight",value:function(e,t,i){var n=e,r=t,a=function e(t,i,n,r){var a=1;if(t>n)a=n/t,t=n,i=parseInt(i*a);else{if(!(i>r))return[t,i];a=r/i,t=parseInt(t*a),i=r}return e(t,i,n,r)}(i.width,i.height,1*n,1*r);return{width:a[0],height:a[1]}}},{key:"getOpenApiImgRect",value:function(e,t,i){var n=t.x,r=t.y,a=t.width,o=t.height,s=t.scale;if((n||0===n)&&(r||0===r)&&a&&o)return s?{x:e.width*n,y:e.height*r,width:e.width*a,height:e.height*o}:Xp({x:n,y:r,width:a,height:o},i);console.warn("insert picture warn: params error")}},{key:"getFixedRect",value:function(e,t){var i=t.width,n=t.height,r=t.x,a=t.y,o=e.height/e.width,s=void 0,l=void 0;return n/i>o?(s=i,l=i*o):(l=n,s=n/o),{width:s,height:l,x:r+(i-s)/2,y:a+(n-l)/2}}},{key:"calcSourceRectangle",value:function(e,t){var i=t.x/635*window.ti2pxRatio,n=t.y/635*window.ti2pxRatio,r=t.width/635*window.ti2pxRatio,a=t.height/635*window.ti2pxRatio,o=e.width,s=e.height/o,l=a/r,h=new window.Rect(i,n,r,a),u=new window.Rect(i,n,r,a);if(l>s){var c=a,d=a/s;u.setSize({width:d,height:c}),u.translate(new window.Point(-(d-r)/2,0))}else{var p=r,f=r*s;u.setSize({width:p,height:f}),u.translate(new window.Point(0,-(f-a)/2))}var g=(h.left()-u.left())/u.width(),y=(h.top()-u.top())/u.height(),v=(u.right()-h.right())/u.width();return{bottom:(u.bottom()-h.bottom())/u.height(),top:y,right:v,left:g}}},{key:"createModifierByName",value:function(e,t){return window.APP.utils.createModifier(e,t)}},{key:"modelNames",get:function(){return[Fp.a.SLIDE]}}]),t}(kp.default),Qp=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.init=function(){i.addKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut)},i.destroy=function(){i.removeKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut)},i.cut=function(e){i.editor.common.cut(e)},i.deleteSlide=Object(Cn.debounce)((function(e){var t=e.activeSlideIndex,n=i.getLocalSelection(),r=isNaN(t)?i.shellDoc.getActiveSlideIdx():t;n&&n.deleteSlide(r)}),100),i.insertSlide=function(e){e.activeSlideIndex||0===e.activeSlideIndex?i.baseInsertSlide(e):i.debounceInsertSlide(e)},i.baseInsertSlide=function(e){var t=e.layoutType,n=e.activeSlideIndex,r=e.noPh,a=i.selection.getSlideCount();if((isNaN(n)||null===n)&&(n=i.shellDoc.getActiveSlideIdx()),n=Math.min(a-1,n),n=Math.max(-1,n),0!==i.shellDoc.getSlideLayoutsCount()){0===a&&(n=-1);var o=i.getLocalSelection();o&&(r?o.insertSlideNoPh(n+1,t):o.insertSlide(n+1,t)),i.shellDoc.setActiveSlide(n+1),window.collection("newui","value",window.pcTrack.newui.slide_add)}},i.moveSlide=function(e){var t=e.from,n=e.offset,r=i.getLocalSelection();r&&r.moveSlide(t,n)},i.init(),i.debounceInsertSlide=Object(Cn.debounce)(i.baseInsertSlide,100),i}return u()(t,e),o()(t,[{key:"insertSlideByUrl",value:function(e){var t=this,i=e.url,n=e.slideIdx,r=void 0===n?0:n,a=e.pos,o=i,s="/api/v3/office/file/"+window.urlFileId+"/object/wpp?connid="+window.RPCClient.clientID,l=new FormData;return l.append("object_url",o),window.__WPSENV__.request({method:"POST",url:s,body:l}).end().then((function(e){var i=JSON.parse(e.target.response);return t._insertSlideByUploadId(i.uploadid,r,a)})).catch((function(e){return Promise.reject({type:"error",message:"3/4: The file upload to the server failed!"})}))}},{key:"_insertSlideByUploadId",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments[2];return new Promise((function(r,a){var o=t.selection.getSlideCount();(isNaN(n)||null===n)&&(n=t.shellDoc.getActiveSlideIdx()),n=Math.min(o-1,n),n=Math.max(-1,n);var s=t.selection.getPresentation();s.on(s.constructor.EventTypes.NOTIY_BACKEND_CMD,(function e(i){var n=i.event,o=i.param;if(n===Pu.default.server_doctemplate_end)if(s.off(s.constructor.EventTypes.NOTIY_BACKEND_CMD,e),o.success){var l=o.data;l&&l.slideIdx&&t.selection.selectSlideAt(l.slideIdx),r({type:"success"})}else a({type:"error",message:"4/4: The core failed to create a new slide!"})})),window.APP.coreAPI.beginCommand(),window.APP.coreAPI.setCooperHandler("insertDocerSlide"),t.selection.insert3rdpartySlide(n+1,i,e),window.APP.coreAPI.endCommand()}))}},{key:"modelNames",get:function(){return[Fp.a.CONTAINER]}}]),t}(kp.default),$p=i(2724),ef=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.init=function(){i.addKeyDownListener({keyCode:ru.a.A,ctrlKey:!0},i.selectAll),i.addKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut),i.addKeyDownListener({keyCode:ru.a.L,ctrlKey:!0},i.align_left),i.addKeyDownListener({keyCode:ru.a.E,ctrlKey:!0},i.align_horiz),i.addKeyDownListener({keyCode:ru.a.R,ctrlKey:!0},i.align_right),i.addKeyDownListener({keyCode:ru.a.J,ctrlKey:!0},i.align_both),i.addKeyDownListener({keyCode:ru.a.J,ctrlKey:!0,shiftKey:!0},i.align_decentralized),i.addKeyDownListener({keyCode:ru.a.G,ctrlKey:!0,altKey:!0},i.shapeGroup),i.addKeyDownListener({keyCode:ru.a.G,ctrlKey:!0,altKey:!0,shiftKey:!0},i.shapeUngroup),i.addKeyDownListener({keyCode:ru.a.B,ctrlKey:!0},i.bold),i.addKeyDownListener({keyCode:ru.a.I,ctrlKey:!0},i.italic),i.addKeyDownListener({keyCode:ru.a.U,ctrlKey:!0},i.underline),i.addKeyDownListener({keyCode:ru.a.D,ctrlKey:!0},i.duplicate),i.addKeyDownListener({keyCode:ru.a.LEFT_PARENTHESIS,ctrlKey:!0},i.font_size_minus),i.addKeyDownListener({keyCode:ru.a.RIGHT_PARENTHESIS,ctrlKey:!0},i.font_size_add),i.addKeyDownListener({keyCode:ru.a.TAB},i.tabPress),i.addKeyDownListener({keyCode:ru.a.TAB,shiftKey:!0},i.shiftTabPress)},i.destroy=function(e){i.removeKeyDownListener({keyCode:ru.a.A,ctrlKey:!0},i.selectAll),i.removeKeyDownListener({keyCode:ru.a.X,ctrlKey:!0},i.cut),i.removeKeyDownListener({keyCode:ru.a.L,ctrlKey:!0},i.align_left),i.removeKeyDownListener({keyCode:ru.a.E,ctrlKey:!0},i.align_horiz),i.removeKeyDownListener({keyCode:ru.a.R,ctrlKey:!0},i.align_right),i.removeKeyDownListener({keyCode:ru.a.J,ctrlKey:!0},i.align_both),i.removeKeyDownListener({keyCode:ru.a.J,ctrlKey:!0,shiftKey:!0},i.align_decentralized),i.removeKeyDownListener({keyCode:ru.a.G,ctrlKey:!0,altKey:!0},i.shapeGroup),i.removeKeyDownListener({keyCode:ru.a.G,ctrlKey:!0,altKey:!0,shiftKey:!0},i.shapeUngroup),i.removeKeyDownListener({keyCode:ru.a.B,ctrlKey:!0},i.bold),i.removeKeyDownListener({keyCode:ru.a.I,ctrlKey:!0},i.italic),i.removeKeyDownListener({keyCode:ru.a.U,ctrlKey:!0},i.underline),i.removeKeyDownListener({keyCode:ru.a.D,ctrlKey:!0},i.duplicate),i.removeKeyDownListener({keyCode:ru.a.LEFT_PARENTHESIS,ctrlKey:!0},i.font_size_minus),i.removeKeyDownListener({keyCode:ru.a.RIGHT_PARENTHESIS,ctrlKey:!0},i.font_size_add),i.removeKeyDownListener({keyCode:ru.a.TAB},i.tabPress),i.removeKeyDownListener({keyCode:ru.a.TAB,shiftKey:!0},i.shiftTabPress)},i.select=function(e){var t=i.getNormalRange(),n=t.pos;0===t.len&&i.getLocalSelection().selectText(n,n+1)},i.selectAll=function(e){var t=i.getLocalSelection();if(t.state===Tp.SelectType.select_text){var n=t.getActiveTextStream();if(n){var r=n.getCharCount()-1;t.selectText(0,r)}}else if(t.state===Tp.SelectType.select_multi_cell||t.state===Tp.SelectType.select_cell){var a=i.selection.getActiveTableFrame().getColumnCount(),o=i.selection.getActiveTableFrame().getRowCount();i.selection.selectTableCells(0,0,o,a)}else i.editor.slide.selectAll(e)},i.cut=function(e){i.editor.common.cut(e)},i.font_size_add=function(e){i.editor.chapter.growUp(!0)},i.font_size_minus=function(e){i.editor.chapter.growUp(!1)},i.align_left=function(e){var t=i.editor.paragraph;1===t.getAlignment()?t.setAlignment(Tp.HorzAlignMode.Adjustify):t.setAlignment(Tp.HorzAlignMode.Left)},i.align_horiz=function(e){var t=i.editor.paragraph;2===t.getAlignment()?t.setAlignment(Tp.HorzAlignMode.Adjustify):t.setAlignment(Tp.HorzAlignMode.Center)},i.align_right=function(e){var t=i.editor.paragraph;3===t.getAlignment()?t.setAlignment(Tp.HorzAlignMode.Adjustify):t.setAlignment(Tp.HorzAlignMode.Right)},i.align_both=function(e){i.editor.paragraph.setAlignment(Tp.HorzAlignMode.Adjustify)},i.align_decentralized=function(e){var t=i.editor.paragraph;5===t.getAlignment()?t.setAlignment(Tp.HorzAlignMode.Adjustify):t.setAlignment(Tp.HorzAlignMode.FullAdjustify)},i.setAnchorType=function(e){e!==i.getAnchorType()&&i._setTextFrameProperty({anchorType:e})},i.setAutoFit=function(e){e!==i.getAutoFit()&&i._setTextFrameProperty({autoFit:e})},i.reduce_indentation=function(e){i.workspace.presentation.selection.fmtPapx({tabIndent:-1})},i.increase_indentation=function(e){i.workspace.presentation.selection.fmtPapx({tabIndent:1})},i.sub_script=function(e){var t=i.editor.chapter;t.setSubscript(!t.getSubscript())},i.super_script=function(e){var t=i.editor.chapter;t.setSuperscript(!t.getSuperscript())},i.bold=function(e){var t=i.editor.chapter;t.setBold(!t.getBold())},i.italic=function(e){var t=i.editor.chapter;t.setItalic(!t.getItalic())},i.underline=function(e){var t=i.editor.chapter,n=t.getUnderline();t.setUnderline(n&&n.underlineType?Tp.UnderlineType.wpsUnderlineNone:Tp.UnderlineType.wpsUnderlineSingle)},i.del_line=function(e){var t=i.editor.chapter;t.setStrikeThrough(!t.getStrikeThrough())},i.save=function(e){i.workspace.showToast("success",_i18n("applications.presentation.app.shell.editor.model.shapeModel.saveSuccess", "自动保存成功"))},i.tabPress=function(e){var t=i.selection,n=t.getActiveShapes(),r=n&&n[0],a=r&&r.getShapeType();a&&t.state===Tp.SelectType.select_text&&a!==v.ShapeType.Table&&i.editor.paragraph.setIndentation(!1)},i.shiftTabPress=function(e){var t=i.selection,n=t.getActiveShapes(),r=n&&n[0],a=r&&r.getShapeType();a&&t.state===Tp.SelectType.select_text&&a!==v.ShapeType.Table&&i.editor.paragraph.setIndentation(!0)},i.shapeGroup=function(){var e=i.selection.canGroup().errtype;Object($p.a)(e,(function(){window.collection("newui","value","group_shortcut"),i.selection.shapeGroup()}))},i.shapeUngroup=function(){i.selection.shapeUngroup(),window.collection("newui","value","group_cancel_shortcut")},i.duplicate=function(){if(!window.APP||window.APP.canCopy()){var e=i.selection.getActiveShapes();if(e&&!(e.length<=0)){var t=1/0,n=1/0,r=e.every((function(e,r){var a=e.visual.getRealTransform2D();if(t=Math.min(a.x/635,t),n=Math.min(a.y/635,n),i.duplicateOffSet){for(var o in a)if(a.hasOwnProperty(o)){var s=i.duplicateOffSet.transform[r][o];if("number"==typeof a[o]&&Math.abs((a[o]-s)/635)>=1||"boolean"==typeof a[o]&&a[o]!==s)return!1}return!0}return!0}))&&i.duplicateOffSet&&i.duplicateOffSet.version===i.selection.getVersion(),a=200,o=200;r&&(a=i.duplicateOffSet.x,o=i.duplicateOffSet.y,i.duplicateOffSet.transform=[],e.forEach((function(e){var t=e.visual.getRealTransform2D(),n=Object.assign({},t);n.x=Math.round(635*(t.x/635+a)),n.y=Math.round(635*(t.y/635+o)),i.duplicateOffSet.transform.push(n)}))),i.selection.selectShapes(e),i.selection.dragPasteShapes({extraDatas:{adjustShapeType:2,newPos:{x:Math.round(t+a),y:Math.round(n+o)}}}),i.duplicateOffSet&&(i.duplicateOffSet.version=i.selection.getVersion()),window.collection("newui","value","ctrl_d")}}else Yp.canRequestForAuthForSecurityDoc&&Object(Yp.isCopyLimitedSecurityDoc)()?Object(Yp.requestForAuth)({type:Yp.AUTH_TYPES.COPY}):i.showToast("warn",_i18n("applications.presentation.app.shell.editor.model.shapeModel.cannotOperate", "你没有此操作的权限，请联系所有者修改权限"))},i.getActiveShapeImg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isOrigin;return new Promise((function(e,n){var r=i.selection.getActiveShapes();if(r&&1===r.length){var a=r[0],o=a&&a.getShapeType();if(!o||o!==v.ShapeType.Picture&&o!==v.ShapeType.Processon)n({type:"error",message:"The active shape is not a single picture!"});else{var s=a.getPicture().blip.blipAtom.imageId,l={slideId:a.getSlideId(),shapeId:a.getId(),imageId:s,noNeedLoad:!0,origin:t},h=function(t,i){i?e({type:"success",message:{url:i.data_url}}):n({type:"error",message:"Can't get the url of this picture!"},t)},u=window.backendImageManager.fetchImageSync(l);u&&u.image&&u.image.data_url?h(void 0,u.image):window.backendImageManager.fetchImage(_()({},l,{cb:h,getUrl:!0}))}}else n({type:"error",message:"The active shape is not a single picture!"})}))},i.init(),i}return u()(t,e),o()(t,[{key:"getAnchorType",value:function(){var e=this.editor.getSelShapeAttrs(),t=void 0;return e&&e.textBodyStyle&&void 0!==e.textBodyStyle.anchorType&&(t=e.textBodyStyle.anchorType,e.textBodyStyle.anchorCenter&&(t=void 0)),t}},{key:"setFontScale",value:function(e){this.selection.modifyTextFrameProperty({fontScale:e},!1)}},{key:"setDuplicateOffSet",value:function(e){this.duplicateOffSet=e}},{key:"modelNames",get:function(){return[Fp.a.SHAPE]}}]),t}(kp.default),tf=i(376),nf=(Jp={},d()(Jp,Tp.WpActionType.ActionFirstSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.firstSlide", "第一页幻灯片")),d()(Jp,Tp.WpActionType.ActionLastSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.lastSlide", "最后一页幻灯片")),d()(Jp,Tp.WpActionType.ActionPreviousSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.previousSlide", "上一页幻灯片")),d()(Jp,Tp.WpActionType.ActionNextSlide,_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.nextSlide", "下一页幻灯片")),Jp),rf=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._getDataByPointer=function(e){var t=i.editor.coreView.hitTest(e.left,e.top);return i.getDataByHitTestRet(t)},i.getDataByHitTestRet=function(e){var t=function(e){if(e&&e.hitTestInfo){var t=e.shape,n=e.hitTestInfo.textHyperlink,r=i._getShape(e),a=i._getTextLink(n,r)||i._getShapeLink(r);return!!a&&_()({},a,{viewShape:t})}};return e&&(t(e)||t(e.otherLayerHitRestRet))},i.dispatchEvent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=document.createEvent("CustomEvent");r.initCustomEvent(e,i,n,t),window.dispatchEvent(r)},i.changeSelectText=function(){var e=i.getLocalSelection(),t=i.getTextHyperlink();if(i._isSelectText()&&t){var n=t.beginEnd;Array.isArray(t)&&(n=t.reduce((function(e,t){return e||(e=_()({},t.beginEnd)),e.begin=Math.min(e.begin,t.beginEnd.begin),e.end=Math.max(e.end,t.beginEnd.end),e}),null));var r=e.getRange(),a=r.begin,o=r.end;(a>n.begin||o<n.end)&&(void 0!==t.cellIndex&&e.selectTableCellAt(t.cellIndex),e.selectText(Math.min(a,n.begin),Math.max(o,n.end)))}},i.isSameLink=function(e){var t=i.linkMaster;if(!e||!t)return!1;return["slideId","shapeId","beginEnd","cellIndex"].every((function(i){return t[i]===e[i]||("beginEnd"===i?!(!t[i]||!e[i]||t[i].begin!==e[i].begin||t[i].end!==e[i].end):void 0)}))},i.isLegalURL=function(e){return Object(tf.isLegalURL)(e)},i.lock=!1,i}return u()(t,e),o()(t,[{key:"initData",value:function(e){if(!this.lock){this.clearData();var t=this.getData(e);t&&this.setData(t)}}},{key:"initDataByHitInfo",value:function(e){if(!this.lock){this.clearData();var t=this.getDataByHitTestRet(e);t&&this.setData(t)}}},{key:"getData",value:function(e){return e?this._getDataByPointer(e):this._getDataBySelection()}},{key:"setData",value:function(e){var t=e.linkMaster,i=e.coreData,n=e.viewShape;this.linkMaster=t,this.coreData=i,this.viewShape=n,this._setViewData()}},{key:"clearData",value:function(){this.coreData=null,this.linkMaster=null,this.viewShape=null,this.viewData=null}},{key:"lockInit",value:function(){var e=this;this.lock=!0,setTimeout((function(){e.lock=!1}),500)}},{key:"_isSelectText",value:function(){return this.getLocalSelection().state===Tp.SelectType.select_text}},{key:"_isSelectShape",value:function(){return this.getLocalSelection().state===Tp.SelectType.select_shape}},{key:"_getShapeLink",value:function(e){if(!e||!this.isSupportShape(e))return!1;var t=e.getActions(),i=t&&t.mouseClick;return i&&Tp.SupLinkType.includes(i.action)?{coreData:i,linkMaster:{slideId:e.getSlideId(),shapeId:e.getId()}}:void 0}},{key:"_getTextLink",value:function(e,t){if(!e||!t)return!1;Array.isArray(e)&&(e=e[0]);var i=e.mouseClick;return i&&Tp.SupLinkType.includes(i.action)?{coreData:i,linkMaster:{beginEnd:e.beginEnd,cellIndex:e.cellIndex,slideId:t.getSlideId(),shapeId:t.getId()}}:void 0}},{key:"_getDataBySelection",value:function(){var e=this.getLocalSelection().getActiveShapes();if(!e||1!==e.length)return!1;var t=e[0];if(this._isSelectShape())return this._getShapeLink(t);if(this._isSelectText()){var i=this.getTextHyperlink();return this._getTextLink(i,t)}}},{key:"_getShape",value:function(e){var t=e.shape,i=t&&t.getData();if(i){if(i.getShapeType()!==Tp.ShapeType.GroupShape)return i;var n=e.childShapeHit;if(n&&n.isHit){var r=n.shape;return r&&r.getData()}return null}}},{key:"_setViewData",value:function(){var e=this.coreData,t=e.action,i=e.hyperlink,n=i&&i.address,r=i&&i.link;if(t===Tp.WpActionType.ActionHyperlink&&void 0!==n){if(/^mailto:.*/.test(n)){var a=n.split(/mailto:|\?subject=/)[1];this.viewData={linkType:Tp.LinkType.email,address:a}}else this.viewData={address:n,linkType:Tp.LinkType.web}}else if(t===Tp.WpActionType.ActionHyperlink){var o=r?r.split(","):[];this.viewData={linkType:Tp.LinkType.slideAsl,linkSlideId:Number(o[0])}}else if(void 0!==nf[t]){var s=r&&r.split(",");this.viewData={linkType:Tp.LinkType.slideRlt,address:nf[t],linkSlideId:s&&Number(s[0])}}else this.viewData={}}},{key:"getViewAddress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getLinkType()===Tp.LinkType.slideAsl){var t=this.shellDoc.coreView.getIndexBySlideId(this.viewData.linkSlideId);if(!(t>=0))return!!e&&_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.none", "幻灯片不存在或被删除");this.viewData.address=_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slidePage", "第{0}页幻灯片").replace("{0}",t+1)}return this.viewData&&this.viewData.address}},{key:"getLinkSlideIndex",value:function(){var e=this.getLinkType(),t=this.shellDoc.coreView.getIndexBySlideId(this.viewData.linkSlideId),i=this.slideCount;if(e===Tp.LinkType.slideRlt){var n=this.shellDoc.coreView.getIndexBySlideId(this.slideId),r=void 0;switch(this.coreData.action){case Tp.WpActionType.ActionFirstSlide:r=0;break;case Tp.WpActionType.ActionLastSlide:r=i-1,this.fireLimitMsg(t);break;case Tp.WpActionType.ActionPreviousSlide:r=0===n?0:n-1;break;case Tp.WpActionType.ActionNextSlide:r=n===i-1?i-1:n+1,this.fireLimitMsg(Math.max(i-1,n+1))}return r}if(e===Tp.LinkType.slideAsl)return this.fireLimitMsg(t),Math.min(t,i-1)}},{key:"fireLimitMsg",value:function(e){var t=this.getLocalSelection().getSlideCount(),i=this.slideCount;i<t&&(e>i-1||e<0)&&this.dispatchEvent("openapi.on.preview.limit",{slideIndex:e,limitCount:i,slideCount:t})}},{key:"getLinkType",value:function(){return this.viewData&&this.viewData.linkType}},{key:"getTextHyperlink",value:function(){var e=this.getChpx();return void 0===e||void 0===e.textHyperlink?null:e.textHyperlink}},{key:"getRect",value:function(){if(this.hasLink&&this.viewShape){var e=this.viewShape.layout();if(!this.isTextLink)return e.getUilRotatedLayoutRect(this.scale);e.updateRatio(this.scale);var t=e.getSelectRectByGcp(_()({},this.beginEnd,{cellIndex:this.cellIndex})),i=t&&t[0]&&t[0][0];return i?e.getRotatedRect(i):void 0}}},{key:"isSupportShape",value:function(e){switch(e.getShapeType()){case Tp.ShapeType.NormalShape:if(e.isInk())return!1;if(e.isTowControlPointShapeType())return!1;case Tp.ShapeType.Picture:if(e.isMedia())return!1;case Tp.ShapeType.TextBox:if(e.isPlaceHolder()&&!e.hasContent())return!1;if(e.isPlaceHolder()&&this.isMasterView)return!1;case Tp.ShapeType.Chart:case Tp.ShapeType.OleShape:return!0;default:return!1}}},{key:"modifyLink",value:function(e,t){var i=this,n=this.getLocalSelection();if(n.state===Tp.SelectType.select_shape){var r=window.APP.utils.createModifier("Actions");r.modify("mouseClick",e),n.modifyShapeProperties(r)}else n.editBatchDatas((function(){var r=(n.getText()||[]).join(""),a=n.getRange(),o=a.begin;if((o===a.end||t&&r!==t)&&(n.insertText(t),n.selectText(o,o+t.length)),i.editor.chapter.isEnable())i.editor.chapter.setActions({mouseClick:e});else{i._modifyLinkTime=Date.now();i.editor.chapter.on(Tp.EditorEventTypes.SELECT_CHANGE,(function t(){i.editor.chapter.off(Tp.EditorEventTypes.SELECT_CHANGE,t),Date.now()-i._modifyLinkTime<500&&i.editor.chapter.setActions({mouseClick:e})}))}}),{bKeepCurrentSeletion:!1,bFireSeletionChange:!1})}},{key:"selectSelf",value:function(){var e=this.getLocalSelection(),t=e.getActiveSlide(),i=t&&t.findShapeById(this.shapeId);i&&(e.clearTextSelect(),e.selectShape(i),this.beginEnd&&(void 0!==this.cellIndex&&e.selectTableCellAt(this.cellIndex),e.selectText(this.beginEnd.begin,this.beginEnd.end)))}},{key:"open",value:function(){if(this.hasLink)switch(this.getLinkType()){case Tp.LinkType.email:case Tp.LinkType.web:Object(tf.openHyperlink)(this.coreAddress);break;case Tp.LinkType.slideRlt:case Tp.LinkType.slideAsl:var e=this.getLinkSlideIndex();console.log("link open",e),e>=0?lt.default.dispatchEvent(lt.default.hyperlinkType.OPEN_LINK_TO_SLIDE,{index:e}):window.Toast.warn(_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slideDeleted", "链接的幻灯片已被删除"))}}},{key:"slideCount",get:function(){var e=this.workspace.presentation,t=e.getSlideCount(),i=e.slidesPreviewLimit();return i>0&&i<=t&&(t=i),t}},{key:"hasLink",get:function(){return!!this.coreData}},{key:"isTextLink",get:function(){return!(!this.linkMaster||!this.linkMaster.beginEnd)}},{key:"slideId",get:function(){return this.linkMaster&&this.linkMaster.slideId}},{key:"shapeId",get:function(){return this.linkMaster&&this.linkMaster.shapeId}},{key:"beginEnd",get:function(){return this.linkMaster&&this.linkMaster.beginEnd}},{key:"cellIndex",get:function(){return this.linkMaster&&this.linkMaster.cellIndex}},{key:"scale",get:function(){return this.shellDoc.svgLayout.bestZoom}},{key:"coreAddress",get:function(){return this.coreData&&this.coreData.hyperlink&&this.coreData.hyperlink.address}},{key:"action",get:function(){return this.coreData&&this.coreData.action}}]),t}(kp.default),af=i(810),of=function(){function e(){r()(this,e)}return o()(e,[{key:"getData",value:function(e,t){var i=t.shape,n=t.slide,r=_()({},e.color);if(i){var a=window.CoreUtils.getColorDelegation("fill",i,n);r=window.CoreUtils.interpretColor(e.color,a)}return{type:e.type,hex:r.hex,trans:Math.round(100-100*r.alpha)}}},{key:"mergeData",value:function(e,t){var i=_()({},e);return t.hex!==e.hex&&(i.hex=""),t.trans!==e.trans&&(i.trans=0),{fill:i,isDiff:""===i.hex&&0===i.trans}}},{key:"getModifier",value:function(){return window.APP.utils.createModifier("Fill")}},{key:"getModifyData",value:function(e,t){switch(e){case"trans":return{tag:"opacity",value:parseInt(100-t)/100};case"hex":return{value:t,tag:"color.rgb"};case"fill":var i=window.CoreTypes.Color.fromString(t.hex).data;return t.trans&&!isNaN(t.trans)||(t.trans=0),i.transOp=[{op:0,val:parseInt(100-t.trans)/100}],{tag:e,value:{type:Tp.FillType.FillTypeSolidColor,color:i}}}}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),sf=function(){function e(t){var i=this;r()(this,e),this.getBlibRatio=function(e){var t=e.imageHeight,n=e.imageWidth,r=e.shapeView,a=void 0;r?a=r.layout().getUilLayoutRect(i.scale):a=i.doc.slideLayout().svgLayout;return{scaleW:Number((a.width/n).toFixed(2)),scaleH:Number((a.height/t).toFixed(2)),frameW:a.width,frameH:a.height}},this.getScaleRatio=function(e){var t=e.scaleW,i=e.scaleH,n=e.frameW,r=e.frameH,a=e.imageHeight,o=e.imageWidth,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=void 0,h=void 0,u=s?t>i:t<i;if(u){var c=o*i;l=Number(((n-c)/2/n).toFixed(2)),h="x"}if(u=s?t<i:t>i){var d=a*t;l=Number(((r-d)/2/r).toFixed(2)),h="y"}return{ratio:l,direction:h}},this.parent=t.parent}return o()(e,[{key:"getData",value:function(e,t){var i=t.shapeView;if(!e.blip||!e.blip.blipAtom)return{type:e.type,blibFillType:e.isStretched?Tp.BlibFillType.stretch:Tp.BlibFillType.tile};var n=e.isStretched,r=e.stretchRectangle;return _()({},e.blip.blipAtom,{type:e.type,picFillType:this.getBlibFillType(_()({},e.blip.blipAtom,{isStretched:n,stretchRectangle:r,shapeView:i}))})}},{key:"mergeData",value:function(e,t){var i=_()({},e);return t.imageId!==e.imageId&&(i.imageId=-1),t.picFillType!==e.picFillType&&(i.picFillType=Tp.BlibFillType.other),t.format!==e.format&&(i.format="..."),t.imageId===e.imageId&&t.dpiX===e.dpiX&&t.dpiY===e.dpiY||(i.dpiX=-1,i.dpiY=-1),t.imageId===e.imageId&&t.imageHeight===e.imageHeight&&t.imageWidth===e.imageWidth||(i.imageHeight=-1,i.imageWidth=-1),t.imageId===e.imageId&&t.size===e.size||(i.size=-1),{fill:i,isDiff:i.picFillType===Tp.BlibFillType.other&&-1===i.imageId}}},{key:"getModifier",value:function(){return window.APP.utils.createModifier("BlipFill")}},{key:"getModifyData",value:function(e,t,i,n){var r=t.picFillType,a=t.imageId,o=t.imageHeight,s=t.imageWidth,l=n||this.parent.getSlideCoreFill();if(!this._isLegalParam(a,o,s)){var h=l&&l.blip&&l.blip.blipAtom;if(h&&(a=h.imageId,o=h.imageHeight,s=h.imageWidth),!this._isLegalParam(a,o,s))return!1}var u=l&&l.blip&&l.blip.effects||[],c={type:Tp.FillType.FillTypeBlip,isStretched:!0,blip:{effects:Object(nu.a)(u),blipAtom:{imageId:a,imageHeight:o,imageWidth:s}}};if(r===Tp.BlibFillType.tile)Object.assign(c,{isStretched:!1,tileHorizontalRatio:1,tileVerticalRatio:1});else if(r!==Tp.BlibFillType.stretch){var d=this.getBlibRatio({imageHeight:o,imageWidth:s,shapeView:i}),p=r===Tp.BlibFillType.scaleSuit?this.getScaleRatio(_()({},d,{imageHeight:o,imageWidth:s}),!0):this.getScaleRatio(_()({},d,{imageHeight:o,imageWidth:s})),f=p.ratio,g=p.direction;"x"===g?c.stretchRectangle={left:f,right:f,bottom:0,top:0}:"y"===g&&(c.stretchRectangle={left:0,right:0,bottom:f,top:f})}return{tag:e,value:c}}},{key:"_isLegalParam",value:function(e,t,i){var n=void 0===e?"undefined":I()(e);return("number"===n&&e>0||"string"===n&&e)&&t>0&&i>0}},{key:"getBlibFillType",value:function(e){var t=e.imageHeight,i=e.imageWidth,n=e.isStretched,r=e.stretchRectangle,a=e.shapeView,o=this.getBlibRatio({imageHeight:t,imageWidth:i,shapeView:a});if(n){if(o.scaleW===o.scaleH)return Tp.BlibFillType.scaleFill;if(r){var s=r.left,l=r.right,h=r.top,u=r.bottom;if(s===l&&0===h&&0===u||h===u&&0===s&&0===l){var c=this.getScaleRatio(_()({},o,{imageHeight:t,imageWidth:i}),!0);if(this.isScale(_()({},c,{xRatio:s,yRatio:h})))return Tp.BlibFillType.scaleSuit;if(c=this.getScaleRatio(_()({},o,{imageHeight:t,imageWidth:i})),this.isScale(_()({},c,{xRatio:s,yRatio:h})))return Tp.BlibFillType.scaleFill}}return Tp.BlibFillType.stretch}return Tp.BlibFillType.tile}},{key:"isScale",value:function(e){var t=e.direction,i=e.ratio,n=e.xRatio,r=e.yRatio;return"x"===t&&n===i||"y"===t&&r===i}},{key:"doc",get:function(){return this.parent&&this.parent.editor.coreView.doc}},{key:"scale",get:function(){var e=this.doc.slideLayout();return e.scale*e.bestZoom}}],[{key:"getInstance",value:function(t){return this._instance=this._instance||new e(t),this._instance}}]),e}(),lf=function(){function e(){r()(this,e)}return o()(e,[{key:"getModifyData",value:function(e,t){return{tag:e,value:t}}},{key:"getData",value:function(e){return e}},{key:"mergeData",value:function(e,t){return{fill:e,isDiff:!1}}},{key:"getModifier",value:function(){return window.APP.utils.createModifier("Fill")}}],[{key:"getInstance",value:function(){return this._instance=this._instance||new e,this._instance}}]),e}(),hf=function(e){function t(){var e,i,n,a;r()(this,t);for(var o=arguments.length,s=Array(o),h=0;h<o;h++)s[h]=arguments[h];return i=n=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n._getModifier=function(e){var t=e.type,i=e.tag,r=e.value,a=e.shapeView,o=e.curFill,s=n.getFillOperator(t),l=s.getModifier(),h=s.getModifyData(i,r,a,o);return l.modify(h.tag,h.value),l},n._setSlideFill=function(e){var t=e.type,i=e.tag,r=e.value,a=e.shapeView;if(e.isModifyAll){var o=n.getSlideCoreFill(),s=n.getFillOperator(o.type).getModifier();s.modify("fill",o),s.setName("Background"),n.localSlt.modifySlideBackground(s,!0)}else{var l=n._getCurSlideProxys(),h=l&&l.map((function(e){if(e.bLoaded){var o=n.workspace.presentation.getSlideById2(e.category,null,e.slideId),s=n.getSlideCoreFill(o),l=n._getModifier({type:t,tag:i,value:r,shapeView:a,curFill:s});return l.setName("Background"),{slide:o,modifier:l}}})).filter(Boolean);if(h&&h.length>0){var u=n.localSlt.transaction;u.beginBatchCommand(),u.setCooperHandler("modifySlideProps"),n.localSlt.modifySlidePropertiesV2(h);var c=h[0].modifier&&h[0].modifier.trimmedModifiers();u.setUserData("props",{modifiers:c}),u.setActionName("background"),u.endBatchCommand()}}},n._getCurSlideProxys=function(){var e=n.editor.getLocalSelection().getSlideMarker();return e&&e.fetch()},n._getShapeFill=function(e){var t=e.getId(),i=n.shellDoc.getShapeInActiveSlide(t);if(e.getShapeType()!==v.ShapeType.Table){if(i&&i.isLocalShape()){var r,a=i.layout();return r=a&&a.getShapeFill(),n.getFillData(r,{shapeView:i})}var o=e.visual.getFill();return n.getFillData(o,{shape:e,shapeView:i})}var s,l=n.localSlt.getActiveTableCells();if((!l||l.length<=0)&&(l=e.getChilds()[0].getChilds()),l){var h=(s=[],l.forEach((function(t){var r=t.visual.getFill();r&&(r=n.getFillData(r,{shape:e,shapeView:i}),s.push(r))})),s);return n._mergeFill(h)}},n.getSlideFill=function(e){var t=e&&e.visual.getBackgroundShape(),i=t&&t.getFill()?t.getFill():{type:0};return n.getFillData(i,{shape:t,slide:e})},n.getFillData=function(e,t){var i=t.shape,r=t.slide,a=t.shapeView,o=e&&n.getFillOperator(e.type);return o&&o.getData(e,{shape:i,slide:r,shapeView:a})},n.getSlideCoreFill=function(e){var t=e||n.localSlt.getActiveSlide(),i=t&&t.visual.getBackgroundShape();return i&&i.getFill()?i.getFill():{type:0}},a=i,l()(n,a)}return u()(t,e),o()(t,[{key:"getFillOperator",value:function(e){switch(e){case Tp.FillType.FillTypeSolidColor:return of.getInstance();case Tp.FillType.FillTypeBlip:return sf.getInstance({parent:this});default:return lf.getInstance()}}},{key:"getFill",value:function(){var e=this;if(this.localSlt.state===Tp.SelectType.select_slide){var t=this._getCurSlideProxys(),i=t&&t.map((function(t){if(t.bLoaded){var i=e.workspace.presentation.getSlideById2(t.category,null,t.slideId);return e.getSlideFill(i)}})).filter(Boolean);return this._mergeFill(i)}var n=this.localSlt.getActiveShapes();if(n&&n.length>0){var r=n.map((function(t){return t.isBackgroundFillUsed()?{type:Tp.FillType.FillTypeBackground}:e._getShapeFill(t)}));return this._mergeFill(r)}}},{key:"setFill",value:function(e,t){var i=e.type,n=e.tag,r=e.value,a=e.shapeView,o=e.isModifyAll,s=e.isEnd,l=void 0===s||s,h=e.isModifySlide,u=void 0!==h&&h,c=window.APP.coreAPI;if(c.isCommandStarted(t)||c.beginCommand(t),c.isCommandStarted(t))if(u||o||this.localSlt.state===Tp.SelectType.select_slide)this._setSlideFill({type:i,tag:n,value:r,shapeView:a,isModifyAll:o});else{var d=this._getModifier({type:i,tag:n,value:r,shapeView:a});switch(this.localSlt.state){case Tp.SelectType.select_shape:case Tp.SelectType.select_multi_shape:this.localSlt.modifyShapeProperties(d);break;case Tp.SelectType.select_cell:case Tp.SelectType.select_multi_cell:this.localSlt.modifyTblCellProperties(d);break;case Tp.SelectType.select_text:var p=this.localSlt.getActiveTableCells();p&&p.length>0?this.localSlt.modifyTblCellProperties(d):this.localSlt.modifyShapeProperties(d)}}l&&c.endCommand()}},{key:"_mergeFill",value:function(e){var t=!!e&&_()({},e[0]);if(e&&e.length>1)for(var i=1;i<e.length;i++)if(e[i]){if(t.type!==e[i].type){t.type="other";break}var n=this.getFillOperator(t.type).mergeData(t,e[i]);if(t=n.fill,n.isDiff)break}return t}},{key:"getBlibRatio",value:function(e){return sf.getInstance().getBlibRatio(e)}},{key:"localSlt",get:function(){return this.getLocalSelection()}}]),t}(kp.default),uf=i(4962),cf=i.n(uf),df=i(4964),pf=i.n(df),ff=function(e){function t(){var e,i,n,a;r()(this,t);for(var o=arguments.length,s=Array(o),h=0;h<o;h++)s[h]=arguments[h];return i=n=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.defaultInfo={hex:"#AEB5C0",width:1},n.stashKey={connector:"connector"},n._stashMap={},n.getModifyData=function(e){var t=e.type,i=e.tag,r=e.value,a=n.fill.getFillOperator(t),o=void 0,s=i;switch(i){case"width":o={lineWidth:12700*r};break;case"lineType":o=Tp.LineValueMap[r];break;case"headEnd":case"tailEnd":o=r;break;case"outline":var l=r.fill,h=r.width,u=r.lineType,c=_()({},Tp.LineValueMap[u],{width:12700*h,joinType:0,miterLimit:8}),d=a.getModifyData("fill",l);c.fill=d.value,o=c;break;default:var p=a.getModifyData(i,r);s=p.tag,o=p.value}return{tag:s,value:o}},n.getLineType=function(e,t){var i=Tp.LineType.OTHER;switch(e){case 0:switch(t){case 0:i=Tp.LineType.SINGLE;break;case 2:i=Tp.LineType.SHORT_DASH;break;case 4:i=Tp.LineType.DASH_DOT;break;case 8:i=Tp.LineType.ROUND_DOT}break;case 1:switch(t){case 0:i=Tp.LineType.DOUBLE;break;case 8:i=Tp.LineType.DOUBLE_DOT}break;case 2:0===t&&(i=Tp.LineType.THICK_THIN);break;case 3:0===t&&(i=Tp.LineType.THIN_THICK);break;case 4:0===t&&(i=Tp.LineType.THIN_THICK_THIN)}return i},a=i,l()(n,a)}return u()(t,e),o()(t,[{key:"setOutline",value:function(e,t){var i=e.type,n=e.tag,r=e.value,a=e.isEnd,o=void 0===a||a,s=e.isStash,l=void 0!==s&&s,h=window.APP.utils.createModifier("Outline"),u=this.getModifyData({type:i,tag:n,value:r});h.modify(u.tag,u.value);var c=window.APP.coreAPI;if(c.isCommandStarted(t)||c.beginCommand(t),c.isCommandStarted(t))switch(c.setWaitCommands(["tableHandler","modifyShapeProps","modifySlideProps"]),this.localSlt.state){case v.SelectType.select_shape:this.localSlt.modifyShapeProperties(h);break;case v.SelectType.select_multi_shape:for(var p=this.getActiveShapes(!0),f=[],g=0;g<p.length;++g){if(p[g].hasTable())this.localSlt.getTableSelection().modifyTableProperty(h,p[g].getTableFrame());else f.push(p[g])}this.localSlt.applyShapeModifiers([h],f);break;case v.SelectType.select_text:var y=this.localSlt.getActiveTableCells();y&&1===y.length?this.localSlt.modifyTblCellProperties(h):this.localSlt.modifyShapeProperties(h);break;case v.SelectType.select_cell:case v.SelectType.select_multi_cell:this.localSlt.modifyTblCellProperties(h)}o&&c.endCommand(),l&&this.setStashInfo({value:d()({},n,r)})}},{key:"getOutline",value:function(){var e=this.localSlt.getActiveShapes();return this._getShapeArrOutline(e)}},{key:"_getShapeArrOutline",value:function(e){var t=this;if(e&&e.length>0){var i=e.map((function(e){if(e.isGroupShape()){var i=e.getChilds();return t._getShapeArrOutline(i)}return t._getViewData(e)})),n=this._mergeOutlines(i);return"object"===(void 0===n?"undefined":I()(n))&&(n.isInk=i.some((function(e){return e&&e.isInk}))),n}}},{key:"_getViewData",value:function(e){var t=this,i=e.getId(),n=this.shellDoc.getShapeInActiveSlide(i);if(e.getShapeType()===v.ShapeType.Table){var r=this.localSlt.getActiveTableCells();if(!r||r.length<=0)r=e.getChilds()[0].getChilds().filter((function(e){return e.getTextFrame()}));if(r.length>0){var a=r.map((function(i){var n=i.visual.getBorder(),r=[];for(var a in n){var o=t._getOutlineData(n[a],e);o.fill&&0!==o.fill.type&&r.push(o)}return t._mergeOutlines(r)}));return a=a.filter((function(e){return 0!==e.fill.type})),this._mergeOutlines(a)}}else{if(n&&n.isLocalShape()){var o=n.layout();if(e.isInk()){var s=o&&o.getExtendList();return s&&this._getViewInk(s.inkBody)}var l=o&&o.shapeProperty&&o.shapeProperty.outline;return this._getOutlineData(l,e)}if(n){var h=e.visual.getOutline();return this._getOutlineData(h,e)}}}},{key:"_getOutlineData",value:function(e,t){if(!e||!e.fill||!e.fill.type)return{fill:{type:Tp.FillType.FillTypeNone},isInk:!1};var i=this.fill.getFillData(e.fill,{shape:t}),n=this.getLineType(e.compoundLine,e.dashType),r=e.width?e.width/12700:1;return r=r>100?100:r,{fill:i,lineType:n,width:Number(r.toFixed(2)),isInk:!1,headEnd:e.headEnd||{type:0},tailEnd:e.tailEnd||{type:0},isSupportEndType:this.isSupportEndType(t)}}},{key:"_getViewInk",value:function(e){var t=e.getTraceVec(),i=t&&t[0]&&t[0].getBrushRef(),n=i&&e.getBrushMap()[i],r=n&&n.getColor();return r&&{isInk:!0,width:Number(n.getWidthBy(4).toFixed(2)),lineType:"",fill:{type:Tp.FillType.FillTypeSolidColor,hex:r.hex,trans:100-Math.round(100*r.alpha)}}}},{key:"_mergeOutlines",value:function(e){var t=!!e&&_()({},e[0]);t&&!t.fill&&(t.fill={type:Tp.FillType.FillTypeNone});var i=!1;if(e&&e.length>1)for(var n=1;n<e.length;n++){if(!t||!e[n]){t=!1;break}if(e[n].fill||(e[n].fill={type:Tp.FillType.FillTypeNone}),t.fill.type!==e[n].fill.type){t.fill.type="other";break}if(!i){var r=this.fill.getFillOperator(t.fill.type).mergeData(t.fill,e[n].fill);t.fill=r.fill,i=r.isDiff}if(e[n].width!==t.width&&(t.width=""),e[n].lineType!==t.lineType&&(t.lineType=Tp.LineType.OTHER),""===t.width&&t.lineType===Tp.LineType.OTHER&&i)break;t.isSupportEndType=t.isSupportEndType||e[n].isSupportEndType;var a=function(e,t){return e&&t&&e.type===t.type};t.headEnd=a(t.headEnd,e[n].headEnd)?t.headEnd:{type:0},t.tailEnd=a(t.tailEnd,e[n].tailEnd)?t.tailEnd:{type:0}}return t}},{key:"isSupportEndType",value:function(e){if(!e||!e.getGeometry2D())return!1;var t=Number(e.getShapeGroup())===v.ShapeGroupType.LineGroup,i=e.getGeometry2D(),n=i.isCustomGeometry()&&!i.isClosedCurve();if(t||n)return!0;var r=Number(e.getPresetShapeType());return r>=88&&r<94||r>=104&&r<=115}},{key:"setStashInfo",value:function(e){var t=e.key,i=e.value;(t=t||this.getStashKey())&&(this._stashMap[t]?Object.assign(this._stashMap[t],i):this._stashMap[t]=i)}},{key:"getStashInfo",value:function(e){return e=e||this.getStashKey(),this._stashMap[e]}},{key:"getStashKey",value:function(){var e=this.localSlt.getActiveShapes();if(e&&e.every((function(e){return e.isTowControlPointShapeType()})))return this.stashKey.connector}},{key:"localSlt",get:function(){return this.getLocalSelection()}},{key:"fill",get:function(){return this.editor.fill}}]),t}(kp.default),gf=i(4965),yf=i.n(gf),vf=i(4966),mf=i.n(vf),_f=i(4967),wf=i.n(_f),Sf=function(){function e(t,i){var n,a=this;r()(this,e),this._onCoreViewChange=function(e){a._fireModels(Tp.EditorEventTypes.SELECT_CHANGE,e)},this._fireModels=Object(Cn.debounce)((function(e){a._updateSelShapeAttrs();var t=a.getLocalSelection(),i=[],n=void 0;switch(t.state){case Tp.SelectType.select_slide:break;case Tp.SelectType.select_multi_animation:case Tp.SelectType.select_multi_shape:var r=t.getActiveShapes();r&&r.map((function(e){if(e.isGroupShape()&&!n){var t=e.getChilds();n=a.isIncludeParaAttrs(t)}else n||(n=a.isIncludeParaAttrs(r))})),n&&(i=[Tp.ModelNamesDef.paragraph,Tp.ModelNamesDef.chapter]);break;case Tp.SelectType.select_shape:var o=t.getActiveShapes(),s=o[0];if(a.isLocalShape){var l=s.getPlaceHolder();if(l&&l.type===Tp.PlaceholderType.Picture)break;var h=s.getTextFrame();h&&h.getTextStream&&(i=[Tp.ModelNamesDef.paragraph,Tp.ModelNamesDef.chapter])}var u=s.getShapeType();if(u===Tp.ShapeType.GroupShape){var c=s&&s.getChildShapesRecurse(),d=a.isIncludeParaAttrs(c);d&&(i=[Tp.ModelNamesDef.paragraph,Tp.ModelNamesDef.chapter])}else u===Tp.ShapeType.Table&&(i=[Tp.ModelNamesDef.paragraph,Tp.ModelNamesDef.chapter]);break;case Tp.SelectType.select_text:case Tp.SelectType.select_table:case Tp.SelectType.select_cell:case Tp.SelectType.select_multi_cell:i=[Tp.ModelNamesDef.paragraph,Tp.ModelNamesDef.chapter]}for(var p in a.models){var f=a.models[p];-1!==i.indexOf(p)?(f.setEnable(!0),p===Tp.ModelNamesDef.paragraph&&(f.isTitle=a.selAttrs&&a.selAttrs.isTitle),f.fireAsync(e,f)):(f.setEnable(!1),f.fireDirect(e,f))}}),100),this.props=t,this.shellDoc=i;var o={editor:this};this._uilHotkeys=Fp.c.getInstance(),this._models=(n={},d()(n,Tp.ModelNamesDef.paragraph,new Bp(o)),d()(n,Tp.ModelNamesDef.chapter,new Rp(o)),d()(n,Tp.ModelNamesDef.common,new Kp(o)),d()(n,Tp.ModelNamesDef.container,new Qp(o)),d()(n,Tp.ModelNamesDef.slide,new Zp(o)),d()(n,Tp.ModelNamesDef.shape,new ef(o)),d()(n,Tp.ModelNamesDef.link,new rf(o)),d()(n,Tp.ModelNamesDef.fill,new hf(o)),d()(n,Tp.ModelNamesDef.outline,new ff(o)),d()(n,Tp.ModelNamesDef.action,new yf.a(o)),d()(n,Tp.ModelNamesDef.ink,new cf.a(o)),d()(n,Tp.ModelNamesDef.connector,new pf.a(o)),d()(n,Tp.ModelNamesDef.explain,new mf.a(o)),n),this.uilTool=new wf.a}return o()(e,null,[{key:"getInstance",value:function(t){return this._instance=this._instance||new e(t),this._instance}}]),o()(e,[{key:"init",value:function(){this._unBindEvent(),this._bindEvent()}},{key:"getLocalSelection",value:function(){return this.workspace.getSelection()}},{key:"_bindEvent",value:function(){this.shellDoc.on(af.a.ACTIVE_SLIDE_CHANGE,this._onCoreViewChange)}},{key:"_unBindEvent",value:function(){this.shellDoc.off(af.a.ACTIVE_SLIDE_CHANGE,this._onCoreViewChange)}},{key:"getModelByName",value:function(e){return this.models[e]}},{key:"destroy",value:function(){for(var e in this.models){var t=this.models[e];t&&t.destroy()}this._unBindEvent()}},{key:"_updateSelShapeAttrs",value:function(){var e=this.getLocalSelection();if(e.state===Tp.SelectType.select_text||e.state===Tp.SelectType.select_multi_cell||e.state===Tp.SelectType.select_cell||e.state===Tp.SelectType.select_shape||e.state===Tp.SelectType.select_table){var t=e.getActiveShapes(),i=t&&t[0],n=i&&i.getId(),r=this.coreView.doc.activeSlide,a={},o=[],s=r&&r.getShape(n);if(!s)return null;var l=e.getRange();if(void 0===l.begin)return{};var h=s.layout();if(!h)return;var u={};this.isLocalShape=h.isLocalShape;var c=h.getOriginDataToken()||h.dataToken;if(this.isLocalShape&&c===i.data_token)if(e.state===Tp.SelectType.select_text||e.state===Tp.SelectType.select_multi_cell||e.state===Tp.SelectType.select_cell){var d=e.getActiveTableCells();if(d instanceof Array){if(1===d.length){var p=d[0];u=h.getSelectStyleByRange(_()({},l,{cellIndex:p.getIdx()}))}else{var f=e.getActiveShapes();u=this.mergeMultiShapeStyle(e,f,r,d)}if(u&&u.textBodyStyle){var g=u.textBodyStyle.autoFit||0;a[n]=g,o.push(a),u.textBodyStyle.autoFitMap=o}}else{if((u=h.getSelectStyleByRange(_()({},l))).textBodyStyle){var y=u.textBodyStyle.autoFit||0;a[n]=y,o.push(a),u.textBodyStyle.autoFitMap=o}var v=e.getActiveShapes()[0];if(v){var m=v.getTextFrame(),w=m&&m.getTextStream();u.isTitle=w&&w.isTextStyleTitle()}}}else if(i.getShapeType()===Tp.ShapeType.GroupShape){var S=i.getChildShapesRecurse();if(void 0===(u=this.mergeMultiShapeStyle(e,S,r)))return null}else if(i.getShapeType()===Tp.ShapeType.Table)u=this.getTableStyle(i,e);else{var x=i.getTextFrame(),T=x&&x.getTextStream();if(T&&(u=h.getSelectStyleByRange({begin:0,end:T.getCharCount()-1})),u.textBodyStyle){var k=u.textBodyStyle.autoFit||0;a[n]=k,o.push(a),u.textBodyStyle.autoFitMap=o}}u&&(u.begin=l&&l.begin,u.end=l&&l.end),this.selAttrs=u}else if(e.state===Tp.SelectType.select_multi_shape){var C=this.coreView.doc.activeSlide,b=e.getActiveShapes();this.selAttrs=this.mergeMultiShapeStyle(e,b,C)}return null}},{key:"getSelShapeAttrs",value:function(){return this.selAttrs}},{key:"getTableStyle",value:function(e,t){var i=this.coreView.doc.activeSlide,n=e.getId(),r=i&&i.getShape(n);if(!r)return null;if(void 0===t.getRange().begin)return{};var a=r.layout(),o=e.getTableFrame();if(o){var s=o.getChilds();if(!s||!s.length)return null;for(var l=[],h=[],u=[],c=[],d={},p=0;p<s.length;p++){var f=s[p],g=f&&f.getTextFrame(),y=g&&g.getTextStream();if(y){var v=a.getSelectStyleByRange({begin:0,end:y.getCharCount()-1,cellIndex:f.getIdx()}),m=v.textBodyStyle,_=m&&m.paragraphStyle;d=0===p?_:Xa(d,_);var w=_&&_.chapterStyle&&_.chapterStyle.fontList;w&&0!==w.length&&u.push({textFrame:g,fontList:Object.assign([],w)}),c.push({rightToLeftMap:m&&m.rightToLeftMap,textFrame:g});var S={};if(m){var x=m.autoFit||0;S[n]=x,h.push(S)}l.push(v)}}var T=l[0];if(T)for(var k=0;k<l.length;k++){l[0].textBodyStyle.anchorType!==l[k].textBodyStyle.anchorType&&(T.textBodyStyle.anchorType=void 0)}return T&&(T.textBodyStyle.paragraphStyle=d,T.textBodyStyle.autoFitMap=h,T.textBodyStyle.fontListMap=u,T.textBodyStyle.rightToLeftMapObj=c),T}return null}},{key:"mergeMultiShapeStyle",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],s=r,l=a,h=o,u=[],c=[];if(0!==t.length){for(var d=0;d<t.length;d++){var p=t[d],f=p.getShapeType(),g=p.getId(),y=i&&i.getShape(g);if(!y)return null;var v=e.getRange();if(void 0===v.begin)return{};var m=y.layout();if(!m)return;var _={},w={},S=m.isLocalShape;if(S&&p.data_token===m.dataToken){if(e.state===Tp.SelectType.select_multi_cell||e.state===Tp.SelectType.select_multi_shape&&f===Tp.ShapeType.Table){var x=[];if(n&&0===n.length){var T=p.getTableFrame();x=T&&T.getChilds()}for(var k=0;k<x.length;k++){var C=x[k].getTextFrame(),b=C&&C.getTextStream();if(b&&((_=m.getSelectStyleByRange({begin:0,end:b.getCharCount()-1,cellIndex:x[k].getIdx()})).textBodyStyle&&_.textBodyStyle.paragraphStyle&&_.textBodyStyle.paragraphStyle.chapterStyle&&_.textBodyStyle.paragraphStyle.chapterStyle.fontList&&0!==_.textBodyStyle.paragraphStyle.chapterStyle.fontList.length&&h.push({textFrame:C,fontList:Object.assign([],_.textBodyStyle.paragraphStyle.chapterStyle.fontList)}),u.push({rightToLeftMap:_&&_.textBodyStyle&&_.textBodyStyle.rightToLeftMap,textFrame:C})),void 0!==_&&0!==Object.keys(_).length&&_.textBodyStyle){var E=_.textBodyStyle.autoFit||0;w[g]=E,l.push(w),c.push(_)}}}else if(p.getShapeType()===Tp.ShapeType.GroupShape){var R=p.getChildShapesRecurse();_=this.mergeMultiShapeStyle(e,R,i,[],s,l,h)}else{var P=p.getTextFrame(),I=p.isPlaceHolder(),L=P&&P.getTextStream();if(L){var A=(_=m.getSelectStyleByRange({begin:0,end:L.getCharCount()-1}))&&_.textBodyStyle||{},B=A.paragraphStyle;B&&B.chapterStyle.fontList&&0!==B.chapterStyle.fontList.length&&!I&&h.push({textFrame:P,fontList:Object.assign([],_.textBodyStyle.paragraphStyle.chapterStyle.fontList)});var D=_&&_.textBodyStyle;u.push({rightToLeftMap:D&&D.rightToLeftMap,textFrame:P})}}if(void 0!==_&&0!==Object.keys(_).length&&p.getShapeType()!==_.GroupShape&&_.textBodyStyle){var M=_.textBodyStyle.autoFit||0;w[g]=M,l.push(w),c.push(_)}}}for(var O={},N=0;N<c.length;N++){var F=c[N].textBodyStyle&&c[N].textBodyStyle.paragraphStyle;O=0===N?F:Xa(O,F)}var V=s[0]&&s[0].textBodyStyle&&s[0].textBodyStyle.paragraphStyle;V&&(O=Xa(V,O)),s.push.apply(s,c);var U=s[0];if(U)for(var G=0;G<s.length;G++){var H=s[0].textBodyStyle.autoFit,W=s[0].textBodyStyle.anchorType;if(W&&W!==s[G].textBodyStyle.anchorType&&(U.textBodyStyle.anchorType=void 0),void 0!==H&&H!==s[G].textBodyStyle.autoFit&&(U.textBodyStyle.autoFit=void 0),void 0===U.textBodyStyle.anchorType&&void 0===U.textBodyStyle.autoFit)break}return U&&(U.textBodyStyle.paragraphStyle=O,U.textBodyStyle.autoFitMap=l,U.textBodyStyle.fontListMap=h,U.textBodyStyle.rightToLeftMapObj=u),U}}},{key:"isIncludeParaAttrs",value:function(e){if(e){for(var t=!1,i=0;i<e.length;i++)if(e[i].getTextFrame()&&e[i].getTextFrame().getTextStream||e[i].getShapeType()===Tp.SelectType.select_table){t=!0;break}return t}}},{key:"setForbiddenScrollTime",value:function(e){this._forbiddenScrollTime=e}},{key:"workspace",get:function(){return this.props.workspace}},{key:"coreView",get:function(){return this.workspace.core.view}},{key:"models",get:function(){return this._models}},{key:"uilHotkeys",get:function(){return this._uilHotkeys}},{key:"paragraph",get:function(){return this.getModelByName(Tp.ModelNamesDef.paragraph)}},{key:"chapter",get:function(){return this.getModelByName(Tp.ModelNamesDef.chapter)}},{key:"common",get:function(){return this.getModelByName(Tp.ModelNamesDef.common)}},{key:"container",get:function(){return this.getModelByName(Tp.ModelNamesDef.container)}},{key:"slide",get:function(){return this.getModelByName(Tp.ModelNamesDef.slide)}},{key:"shape",get:function(){return this.getModelByName(Tp.ModelNamesDef.shape)}},{key:"link",get:function(){return this.getModelByName(Tp.ModelNamesDef.link)}},{key:"fill",get:function(){return this.getModelByName(Tp.ModelNamesDef.fill)}},{key:"outline",get:function(){return this.getModelByName(Tp.ModelNamesDef.outline)}},{key:"action",get:function(){return this.getModelByName(Tp.ModelNamesDef.action)}},{key:"ink",get:function(){return this.getModelByName(Tp.ModelNamesDef.ink)}},{key:"connector",get:function(){return this.getModelByName(Tp.ModelNamesDef.connector)}},{key:"explain",get:function(){return this.getModelByName(Tp.ModelNamesDef.explain)}},{key:"isForbiddenScroll",get:function(){return!Object.isEmpty(this._forbiddenScrollTime)&&performance.now()-this._forbiddenScrollTime<500}}]),e}();Sf.ModelNames=Tp.ModelNamesDef;var xf=Sf,Tf=function(){function e(t){r()(this,e),this.app=t,this.doc=new xp(t),this.editor=new xf(t,this.doc)}return o()(e,[{key:"init",value:function(){this.doc.init(),this.editor.init()}},{key:"coreView",get:function(){return this.editor.coreView}},{key:"remarkSpeakerDoc",get:function(){return window.opener&&window.opener.APP&&window.opener.APP.shell&&window.opener.APP.shell.doc}}]),e}(),kf=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=e.app;return i.view=new _p(e),i.editShell=new Tf(n),i}return u()(t,e),o()(t,[{key:"init",value:function(e){this.presentation=e,this.view.init(e),this.editShell.init(e)}},{key:"getSelection",value:function(){return this.presentation.getSelection()}},{key:"getDocument",value:function(){return this.presentation}}]),t}(x.a);kf.EVENT_TYPES={INIT:"1"};t.default=kf;window.WppCore=kf},470:function(e,t,i){"use strict";i.r(t),i.d(t,"SlideViewType",(function(){return o})),i.d(t,"PresetShapeType",(function(){return s})),i.d(t,"PresetShapeInfo",(function(){return l})),i.d(t,"shapeDefaultSize",(function(){return h})),i.d(t,"ShapeGroupType",(function(){return c})),i.d(t,"ShapeCreateFunctions",(function(){return d})),i.d(t,"ShapeGroupItems",(function(){return p})),i.d(t,"TextVerticalType",(function(){return m})),i.d(t,"TextAutoFitType",(function(){return _})),i.d(t,"LineType",(function(){return v})),i.d(t,"shapeTypeStr2Enum",(function(){return u}));var n,r=i(150),a=i.n(r),o={wpViewInvalid:0,wpViewSlide:1,wpViewSlideMaster:2,wpViewNotesPage:3,wpViewHandoutMaster:4,wpViewNotesMaster:5,wpViewOutline:6,wpViewSlideSorter:7,wpViewTitleMaster:8,wpViewNormal:9,wpViewPrintPreview:10,wpViewThumbnails:11,wpViewMasterThumbnails:12,wpViewNotesText:13};Object.freeze(o);var s={ShapeInvalid:-1,ShapeBegin:0,ShapeLine:0,ShapeLineInverse:1,ShapeTriangle:2,ShapeRightTriangle:3,ShapeRectangle:4,ShapeDiamond:5,ShapeParallelogram:6,ShapeTrapezoid:7,ShapeNonIsoscelesTrapezoid:8,ShapePentagon:9,ShapeHexagon:10,ShapeHeptagon:11,ShapeOctagon:12,ShapeDecagon:13,ShapeDodecagon:14,ShapeStar4:15,ShapeStar5:16,ShapeStar6:17,ShapeStar7:18,ShapeStar8:19,ShapeStar10:20,ShapeStar12:21,ShapeStar16:22,ShapeStar24:23,ShapeStar32:24,ShapeRoundRectangle:25,ShapeRound1Rectangle:26,ShapeRound2SameRectangle:27,ShapeRound2DiagonalRectangle:28,ShapeSnipRoundRectangle:29,ShapeSnip1Rectangle:30,ShapeSnip2SameRectangle:31,ShapeSnip2DiagonalRectangle:32,ShapePlaque:33,ShapeEllipse:34,ShapeTeardrop:35,ShapeHomePlate:36,ShapeChevron:37,ShapePieWedge:38,ShapePie:39,ShapeBlockArc:40,ShapeDonut:41,ShapeNoSmoking:42,ShapeRightArrow:43,ShapeLeftArrow:44,ShapeUpArrow:45,ShapeDownArrow:46,ShapeStripedRightArrow:47,ShapeNotchedRightArrow:48,ShapeBentUpArrow:49,ShapeLeftRightArrow:50,ShapeUpDownArrow:51,ShapeLeftUpArrow:52,ShapeLeftRightUpArrow:53,ShapeQuadArrow:54,ShapeLeftArrowCallout:55,ShapeRightArrowCallout:56,ShapeUpArrowCallout:57,ShapeDownArrowCallout:58,ShapeLeftRightArrowCallout:59,ShapeUpDownArrowCallout:60,ShapeQuadArrowCallout:61,ShapeBentArrow:62,ShapeUTurnArrow:63,ShapeCircularArrow:64,ShapeLeftCircularArrow:65,ShapeLeftRightCircularArrow:66,ShapeCurvedRightArrow:67,ShapeCurvedLeftArrow:68,ShapeCurvedUpArrow:69,ShapeCurvedDownArrow:70,ShapeSwooshArrow:71,ShapeCube:72,ShapeCan:73,ShapeLightningBolt:74,ShapeHeart:75,ShapeSun:76,ShapeMoon:77,ShapeSmileyFace:78,ShapeIrregularSeal1:79,ShapeIrregularSeal2:80,ShapeFoldedCorner:81,ShapeBevel:82,ShapeFrame:83,ShapeHalfFrame:84,ShapeCorner:85,ShapeDiagonalStripe:86,ShapeChord:87,ShapeArc:88,ShapeLeftBracket:89,ShapeRightBracket:90,ShapeLeftBrace:91,ShapeRightBrace:92,ShapeBracketPair:93,ShapeBracePair:94,ShapeStraightConnector1:95,ShapeBentConnector2:96,ShapeBentConnector3:97,ShapeBentConnector4:98,ShapeBentConnector5:99,ShapeCurvedConnector2:100,ShapeCurvedConnector3:101,ShapeCurvedConnector4:102,ShapeCurvedConnector5:103,ShapeCallout1:104,ShapeCallout2:105,ShapeCallout3:106,ShapeAccentCallout1:107,ShapeAccentCallout2:108,ShapeAccentCallout3:109,ShapeBorderCallout1:110,ShapeBorderCallout2:111,ShapeBorderCallout3:112,ShapeAccentBorderCallout1:113,ShapeAccentBorderCallout2:114,ShapeAccentBorderCallout3:115,ShapeWedgeRectangleCallout:116,ShapeWedgeRoundRectangleCallout:117,ShapeWedgeEllipseCallout:118,ShapeCloudCallout:119,ShapeCloud:120,ShapeRibbon:121,ShapeRibbon2:122,ShapeEllipseRibbon:123,ShapeEllipseRibbon2:124,ShapeLeftRightRibbon:125,ShapeVerticalScroll:126,ShapeHorizontalScroll:127,ShapeWave:128,ShapeDoubleWave:129,ShapePlus:130,ShapeFlowChartProcess:131,ShapeFlowChartDecision:132,ShapeFlowChartInputOutput:133,ShapeFlowChartPredefinedProcess:134,ShapeFlowChartInternalStorage:135,ShapeFlowChartDocument:136,ShapeFlowChartMultidocument:137,ShapeFlowChartTerminator:138,ShapeFlowChartPreparation:139,ShapeFlowChartManualInput:140,ShapeFlowChartManualOperation:141,ShapeFlowChartConnector:142,ShapeFlowChartPunchedCard:143,ShapeFlowChartPunchedTape:144,ShapeFlowChartSummingJunction:145,ShapeFlowChartOr:146,ShapeFlowChartCollate:147,ShapeFlowChartSort:148,ShapeFlowChartExtract:149,ShapeFlowChartMerge:150,ShapeFlowChartOfflineStorage:151,ShapeFlowChartOnlineStorage:152,ShapeFlowChartMagneticTape:153,ShapeFlowChartMagneticDisk:154,ShapeFlowChartMagneticDrum:155,ShapeFlowChartDisplay:156,ShapeFlowChartDelay:157,ShapeFlowChartAlternateProcess:158,ShapeFlowChartOffpageConnector:159,ShapeActionButtonBlank:160,ShapeActionButtonHome:161,ShapeActionButtonHelp:162,ShapeActionButtonInformation:163,ShapeActionButtonForwardNext:164,ShapeActionButtonBackPrevious:165,ShapeActionButtonEnd:166,ShapeActionButtonBeginning:167,ShapeActionButtonReturn:168,ShapeActionButtonDocument:169,ShapeActionButtonSound:170,ShapeActionButtonMovie:171,ShapeGear6:172,ShapeGear9:173,ShapeFunnel:174,ShapeMathPlus:175,ShapeMathMinus:176,ShapeMathMultiply:177,ShapeMathDivide:178,ShapeMathEqual:179,ShapeMathNotEqual:180,ShapeCornerTabs:181,ShapeSquareTabs:182,ShapePlaqueTabs:183,ShapeChartX:184,ShapeChartStar:185,ShapeChartPlus:186,ShapeTypeEnd:186,TextShapeBegin:187,TextArchDown:187,TextArchDownPour:188,TextArchUp:189,TextArchUpPour:190,TextButton:191,TextButtonPour:192,TextCanDown:193,TextCanUp:194,TextCascadeDown:195,TextCascadeUp:196,TextChevron:197,TextChevronInverted:198,TextCircle:199,TextCirclePour:200,TextCurveDown:201,TextCurveUp:202,TextDeflate:203,TextDeflateBottom:204,TextDeflateInflate:205,TextDeflateInflateDeflate:206,TextDeflateTop:207,TextDoubleWave1:208,TextFadeDown:209,TextFadeLeft:210,TextFadeRight:211,TextFadeUp:212,TextInflate:213,TextInflateBottom:214,TextInflateTop:215,TextPlain:216,TextRingInside:217,TextRingOutside:218,TextSlantDown:219,TextSlantUp:220,TextStop:221,TextTriangle:222,TextTriangleInverted:223,TextWave1:224,TextWave2:225,TextWave4:226,TextNoShape:227,TextShapeEnd:228,OutputConnection:229,OutputNone:230,ShapeCustom:231,KsoCustomBegin:232,ShapeInk:233,KsoCustomEnd:234,VmlShapeBegin:4096};Object.freeze(s);var l={0:{text:"line"},1:{text:"lineInv"},2:{text:"triangle",w:1672.65,h:1440.18},3:{text:"rtTriangle"},4:{text:"rect"},5:{text:"diamond"},6:{text:"parallelogram",w:1916.46,h:1440.18},7:{text:"trapezoid",w:1440.18,h:1916.46},8:{text:"nonIsoscelesTrapezoid"},9:{text:"pentagon",w:1513.89,h:1440.18},10:{text:"hexagon",w:1672.65,h:1440.18},11:{text:"heptagon"},12:{text:"octagon"},13:{text:"decagon"},14:{text:"dodecagon"},15:{text:"star4"},16:{text:"star5"},17:{text:"star6"},18:{text:"star7"},19:{text:"star8"},20:{text:"star10"},21:{text:"star12"},22:{text:"star16"},23:{text:"star24"},24:{text:"star32"},25:{text:"roundRect"},26:{text:"round1Rect"},27:{text:"round2SameRect"},28:{text:"round2DiagRect"},29:{text:"snipRoundRect"},30:{text:"snip1Rect"},31:{text:"snip2SameRect"},32:{text:"snip2DiagRect"},33:{text:"plaque"},34:{text:"ellipse"},35:{text:"teardrop"},36:{text:"homePlate",w:1542.24,h:765.45},37:{text:"chevron",w:765.45,h:765.45},38:{text:"pieWedge"},39:{text:"pie"},40:{text:"blockArc"},41:{text:"donut"},42:{text:"noSmoking"},43:{text:"rightArrow",w:1542.24,h:765.45},44:{text:"leftArrow",w:1542.24,h:765.45},45:{text:"upArrow",w:765.45,h:1542.24},46:{text:"downArrow",w:765.45,h:1542.24},47:{text:"stripedRightArrow",w:1542.24,h:765.45},48:{text:"notchedRightArrow",w:1542.24,h:765.45},49:{text:"bentUpArrow",w:1338.12,h:1151.01},50:{text:"leftRightArrow",w:1916.46,h:765.45},51:{text:"upDownArrow",w:765.45,h:1916.46},52:{text:"leftUpArrow",w:1338.12,h:1338.12},53:{text:"leftRightUpArrow",w:1916.46,h:1338.12},54:{text:"quadArrow",w:1916.46,h:1916.46},55:{text:"leftArrowCallout"},56:{text:"rightArrowCallout"},57:{text:"upArrowCallout"},58:{text:"downArrowCallout"},59:{text:"leftRightArrowCallout",w:1916.46,h:907.2},60:{text:"upDownArrowCallout"},61:{text:"quadArrowCallout",w:1916.46,h:1916.46},62:{text:"bentArrow",w:1281.42,h:1366.47},63:{text:"uturnArrow"},64:{text:"circularArrow",w:1542.24,h:1542.24},65:{text:"leftCircularArrow"},66:{text:"leftRightCircularArrow"},67:{text:"curvedRightArrow",w:1151.01,h:1916.46},68:{text:"curvedLeftArrow",w:1151.01,h:1916.46},69:{text:"curvedUpArrow",w:1916.46,h:1151.01},70:{text:"curvedDownArrow",w:1916.46,h:1151.01},71:{text:"swooshArrow"},72:{text:"cube",w:1916.46,h:1916.46},73:{text:"can",w:1440.18,h:1916.46},74:{text:"lightningBolt"},75:{text:"heart"},76:{text:"sun"},77:{text:"moon",w:720.09,h:1440.18},78:{text:"smileyFace"},79:{text:"irregularSeal1"},80:{text:"irregularSeal2"},81:{text:"foldedCorner"},82:{text:"bevel",w:1644.3,h:1644.3},83:{text:"frame"},84:{text:"halfFrame"},85:{text:"corner"},86:{text:"diagStripe"},87:{text:"chord"},88:{text:"arc"},89:{text:"leftBracket",w:113.4,h:1440.18},90:{text:"rightBracket",w:113.4,h:1440.18},91:{text:"leftBrace",w:243.81,h:1440.18},92:{text:"rightBrace",w:243.81,h:1440.18},93:{text:"bracketPair"},94:{text:"bracePair",w:1683.99,h:1440.18},95:{text:"straightConnector1"},96:{text:"bentConnector2"},97:{text:"bentConnector3"},98:{text:"bentConnector4"},99:{text:"bentConnector5"},100:{text:"curvedConnector2"},101:{text:"curvedConnector3"},102:{text:"curvedConnector4"},103:{text:"curvedConnector5"},104:{text:"callout1",w:1440.18,h:963.9},105:{text:"callout2",w:1440.18,h:963.9},106:{text:"callout3",w:1440.18,h:963.9},107:{text:"accentCallout1",w:1440.18,h:963.9},108:{text:"accentCallout2",w:1440.18,h:963.9},109:{text:"accentCallout3",w:1440.18,h:963.9},110:{text:"borderCallout1",w:1440.18,h:963.9},111:{text:"borderCallout2",w:1440.18,h:963.9},112:{text:"borderCallout3",w:1440.18,h:963.9},113:{text:"accentBorderCallout1",w:1440.18,h:963.9},114:{text:"accentBorderCallout2",w:1440.18,h:963.9},115:{text:"accentBorderCallout3",w:1440.18,h:963.9},116:{text:"wedgeRectCallout"},117:{text:"wedgeRoundRectCallout"},118:{text:"wedgeEllipseCallout",w:1440.18,h:963.9},119:{text:"cloudCallout",w:1440.18,h:963.9},120:{text:"cloud"},121:{text:"ribbon",w:1916.46,h:963.9},122:{text:"ribbon2",w:1916.46,h:963.9},123:{text:"ellipseRibbon",w:1916.46,h:1196.37},124:{text:"ellipseRibbon2",w:1916.46,h:1196.37},125:{text:"leftRightRibbon"},126:{text:"verticalScroll",w:1803.06,h:1627.29},127:{text:"horizontalScroll",w:1627.29,h:1803.06},128:{text:"wave"},129:{text:"doubleWave"},130:{text:"plus"},131:{text:"flowChartProcess",w:1440.18,h:963.9},132:{text:"flowChartDecision",w:1440.18,h:963.9},133:{text:"flowChartInputOutput",w:1440.18,h:963.9},134:{text:"flowChartPredefinedProcess",w:1440.18,h:963.9},135:{text:"flowChartInternalStorage",w:963.9,h:963.9},136:{text:"flowChartDocument",w:1440.18,h:963.9},137:{text:"flowChartMultidocument",w:1672.65,h:1196.37},138:{text:"flowChartTerminator",w:1440.18,h:476.28},139:{text:"flowChartPreparation",w:1672.65,h:963.9},140:{text:"flowChartManualInput",w:1440.18,h:720.09},141:{text:"flowChartManualOperation",w:1440.18,h:963.9},142:{text:"flowChartConnector",w:720.09,h:720.09},143:{text:"flowChartPunchedCard"},144:{text:"flowChartPunchedTape",w:1440.18,h:1270.08},145:{text:"flowChartSummingJunction",w:963.9,h:963.9},146:{text:"flowChartOr",w:963.9,h:963.9},147:{text:"flowChartCollate",w:720.09,h:1440.18},148:{text:"flowChartSort",w:720.09,h:1440.18},149:{text:"flowChartExtract",w:1082.97,h:1082.97},150:{text:"flowChartMerge",w:1082.97,h:1082.97},151:{text:"flowChartOfflineStorage"},152:{text:"flowChartOnlineStorage",w:1440.18,h:963.9},153:{text:"flowChartMagneticTape",w:963.9,h:963.9},154:{text:"flowChartMagneticDisk",w:1440.18,h:963.9},155:{text:"flowChartMagneticDrum",w:1440.18,h:1082.97},156:{text:"flowChartDisplay",w:1440.18,h:963.9},157:{text:"flowChartDelay",w:963.9,h:963.9},158:{text:"flowChartAlternateProcess",w:1440.18,h:963.9},159:{text:"flowChartOffpageConnector",w:963.9,h:963.9},160:{text:"actionButtonBlank",w:1644.3,h:1644.3},161:{text:"actionButtonHome",w:1644.3,h:1644.3},162:{text:"actionButtonHelp",w:1644.3,h:1644.3},163:{text:"actionButtonInformation",w:1644.3,h:1644.3},164:{text:"actionButtonForwardNext",w:1644.3,h:1644.3},165:{text:"actionButtonBackPrevious",w:1644.3,h:1644.3},166:{text:"actionButtonEnd",w:1644.3,h:1644.3},167:{text:"actionButtonBeginning",w:1644.3,h:1644.3},168:{text:"actionButtonReturn",w:1644.3,h:1644.3},169:{text:"actionButtonDocument",w:1644.3,h:1644.3},170:{text:"actionButtonSound",w:1644.3,h:1644.3},171:{text:"actionButtonMovie",w:1644.3,h:1644.3},172:{text:"gear6"},173:{text:"gear9"},174:{text:"funnel"},175:{text:"mathPlus"},176:{text:"mathMinus"},177:{text:"mathMultiply"},178:{text:"mathDivide"},179:{text:"mathEqual"},180:{text:"mathNotEqual"},181:{text:"cornerTabs"},182:{text:"squareTabs"},183:{text:"plaqueTabs"},184:{text:"chartX"},185:{text:"chartStar"},186:{text:"chartPlus"},187:{text:"textArchDown"},188:{text:"textArchDownPour"},189:{text:"textArchUp"},190:{text:"textArchUpPour"},191:{text:"textButton"},192:{text:"textButtonPour"},193:{text:"textCanDown"},194:{text:"textCanUp"},195:{text:"textCascadeDown"},196:{text:"textCascadeUp"},197:{text:"textChevron"},198:{text:"textChevronInverted"},199:{text:"textCircle"},200:{text:"textCirclePour"},201:{text:"textCurveDown"},202:{text:"textCurveUp"},203:{text:"textDeflate"},204:{text:"textDeflateBottom"},205:{text:"textDeflateInflate"},206:{text:"textDeflateInflateDeflate"},207:{text:"textDeflateTop"},208:{text:"textDoubleWave1"},209:{text:"textFadeDown"},210:{text:"textFadeLeft"},211:{text:"textFadeRight"},212:{text:"textFadeUp"},213:{text:"textInflate"},214:{text:"textInflateBottom"},215:{text:"textInflateTop"},216:{text:"textPlain"},217:{text:"textRingInside"},218:{text:"textRingOutside"},219:{text:"textSlantDown"},220:{text:"textSlantUp"},221:{text:"textStop"},222:{text:"textTriangle"},223:{text:"textTriangleInverted"},224:{text:"textWave1"},225:{text:"textWave2"},226:{text:"textWave4"},227:{text:"textNoShape"},231:{text:"shapeCustom"}};function h(e){var t={w:1440,h:1440};return l[e]&&(l[e].w&&(t.w=l[e].w),l[e].h&&(t.h=l[e].h)),t}function u(e){for(var t=Object.keys(l).length,i=0;i<t;++i){if(e===l[i].text)return i}return null}Object.freeze(l);var c={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9};Object.freeze(c);var d=["createLine","createConnectorArrow","createConnectorDoubleArrow","createCustomGeometryShape","createNormalShape","createTextBox","createHollowOutShape","createArcShape"];Object.freeze(d);var p=(n={},a()(n,c.LineGroup,{types:[0,95,95,97,97,97,101,101,101,231,231,231],funcIdx:[0,1,2,0,1,2,0,1,2,3,3,3],subTypes:[0,1,95,96,97,98,99,100,101,102,103,231],defaultFill:[0,1,95,96,97,98,99,100,101,102,103,231]}),a()(n,c.RectangleGroup,{types:[4,25,30,31,32,29,26,27,28],funcIdx:[4,4,4,4,4,4,4,4,4],subTypes:[4,25,26,27,28,29,30,31,32],defaultFill:[]}),a()(n,c.NormalGroup,{types:[4,4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],funcIdx:[5,5,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,6,6,4,6,4,4,4,4,4,6,6,6,4,4,4,4,4,4,4,7,7,7,7,7,7,7],subTypes:[4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],defaultFill:[88,89,90,91,92,93,94]}),a()(n,c.ArrowGroup,{types:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],funcIdx:[4,4,4,4,4,4,4,4,6,6,4,4,6,6,6,6,4,4,4,4,4,4,4,4,4,4,6],subTypes:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],defaultFill:[]}),a()(n,c.FormulaGroup,{types:[175,176,177,178,179,180],funcIdx:[4,4,4,4,6,6],subTypes:[175,176,177,178,179,180],defaultFill:[]}),a()(n,c.ProcessGroup,{types:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4],subTypes:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],defaultFill:[]}),a()(n,c.StarAndFlagGroup,{types:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],defaultFill:[]}),a()(n,c.CalloutGroup,{types:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],defaultFill:[]}),a()(n,c.ActionGroup,{types:[165,164,167,166,161,163,168,171,169,170,162,160],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[165,164,167,166,161,163,168,171,169,170,162,160],defaultFill:[]}),n);Object.freeze(p);var f=[s.ShapeLine,s.ShapeLineInverse,s.ShapeStraightConnector1];Object.freeze(f);var g=[s.ShapeBentConnector2,s.ShapeBentConnector3,s.ShapeBentConnector4,s.ShapeBentConnector5];Object.freeze(g);var y=[s.ShapeCurvedConnector2,s.ShapeCurvedConnector3,s.ShapeCurvedConnector4,s.ShapeCurvedConnector5];Object.freeze(y);var v={StraightLine:f,BentLine:g,CurveLine:y};Object.freeze(v);var m={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7};Object.freeze(m);var _={NoAutoFit:0,NormalAutoFit:1,AdvancedAutoFit:2};Object.freeze(_)},4901:function(e,t,i){e.exports=function(e,t){i.e(231).then(i.bind(null,6136)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4902:function(e,t,i){e.exports=function(e,t){i.e(232).then(i.bind(null,6137)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4903:function(e,t,i){e.exports=function(e,t){i.e(233).then(i.bind(null,6138)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4904:function(e,t,i){e.exports=function(e,t){i.e(234).then(i.bind(null,6139)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4905:function(e,t,i){e.exports=function(e,t){i.e(235).then(i.bind(null,6140)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4906:function(e,t,i){e.exports=function(e,t){i.e(236).then(i.bind(null,6141)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4907:function(e,t,i){e.exports=function(e,t){i.e(237).then(i.bind(null,6142)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4908:function(e,t,i){e.exports=function(e,t){i.e(238).then(i.bind(null,6143)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4909:function(e,t,i){e.exports=function(e,t){i.e(239).then(i.bind(null,6144)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4910:function(e,t,i){e.exports=function(e,t){i.e(240).then(i.bind(null,6145)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4911:function(e,t,i){e.exports=function(e,t){i.e(241).then(i.bind(null,6146)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4912:function(e,t,i){e.exports=function(e,t){i.e(242).then(i.bind(null,6147)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4913:function(e,t,i){e.exports=function(e,t){i.e(243).then(i.bind(null,6148)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4914:function(e,t,i){e.exports=function(e,t){i.e(244).then(i.bind(null,6149)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4915:function(e,t,i){e.exports=function(e,t){i.e(245).then(i.bind(null,6150)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4916:function(e,t,i){e.exports=function(e,t){i.e(246).then(i.bind(null,6151)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4917:function(e,t,i){e.exports=function(e,t){i.e(247).then(i.bind(null,6152)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4918:function(e,t,i){e.exports=function(e,t){i.e(248).then(i.bind(null,6153)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4919:function(e,t,i){e.exports=function(e,t){i.e(249).then(i.bind(null,6154)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4920:function(e,t,i){e.exports=function(e,t){i.e(250).then(i.bind(null,6155)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4921:function(e,t,i){e.exports=function(e,t){i.e(251).then(i.bind(null,6156)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4922:function(e,t,i){e.exports=function(e,t){i.e(252).then(i.bind(null,6157)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4923:function(e,t,i){e.exports=function(e,t){i.e(253).then(i.bind(null,6158)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4924:function(e,t,i){e.exports=function(e,t){i.e(254).then(i.bind(null,6159)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4925:function(e,t,i){e.exports=function(e,t){i.e(255).then(i.bind(null,6160)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4926:function(e,t,i){e.exports=function(e,t){i.e(256).then(i.bind(null,6161)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4927:function(e,t,i){e.exports=function(e,t){i.e(257).then(i.bind(null,6162)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4928:function(e,t,i){e.exports=function(e,t){i.e(258).then(i.bind(null,6163)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4929:function(e,t,i){e.exports=function(e,t){i.e(259).then(i.bind(null,6164)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4930:function(e,t,i){e.exports=function(e,t){i.e(260).then(i.bind(null,6165)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4931:function(e,t,i){e.exports=function(e,t){i.e(261).then(i.bind(null,6166)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4932:function(e,t,i){e.exports=function(e,t){i.e(262).then(i.bind(null,6167)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4933:function(e,t,i){e.exports=function(e,t){i.e(263).then(i.bind(null,6168)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4934:function(e,t,i){e.exports=function(e,t){i.e(264).then(i.bind(null,6169)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4935:function(e,t,i){e.exports=function(e,t){i.e(265).then(i.bind(null,6170)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4936:function(e,t,i){e.exports=function(e,t){i.e(266).then(i.bind(null,6171)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4937:function(e,t,i){e.exports=function(e,t){i.e(267).then(i.bind(null,6172)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4938:function(e,t,i){e.exports=function(e,t){i.e(268).then(i.bind(null,6173)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4939:function(e,t,i){e.exports=function(e,t){i.e(269).then(i.bind(null,6174)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4940:function(e,t,i){e.exports=function(e,t){i.e(270).then(i.bind(null,6175)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4941:function(e,t,i){e.exports=function(e,t){i.e(271).then(i.bind(null,6176)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4942:function(e,t,i){e.exports=function(e,t){i.e(272).then(i.bind(null,6177)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4943:function(e,t,i){e.exports=function(e,t){i.e(273).then(i.bind(null,6178)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4944:function(e,t,i){e.exports=function(e,t){i.e(274).then(i.bind(null,6179)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4945:function(e,t,i){e.exports=function(e,t){i.e(275).then(i.bind(null,6180)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4946:function(e,t,i){e.exports=function(e,t){i.e(276).then(i.bind(null,6181)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4947:function(e,t,i){e.exports=function(e,t){i.e(277).then(i.bind(null,6182)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4948:function(e,t,i){e.exports=function(e,t){i.e(278).then(i.bind(null,6183)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4949:function(e,t,i){e.exports=function(e,t){i.e(279).then(i.bind(null,6184)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4950:function(e,t,i){e.exports=function(e,t){i.e(280).then(i.bind(null,6185)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4951:function(e,t,i){e.exports=function(e,t){i.e(281).then(i.bind(null,6186)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4952:function(e,t,i){e.exports=function(e,t){i.e(230).then(i.bind(null,6187)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4953:function(e,t,i){e.exports=function(e,t){i.e(224).then(i.bind(null,8082)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4954:function(e,t,i){e.exports=function(e,t){i.e(226).then(i.bind(null,8024)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4955:function(e,t,i){e.exports=function(e,t){i.e(228).then(i.bind(null,8197)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4956:function(e,t,i){e.exports=function(e,t){i.e(227).then(i.bind(null,8198)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4957:function(e,t,i){e.exports=i.p+"images/chart.40a6ab6c.svg"},4958:function(e,t,i){e.exports=i.p+"images/table.c0f02791.svg"},4959:function(e,t,i){e.exports=i.p+"images/picture.6727c805.svg"},4960:function(e,t,i){e.exports=i.p+"images/loading.449f1392.gif"},4961:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrigin=void 0;t.getOrigin=function(e){var t=null==e?void 0:e.match(/(\w+):\/\/([^/:]+)(:\d*)?/);return t?t[0]:""}},4962:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(940)),a=i(144),o=i(563),s=(0,n.__importDefault)(i(4963)),l=function(e){function t(t){var i=e.call(this,t)||this;return i.playViewInk=new s.default(t),i}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"coreView",{get:function(){return window.APP.shell.coreView},enumerable:!1,configurable:!0}),t.prototype.deleteInkByPosition=function(e){if(e){var t=this.getHitShape(e);this.deleteShapeInk(t)}},t.prototype.deleteShapeInk=function(e){e&&e.isInk()&&(this.app.isReadOnly()?this.selection.deleteInkNoTransact([e]):(this.selection.deleteShape([e]),window.collection("newui","value",window.pcTrack.newui.ink_delete)))},t.prototype.deleteSlideInk=function(){var e;if(this.app.isReadOnly()){var t=(null===(e=this.selection.getActiveSlide())||void 0===e?void 0:e._drawingShapes)||[];this.selection.deleteInkNoTransact(t)}else{var i=this.selection.getActiveSlide();this.selection.removeAllInk([i]),window.collection("newui","value",window.pcTrack.newui.ink_slide_delete)}},t.prototype.deleteAllInk=function(){this.app.isReadOnly()?this.selection.deleteAllInkNoTransact():(this.selection.removeAllInk(),window.collection("newui","value",window.pcTrack.newui.ink_document_delete))},t.prototype.getHitShape=function(e){var t,i=e.clientX,n=void 0===i?0:i,r=e.clientY,o=void 0===r?0:r;if(a.isMobile&&window.__SCREEN_ROTATE__){var s=n;n=o,o=(window._parent||window).innerWidth-s}var l=this.coreView.hitTest(n,o);return null===(t=null==l?void 0:l.shape)||void 0===t?void 0:t.shapeData},t.prototype.setAllInkHidden=function(e){this.selection.setAllInkHidden(e),window.APP.shell.doc.fire(o.VIEW_EVENT_TYPES.WPP_INK_VISIBLE,{showmark:!e})},t}(r.default);t.default=l},4963:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(940)),a=i(697),o=function(e){function t(t){var i=e.call(this,t)||this;return i.isValidInk=function(e){return!(!e||!e.isInk())&&(e.getTags()||[]).some((function(e){return e&&"KSO_WEBWPP_OBJECT_TOKEN"===e.name&&e.value===i.Key}))},i.resetState(),i}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"mode",{get:function(){return this.shellDoc.getMode()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Key",{get:function(){return this._KEY||(this._KEY="PLAY_INK_".concat(String(Date.now())))},enumerable:!1,configurable:!0}),t.prototype.resetState=function(){this._KEY="",this.playViewInkCount=0,this.playViewInks=[]},t.prototype.isPlayMode=function(){return this.mode===a.ViewModes.PlayView},t.prototype.getInkTagModifier=function(){this.playViewInkCount++;var e=window.APP.coreAPI.createModifier("Tags");return e.modify("KSO_WEBWPP_OBJECT_TOKEN",this.Key),e},t.prototype.existPlayViewInk=function(){return!!this.playViewInkCount&&(this.refreshPlayViewInks(),this.playViewInks.length>0)},t.prototype.deletePlayViewInk=function(){var e=this.playViewInks;this.resetState();var t=window.getTransaction();t.beginBatchCommand(),t.setCooperHandler("delPlayViewInk"),this.selection.deleteShape(e),t.endBatchCommand()},t.prototype.refreshPlayViewInks=function(){this.playViewInks=this.getPlayViewInks()},t.prototype.getPlayViewInks=function(){if(!this.isPlayMode()||window.APP.isReadOnly())return[];for(var e=this.app.presentation.getSlideCount(),t=[],i=0;i<e;i++){var n=this.app.presentation.getSlideAt(i),r=this.getSlideInks(n);if((t=t.concat(r)).length>=this.playViewInkCount)break}return t},t.prototype.getSlideInks=function(e){var t,i=this;if(!e)return[];var n=(null===(t=e.getShapeTree())||void 0===t?void 0:t.getChilds())||[],r=[];return n.forEach((function(e){if(e.isGroupShape()){var t=e.getChildShapesRecurse(i.isValidInk)||[];r=r.concat(t)}else i.isValidInk(e)&&r.push(e)})),r},t}(r.default);t.default=o},4964:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.updateConnectors=function(e){e||(e=this.selection.getActiveShapes()),e&&e.length&&this.unlinkConnector(e),e&&(e.length>1||1===e.length&&e[0].isGroupShape())&&this.updateConnectorRouteByMove(e)},t.prototype.unlinkConnector=function(e){if(e||(e=this.selection.getActiveShapes()),e&&e.length){var t=this.getInternalConnectors(e,!1);if(t.length){var i=this.selection.getActiveSlide(),n=t.map((function(e){var t=window.APP.utils.createModifier("Connector");return e.startConnection()&&t.modify("startConnector",null),e.endConnection()&&t.modify("endConnector",null),{slide:i,shape:e,modifier:t}}));this.selection.modifyShapePropertiesBatch(n)}}},t.prototype.updateConnectorRouteByMove=function(e){var t=this;if(e||(e=this.selection.getActiveShapes()),e&&e.length){var i=[];e&&e.forEach((function(n){if(n.isConnector())t.isConnectedInAndOut(e,n)&&i.push(n);else if(n.isGroupShape()){var r=n.getChildShapesRecurse((function(i){return t.isConnectedInAndOut(e,i)}));i=i.concat(r)}})),i.forEach((function(e){t.selection.modifyConnectorRoute(e)}))}},t.prototype.isConnectedInAndOut=function(e,t){if(t.isConnector()&&2===Object.keys(t.getConnector()).length){var i=this.isSomeInclude(e,[t.startConnection().shapeId]),n=this.isSomeInclude(e,[t.endConnection().shapeId]);return i&&!n||!i&&n}return!1},t.prototype.getInternalConnectors=function(e,t){var i=this;void 0===t&&(t=!1);var n=[];return null==e||e.forEach((function(r){if(r.isConnector()){var a=i.getConnectorShapeIds(r);i.isSomeInclude(e,a)===t&&n.push(r)}else if(r.isGroupShape()){var o=r.getChildShapesRecurse((function(n){if(n.isConnector()){var r=i.getConnectorShapeIds(n);return i.isSomeInclude(e,r)===t}return!1}));n=n.concat(o)}})),n},t.prototype.getShapesWithoutConnectors=function(e){var t=this;return e.filter((function(i){if(i.isConnector()){var n=[i.startConnection(),i.endConnection()];return!t.isSomeInclude(e,n.map((function(e){return e&&e.shapeId})))}return!0}))},t.prototype.getExternalConnectors=function(e,t){var i=this,n=this.selection.getActiveSlide(),r=null==n?void 0:n.getShapeTree();return(null==r?void 0:r.getChildShapesRecurse((function(n){if(!n.isConnector()||i.isSomeInclude(e,[n.getId()]))return!1;var r=i.getConnectorShapeIds(n);return i.isSomeInclude(e,r)&&(!t||t(n))})))||[]},t.prototype.isSomeInclude=function(e,t){return t.some((function(t){return t&&e.some((function(e){return e.isGroupShape()?!!e.getChildShapesRecurse((function(e){return e.getId()===t})).length:e.getId()===t}))}))},t.prototype.getConnectorShapeIds=function(e){var t,i;return[null===(t=e.startConnection())||void 0===t?void 0:t.shapeId,null===(i=e.endConnection())||void 0===i?void 0:i.shapeId]},t}((0,n.__importDefault)(i(940)).default);t.default=r},4965:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(940)),a=i(523),o=(0,n.__importDefault)(i(2725)),s=function(e){function t(t){var i=e.call(this,t)||this;return i.soundData=new l,i}return(0,n.__extends)(t,e),t.prototype.update=function(e){(e=e&&e.otherLayerHitRestRet?e.otherLayerHitRestRet:e)&&this._hitInPath(e)?this._isSameData(e)||(this.reset(),this._hasUpdated=this._update(e)):this.reset()},t.prototype._hitInPath=function(e){var t=e.hitTestInfo;return!!t&&(t&&t.hitInPath)},t.prototype._isSameData=function(e){if(e&&e.hitTestInfo){var t=e.shape,i=t.getId(),n=t.getSlide().getId();if(i===this._shapeId&&n===this._slideId){var r=e.hitTestInfo.textHyperlink,a=r&&r.beginEnd,o=r&&r.cellIndex;if(!a&&!this._gcpRange&&!o&&!this._cellIndex||a===this._gcpRange&&o===this._cellIndex)return!0}}return!1},t.prototype._update=function(e){return!!e&&this._updateData(e)},t.prototype._updateData=function(e){return!!e&&(!!this._updateTextData(e)||this._updateShapeData(e))},t.prototype._getShape=function(e){var t=e.shape,i=t&&t.getData();if(i){if(i.getShapeType()!==a.ShapeType.GroupShape)return i;var n=e.childShapeHit;if(n&&n.isHit){var r=n.shape;return r&&r.getData()}return null}},t.prototype._updateTextData=function(e){if(e.hitTestInfo){var t=e.hitTestInfo.textHyperlink;if(!t)return!1;Array.isArray(t)&&(t=t[0]);var i=t.mouseClick,n=t.mouseOver;if(this._updateSoundData(i,n)){var r=e.shape;return this._shapeId=r.getId(),this._slideId=r.getSlide().getId(),this._gcpRange=t.beginEnd,this._cellIndex=t.cellIndex,!0}}return!1},t.prototype._updateShapeData=function(e){var t=this._getShape(e);if(!t)return!1;var i=t.getActions(),n=i&&i.mouseClick,r=i&&i.mouseOver;if(this._updateSoundData(n,r)){var a=e.shape;return this._shapeId=a.getId(),this._slideId=a.getSlide().getId(),!0}return!1},t.prototype._updateSoundData=function(e,t){var i=!1;return e&&(e.soundEffect&&this.soundData.setClickData(e.soundEffect),e.stopSound&&this.soundData.setClickData({stopSound:e.stopSound}),i=!0),t&&(t.soundEffect&&this.soundData.setOverData(t.soundEffect),t.stopSound&&this.soundData.setOverData({stopSound:t.stopSound}),i=!0),i},Object.defineProperty(t.prototype,"hasClickActionSound",{get:function(){return this.soundData&&this.soundData.hasClickData()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasOverActionSound",{get:function(){return this.soundData&&this.soundData.hasOverData()},enumerable:!1,configurable:!0}),t.prototype.click=function(){var e=this.soundData.getClickData();this._play(e)},t.prototype.over=function(){if(this._hasUpdated){var e=this.soundData.getOverData();this._play(e),this._hasUpdated=!1}},t.prototype._play=function(e){e&&(e.stopSound?this._stopSound():this._playSound(e))},t.prototype._playSound=function(e){var t=e.media;t&&o.default.getInstance().play((0,n.__assign)({slideId:this._slideId,shapeId:this._shapeId,cellIndex:this._cellIndex,gcpRange:this._gcpRange},t))},t.prototype._stopSound=function(){o.default.getInstance().stop()},t.prototype.reset=function(){this.soundData.destroy(),this._shapeId=null,this._slideId=null,this._gcpRange=null,this._cellIndex=null},t.prototype.destroy=function(){this.soundData.destroy(),this.soundData=null},t}(r.default);t.default=s;var l=function(){function e(){}return e.prototype.hasClickData=function(){return!!this.clickSoundData},e.prototype.hasOverData=function(){return!!this.overSoundData},e.prototype.setClickData=function(e){this.clickSoundData=e},e.prototype.setOverData=function(e){this.overSoundData=e},e.prototype.getClickData=function(){return this.clickSoundData},e.prototype.getOverData=function(){return this.overSoundData},e.prototype.destroy=function(){this.overSoundData=null,this.clickSoundData=null},e}()},4966:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(940)),a=i(158),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype._getEffect=function(e){if(void 0===e&&(e=-1),-1!==e){var t=this._getEffects();return t&&t[e]}},t.prototype._getEffects=function(){var e=this.selection.getActiveSlide(),t=e&&e.getTiming(),i=t&&t.mainSequence;return i&&i.getEffects()},t.prototype._getLayoutEffects=function(){var e=this.selection.getActiveSlide(),t=e&&e.getFollowing(),i=t&&t.getTiming(),n=i&&i.mainSequence;return n&&n.getEffects()},t.prototype._getMasterEffects=function(){var e=this.selection.getActiveSlide(),t=e&&e.getFollowing(),i=t&&t.getFollowing(),n=i&&i.getTiming(),r=n&&n.mainSequence;return r&&r.getEffects()},t.prototype.getEffectExplainArr=function(e){var t=this,i=e.isAll,n=void 0!==i&&i,r=e.animeIndex,o=void 0===r?-1:r,s=[];(n||-1===o)&&((p=this._getSlideAnimeExplainObj()).clickIndex=-1,s.push(p));if(n){var l=0,h=function(e,i,n){var r=t._getEffectExplainsObj(e,n);1!==s.length||-1!==s[0].clickIndex||r||0!==i?r&&(r.isSupport?(r.clickIndex=l,l++):r.lastClickIndex=l-1,s.push(r)):(s[0].clickIndex=l,l++)},u=this._getMasterEffects();u&&u.forEach((function(e,t){return h(e,t,a.SlideType.master)}));var c=this._getLayoutEffects();c&&c.forEach((function(e,t){return h(e,t,a.SlideType.layout)}));var d=this._getEffects();d&&d.forEach((function(e,t){return h(e,t,a.SlideType.slide)}))}else if(-1!==o){var p,f=this._getEffect(o);(p=this._getEffectExplainsObj(f))&&s.push(p)}return s},t.prototype._getEffectExplainsObj=function(e,t){var i=this;void 0===t&&(t=a.SlideType.slide);var n=e&&e.getTriggerType(),r=window.CoreExports.animation,o=r.AnimNodeType;if(n!==r.AnimTriggerType.OnPageClick)return!1;var s={animeIndex:e.getIndex(),isSupport:this.shellDoc.isSupportEffect(e),slideType:t};if(t===a.SlideType.slide&&s.isSupport){var l=e.getBehaviors(),h=l&&l.filter((function(e){return e.getNodeType()===o.Command&&e.private.command===a.ExplainBehaviorCmd}));s.explains=h&&h.map((function(e){var t=e.getTargetShapeId(),n=i.selection.getActiveSlide(),r=n.getShapeById(t);if(!r)return null;var a=r.getMedia(),o=a.mediaId,s=a.sha1,l=(r.getExtData()||{}).explainData;return{userId:l&&l.userId,duration:l&&l.duration,text:l&&l.text,shapeId:t,mediaId:o,sha1:s,id:"".concat(n.getId(),"_").concat(r.getId())}})).filter(Boolean)}return s},t.prototype._getSlideAnimeExplainObj=function(){var e={animeIndex:-1,slideType:a.SlideType.slide,isSupport:!0,explains:[],isTransition:!0},t=this.selection.getActiveSlide(),i=t&&t.getShapeTree(),n=i&&i.childShapes;return n&&n.forEach((function(i){var n=(i.getExtData()||{}).explainData;if(i.isHidden()&&n&&n.explainType===a.ExplainType.slideAnime){var r=i.getMedia(),o=r.mediaId,s=r.sha1;e.explains.push({userId:n.userId,duration:n&&n.duration,text:n&&n.text,mediaId:o,sha1:s,shapeId:i.getId(),id:"".concat(t.getId(),"_").concat(i.getId())})}})),e},t.prototype.isExplainEmpty=function(){for(var e=this.shellDoc.getSlideCount(),t=0;t<e;t++){var i=this.workspace.presentation.getSlideAt(t),n=i&&i.getShapeTree(),r=n&&n.getChildCount();if(r&&n)for(var o=0;o<r;o++){var s=n.getChildAt(o),l=(s&&s.getExtData()||{}).explainData;if(l&&(l.explainType===a.ExplainType.slideAnime||l.explainType===a.ExplainType.shapeAnime))return!1}}return!0},t.prototype.getCurSlideAnimeDuration=function(){var e,t=this.selection.getActiveSlide(),i=t&&t.getTransition();return(null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.type)?i.data.duration:0},t.prototype.getAutoPlayInfo=function(){var e,t,i,n=!0,r=3,a=!0,o=this.workspace.presentation.getCustomProps(),s=(null==o?void 0:o.private)&&o.private[0]&&(null===(i=null===(t=null===(e=o.private[0])||void 0===e?void 0:e.private)||void 0===t?void 0:t.docConfig)||void 0===i?void 0:i.private);return s&&(n=!!s.isAdvancePlay,r=s.time/1e3,a=!!s.isLoopPlay),{isAdvancePlay:n,isLoopPlay:a,time:r}},t.prototype.getSwitchSlideTime=function(){var e,t,i,n=this.getAutoPlayInfo(),r=n.isAdvancePlay,a=n.time;if(r){var o=null===(e=this.selection.getActiveSlide())||void 0===e?void 0:e.getTransition();if(null===(t=o.data)||void 0===t?void 0:t.bOnTime)return(null===(i=null==o?void 0:o.data)||void 0===i?void 0:i.advanceTime)/1e3}return a},t}(r.default);t.default=o},4967:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=function(){function e(){}return e.prototype.set=function(e){this._uilCmdTool=e},e.prototype.get=function(){return this._uilCmdTool},e.prototype.bindTool=function(e,t){var i=this;return void 0===t&&(t=null),function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];if(i._uilCmdTool&&"function"==typeof e)return e.call.apply(e,(0,n.__spreadArray)([t,i._uilCmdTool],r,!1));console.warn("uilCmdTool not loaded!")}},e}();t.default=r},502:function(e,t,i){"use strict";i.r(t),i.d(t,"AudioNameMap",(function(){return _})),i.d(t,"AudioIconUrlMap",(function(){return w})),i.d(t,"AudioAnime",(function(){return S})),i.d(t,"getTimeByTrim",(function(){return x})),i.d(t,"getFormatTime",(function(){return T})),i.d(t,"getMediaDom",(function(){return k})),i.d(t,"getAudioIcon",(function(){return C}));var n,r,a=i(150),o=i.n(a),s=i(1150),l=i.n(s),h=i(1151),u=i.n(h),c=i(1152),d=i.n(c),p=i(1153),f=i.n(p),g=i(1154),y=i.n(g),v=i(1155),m=i.n(v),_={icon1:"webwpp_sound1.png",icon2:"webwpp_sound2.png",icon3:"webwpp_sound3.png",icon4:"webwpp_sound4.png",icon5:"webwpp_sound5.png",icon6:"webwpp_sound6.png",defalut:"sound.png"},w=(n={},o()(n,_.icon1,l.a),o()(n,_.icon2,u.a),o()(n,_.icon3,d.a),o()(n,_.icon4,f.a),o()(n,_.icon5,y.a),o()(n,_.icon6,m.a),o()(n,_.defalut,l.a),n),S=(r={},o()(r,_.defalut,"media audio-anime audio-anime-1 black"),o()(r,_.icon1,"media audio-anime audio-anime-1 black"),o()(r,_.icon2,"media audio-anime audio-anime-1 white"),o()(r,_.icon3,"media audio-anime audio-anime-2 black"),o()(r,_.icon4,"media audio-anime audio-anime-2 white"),o()(r,_.icon5,"media audio-anime audio-anime-3 black"),o()(r,_.icon6,"media audio-anime audio-anime-3 white"),r),x=function(e){var t=0;return e&&(t=e/1e3),t},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="0"+Math.floor(e%60),n="0"+Math.floor(e/60%60),r="0"+Math.floor(e/3600);return t?parseInt(1e3*e):r.slice(-2)+":"+n.slice(-2)+":"+i.slice(-2)},k=function(e,t){var i=e.getSlideId()+"_"+e.getId(),n=document.createElement("div");if(n.id="media_container_"+i,n.className="media_container",t&&window.domTools.setStyle(n,t),e.isVideo()){var r=document.createElement("video");r.controls=!1,r.id="media_player_"+i,r.className="video_player",n.appendChild(r);var a=document.createElement("div");a.id="video_mask_"+i,a.className="video_mask hidden",n.appendChild(a)}else if(e.isAudio()){var o=C(e);if(o){var s=document.createElement("div");s.id="audio_icon_"+i,s.className=S[o],n.appendChild(s)}}return n},C=function(e){var t=(e.getPicture()||{}).blip,i=t&&t.blipAtom&&t.blipAtom.imageId,n=window.APP.presentation.getPresetAudioIcons();for(var r in n)if(n[r]===i)return r}},522:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a}));var n={MediaDataTypeNone:-1,MediaDataTypeMovie:0,MediaDataTypeOnlineVideo:1,MediaDataTypeSound:2,MeidaDataTypeOle:3,MediaDataTypeBlip:4,MediaDataTypeGif:5,MediaDataTypeHyperlink:6},r={presMediaUnknown:0,presMediaCDAudio:1,presMediaAudio:2,presMediaWavAudio:3,presMediaVideo:4,presMediaAviVideo:5,presMediaWavAudioLink:6,presMediaEmbedded:256},a={MediaSubType_Unk:0,MediaSubType_Wave:1,MediaSubType_OtherAudio:2,MediaSubType_Avi:3,MediaSubType_OtherVideo:4}},523:function(e,t,i){"use strict";i.r(t),i.d(t,"UnderlineType",(function(){return r})),i.d(t,"ParagraphReadingOrder",(function(){return a})),i.d(t,"TaskListChar",(function(){return o})),i.d(t,"TaskListIndex",(function(){return s})),i.d(t,"UnitType",(function(){return l})),i.d(t,"WpsEmphasisMark",(function(){return h})),i.d(t,"SupLinkType",(function(){return u}));var n=i(158);i.d(t,"FormatOpType",(function(){return n.FormatOpType})),i.d(t,"StyleSti",(function(){return n.StyleSti})),i.d(t,"HorzAlignMode",(function(){return n.HorzAlignMode})),i.d(t,"ListType",(function(){return n.ListType})),i.d(t,"SelectType",(function(){return n.SelectType})),i.d(t,"EditorEventTypes",(function(){return n.EditorEventTypes})),i.d(t,"NoWidthLineStyle",(function(){return n.NoWidthLineStyle})),i.d(t,"UnderlineMode",(function(){return n.UnderlineMode})),i.d(t,"ModelNamesDef",(function(){return n.ModelNamesDef})),i.d(t,"FillType",(function(){return n.FillType})),i.d(t,"ShapeType",(function(){return n.ShapeType})),i.d(t,"PlaceholderType",(function(){return n.PlaceholderType})),i.d(t,"WpActionType",(function(){return n.WpActionType})),i.d(t,"LinkType",(function(){return n.LinkType})),i.d(t,"BlibFillType",(function(){return n.BlibFillType})),i.d(t,"LineType",(function(){return n.LineType})),i.d(t,"LineValueMap",(function(){return n.LineValueMap}));var r={wpsUnderlineNone:0,wpsUnderlineSingle:1,wpsUnderlineWords:2,wpsUnderlineDouble:3,wpsUnderlineDotted:4,wpsUnderlineThick:6,wpsUnderlineDash:7,wpsUnderlineDotDash:9,wpsUnderlineDotDotDash:10,wpsUnderlineWavy:11,wpsUnderlineWavyHeavy:27,wpsUnderlineDottedHeavy:20,wpsUnderlineDashHeavy:23,wpsUnderlineDotDashHeavy:25,wpsUnderlineDotDotDashHeavy:26,wpsUnderlineDashLong:39,wpsUnderlineDashLongHeavy:55,wpsUnderlineWavyDouble:43},a={ReadingOrderLtr:0,ReadingOrderRtl:1},o={Todo:String.fromCharCode(61693),Done:String.fromCharCode(61694)},s={Todo:8,Done:9},l={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},h={wpsEmphasisMarkNone:0,wpsEmphasisMarkOverSolidCircle:1,wpsEmphasisMarkOverComma:2,wpsEmphasisMarkOverWhiteCircle:3,wpsEmphasisMarkUnderSolidCircle:4},u=[n.WpActionType.ActionFirstSlide,n.WpActionType.ActionLastSlide,n.WpActionType.ActionPreviousSlide,n.WpActionType.ActionNextSlide,n.WpActionType.ActionHyperlink]},559:function(e,t,i){"use strict";t.a={SUCCESS_INCLUDE_DATA:1,SUCCESS_CONTENT_LONG:2,SUCCESS_CONTENT_LONG_TEXT:3,SUCCESS_CONTENT_LONG_TEXT_CUT:4,ERROR:5}},563:function(e,t,i){"use strict";i.r(t),i.d(t,"VIEW_EVENT_TYPES",(function(){return n}));var n={MODIFY:"MODIFY",ERROR_READONLY:"error_readonly",THUMBNAIL_UPDATE:"thumbnail_update",DOC_INIT:"doc_init",MODE_CHANGE:"mode_change",THUMBNAIL_DOC_CHANGE:"thumbnail_doc_change",DOC_LAYOUTS_LOADED:"ALL_LOADED",PLAYER_EVENT:"player_event",ZOOM_CHANGE:"zoom_change",DOC_RESIZE:"doc_resize",DOC_CHANGE:"doc_change",ACTIVE_SLIDE_CHANGE:"active_slide_change",SET_ACTIVE_SLIDE:"set_active_slide",ON_PREVIEW_LIMIT:"preview_limit",MEDIA_PLAY_CHANGE:"media_play_change",MEDIA_VISIBLE_CHANGE:"media_visible_change",MEDIA_STYLE_CHANGE:"media_style_change",MEDIA_PLAY_END:"media_play_end",DESTROY_SLIDE_VIDEO:"destroy_slide_video",PREVIEW_ANIMATION:"preview_animation",SEARCH_AT_END:"search_at_end",SEARCH_RESULT_CHANGED:"search_result_changed",SEARCH_RESULT_ADD:"search_result_add",SEARCH_RESULT_REMOVE:"search_result_remove",SEARCH_INDEX_CHANGE:"search_index_change",WPP_LASERPEN_INK_POINTS:"wpp_laserpen_ink_points",WPP_INK_TOOLBAR:"wpp_ink_toolbar",WPP_INK_VISIBLE:"wpp_ink_visible",SLIDE_CHANGE_DONE:"slide_change_done",SELECT_SHAPE_CHANGE:"select_shape_change",SELECT_SLIDE_CHANGE:"select_slide_change",ON_FORECE_ROTATE_CHANGE:"on_forece_rotate_change",SET_AUTO_FORECE_ROTATE:"SET_AUTO_FORECE_ROTATE",COOPER_SELECTION_CHANGE:"cooper_selection_change",READONLY_SELECT_SHAPE_POSITION:"readonly_select_shape_position",SVG_ROOT_VIEW_CHANGE:"svg_root_view_change",SLIDE_CORE_DATA_COMPLETED:"slide_core_data_completed",MASTER_SLIDE_CHANGE:"master_slide_change",ERROR_CORE:"error_core",REMARK_AUDIENCE_VIEW_OPENED:"remark_audience_view_opened",MULTI_SLIDE:"multi_slide",EXPLAIN_PLAYER_INIT_DONE:"explain_player_init_done",MODIFY_PAGE_SETUP:"modify_page_setup",MODIFY_DOCUMENT_BEAUTIFY:"MODIFY_DOCUMENT_BEAUTIFY",BACKEND_CMD:"backend_cmd"}},617:function(e,t,i){"use strict";var n=i(150),r=i.n(n),a=i(26),o=i.n(a),s=i(147),l=i.n(s),h=i(236),u=i(216),c=i(222),d=i(0),p=i.n(d),f=i(3),g=i.n(f),y=i(144),v=function(){function e(t){p()(this,e),this.resolveOptions(t),this.initSelection()}return g()(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.text=e.text,this.needFake=e.needFake}},{key:"initSelection",value:function(){this.needFake?this.selectFake():y.isMobile&&(document.clipboard="")}},{key:"selectFake",value:function(){var e=this;this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.setAttribute("style","font-Size:12px;border:0;padding:0;margin:0;opacity:0;z-index:-1;position:absolute;top:0px"),this.fakeElem.setAttribute("readonly",""),y.isIEPure&&(this.fakeElem.style.position="fixed");var t=this.text?this.text.substring(0,37e3):"";if(this.fakeElem.value=t,this.container.appendChild(this.fakeElem),this.fakeElem.setSelectionRange)this.fakeElem.setSelectionRange(0,this.fakeElem.value.length);else if(this.fakeElem.createTextRange){var i=this.fakeElem.createTextRange();i.collapse(!0),i.moveStart("character",0),i.moveEnd("character",0,this.fakeElem.value.length),i.select()}var n=document.activeElement;this.fakeElem.focus(),this.copyText(),n&&"function"==typeof n.focus&&n.focus(),this.removeFake()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action),y.isIE||(document.clipboard=this.text)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){e||console.error("fail copy"),console.log("execCommand('copy') = "+e)}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(e){if(this._action=e||"copy","copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}}]),e}(),m=i(556),_=i(145),w=i(162),S=i(303),x=void 0,T=void 0,k=function(){x&&(document.removeEventListener(x,b),x=void 0)},C=function(e){return"ok"===e.callstatus};function b(e){if(!y.isIos||y.isPad){k();var t=e.clipboardData||window.clipboardData;if(t){var i=T[c.default.text];if(y.isIEPure)t.setData(c.default.ieText,i);else{var n=T[c.default.html],r=u.default.getCurrentClipBoardInfo(),a=h.default.assembleClipData(i,n,r),o=T[c.default.isShape];C(m.a.write(a))||(i&&(window.officeType===w.default.writer||window.officeType===w.default.presentation?t.setData(c.default.text,i):o||t.setData(c.default.text,i)),window.APP.copyControl&&window.APP.copyControl()&&(n=S.a.addClipboardInfo2Html(""," ",r)),n&&t.setData(c.default.html,n),r&&t.setData(c.default.ksDocClipBoardInfo,JSON.stringify(r)))}Object(_.stopBubble)(e)}}}var E=void 0,R={eventType:"",handler:null};var P=function(e,t,i){!function(){E&&E.destroy();var e=R,t=e.eventType,i=e.handler;i&&document.removeEventListener(t,i),R={}}();var n=i.needFake;if(function(e,t){document.addEventListener(e,t),R={eventType:e,handler:t}}(e,t),n){var r=i.options||document.body;E=new v(o()({},i,{action:e,container:r}))}},I=function(e,t){return k(),x=e,T=t,b},L="copy",A="cut",B=function(e){return!(e&&(e.type===L||e.type===A))},D=void 0,M=function(e,t,i,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];i&&console.log("[xclipboard] sync write: ",i);var o=h.default.assembleClipData(t,i,n,a);u.default.setCurrentClipBoardInfo(o[c.default.ksDocClipBoardInfo]);var s=I(D,o),l=e;return A===e&&r&&(l=L),P(l,s,{text:t,needFake:r}),a&&(o[c.default.text]=void 0),o},O=function(e,t,i,n,r,a){var o=M(D=L,e,t,i,n,r);return r&&a&&S.a.supportImage()&&(o[c.default.image]=a,S.a.write(o).then((function(e){0!==e.status&&delete o[c.default.image]}))),o},N=function(e,t,i,n,r){return M(D=A,e,t,i,n,r)},F=i(626),V=i.n(F),U={},G=0;function H(){this.init()}H.prototype={constructor:H,init:function(){S.a.checkSupport()},isSupportImage:function(){return S.a.supportImage()},asyncWrite:function(e,t){var i=this;return l()(regeneratorRuntime.mark((function n(){var r,a,s,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(U=o()({},e),r=U[c.default.text],a=U[c.default.html],s=U[c.default.image],r||a||!s){i.next=8;break}return i.next=7,m.a.write(h.default.assembleClipData(null,null,null,!0,s,!0));case 7:return i.abrupt("return",i.sent);case 8:if(t===G){i.next=10;break}return i.abrupt("return",!1);case 10:return(l=u.default.getCurrentClipBoardInfo())&&(l.priorityFormat=u.default.getPriorityFormat(l)),i.next=14,m.a.write(h.default.assembleClipData(r,a,l,!!s,s,!0));case 14:return i.abrupt("return",i.sent);case 15:case"end":return i.stop()}}),n,i)})))()},copy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.clipboardData;return U=O(e,null,null,B(t)),console.log("剪贴板信息",U),++G},cut:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.clipboardData;return U=N(e,null,null,B(t)),++G},copyShape:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;console.log("[xclipboard] copyShape",{html:e,placeholder:i,image:n});var r=t?u.default.getCurrentClipBoardInfo():null;r||(r=u.default.createClipboardInfo());var a=e;return r&&(r.priorityFormat=u.default.getPriorityFormat(r),a=S.a.addClipboardInfo2Html("",e,r)),U=O(i,a,r,!0,!0,n),++G},getClipBoardData:function(e){var t=this;return l()(regeneratorRuntime.mark((function i(){var n,a,s,l,d,p,f,g,v,_,w,x,T,k,b,E,R,P;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(S.a.event=e,console.log("[xclipboard] getClipBoardData event:",e),e||!y.isPad){i.next=9;break}return a=o()({},U),s=u.default.getCurrentClipBoardInfo(),a[c.default.id]=s&&s.id,a.memory=!0,console.log("[xclipboard] memory",a),i.abrupt("return",a);case 9:return l=h.default.wrapE(e),i.next=12,m.a.read();case 12:if(d=i.sent,p=V()({userAgent:y,wrapE:!l,res:d}),!d||!d[c.default.async]){i.next=23;break}if(y.isMobile||(f=u.default.getCurrentClipBoardInfo(!1),d.updateExternal=t.freshCurrentClipInfo(l,d,f)),g=o()({},d,{unSupportContext:p}),!C(g)){i.next=21;break}return u.default.setCurrentClipBoardInfo(d[c.default.ksDocClipBoardInfo]),i.next=21,h.default.buildClipboardData(g);case 21:return console.log("[xclipboard] async read: ",g),i.abrupt("return",g);case 23:if(v=C(d),_=u.default.getCurrentClipBoardInfo(!1),w=!1,!v){i.next=33;break}return x=h.default.wrapClientClipData(d,_,w),d[c.default.ksDocClipBoardInfo]&&u.default.setCurrentClipBoardInfo(d[c.default.ksDocClipBoardInfo]),h.default.needExpiredClipInfo(d,_)&&(x[c.default.html]=void 0,t.asyncWrite(r()({},c.default.text,d[c.default.text]),G)),d[c.default.id]&&(x[c.default.id]=d[c.default.id]),console.log("[xclipboard] client read: ",x),i.abrupt("return",x);case 33:if(y.isMobile||(w=t.freshCurrentClipInfo(l,d,_)),T=h.default.getWrapClipData(l,U),k=y.isIE?T.getData(c.default.ieText):T.getData(c.default.text),n={},r()(n,c.default.text,k),r()(n,"updateExternal",w),r()(n,"unSupportContext",p),b=n,E=_&&_.expired,y.isIEPure){i.next=46;break}return b[c.default.html]=T.getData(c.default.html),b[c.default.html]&&(R=S.a.parseClipboardInfoFromHtml(b[c.default.html]),b[c.default.html]=R[c.default.html],R[c.default.ksDocClipBoardInfo]&&!E&&u.default.setCurrentClipBoardInfo(R[c.default.ksDocClipBoardInfo])),b[c.default.files]=h.default.extractClipFileData(T),P=u.default.getCurrentClipBoardInfo(),b[c.default.id]=P&&P.id,i.next=46,h.default.buildClipboardData(b);case 46:return E&&b[c.default.html]&&(b[c.default.html]=""),console.log("[xclipboard] sync read: ",b),i.abrupt("return",b);case 49:case"end":return i.stop()}}),i,t)})))()},pasteToSys:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(U={},h.default.buildSysClipboardData(e,U));var t=U[c.default.text]||" ",i=U[c.default.html],n=u.default.getCurrentClipBoardInfo(!1);if(n&&(n.priorityFormat=u.default.getPriorityFormat(n),i=S.a.addClipboardInfo2Html("",i,n)),O(t,i,n,!0),e&&e.oncePaste){var r=o()({},U);r[c.default.html]=i,r[c.default.ksDocClipBoardInfo]=n,m.a.write(r)}},getCopyID:function(){return G}};var W=H,j=W.prototype,Y={addEventListener:u.default.addEvent,removeEventListener:u.default.removeEvent,clearEvent:u.default.clearKSEvent};W.prototype=o()({},j,Y);var z=W.prototype,K={checkClipboardChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=t||u.default.getClipBoardInfo(e);return u.default.checkClipboardChange(i,u.default.getCurrentClipBoardInfo(!1))},clear:function(){u.default.setCurrentClipBoardInfo(null)},getCurrentClipBoardInfo:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=u.default.getCurrentClipBoardInfo(e);if(!t)return null;var i=u.default.getPriorityFormat(t);return o()({},t,{priorityFormat:i})},createClipboardInfo:function(){if(!y.isIE)return console.warn("~~~ 非IE环境，不能调用此接口!"),null;var e=u.default.createClipboardInfo(),t=u.default.getPriorityFormat(e);return o()({},e,{priorityFormat:t})},freshCurrentClipInfo:function(e,t,i){if(!e&&!t.async)return!1;var n=!1,r=u.default.getClipBoardInfo(e);if(!e&&!r){var a=t[c.default.html];r=S.a.parseClipboardInfoFromHtml(a)[c.default.ksDocClipBoardInfo]}return e&&this.checkClipboardChange(e,t[c.default.ksDocClipBoardInfo])&&(n=!0,u.default.clear()),h.default.needExpiredClipInfo(r,i)&&(r=null),u.default.setCurrentClipBoardInfo(r),n}};W.prototype=o()({},z,K);var q=i(627),X=i.n(q),J=new W;t.a=X()(J)},626:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.wrapE,i=e.res,n=i.async,r=i.callstatus,a=e.userAgent,o=a.isMobile,s=a.isPad,l=a.isSafari;return!!t&&(n?!(!l||s)||"ok"!==r:!o&&t&&!s)}},627:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(628)),a=(0,n.__importDefault)(i(222)),o=i(363),s=i(281),l=(0,n.__importDefault)(i(236)),h=(0,n.__importDefault)(i(162));function u(){this.getCopyID=function(){return r.default.getCopyID()},this.asyncWrite=function(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function(){return(0,n.__generator)(this,(function(i){return[2,r.default.write(e,!1,t)]}))}))},this.copy=function(e,t){var i;return void 0===t&&(t=window.clipboardData),r.default.write(((i={})[a.default.text]=e,i))},this.cut=function(e,t){var i;return void 0===t&&(t=window.clipboardData),r.default.write(((i={})[a.default.text]=e,i))},this.copyShape=function(e,t,i,n){var o;return void 0===t&&(t=!1),void 0===n&&(n=null),r.default.write(((o={})[a.default.html]=e,o[s.WoMimeTypes.image]=n,o),t)},this.getClipBoardData=function(e){return(0,n.__awaiter)(this,void 0,void 0,(function(){return(0,n.__generator)(this,(function(e){return[2,r.default.read()]}))}))},this.pasteToSys=function(e){return(0,n.__awaiter)(this,void 0,void 0,(function(){var t;return(0,n.__generator)(this,(function(i){return window.officeType===h.default.outline?(t={},l.default.buildSysClipboardData(e,t),[2,r.default.write(t,!1,this.getCopyID())]):[2]}))}))}}t.default=function(e){if(!r.default.support())return e;u.prototype=e,u.prototype.constructor=u;for(var t=new u,i=0,n=Object.getOwnPropertyNames(t);i<n.length;i++){var a=n[i];"function"==typeof t[a]&&(t[a]=(0,o.supportAOP)((0,o.woLogAOP)(t[a]),r.default))}return t}},628:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWoClipBoard=void 0;var n=i(143),r=(0,n.__importDefault)(i(629));t.IWoClipBoard=r.default;var a=(0,n.__importDefault)(i(630)),o=(0,n.__importDefault)(i(454)),s=(0,n.__importDefault)(i(216)),l=i(281),h=(0,n.__importStar)(i(162)),u=(0,n.__importDefault)(i(632)),c=0;t.default=function(){var e,t=this,i=u.default.isSupportPre()&&((0,h.isEtLike)(window.officeType)||window.officeType===h.default.outline);return{getCopyID:function(){return c},support:function(){return i},read:function(){return(0,n.__awaiter)(this,void 0,Promise,(function(){var e,t;return(0,n.__generator)(this,(function(i){switch(i.label){case 0:return e=a.default,t=[u.default],[4,this.supportMimeTypes()];case 1:return[2,e.apply(void 0,t.concat([i.sent()]))]}}))}))},write:function(e,t,i){var r;void 0===t&&(t=!1),void 0===i&&(i=null);var a=t?s.default.getCurrentClipBoardInfo():s.default.createClipboardInfo(),h=null!==i;if(h&&i!==c)throw o.default.invalid;s.default.setCurrentClipBoardInfo(a);var d=function(e,t){return t.nativeWOWrite(e)}((0,n.__assign)((0,n.__assign)({},e),((r={})[l.WoMimeTypes.ksDocClipBoardInfo]=JSON.stringify(a),r)),u.default);return h?d:++c},supportMimeTypes:function(){return(0,n.__awaiter)(t,void 0,void 0,(function(){return(0,n.__generator)(this,(function(t){switch(t.label){case 0:return e?[3,2]:[4,u.default.supportMimeTypes()];case 1:e=(e=t.sent())[l.WoMimeTypes.mimeTypes],t.label=2;case 2:return[2,e]}}))}))}}}()},629:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},630:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(631)),a=(0,n.__importDefault)(i(222)),o=(0,n.__importDefault)(i(216)),s=i(281),l=i(363);function h(e,t,i){void 0===e&&(e=""),void 0===i&&(i=[]);var n=i.includes(e)?t[e]:void 0;try{return n&&e===s.WoMimeTypes.ksDocClipBoardInfo?JSON.parse(n):n}catch(e){throw window.isDebugger&&console.error("wo_clip_info is invalid: ".concat(n)),e}}t.default=(0,l.woLogAOP)((function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i=!1);var n=e.nativeWORead();return i?n:new Promise((function(e){n.then((function(i){var n,l,u=h(s.WoMimeTypes.ksDocClipBoardInfo,i,t),c=h(s.WoMimeTypes.html,i,t),d=h(s.WoMimeTypes.text,i,t),p=h(s.WoMimeTypes.image,i,t),f=o.default.getCurrentClipBoardInfo(!1);l=(0,r.default)(u,f).updateExternal,e(((n={callstatus:i.callstatus,updateExternal:l,unSupportContext:!1})[a.default.html]=c,n[a.default.text]=d,n[a.default.files]=p,n[a.default.id]=u?u.id:void 0,n))})).catch((function(e){throw e}))}))}))},631:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=(0,n.__importDefault)(i(236)),a=(0,n.__importDefault)(i(216));t.default=function(e,t){var i;return(i=a.default.checkClipboardChange(e,t))&&a.default.clear(),r.default.needExpiredClipInfo(e,t)&&a.default.setCurrentClipBoardInfo(null),{updateExternal:i}}},632:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(143),r=i(281),a=i(363),o=i(633);var s={isSupportPre:function(){return window.WPSNativeMessageChannel.isSupportNativeClipBoard()},supportMimeTypes:function(){return window.WPSNativeMessageChannel.invokeNativeMessageCallback({handleName:"WOMessageHandle",methodName:"CLIPMimeTypes",callbackName:"WoClipBoardBack",callbackHandle:o.clientExtract})},nativeWORead:function(){return window.WPSNativeMessageChannel.invokeNativeMessageCallback({handleName:"WOMessageHandle",methodName:"woClipRead",callbackName:"WoClipBoardBack",callbackHandle:o.clientExtract})},nativeWOWrite:function(e){return(0,n.__awaiter)(this,void 0,Promise,(function(){var t,i,a;return(0,n.__generator)(this,(function(o){switch(o.label){case 0:return(t=e[r.WoMimeTypes.image])?[4,new Promise((function(e){var i,n,r;i=t,n=function(t){e(t)},(r=new FileReader).onload=function(e){n(e.target.result)},r.readAsDataURL(i)}))]:[3,2];case 1:return i=o.sent(),[2,window.WPSNativeMessageChannel.invokeNativeMessageCallback({handleName:"WOMessageHandle",methodName:"woClipWrite",callbackName:"WoClipBoardBack",params:(0,n.__assign)((0,n.__assign)({},e),(a={},a[r.WoMimeTypes.image]=i,a))})];case 2:return[2,window.WPSNativeMessageChannel.invokeNativeMessageCallback({handleName:"WOMessageHandle",methodName:"woClipWrite",callbackName:"WoClipBoardBack",params:e})]}}))}))}};t.default=(0,a.woObjectLogAop)(s)},633:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clientExtract=void 0;var n=i(143),r=i(144),a=i(281),o=i(236),s=(0,n.__importDefault)(i(536));t.clientExtract=function(e){var t;if(r.isAndroid)try{var i=JSON.parse(s.default.decode(e)),l=i.status,h=i.params;t=(0,n.__assign)((0,n.__assign)({},h),{callstatus:"success"===l?"ok":"fail"})}catch(t){throw new Error("wo-clip-android: ".concat(t.message," ").concat(e))}if(r.isIos&&((t=e.params?e.params:e).callstatus="success"===e.status?"ok":"fail"),!t)return t;var u=t[a.WoMimeTypes.image];return u&&(t[a.WoMimeTypes.image]=function(e){var t=e.split(","),i=t[0].split(":")[1].split(";")[0];return(0,o.base64ToBlob)(t[1],i)}(u)),t}},664:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPENAPI_EVENT=void 0,t.OPENAPI_EVENT={SET_MODE:"openapi.set.mode",SET_ACTIVE_SLIDE:"openapi.set.active.slide",ON_PREVIEW_LIMIT:"openapi.on.preview.limit",SET_ZOOM:"openapi.set.zoom",SET_PLAY_FULLSCREEN_TYPE:"openapi.set.play.isLanchFullscrenn.type",SLIDE_UPDATE_WATERMARK:"slide_update_watermark",SET_SHOW_PAGE:"set_show_page",UPDATE_LASERPEN:"update_laserpen",OPEN_INK_EDITOR:"open_ink_editor",ON_GET_MEDIA_PLAY_MSG:"on_get_media_play_msg",CLICK_LANCH_FULLSCREEN:"click_lunch_fullscreen",CLICK_EXIT_FULLSCREEN:"click_exit_fullscreen",SET_START_AUTO_PLAY:"set_start_auto_play",SET_STOP_AUTO_PLAY:"set_stop_auto_play",SET_RESUME_ADVANCE_PLAY:"set_resume_advance_play",SET_STOP_ADVANCE_PLAY:"set_stop_advance_play",SET_HIDE_PLAYING_MENU:"set_hide_playing_menu",SET_HIDE_PLAY_HOVER_LINK:"set_hide_play_link",SET_HIDE_IMAGE_HOVER_TIP:"set_hide_image_hover_tip",STOP_VIDEO_PLAY:"stop_video_play",ON_PLAY_MEDIA:"on_play_media",ON_LAST_PAGE:"on_last_page",INSERT_IMAGE:"insert_image",RECEIVE_MATTING_PICTURE:"receive_matting_picture",INSERT_SLIDE:"open_api_insert_slide",INSERT_TEXTBOX:"open_api_insert_textbox",INSERT_HYPERLINK:"open_api_insert_hyperlink",REPLACE_PICTURE:"replace_picture",SET_MINI_THUMBNAIL_VISIBLE:"set_mini_thumbnail_visible",MINI_THUMBNAIL_VISIBLE_INFO:"mini_thumbnail_visible_info",EXIT_VIDEO_FULLSCREEN:"exit_video_fullscreen",VIDEO_FULLSCREEN_INFO:"video_fullscreen_info",SET_PLAY_TOOLBAR_POSITION:"set_paly_toolbar_position",SET_PLAY_INK_POSITION:"set_play_ink_position",SHOW_PALY_TOOLBAR:"show_play_toolbar",SET_COUNT_DOWN:"set_count_down",OPEN_REMARK_SPEAKER:"open_remark_speaker",ON_DIAGRAM_MOUNT:"ON_DIAGRAM_MOUNT",ON_DIAGRAM_TOGGLE_BTNS:"ON_DIAGRAM_TOGGLE_BTNS",BEAUTIFY_DIAGRAM_PPT:"BEAUTIFY_DIAGRAM_PPT",INSERT_DIAGRAM:"INSERT_DIAGRAM",INSERT_DIAGRAM_FINISH:"INSERT_DIAGRAM_FINISH",SLIDE_MOVE:"slide_move",SLIDE_INSERT:"slide_insert",SLIDE_DELETE:"slide_delete",SLIDE_CHANGE_OPERATOR:"slide_change_operator",OPEN_REVIEW:"open_review",CLOSE_REVIEW:"close_review",OPEN_REVIEW_END:"open_review_END",OPEN_REVIEW_INK:"open_review_ink",SET_BG_OPACITY:"set_bg_opacity",LAST_SLIDE_END:"last_slide_end",SET_INK_COLOR:"SET_INK_COLOR",SET_INK_WIDTH:"SET_INK_WIDTH",UPDATE_UNDO_REDO:"UPDATE_UNDO_REDO",SWITCH_TO_ERASER:"SWITCH_TO_ERASER",CHANGE_INK_TYPE:"CHANGE_INK_TYPE",GO_TO_COMMENTITEM:"GO_TO_COMMENTITEM",SWITCH_PLAY_FULLSCREEN:"switch_play_fullscreen",ON_PREVIEW_SCROLL_TO_BOTTOM:"ON_PREVIEW_SCROLL_TO_BOTTOM",COMMENT_MODIFY_MESSAGE:"COMMENT_MODIFY_MESSAGE"}},665:function(e,t,i){"use strict";i.d(t,"f",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"h",(function(){return o})),i.d(t,"g",(function(){return s})),i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return u}));var n={None:0,Legacy:1,Normal:2,Lighten:3,LightenLess:4,Darken:5,DarkenLess:6},r={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},a={LinearShade:0,ShapeShade:1,CircleShade:2,RectangleShade:3},o={TileFlipNone:0,TileFlipHorizontal:1,TileFlipVertical:2,TileFlipBoth:3},s={RectangleAlignmentTopLeft:0,RectangleAlignmentTop:1,RectangleAlignmentTopRight:2,RectangleAlignmentLeft:3,RectangleAlignmentCenter:4,RectangleAlignmentRight:5,RectangleAlignmentBottomLeft:6,RectangleAlignmentBottom:7,RectangleAlignmentBottomRight:8},l={AlphaBiLevel:0,AlphaCeiling:1,AlphaFloor:2,AlphaInverse:3,AlphaModulate:4,Blend:5,AlphaModulateFixed:6,AlphaOutset:7,AlphaReplace:8,BiLevel:9,Blur:10,ColorChange:11,ColorReplace:12,Duotone:13,EffectContainer:14,EffectRef:15,FillOverlay:16,Glow:17,Grayscale:18,HSL:19,InnerShadow:20,Luminance:21,OuterShadow:22,PresetShadow:23,Reflection:24,RelativeOffset:25,SoftEdges:26,Tint:27,Transform:28,PictureEffectBegin:29,ArtisticBlur:29,ArtisticCement:31,ArtisticChalkSketch:32,ArtisticCrisscrossEtching:33,ArtisticCutout:34,ArtisticFilmGrain:35,ArtisticGlass:36,ArtisticGlowDiffused:37,ArtisticGlowEdges:38,ArtisticLightScreen:39,ArtisticLineDrawing:40,ArtisticMarker:41,ArtisticMosiaicBubbles:42,ArtisticPaintBrush:43,ArtisticPaintStrokes:44,ArtisticPastelsSmooth:45,ArtisticPencilGrayscale:46,ArtisticPencilSketch:47,ArtisticPhotocopy:48,ArtisticPlasticWrap:49,ArtisticTexturizer:50,ArtisticWatercolorSponge:51,BackgroundRemoval:52,BrightnessContrast:53,ColorTemperature:54,Saturation:55,SharpenSoften:56},h={type:r.FillTypeNone},u={type:r.FillTypeGradient,shadeType:a.LinearShade}},697:function(e,t,i){"use strict";i.r(t);var n=i(164);i.d(t,"Loader",(function(){return n.default}));var r=i(311);i.d(t,"PubComponent",(function(){return r.PubComponent})),i.d(t,"WPPCustomEvent",(function(){return r.WPPCustomEvent}));var a=i(208);i.d(t,"userAgent",(function(){return a.userAgent})),i.d(t,"ViewModes",(function(){return a.ViewModes})),i.d(t,"VIEW_EVENT_TYPES",(function(){return a.VIEW_EVENT_TYPES})),i.d(t,"FocusTargetsDef",(function(){return a.FocusTargetsDef}))},724:function(e,t,i){"use strict";i.d(t,"d",(function(){return n})),i.d(t,"e",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return s}));var n={MoveTo:1,LineTo:2,ArcTo:3,QuadraticBezierTo:4,CubicBezierTo:5,Close:6},r={None:0,Legacy:1,Normal:2,Lighten:3,LightenLess:4,Darken:5,DarkenLess:6},a={MultiplyDivide:0,AddSubtract:1,AddDivide:2,IfElse:3,Absolute:4,ArcTan:5,CosineArcTan:6,Cosine:7,Maximum:8,Minimum:9,Modulo:10,PinTo:11,SineArcTan:12,Sine:13,SquareRoot:14,Tangent:15,SumAngle:16,Ellipse:17,LiteralValue:18},o={gdRefXY:0,gdRefX:1,gdRefY:2,gdRefR:3,gdRefAng:4,gdRefPolar:5},s=5},725:function(e,t,i){"use strict";i.r(t),i.d(t,"KeyAction",(function(){return r})),i.d(t,"KeyCode",(function(){return a})),i.d(t,"MouseButton",(function(){return o})),i.d(t,"MouseAction",(function(){return s})),i.d(t,"MenuText",(function(){return l}));var n=i(144),r={down:"down",up:"up",press:"press",inputText:"inputText"},a={enter:13,backspace:8,tab:9,space:32,delete:46,left:37,right:39,up:38,down:40,m:77,home:36,end:35},o={left:0,middle:1,right:2},s={clickSlide:0,clickText:1,rightClick:2,selectText:3,selectMultiShape:4,clickShape:5,insertShape:6,insertTextBox:7,movingShape:8,insertInk:9,moveContent:10,selectTableColumn:11,selectTableRow:12,selectTableBorderVert:13,selectTableBorderHori:14,clickTableCell:15,resizingShape:16,adjustingShape:17},l={copy:'<i class="icons icon-16 icons-context-copy"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.copy", "复制")+'</span><span class="short-cut">'+Object(n.convertCtrl)("Ctrl + C")+"</span>",paste:'<i class="icons icon-16 icons-context-paste"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.paste", "粘贴")+'</span><span class="short-cut">'+Object(n.convertCtrl)("Ctrl + V")+"</span>",cut:'<i class="icons icon-16 icons-context-cut"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.cut", "剪切")+'</span><span class="short-cut">'+Object(n.convertCtrl)("Ctrl + X")+"</span>",replace:'<i class="icons icon-16 icons-16-replace_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.replacePicture", "替换图片")+"</span>",download:'<i class="icons icon-16 icons-16-download_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.downloadPicture", "下载原图")+"</span>",matting:'<i class="icons icon-16 icons-16-matting_picture"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.mattingPicture", "抠图")+"</span>",line:'<span class="divider-line"></span>',link:'<i class="icons icon-16 icons-context-hyperlink"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.link", "插入链接")+'</span><span class="short-cut">',openLink:'<i class="icons icon-16 icons-context-hyperlink"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.openLink", "打开链接")+'</span><span class="short-cut"></span>',editLink:'<i class="icons icon-16 icons-context-link_edit"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.editLink", "编辑链接")+'</span><span class="short-cut"></span>',cancelLink:'<i class="icons icon-16 icons-context-link_delete"></i><span class="item-text">'+_i18n("applications.presentation.helpers.tools.keysDef.cancelLink", "取消链接")+'</span><span class="short-cut"></span>',setSlideBg:'<i class="icons icon-16 icons-16-set_to_bg"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.setSlideBg", "设为背景")+"</span>",slideBg:'<i class="icons icon-16 icons-16-set_to_bg"></i><span>'+_i18n("applications.presentation.helpers.tools.keysDef.slideBg", "设置背景")+"</span>"}},809:function(e,t,i){"use strict";i.d(t,"f",(function(){return l})),i.d(t,"g",(function(){return h})),i.d(t,"e",(function(){return u})),i.d(t,"b",(function(){return c})),i.d(t,"d",(function(){return d})),i.d(t,"a",(function(){return p})),i.d(t,"c",(function(){return f}));var n,r=i(150),a=i.n(r),o=i(158),s=i(874),l={CS_AutoNumGrayColor:4290822336,CS_TextNoShowColor:4278190080,DEFAULTINDENT:720,DEFAULTTAB:1440,CS_TextDefaultColor:524289,TEXT_MAX_TABSTOPS:20,TextRenderingHintAntiAlias:360,MAX_WORDS:80,DEFAULT_BULLETCHAR:8226,CS_TextShadowGrayColor:13026246,FontSize:360,FONT_MIN_SCALE:.25,FONT_MAX_SCALE:1,FONT_SCALE_ONE_STEP:.05,FontFamily:"宋体",AsciiFont:"Arial",TextColor:null},h=s.c,u=s.b,c={FontSize:280,FontFamily:"宋体",FontColor:"#383838",LineSpacing:{rule:"auto",value:126},anchorType:o.TextAnchoringType.Top,alignMode:o.HorzAlignMode.Adjustify,autoFit:o.AutoFit.None},d={Return:"\n",EndLine:"\v",EndPara:"\r",EndCell:"",EndSection:"\f",EndPage:"",EndColumn:"",Footnote:"",Comment:"",Drawing:"\b",Embed:"",Tab:"\t",Space:" ",FieldBegin:"",FieldSep:"",FieldEnd:"",TextSymbol:"(",ContentNodeBegin:"<",ContentNodeEnd:">",ControlBegin:"",ControlEnd:"",MathFunction:"",MathArgEnd:""},p={61548:108,61550:110,61557:117,61552:112,61692:252,61656:216},f=(n={},a()(n,o.PlaceholderType.Title,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Title", "单击此处添加标题")),a()(n,o.PlaceholderType.CenterTitle,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Title", "单击此处添加标题")||_i18n("applications.presentation.constants.textDefine.PlaceholderType.CenterTitle", "编辑标题")),a()(n,o.PlaceholderType.SubTitle,_i18n("applications.presentation.constants.textDefine.PlaceholderType.SubTitle", "单击此处添加副标题")),a()(n,o.PlaceholderType.Body,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Body", "单击此处添加文本")),a()(n,o.PlaceholderType.Footer,_i18n("applications.presentation.constants.textDefine.PlaceholderType.footer", "页脚区")),a()(n,"other",_i18n("applications.presentation.constants.textDefine.PlaceholderType.other", "单击此处添加文本")),a()(n,"noteTitle",_i18n("applications.presentation.constants.textDefine.PlaceholderType.noteTitle", "无备注")),a()(n,"editMaster",_i18n("applications.presentation.constants.textDefine.PlaceholderType.editMaster", "编辑母版")),a()(n,"style",_i18n("applications.presentation.constants.textDefine.PlaceholderType.style", "样式")),a()(n,"add",_i18n("applications.presentation.constants.textDefine.PlaceholderType.add", "添加")),n)},810:function(e,t,i){"use strict";var n=i(563);i.d(t,"a",(function(){return n.VIEW_EVENT_TYPES}))},873:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n={"zh-MO_radstr":{script:"Hant",type:2},"zh-TW_pronun":{script:"Hant",type:2},"zh-MO_stroke":{script:"Hant",type:2},"de-DE_phoneb":{script:"Latn",type:0},"tzm-Latn":{script:"Latn",type:0},"sd-Arab":{script:"Arab",type:1},"mn-Mong":{script:"Mong",type:1},"tg-Cyrl":{script:"Cyrl",type:0},"tzm-Tfng":{script:"Tfng",type:0},"az-Cyrl":{script:"Cyrl",type:0},"bs-Cyrl":{script:"Cyrl",type:0},"es-CU":{script:"Latn",type:0},"es-US":{script:"Latn",type:0},"es-NI":{script:"Latn",type:0},"sr-Latn":{script:"Latn",type:0},"es-HN":{script:"Latn",type:0},"en-SG":{script:"Latn",type:0},"es-SV":{script:"Latn",type:0},"en-MY":{script:"Latn",type:0},"es-BO":{script:"Latn",type:0},"ar-QA":{script:"Arab",type:1},"en-IN":{script:"Latn",type:0},"fr-HT":{script:"Latn",type:0},"ar-AE":{script:"Arab",type:1},"es-CL":{script:"Latn",type:0},"uz-Cyrl":{script:"Cyrl",type:0},"sr-Cyrl-ME":{script:"Cyrl",type:0},"ar-LB":{script:"Arab",type:1},"sr-Latn-ME":{script:"Latn",type:0},"en-TT":{script:"Latn",type:0},"ar-JO":{script:"Arab",type:1},"sr-Cyrl-RS":{script:"Cyrl",type:0},"fr-SN":{script:"Latn",type:0},"es-PE":{script:"Latn",type:0},"uz-Latn":{script:"Latn",type:0},"fr-CI":{script:"Latn",type:0},"smn-FI":{script:"Latn",type:0},"sr-Latn-RS":{script:"Latn",type:0},"fr-CD":{script:"Latn",type:0},"en-029":{script:"Latn",type:0},"es-EC":{script:"Latn",type:0},"ar-YE":{script:"Arab",type:1},"bs-Cyrl-BA":{script:"Cyrl",type:0},"fr-RE":{script:"Latn",type:0},"es-VE":{script:"Latn",type:0},"en-JM":{script:"Latn",type:0},"ka-GE_modern":{script:"Geor",type:0},"ar-OM":{script:"Arab",type:1},"fr-029":{script:"Latn",type:0},"es-DO":{script:"Latn",type:0},"en-ZA":{script:"Latn",type:0},"ar-TN":{script:"Arab",type:1},"fr-MC":{script:"Latn",type:0},"ar-MA":{script:"Arab",type:1},"fr-LU":{script:"Latn",type:0},"fr-ML":{script:"Latn",type:0},"uk-UA":{script:"Cyrl",type:0},"yi-001":{script:"Hebr",type:1},"de-LI":{script:"Latn",type:0},"zh-MO":{script:"Hant",type:2},"smj-NO":{script:"Latn",type:0},"en-CA":{script:"Latn",type:0},"ar-LY":{script:"Arab",type:1},"sd-Arab-PK":{script:"Arab",type:1},"quz-PE":{script:"Latn",type:0},"se-FI":{script:"Latn",type:0},"fy-NL":{script:"Latn",type:0},"fr-CA":{script:"Latn",type:0},bs:{script:"Latn",type:0},"en-AU":{script:"Latn",type:0},"rw-RW":{script:"Latn",type:0},"ar-EG":{script:"Arab",type:1},"es-PY":{script:"Latn",type:0},"ti-ER":{script:"Ethi",type:0},"ti-ET":{script:"Ethi",type:0},"quz-EC":{script:"Latn",type:0},"ff-Latn-SN":{script:"Latn",type:0},"ne-IN":{script:"Deva",type:1},"en-BZ":{script:"Latn",type:0},"es-ES":{script:"Latn",type:0},"smj-SE":{script:"Latn",type:0},"sr-Latn-BA":{script:"Latn",type:0},"es-CR":{script:"Latn",type:0},"tzm-Latn-DZ":{script:"Latn",type:0},"bn-BD":{script:"Beng",type:1},"az-Cyrl-AZ":{script:"Cyrl",type:0},"ur-IN":{script:"Arab",type:1},"ig-NG":{script:"Latn",type:0},"ru-MD":{script:"Cyrl",type:0},"ro-MD":{script:"Latn",type:0},"nn-NO":{script:"Latn",type:0},"nl-BE":{script:"Latn",type:0},"it-CH":{script:"Latn",type:0},"es-MX":{script:"Latn",type:0},"en-GB":{script:"Latn",type:0},"fr-CM":{script:"Latn",type:0},"ar-SY":{script:"Arab",type:1},"fr-BE":{script:"Latn",type:0},"ca-ES-valencia":{script:"Latn",type:0},"zh-HK":{script:"Hant",type:2},"ku-Arab-IQ":{script:"Arab",type:1},"sah-RU":{script:"Cyrl",type:0},"gsw-FR":{script:"Latn",type:0},"co-FR":{script:"Latn",type:0},"oc-FR":{script:"Latn",type:0},"br-FR":{script:"Latn",type:0},"ta-IN":{script:"Taml",type:1},"so-SO":{script:"Latn",type:0},"ar-DZ":{script:"Arab",type:1},"fr-CH":{script:"Latn",type:0},"moh-CA":{script:"Latn",type:0},"ii-CN":{script:"Yiii",type:2},"uz-Cyrl-UZ":{script:"Cyrl",type:0},"dz-BT":{script:"Tibt",type:1},"hsb-DE":{script:"Latn",type:0},"haw-US":{script:"Latn",type:0},"om-ET":{script:"Latn",type:0},"zh-CN":{script:"Hans",type:2},"pap-029":{script:"Latn",type:0},"tn-ZA":{script:"Latn",type:0},"kl-GL":{script:"Latn",type:0},"lb-LU":{script:"Latn",type:0},"sms-FI":{script:"Latn",type:0},"ba-RU":{script:"Cyrl",type:0},"az-Latn":{script:"Latn",type:0},"kr-NG":{script:"Latn",type:0},"nso-ZA":{script:"Latn",type:0},"quz-BO":{script:"Latn",type:0},"ar-BH":{script:"Arab",type:1},"mn-Mong-MN":{script:"Mong",type:1},"bin-NG":{script:"Latn",type:0},"yo-NG":{script:"Latn",type:0},"zh-CN_phoneb":{script:"Hans",type:2},"en-PH":{script:"Latn",type:0},"ha-Latn-NG":{script:"Latn",type:0},"en-ZW":{script:"Latn",type:0},"ff-NG":{script:"Latn",type:0},"ibb-NG":{script:"Latn",type:0},"dv-MV":{script:"Thaa",type:1},"en-IE":{script:"Latn",type:0},"ps-AF":{script:"Arab",type:1},"dsb-DE":{script:"Latn",type:0},"iu-Latn-CA":{script:"Latn",type:0},"ks-Arab":{script:"Arab",type:1},"as-IN":{script:"Beng",type:1},"ta-LK":{script:"Taml",type:1},"nl-NL":{script:"Latn",type:0},"si-LK":{script:"Sinh",type:1},"arn-CL":{script:"Latn",type:0},"ar-SA":{script:"Arab",type:1},"af-ZA":{script:"Latn",type:0},"sd-Deva-IN":{script:"Deva",type:1},"th-TH":{script:"Thai",type:1},"my-MM":{script:"Mymr",type:1},"es-CO":{script:"Latn",type:0},"sma-NO":{script:"Latn",type:0},"ar-IQ":{script:"Arab",type:1},"km-KH":{script:"Khmr",type:1},"sr-Cyrl":{script:"Cyrl",type:0},"bo-CN":{script:"Tibt",type:1},"ml-IN":{script:"Mlym",type:1},"quc-Latn":{script:"Latn",type:0},"rm-CH":{script:"Latn",type:0},"ur-PK":{script:"Arab",type:1},"gu-IN":{script:"Gujr",type:1},"pa-Arab-PK":{script:"Arab",type:1},"en-US":{script:"Latn",type:0},"uz-Latn-UZ":{script:"Latn",type:0},"ky-KG":{script:"Cyrl",type:0},"en-NZ":{script:"Latn",type:0},"mn-MN":{script:"Cyrl",type:0},"en-HK":{script:"Latn",type:0},"tt-RU":{script:"Cyrl",type:0},"mn-Mong-CN":{script:"Mong",type:1},"ja-JP_radstr":{script:"Jpan",type:2},"ve-ZA":{script:"Latn",type:0},"kk-KZ":{script:"Cyrl",type:0},"ms-MY":{script:"Latn",type:0},"cs-CZ":{script:"Latn",type:0},"zh-CN_stroke":{script:"Hans",type:2},"lo-LA":{script:"Laoo",type:1},"es-AR":{script:"Latn",type:0},"se-NO":{script:"Latn",type:0},"de-CH":{script:"Latn",type:0},"mn-Cyrl":{script:"Cyrl",type:0},"mk-MK":{script:"Cyrl",type:0},"mt-MT":{script:"Latn",type:0},"syr-SY":{script:"Syrc",type:1},"quc-Latn-GT":{script:"Latn",type:0},"id-ID":{script:"Latn",type:0},"ka-GE":{script:"Geor",type:0},"zh-SG":{script:"Hans",type:2},"prs-AF":{script:"Arab",type:1},"zu-ZA":{script:"Latn",type:0},"wo-SN":{script:"Latn",type:0},"hu-HU":{script:"Latn",type:0},"st-ZA":{script:"Latn",type:0},"ms-BN":{script:"Latn",type:0},"mr-IN":{script:"Deva",type:1},"se-SE":{script:"Latn",type:0},"pt-PT":{script:"Latn",type:0},"ts-ZA":{script:"Latn",type:0},"es-ES_tradnl":{script:"Latn",type:0},"or-IN":{script:"Orya",type:1},"es-GT":{script:"Latn",type:0},"ga-IE":{script:"Latn",type:0},"fi-FI":{script:"Latn",type:0},"sv-FI":{script:"Latn",type:0},"eu-ES":{script:"Latn",type:0},"te-IN":{script:"Telu",type:1},"lt-LT":{script:"Latn",type:0},"en-ID":{script:"Latn",type:0},"fr-FR":{script:"Latn",type:0},"ne-NP":{script:"Deva",type:1},"mni-IN":{script:"Beng",type:1},"el-GR":{script:"Grek",type:0},"zh-SG_stroke":{script:"Hans",type:2},"et-EE":{script:"Latn",type:0},"zh-HK_radstr":{script:"Hant",type:2},"gd-GB":{script:"Latn",type:0},"am-ET":{script:"Ethi",type:0},"xh-ZA":{script:"Latn",type:0},"bg-BG":{script:"Cyrl",type:0},"he-IL":{script:"Hebr",type:1},"lv-LV":{script:"Latn",type:0},"tk-TM":{script:"Latn",type:0},"es-PR":{script:"Latn",type:0},"zh-TW":{script:"Hant",type:2},"tr-TR":{script:"Latn",type:0},"ar-KW":{script:"Arab",type:1},"sr-Cyrl-BA":{script:"Cyrl",type:0},"ko-KR":{script:"Hang",type:2},"zh-SG_phoneb":{script:"Hans",type:2},"vi-VN":{script:"Viet",type:0},"sv-SE":{script:"Latn",type:0},"tzm-Arab-MA":{script:"Arab",type:1},"pa-IN":{script:"Guru",type:1},"kn-IN":{script:"Knda",type:1},"sq-AL":{script:"Latn",type:0},"de-AT":{script:"Latn",type:0},"fr-MA":{script:"Latn",type:0},"ks-Deva-IN":{script:"Deva",type:1},"es-UY":{script:"Latn",type:0},"es-PA":{script:"Latn",type:0},"hr-HR":{script:"Latn",type:0},"fa-IR":{script:"Arab",type:1},"be-BY":{script:"Cyrl",type:0},"tg-Cyrl-TJ":{script:"Cyrl",type:0},"sk-SK":{script:"Latn",type:0},"es-419":{script:"Latn",type:0},"sw-KE":{script:"Latn",type:0},"hr-BA":{script:"Latn",type:0},"fo-FO":{script:"Latn",type:0},"ru-RU":{script:"Cyrl",type:0},"az-Latn-AZ":{script:"Latn",type:0},"sl-SI":{script:"Latn",type:0},"is-IS":{script:"Latn",type:0},"ro-RO":{script:"Latn",type:0},"gl-ES":{script:"Latn",type:0},"tn-BW":{script:"Latn",type:0},"fil-PH":{script:"Latn",type:0},"zh-TW_radstr":{script:"Hant",type:2},"pt-BR":{script:"Latn",type:0},"bs-Latn":{script:"Latn",type:0},"kok-IN":{script:"Deva",type:1},"hy-AM":{script:"Armn",type:0},"ja-JP":{script:"Jpan",type:2},"hu-HU_technl":{script:"Latn",type:0},"nb-NO":{script:"Latn",type:0},"it-IT":{script:"Latn",type:0},"cy-GB":{script:"Latn",type:0},"iu-Cans-CA":{script:"Cans",type:0},"sma-SE":{script:"Latn",type:0},"sa-IN":{script:"Deva",type:1},"mi-NZ":{script:"Latn",type:0},"ks-Deva":{script:"Deva",type:1},"pl-PL":{script:"Latn",type:0},"bs-Latn-BA":{script:"Latn",type:0},"tzm-Tfng-MA":{script:"Tfng",type:0},"de-DE":{script:"Latn",type:0},"hi-IN":{script:"Deva",type:1},yi:{script:"Hebr",type:1},"la-001":{script:"Latn",type:0},"chr-Cher-US":{script:"Cher",type:0},"gn-PY":{script:"Latn",type:0},"ca-ES":{script:"Latn",type:0},"ku-Arab":{script:"Arab",type:1},"de-LU":{script:"Latn",type:0},"da-DK":{script:"Latn",type:0},"bn-IN":{script:"Beng",type:1}}},874:function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"d",(function(){return o}));var n={TextWrapNone:0,TextWrapSquare:1},r={NoAutoFit:0,NormalAutoFit:1,AdvancedAutoFit:2},a={LLetterWithDot:0,ULetterWithDot:1,ArabicWithRBracket:2,ArabicWithDot:3,LRomaWithLRBracket:4,LRomaWithRBracket:5,LRomaWithDot:6,URomaWithDot:7,LLetterWithLRBracket:8,LLetterWithRBracket:9,ULetterWithLRBracket:10,ULetterWithRBracket:11,ArabicWithLRBracket:12,Arabic:13,URomaWithLRBracket:14,URomaWithRBracket:15,LocalChar:16,LocalCharWithDot:17,ArabicWithRound:18,ArabicWithWhiteRound:19,ArabicWithBlackRound:20,LChineseB5:21,LChineseB5WithDot:22,ArabicChar:23,LChineseGB:24,LChineseGBWithDot:25,ArabicDbWidthDBDot:26,ArabicDb:27,HindiAlpha1WithDot:28,HindiAlphaWithDot:29,HindiNumRBracket:30,HindiNumWithDot:31,Hebrew:32,Arabic1:33,Arabic2:34,Ea1JpnKor:35,Ea1JpnKorWithDot:36,Ea1JpnChsWithDbDot:38,ThaiAlphaLRBracket:39,ThaiAlphaRBracket:40,ThaiAlphaWithDot:41,ThaiNumLRBracket:42,ThaiNumRBracket:43,ThaiNumWithDot:44},o={None:0,Bullet:1,AutoNum:2,Image:3}},940:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),a=i(3),o=i.n(a),s=i(25),l=i.n(s),h=i(42),u=i.n(h),c=i(335),d=i(523),p=i(237),f=i(158),g=function(e){function t(e){r()(this,t);var i=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.destroy=function(){},i.stopBubble=function(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()},i.fireMouseActionEvent=function(e){p.default.uilDispatcher.fire(f.UserEventTypes.MOUSE_ACTION,e)},i.isSelTextShape=function(){return i.getLocalSelection().state===d.SelectType.select_text||null},i.props=e,console.log(i.constructor.name+" has init."),i}return u()(t,e),o()(t,[{key:"getLocalSelection",value:function(){return this.editor.getLocalSelection()}},{key:"getAutoFit",value:function(){var e=this.getBodyStyle();return e&&e.autoFit}},{key:"getAutoFitMap",value:function(){var e=this.getBodyStyle();return e&&e.autoFitMap||{}}},{key:"_setTextFrameProperty",value:function(e){this.getLocalSelection().modifyTextFrameProperty(e)}},{key:"_setParagraphAttrs",value:function(e){this.getLocalSelection().fmtPapx(e)}},{key:"_setChapterAttrs",value:function(e){this.getLocalSelection().fmtChpx(e)}},{key:"_setShapeAttrs",value:function(e){this.getLocalSelection().modifyTextTableAttrs(e)}},{key:"_getSelectObjectAttrs",value:function(){return this.editor.getSelShapeAttrs()}},{key:"getBodyStyle",value:function(){return(this._getSelectObjectAttrs()||{}).textBodyStyle||{}}},{key:"getPapx",value:function(){return this.getBodyStyle().paragraphStyle||{}}},{key:"getFontScale",value:function(){return this.getBodyStyle().fontScale||1}},{key:"getChpx",value:function(){var e=this.getPapx().chapterStyle||{},t=this.getLocalSelection();if(t&&t.state===d.SelectType.select_text){var i=t.getFontPropCache();if(i){var n=Object.assign({},i);n.font_size_cs*=window.ti2pxRatio,Object.assign(e,n);var r=i.fontNameSymbol,a=i.textColor,o=i.hightLightColor;r&&(e.fontFamily=r.name),a&&a.color&&(e.color=this._pickColor(a.color)),o&&o.color&&(o.color.rgba=this._pickColor(o.color))}}return e}},{key:"_pickColor",value:function(e){var t=e.toRGB,i=e.srgb;return t&&9===t.length?"#"+t.slice(3):t||(i?"#"+i.toString(16):"")}},{key:"getNormalRange",value:function(){var e=this.getLocalSelection();if(e.state===d.SelectType.select_text){var t=e.getRange(),i=t.begin;return{pos:i,len:t.end-i}}if(e.state===d.SelectType.select_shape){var n=e.getRange(),r=n.begin,a=n.end,o=e.getActiveTextFrame();if(o){var s=o.getTextStream();s&&(a=s.getCharCount())}return{pos:r,len:a}}return{pos:-1,len:-1}}},{key:"getNormalRanges",value:function(){return this.getNormalRange()}},{key:"setEnable",value:function(e){this._enable=e}},{key:"isEnable",value:function(){return this._enable}},{key:"onCmdExec",value:function(e){console.log("editorModel onCmdExec:"+JSON.stringify(e))}},{key:"updateInsertPointChpx",value:function(){}},{key:"beginTransact",value:function(){this.getLocalSelection().transaction.beginTransact()}},{key:"cmdFmtChpx",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.getLocalSelection();r.cmdFmtChpx(e,t,i,n)}},{key:"commit",value:function(){this.getLocalSelection().transaction.commit()}},{key:"_setIndentation",value:function(e){this.getLocalSelection().tabPress(e)}},{key:"addListener",value:function(e,t,i){var n=this,r=arguments;t.keyCode,t.ctrlKey,t.metaKey,t.shiftKey,t.altKey;this.modelNames.forEach((function(e){var t;(t=n.uilHotkeys).on.apply(t,[e].concat(Array.prototype.slice.call(r)))}))}},{key:"removeListener",value:function(e,t,i){var n=this,r=arguments;t.keyCode,t.ctrlKey,t.metaKey,t.shiftKey,t.altKey;this.modelNames.forEach((function(e){var t;(t=n.uilHotkeys).off.apply(t,[e].concat(Array.prototype.slice.call(r)))}))}},{key:"addKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyDownListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keydown"].concat(Array.prototype.slice.call(arguments)))}},{key:"addKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.addListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}},{key:"removeKeyUpListener",value:function(e,t){e.keyCode,e.ctrlKey,e.metaKey,e.shiftKey,e.altKey;this.removeListener.apply(this,["keyup"].concat(Array.prototype.slice.call(arguments)))}},{key:"showToast",value:function(e,t){window.Toast[e]&&window.Toast[e](t)}},{key:"createModifierByName",value:function(e,t){return window.APP.utils.createModifier(e,t)}},{key:"getActiveShapes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[],i=this.selection.getActiveShapes();if(!i)return t;for(var n=0;n<i.length;n++){var r=i[n];if(e&&r.isGroupShape()){var a=r.getChildShapesRecurse();t=t.concat(a)}else t.push(r)}return t}},{key:"app",get:function(){return window.APP}},{key:"uilHotkeys",get:function(){return this.editor.uilHotkeys}},{key:"editor",get:function(){return this.props.editor}},{key:"workspace",get:function(){return this.editor.workspace}},{key:"selection",get:function(){return this.editor.getLocalSelection()}},{key:"modelNames",get:function(){return[]}},{key:"shellDoc",get:function(){return window.APP.shell.doc}},{key:"isMasterView",get:function(){return this.shellDoc&&this.shellDoc.getMode()===f.ViewModes.MasterView}}]),t}(c.a);t.default=g}}]);