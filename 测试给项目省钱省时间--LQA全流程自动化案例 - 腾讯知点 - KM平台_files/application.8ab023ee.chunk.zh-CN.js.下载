(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{1e3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=(0,n.__importDefault)(r(1001)),a=(0,n.__importDefault)(r(500)),o=function(e){function t(t){var r=e.call(this,t)||this;return r.pluginInstance=null,r}return(0,n.__extends)(t,e),t.prototype.setPluginInstance=function(t){this.pluginInstance=t,e.prototype.onMount.call(this)},t.prototype.getPluginInstance=function(e,t){var r=this;return this.current===a.default.onMount?Promise.resolve(this.pluginInstance):(this.current===a.default.onInactive&&this.active(e,t),new Promise((function(e,t){r.on("onMount",(function(){e(r.pluginInstance)}))})))},t.prototype.getActiveEvent=function(){var e=this.activeEvent;return this.activeEvent=null,e},t.prototype.desptroy=function(){this.pluginInstance&&"function"==typeof this.pluginInstance.destroy&&this.pluginInstance.destroy(),e.prototype.destroy.call(this)},t}(i.default);t.default=o},1001:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=(0,n.__importDefault)(r(1002)),a=(0,n.__importDefault)(r(1004)),o=r(434),s=(0,n.__importDefault)(r(1006)),l=r(292),u=function(e){function t(t){var r=e.call(this)||this;return r.config=null,r.config=t,r.appReadyTime=0,r.activeTime=0,r.readyTime=0,r.active=r.active.bind(r),r.init(),r}return(0,n.__extends)(t,e),t.prototype.init=function(){this.eventBind()},Object.defineProperty(t.prototype,"isActivable",{get:function(){return 0===this.current},enumerable:!1,configurable:!0}),t.prototype.active=function(e,t){this.isActivable&&(this.activeTime=performance.now(),this.reportActive(),this.activeEvent=e,this.onActive(),this.startLoad(t))},t.prototype.destroy=function(){this.cancelLoad(),this.eventUnBind(),e.prototype.destroy.call(this),e.prototype.onDestroy.call(this)},t.prototype.startLoad=function(e){var t=this;window.report(l.TYPE.COUNT,"plg_mgr_load_plg_start",1),(0,o.logger)(this.config.id,"plugin startLoad");var r=Object.assign({},e);return r.waitNetworkConnected&&(r.waitSuccessCallback=function(){t.loadPlugin(e)}),this.loadDependencies(r).then((function(){return(0,o.logger)(t.config.id,"plugin loadDependencies success"),t.onDepsReady(),t.loadPlugin(e)})).then((function(e){var r=e[0],n=e[1];(0,o.logger)(t.config.id,"plugin loadPlugin success"),t.readyTime=performance.now(),t.reportReady(r,n),t.onPluginReady()})).catch((function(e){(0,o.logger)(t.config.id,"plugin startLoad error",e),t.onInactive()}))},t.prototype.loadDependencies=function(e){var t=this,r=this.config.pluginManifest.dependencies;return a.default.loadDependencies(r,e).then((function(e){return Promise.resolve(e)})).catch((function(e){return function(e){window.report(l.TYPE.COUNT,"plg_mgr_load_dep_error",1),(0,o.logger)(t.config.id,"plugin loadDependencies error",e)}(e),Promise.reject(e)}))},t.prototype.loadPlugin=function(e){var t=this,r=this.config.src;return a.default.loadPlugin(r,e).then((function(e){return Promise.resolve(e)})).catch((function(e){return function(e){window.report(l.TYPE.COUNT,"plg_mgr_load_plg_error",1),(0,o.logger)(t.config.id,"plugin loadPlugin error",e)}(e),Promise.reject(e)}))},t.prototype.cancelLoad=function(){},t.prototype.eventBind=function(){var e=this,t=(0,s.default)(this.config.pluginManifest.activedEvents);Object.keys(t).forEach((function(r){var n="function"!=typeof t[r];window.addEventListener(r,e.active,{once:n})}))},t.prototype.eventUnBind=function(){var e=this,t=(0,s.default)(this.config.pluginManifest.activedEvents);Object.keys(t).forEach((function(t){window.removeEventListener(t,e.active)}))},t.prototype.setAppReadyTime=function(e){this.appReadyTime=e},t.prototype.reportActive=function(){var e=!0===window.isDebugger?1:1e3;if(1===Math.ceil(Math.random()*e)){var t=0!==this.appReadyTime?Math.round(this.activeTime-this.appReadyTime):0;window.collection("wopluginactive",{plugin_id:this.config.id||"",plugin_name:this.config.pluginName||"",version:this.config.version||"",times:t,prob:e})}},t.prototype.reportReady=function(e,t){var r=!0===window.isDebugger?1:1e3;1===Math.ceil(Math.random()*r)&&window.collection("wopluginloaded",{plugin_id:this.config.id||"",plugin_name:this.config.pluginName||"",version:this.config.version||"",from_cache:e,retry:t,times:Math.max(Math.round(this.readyTime-this.activeTime),0),prob:r})},t}(i.default);t.default=u},1002:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=(0,n.__importDefault)(r(1003)),a=(0,n.__importDefault)(r(500)),o=function(e){function t(){var t=e.call(this)||this;return t.status=a.default.onInactive,t}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"current",{get:function(){return this.status},set:function(e){(this.status<e||e===a.default.onDestroy)&&(this.status=e)},enumerable:!1,configurable:!0}),t.prototype.onInactive=function(){this.current=a.default.onInactive,this.emit("onInactive")},t.prototype.onActive=function(){this.current=a.default.onActive,this.emit("onActive")},t.prototype.onDepsReady=function(){this.current=a.default.onDepsReady,this.emit("onDepsReady")},t.prototype.onPluginReady=function(){this.current=a.default.onPluginReady,this.emit("onPluginReady")},t.prototype.onMount=function(){this.current=a.default.onMount,this.emit("onMount")},t.prototype.onDestroy=function(){this.current=a.default.onDestroy,this.emit("onDestroy")},t}(i.default);t.default=o},1003:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._listeners=new Map}return e.prototype.on=function(e,t){return e?(this._on(e,{handler:t}),!0):(console.trace("this evenName is empty",e),!1)},e.prototype.once=function(e,t){return e?(this._on(e,{handler:t,once:!0}),!0):(console.trace("this evenName is empty",e),!1)},e.prototype.off=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),e)if(t){var r=this._listeners.get(e);if(r){for(var n=0;n<r.length;n++)r[n].handler===t&&(r.splice(n,1),n--);0===r.length?this._listeners.delete(e):this._listeners.set(e,r)}}else this._listeners.delete(e);else this._listeners.clear()},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this._listeners.get(e);if(n){for(var i=n.slice(0),a=i.length-1;a>=0;--a){var o=i[a];o?(o.handler&&o.handler.apply(o,t),o.once&&n.splice(a,1)):console.warn("EventDispatcher event "+e+" handler is undefined!")}n.length!==i.length&&(0===n.length?this._listeners.delete(e):this._listeners.set(e,n))}},e.prototype.destroy=function(){this._listeners.clear()},e.prototype._on=function(e,t){if(this._listeners.has(e)){for(var r=this._listeners.get(e),n=!1,i=0;i<r.length;++i)if(r[i].handler===t.handler&&r[i].once===t.once){n=!0;break}n||(r.push(t),this._listeners.set(e,r))}else this._listeners.set(e,[t])},e}();t.default=n},1004:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=r(434),a=r(1005),o=(0,n.__importDefault)(r(146)),s=window.isDebugger?10:120,l={NOT_LOAD:void 0,PENDING:0,LOADED:1,FAILED:2},u="RETRY_MAXTIMES",c="NETWORK_DISCONNECTED",h={},d={};var p=function(){function e(){this.addNetworkListener()}return e.prototype.loadDependencies=function(e,t,r){return function e(t,r,n){var i=function(e){return e.map((function(e){return"".concat(e.name,"@").concat(e.version)})).join(",")}(t),o=h[i];if(o||(o=h[i]={key:t,status:l.NOT_LOAD,count:0}),o.status===l.NOT_LOAD){var s=null,d=null,p=new Promise((function(e,t){s=e,d=t}));o.pending=[s,d,p]}if(void 0!==(null==r?void 0:r.waitNetworkConnected)&&(o.waitNetworkConnected=r.waitNetworkConnected),(null==r?void 0:r.waitSuccessCallback)&&(o.waitSuccessCallback=o.waitSuccessCallback||[],o.waitSuccessCallback.push(r.waitSuccessCallback)),o.status===l.LOADED)return Promise.resolve([!0,o.count]);if(o.status===l.PENDING)return o.pending[2];var f=[];return t.forEach((function(e){f.push((0,a.importPackage)(e.name))})),o.status=l.PENDING,o.count+=1,Promise.all(f).then((function(){return o.status=l.LOADED,n&&(o.waitSuccessCallback.forEach((function(e){return e()})),o.waitSuccessCallback.length=0),o.pending[0]([!1,o.count]),o.pending[2]})).catch((function(r){if(!n&&o.count<3&&navigator.onLine)setTimeout((function(){e(t)}),3e3),o.status=l.FAILED;else{var i=null;o.count>=3?i=u:navigator.onLine||(i=c),o.status=l.NOT_LOAD,o.count=0,o.pending[1](i)}return o.pending[2]}))}(e,t,r)},e.prototype.loadPlugin=function(e,t,r){return function e(t,r,n){var i=d[t];if(i||(i=d[t]={key:t,status:l.NOT_LOAD,count:0}),i.status===l.NOT_LOAD){var a=null,o=null,h=new Promise((function(e,t){a=e,o=t}));i.pending=[a,o,h]}if(void 0!==(null==r?void 0:r.waitNetworkConnected)&&(i.waitNetworkConnected=r.waitNetworkConnected),(null==r?void 0:r.waitSuccessCallback)&&(i.waitSuccessCallback=i.waitSuccessCallback||[],i.waitSuccessCallback.push(r.waitSuccessCallback)),i.status===l.LOADED)return Promise.resolve([!0,i.count]);if(i.status===l.PENDING)return i.pending[2];var p=document.createElement("script");p["data-func-desc"]="plugin",p.charset="utf-8",p.type="text/javascript",p.crossOrigin="anonymous",p.src=t,i.status=l.PENDING,i.count+=1;var f=function(r,a){if(p.onerror=p.onload=null,p.parentNode&&p.parentNode.removeChild(p),clearTimeout(v),"load"!==a.type){if(!n&&i.count<3&&navigator.onLine)setTimeout((function(){e(t)}),3e3),i.status=l.FAILED;else{var o=null;i.count>=3?o=u:navigator.onLine||(o=c),i.status=l.NOT_LOAD,i.count=0,i.pending[1](o)}return i.pending[2]}i.status=l.LOADED,n&&(i.waitSuccessCallback.forEach((function(e){return e()})),i.waitSuccessCallback.length=0),i.pending[0]([!1,i.count])},v=setTimeout(f.bind(null,void 0,{type:"timeout",target:p}),1e3*s);return p.onerror=f.bind(null,p.onerror),p.onload=f.bind(null,p.onload),document.head.appendChild(p),i.pending[2]}(e,t,r)},e.prototype.addNetworkListener=function(){window.addEventListener(o.default.names.network.ON_CONNECTED,this.handleNetworkConnected.bind(this)),window.addEventListener(o.default.names.network.ON_DISCONNECTED,this.handleNetworkDisconnected.bind(this))},e.prototype.handleNetworkConnected=function(){for(var e in h){(r=h[e]).status!==l.NOT_LOAD&&r.status!==l.FAILED||!0!==r.waitNetworkConnected||this.loadDependencies(r.key,null,!0).catch((function(e){(0,i.logger)("ON_CONNECTED loadDependencies fail",e)}))}for(var t in d){var r;(r=d[t]).status!==l.NOT_LOAD&&r.status!==l.FAILED||!0!==r.waitNetworkConnected||this.loadPlugin(r.key,null,!0).catch((function(e){(0,i.logger)("ON_CONNECTED loadPlugin fail",e)}))}},e.prototype.handleNetworkDisconnected=function(){},e}();t.default=new p},1005:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importPackage=void 0;var n={};t.importPackage=function(e){return function(e){return n[e]}(e)?n[e]():Promise.reject("package not exist")}},1006:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,r(143).__importDefault)(r(146));t.default=function(e){var t={};return Object.keys(e).forEach((function(r){var i=function(e){var t,r=(e||"").split("."),i=n.default.names;return r.forEach((function(e){t=(t||i)[e]})),t}(r);t[i]=e[r]})),t}},1007:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerInstance=void 0,t.registerInstance=function(e){window.__PLUGINGLOBAL__||(window.__PLUGINGLOBAL__={instance:[],dependence:{}}),window.__PLUGINGLOBAL__.instance.push(e)}},1012:function(e,t,r){"use strict";function n(e,t){var r=e.x1,n=e.y1,i=e.x2,a=e.y2,o=e.x3,s=e.y3,l=1-t,u=r*l+i*t,c=i*l+o*t,h=n*l+a*t,d=a*l+s*t;return{x:(u=u*l+c*t)*l+(c=c*l+(o*l+e.x4*t)*t)*t,y:(h=h*l+d*t)*l+(d=d*l+(s*l+e.y4*t)*t)*t}}function i(e,t,r){var n=e.x1,i=e.y1,a=e.x2,o=e.y2,s=e.x3,l=e.y3,u=e.x4,c=e.y4,h=.5*(a+s);t.x2=.5*(n+a),r.x3=.5*(s+u),t.x1=n,r.x4=u,t.x3=.5*(t.x2+h),r.x2=.5*(r.x3+h),t.x4=r.x1=.5*(t.x3+r.x2),h=(o+l)/2,t.y2=.5*(i+o),r.y3=.5*(l+c),t.y1=i,r.y4=c,t.y3=.5*(t.y2+h),r.y2=.5*(r.y3+h),t.y4=r.y1=.5*(t.y3+r.y2)}function a(e,t,r){for(var n=new Array(10),a=0;a<n.length;a++)n[a]={x1:0,y1:0,x2:0,y2:0,x3:0,y3:0,x4:0,y4:0};var o=new Array(10);n[0]=e,o[0]=9;for(var s=0,l=0,u=window.Point;s>=0;){var c=n[s],h=c.y4-c.y1,d=c.x4-c.x1,p=Math.abs(d)+Math.abs(h),f=void 0;p>1?f=Math.abs(d*(c.y1-c.y2)-h*(c.x1-c.x2))+Math.abs(d*(c.y1-c.y3)-h*(c.x1-c.x3)):(f=Math.abs(c.x1-c.x2)+Math.abs(c.y1-c.y2)+Math.abs(c.x1-c.x3)+Math.abs(c.y1-c.y3),p=1),f<r*p||0===o[l]?(t.push(new u(c.x4,c.y4)),--s,--l):(i(c,n[s+1],c),o[l+1]=--o[l],++s,++l)}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=[];return r.push(e.pt1()),a(e,r,t),r}function s(e,t){if(!e||t<=2)return console.warn("convert2Beziers fail!! ",e,t),[];var r=[],n=window.Point;if(2===t)return r[0]=e[0],r[1]=n["/"](n["+"](n["*"](2,e[0]),e[1]),3),r[2]=n["/"](n["+"](n["*"](2,e[1]),e[0]),3),r[3]=e[1],r;var i=t,a=3*i-2;r[0]=e[0];var o=n["/"](n["-"](n["-"](e[1],e[0]),n["*"](n["-"](e[2],e[1]),.1)),5);r[1]=n["+"](r[0],o);for(var s=1,l=0;s<i-1;)r[l=3*s]=e[s],o=n["/"](n["-"](e[s+1],e[s-1]),5),r[l-1]=n["-"](e[s],o),r[l+1]=n["+"](e[s],o),s++;return r[a-1]=e[i-1],o=n["/"](n["-"](n["-"](e[i-2],e[i-1]),n["*"](n["-"](e[i-3],e[i-2]),.1)),5),r[a-2]=n["+"](r[a-1],o),r}r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"a",(function(){return s}))},1013:function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"f",(function(){return x})),r.d(t,"e",(function(){return D})),r.d(t,"a",(function(){return L})),r.d(t,"d",(function(){return te})),r.d(t,"b",(function(){return ie})),r.d(t,"g",(function(){return ae}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(268),l=r(360),u={SRgb:0,ScRgb:1,Hsl:2,Scheme:3,Preset:4,System:5,Palette:6,LegacyRef:7},c=0,h=4,d=5,p=6,f=7,v=8,y=9,g=11,m=12,_=13,S=14,T=15,b=16;function k(e,t,r){return e>t&&e>r?e:t>r?t:r}function C(e,t,r){return e<t&&e<r?e:t<r?t:r}function w(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function P(e,t){var r=e>=.5?{r:1-e,g:e-1,b:e-1}:{r:e,g:-e,b:-e};return{r:Object(l.i)(0,e+r.r*t,1),g:Object(l.i)(0,e+r.g*t,1),b:Object(l.i)(0,e+5*r.b*t,1)}}var x={Alpha:0,AlphaModulation:1,AlphaOffset:2,Blue:3,BlueModification:4,BlueOffset:5,Complement:6,Gamma:7,Gray:8,Green:9,GreenModification:10,GreenOffset:11,Hue:12,HueModulate:13,HueOffset:14,Inverse:15,InverseGamma:16,Luminance:17,LuminanceModulation:18,LuminanceOffset:19,Red:20,RedModulation:21,RedOffset:22,Saturation:23,SaturationModulation:24,SaturationOffset:25,Shade:26,Tint:27};function O(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function E(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}function I(e){return{a:e>>24&255,r:e>>16&255,g:e>>8&255,b:255&e}}function A(e){var t=window.APP.presentation,r=t&&t.getBuddy(),n=r&&r.private.globalPalette;return n&&e<n.length?n[e]:e>=M?e:F}function R(e){var t=window.APP.presentation,r=t&&t.getBuddy(),n=r&&r.private.presetColors;return n&&e<n.length?n[e]:F}var D=function(){function e(t,r,n,a){i()(this,e),this.setRgba({r:t,g:r,b:n,a:a}),this.hasAlpha=!0}return o()(e,[{key:"toScRgb",value:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}}},{key:"toRGB",value:function(){return{r:Math.round(255*this.r),g:Math.round(255*this.g),b:Math.round(255*this.b),a:Math.round(255*this.a)}}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||{},r=t.prefix,n=t.hasAlpha;if(n=null==n?!!this.hasAlpha:!!n,"rgba"===r){var i=this.toRGB(),a=i.r,o=i.g,s=i.b,l=i.a;return"rgba("+a+","+o+","+s+","+l/255+")"}r="0x"===r?"0x":"#";var u=this.toInt(),c="00000000",h=u.toString(16);return h.length<8&&(h=c.slice(0,8-h.length)+h),n||(h=h.slice(2)),r+h}},{key:"toInt",value:function(){var e=this.toRGB(),t=e.r,r=e.g,n=e.b,i=e.a;i=null==i?255:i;return(this.hasAlpha?(i<<24)+(t<<16)+(r<<8)+n:(t<<16)+(r<<8)+n)>>>0}},{key:"toHsl",value:function(){var e,t=this.r,r=this.g,n=this.b,i=void 0,a=void 0,o=k(t,r,n),s=C(t,r,n),u=o-s,c=o+s;return i=0,e=.5*c,Object(l.l)(u)?a=0:(a=e<.5?u/c:u/(2-c),Object(l.k)(t,o)?i=(r-n)/u+(r<n?6:0):Object(l.k)(r,o)?i=2+(n-t)/u:Object(l.k)(n,o)&&(i=4+(t-r)/u),i*=1/6),{h:i,l:e,s:a}}},{key:"setHasAlpha",value:function(e){this.hasAlpha=!!e}},{key:"assign",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this.hasAlpha=e.hasAlpha}},{key:"setRgba",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=null==e.a?1:e.a}},{key:"setRgb",value:function(e){this.r=e.r,this.g=e.g,this.b=e.b}},{key:"setHsl",value:function(e){var t=e.h,r=e.s,n=e.l,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0;Object(l.k)(t,1)?i=a=o=n:r<0?(i=2*n-w(u=2*n-(s=n<.5?n*(1-r):n-r+n*r),s,t+1/3),a=2*n-w(u,s,t),o=2*n-w(u,s,t-1/3),i=Object(l.i)(0,i,1),a=Object(l.i)(0,a,1),o=Object(l.i)(0,o,1)):Object(l.l)(n)?i=a=o=0:(i=w(u=2*n-(s=n<.5?n*(1+r):n+r-n*r),s,t+1/3),a=w(u,s,t),o=w(u,s,t-1/3),i=Object(l.i)(0,i,1),a=Object(l.i)(0,a,1),o=Object(l.i)(0,o,1)),this.r=i,this.g=a,this.b=o}},{key:"revertGamma",value:function(){this.r=O(this.r),this.g=O(this.g),this.b=O(this.b)}},{key:"gammaCorrected",value:function(){this.r=E(this.r),this.g=E(this.g),this.b=E(this.b)}},{key:"max",value:function(){return k(this.r,this.g,this.b)}},{key:"min",value:function(){return C(this.r,this.g,this.b)}}],[{key:"fromRGB",value:function(t){var r=t.r,n=t.g,i=t.b,a=t.a;return new e(r/255,n/255,i/255,null==a?1:a/255)}},{key:"fromScRgb",value:function(t){var r=t.r,n=t.g,i=t.b,a=t.a;return Object.isEmpty(a)&&(a=1),new e(r,n,i,a)}},{key:"fromHsl",value:function(t){var r=new e(0,0,0,1);return r.setHsl(t),r}},{key:"fromSrgb",value:function(t){return e.fromRGB(I(4278190080|t))}},{key:"fromInt",value:function(t){return e.fromRGB(I(t))}},{key:"fromString",value:function(t){try{return e.fromStringColor(t)}catch(e){}return e.fromInt(16777215)}},{key:"fromStringColor",value:function(t){var r=16777215;if("string"==typeof t){if(t.startsWith("#"))t=t.slice(1);else if(t.startsWith("0x"))t=t.slice(2);else if(t.startsWith("rgba(")&&t.endsWith(")")){var n=t.slice(5,t.length-1).split(",");if(4===n.length)return e.fromRGB({r:parseInt(n[0]),g:parseInt(n[1]),b:parseInt(n[2]),a:Math.round(parseInt(255*n[3]))});t=null}else t=null;t&&(r=parseInt(t,16))}return e.fromInt(r)}},{key:"fromPalette",value:function(t){var r=e.fromInt(A(32767===t?N:t));return r.isAutoColor=64===t||65===t||t>=77&&t<=80||32767===t,r}}]),e}(),L=function(){function e(t){i()(this,e),this._data=t}return o()(e,[{key:"setData",value:function(e){this._data=e}},{key:"clone",value:function(){return new e(Object(s.a)(this._data))}},{key:"getRgba",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._data||{},r=null;switch(t.type){case u.SRgb:(r=D.fromSrgb(t.sRgb)).revertGamma();break;case u.System:(r=D.fromInt(A(t.system))).revertGamma();break;case u.Preset:(r=D.fromInt(R(t.preset))).revertGamma();break;case u.ScRgb:r=D.fromScRgb(t);break;case u.Hsl:r=D.fromHsl(t.h/6e3/360,t.s,t.l);break;case u.Scheme:case u.Palette:case u.LegacyRef:if(e){var n=e.interpret(this);n?(r=n.getRgba(e),r=n.applyTransforms(r)):console.error("Invalid color, type=",t.type)}}return r||new D({r:0,g:0,b:0,a:1})}},{key:"toScRgb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getRgba(e);return(t=this.applyTransforms(t)).gammaCorrected(),t}},{key:"toRGB",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getRgba(e);return(t=this.applyTransforms(t)).gammaCorrected(),t.toString()}},{key:"applyTransforms",value:function(e){var t=(this._data||{}).transOp;if(t&&t.length>0)for(var r=0;r<t.length;r++)this.applyTransform(t[r],e);return e}},{key:"applyTransform",value:function(e,t){if(e&&t){var r=e.op,n=e.val;switch(r){case x.Alpha:t.a=n;break;case x.AlphaModulation:t.a=Object(l.o)(t.a*n,1);break;case x.AlphaOffset:t.a=Object(l.i)(0,t.a+n,1);break;case x.Blue:t.b=n;break;case x.BlueModification:t.b=Object(l.o)(t.b*n,1);break;case x.BlueOffset:t.b=Object(l.i)(0,t.b+n,1);break;case x.Complement:t.gammaCorrected();var i=t.max(),a=t.min();t.r=i+a-t.r,t.g=i+a-t.g,t.b=i+a-t.b,t.revertGamma();break;case x.Gamma:t.gammaCorrected();break;case x.Gray:t.gammaCorrected(),t.r=.2157*t.r+.7137*t.g+.0706*t.b;var o=O(t.r);t.setRgb({r:o,g:o,b:o});break;case x.Green:t.g=n;break;case x.GreenModification:t.g=Object(l.o)(t.g*n,1);break;case x.GreenOffset:t.g=Object(l.i)(0,t.g+n,1);break;case x.Hue:t.gammaCorrected();var s=t.toHsl(),u=s.s,c=s.l;t.setHsl({h:Object(l.i)(0,n/6e4/360,1),s:u,l:c}),t.revertGamma();break;case x.HueModulate:t.gammaCorrected();var h=t.toHsl(),d=h.h,p=h.s,f=h.l;d=Math.min(d*n,1),t.setHsl({h:d,s:p,l:f}),t.revertGamma();break;case x.HueOffset:t.gammaCorrected();var v=t.toHsl(),y=v.h,g=v.s,m=v.l;(y+=n/6e4/360)<0&&(y+=Object(l.j)(-y)),y-=Math.floor(y),t.setHsl({h:y,s:g,l:m}),t.revertGamma();break;case x.Inverse:t.setRgb({r:1-t.r,g:1-t.g,b:1-t.b});break;case x.InverseGamma:t.revertGamma();break;case x.Luminance:t.gammaCorrected();var _=t.toHsl(),S=_.h,T=_.s;t.setHsl({h:S,s:T,arg:n}),t.revertGamma();break;case x.LuminanceModulation:t.gammaCorrected();var b=t.toHsl(),k=b.h,C=b.s,w=b.l;w*=n,w=Object(l.o)(w,1),t.setHsl({h:k,s:C,l:w}),t.revertGamma();break;case x.LuminanceOffset:t.gammaCorrected();var E=t.toHsl(),I=E.h,A=E.s,R=E.l;t.setHsl({h:I,s:A,l:R+n}),t.revertGamma();break;case x.Red:t.r=n;break;case x.RedModulation:t.r=Math.min(t.r*n,1);break;case x.RedOffset:t.r=Object(l.i)(0,t.r+n,1);break;case x.Saturation:t.gammaCorrected();var D=t.toScRgb(),L=D.r,N=D.g,M=D.b;if(Object(l.l)(L-N)&&Object(l.l)(N-M))t.setRgb(P(L,n));else{var F=t.toHsl(),B=F.h,j=F.l;t.setHsl({h:B,arg:n,l:j})}t.revertGamma();break;case x.SaturationModulation:t.gammaCorrected();var V=t.toHsl(),H=V.h,G=V.s,U=V.l;G*=n,t.setHsl({h:H,s:G,l:U}),t.revertGamma();break;case x.SaturationOffset:t.gammaCorrected();var W=t.toScRgb(),z=W.r,Y=W.g,q=W.b;if(Object(l.l)(z-Y)&&Object(l.l)(Y-q))t.setRgb(P(z,n));else{var K=t.toHsl(),Q=K.h,X=K.s,J=K.l;X+=n,t.setHsl({h:Q,s:X,l:J})}t.revertGamma();break;case x.Shade:t.r*=n,t.g*=n,t.b*=n;break;case x.Tint:t.r=t.r*n+1-n,t.g=t.g*n+1-n,t.b=t.b*n+1-n}return t}}},{key:"setTransforms",value:function(e){this._data.transOp=e}},{key:"addTransform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._data.transOp.push({op:e,val:t})}},{key:"getTransform",value:function(e){for(var t=this._data.transOp||[],r=0;r<t.length;r++)if(t[r].op===e)return t[r].val;return null}},{key:"setTransformValue",value:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=this._data.transOp||[],a=0;a<i.length;a++)i[a].op===e&&(i[a].val=t,n=!0);r&&!n&&(i.push({op:e,val:t}),this._data.transOp=i)}},{key:"removeTransform",value:function(e){for(var t=this._data.transOp||[],r=0;r<t.length;)t[r].op===e?t.splice(r,1):r++}},{key:"removeNoMattersTransform",value:function(){for(var e=this._data.transOp||[],t=0;t<e.length;++t)e[t].op!=x.Alpha&&e[t].op!=x.AlphaModulation&&e[t].op!=x.AlphaOffset&&(e.splice(t,1),t--)}},{key:"setOpacity",value:function(e){this.setTransformValue(x.Alpha,e,!0)}},{key:"type",get:function(){return this._data&&this._data.type}},{key:"data",get:function(){return this._data}}],[{key:"fromString",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=D.fromString(t),i={type:u.SRgb,isAutoColor:!1,toRGB:n.toString(),sRgb:n.toInt()};return null!=r&&(i.transOp=r),new e(i)}},{key:"fromScRgb",value:function(t){return new e({type:u.SRgb,isAutoColor:!1,toRGB:t.toString(),sRgb:t.toInt()})}},{key:"fromPreset",value:function(t){var r=R(t),n=D.fromInt(r);return new e({type:u.Preset,isAutoColor:!1,preset:t,toRGB:n.toString()})}},{key:"fromPalette",value:function(t){var r=D.fromPalette(t);return new e({type:u.Palette,isAutoColor:r.isAutoColor,preset:t,toRGB:r.toString()})}},{key:"fromSystem",value:function(t){var r=D.fromPalette(t);return new e({type:u.System,isAutoColor:r.isAutoColor,preset:t,toRGB:r.toString()})}},{key:"defaultColor",get:function(){return new e({type:u.ScRgb,isAutoColor:!1,r:1,g:1,b:1,toRGB:"#ffffff"})}},{key:"blackColor",get:function(){return new e({type:u.ScRgb,isAutoColor:!1,r:0,g:0,b:0,toRGB:"#000000"})}},{key:"defaultFillColor",get:function(){return e.fromPreset(e.PresetBlack)}}]),e}();L.PresetBlack=7;var N=8,M=16777215,F=4278190080,B=240,j=241,V=242,H=243,G=244,U=245,W=246,z=247,Y=255,q=3840,K=256,Q=512,X=768,J=1024,Z=16711680,$=16;function ee(e,t){var r=function(e){return(((e=Math.floor(e))&Z)>>$)/255}(t);switch(t&q){case K:e.addTransform(x.Shade,r);break;case Q:e.addTransform(x.Tint,r);break;case X:e.addTransform(x.RedOffset,r),e.addTransform(x.GreenOffset,r),e.addTransform(x.BlueOffset,r);break;case J:e.addTransform(x.RedOffset,-1*r),e.addTransform(x.GreenOffset,-1*r),e.addTransform(x.BlueOffset,-1*r)}}var te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i()(this,e),this.colorScheme=t,this.colorMap=r,this.phColor=null==n?L.defaultColor:n,this.colorUsedFor=""}return o()(e,[{key:"setColorScheme",value:function(e){this.colorScheme=e}},{key:"setColorMapping",value:function(e){this.colorMap=e}},{key:"setPalette",value:function(e){this.palette=e}},{key:"setPhColor",value:function(e){this.phColor=e?e.clone():L.defaultColor}},{key:"setShape",value:function(e){this.shape=e}},{key:"setTheme",value:function(e){this.theme=e}},{key:"setStyle",value:function(e){this.style=e}},{key:"setColorUsedFor",value:function(e){this.colorUsedFor=e;var t=this.style;if(t){var r=null;"fill"==e?r=t.fillColor:"line"==e?r=t.lineColor:"font"==e?r=t.fontColor:"effects"==e&&(r=t.effectsColor),r?this.setPhColor(new L(r)):this.setPhColor(null)}}},{key:"interpret",value:function(e){var t=e instanceof L,r=e&&(t?e.data:e),n=null;switch(r&&r.type){case u.Scheme:var i=r.scheme===b;n=this.interpretScheme(r.scheme),i&&n&&n.type===u.Scheme&&n.data&&n.data.scheme===b&&(n=null);break;case u.Palette:n=this.interpretPalette(r.palette);break;case u.LegacyRef:n=this.interpretLegacyRef(t?e:new L(e))}if(n){if(r.transOp)for(var a=0;a<r.transOp.length;++a){var o=r.transOp[a];n.setTransformValue(o.op,o.val,!0)}return n.type!=u.Scheme&&n.type!=u.Palette&&n.type!=u.LegacyRef||(n=this.interpret(n)),t?n:n.data}return e}},{key:"interpretScheme",value:function(e){if(e===b)return this.phColor.clone();this.colorMap&&(e=this.colorMap.mapColor(e));var t=L.defaultColor;return"font"===this.colorUsedFor&&(t=L.blackColor),this.colorScheme&&c<=e&&e<=g?new L(Object(s.a)(this.colorScheme.getColor(e,t.data))):t}},{key:"interpretPalette",value:function(e){if(32767===e){var t=D.fromInt(A(N));return L.fromScRgb(t)}if(this.palette&&e<this.palette.length)return L.fromScRgb(D.fromInt(this.palette[e]));var r=window.APP.presentation,n=r&&r.private.globalPalette;return n&&e<n.length?L.fromScRgb(A(e)):L.defaultColor}},{key:"interpretLegacyRef",value:function(e){var t=e.legacyRef,r=65535&t;if(r<240){var n=A(r+18);return L.fromScRgb(D.fromSrgb(16777215&n))}if(!this.shape)return L.defaultColor;var i=new L(function(e,t){var r=t&Y;switch(r){case B:var n=e.getFill();if(n)return n.color?n.color:L.defaultFillColor;break;case j:var i=e.getFill();if(i)return i.color?i.color:L.defaultFillColor;var a=e.getOutline();if(a){var o=a.fill||{type:0};return o.color?o.color:L.defaultFillColor}break;case V:var s=e.getOutline();if(s){var l=s.fill||{type:0};return l.color?l.color:L.defaultFillColor}break;case H:var u=e.getEffects();if(u)return u.legacyShadow.primaryColor;break;case G:case U:case W:case z:case Y:break;default:var c=A(r+18),h=D.fromSrgb(16777215&c);return L.fromScRgb(h).data}return L.defaultColor}(this.shape,t));i.addTransform(x.Gamma),ee(i,t),i.addTransform(x.InverseGamma);var a=e.getTransform(x.Alpha);return null!=a?i.setTransformValue(x.Alpha,a)&&i.addTransform(x.Alpha,a):i.removeTransform(x.Alpha),i}}]),e}();function re(e,t){for(var r=[],n=0;n<t.length;n++){var i=Object(s.a)(e);i.transOp=i.transOp||[],i.transOp.push(Object(s.a)(t[n]));var a=new L(i);i.toRGB=a.toRGB(),r.push(i)}return r}function ne(e,t,r){for(var n=[],i=0;i<r.length;i++)n.push({op:t,val:r[i]});return re(e,n)}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;for(var r=[m,_,S,T,h,d,p,f,v,y],n=e.colorMap,i=[],a=0;a<r.length;a++){var o=r[a],s=n?n.mapColor(o):o,l=e.interpret({type:u.Scheme,scheme:s});if(t){var c=[];switch(c.push(l),o){case m:c=c.concat(ne(l,x.Shade,[.05,.15,.25,.35,.5]));break;case _:c=c.concat(ne(l,x.Tint,[.5,.35,.25,.15,.05]));break;case S:c=c.concat(ne(l,x.Shade,[.1,.25,.5,.75,.9]));break;default:c=c.concat(re(l,[{op:x.Tint,val:.8},{op:x.Tint,val:.6},{op:x.Tint,val:.4},{op:x.Shade,val:.25},{op:x.Shade,val:.5}]))}i.push(c)}else i.push(l)}return i}function ae(e,t){if(null==e)return null;var r=Object(s.a)(e.primary?e.primary:e),n=new L(r);t&&(n=t.interpret(n));var i=n.toScRgb(t),a=i.toString(),o=i.toString({hasAlpha:!1}),l=i.toRGB(),c=l.r,h=l.g,d=l.b,p=l.a,f="rgba("+c+","+h+","+d+","+(p/=255)+")",v=i.toInt();return{type:u.SRgb,sRgb:v,toRGB:a,scheme:e.scheme,rgba:f,hex:o,alpha:p,primary:r}}},1014:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(2669),d=r(158),p=r(262),f=r(927),v=r(1866),y=r(2248),g=r.n(y),m=r(3156),_=function(e){function t(e,r){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r||"Shape"))}return c()(t,e),o()(t,[{key:"_fireChanged",value:function(){this._bubbleUpEvent(p.default.modify_shape,{data:this})}},{key:"ensureBackendHelper",value:function(){return this._backendHelper||this.setBackendShapeHelper(new m.BackendShapeHelper(this)),this._backendHelper}},{key:"isGroupShape",value:function(){return!1}},{key:"isHeaderFooterShape",value:function(){if(!this.isPlaceHolder())return!1;var e=this.getPlaceHolder(),t=e.type?e.type:d.PlaceholderType.Object;return t==d.PlaceholderType.DateTime||t==d.PlaceholderType.SlideNumber||t==d.PlaceholderType.Footer||t==d.PlaceholderType.Header}},{key:"getTextFrame",value:function(){var e=this.getChilds();if(!e)return null;for(var t=0;t<e.length;++t){var r=e[t];if(r instanceof f.a)return r}return null}},{key:"ensureTextFrame",value:function(){var e=this.getTextFrame();if(!e){var t=this.getSlide();if(!t)return void console.error("shape has not parent slide !!");var r=t.getPresentation(),n=f.a.createNewTextFrame(r);n.private.textStream.private.papTbl=f.a._createPropTbl({alignMode:2}),this.setChilds([n]),n.buildTree(this)}return e}},{key:"getTableFrame",value:function(){var e=this.getChilds(),t=e&&e[0];return t instanceof v.a?t:null}},{key:"getChartLayer",value:function(){var e=this.getChilds(),t=e&&e[0];return t instanceof g.a?t:null}},{key:"updateChartMetaData",value:function(e){var t=e.chartSha1;this.getChartLayer().updateChartSha1(t)}},{key:"isTextShape",value:function(){var e=this.getSlide();if(this.isPlaceHolder()&&e&&(e.isMasterSlide||e.isLayoutSlide))return!0;var t=this.getShapeType();return!this.private.picture&&t!=d.ShapeType.Table&&t!=t.Chart&&t!=t.Media}},{key:"matchText",value:function(e){if(!e)return null;var t=this.getTextFrame()||this.getTableFrame();return t&&t.matchText?t.matchText(e):null}},{key:"isImage",get:function(){var e=this.private.childs[0];return!!(this.private.picture||e&&e.private.picture)}}]),t}(h.a);t.a=_},1015:function(e,t,r){"use strict";var n=r(43),i=r.n(n),a=r(0),o=r.n(a),s=r(3),l=r.n(s),u=r(25),c=r.n(u),h=r(42),d=r.n(h),p=r(926),f=r(927),v=r(158),y=r(167),g=function(e){function t(e){return o()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,v.WppLayerType.WppLayerNotesPage,e))}return d()(t,e),l()(t,[{key:"getNotesTextFrame",value:function(){for(var e=this.getSpTree().childShapes,t=0;t<e.length;t++){var r=e[t];if(r.isPlaceHolder()&&r.getPlaceHolder().type===y.PlaceholderType.Body){var n=r&&r.getTextFrame();if(n)return n}}}},{key:"getNotesText",value:function(){for(var e=[this.getSpTree()],t=[];e.length>0;){var r=e.pop();if(r.isGroupShape())for(var n=r.getChildCount(),a=0;a<n;++a){var o=r.getChildAt(a);e.push(o)}else if(r.isPlaceHolder()&&r.getPlaceHolder().type===y.PlaceholderType.Body){var s=r.getTextFrame();if(s instanceof f.a&&s.getTextStream()){var l=s.getTextStream().getAllText();t.push.apply(t,i()(l))}}}return t.join("")}},{key:"isNotesPage",get:function(){return!0}}]),t}(p.a);t.a=g},1016:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IShell=void 0;var n=function(){function e(e){this.private={},this.coreData=e,this.coreData.apiShell=this}return e.prototype.buildTree=function(e){},e}();t.IShell=n},1131:function(e,t,r){"use strict";var n=r(263),i=r(304);function a(){this.initialize()}a.prototype=new n.AbsVectorObject,a.prototype.initialize=function(){this.objType=i.default.OType_Custom,window.g_rpt.registerNewObject(this)},a.prototype.applySvrData=function(e){this.private=e.data,this.objID=e.id,this.vector=e.data.childs},a.prototype.getChilds=function(){return this.private.childs},a.prototype.getObjID=function(){return this.objID},a.prototype.appChild=function(e){this.push(e)},a.prototype.insertChild=function(e,t){this.insert(e,t)},a.prototype.removeChild=function(e){this.remove(e)},a.prototype.moveChild=function(e,t){this.move(e,t)},a.prototype.setChild=function(e,t){this.set(e,t)},a.prototype.forward=function(e){switch(e.opType){case i.default.otInsert:this.private.childs.splice(e.pos,0,e.data);break;case i.default.otRemove:this.private.childs.splice(e.pos,1);break;case i.default.otMove:this.private.childs.splice(e.pos,1),this.private.childs.splice(e.pos+e.offset,0,e.data);break;case i.default.otModify:this.private.childs[e.pos]=e.data;break;case i.default.otReplaceData:var t=this.private;this.private=e.data,e.data=t}},a.prototype.backward=function(e){var t=new Object;switch(t.object=e.object,t.pos=e.pos,e.opType){case i.default.otInsert:t.opType=i.default.otRemove,t.data=e.data;break;case i.default.otRemove:t.opType=i.default.otInsert,t.data=e.data;break;case i.default.otMove:t.opType=i.default.otMove,t.pos=e.pos+e.offset,t.offset=-e.offset,t.data=e.data;break;case i.default.otModify:t.opType=i.default.otModify,t.oldData=e.data,t.data=e.oldData;break;case i.default.otReplaceData:t=e}this.forward(t)},t.a=a},1132:function(e,t,r){"use strict";var n=r(44),i=r.n(n),a=r(304);function o(){this.operates=new Array,this.customOp=new Map,this.newObjects=new Array,this.modifyObjects=new Array,this.command={},this.mainOperstes={},this.dataVersion=-1,this.isLocal=!0,this.isSelf=!0,this.isVerOfCurExec=!0,this.extRanges=null,this.closed=!1,this.taskVer=-1,this.bornTaskVer=-1,this.topOps=null}o.prototype.backward=function(){for(var e=this.operates.length-1;e>=0;e--){var t=this.operates[e];t.obj.backward(t),t.obj._fireChanged(t)}},o.prototype.forward=function(){for(var e=this.operates.length,t=0;t<e;t++){var r=this.operates[t];g_rpt.delayLoadObj.has(r.obj)||(r.obj.forward(r),r.obj._fireChanged(r))}},o.prototype.swapExtObjRanges=function(e){var t=window.g_rpt;if(null!=this.extRanges&&null!=t.getTransDepositedContainer()){var r=this;t.getTransDepositedContainer().transDepositedGetArray().forEach((function(t){if(null==t.transDepositedInstall||null==t.transDepositedClone)console.error("ext object not transDepositedInstall or  transDepositedClone function");else{var n=r.extRanges.get(t);null!=n&&t.transDepositedInstall(e?n.beginRgs:n.endRgs,r,e)}}))}},o.prototype.rollback=function(){this.complete(),this.backward(!0)},o.prototype.complete=function(){var e=this;this.newObjects.forEach((function(e){e.__isNew=!1,e.__modify=!1})),this.newObjects=null,this.modifyObjects.forEach((function(e){e.__isNew=!1,e.__modify=!1})),this.modifyObjects=null;var t=this.customOp;delete this.customOp,t.forEach((function(t,r){e.operates.push({obj:r,opType:a.default.otModify,data:t})}))},o.prototype.backwardTopObj=function(){if(null!=this.topOps)for(var e=this.topOps.length,t=0;t<e;t++){var r=this.topOps[t];r.obj.backward(r)}},o.prototype.beginExtObjects=function(e){if(null!=e){this.extRanges=new Map;var t=this;e.forEach((function(e){var r=e.transDepositedClone();null!=r&&t.extRanges.set(e,{beginRgs:r,endRgs:null})}))}},o.prototype.commitExtObjects=function(e){if(null!=e&&void 0!==this.extRanges){var t=this;e.forEach((function(e){var r=e.transDepositedClone();if(null!=r){var n=t.extRanges.get(e);null!=n&&(n.endRgs=r)}}))}},o.prototype.mergeExtObjects=function(e,t){if(null!=e&&void 0!==t.extRanges&&void 0!==this.extRanges){var r=this;e.forEach((function(e){var n=t.extRanges.get(e),i=r.extRanges.get(e);null!=n&&null!=i&&(i.endRgs=n.endRgs)}))}},o.prototype.isLocalTransact=function(){return this.isLocal},o.prototype.getDataVersion=function(){return this.dataVersion},o.prototype.setDataVersion=function(e){this.dataVersion=e},o.prototype.setSrcCommand=function(e){this.command.srcCommand=e},o.prototype.getSrcCommand=function(e){return this.command.srcCommand},o.prototype.addCommand=function(e){this.command.cmds.push(e)},o.prototype.addCommand=function(e){return this.command.cmds},o.prototype.addMainObjectOperates=function(e,t){return!(!e.isMainObject()||0==t.length)&&(this.mainOperstes[e.getObjID()]=t,!0)},o.prototype.getMainObjectOperates=function(e){return this.mainOperstes[e]},o.prototype.registerNewObject=function(e){e.__isNew=!0,this.newObjects.push(e)},o.prototype.addDataNotify=function(e){if(!e.__isNew&&!e.__modify){e.__modify=!0,this.modifyObjects.push(e);var t={};s(e.private,t),this.addRelaceDataOp(e,t)}},o.prototype.addRelaceDataOp=function(e,t){if(!e.__isNew){var r={obj:e,opType:a.default.otReplaceData,data:t};this.operates.push(r),e._fireChanged(r)}},o.prototype.addVectorOp=function(e,t,r,n,i,a){if(!e.__isNew){var o={obj:e,opType:t,pos:r,data:n};null!=i&&(o.oldData=i),null!=a&&(o.offset=a),this.operates.push(o),e._fireChanged(o)}},o.prototype.addCustomOp=function(e,t){e.__isNew||(this.customOp.has(e)||this.customOp.set(e,[]),this.customOp.get(e).push(t),e._fireChanged({obj:e,data:t}))},o.prototype.addServerOperate=function(e){this.operates.push(e)};var s=function e(t,r){r=r||{};for(var n in t)if(null===t[n])r[n]=t[n];else if("object"===i()(t[n])){var a=t[n].constructor;r[n]=a===Array?[]:{},a===Object&&a===Array?e(t[n],r[n]):r[n]=t[n]}else r[n]=t[n];return r};t.a=o},1146:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"c",(function(){return p})),r.d(t,"b",(function(){return f}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(268),l=r(315),u=r(167),c=r(470),h=r(304),d=r(262);function p(e,t){switch(t){case u.UnitsLength.m:return 100*e*(72/2.54);case u.UnitsLength.cm:return e*(72/2.54);case u.UnitsLength.mm:return.1*e*(72/2.54);case u.UnitsLength.in:return 72*e;case u.UnitsLength.pt:return e;case u.UnitsLength.ti:return e/20;case u.UnitsLength.pc:return e/22;case u.UnitsLength.em:return 12*e;case u.UnitsLength.ex:return 6*e;default:return e}}var f=function(){function e(t){i()(this,e),this.inkData=t}return o()(e,[{key:"createInkShape",value:function(e,t){var r=this.defaultBrush(),n=t.brushColor,i=t.lineWidth,a=t.trace;if(null!=n&&(r.color={toRGB:n,type:0,isAutoColor:!1,sRgb:parseInt(n.slice(-6),16)}),null!=i&&(i=i/12700/72,r.width=i,r.height=2*i),this.inkData={brushMap:{br0:r},context:{timeStamp:"",traceFormat:{channelX:{resolution:{uint:u.UnitsLength.ti,value:.05}},channelY:{resolution:{uint:u.UnitsLength.ti,value:.05}}}},vecTrace:[]},a&&a.length>0){for(var o=0;o<a.length;o++){var s=a[o];s.px=Math.round(s.px/635),s.py=Math.round(s.py/635)}this.appendTrace(a,"br0")}else this.inkData.vecTrace.push({brushRef:"br0",strPoints:"",vecPoints:[]});this.applyToShape(e)}},{key:"applyToShape",value:function(e){e&&e.setInkData(this.inkData)}},{key:"pointsToString",value:function(e){for(var t="",r=0;r<e.length;r++){var n=e[r],i=n.px,a=n.py;if(0===r)t=i+" "+a;else{var o=e[r-1];t+=","+(i-o.px)+" "+(a-o.py)}}return t}},{key:"stringToPoints",value:function(e){for(var t=[],r=e.split(","),n=0,i=0,a=0;a<r.length;++a)n+=parseInt(r[a].split(" ")[0]),i+=parseInt(r[a].split(" ")[1]),t.push({px:n,py:i});return t}},{key:"setBrush",value:function(e,t){if(this.inkData){var r=this.inkData.brushMap||{};r[e]=Object(s.a)(t),this.inkData.brushMap=r}}},{key:"defaultBrush",value:function(){var e=u.InkBrushType.brushDefaultWidth4Ellipse/12700/72;return{tip:u.InkBrushTip.ellipse,rasterOp:u.InkBrushRasterOp.CopyPen,widthUnit:u.UnitsLength.in,heightUnit:u.UnitsLength.in,fitToCurve:!1,antiAliased:!0,ignorePressure:!1,width:e,height:2*e,color:{toRGB:"#FF0000",type:0,isAutoColor:!1,sRgb:parseInt("#FF0000".slice(-6),16)}}}},{key:"setTraceBrush",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.inkData){null!=r&&this.setBrush(t,r);var n=this.inkData.vecTrace||[];e>=0&&e<n.length&&(n[e].brushRef=t),this.inkData.vecTrace=n}}},{key:"_genTimestamp",value:function(e){var t=e.length;if(0==t)return 100*Date.now();var r=e[t-1].timestamp;if(null==r)return 100*Date.now();var n=Math.floor(r/100),i=Date.now();return n===i?100*i+r%100+1:100*i}},{key:"appendTrace",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.inkData){null!=r&&this.setBrush(t,r);var n=this.inkData.vecTrace||[],i=void 0,a=void 0;"string"==typeof e?(i=e,a=this.stringToPoints(i)):(i=this.pointsToString(e),a=e);var o=this._genTimestamp(n),s={brushRef:t,strPoints:i,vecPoints:a,timestamp:o};n.push(s),this.inkData.vecTrace=n}}},{key:"appendPoint",value:function(e,t){if(this.inkData){e=Math.round(e/635),t=Math.round(t/635);var r=this.inkData.brushMap||{},n=this.inkData.vecTrace||[],i=Object.keys(r),a=null,o=null,s=[],l=n.length;if(l>0){var u=n[l-1],c=u.vecPoints;if(c.length<100&&c.length>0){var h=c[c.length-1],d=e-h.px,p=t-h.py;return u.strPoints+=","+d+" "+p,c.push({px:e,py:t}),void(u.timestamp=this._genTimestamp(n))}if(a=u.brushRef,c.length>0){var f=c[c.length-1];s.push({px:f.px,py:f.py})}s.push({px:e,py:t})}else a=0==i.length?"br0":i[0],0==i.length&&(o=this.defaultBrush()),s.push({px:e,py:t});this.appendTrace(s,a,o)}}},{key:"getCommandData",value:function(){if(this.inkData){for(var e=[],t={brushMap:{},vecTrace:e,context:this.inkData.context},r=this.inkData.vecTrace||[],n=0;n<r.length;n++){var i=r[n];if(0===e.length)e.push(Object.assign({},i));else{var a=e[e.length-1];a.brushRef===i.brushRef?a.vecPoints=a.vecPoints.concat(i.vecPoints):e.push(Object.assign({},i))}}for(var o=[],l=0;l<e.length;l++){var u=e[l];o.push(u.brushRef),u.strPoints=this.pointsToString(u.vecPoints),delete u.vecPoints}for(var c=this.inkData.brushMap||{},h=Object.keys(c),d=0;d<h.length;d++){var p=h[d];o.indexOf(p)>=0&&(t.brushMap[p]=Object(s.a)(c[p]))}return t}}},{key:"setFromCommandData",value:function(e){this.inkData=Object(s.a)(e);for(var t=this.inkData.vecTrace,r=[],n=0;n<t.length;n++){var i=this._genTimestamp(r);t[n].vecPoints=this.stringToPoints(t[n].strPoints),t[n].timestamp=i,r.push(t[n])}this.inkData.vecTrace=r}},{key:"getBrush",value:function(e){if(this.inkData)return(this.inkData.brushMap||{})[e]}},{key:"setBrushProperty",value:function(e,t,r){var n=this.getBrush(e);switch(t){case"width":this.setLineWidth(n,r);break;case"height":this.setLineWidth(n,r/2);break;default:n[t]=r}}},{key:"setAllBrushProperty",value:function(e,t){for(var r=this.inkData.brushMap||{},n=Object.keys(r),i=0;i<n.length;i++){var a=n[i];this.setBrushProperty(a,e,t)}}},{key:"setLineWidth",value:function(e,t){e.widthUnit=u.UnitsLength.in,e.width=t/72,e.heightUnit=u.UnitsLength.in,e.height=2*e.width}}]),e}(),v=function(){function e(t){i()(this,e),this.pres=t.pres,this.selection=t.selection,this.EventTypes=t.EventTypes,this._remoteDrawingSlides={},this._localDrawingTokens=[],this.enableDrawingNotify=!0,this.meetingNotify=null}return o()(e,[{key:"notify",value:function(e,t,r){this.enableDrawingNotify&&"SHAPE_CREATED"===e&&r&&r.isInk()&&this.createNotify(t,r)}},{key:"createNotify",value:function(e,t){var r=this,n=function(e){e.data==t&&r.broadcastDrawingInkData(r.selection,t)},i=window.getTransaction();i.isInTransaction()?(t.bBroadcast=!0,i.registerEndNotify((function(){r.pres.off(r.EventTypes.MODIFY,n),r.broadcastDrawingInkData(r.selection,t,!0),r.broadcastDrawingInkDataEnd(r.selection,t)})),r.pres.on(r.EventTypes.MODIFY,n),r.broadcastDrawingInkDataStart(r.selection,e,t)):console.log("Warning: createNotify() failed, not in transaction.")}},{key:"getDrawingSlideByToken",value:function(e){return this._remoteDrawingSlides[e]}},{key:"getDrawingShapeByToken",value:function(e){var t=this._remoteDrawingSlides[e];if(t)for(var r=t.drawingShapes,n=r.length,i=0;i<n;i++)if(r[i].drawingToken===e)return r[i]}},{key:"removeDrawingShape",value:function(e){var t=this.getDrawingSlideByToken(e);if(t)for(var r=t.drawingShapes,n=r.length,i=0;i<n;i++)if(r[i].drawingToken===e){var a=r[i];r.splice(i,1);var o=t.getSpTree(),s={opType:h.default.otRemove,data:o,op:d.default.op_remove,vals:[a],isDrawingShape:!0};o._fireChanged(s);break}delete this._remoteDrawingSlides[e]}},{key:"remoteDataUpdated",value:function(e){var t=this,r=e.data,n=r.notifyType;if("inkData"===r.dataType)if("start"===n){var i=this.pres.getSlideById(r.slideId);if(i&&i.getSpTree()){var a=r.drawingToken,o=r.data,s=o.inkData,l=o.transform2D;s.vecTrace=[];var u=i.getSpTree(),p=u._createNewShape(c.PresetShapeType.ShapeInk,l);p.private.isInk=!0,p.private.inkData=s,p.drawingToken=a,p.parent=u,i.drawingShapes.push(p),this._remoteDrawingSlides[a]=i;var v={opType:h.default.otInsert,data:u,op:d.default.op_add,vals:[p],isDrawingShape:!0};u._fireChanged(v)}}else if("drawing"===n){var y=r.drawingToken,g=r.data,m=g.startIndex,_=g.endIndex,S=g.timestamp,T=g.inkData,b=g.transform2D,k=this.getDrawingShapeByToken(y);if(k){var C=this.selection.presentation.session,w=k.private.inkData.vecTrace,P=w[w.length-1],x=P&&P.uncompleted;x&&w.splice(w.length-1,1);var O=w.length,E=0===O?-1:w[O-1].timestamp,I=function(e,t){for(var r=[],n=null,i=null,a=null,o=0;o<t.length;o++){n=t[o].data.transform2D;var s=t[o].data.inkData;s&&s.vecTrace&&(r=r.concat(s.vecTrace)),i=s.brushMap,a=s.context}for(var l=e.private.inkData,u=new f(l),c=0;c<r.length;c++){var h=r[c];h.timestamp<=E||(u.appendTrace(h.strPoints,h.brushRef),l.vecTrace[l.vecTrace.length-1].timestamp=h.timestamp,h.uncompleted&&(l.vecTrace[l.vecTrace.length-1].uncompleted=!0))}i&&(e.private.inkData.brushMap=i),a&&(e.private.inkData.context=a),n&&(e.private.transform2D=n),e._fireChanged()};0==m||m==O||O>_?I(k,[{data:{inkData:T,transform2D:b}}]):E<S&&(x&&w.push(P),C.execSimpleQuery("queryDrawingData",{drawingToken:y,lastTimestamp:E,timestamp:S},(function(e){if(e&&0==e.error&&(k=t.getDrawingShapeByToken(y))){var r=w.length;(P=w[r-1])&&P.uncompleted&&w.splice(w.length-1,1),I(k,e.datas),w.length<r&&P&&w.push(P)}})))}}else"end"===n&&this.removeDrawingShape(r.drawingToken)}},{key:"creatMeetingData",value:function(e,t){if(e&&t&&this.meetingNotify){var r=e.getPresentation();if(r){var n=r.slides.getSlideIdx(e);if(!(n<0))for(var i=t._timestamp,a=t.private.inkData,o=a.brushMap,s=a.vecTrace,l=0;l<s.length;l++){var c=s[l],h=c.brushRef,d=c.vecPoints,f=o[h],v=(4278190080|parseInt(f.color.toRGB.slice(1),16))>>>0,y=f.tip==u.InkBrushTip.rectangle?2:1,g=p(f.width,f.widthUnit);(g=Math.floor(g/1.5))>3&&(g=3);for(var m={color:v,alpha:255,type:y,width:g,auto_disapper:!1},_=[],S=d.length,T=0;T<S;T++){var b=d[T],k=0;k=0==T?0:1,T==S-1&&(k=2);var C=Math.round(100*b.px/20)/100,w=Math.round(100*b.py/20)/100;_.push({x:C,y:w,width:g,type:k})}this.meetingNotify({scale:1,uuid:i,slideIndex:n,pen:m,points:_})}}}}},{key:"broadcastDrawingInkDataStart",value:function(e,t,r){var n=this,i=e.getConnId()+"_"+Object(l.a)(),a=t.getId(),o=r.private.inkData,u={connId:e.getConnId(),slideId:a,drawingToken:i,notifyType:"start",dataType:"inkData",timestamp:0,data:{transform2D:r.visual.getTransform2D(),inkData:{brushMap:Object(s.a)(o.brushMap),context:Object(s.a)(o.context)}}};r._timestamp=Date.now(),r.drawingToken=i,this._localDrawingTokens.push(i),e.presentation.session.execSimpleQuery("drawingNotify",u,(function(e){n._localDrawingTokens.indexOf(i)}));var c={messageName:"drawingNotify",data:u};e.presentation.session.sendBroadcast(c)}},{key:"broadcastDrawingInkData",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.drawingToken){var n=t.drawingToken,i=t.private.inkData,a=i.vecTrace,o=null==t.nextStartIndex?0:t.nextStartIndex,l=null==t.uncompletedIndex?-1:t.uncompletedIndex,u=null==t.uncompletedPoints?-1:t.uncompletedPoints,c=[],h=-1,d=-1;t.nextStartIndex=a.length;for(var p=null,f=o;f<a.length;f++){var v=a[f],y=v.brushRef,g=v.strPoints,m=v.timestamp,_=v.vecPoints;if(!r&&f==a.length-1&&_.length<100){t.nextStartIndex=a.length-1,f==l?_.length-u>=10&&(p={brushRef:y,strPoints:g,timestamp:m,uncompleted:!0}):p={brushRef:y,strPoints:g,timestamp:m,uncompleted:!0},p&&(t.uncompletedIndex=f,t.uncompletedPoints=_.length);break}h<0&&(h=m),d=m,c.push({brushRef:y,strPoints:g,timestamp:m})}var S=0==c.length||d<0;if(!S||null!=p){var T={connId:e.getConnId(),drawingToken:n,notifyType:"drawing",dataType:"inkData",timestamp:h,data:{startIndex:o,endIndex:t.nextStartIndex-1,timestamp:d,transform2D:t.visual.getTransform2D(),inkData:{vecTrace:c,brushMap:Object(s.a)(i.brushMap),context:Object(s.a)(i.context)}}},b={messageName:"drawingNotify",data:T};if(p){var k=p,C=k.timestamp,w=Object(s.a)(T);w.timestamp=C,w.data.inkData.vecTrace.push(p),w.data.timestamp=C,w.data.endIndex=a.length-1,b.data=w}S?p&&e.presentation.session.sendBroadcast(b):e.presentation.session.execSimpleQuery("drawingNotify",T,null,(function(){e.presentation.session.sendBroadcast(b)}))}}}},{key:"broadcastDrawingInkDataEnd",value:function(e,t){if(t.drawingToken){var r=t.drawingToken,n={connId:e.getConnId(),drawingToken:r,notifyType:"end",dataType:"inkData",data:{}};e.presentation.session.execSimpleQuery("drawingNotify",n);var i={messageName:"drawingNotify",data:{connId:e.getConnId(),drawingToken:r,notifyType:"end",dataType:"inkData",data:{}}},a=this._localDrawingTokens.indexOf(r);a>=0&&this._localDrawingTokens.splice(a,1),setTimeout((function(){e.presentation.session.sendBroadcast(i)}),1e3),this.creatMeetingData(t.getSlide(),t)}}}]),e}()},1147:function(e,t,r){"use strict";r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return l}));var n=r(262);function i(e,t){var r={};t._bubbleUpEvent(n.default.collect_path,r);var i=r.category,a=r.layerType,o=r.slideId,s=r.shapeIds,l=r.cellRange,u=r.topSlide,c=r.nodePath;if(u){var h=e.getContainerByCategory(u.category),d=h&&h.getSlideById(u.slideId);if(d){var p=h.getSlideIdx(d);i===u.category&&a===u.layerType||(d=e.getSlideByIdx(a,i,p));var f={category:i,layerType:a,slideIdx:p};if(f.slideId=o,s&&s.length>0){var v=s[s.length-1],y=e.getShapeDepth(d.getId(),v),g=function(e,t){if(!e||!t||0===t.length)return null;var r=e.getShapeIdxById(t[0]),n=e.getShapeAt(r);if(!n)return null;var i=[];i.push(r);for(var a=t.length,o=1;o<a;++o){if(!n.isGroupShape())return null;var s=n.getChildIdxById(t[o]);if(s<0)return null;i.push(s),n=n.getChildAt(s)}return i}(d,s);f.shapePath=g,f.shapeid=v,y>0&&(f.primaryDepth=y),function(e){return!!e&&(!(e.startRow<0||e.endRow<0||e.startCol<0||e.endCol<0)&&!(e.endRow<=e.startRow||e.endCol<=e.startCol))}(l)&&(f.cellRange=l)}else c&&c.length>0&&(f.sPath=c.slice(0));return f}}}function a(e,t,r){var n=i(e,t);return n&&Object.assign(r,n),r}function o(e,t){return i(e,t)}function s(e,t,r){var n=[],i=e.getTiming();if(!i)return null;var a=i.timeLine;if(!a)return null;var o=a.subNodeIndex(t);if(-1===o)return null;n.push(o);var s=t.subNodeIndex(r);return-1===s?null:(n.push(s),n)}function l(e,t){e&&e._bubbleUpEvent(n.default.collect_path,t)}},1148:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return p}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(268),l=r(360),u=r(167),c=function(){function e(t){i()(this,e),this.table=t,this.rowRange={begin:0,end:0},this.columnRange={begin:0,end:0}}return o()(e,[{key:"clone",value:function(){var t=new e(this.table);return t.rowRange=this.rowRange,t.columnRange=this.columnRange,t}},{key:"reset",value:function(e){this.table=e,this.clearRange()}},{key:"clearRange",value:function(){this.rowRange={begin:0,end:0},this.columnRange={begin:0,end:0}}},{key:"range",value:function(){var e=this.rowRange,t=this.columnRange;return{startRow:e.begin,endRow:e.end,startCol:t.begin,endCol:t.end}}},{key:"rangeExpand",value:function(){var e=this.rowRange,t=this.columnRange;return{startRow:e.begin,endRow:e.end+1,startCol:t.begin,endCol:t.end+1}}},{key:"setRowRange",value:function(e,t){this.rowRange={begin:e,end:t}}},{key:"setColumnRange",value:function(e,t){this.columnRange={begin:e,end:t}}},{key:"cells",value:function(){if(this.table){var e=this.rowRange,t=this.columnRange;return this.table.getCells(e.begin,t.begin,e.end,t.end)}return[]}}]),e}(),h=function(){function e(){i()(this,e)}return o()(e,null,[{key:"startRowIdx",value:function(e,t,r){for(var n=t,i=t;i>-1;--i){var a=e.getCell(i,r-1),o=e.getCell(i,r);if(a.getIdx()===o.getIdx())break;n=i}return n}},{key:"endRowIdx",value:function(e,t,r){for(var n=t+1,i=e.getRowCount(),a=n;a<i;++a){var o=e.getCell(a,r-1),s=e.getCell(a,r);if(o.getIdx()===s.getIdx())break;n=a+1}return n}},{key:"startColIdx",value:function(e,t,r){for(var n=r,i=r;i>-1;--i){var a=e.getCell(t-1,i),o=e.getCell(t,i);if(a.getIdx()===o.getIdx())break;n=i}return n}},{key:"endColIdx",value:function(e,t,r){for(var n=r+1,i=e.getColumnCount(),a=n;a<i;++a){var o=e.getCell(t-1,a),s=e.getCell(t,a);if(o.getIdx()===s.getIdx())break;n=a+1}return n}},{key:"updateRangeAfterRowInsert",value:function(e,t){Object.isEmpty(t)||(e<t.startRow?(++t.endRow,++t.startRow):e<=t.endRow&&++t.endRow)}},{key:"updateRangeAfterColInsert",value:function(e,t){Object.isEmpty(t)||(e<t.startCol?(++t.startCol,++t.endCol):e<=t.endCol&&++t.endCol)}},{key:"resetRowHeight",value:function(e,t,r){for(var n=r-(e[t=0===t?1:t]-e[t-1]),i=t;i<e.length;++i)e[i]=e[i]+n}},{key:"resetColWidth",value:function(e,t,r){var n=e.length-1;if(r=Object(l.n)(r,208280),0===t)for(var i=r-(e[t+1]-e[t]),a=1;a<=n;++a)e[a]=e[a]+i;else if(t===n)e[t]=e[t-1]+r;else{var o=e[t-1]+r;e[t+1]-o<208280&&(o=e[t+1]-208280),e[t]=o}}},{key:"setRowHeight",value:function(t,r,n){if(r<0||r>=t.getRowCount())return!1;r++;var i=Object(s.a)(t.visual.getHoriBorderPosV());return e.resetRowHeight(i,r,n),t.visual.setHoriborderposV(i),!0}},{key:"setColWidth",value:function(t,r,n){if(r<0||r>=t.getColumnCount())return!1;r++;var i=Object(s.a)(t.visual.getVertBorderPosV());return e.resetColWidth(i,r,n),t.visual.setVertBorderPosV(i),!0}}]),e}();function d(e){if(!e||!e.fill)return!1;var t=e.fill;return!(t&&(!t.type||t.type===u.FillType.FillTypeNone))}var p=function(){function e(t,r){i()(this,e),this.selection=t,this.selectData=r}return o()(e,[{key:"getTableRange",value:function(){return this.selectData.tableRange.range()}},{key:"canMergeCells",value:function(){return this.selectData.selectedTableCellCount()>1}},{key:"canSetRowColVal",value:function(){return 1===this.selectData.selectedTableCellCount()}},{key:"mergedCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.selection.getActiveTableFrame();if(!t)return[];e||(e=this.getTableRange());for(var r={},n=[],i=e.startRow;i<e.endRow;++i)for(var a=e.startCol;a<e.endCol;++a){var o=t.getCell(i,a);if(o){var s=o.getIdx();null==r[s]?r[s]=0:0===r[s]&&(r[s]++,n.push(o))}}return n}},{key:"canUnMergeCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.mergedCells(e);return t.length>0}},{key:"_collectCells",value:function(e,t){for(var r=[],n=t.startRow;n<t.endRow;n++)for(var i=t.startCol;i<t.endCol;i++){if(e.getCell(n,i).getTextFrame()){var a={row:n,col:i};r.push(a)}}return r}},{key:"getBorderType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.selection.getActiveTableFrame();t||(t=this.selectData.getTableFrame());var r=this.getTableRange();e&&(r.startRow=0,r.startCol=0,r.endRow=t.getRowCount(),r.endCol=t.getColumnCount());for(var n=0,i=0,a=0,o=0,s=0,l=0,u=r.endRow-r.startRow,c=r.endCol-r.startCol,h=0,p=0,f=this._collectCells(t,r),v={},y=0;y<f.length;++y){var g=f[y],m=t.visual.getCellGridData(g.row,g.col),_=m.cell,S=_.visual.getBorder();m.startCol===r.startCol&&d(S.left)&&(o+=m.endRow-m.startRow),m.startRow===r.startRow&&d(S.top)&&(a+=m.endCol-m.startCol),m.endCol===r.endCol&&d(S.right)&&(s+=m.endRow-m.startRow),m.endRow===r.endRow&&d(S.bottom)&&(l+=m.endCol-m.startCol),m.startCol!==r.startCol&&(d(S.left)&&i++,p++),m.startRow!==r.startRow&&(d(S.top)&&n++,h++)}return v.validVert=!!(i>0&&i===p),v.validHori=!!(n>0&&n===h),v.validLeft=!(o!==u),v.validRight=!(s!==u),v.validTop=!(a!==c),v.validBottom=!(l!==c),v.validOut=v.validLeft&&v.validRight&&v.validTop&&v.validBottom,v.validInner=v.validVert&&v.validHori,v}},{key:"innerBorderValid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.selection.getActiveTableFrame();t||(t=this.selectData.getTableFrame());var r=this.getTableRange();e&&(r.startRow=0,r.startCol=0,r.endRow=t.getRowCount(),r.endCol=t.getColumnCount());for(var n=0,i=0,a=this._collectCells(t,r),o={},s=0;s<a.length;++s){var l=a[s],u=t.visual.getCellGridData(l.row,l.col);u.startCol!==r.startCol&&i++,u.startRow!==r.startRow&&n++}return o.validVert=!!(i>0),o.validHori=!!(n>0),o}},{key:"shouldDelWholeTbl",value:function(e){var t=this.selection.getActiveTableFrame(),r=this.getTableRange(),n=t.getRowCount(),i=t.getColumnCount();return e?r.endRow-r.startRow===n:r.endCol-r.startCol===i}},{key:"readonly",get:function(){return this.selection.readonly}}]),e}()},1149:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(154),c=r.n(u),h=r(42),d=r.n(h),p=r(2669),f=r(446),v=r(262),y=r(304),g=r(167),m=r(763),_=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"GroupShape"));return r.listDelegate=new S(r),r}return d()(t,e),o()(t,[{key:"createFakeShape",value:function(){for(var e=c()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createFakeShape",this).call(this),r=[],n=this.private.childs,i=0;i<n.length;++i){var a=n[i].createFakeShape();r.push(a)}return e.private.childs=r,e}},{key:"_fireChanged",value:function(e){var t=this.isShapeTree?v.default.modify_shapetree:v.default.modify_shape;if(this._fireChangeData){var r=this._fireChangeData,n=r.type,i=r.param;this._fireChangeData=null;var a=[i.value];i.value instanceof Array&&(a=i.value),this._bubbleUpEvent(t,{data:this,op:n,vals:a})}else this._bubbleUpEvent(t,Object.assign({},e||{},{data:this}))}},{key:"getChildCount",value:function(){return this.private.childs.length}},{key:"getChildAt",value:function(e){return this.private.childs[e]}},{key:"getChildById",value:function(e){var t=this.getChildIdxById(e);return this.getChildAt(t)}},{key:"getChildIdxById",value:function(e){for(var t=this.private.childs,r=0,n=t.length;r<n;++r)if(t[r].getId()===e)return r;return-1}},{key:"findShapeById",value:function(e){for(var t=this.private.childs,r=0,n=t.length;r<n;++r){if(!t[r])throw new Error("{shapeId: "+this.getId()+", shapeType: "+this.getShapeType()+", pos: "+r+", length: "+t.length);if(t[r].getId()===e)return t[r]}for(var i=0,a=t.length;i<a;++i)if(t[i].isGroupShape()){var o=t[i].findShapeById(e);if(o)return o}return null}},{key:"matchCommentShape",value:function(e){for(var t=e.getAnchor(),r=t.x,n=t.y,i=this.private.childs,a=0,o=i.length;a<o;++a){var s=i[a].visual.getAnchorRect();if(Math.abs(s.x()-r)<=1&&Math.abs(s.y()-n)<=1)return i[a]}for(var l=0,u=i.length;l<u;++l)if(i[l].isGroupShape()){var c=i[l].matchCommentShape(e);if(c)return c}return null}},{key:"matchText",value:function(e){if(!e)return null;for(var t=[],r=0;r<this.getChildCount();++r){var n=this.getChildAt(r);if(n.matchText){var i=n.matchText(e);i&&(t=t.concat(i))}}return t}},{key:"deleteShape",value:function(e){if(e)if(this.isShapeTree)this.remove(e);else{var t=this.getChildCount();if(t>2)this.remove(e),this.visual.updatePosInfo();else if(2===t){var r=0===this.getShapeIndex(e)?1:0,n=this.getChildAt(r),i=n.visual.getRealTransform2D(),a=this.parent;if(this.remove(n),a){var o=a.indexOf(this);a.remove(this),o>=0?a.insert(o,n):a.push(n);var s=n.visual.transform2DRelativeToParent(i);n.setTransform2D(s),a.isGroupShape()&&!a.isShapeTree&&a.visual.updatePosInfo()}}else if(1===t){var l=this.parent;l&&l.remove(this)}}}},{key:"childrenTree",value:function(){for(var e=[],r=this.private.childs,n=0;n<r.length;n++){var i=r[n];i instanceof t?e.push(i.childrenTree()):e.push({id:i.getId()})}return{id:this.getId(),childs:e}}},{key:"getChildShapesRecurse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[],r=this.private.childs.length,n=0;n<r;n++){var i=this.private.childs[n];if(i.isGroupShape()){var a=i.getChildShapesRecurse(e);t=t.concat(a)}else(null==e||e(i))&&t.push(i)}return t}},{key:"afterForward",value:function(){this.childsBuildTree()}},{key:"afterBackward",value:function(){this.childsBuildTree()}},{key:"childShapes",get:function(){return this.private.childs}}]),t}(p.a);t.default=_;var S=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.groupshape=e,r.listener.on(f.b.INSERT,(function(e){r._onDataChanged(v.default.op_add,e)})),r.listener.on(f.b.MODIFY,(function(e){r._onDataChanged(v.default.op_modify,e)})),r.listener.on(f.b.REMOVE,(function(e){r._onDataChanged(v.default.op_remove,e)})),r.listener.on(f.b.MOVE,(function(e){return r._onDataChanged(v.default.op_move,e)})),r.listener.on(f.b.RESET,(function(e){return r._onDataChanged(v.default.op_replace,e)})),r}return d()(t,e),o()(t,[{key:"_onDataChanged",value:function(e,t){var r=[];e===v.default.op_add||e===v.default.op_modify?r=[t.value]:e===v.default.op_replace&&(r=t.value);for(var n=this.groupshape,i=0;i<r.length;i++){var a=r[i];a.buildTree?a.buildTree(n):a.parent=n}this.groupshape._fireChangeData={type:e,param:t}}},{key:"_fireChanged",value:function(e){this.groupshape._fireChanged(e)}},{key:"getShapeIndex",value:function(e){return this.indexOf(e)}},{key:"remove",value:function(e){if(e.isShape){var t=this.private.childs,r=this.getShapeIndex(e);r>=0&&r<t.length&&(t.splice(r,1),this.addVectorOperate(this,y.default.otRemove,r,e),delete e.parent)}}},{key:"removeAt",value:function(e){var t=this.private.childs;e>=0&&e<t.length&&this.remove(t[e])}},{key:"insert",value:function(e,t){var r=this.private.childs;if(t.isShape){var n=this.getShapeIndex(t);n>=0&&n<r.length||((r.length<e||e<0)&&(e=r.length),r.splice(e,0,t),this.addVectorOperate(this,y.default.otInsert,e,t),t.parent=this.groupshape)}}},{key:"listAtomProperties",get:function(){return["childs"]}}]),t}(f.c);Object(f.d)(_,{ListAtomDelegateClass:S,selfAtomeType:"customAtom"}),_.createGroupShape=function(e){for(var t=window.APP.presentation,r=[],n=0;n<e.length;n++){var i=e[n].visual.getRealTransform2D();r.push(i),e[n].setPropertyValue("transform2D",i)}var a=Object(m.c)(r),o={x:a.left,y:a.top,width:a.right-a.left+1,height:a.bottom-a.top+1,rotation:0,horizontalFlipped:!1,verticalFlipped:!1},s={group:!0,isOle:!1,modelType:g.ShapeModeType.MODEL_GROUPSHAPE,shape:!0,name:"",shapeId:t.allocateLocalId(),childs:e,transform2D:o,childExtents:{width:o.width/635,height:o.height/635},childOffset:{x:o.x/635,y:o.y/635}},l=new _({id:s.shapeId,data:s});l.buildTree(null);for(var u=0;u<s.childs.length;u++){var c=s.childs[u],h=c.getTransform2D();h.x=h.x-o.x,h.y=h.y-o.y;var d=c.visual.transform2DRelativeToParent(h);c.setPropertyValue("transform2D",d)}return l}},1258:function(e,t,r){"use strict";var n,i=r(0),a=r.n(i),o=r(3),s=r.n(o),l=r(25),u=r.n(l),c=r(154),h=r.n(c),d=r(42),p=r.n(d),f=r(926),v=r(1015),y=r(1384),g=r(158),m=r(762),_=r(268),S=r(927),T=r(1147),b=function(){function e(){a()(this,e)}return s()(e,null,[{key:"isSlideTransFollowMaster",value:function(e){var t=e.getFollowing();if(!t)return!1;var r=e.getTransition(),n=t.getTransition();return!r&&!n}},{key:"removeEmptyPlaceholders",value:function(e){for(var t={},r=[],n=e.getPresentation(),i=n.getSlideIdxById(e.getId()),a=e.getSpTree(),o=a.childShapes,s=[],l=0;l<o.length;l++){var u=o[l];if(u.isPlaceHolder()&&!u.hasContent()){var c=u.private.placeholder.type;if(!m.a.isIgnoreType(c)){s.push(u);var h=Object(T.e)(n,u);r.push(h)}}}for(var d=0;d<s.length;d++)a.remove(s[d]);return t.slideIdx=i,t.shapes=r,[{name:"shapeDelete",param:t}]}},{key:"getPlaceholderShapes",value:function(e){for(var t=e.getSpTree().childShapes,r=[],n=0;n<t.length;n++){var i=t[n];if(i.isPlaceHolder()){var a=i.getPlaceHolder();null!=a.type&&m.a.isIgnoreType(a.type)||r.push(i)}}return r}},{key:"getHeaderFooterShapes",value:function(e){for(var t=e.getSpTree().childShapes,r=[],n=0;n<t.length;n++){var i=t[n];if(i.isPlaceHolder()){var a=i.getPlaceHolder().type;a!==g.PlaceholderType.DateTime&&a!==g.PlaceholderType.SlideNumber&&a!==g.PlaceholderType.Footer&&a!==g.PlaceholderType.Header||r.push(i)}}return r}},{key:"isValidPlaceholderType",value:function(e,t){return t?e!==g.PlaceholderType.Footer&&e!==g.PlaceholderType.DateTime&&e!==g.PlaceholderType.SlideNumber:e===g.PlaceholderType.Title||e===g.PlaceholderType.CenterTitle||e===g.PlaceholderType.SubTitle}},{key:"getFollowrPlaceholderShapes",value:function(e){for(var t=e.getFollowing().getSpTree().childShapes,r=[],n=0;n<t.length;n++){var i=t[n];if(i.isPlaceHolder()){var a=i.getPlaceHolder();this.isValidPlaceholderType(a.type,!0)&&r.push(i)}}return r}},{key:"backupPhTransform2D",value:function(e){for(var t=e.getShapeTree(),r=t.childShapes.length-1;r>=0;--r){var n=t.getChildAt(r);n.isPlaceHolder()&&n.getTransform2D()}}},{key:"syncLayoutShapeProps",value:function(e,t){switch(m.a.syncLayoutPlaceholderProps(e,t.private.placeholder),m.a.isTextShape(e)&&e.getTransform2D()&&e.setTransform2D(null),e.getShapeType()){case g.ShapeType.OleShape:m.a.adjustShapeSize(e,t);break;case g.ShapeType.Picture:m.a.adjustPictureSize(e,t);break;case g.ShapeType.Table:m.a.adjustTableSize(e,t);break;case g.ShapeType.Chart:m.a.adjustChartSize(e,t);break;case g.ShapeType.Media:m.a.adjustShapeSize(e,t)}}},{key:"takeMatchShape",value:function(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(r){if(m.a.isExactMatch(i,t))return e.splice(n,1),i}else if(m.a.isMatch(i,t))return e.splice(n,1),i}return null}},{key:"matchPlaceholders",value:function(t,r){for(var n=t,i=[],a=0;a<r.length;a++){var o=e.takeMatchShape(n,r[a],!0);o&&(e.syncLayoutShapeProps(o,r[a]),i.push(o),r[a]=null)}if(0===n.length)return{matchs:i,noMatch:n};for(var s=0;s<r.length;s++)if(r[s]){var l=this.takeMatchShape(n,r[s],!1);l&&(e.syncLayoutShapeProps(l,r[s]),i.push(l),r[s]=null)}return{matchs:i,noMatch:n}}},{key:"addNewLayoutPlaceholder",value:function(e,t){for(var r=[],n=e.getPresentation(),i=e.getSpTree(),a=0;a<t.length;a++){var o=t[a];if(o){var s=i.createNewShape(e.getPresentation());s.setPlaceholder(o.getPlaceHolder()),o.getTransform2D()&&s.setTransform2D(o.getTransform2D());var l=s.private.placeholder.type;if(l!==g.PlaceholderType.Chart&&l!==g.PlaceholderType.Table&&l!==g.PlaceholderType.ClipArt&&l!==g.PlaceholderType.Diagram&&l!==g.PlaceholderType.Media&&l!==g.PlaceholderType.Picture){var u=S.a.createNewTextFrame(e.getPresentation()),c=u.private.textStream;s.private.childs[0]=u,c.private.textHeader="TextStyleOther";var h=o.getTextFrame();if(h){for(var d=h&&h.private,p=["layer","modelType","prop"],f=0;f<p.length;f++){var v=p[f];d.hasOwnProperty(v)&&(u.private[v]=Object(_.a)(d[v]))}d.textStream&&(c.private.textHeader=Object(_.a)(d.textStream.textHeader))}}i.push(s),s.parent=i;var y=Object(T.e)(n,s);r.push({name:"shapeInsert",param:y})}}return r}},{key:"setNoMatchPlaceholderProps",value:function(e,t){for(var r=0,n=t.width,i=(t.height,0);i<e.length;i++){var a=e[i],o=a.visual.getAnchorRect(),s=r,l=r+n;if(l-o.right>=o.left-s)o.right=o.right-o.left,o.left=0;else{var u=o.right-o.left;o.right=l,o.left=l-u}a.visual.setAnchorRect(o)}}},{key:"syncHeaderFooterFromLayout",value:function(t){var r=e.getHeaderFooterShapes(t);if(0!==r.length){for(var n=[],i=t.getSpTree(),a=t.getFollowing(),o=0;o<r.length;o++){var s=r[o],l=a.getPlaceholders(s.getPlaceHolder().type);l.length>0?(s.setPlaceholder(l[0].getPlaceHolder()),s.setTransform2D(null)):s.hasContent()?n.push(s):i.remove(s)}var u=t.getPresentation();e.setNoMatchPlaceholderProps(n,u.getSlideSize())}}},{key:"renewPlaceholders",value:function(t){var r=[],n=t.getPresentation(),i=e.removeEmptyPlaceholders(t);!Object.isEmpty(i)&&i.length>0&&r.concat(i);var a=e.getPlaceholderShapes(t),o=e.getFollowrPlaceholderShapes(t),s=e.matchPlaceholders(a,o).noMatch;e.setNoMatchPlaceholderProps(s,n.getSlideSize());var l=e.addNewLayoutPlaceholder(t,o);return!Object.isEmpty(l)&&l.length>0&&(r=r.concat(l)),this.syncHeaderFooterFromLayout(t),r}},{key:"copyTransFromSlide",value:function(e,t){var r=t.getTransition();if(r){var n=Object(_.a)(r);e.modifyProperties({transition:n})}else e.modifyProperties({transition:null})}},{key:"adjustPhText",value:function(e){for(var t=e.getShapeTree().childShapes,r=0;r<t.length;r++){t[r].getTextFrame()}}}]),e}(),k=r(446),C=r(2249),w=r(1713),P=r(2250),x=function(e){function t(e){a()(this,t);var r=u()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,g.WppLayerType.WppLayerNormalSlide,e));return r.listenPropertyChanged(["comments","timing"],(function(e,t,n){r._onSlidePropChanged(e,t,n)})),r}return p()(t,e),s()(t,[{key:"getSize",value:function(){return this.slideSize}},{key:"getLayout",value:function(){return this.getFollowing()}},{key:"getComments",value:function(){return this.private.comments}},{key:"replyComment",value:function(e,t){return this._doInsertComment(e,t)}},{key:"decodeComment",value:function(){var e=this.private.comments,t=w.a.parseComments(e,r),r=t.commentMap,n=t.replicas,i=[],a={};for(var o in r){var s=r[o];a[s.index]=s}if(n&&n.length>0)for(var l=0;l<n.length;++l){var u=n[l];a[u.index]=u}for(var c in a)i.push(a[c]);return i}},{key:"addComment",value:function(e){return this._doInsertComment(e)}},{key:"_doInsertComment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null,n=e.media_type;if(r="voice"===n?"6e439d96ec4fba12":e.content,t){var i=w.a.encodeComment(t.authName,t.commentId);r=i.concat(r)}e.content=r}},{key:"deleteComment",value:function(e){var t=this.private.comments;return t?t.deleteComment(e):null}},{key:"updateCommentPos",value:function(e,t){return!!this.private.comments&&(e&&e.setPropertyValue("pos",t),!0)}},{key:"getNotesPage",value:function(){for(var e=this.getChildCount(),t=0;t<e;++t){var r=this.getChildAt(t);if(r instanceof v.a)return r}return null}},{key:"buildTree",value:function(e){h()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"buildTree",this).call(this,e),this.getNotesPage().buildTree(this);var r=this.getComments();r&&r.buildTree(this)}},{key:"_onSlidePropChanged",value:function(e,t,r){t&&delete t.parent,r&&"comments"===e&&r.buildTree(this)}},{key:"matchText",value:function(e){if(!e)return null;for(var t=[],r=0;r<this.private.childs.length;++r){var n=this.private.childs[r];if(n.matchText){var i=n.matchText(e);i&&(t=t.concat(i))}}return t}},{key:"getMasterSlide",value:function(){var e=this.getFollowing();return e&&e.getMasterSlide()}},{key:"isNormalSlide",get:function(){return!0}}]),t}(f.a);t.a=x;function O(){return new y.a({data:{childs:[],group:!0,layer:!0,shape:!0,shapeId:1,shapetree:!0}})}function E(e,t){return new C.a({data:{followId:e,timing:t}})}n=x.prototype,Object(k.e)(n,!1),x.createNewSlide=function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=r.getSlideCount();if(e<0||e>i)return null;var a=r.parent,o=null,s=null;i>0&&(o=0===e?r.getSlideAt(0):r.getSlideAt(e-1));var l=null,u=a.getMasters(),c=a.getLayouts();if(0==t)if(o&&o.getFollowing()){for(var h=o.getFollowing(),d=h.getFollowing(),p=null,f=null,y=0;y<c.getSlideCount();y++){var g=c.getSlideAt(y);if(g&&g.getFollowing()==d)if(p){if(!f){f=g;break}}else p=g}l=p==h?f:h}else{var m=u.getSlideAt(0);if(m)for(var _=0;_<c.getSlideCount();_++){var S=c.getSlideAt(_);if(S&&S.getFollowing()==m){l=S;break}}}else for(var T=0;T<c.getSlideCount();T++){var k=c.getSlideAt(T);if(k&&k.getId()===t){l=k;break}}if(null==l||null==l){if(c.getPendingBlocks().length>0&&window.collection("slide_add_notready"),!o||!o.getFollowing())return console.error("Create slide failed: not found layout with id:",t),null;l=o.getFollowing()}Object.isEmpty(o)||(s=o.getNotesPage());var C=O(),w=null;if(null!=s)w=s.getFollowing();else{var I=a.getContainerByCategory("notesMasters");I&&I.getSlideCount()>0&&(w=I.getSlideAt(0))}var A=a.allocateLocalId(),R=new v.a({id:A,data:{childs:[C],layer:!0,shapeTree:C,slideId:A,following:w}}),D=O(),L=a.allocateLocalId(),N=E(l.getId(),new P.a({data:{}})),M={slideId:L,following:l,layer:!0,showMasterPhAnim:!0,showMasterShape:!0,shapeTree:D,childs:[D,R],baseData:N},F=new x({data:M,id:L});return F.buildTree(r),n&&b.renewPlaceholders(F),F._isLocalNew=!0,F},x.modifySlideLayout=function(e,t,r){var n=e.getLayouts(),i=null,a=[];if(t.getId()!=r){for(var o=b.isSlideTransFollowMaster(t),s=0;s<n.getSlideCount();s++){var l=n.getSlideAt(s);if(l&&l.getId()===r){i=l;break}}if(null==i)return;var u=i.getMaster(),c={following:i};t.modifyProperties(c);var h=b.renewPlaceholders(t);h.length>0&&(a=a.concat(h)),o&&b.copyTransFromSlide(t,u)}else{var d=b.renewPlaceholders(t);d.length&&(a=a.concat(d))}return b.adjustPhText(t),{slide:t,cvCmds:a}}},1259:function(e,t,r){"use strict";r.d(t,"c",(function(){return d.SelectType})),r.d(t,"a",(function(){return d.CompositionState})),r.d(t,"b",(function(){return S}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(335),d=r(158),p=r(167),f=r(262),v=r(1147),y=r(1148),g=0,m=function(){function e(t,r,n,a,o,s){i()(this,e),this.rpt=t,this.presentation=r,this.uid=n,this.connid=a,this._readonly=o,this.coreSlt=s,this.lastChangeTime=Date.now(),this.activeConnId=this.connid,this.reset(),this.makeNewVer(),this._stateList=[];var l=function(e){return new y.a(e)};this.createTableRange=l,this.tableRange=l(this.table),this.slideMarker=new _(this.presentation,this,this.coreSlt)}return o()(e,[{key:"getActiveConnId",value:function(){return this.activeConnId}},{key:"setActiveConnId",value:function(e){this.activeConnId=e}},{key:"getStateList",value:function(){return this._stateList}},{key:"resetStateList",value:function(){this._stateList=[]}},{key:"makeNewVer",value:function(){this.ver=g,g++,this.tran=null,console.log("makeNewVer",this.ver)}},{key:"setReadOnly",value:function(e){this._readonly=e,this.textStream=null}},{key:"getSlideMarker",value:function(){return this.slideMarker}},{key:"setDeviceType",value:function(e){this.deviceType=e}},{key:"resetForState",value:function(e){switch(e){case p.SelectType.select_none:this._activeSlide=null,this._activeSlideProxy=null;case p.SelectType.select_slide:this._clearShapes(),this._clearAnimations();case p.SelectType.select_shape:case p.SelectType.select_multi_shape:this.table=null,this.tableCells=null,this.tableRange.reset(null),this._clearAnimations();case p.SelectType.select_table:this.tableCells=null,this.tableRange.clearRange(),this._clearAnimations();case p.SelectType.select_cell:case p.SelectType.select_multi_cell:this.textFrame=null,this.textStream=null,this._begin=0,this._end=0,this._clearAnimations();case p.SelectType.select_multi_animation:break;case p.SelectType.select_text:this._clearAnimations()}}},{key:"changeToState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.resetForState(e),this._stateList.push(e),this.state=e}},{key:"reset",value:function(){this.state=p.SelectType.select_none,this._activeSlide=null,this._activeSlideProxy=null,this._clearShapes(),this.table=null,this.tableCells=null,this.tableRange?this.tableRange.reset(this.table):this.createTableRange&&(this.tableRange=this.createTableRange(this.table)),this.textFrame=null,this.textStream=null,this._begin=0,this._end=0,this._clearAnimations(),this.deviceType=d.DeviceType.DEVICE_PC}},{key:"clearText",value:function(){this.changeToState(p.SelectType.select_shape)}},{key:"addShape",value:function(e){if(this.isValidShape(e)){if(!this.selectedShape(e)){this.shapes||(this.shapes=[]);var t=this.shapes;if(0===t.length)this.shapes.push(e);else{for(var r=e.visual.isRootShape(),n=!0,i=[],a=0;a<t.length;a++){var o=t[a].visual;n=!!n&&o.isRootShape();var s=o.getRootShape();i.indexOf(s)<0&&i.push(s)}var l=e.visual.getRootShape();i.indexOf(l)<0?(i.push(l),this.shapes=i):r||(n?1===t.length&&(this.shapes=[e]):this.shapes.push(e))}this.changeToState(this.shapes.length>1?p.SelectType.select_multi_shape:p.SelectType.select_shape)}}else console.error("Select invalid shape")}},{key:"removeShape",value:function(e){if(!this.shapes||0===this.shapes.length)return!1;var t=this.shapes.indexOf(e);return!(t<0)&&(this.shapes.splice(t,1),0===this.selectedShapeCount()?this.changeToState(p.SelectType.select_slide):1===this.shapes.length?this.changeToState(p.SelectType.select_shape,!1):this.changeToState(p.SelectType.select_multi_shape,!1),!0)}},{key:"clearShapes",value:function(){this._clearShapes(),this.changeToState(p.SelectType.select_slide)}},{key:"selectedShapeCount",value:function(){return this.shapes?this.shapes.length:0}},{key:"selectedShape",value:function(e){return this.shapes&&this.shapes.indexOf(e)>-1}},{key:"_clearShapes",value:function(){var e=this.shapes;this.shapes=null,e&&this.onClearSelectedShapes(e)}},{key:"clearSlide",value:function(){this.changeToState(p.SelectType.select_none)}},{key:"addAnimation",value:function(e){null==this.animations&&(this.animations=[]),this.animations.push(e),this.changeToState(p.SelectType.select_multi_animation)}},{key:"clearAnimations",value:function(){0!==this.selectedAnimsCount()&&(this._clearAnimations(),this.textStream?this.changeToState(p.SelectType.select_text):this.changeToState(p.SelectType.select_multi_shape))}},{key:"selectedAnimsCount",value:function(){return this.animations?this.animations.length:0}},{key:"_clearAnimations",value:function(){var e=this.animations;this.animations=null,e&&this.onClearSelectedAnims()}},{key:"addTableCell",value:function(e){Object.isEmpty(this.tableCells)&&(this.tableCells=[]),e&&(this.tableCells[this.tableCells.length]=e),1===this.tableCells.length?this.changeToState(p.SelectType.select_cell):this.changeToState(p.SelectType.select_multi_cell)}},{key:"removeTableCell",value:function(e){if(!this.tableCells||0===this.tableCells.length)return!1;var t=this.tableCells.indexOf(e);return!(t<0)&&(this.tableCells.splice(t,1),0===this.tableCells.length?this.changeToState(p.SelectType.select_table):1===this.tableCells.length?this.changeToState(p.SelectType.select_cell):this.changeToState(p.SelectType.select_multi_cell),!0)}},{key:"clearTableCells",value:function(){this._clearTableCells(),this.changeToState(p.SelectType.select_table)}},{key:"selectedCell",value:function(e){return this.tableCells&&this.tableCells.indexOf(e)>-1}},{key:"_clearTableCells",value:function(){return!(!this.tableCells||0===this.tableCells.length)&&(this.tableCells=null,!0)}},{key:"selectedTableCellCount",value:function(){return this.tableCells?this.tableCells.length:0}},{key:"getTableFrame",value:function(){return null!==this.table||(this.state===p.SelectType.select_shape&&(this.table=this.shapes[0].getTableFrame()),this.tableRange.reset(this.table)),this.table}},{key:"getTextFrame",value:function(){return null!==this.textFrame||(this.state===p.SelectType.select_shape?this.textFrame=this.shapes[0].getTextFrame():this.state===p.SelectType.select_cell?this.textFrame=this.tableCells[0].getTextFrame():this.state===p.SelectType.select_multi_animation&&(this.textFrame=this.shapes[0].getTextFrame())),this.textFrame}},{key:"getTextStream",value:function(){return this.textStream||this.textFrame&&(this.textStream=this.textFrame.getTextStream()),this.textStream&&!this._readonly&&this.textStream.initTransact(this.transaction),this.textStream}},{key:"canSelectText",value:function(){return p.SelectType.canSelectTextType(this.state)}},{key:"getStateStr",value:function(){return p.SelectType.toString(this.state)}},{key:"getSelectRanges",value:function(){var e={state:this.state,deviceType:this.deviceType,activeConnId:this.activeConnId};null!=this._slideInsertion&&(e.slideInsertion=this._slideInsertion);var t=this._activeSlide;if(!t)return e.state=p.SelectType.select_none,e;var r=t.getPresentation(),n=t.getCategory();if(e.category=n||"slides",e.layerType=t.getLayerType(),e.slideId=t.getId(),e.activeSlide=r.getSlideIdx(t),e.shapes=[],this.shapes&&this.shapes.length>0)for(var i=0,a=this.shapes.length;i<a;++i){var o=this.shapes[i],s=Object(v.d)(r,o);if(s)e.shapes.push(s);else if(o&&o.isGroupShape())for(var l=o.getChildShapesRecurse(),u=[],c=0;c<l.length;c++){var h=l[c].visual.getRootShape();h&&h.getShapeTree()&&u.indexOf(h)<0&&(u.push(h),(s=Object(v.d)(r,h))&&e.shapes.push(s))}}if(this.state===p.SelectType.select_cell||this.state===p.SelectType.select_multi_cell?(e.cellRange=this.tableRange.range(),e.tableActive=!0):(this.state===p.SelectType.select_table||this.table)&&(e.tableActive=!0,e.cellRange=this.tableRange.range()),this.state===p.SelectType.select_text&&(e.begin=this._begin,e.end=this._end),this.state===p.SelectType.select_multi_animation){if(this.animations&&this.animations.length>0){e.animations=[];for(var d=0;d<this.animations.length;++d){var y={};if(this.animations[d]._bubbleUpEvent(f.default.collect_path,y),y.nodePath){var g={sPath:y.nodePath,slideIdx:e.activeSlide,category:e.category,layerType:e.layerType};e.animations.push(g)}}}this._begin>=0&&this._end>=this._begin&&(e.begin=this._begin,e.end=this._end)}return e}},{key:"_checkRestoreShapes",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].visual.getRootShape();t.indexOf(n)<0&&t.push(n)}return t.length<=1?e:t}},{key:"_checkRestoreCellRange",value:function(e,t,r,n,i){var a=e.getRowCount(),o=e.getColumnCount();return!(t>=r||n>=i)&&(!(t<0||n<0)&&(!(r>a||i>o)&&null!=e.getCell(t,n).getTextFrame()))}},{key:"restoreSelectRange",value:function(e){this.changeToState(p.SelectType.select_none),this.state=e.state,this.deviceType=e.deviceType,this.activeConnId=e.activeConnId;var t=this.presentation;if(null!=e.activeSlide&&e.activeSlide>=0&&(this._activeSlide=t.getSlideByIdx(e.layerType,e.category,e.activeSlide),this._activeSlideProxy=t.getSlideProxy(this._activeSlide)),this._activeSlide){if(this.shapes=null,e.shapes&&e.shapes.length>0){for(var r=t.getBuddy(),n=[],i=0;i<e.shapes.length;i++){var a=r.fetchShape(e.shapes[i]);a&&this.isValidShape(a)&&n.indexOf(a)<0&&n.push(a)}this.shapes=this._checkRestoreShapes(n)}if(this.shapes&&0!==this.shapes.length?1===this.shapes.length&&this.state===p.SelectType.select_multi_shape&&(this.state=p.SelectType.select_shape):(this.shapes=null,this.state=p.SelectType.select_slide),this.tableRange.reset(null),e.tableActive&&this.shapes&&1===this.shapes.length)if(this.table=this.shapes[0].getTableFrame(),this.tableRange.reset(this.table),this.table){if(e.cellRange){var o=e.cellRange,s=o.startRow,l=o.endRow,u=o.startCol,c=o.endCol;this._checkRestoreCellRange(this.table,s,l,u,c)?(this.tableRange.setRowRange(s,l),this.tableRange.setColumnRange(u,c),this.tableCells=this.tableRange.cells()):(this.state=p.SelectType.select_shape,this.tableRange.reset(null),this._clearTableCells())}}else this.state=p.SelectType.select_slide,this.shapes=null;if(this.state===p.SelectType.select_text&&(this.tableCells&&this.tableCells.length>0?this.textFrame=this.tableCells[0].getTextFrame():this.shapes&&this.shapes.length>0&&(this.textFrame=this.shapes[0].getTextFrame()),this.getTextStream(),this._begin=e.begin,this._end=e.end),this.state===p.SelectType.select_multi_animation){var h=e.animations,d=[];if(h&&h.length>0){for(var f=t.getBuddy(),v=0;v<h.length;++v){var y=f.fetchAnimation(h[v]);y&&d.push(y)}d.length>0?this.animations=d:e.begin?this.state=p.SelectType.select_text:this.state=p.SelectType.select_shape}(this.state===p.SelectType.select_text||e.begin)&&(this.tableCells&&this.tableCells.length>0?this.textFrame=this.tableCells[0].getTextFrame():this.shapes&&this.shapes.length>0&&(this.textFrame=this.shapes[0].getTextFrame()),this.getTextStream(),this._begin=e.begin,this._end=e.end)}this.onSelectionDataRestore()}else this.state=p.SelectType.select_none}},{key:"getMemo",value:function(){return this.getSelectRanges()}},{key:"restoreMemo",value:function(e){var t=this.textStream;this.restoreSelectRange(e),this.textStream!==t&&this.onTextStreamChange(t,this.textStream)}},{key:"onTextStreamChange",value:function(e,t){}},{key:"onClearSelectedShapes",value:function(e){}},{key:"onClearSelectedAnims",value:function(e){}},{key:"onSelectionDataRestore",value:function(){}},{key:"isValidShape",value:function(e){return!!e}},{key:"getMemo2",value:function(){return this.getSelectRanges()}},{key:"restoreMemo2",value:function(e){null!=e.token&&(this.__token=e.token);var t=this.fetchSelectObjsById(e);if(t.slide)if(this.changeToState(p.SelectType.select_none),this.state=e.state,this.deviceType=e.deviceType,this.activeConnId=e.activeConnId,this._activeSlide=t.slide,this._activeSlideProxy=this.presentation.getSlideProxy(this._activeSlide),t.shapes&&0!==t.shapes.length){if(this.shapes=t.shapes,this.tableRange.reset(null),e.tableActive&&this.shapes&&1===this.shapes.length&&(this.table=this.shapes[0].getTableFrame(),this.tableRange.reset(this.table),e.cellRange)){var r=e.cellRange,n=r.startRow,i=r.endRow,a=r.startCol,o=r.endCol;this.tableRange.setRowRange(n,i),this.tableRange.setColumnRange(a,o),this.tableCells=this.tableRange.cells()}if(this.state===p.SelectType.select_text&&(this.tableCells&&this.tableCells.length>0?this.textFrame=this.tableCells[0].getTextFrame():this.shapes&&this.shapes.length>0&&(this.textFrame=this.shapes[0].getTextFrame()),this.getTextStream(),this._begin=e.begin,this._end=e.end),this.state===p.SelectType.select_multi_animation){var s=e.animations,l=[];if(s&&s.length>0){for(var u=this._activeSlide.getPresentation().getBuddy(),c=0;c<s.length;++c){var h=u.fetchAnimation(s[c]);h&&l.push(h)}l.length>0?this.animations=l:e.begin?this.state=p.SelectType.select_text:this.state=p.SelectType.select_shape}(this.state===p.SelectType.select_text||e.begin)&&(this.tableCells&&this.tableCells.length>0?this.textFrame=this.tableCells[0].getTextFrame():this.shapes&&this.shapes.length>0&&(this.textFrame=this.shapes[0].getTextFrame()),this.getTextStream(),this._begin=e.begin,this._end=e.end)}this.onSelectionDataRestore()}else this.changeToState(p.SelectType.select_slide);else this.changeToState(p.SelectType.select_none)}},{key:"fetchSelectObjsById",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.presentation,n=null,i=null;if(e.slideId&&(n=r.getSlideById2(e.category,e.layerType,e.slideId)),!n)return{slide:null,shapes:null};var a=[];if(e.shapes&&n){i=[];for(var o=0,s=e.shapes.length;o<s;++o){var l=e.shapes[o],u=n;l.category===e.category&&l.layerType===e.layerType||(u=r.getSlideById2(l.category,l.layerType,l.slideId));var c=u.findShapeById(l.shapeid);if(c)i.push(c),a.push(l);else if(t)return{slide:n,shapes:null}}}return{slide:n,shapes:i,shapeRanges:a}}},{key:"getSlideInsertion",value:function(){return this._slideInsertion}},{key:"setSlideInsertion",value:function(e){return this._slideInsertion=e}},{key:"readonly",get:function(){return this._readonly}},{key:"transaction",get:function(){return this._readonly?null:window.getTransaction()}},{key:"textStream",get:function(){return this._textStream},set:function(e){this._textStream!==e&&this.onTextStreamChange(this._textStream,e),this._textStream=e}},{key:"textFrame",get:function(){return this._textFrame},set:function(e){this._textFrame=e}},{key:"begin",get:function(){return this._begin},set:function(e){null!=e&&(this._begin=e,this.changeToState(p.SelectType.select_text))}},{key:"end",get:function(){return this._end},set:function(e){null!=e&&(this._end=e,this.changeToState(p.SelectType.select_text))}},{key:"activeSlide",get:function(){return this._activeSlide},set:function(e){null==e?this.changeToState(p.SelectType.select_none):(this._activeSlide=e,this.changeToState(p.SelectType.select_slide))}},{key:"activeSlideProxy",get:function(){return this._activeSlideProxy},set:function(e){null==e?this.changeToState(p.SelectType.select_none):(this._activeSlideProxy=e,this.changeToState(p.SelectType.select_slide))}}]),e}(),_=function(){function e(t,r,n){i()(this,e),this.pres=t,this.parent=r,this.coreSlt=n,this.selected=[],this.selectIdxs=[],this.category="slides",this.registerAllProxys()}return o()(e,[{key:"update",value:function(e,t){this.clear(!1);var r=this.pres;this.selected=[];for(var n=0;n<t.length;++n){var i=t[n];i?i.hasLoaded()&&this.selected.push(i):console.warn("invalid proxy, slide marker")}this.category=e,r.onMultiSlides()}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pres;this.selected=[],this.selectIdxs=[],e&&t.onMultiSlides()}},{key:"registerAllProxys",value:function(){for(var e=this.pres,t=e.getContainerSize(),r=0;r<t;++r){e.getContainerAt(r).addProxyNotifiers(this)}}},{key:"onProxyInserted",value:function(e,t){t.category===this.category&&this.pres.onMultiSlides()}},{key:"onProxyRemoved",value:function(e,t,r){if(t.category===this.category){var n=this.selected.indexOf(t);-1!==n&&this.selected.splice(n,1),this.pres.onMultiSlides()}}},{key:"onProxyMoved",value:function(e,t,r){r.category===this.category&&this.pres.onMultiSlides()}},{key:"sortMark",value:function(){this.selectIdxs=[];for(var e=0;e<this.selected.length;++e){var t=this.selected[e];t&&this.selectIdxs.push(t.idx)}this.selectIdxs.sort((function(e,t){return e-t}))}},{key:"fetch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.coreSlt;(t.state!==p.SelectType.select_slide&&t.state!==p.SelectType.select_multi_slide||t.category()!==this.category)&&this.clear(!1),e&&this.sortMark();var r=t.getActiveSlideProxy();if(r&&!e&&-1===this.selected.indexOf(r)){var n=this.selected.slice();return n.push(r),n}return this.selected}},{key:"binarySearch",value:function(e){var t=this.selectIdxs.length;if(t<=0)return-1;for(var r=0,n=t-1,i=r;i<=n;i++){var a=Math.floor((r+n)/2),o=this.selectIdxs[a],s=this.selectIdxs[a-1];if(s&&e<=o&&e>s)return o;var l=this.selectIdxs[a+1];if(l&&e>=o&&e<l)return o;e<=o?n=a:r=a}return t-1}},{key:"fetchIdxs",value:function(){return this.fetch(!0),this.selectIdxs}}]),e}(),S={CHANGE:"selection_change",SLIDE_CHANGE:"selection_slide_change",ERROR_READONLY:"error_readonly",SEND_SELECTION:"send_selection",SYNC_SELECTION:"sync_selection",ERROR_CORE:"error_core"},T=function(e){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"local",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"local",o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;i()(this,t);var u=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.EventTypes=S,u._readonly=!o,u.isLocal=o,u.authority_mgr=s,u._data=new m(e,r,n,a,u._readonly,u),u.rpt=e,u.presentation=r,u.batchSltLevel=0,u.disableBroadcastSelection=!1,o&&e.getTransDepositedContainer().addItem(u),u}return c()(t,e),o()(t,[{key:"setConnectionInfo",value:function(e,t){this._data.uid=e,this._data.connid=t}},{key:"setReadOnly",value:function(e){this._readonly!==e&&(this._readonly=!!e,this._data.setReadOnly(this._readonly))}},{key:"setDeviceType",value:function(e){this._data.setDeviceType(e)}},{key:"isLocalSelection",value:function(){return this.isLocal}},{key:"beginBatchSelect",value:function(){++this.batchSltLevel}},{key:"endBatchSelect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?this.batchSltLevel=0:--this.batchSltLevel}},{key:"_fireSelectionChange",value:function(){if(this.batchSltLevel<=0){if(!0!==this.disableBroadcastSelection&&(window.APP.isDoingCmdResponse||this.bDisbleUpdateActiveConnId?this.fire(t.EventTypes.SEND_SELECTION,{bUpdateActiveConnId:!1}):(this._data.activeConnId=this._data.connid,this.fire(t.EventTypes.SEND_SELECTION,{bUpdateActiveConnId:!0}))),window.APP.isDoingCmdResponse)return;this._data.lastChangeTime=Date.now();this.fire(t.EventTypes.CHANGE)}}},{key:"_fireSlideSelectionChange",value:function(e,r){this.batchSltLevel<=0&&this.fire(t.EventTypes.SLIDE_CHANGE,{oldSlide:e,curSlide:r})}},{key:"getLastChangeTime",value:function(){return this._data.lastChangeTime}},{key:"transDepositedClone",value:function(){var e=this._data.getMemo();return e.ver=this._data.ver,e}},{key:"transDepositedInstall",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t){if(!(t.isSelf||e.ver===this._data.ver&&r))return;this._data.ver=e.ver}this._restoreTrans=t,this._restoreMemo=e;var n=this._data.activeSlide;this._data.restoreMemo(e);var i=this._data.activeSlide;n!==i&&this._fireSlideSelectionChange(n,i),this._fireSelectionChange()}},{key:"transMemoPathInstall",value:function(e){}},{key:"readonly",get:function(){return this._readonly||this.authority_mgr&&this.authority_mgr.isReadOnly()}},{key:"transaction",get:function(){return this._data.transaction}},{key:"deviceType",get:function(){return this._data.deviceType}}]),t}(h.a);T.EventTypes=S,T.EventArgs={};t.d=T},1260:function(e,t,r){"use strict";r.d(t,"a",(function(){return T})),r.d(t,"b",(function(){return b}));var n=r(25),i=r.n(n),a=r(42),o=r.n(a),s=r(0),l=r.n(s),u=r(3),c=r.n(u),h=r(1715),d=function(){function e(t){var r=this;l()(this,e),this.timenNode=t,t.delegate&&console.error("use AeoDelegate in the wrong place."),t.delegate=this,t.hasCustomDelegate?(t.customAtomDelegate.listener.on("onForward",(function(e){return r.__onForward(e)})),t.customAtomDelegate.listener.on("onBackward",(function(e){return r.__onBackward(e)}))):(t.listener.on("onForward",(function(e){return r.__onForward(e)})),t.listener.on("onBackward",(function(e){return r.__onBackward(e)})))}return c()(e,[{key:"__onForward",value:function(e){e.isForward=!0,this.childsBuildTree()}},{key:"__onBackward",value:function(e){e.isForward=!1,this.childsBuildTree()}},{key:"childsBuildTree",value:function(){for(var e=this.timenNode,t=e.childs,r=0;r<t.length;r++){var n=t[r];n.parent||(n.buildTree?n.buildTree(e):n.parent=e)}}}]),e}(),p=r(201),f=r(446),v=r(262),y=r(315),g=r(875),m=r(268),_={fill:3,timeFilter:null,nodeType:null,nodePlaceholder:!1,restart:null,direction:0,display:null,eventFilter:null,runtimeContext:null,isOverride:!1,valueType:-1,animTo:null,groupId:0,additive:-1,attrName:-1,paraStart:-1,paraEnd:-1,subItem:0,textParagragh:null,textRangeType:-1,graphicElType:-1,dgmBld:null,dgmStep:-1,autoReverse:null},S={duration:"indefinite",speed:1,repeat:1,accelerate:0,decelerate:0,restart:null,rewindAtEnd:null,smoothStart:null,smoothEnd:null,autoReverse:!1,triggerType:null,triggerObjId:-1,delay:0},T=function(){function e(t){l()(this,e),this.delegate=new d(this),this.private=t.data||{},this.data_token=Object(y.a)(),this.tree_token=this.data_token,Object(g.a)(this)}return c()(e,[{key:"buildTree",value:function(t){var r=this;this.parent=t,this.childs.forEach((function(t){t instanceof e&&t.buildTree(r)})),this.private.container.core=this}},{key:"_bubbleUpEvent",value:function(e,t){v.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(y.a)():this.tree_token=Object(y.a)());var r=this.parent;if(r&&r._bubbleUpEvent){if(e===v.default.collect_path){t.nodePath||(t.nodePath=[]);var n=this.getIndex();null!==n&&t.nodePath.unshift(n)}r._bubbleUpEvent(e,t)}}},{key:"_fireChanged",value:function(e){this._bubbleUpEvent(v.default.animation_notify,{data:this,op:e})}},{key:"_onDataChanged",value:function(e,t){this._bubbleUpEvent(v.default.animation_notify,{data:this,opType:e,opvalue:t})}},{key:"setTxtRangeType",value:function(e){this.txtRangeType=e}},{key:"getType",value:function(){return this.private.type}},{key:"getParent",value:function(){return this.parent}},{key:"getNodeType",value:function(){return this.private.nodeType}},{key:"getTargetShapeId",value:function(){return this.private.targetShapeId}},{key:"getIsNodePlaceHolder",value:function(){return this.private.nodePlaceholder}},{key:"getIndex",value:function(){var e=this.parent;return e&&e.subNodeIndex&&e.subNodeIndex(this)}},{key:"subNode",value:function(e){return this.childs[e]}},{key:"subNodeIndex",value:function(e){for(var t=this.childs,r=0,n=t.length;r<n;r++){if(e===t[r])return r}return-1}},{key:"insertSubNode",value:function(e,t){this.container.insert(e,t)}},{key:"moveSubNode",value:function(e,t){var r=void 0;if(e>t)r=t-e;else{if(!(e<t))return!1;r=t-e+1}return-1!==this.container.move(e,r)}},{key:"deleteSubNode",value:function(e){this.container.removeAt(e)}},{key:"deleteAll",value:function(){for(var e=0;e<this.length;++e){this.subNode(e)&&this.deleteSubNode(e--)}}},{key:"setProperty",value:function(e,t){this.setPropertyValue(e,t)}},{key:"setPropertyBatch",value:function(e){return this.modifyProperties(e)}},{key:"_modifyPrivate",value:function(e,t,r){this.setPropertyValue(e,r?Object(m.a)(t):t);var n={};return t?n[e]=r?Object(m.a)(t):t:n.undefineds=[e],{newval:n}}},{key:"getRepeatCount",value:function(){return this.private.repeat}},{key:"defaultValue",get:function(){return _}},{key:"childs",get:function(){var e=this.private.container;if(!e){this.private.container=new h.a({data:[]}),e=this.private.container}return e.core||(e.core=this),e.vector}},{key:"container",get:function(){var e=this.private.container;if(!e){this.private.container=new h.a({data:[]}),e=this.private.container}return e.core||(e.core=this),e}},{key:"length",get:function(){return this.childs.length}}]),e}(),b=function(e){function t(e){l()(this,t);var r=i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.private=e.data||{},r}return o()(t,e),c()(t,[{key:"setDuration",value:function(e){var t=this.getDuration();if("indefinite"===t||t<=0)for(var r=0;r<this.length;r++){var n=this.subNode(r),i=n.getDuration();Math.abs(i-.001)>5e-5&&Math.abs(i)>5e-5&&(i>.001?n.setProperty("duration",1e3*e):n.setProperty("duration",500))}}},{key:"setSpeed",value:function(e){return this.setDuration(e)}},{key:"defaultValue",get:function(){return Object.assign({},_,S)}}]),t}(T);Object(f.e)(T.prototype,!1),Object(p.makePropertyFunctions)(_,T.prototype),Object(p.makePropertyFunctions)(Object.assign({},_,S),b.prototype)},1270:function(e,t,r){"use strict";function n(e,t){if(e.localCommitedVersion.length>0)for(var r=0;r<e.applyVersions.length;++r){var n=e.applyVersions[r];if(n.isSelf){for(var i={applyVersions:[],resetBaseVersions:[]},a=0;a<=r;++a){var o=e.applyVersions[a];o.isSelf||i.applyVersions.push(o)}for(var s=0;s<e.resetBaseVersions.length;++s){var l=e.resetBaseVersions[s];l.isSelf||l.taskVer>n.taskVer||i.resetBaseVersions.push(l)}0===i.applyVersions.length&&0===i.resetBaseVersions.length||t(n.extRanges,i)}}}function i(e,t){var r=e.applyVersions.length,n=e.resetBaseVersions.length;if(r>0&&n>0)for(var i=0;i<r;++i)for(var a=e.applyVersions[i],o=0;o<n;++o){var s=e.resetBaseVersions[o];if(a.bornTaskVer===s.bornTaskVer||a.bornTaskVer===s.taskVer){for(var l={applyVersions:[],resetBaseVersions:[]},u=0;u<i;++u)l.applyVersions.push(e.applyVersions[u]);for(var c=0;c<o;++c)l.resetBaseVersions.push(e.resetBaseVersions[c]);(l.applyVersions.length>0||l.resetBaseVersions.length>0)&&t(a.extRanges,l);break}}}function a(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={applyVersions:[],resetBaseVersions:[]},i=0;i<t.applyVersions.length;++i){var a=t.applyVersions[i];(r||!a.isSelf)&&a.taskVer>e.taskVer&&n.applyVersions.push(a)}for(var o=0;o<t.resetBaseVersions.length;++o){var s=t.resetBaseVersions[o];if((r||!s.isSelf)&&s.taskVer>e.taskVer){for(var l=!1,u=0;u<t.applyVersions.length;++u){var c=t.applyVersions[u];if(c.bornTaskVer===s.bornTaskVer||c.bornTaskVer===s.taskVer){l=!0;break}}l||n.resetBaseVersions.push(s)}}return n}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}))},1284:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(268),l=r(724),u=r(470),c=function(){function e(t){i()(this,e),this.private=t?t.data:{}}return o()(e,[{key:"clone",value:function(){return new e(Object(s.a)(this.type))}},{key:"shadowClone",value:function(){var t=this.private,r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return new e({data:r})}},{key:"getPaths",value:function(){return this.private.paths}},{key:"setPaths",value:function(e){this.private.paths=e}},{key:"isCustomGeometry",value:function(){return null!=this.private.paths}},{key:"hasGeometry2DData",value:function(){return null!=this.getGeometrySvrObj()}},{key:"isClosedCurve",value:function(){if(!this.isCustomGeometry())return!1;var e=this.getPaths(),t=e&&e[0];return!!t&&(t.commands&&t.commands.slice(-1)[0]===l.d.Close)}},{key:"setEnv",value:function(e,t){this.geometry=e,this.sink=t}},{key:"interpretPath",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.sink&&this.geometry){var n=this.sink;return this.geometry.interpretPathList(n,e,t,r),n.pathList}console.warn("this Geomerty is not set environment")}},{key:"setDataToken",value:function(e){this.dataToken=e}},{key:"getDataToken",value:function(){return this.dataToken}},{key:"setAdjustValues",value:function(e){this.type&&(this.type.data.hasOwnProperty("adjustValues")||(this.type.data.adjustValues={}),this.type.data.adjustValues=e)}},{key:"getGeometry",value:function(){if(this.geometry)return this.geometry;console.error("geomerty is not interpret!!")}},{key:"getGeometryType",value:function(){var e=this.type.data;return e&&e.presetType?e.presetType:null}},{key:"setProp",value:function(e,t){e&&t&&(this.type.data[e]=t)}},{key:"getGeometrySvrObj",value:function(){return this.type}},{key:"isPathsAttributesHasWH",value:function(){for(var e=this.geometry.geometry.definition.paths,t=0;t<e.length;t++){var r=e[t];return r.attributes&&r.attributes.w&&r.attributes.h}}},{key:"getDefinition",value:function(){return this.geometry&&this.geometry.getDefinition()}},{key:"calcRefXAdjMax",value:function(e,t,r,n){var i=void 0,a=void 0;e.isPolar?(a=e.maxR,i="gdRefR"):(a=e.maxX,i="gdRefX");var o={};return o[e[i]]=a,this.updateAdjXY(r,n,t,o)}},{key:"calcRefXAdjMin",value:function(e,t,r,n){var i=void 0,a=void 0;e.isPolar?(a=e.minR,i="gdRefR"):(a=e.minX,i="gdRefX");var o={};return o[e[i]]=a,this.updateAdjXY(r,n,t,o)}},{key:"calcRefYAdjMax",value:function(e,t,r,n){var i=void 0,a=void 0;e.isPolar?(a=e.maxAng,i="gdRefAng"):(a=e.maxY,i="gdRefY");var o={};return o[e[i]]=a,this.updateAdjXY(r,n,t,o)}},{key:"calcRefYAdjMin",value:function(e,t,r,n){var i=void 0,a=void 0;e.isPolar?(a=e.minAng,i="gdRefAng"):(a=e.minY,i="gdRefY");var o={};return o[e[i]]=a,this.updateAdjXY(r,n,t,o)}},{key:"updateAdjXY",value:function(e,t,r,n){var i=this.getDefinition(),a=this.geometry.getNameTable(),o=void 0;o=a.w==e&&a.h==t?a:new i.Guides,Object.assign(o,{w:e,h:t},this.adjustValues,n);var s=i.adjustHandles[r],l=s.x,u=s.y;return"string"==typeof l&&(l=o[l]),"string"==typeof u&&(u=o[u]),{x:l,y:u}}},{key:"calcAdjustValue",value:function(e,t,r,n){if(!this.geometry)return[];var i=!1,a=!1,o=t.isPolar;switch(this.getAdjType(t)){case l.a.gdRefR:o=!0;case l.a.gdRefX:i=!0;break;case l.a.gdRefAng:o=!0;case l.a.gdRefY:a=!0;break;case l.a.gdRefPolar:o=!0;case l.a.gdRefXY:i=a=!0}var s=[];return i&&s.push(this.updateAdjustValueForRefX(e,t,r,n,o)),a&&s.push(this.updateAdjustValueForRefY(e,t,r,n,o)),s}},{key:"getAdjType",value:function(e){return e.gdRefX&&e.gdRefY?l.a.gdRefXY:e.gdRefX?l.a.gdRefX:e.gdRefY?l.a.gdRefY:e.gdRefR&&e.gdRefAng?l.a.gdRefPolar:e.gdRefR?l.a.gdRefR:e.gdRefAng?l.a.gdRefAng:void console.warn("may adj type has a error")}},{key:"updateAdjustValueForRefX",value:function(e,t,r,n,i){var a=null!=t.maxX?t.maxX:t.maxR,o=null!=t.minX?t.minX:t.minR,s=this.calcRefXAdjMin(t,r,n.width,n.height),l=this.calcRefXAdjMax(t,r,n.width,n.height),u=s.x,c=l.x,h=e.x,d=t.gdRefX;return i&&(u=this.cartToPolar(s,n).x,c=this.cartToPolar(l,n).x,h=this.cartToPolar(e,n).x,d=t.gdRefR),{name:d,value:this.calcAjustValue(h,u,c,o,a)}}},{key:"updateAdjustValueForRefY",value:function(e,t,r,n,i){var a=null!=t.maxY?t.maxY:t.maxAng,o=null!=t.minY?t.minY:t.minAng,s=this.calcRefYAdjMin(t,r,n.width,n.height),l=this.calcRefYAdjMax(t,r,n.width,n.height),u=s.y,c=l.y,h=e.y,d=t.gdRefY,p=void 0;return i?(u=this.cartToPolar(s,n).y,c=this.cartToPolar(l,n).y,h=this.cartToPolar(e,n).y,d=t.gdRefAng,"circularArrow"===this.getGeometryType()&&(c=this.recalcForCircularArrow(d,u,c)),p=this.calcAngelAdjustValue(h,u,c,o,a)):p=this.calcAjustValue(h,u,c,o,a),{name:d,value:p}}},{key:"cartToPolar",value:function(e,t){var r=e.x-t.width/2,n=e.y-t.height/2,i=Math.sqrt(r*r+n*n),a=Math.atan2(n,r);return a<0&&(a+=2*Math.PI),{x:i,y:a}}},{key:"calcAjustValue",value:function(e,t,r,n,i){if(a=t-r,Math.abs(a)<=1e-12)return n;var a,o=Math.min(t,r),s=Math.max(t,r);return e<o?e=o:e>s&&(e=s),n+(e-t)*(i-n)/(r-t)}},{key:"calcAngelAdjustValue",value:function(e,t,r,n,i){var a,o,s;return s=r,(a=e)>=(o=t)&&a<=s||o>s&&(a<=2*Math.PI&&a>=o||a>=0&&a<=s)||(e=r),t>r&&(e>=t&&(e-=2*Math.PI),t-=2*Math.PI),n+(e-t)*(i-n)/(r-t)}},{key:"recalcForCircularArrow",value:function(e,t,r){return"adj3"===e&&Math.abs(t-r)<.001&&(r+=2*Math.PI),r}},{key:"interpretShapeSize",value:function(e,t){if(e&&t)return this.geometry.interpretShapeSize(e,t,u)}},{key:"interpretTextBoxRect",value:function(e,t){return this.geometry.interpretTextBoxRect(e,t)}},{key:"isGeometry2D",get:function(){return!0}},{key:"type",get:function(){return{data:this.private}}},{key:"adjustValues",get:function(){return this.geometry?this.geometry.adjustValues:this.type&&this.type.data&&this.type.data.adjustValues?this.type.data.adjustValues:(console.warn("geomerty is not interpret!!"),{})}}]),e}();t.a=c,Math.sqrtFix=function(e){return e<0?0:this.sqrt(e)}},1383:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return l}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=function(){function e(t){i()(this,e),this._tags=t}return o()(e,[{key:"setTags",value:function(e){e&&(this._tags=e)}},{key:"getTags",value:function(){return this._tags}},{key:"getTemplateCategory",value:function(){return this._getTag("KSO_WM_TEMPLATE_CATEGORY")}},{key:"getTemplateIndex",value:function(){return this._getTag("KSO_WM_TEMPLATE_INDEX")}},{key:"getDiagramGroupCode",value:function(){return this._getTag("KSO_WM_DIAGRAM_GROUP_CODE")}},{key:"getUnitTypeCode",value:function(){return this._getTag("KSO_WM_UNIT_TYPE")}},{key:"getUnitSerialNo",value:function(){var e=this._getTag("KSO_WM_UNIT_INDEX");return e||(e=this.getSimulateUnitSerialByUnitType()),e}},{key:"getSimulateUnitSerialByUnitType",value:function(){var e=this.getUnitTypeCode();if(e){for(var t="",r=e.split("_").length-1;r>-1;--r)t+="1_";return t.splice(t.length-1,1)}return"1"}},{key:"isDiagramShape",value:function(){var e=this.getUnitTypeCode(),t=e&&e.split("_")[0]||"";return"l"===t||"m"===t||"n"===t||"o"===t||"p"===t||"q"===t||"r"===t||""===t||""===t||""===t}},{key:"isSameDiagram",value:function(e){return this.getRootDiagramId()===e.getRootDiagramId()}},{key:"getDiagramId",value:function(){return(this.getTemplateCategory()||"diagram")+"*"+this.getTemplateIndex()+"*"+this.getDiagramGroupCode()+"*"+this.getUnitTypeCode()+"*"+this.getUnitSerialNo()}},{key:"getRootDiagramId",value:function(){var e=this.getTemplateCategory()||"diagram",t=this.getTemplateIndex(),r=this.getDiagramGroupCode(),n=this.getUnitTypeCode(),i=n&&n.split("_")[0]||"",a=this.getUnitSerialNo();return e+"*"+t+"*"+r+"*"+i+"*"+(a&&a.split("_")[0]||"")}},{key:"_getTag",value:function(e){if(this._tags)for(var t=0;t<this._tags.length;++t){var r=this._tags[t];if(r.name===e)return r.value}}}]),e}(),l=function(){function e(){i()(this,e)}return o()(e,null,[{key:"getDiagramGroup",value:function(e){if(null!=e){var t=e.getShapeTree();if(t){for(var r={},n=function(e){e.forEach((function(e){if(e.isDiagramShape()){var t=new s(e.getTags()).getRootDiagramId();r[t]=r[t]||[],r[t].push(e)}}))},i=t.private.childs,a=0;a<i.length;++a){var o=i[a];if(o.hasTags())if(o.isGroupShape())n(o.getChildShapesRecurse());else n([o]);else if(o.isGroupShape())for(var l=o.getChildShapesRecurse(),u=0;u<l.length;++u){var c=l[u];c.hasTags()&&n([c])}}var h=function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isChildShape()){var n=r.visual.getRootShape();e.includes(n)||e.push(n),e.splice(t--,1)}}};for(var d in r){h(r[d])}return r}}}},{key:"isDiagramShape",value:function(e){if(!e)return!1;var t=e.getTags();return new s(t).isDiagramShape()}},{key:"isDiagramSubShape",value:function(t,r){return null!=e.getRootDiagramId(t,r)}},{key:"getRootDiagramId",value:function(t,r){if(!t||!r)return null;if(!r.hasTags()){if(!r.isGroupShape())return;var n=r.getChildShapesRecurse((function(e){var t=e.getTags();return!!t&&"diagram"===new s(t).getTemplateCategory()}));if(null==n||0===n.length)return}var i=function e(t,r){if(!r.isGroupShape())return t.getId()===r.getId();for(var n=r.childShapes,i=0;i<n.length;++i)if(e(t,n[i]))return!0},a=e.getDiagramGroup(t);for(var o in a)for(var l=a[o],u=0;u<l.length;++u){if(r.getId()===l[u].getId())return o;if(l[u].isGroupShape()&&i(r,l[u]))return o}}}]),e}()},1384:function(e,t,r){"use strict";var n=r(44),i=r.n(n),a=r(0),o=r.n(a),s=r(3),l=r.n(s),u=r(25),c=r.n(u),h=r(154),d=r.n(h),p=r(42),f=r.n(p),v=r(1149),y=r(1014),g=r(262),m=r(470),_=r(167),S=r(1284),T=r(927),b=r(315),k=r(268),C=r(762),w=r(1146),P=r(1866),x=r(606),O=function(e){function t(e){return o()(this,t),c()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return f()(t,e),l()(t,[{key:"_matchPhShapeCommon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var r=e.getPlaceHolder(),n=this.childShapes,i=C.a.phTypeFollowCommon(r,t);if(!t&&i&&i===_.PlaceholderType.Title&&r.index&&4294967295===r.index)return null;for(var a=n.length,o=0;o<a;++o){var s=n[o];if(!s.isGroupShape()&&s.isPlaceHolder()){var l=s.getPlaceHolder(),u=C.a.phTypeFollowCommon(l);if(this.__isPlaceholderMatch({placeholder:r,phType:i,masterPh:l,masterPhType:u,bFollowMaster:t}))return s}}return null}},{key:"_matchShapesFollowing",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return[];for(var n=[],i=e.getPlaceHolder(),a=C.a.phTypeFollowCommon(i),o=this.childShapes,s=o.length,l=0;l<s;++l){var u=o[l];if(!u.isGroupShape()&&u.isPlaceHolder()){var c=u.getPlaceHolder(),h=C.a.phTypeFollowCommon(c);if(this.__isPlaceholderMatch({placeholder:c,phType:h,masterPh:i,masterPhType:a,bFollowMaster:t})&&(n.push(u),!r))break}}return n}},{key:"__isPlaceholderMatch",value:function(e){var t=e.placeholder,r=e.phType,n=e.masterPh,i=e.masterPhType,a=e.bFollowMaster;if(!a&&r&&r===_.PlaceholderType.Title&&t.index&&4294967295===t.index)return!1;if(r===_.PlaceholderType.Body&&i===_.PlaceholderType.Body){if(a||t.index&&n.index&&t.index===n.index)return!0;if(C.a.phEqual(t,n)&&!t.index&&!n.index)return!0}else if(!a&&r===_.PlaceholderType.SlideNumber&&t.index&&n.index){if(-1!==t.index&&t.index===n.index)return!0}else if(r==i){if(a||r===_.PlaceholderType.Title)return!0;if(t.index){if(n.index&&t.index===n.index)return!0}else if(!n.index)return!0}return!1}},{key:"_bubbleUpEvent",value:function(e,t){g.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(b.a)():this.tree_token=Object(b.a)());var r=this.parent;r&&r._bubbleUpEvent&&r._bubbleUpEvent(e,t)}},{key:"insertShape",value:function(e,t){var r=null,n=t.rect,i=t.bDefCreate,a=t.bCopyDefProps,o=_.ShapeTreeInsertCommandTypes;if(e===o.InsertShape){if(m.ShapeGroupItems[t.group]){var s=m.ShapeGroupItems[t.group],l=s.types[t.item];if(Object.isEmpty(l))return void console.error("Invalid insert shape: group",t.group,", item",t.item);if(null==i||!0===i){var u=m.shapeDefaultSize(l);n.width=914400*u.w/1440,n.height=914400*u.h/1440}var c=m.ShapeCreateFunctions[s.funcIdx[t.item]];switch(console.log("create shape use func:",c),c){case"createLine":r=this._createLine(l,n,a);break;case"createConnectorArrow":r=this._createLineArrow(l,n,a);break;case"createConnectorDoubleArrow":r=this._createLineDoubleArrow(l,n,a);break;case"createCustomGeometryShape":r=this._createCustomGeometryShape(l,n,!1,a);break;case"createNormalShape":r=this._createNormalShape(l,n,a);break;case"createTextBox":t.orientation=0===t.item?"horizontal":"vertical",r=this._createTextBox(0,n,i,a,t.orientation);break;case"createHollowOutShape":r=this._createHollowOutShape(l,n,a);break;case"createArcShape":r=this._createArcShape(l,n,a);break;default:console.error("Not found shape creator function!")}}}else e===o.InsertTextBox?r=this._createTextBox(1,n,i,a,t.orientation):e===o.InsertPicture?r=this._createPicture(n,t.uploadId):e===o.InsertProcessOn?r=this._createProcessOn(n,t.uploadId,t.category,t.fileId,t.definition):e===o.InsertInk?r=this._createInk(t):e===o.InsertTable?r=this._createTable(n,t.rows,t.cols,t.style,t.phShape):e===o.InsertMedia?r=this._createMedia(t.dataType,t.mediaType,t.mediaSubType,n,t.uploadId||t.mediaId):e===o.InsertSvgPicture&&(r=this._createSvgPicture(n,t.svgData));return null!=r&&(this.push(r),r.buildTree?r.buildTree(this):r.parent=this),r}},{key:"_getThemeProp",value:function(e,t){var r=this.visual.getTheme(),n=r?r.data():{};return n[e]?Object(k.a)(n[e]):t}},{key:"_makeLineProperties",value:function(e){e.private.style=this._getThemeProp("defaultLine",{shapeStyle:{lineIndex:1,lineColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000"},fillIndex:0,fillColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000"},effectsIndex:0,effectsColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000"},fontIndex:2,fontColor:{type:3,isAutoColor:!1,scheme:13,toRGB:"#ff000000"}}}).shapeStyle}},{key:"_makeNormalProperties",value:function(e){e.private.style=this._getThemeProp("defaultShape",{shapeStyle:{lineIndex:2,lineColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000",transOp:[{op:26,val:.5}]},fillIndex:1,fillColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000"},effectsIndex:0,effectsColor:{type:3,isAutoColor:!1,scheme:4,toRGB:"#ff000000"},fontIndex:2,fontColor:{type:3,isAutoColor:!1,scheme:1,toRGB:"#ff000000"}}}).shapeStyle}},{key:"_makeTextBoxProperties",value:function(e){var t=this._getThemeProp("defaultTextBox");t&&(e.private.style=t.shapeStyle)}},{key:"_makeLableProperties",value:function(e){var t=this._getThemeProp("defaultTextBox");t&&(e.private.style=t.shapeStyle)}},{key:"_createLine",value:function(e,t,r){var n=this._createNewShape(e,t);return n&&r&&this._makeLineProperties(n),n}},{key:"_createLineArrow",value:function(e,t,r){var n=this._createNewShape(e,t);return n&&(r&&this._makeLineProperties(n),n.private.outline=n.private.outline||{tailEnd:{type:5}}),n}},{key:"_createLineDoubleArrow",value:function(e,t,r){var n=this._createNewShape(e,t);return n&&(r&&this._makeLineProperties(n),n.private.outline=n.private.outline||{headEnd:{type:5},tailEnd:{type:5}}),n}},{key:"_createNormalShape",value:function(e,t,r){var n=this._createNewShape(e,t);if(n){var i=this.parent,a=i&&i.getPresentation(),o=T.a.createNewTextFrame(a);o.private.textStream.private.papTbl=T.a._createPropTbl({alignMode:2}),n.private.childs[0]=o,r&&this._makeNormalProperties(n)}return n}},{key:"_createArcShape",value:function(e,t,r){var n=this._createNewShape(e,t);if(n){var i=this.parent,a=i&&i.getPresentation(),o=T.a.createNewTextFrame(a);o.private.textStream.private.papTbl=T.a._createPropTbl({alignMode:2}),n.private.childs[0]=o,r&&this._makeLineProperties(n)}return n}},{key:"_createInk",value:function(e){var t=e.rect,r=m.PresetShapeType.ShapeInk,n=this._createNewShape(r,t);return n.private.isInk=!0,(new w.b).createInkShape(n,e),n}},{key:"_createTable",value:function(e,t,r,n,a){var o=this.parent,s=o&&o.getPresentation(),l={x:0,y:0,width:200,height:200,horizontalFlipped:!1,rotation:0,verticalFlipped:!1};if("object"===(void 0===e?"undefined":i()(e))){var u=e,c=u.x,h=u.y,d=u.width,p=u.height;Object.assign(l,{x:c,y:h,width:d,height:p})}var f=this.createNewShape(s);if(f){f.private.transform2D=l,f.private.rect=f.visual.getAnchorRect().getAlignedBounds();var v=null;if(a){var y=a.visual.getAnchorRect(),g=y.width(),m=600*t;e={x:y.x(),y:y.y(),width:g,height:m},e=x.a.create(e),f.visual.setAnchorRect(e)}v=n?P.a.createTableFrame(s,f,t,r,n):P.a.createTableFrameNoStyle(s,f,t,r),f.private.modelType=_.ShapeModeType.MODEL_OBJTABLE,f.private.childs[0]=v}return f}},{key:"_createCustomGeometryShape",value:function(e,t,r,n){var i=this._createNewShape(m.PresetShapeType.ShapeCustom,t);if(i){var a=this.parent,o=a&&a.getPresentation(),s=T.a.createNewTextFrame(o);s.private.textStream.private.papTbl=T.a._createPropTbl({alignMode:2}),i.private.childs[0]=s,n&&this._makeNormalProperties(i),r||(i.private.fill={type:0})}return i}},{key:"_createTextBox",value:function(e,t,r,n,i){Object.isEmpty(r)&&(r=!0);var a=this._createNewShape(m.PresetShapeType.ShapeRectangle,t);if(a){var o=this.parent,s=o&&o.getPresentation(),l=T.a.createNewTextFrame(s);a.private.childs[0]=l,a.private.fill={type:0},n&&(0===e?this._makeTextBoxProperties(a):this._makeLableProperties(a));var u=a.private.childs[0].private.prop;(1440===t.width&&1440===t.height||r)&&(u.textWrap=0,r=!0);var c=459740,h=218440;"horizontal"===i?(c=309880,h=368300):u.verticalType=m.TextVerticalType.EastAsianVer,u.autoFit=m.TextAutoFitType.AdvancedAutoFit;var d=a.private.transform2D,p=a.private.rect;"horizontal"===i?(t.height=h,d.height=h,p.bottom=(d.y+d.height)/635):(t.width=c,d.width=c,p.right=(d.x+d.width)/635),r&&(t.width=c,t.height=h,d.width=c,d.height=h,"horizontal"===i?(p.right=(d.x+d.width)/635,p.bottom=(d.y+d.height)/635):(d.x=d.x-d.width/2,p.left=d.x/635,p.right=(d.x+d.width)/635,p.bottom=(d.y+d.height)/635))}return a}},{key:"_createHollowOutShape",value:function(e,t,r){var n=this._createNormalShape(e,t,r);n&&(n.private.childs[0].private.textStream.private.chpTbl.private.data.private[0].private.prop.private.textColor={type:2,color:{toRGB:"#ff000000",type:3,isAutoColor:!1,scheme:13}});return n}},{key:"_createPicture",value:function(e,t){var r=this._createNewShape(m.PresetShapeType.ShapeRectangle,e);return r&&(delete r.private.fill,r.private.picture={blip:{blipAtom:{imageId:t}},isStretched:!0,type:m.PresetShapeType.ShapeRectangle}),r}},{key:"_createProcessOn",value:function(e,t,r,n,i){var a=this._createPicture(e,t);return a&&(a.private.extData={isProcessOn:!0}),a}},{key:"_createMedia",value:function(e,t,r,n,i){var a=this._createNewShape(m.PresetShapeType.ShapeRectangle,n);return a&&(delete a.private.fill,a.private.picture={blip:{},isStretched:!0,type:m.PresetShapeType.ShapeRectangle},a.private.media=Object.assign({mediaId:i},{dataType:e,mediaType:t,mediaSubType:r,isEmbed:!0})),a}},{key:"_createSvgPicture",value:function(e,t){var r=this._createNewShape(m.PresetShapeType.ShapeRectangle,e);return r&&(delete r.private.fill,r.private.picture={blip:{blipAtom:{imageId:t}},isStretched:!0,type:m.PresetShapeType.ShapeRectangle}),r}},{key:"_createNewShape",value:function(e,t){if(void 0===e)return null;var r=m.PresetShapeType,n=this.parent,a=n&&n.getPresentation();if(!n)return null;var o=a.allocateLocalId(),s=null;if(e>=r.ShapeBegin&&e<r.ShapeCustom)s=new S.a({data:{presetType:m.PresetShapeInfo[e].text},id:o,type:1}),e===r.ShapeBegin||e>=r.ShapeStraightConnector1&&r.ShapeCurvedConnector5;else if(e===r.ShapeCustom)s=new S.a({data:{presetType:m.PresetShapeInfo[e].text,paths:[{attributes:{},commands:[],argumentIndices:[],arguments:[]}]},id:o,type:1});else if(e===r.ShapeInk);else r.VmlShapeBegin;var l={x:0,y:0,width:200,height:200,horizontalFlipped:!1,rotation:0,verticalFlipped:!1};if("object"===(void 0===t?"undefined":i()(t))){var u=t.x,c=t.y,h=t.width,d=t.height;Object.assign(l,{x:u,y:c,width:h,height:d})}var p=this.createNewShape(a);return p.private.transform2D=l,s&&(p.private.geometry2D=s),p.private.rect=p.visual.getAnchorRect().getAlignedBounds(),p}},{key:"createNewShape",value:function(e){var t=e.allocateLocalId(),r={data:{shapeId:t,shape:!0,childs:[]},id:t,type:3},n=new y.a(r);return n._isLocalNew=!0,n}},{key:"deleteShape",value:function(e){var r=this.getSlide();return r&&"slides"===r.getCategory()&&e.isPlaceHolder()&&e.hasContent()?this._deletePhShape(e):d()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deleteShape",this).call(this,e)}},{key:"_deletePhShape",value:function(e){if(!e.isHeaderFooterShape()){var r=e.getSlideFollowing().matchPhShapeCommon(e);if(r){var n=this.parent,i=n&&n.getPresentation(),a=this.createNewShape(i);if(!a)return null;if(a.setPlaceholder(r.getPlaceHolder()),r.getTextFrame()&&!C.a.isFakeTextFramePh(r)){var o=T.a.clone(i,r.getTextFrame());a.private.childs[0]=o}var s=this.getShapeIndex(e);return this.remove(e),this.insert(s,a),a}}return d()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deleteShape",this).call(this,e),null}},{key:"isShapeTree",get:function(){return!0}},{key:"isShape",get:function(){return!1}}]),t}(v.default);t.a=O},1512:function(e,t,r){"use strict";r.d(t,"h",(function(){return ot})),r.d(t,"i",(function(){return st})),r.d(t,"n",(function(){return wt})),r.d(t,"o",(function(){return Pt})),r.d(t,"g",(function(){return gt})),r.d(t,"d",(function(){return R.a})),r.d(t,"j",(function(){return I.a})),r.d(t,"k",(function(){return L})),r.d(t,"l",(function(){return N})),r.d(t,"f",(function(){return M.a})),r.d(t,"e",(function(){return H})),r.d(t,"c",(function(){return mt})),r.d(t,"b",(function(){return pt.a})),r.d(t,"a",(function(){return _t.a})),r.d(t,"m",(function(){return St.c}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(1132),l=r(304),u=r(1860),c=r(25),h=r.n(c),d=r(42),p=r.n(d),f=r(154),v=r.n(f),y=r(543),g=r(268),m=r(167),_=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",r).call(r),r.buddy=e,r}return p()(t,e),o()(t,[{key:"_fireChanged",value:function(){}},{key:"fetchBackendShapeHelper",value:function(e){var t=this.buddy.fetchShape(e,!0);return t?t.ensureBackendHelper():null}},{key:"getFetchFunc",value:function(e,t){var r=this,n=this,i=null,a=null,o=null,s=t||{},l=s.forAll,u=s.onlyBackend;switch(e){case"txtStrmInsert":case"txtStrmDelete":case"txtStrmFmtChpxV2":case"txtStrmFmtPapxV2":i=function(e){return n.buddy.fetchTextStream(e,!1)};break;case"modifyShapeProps":u||(i=function(e){return n.buddy.fetchShape(e,!1)}),o=function(e){var t=r.buddy.fetchShape(e,!1);if(t&&t.hasChart())return t.ensureBackendHelper()};break;case"shapeDelete":i=function(e){return n.buddy.fetchShape(e,!1)};break;case"modifySlideProps":a=function(e){return n.buddy.fetchSlide(e)};break;case"txtStrmFmtChpx":case"txtStrmFmtPapx":l&&(i=function(e){return n.buddy.fetchTextStream(e,!1)});break;case"slideDelete":case"slideInsert":case"slideMove":l&&(a=function(e){return n.buddy.fetchSlide(e)});break;case"paste":case"modifySlideLayout":break;case"woChart":i=function(e){return n.fetchBackendShapeHelper(e)};break;default:l&&(i=function(e){return n.buddy.fetchShape(e,!1)})}return{fetchObject:i,fetchSlide:a,fetchBackendHelper:o}}},{key:"doOperate",value:function(e,t,r){for(var n=e.data.param,i=this.getFetchFunc(e.data.name,r),a=i.fetchObject,o=i.fetchSlide,s=i.fetchBackendHelper,l=n.category,u=n.layerType,c=n.shapes,h=n.slideIdx,d=n.execToken,p=[{fetchFunc:a,onError:function(e){console.warn("Not found target shape:",e)}},{fetchFunc:s,onError:function(e){}}],f=0;f<p.length;f++){var v=p[f],y=v.fetchFunc,g=v.onError;if(y)if(c instanceof Array&&c.length>0)for(var m=0;m<c.length;m++){var _=c[m],S=_.slideIdx>=0?_.slideIdx:h;_.slideIdx=S,_.slideIndex=S,_.category=_.category||l,_.layerType=_.layerType||u;var T=y(_);if(T){var b=Object.assign({execToken:d},_,_.props);b.shapePath=_.shapePath.slice(0),t({obj:T,name:e.data.name,param:b})}else g&&g(_)}else{var k=y(n);k&&t({obj:k,name:e.data.name,param:n})}}var C=n.slideProps;if(o&&C){var w=o(n);w&&t({obj:w,name:e.data.name,param:n})}}}]),t}(y.a);function S(e){var t=[];if(e&&""!==e)for(var r=e.split(","),n=0;n<r.length;n++)t.push(parseInt(r[n],16));return t}var T=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));v()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",r).call(r);var n=r;n.private=e.data||{},n.private.objID=e.id,n.pres=null,n.helper=new _(n),n.newobjIds=null;var a=n.private;return a.globalPalette=S(a.globalPalette),a.presetColors=S(a.presetColors),r}return p()(t,e),o()(t,[{key:"isTopObject",value:function(){return!0}},{key:"isMainObject",value:function(){return!0}},{key:"isNewestObject",value:function(e){return e.newest||e.__isNew||this.newobjIds&&this.newobjIds.has(e.objID)}},{key:"removeNewestFlag",value:function(e){e&&(e.newest=null,e.__isNew=null,this.newobjIds&&this.newobjIds.delete(e.objID))}},{key:"addNewestFlag",value:function(e){e&&(this.newobjIds||(this.newobjIds=new Set),this.newobjIds.add(e.objID))}},{key:"getObjID",value:function(){return this.private.objID}},{key:"init",value:function(e){this.pres=e}},{key:"getPresentation",value:function(){return this.pres}},{key:"setNewObjectIds",value:function(e){this.newobjIds=e}},{key:"setOrgObjectIds",value:function(e){this.orgObjIds=e}},{key:"getFetchFunc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.forAll=!0,this.helper.getFetchFunc(e,t)}},{key:"_forwardHelper",value:function(e,t){var r=[],n=this;return this.helper.doOperate(e,(function(e){var t=e.obj,i=e.name,a=e.param;if(!a._bInvalidRange){var o={obj:t,data:[{name:i,param:Object(g.a)(a)}]};t.buddy=n,r.push(o)}}),t),r}},{key:"forward",value:function(e){var t={objType:e.objType,data:[]},r=e.data.param;switch(e.data.name){case"RECORDS":return t.obj=this,t.data={name:e.data.name,param:r,isRecordOperate:!0},[t];case"txtStrmInsert":case"txtStrmDelete":case"txtStrmFmtChpxV2":case"txtStrmFmtPapxV2":return this._forwardHelper({data:{name:e.data.name,param:Object(g.a)(r)}});case"modifyShapeProps":if(r.shapes)for(var n=0;n<r.shapes.length;n++){var i=r.shapes[n].props;i.newPicture&&(i.picture&&(this.pres._imageIdMap[i.picture.blip.blipAtom.imageId]=i.newPicture),delete i.newPicture)}return this._forwardHelper({data:{name:e.data.name,param:Object(g.a)(r)}},{onlyBackend:!0});case"shapeInsert":var a=r.slideProps;if(a&&a.insertMedia){var o=a.insertMedia;o.uploadId&&o.mediaId&&(this.pres._mediaIdMap[o.mediaId]=o.uploadId)}else if(a&&(a.insertPicture||a.insertProcessOn)){var s=a.insertPicture||a.insertProcessOn;s.uploadId&&s.imageId&&(this.pres._imageIdMap[s.imageId]=s.uploadId)}return null;case"modifySlideProps":return this._forwardModifySlideProps(e);case"paste":if(r.cvCmds&&r.cvCmds.length>0){for(var l=[],u=0,c=r.cvCmds.length;u<c;u++){var h=r.cvCmds[u];h.param.isPaste=!0;var d={objType:e.objType,data:h},p=this.forward(d);p&&p.length>0&&(l=l.concat(p))}return l.length>0?l:null}return null;case"modifyPresentation":t.obj=this.pres,t.data={name:e.data.name,param:Object(g.a)(r)};break;case"formatBrush":return this._forwardFormat(e);case"batchCommands":for(var f=r.commands,v=[],y=0;y<f.length;y++){var m=Object.assign({},e);m.data=f[y];var _=this.forward(m);_&&_.length>0&&(v=v.concat(_))}return v.length>0?v:null;case"woChart":return this._forwardHelper({data:{name:e.data.name,param:Object(g.a)(r)}});default:return null}return[t]}},{key:"_forwardFormat",value:function(e){var t=this,r=[],n=e.data.param,i=n.state,a=n.gcp,o=n.ccp,s=n.cellRange;switch(i){case m.SelectType.select_text:var l={name:"txtStrmFmtChpxV2",param:{gcp:a,ccp:o,category:n.category,layerType:n.layerType,shapePath:n.shapePath,slideIdx:n.slideIdx}};s&&(l.param.cellRange=s);var u={data:l};this.helper.doOperate(u,(function(e){var n=e.obj;if(!e.param._bInvalidRange){var i={obj:n,data:[{name:l.name,param:Object(g.a)(l.param)}]};n.buddy=t,r.push(i)}}));break;case m.SelectType.select_cell:case m.SelectType.select_multi_cell:for(var c=e.data.param,h=this.fetchShape(c,!1),d=this.getCellPairs(h,s),p=0;p<d.length;++p){var f=d[p],v=f.txtStream,y=v.end,_={name:"txtStrmFmtChpxV2",param:{shapePath:c.shapePath,slideIdx:c.slideIdx,category:c.category,layerType:c.layerType,cellRange:f.cellRange,gcp:0,ccp:y}},S={obj:v,data:[{name:_.name,param:Object(g.a)(_.param)}]};v.buddy=this,r.push(S)}}return r}},{key:"_forwardModifySlideProps",value:function(e){var t=e.data.param,r=t.records,n=[];if(r){for(var i=0;i<r.length;i++){var a=r[i];if("transitionRecord"===a.recordType){var o=this.pres.getContainerByCategory(a.category).getSlideById(a.slideId);o&&(o.buddy=self,n.push({obj:o,data:[{name:e.data.name,param:{records:[a]}}]}))}}t.records=[]}var s=t.slideProps;if(s&&s.background){var l=s.background.props||{},u=l.newPicture;if(u&&l.fill){var c=l.fill.blip;if(c&&c.blipAtom){var h=c.blipAtom.imageId;"number"==typeof h&&(this.pres._imageIdMap[h]=u)}}}var d=this._forwardHelper({data:{name:e.data.name,param:Object(g.a)(t)}});return d&&(n=n.concat(d)),n}},{key:"getTargetShape",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=this;t||(t="slides");var o=a.pres.getSlideByIdx(e,t,r);if(!o)return null;if(null!==i){var s=o.findShapeById(i);if(s)return s}if(!n||0===n.length)return null;for(var l=0;l<n.length;l++)if(n[l]<0)return null;for(var u=o.getSpTree(),c=0,h=n.length;u&&c<h;++c){var d=n[c],p=u.getChildAt(d);if(c+1<h&&p&&!p.isGroupShape())return p.getId()===i?p:null;u=p}return u}},{key:"getTextStream",value:function(e,t){if(!e)return null;var r=[],n=null;if(t){if(e.getTableFrame){var i=e.getTableFrame();if(i){var a=t.startRow,o=t.startCol,s=i.getCell(a,o);s&&(n=s.getTextFrame())&&r.push(n.getTextStream())}}}else e.getTextFrame&&(n=e.getTextFrame())&&r.push(n.getTextStream());return 0===r.length?null:r[0]}},{key:"getCellPairs",value:function(e,t){if(!e)return null;if(t){var r=[],n=e.getTableFrame();if(n)for(var i=n.getCells(t.startRow,t.startCol,t.endRow,t.endCol),a=0;a<i.length;++a){var o=i[a],s={txtStream:o.getTextFrame().getTextStream(),cellRange:n.getCellRange(o)};r.push(s)}return r}}},{key:"fetchSlide",value:function(e){return e.category||(e.category="slides"),e.slideIdx>=0&&(e.slideIndex=e.slideIdx),this.pres.getSlideByIdx(e.layerType,e.category,e.slideIndex)}},{key:"fetchShape",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.category||(e.category="slides"),e.slideIdx>=0&&(e.slideIndex=e.slideIdx),this.getTargetShape(e.layerType,e.category,e.slideIndex,e.shapePath,t?e.shapeid:null)}},{key:"fetchTextStream",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;e.category||(e.category="slides"),e.slideIdx>=0&&(e.slideIndex=e.slideIdx);var n=r.getTargetShape(e.layerType,e.category,e.slideIndex,e.shapePath,t?e.shapeid:null);return r.getTextStream(n,e.cellRange)}},{key:"fetchAnimation",value:function(e){e.category||(e.category="slides"),e.slideIdx>=0&&(e.slideIndex=e.slideIdx);var t=this.fetchSlide(e).getTiming();if(!t)return null;var r=e.sPath;if(!r||2!==r.length)return null;var n=r[0],i=r[1],a=function(e,t){var r=e.getTimeLine();return r?t<0||t>=r.length?null:r.subNode(t):null}(t,n);return a?a.subNode(i):null}}]),t}(y.c),b=r(446),k=r(262),C=r(335),w=r(315),P=function(e){function t(e){var r=e.category,n=e.proxylist;i()(this,t);var a=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.category=r,a.parent=n,a.gid=Object(w.a)(),a}return p()(t,e),o()(t,[{key:"getIdx",value:function(){return this.parent.getProxyIdx(this)}},{key:"getGid",value:function(){return this.gid}},{key:"hasLoaded",value:function(){return!!this.bLoaded}},{key:"setSlideId",value:function(e){this._slideId=e}},{key:"_fireLoaded",value:function(){this.bLoaded&&this.fire(t.EventTypes.DATA_LOADED)}},{key:"isSlideIdxProxy",get:function(){return!0}},{key:"idx",get:function(){return this.getIdx()}},{key:"slideId",get:function(){return this._slideId}}]),t}(C.a);function x(e,t){return new P({category:e,proxylist:t})}P.EventTypes={DATA_LOADED:"data_loaded"};var O=function(){function e(t,r){i()(this,e),this.category=t,this.type=r,this.proxys=[]}return o()(e,[{key:"updateCount",value:function(e){for(var t=this.proxys.length,r=0;r<e;r++)this.proxys[r]||(this.proxys[r]=x(this.category,this));t>e&&this.proxys.splice(e,t-e)}},{key:"getProxyIdx",value:function(e){return this.proxys.indexOf(e)}},{key:"insertProxyAt",value:function(e){if(e>=0&&e<=this.proxys.length){var t=x(this.category,this);return this.proxys.splice(e,0,t),t}}},{key:"count",value:function(){return this.proxys.length}},{key:"at",value:function(e){return e>=0&&e<this.proxys.length?this.ensureAt(e):null}},{key:"ensureAt",value:function(e){var t=this.proxys[e];return t||(t=x(this.category,this),this.proxys[e]=t),t}},{key:"findSlide",value:function(e){for(var t=0;t<this.proxys.length;t++)if(this.proxys[t].slideId===e.slideId)return{idx:t,proxy:this.proxys[t]}}}]),e}(),E=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.applySvrData({data:{childs:[]},id:e.id}),r.listener.on(b.b.INSERT,(function(e){r.__onInsert(e)})),r.listener.on(b.b.MODIFY,(function(e){r.__onModify(e)})),r.listener.on(b.b.REMOVE,(function(e){r.__onRemove(e)})),r.listener.on(b.b.MOVE,(function(e){return r.__onMove(e)})),r.listener.on(b.b.RESET,(function(e){return r.__onReset(e)})),r._load_count_once=8,r._reload_time_gap=3e3,r.block_infos=[],r.pending_block=[],r.idx_proxy=new O(e.data.category,"container"),r.proxy_notifiers=[],r._pushData(e.data),r}return p()(t,e),o()(t,[{key:"init",value:function(e){this.session=e}},{key:"isAllLoaded",value:function(){for(var e=this.block_infos,t=0;t<e.length;t++)if(!e[t].loaded)return!1;return!0}},{key:"_updateBlockInfo",value:function(e,t,r){var n=this.block_infos;if(0===n.length){for(var i=parseInt(r/this._load_count_once),a=0;a<i;++a)n[a]={start:a*this._load_count_once,len:this._load_count_once,time:0,loaded:!1};if(r>i*this._load_count_once){var o=i*this._load_count_once;n[i]={start:o,len:r-o,time:0,loaded:!1}}Object.assign(this.pending_block,n)}for(var s=parseInt(e/this._load_count_once);s>0&&n[s]&&n[s].start<e;)--s;for(var l=this.block_infos.length;s<l;++s){var u=this.block_infos[s];if(null==u)break;if(u.start>=t)break;u.start>=e&&u.start+u.len<=t&&(u.loaded=!0)}for(var c=0,h=0,d=this.block_infos.length;h<d;++h){var p=this.block_infos[h];if(null==p)break;p.loaded&&(c+=1)}c===this.block_infos.length&&this.listener.fire("ALL_LOADED",{data:this})}},{key:"_getBlockIdx",value:function(e){for(var t=this.block_infos,r=0;r<t.length;r++){var n=t[r];if(e>=n.start&&e<n.start+n.len)return r}return-1}},{key:"_pushData",value:function(e){var t=e.childs,r=e.partSerial,n=void 0,i=void 0,a=void 0;r?(i=(n=r.start)+r.len,a=r.count):(n=0,i=t.length,a=t.length),this.idx_proxy.updateCount(a);for(var o=this.vector,s=n;s<i;++s){var l=t[s-n];if(l){o[s]=l;var u=this.idx_proxy.at(s);u.setSlideId(l.getId()),u.bLoaded=!0}else console.warn("--------slide_container_lazy: invalid slide item")}this._updateBlockInfo(n,i,a),this.count=a,this.category=e.category}},{key:"pushSvrData",value:function(e){var t=this;e&&e.category===this.category&&(console.log("loadslides receive:",e.partSerial.start,e.partSerial.len,this.category),this._pushData(e),e.childs.forEach((function(e){e&&e.buildTree(t)})))}},{key:"fireSvrDataLoaded",value:function(e){if(e.category===this.category){for(var t=e.partSerial,r=t.start,n=t.len,i=r,a=r+n;i<a;++i){var o=this.idx_proxy.at(i);o&&o.hasLoaded()&&o._fireLoaded()}this._bubbleUpEvent(k.default.update_slides,{data:this,start:r,len:n}),"p"===window.officeType&&"slides"===e.category&&window.collection("newui","value",window.pcTrack.newui.slide_preloading)}}},{key:"getPendingBlocks",value:function(){return this.pending_block}},{key:"_getContainerSlideIdxProxy",value:function(e){return this.idx_proxy.at(e)}},{key:"addProxyNotifiers",value:function(e){this.proxy_notifiers.push(e)}},{key:"getProxys",value:function(){return this.idx_proxy}},{key:"getSlideIdxProxy",value:function(e){return this.idx_proxy.at(e)}},{key:"getSlideByIdxProxy",value:function(e){return e?e.slide?e.slide:e.slideId?this.getSlideById(e.slideId):null:null}},{key:"getSlideAt",value:function(e){return this.vector[e]}},{key:"getSlideCount",value:function(){return this.count}},{key:"getSlideIdx",value:function(e){return this.children.indexOf(e)}},{key:"getSlideIdxById",value:function(e){for(var t=this.children,r=0,n=t.length;r<n;++r){var i=t[r];if(null!=i&&i.getId()===e)return r}return-1}},{key:"getSlideById",value:function(e){var t=this.getSlideIdxById(e);return this.getSlideAt(t)}},{key:"getCategory",value:function(){return this.category}},{key:"matchText",value:function(e,t,r){if(!e)return null;for(var n=[],i=this.getSlideCount(),a=t;a<i&&a<t+r;++a){var o=this.getSlideAt(a);if(o&&o.matchText){var s=o.matchText(e);s&&(n=n.concat(s))}}return n}},{key:"buildTree",value:function(e){this.parent=e}},{key:"_bubbleUpEvent",value:function(e,t){var r=this.parent;r&&r._bubbleUpEvent&&(t.category=this.getCategory(),r._bubbleUpEvent(e,t))}},{key:"insertSlide",value:function(e,t){return Object.isEmpty(t)||this.insert(e,t),t}},{key:"deleteSlide",value:function(e){this.remove(e)}},{key:"moveSlide",value:function(e,t){this.move(e,t)}},{key:"__onInsert",value:function(e){var t=e.index,r=this._getBlockIdx(t);if(r>=0){this.block_infos[r].len++,++r;for(var n=this.block_infos.length;r<n;++r)this.block_infos[r].start++}else{var i=this.block_infos;i[i.length]={start:t,len:1,time:Date.now(),loaded:!0}}this.count+=1;var a=this.idx_proxy.insertProxyAt(t);e.value&&(a.setSlideId(e.value.getId()),a.bLoaded=!0,e.value.buildTree(this));for(var o=0;o<this.proxy_notifiers.length;++o){this.proxy_notifiers[o].onProxyInserted(t,a)}this._bubbleUpEvent(k.default.modify_slide_container,{data:this,optype:k.default.op_add,opvalue:e,slideProxy:a})}},{key:"__onRemove",value:function(e){var t=e.index,r=e.value,n=this._getBlockIdx(t);if(n>=0)if(this.block_infos[n].len--,this.block_infos[n].len<=0){for(var i=this.block_infos.length-1;n<i;++n)this.block_infos[n]=this.block_infos[n+1],this.block_infos[n].start--;this.block_infos.pop()}else{++n;for(var a=this.block_infos.length;n<a;++n)this.block_infos[n].start--}this.count-=1;var o=this.idx_proxy.proxys.splice(t,1)[0];e.isForward&&r&&delete r.parent;for(var s=0;s<this.proxy_notifiers.length;++s){this.proxy_notifiers[s].onProxyRemoved(t,o,r)}this._bubbleUpEvent(k.default.modify_slide_container,{data:this,optype:k.default.op_remove,opvalue:e,slideProxy:o})}},{key:"__onMove",value:function(e){var t=e.index,r=e.offset,n=this.idx_proxy.proxys,i=n[t];r<0?(n.splice(t,1),n.splice(t+r,0,i)):r>0&&(n.splice(t+r,0,i),n.splice(t,1));for(var a=0;a<this.proxy_notifiers.length;++a){this.proxy_notifiers[a].onProxyMoved(t,r,i)}this._bubbleUpEvent(k.default.modify_slide_container,{data:this,optype:k.default.op_move,opvalue:e,slideProxy:i})}},{key:"__onModify",value:function(e){e.isForward&&e.value&&e.value.buildTree(e.obj),this._bubbleUpEvent(k.default.modify_slide_container,{data:this,optype:k.default.op_modify,opvalue:e})}},{key:"__onReset",value:function(e){if(e.isForward)for(var t=0;t<this.vector.length;t++)this.vector[t].buildTree(this);this._updateBlockInfo(0,this.vector.length,this.vector.length),this.count=this.vector.length,this.idx_proxy.updateCount(this.count);for(var r=this.idx_proxy.proxys,n=0;n<this.vector.length;n++)r[n].setSlideId(this.vector[n].getId()),r[n].bLoaded=!0;for(var i=0;i<this.proxy_notifiers.length;++i){this.proxy_notifiers[i].onProxyMoved(r)}this._bubbleUpEvent(k.default.modify_slide_container,{data:this,optype:k.default.op_replace,opvalue:e})}},{key:"children",get:function(){return this.vector}}]),t}(b.a),I=r(1258),A=r(2249),R=r(926),D=r(158),L=function(e){function t(e){return i()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,D.WppLayerType.WppLayerLayoutSlide,e))}return p()(t,e),o()(t,[{key:"getMaster",value:function(){return this.getFollowing()}},{key:"getExtension",value:function(){return this.private.extension}},{key:"isDefLayout",value:function(){var e=this.getMaster();return e&&e.isDefMaster()}},{key:"matchPhShapeCommon",value:function(e){return this.private.shapeTree._matchPhShapeCommon(e,!1)}},{key:"isLayoutSlide",get:function(){return!0}},{key:"isDefault",get:function(){return this.isDefLayout()}}]),t}(R.a),N=function(e){function t(e){return i()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,D.WppLayerType.WppLayerMasterSlide,e))}return p()(t,e),o()(t,[{key:"getTheme",value:function(){return this.private.theme}},{key:"getName",value:function(){return this.private.theme.private.name}},{key:"isDefMaster",value:function(){return"webwppDefTheme"===this.getTheme().private.name}},{key:"matchPhShapeCommon",value:function(e){return this.private.shapeTree._matchPhShapeCommon(e,!0)}},{key:"getMasterSlide",value:function(){return this}},{key:"isMasterSlide",get:function(){return!0}},{key:"isDefault",get:function(){return this.isDefMaster()}},{key:"isPreserved",get:function(){return!!this.private.preserved}}]),t}(R.a),M=r(1015),F=r(1014),B=r(1149),j=r(1384),V=r(927),H=function(e){function t(e){return i()(this,t),h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,D.WppLayerType.WppLayerNotesMaster,e))}return p()(t,e),o()(t,[{key:"getMasterSlide",value:function(){return this}},{key:"matchPhShapeCommon",value:function(e){return this.private.shapeTree._matchPhShapeCommon(e,!0)}},{key:"isNotesMaster",get:function(){return!0}}]),t}(R.a),G=r(1284),U=r(1866),W=r(2663),z=r(1013),Y=r(461),q=3,K=11,Q=12,X=13,J=17,Z=20,$=22,ee=23,te=function(){function e(t){i()(this,e),this.delegation=t,t&&(t.theme?this.theme=t.theme:t.shape&&(this.theme=t.shape.visual.getTheme()))}return o()(e,[{key:"setColorUsedFor",value:function(e){this.delegation&&this.delegation.setColorUsedFor(e)}},{key:"copyColor",value:function(e,t){var r=e.transOp;return e=Object(Y.deepClone)(t),r&&(e.transOp=r),e}},{key:"convertThemeColor",value:function(e){var t=Object(Y.deepClone)(e);return this.delegation&&t&&t.type===z.c.Scheme?(t=this.delegation.interpret(t),this.copyColor(e,t)):t}},{key:"convertThemeFill",value:function(e,t){var r=t?this.convertThemeColor(t):null,n=Object(Y.deepClone)(e);switch(e.type){case m.FillType.FillTypeNone:break;case m.FillType.FillTypeSolidColor:n.color=r||this.convertThemeColor(e.color);break;case m.FillType.FillTypeGradient:if(n.stops&&t)for(var i=n.stops,a=0;a<i.length;a++)i[a].color=this.copyColor(i[a].color,r);break;case m.FillType.FillTypeBlip:this.transferEffects(n.blip.effects,r,!!t);break;default:n={type:0}}return n}},{key:"convertThemeLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.fill&&((e=Object.assign({},e)).fill=this.convertThemeFill(e.fill,t)),e}},{key:"convertThemeEffectList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(Y.deepClone)(e),n=r.fillOverlay,i=r.glow;return n&&(n.fill=this.convertThemeFill(n.fill,t)),i&&(i.color=this.transferThemeColor(i.color,t,!0)),r}},{key:"fillRef2Fill",value:function(e){if(!this.theme||!e)return{type:0};var t=this.theme.getFormatScheme().getFillAt(e.index);return this.convertThemeFill(t,e.color)}},{key:"lineRef2Line",value:function(e){if(!this.theme||!e)return{fill:{type:0}};var t=this.theme.getFormatScheme().getLineAt(e.index);return this.convertThemeLine(t,e.color)}},{key:"effectRef2EffectList",value:function(e){if(!this.theme||!e)return{};var t=this.theme.getFormatScheme().getEffectsAt(e.index);return this.convertThemeEffectList(t,e.color)}},{key:"transferEffects",value:function(e,t,r){if(e)for(var n=0;n<e.length;n++)this.transferEffect(e[n],t,r)}},{key:"transferEffect",value:function(e,t,r){if(e)switch(e.type){case J:case Z:case $:case ee:e.color=this.transferThemeColor(e.color,t,r);break;case q:for(var n=0;n<e.colors.length;n++)e.colors[n]=this.transferThemeColor(e.colors[n],t,r);break;case K:e.from=this.transferThemeColor(e.from,t,r),e.to=this.transferThemeColor(e.to,t,r);break;case Q:e.replacement=this.transferThemeColor(e.replacement,t,r);break;case X:e.color1=this.transferThemeColor(e.color1,t,r),e.color2=this.transferThemeColor(e.color2,t,r)}}},{key:"transferThemeColor",value:function(e,t,r){return r&&(e=this.copyColor(e,t)),e.type===z.c.Scheme&&(e=this.convertThemeColor(e)),e}}]),e}();function re(e,t,r){return r.setColorUsedFor("fill"),e?r.convertThemeFill(e):t?r.fillRef2Fill(t):void 0}function ne(e,t,r){return r.setColorUsedFor("effects"),e?r.convertThemeEffectList(e):t?r.effectRef2EffectList(t):void 0}var ie=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data||{},r}return p()(t,e),o()(t,[{key:"getStyleName",value:function(){return this.private.styleName}},{key:"getWholeTable",value:function(){return this.private.wholeTable}},{key:"interpret",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.private,r={},n=new te(e);for(var i in t){var a=t[i];a.isTablePartStyle&&(r[i]=a.interpret(n))}var o=t.fill,s=t.effects;return o&&(e&&e.setColorUsedFor("fill"),r.fill=re(o.fill,o.fillRef,n)),s&&(e&&e.setColorUsedFor("effects"),r.effects=ne(s.effects,s.effectsRef,n)),{private:r}}},{key:"getWholeTblHBProp",value:function(e,t){var r=this.getWholeTable();if(!r)return null;var n=null;return 0===e?(n=r.getTBProp())&&(n.defVal=!0):e===t&&(n=r.getBBProp())&&(n.defVal=!0),(n=r.getInsideHBProp())&&(n.defVal=!0),n}},{key:"getWholeTblVBProp",value:function(e,t){var r=this.getWholeTable();if(!r)return null;var n=null;return 0===e?(n=r.getLBProp())&&(n.defVal=!0):e===t&&(n=r.getRBProp())&&(n.defVal=!0),(n=r.getInsideVBProp())&&(n.defVal=!0),n}},{key:"getBand1H",value:function(){return this.private.band1H}},{key:"getBand2H",value:function(){return this.private.band2H}},{key:"getBand1V",value:function(){return this.private.band1V}},{key:"getBand2V",value:function(){return this.private.band2V}},{key:"getFirstRow",value:function(){return this.private.firstRow}},{key:"getLastRow",value:function(){return this.private.lastRow}},{key:"getFirstCol",value:function(){return this.private.firstColumn}},{key:"getLastCol",value:function(){return this.private.lastColumn}},{key:"neCell",value:function(){return this.private.neCell}},{key:"nwCell",value:function(){return this.private.nwCell}},{key:"seCell",value:function(){return this.private.seCell}},{key:"swCell",value:function(){return this.private.swCell}},{key:"getEffects",value:function(){return this.private.effects}},{key:"getFill",value:function(){return this.private.fill}},{key:"getBand1HTopProp",value:function(){var e=this.private.band1H;if(e)return e.getTBProp()}},{key:"getBand1HBottomProp",value:function(){var e=this.private.band1H;if(e)return e.getBBProp()}},{key:"getBand1VRightProp",value:function(){var e=this.private.band1V;return e?e.getRBProp():null}},{key:"getBand2HTopProp",value:function(){var e=this.private.band2H;if(e)return e.getTBProp()}},{key:"getBand2HBottomProp",value:function(){var e=this.private.band2H;if(e)return e.getBBProp()}},{key:"getBand2VLeftProp",value:function(){var e=this.private.band2V;if(e)return e.getLBProp()}},{key:"getBand2VRightProp",value:function(){var e=this.private.band2V;return!!e&&e.getRBProp()}},{key:"getFirstRowVProp",value:function(){var e=this.getFirstRow();return e?e.getTBProp():null}},{key:"getLastColLProp",value:function(){var e=this.getLastCol();return e?e.getLBProp():null}},{key:"getFirstRowBProp",value:function(){var e=this.getFirstRow();return e?e.getBBProp():null}},{key:"getLastColHProp",value:function(){var e=this.getLastCol();return e?e.getInsideHBProp():null}},{key:"getLastRowVProp",value:function(){var e=this.getLastRow();return e?e.getInsideVBProp():null}},{key:"getFirstColHProp",value:function(){var e=this.getFirstCol();return e?e.getInsideHBProp():null}},{key:"getFirstColRProp",value:function(){var e=this.getFirstCol();return e?e.getRBProp():null}},{key:"getLastRowTProp",value:function(){var e=this.getLastRow();return e?e.getTBProp():null}},{key:"getNeCellBottomProp",value:function(){var e=this.getNeCell();if(e)return e.getBBProp();var t=this.getFirstRow();return t||this.getLastCol()}},{key:"getNeCellLBProp",value:function(){var e=this.getNeCell();if(e)return e.getLBProp();var t=this.getFirstRowVBProp();return t||this.getLastColLProp()}},{key:"getNwCellBottomProp",value:function(){var e=this.getNwCell();if(e)return e.getBBProp();var t=this.getFirstRowBProp();return t||this.getFirstColHProp()}},{key:"getNwCellRightProp",value:function(){var e=this.getNwCell();if(e)return e.getRBProp();var t=this.getFirstRowVProp();return t||this.getFirstColRProp()}},{key:"getSeCellLeftProp",value:function(){var e=this.getSeCell();if(e)return e.getLBProp();var t=this.getLastRowVProp();return t||this.getLastColLProp()}},{key:"getSeCellTopProp",value:function(){var e=this.getSeCell();if(e)return e.getTBProp();var t=this.getLastRowTProp();return t||this.getLastColHProp()}},{key:"getSwCellTopProp",value:function(){var e=this.getSwCell();if(e)return e.getTBProp();var t=this.getLastRowTProp();return t||this.getFirstColHProp()}},{key:"getSwCellRightProp",value:function(){var e=this.getSwCell();if(e)return e.getRBProp();var t=this.getLastRowVProp();return t||this.getFirstColRProp()}}]),t}(y.b),ae=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data||{},r}return p()(t,e),o()(t,[{key:"interpret",value:function(e){var t=this.private,r=Object.assign({},t),n=t.cellStyle;if(n){var i={};for(var a in n)"cell3D"!==a&&(i[a]=this._interpretProperty(n[a],e));n.cell3D&&(i.cell3D=n.cell3D),r.cellStyle=i}return{private:r}}},{key:"_interpretProperty",value:function(e,t){var r=e.fill,n=e.fillRef,i=e.line,a=e.lineRef;return r||n?re(r,n,t):i||a?function(e,t,r){return r.setColorUsedFor("line"),e?r.convertThemeLine(e):t?r.lineRef2Line(t):void 0}(i,a,t):void 0}},{key:"getCellStyle",value:function(){return this.private.cellStyle}},{key:"getFillProp",value:function(){var e=this.private.cellStyle;if(e)return e.fill}},{key:"getLBProp",value:function(){var e=this.private.cellStyle;if(e)return e.leftBorder}},{key:"getRBProp",value:function(){var e=this.private.cellStyle;if(e)return e.rightBorder}},{key:"getTBProp",value:function(){var e=this.private.cellStyle;if(e)return e.topBorder}},{key:"getBBProp",value:function(){var e=this.private.cellStyle;if(e)return e.bottomBorder}},{key:"getTL2BRProp",value:function(){var e=this.private.cellStyle;if(e)return e.tl2brBorder}},{key:"getTR2BLProp",value:function(){var e=this.private.cellStyle;if(e)return e.tr2blBorder}},{key:"getInsideHBProp",value:function(){var e=this.private.cellStyle;if(e)return e.insideHBorder}},{key:"getInsideVBProp",value:function(){var e=this.private.cellStyle;if(e)return e.insideVBorder}},{key:"getCell3D",value:function(){var e=this.private.cellStyle;if(e)return e.cell3D}},{key:"getTextStyle",value:function(){return this.private.textStyle}},{key:"getTextStyleSheet",value:function(){return this.private.textStyleSheet}},{key:"isTablePartStyle",get:function(){return!0}}]),t}(y.b),oe=r(2250),se=r(2662),le=r(696),ue=r(1259),ce=r(1715),he=r(2251),de=r(764),pe=r(2256),fe=r(2255),ve=r(2257),ye=r(2258),ge=r(2259),me=r(2260),_e=r(201);var Se=r(2252),Te=r(2253),be=r(2254),ke=r(263),Ce=r(1713),we=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r.data_token=Object(w.a)(),r}return p()(t,e),o()(t,[{key:"buildTree",value:function(e){this.parent=e,this.container.buildTree(e)}},{key:"getDataToken",value:function(){return this.data_token}},{key:"queryComment",value:function(e){for(var t=this.childs,r=-1,n=0;n<t.length;++n){if(e===t[n].getCommentId()){r=n;break}}return r}},{key:"deleteComment",value:function(e){for(var t=this.container,r=this.childs,n=-1,i=null,a=0;a<r.length;++a){var o=r[a];if(o.getCommentId()===e){n=a,i=o;break}}if(!i)return null;var s=i.getAuthorName(),l="c";i.isReply&&(l="r");var u=i.getContent();return"/+1"===u?l="o":"/like"===u&&(l="t"),delete i.parent,t.remove(n),this._deleteReply(e),{authName:s,commentType:l}}},{key:"_deleteReply",value:function(e){for(var t=this.container,r=this.childs,n=0;n<r.length;++n){var i=r[n];if(i.getReplyID()===e){var a=this.queryComment(i.getCommentId());delete i.parent,t.remove(a),n--}}}},{key:"isComments",get:function(){return!0}},{key:"container",get:function(){return this.private.container}},{key:"childs",get:function(){return this.private.container.vector}}]),t}(ke.AbsCustomObject),Pe=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return void 0!==e&&(r.private=e.data,r.vector=e.data),r}return p()(t,e),o()(t,[{key:"_fireChanged",value:function(e){var t=this.parent;t&&t._bubbleUpEvent&&t._bubbleUpEvent(k.default.modify_comment,{op:e})}},{key:"_bubbleUpEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(w.a)():this.tree_token=Object(w.a)());var r=this.parent;r&&r._bubbleUpEvent&&(t.data=this,r._bubbleUpEvent(e,t))}},{key:"buildTree",value:function(e){this.parent=e;for(var t=this.vector,r=0;r<t.length;++r){var n=t[r];n.buildTree&&n.buildTree(this)}}}]),t}(ke.AbsVectorObject),xe=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r.data_token=Object(w.a)(),r.thumbsList=[],r.replyList=[],r.onceList=[],r}return p()(t,e),o()(t,[{key:"clone",value:function(){var e=new t({data:{}});for(var r in this.private)this.private.hasOwnProperty(r)&&(e.private[r]=Object(g.a)(this.private[r]));return e}},{key:"buildTree",value:function(e){if(this.parent=e,this.isReply&&this.getContent()){var t=Ce.a.decodeComment(this.getContent()),r=t.content,n=t.replyId;n?(this.private.replyId=n,this.private.content=r):Object.isEmpty(this.private.replyId)&&(this.private.isReply=!1,this.private.content=r)}}},{key:"_bubbleUpEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(w.a)():this.tree_token=Object(w.a)());var r=this.parent;r&&r._bubbleUpEvent&&r._bubbleUpEvent(e,t)}},{key:"_fireChanged",value:function(e){this._bubbleUpEvent(k.default.modify_comment,{op:e})}},{key:"getObjID",value:function(){return this.private.objID}},{key:"getDataToken",value:function(){return this.data_token}},{key:"getAuthorID",value:function(){return this.private.authorId}},{key:"getReplyID",value:function(){return this.private.replyId}},{key:"getReplyList",value:function(){return this.replyList}},{key:"getThumbsList",value:function(){return this.thumbsList}},{key:"resetReplyList",value:function(){this.replyList=[]}},{key:"getOnceList",value:function(){return this.onceList}},{key:"resetThumbsList",value:function(){this.thumbsList=[],this.onceList=[]}},{key:"getAuthorInit",value:function(){return this.private.authInit}},{key:"getAuthorName",value:function(){return this.private.authName}},{key:"getColorIdx",value:function(){return this.private.colorIdx}},{key:"getContent",value:function(){return this.private.content}},{key:"getDate",value:function(){var e=this.private.date;if(e)return{year:e>>16,month:e>>12&15,week:e>>8&15,daty:255&e}}},{key:"getTime",value:function(){var e=this.private.time;if(e)return{hour:e>>24,minute:e>>16&255,second:e>>10&63}}},{key:"getCommentId",value:function(){return this.private.commentId}},{key:"getVoiceId",value:function(){return this.getCommentId()}},{key:"getAnchor",value:function(){return this.private.pos}},{key:"setAnchor",value:function(e){this.setPropertyValue("pos",e)}},{key:"setContent",value:function(e){this.setPropertyValue("content",e)}},{key:"isSlideToken",get:function(){return!0}},{key:"isReply",get:function(){return this.private.isReply}},{key:"isVoice",get:function(){var e=this.private.content;return e&&("6e439d96ec4fba12"===e||"v"===e)}}]),t}(ke.AbsCustomObject),Oe=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.childsBuildTree=function(){for(var e=this.private,t=this.getCoreObject(),r=0;r<e.length;r++){var n=e[r];n.buildTree?n.buildTree(t):n.parent=t}},r._doOperate=function(e){var t=this.private;switch(e.opType){case l.default.otInsert:t.splice(e.pos,0,e.data),e.data.parent=this.getCoreObject(),this._fireDataChanged(b.b.INSERT,{index:e.pos,value:e.data,isForward:e.isForward});break;case l.default.otRemove:var r=t[e.pos];t.splice(e.pos,1),delete r.parent,this._fireDataChanged(b.b.REMOVE,{index:e.pos,value:r,isForward:e.isForward});break;case l.default.otMove:e.offset<0?(t.splice(e.pos,1),t.splice(e.pos+e.offset,0,e.data)):e.offset>0&&(t.splice(e.pos+e.offset,0,e.data),t.splice(e.pos,1)),this._fireDataChanged(b.b.MOVE,{index:e.pos,offset:e.offset,value:e.data,isForward:e.isForward});break;case l.default.otModify:t[e.pos]=e.data,e.data.parent=this.getCoreObject(),this._fireDataChanged(b.b.MODIFY,{index:e.pos,value:e.data,isForward:e.isForward});break;case l.default.otReplaceData:for(var n=t,i=0;i<n.length;i++)delete n[i].parent;t.splice(0);for(var a=0;a<e.data.length;a++)t.push(e.data[a]),e.data[a].parent=this.getCoreObject();this._fireDataChanged(b.b.RESET,{value:t,isForward:e.isForward})}this.childsBuildTree()},r.container=e,r.listener.on(b.b.INSERT,(function(e){r._onDataChanged(k.default.op_add,e)})),r.listener.on(b.b.MODIFY,(function(e){r._onDataChanged(k.default.op_modify,e)})),r.listener.on(b.b.REMOVE,(function(e){r._onDataChanged(k.default.op_remove,e)})),r.listener.on(b.b.MOVE,(function(e){return r._onDataChanged(k.default.op_move,e)})),r.listener.on(b.b.RESET,(function(e){return r._onDataChanged(k.default.op_replace,e)})),r}return p()(t,e),o()(t,[{key:"at",value:function(e){return this.private[e]}},{key:"indexOf",value:function(e){return this.private.indexOf(e)}},{key:"length",value:function(){return this.private.length}},{key:"set",value:function(e,t){var r=this.private;if(r.length<=e)return-1;var n=r[e];return r[e]=t,t.parent=this.getCoreObject(),this.addVectorOperate(this,l.default.otModify,e,t,n),0}},{key:"push",value:function(e){var t=this.private;return t.push(e),e.parent=this.getCoreObject(),this.addVectorOperate(this,l.default.otInsert,t.length-1,e),0}},{key:"insert",value:function(e,t){var r=this.private;return r.length<e?-1:(r.splice(e,0,t),t.parent=this.getCoreObject(),this.addVectorOperate(this,l.default.otInsert,e,t),0)}},{key:"remove",value:function(e){var t=this.private;if(t.length<=e||e<0)return-1;var r=t[e];return t.splice(e,1),delete r.parent,this.addVectorOperate(this,l.default.otRemove,e,r),0}},{key:"move",value:function(e,t){var r=this.private;if(e+t<0||e+t>r.length)return-1;var n=r[e];return t<0?(r.splice(e,1),r.splice(e+t,0,n)):t>0&&(r.splice(e+t,0,n),r.splice(e,1)),this.addVectorOperate(this,l.default.otMove,e,n,void 0,t),0}},{key:"_onDataChanged",value:function(e,t){var r=[];e===k.default.op_add||e===k.default.op_modify?r=[t.value]:e===k.default.op_replace&&(r=t.value);for(var n=this.container,i=0;i<r.length;i++){var a=r[i];a.buildTree?a.buildTree(n):a.parent=n}this.container._fireChanged({type:e,param:t})}},{key:"_fireChanged",value:function(e){}},{key:"listAtomProperties",get:function(){return["childs"]}}]),t}(b.c);Object(b.e)(we.prototype,!1),Object(b.e)(xe.prototype,!1),Object(b.d)(Pe,{ListAtomDelegateClass:Oe,selfAtomeType:"customAtom"});var Ee=r(2246),Ie=r(150),Ae=r.n(Ie),Re=r(809),De=r(2242);function Le(e,t,r,n){var i=n.names,a=n.merger;i=Object(Y.arrayUnion)(["fill","outline","undefineds","modifiers"],i);for(var o=[],s=0;s<i.length;s++)o.push(r+i[s]);return n.names=o,n.merger=function(e,t,n,i){if(t===r+"fill")return{succ:!0,result:Object(Y.deepMergeWithConfigs)([n,i],Y.FillMergeConfig)};if(t===r+"outline")return{succ:!0,result:Object(Y.deepMergeWithConfigs)([n,i],Y.OutlineMergeConfig)};if(t===r+"undefineds")return{succ:!0,result:Object(Y.arrayUnion)(n,i)};if(t===r+"modifiers"){var o={};if(n)for(var s=0;s<n.length;s++){var l=n[s],u=l.tag,c=l.val;o[u]=c}if(i)for(var h=0;h<i.length;h++){var d=i[h],p=d.tag,f=d.val;o[p]=f}var v=[];for(var y in o)v.push({tag:y,val:o[y]});return{succ:!0,result:v}}return a?a(e,t,n,i):void 0},Object(Y.deepMergeWithConfigs)([e,t],n)}var Ne=function(){function e(){var t,r;i()(this,e),this.mergeHandle=(t={},Ae()(t,le.default.txtStrmInsert,this._mergeInsertText),Ae()(t,le.default.txtStrmDelete,this._mergeDeleteText),Ae()(t,le.default.txtStrmFmtChpxV2,this._mergeForce),Ae()(t,le.default.txtStrmFmtPapxV2,this._mergeForce),Ae()(t,le.default.modifyShapeProps,this._mergeModifyShapeProps),Ae()(t,le.default.shapeInsert,this._mergeShapeInsert),Ae()(t,le.default.modifySlideProps,this._mergeModifySlideProps),Ae()(t,le.default.tableHandler,this._mergeModifyTblProps),t),this.canMergeTest=(r={},Ae()(r,le.default.txtStrmInsert,this._canMergeInsertText),Ae()(r,le.default.txtStrmDelete,this._canMergeDeleteText),Ae()(r,le.default.txtStrmFmtChpxV2,this._canMergeForce),Ae()(r,le.default.txtStrmFmtPapxV2,this._canMergeForce),Ae()(r,le.default.modifyShapeProps,this._canMergeForce),Ae()(r,le.default.shapeInsert,this._canMergeShapeInsert),Ae()(r,le.default.modifySlideProps,this._canMergeModifySlideProps),Ae()(r,le.default.tableHandler,this._canmergeModifyTblProps),r)}return o()(e,[{key:"_canMergeForce",value:function(e,t){if(e.name!==t.name)return!1;var r=e.param,n=t.param;return!!Object(De.c)(r,n)&&!!(r.shapes&&r.shapes instanceof Array&&n.shapes&&n.shapes instanceof Array)}},{key:"_mergeForce",value:function(e,t){var r=e.param,n=t.param;return n.shapes.forEach((function(e){null!=e.slideIdx&&null!=e.slideIdx||(e.slideIdx=n.slideIdx),r.shapes.push(e)})),!0}},{key:"_canMergeInsertText",value:function(e,t,r){var n=t.name,i=e.param,a=t.param;if(n===le.default.txtStrmInsert){if(Object(De.d)(i,a)&&i.gcp+i.text.length==a.gcp){if(!r){if(1===i.text.length&&i.text===Re.d.EndPara||1===a.text.length&&a.text===Re.d.EndPara)return!1;if(!Object(Y.deepCompare)(i.prop,a.prop))return!1}return!0}return!1}if(n===le.default.txtStrmDelete){if(Object(De.d)(i,a))if(i.gcp+i.text.length===a.gcp+a.text.length&&a.gcp>=i.gcp)return!0;return!1}return!1}},{key:"_canMergeDeleteText",value:function(e,t){if(e.name!==t.name)return!1;var r=e.param,n=t.param;return!!Object(De.d)(r,n)&&(r.gcp==n.gcp||n.gcp+n.text.length==r.gcp)}},{key:"_canMergeShapeInsert",value:function(e,t){if(t.name!==le.default.modifyShapeProps)return!1;var r=e.param,n=t.param,i=null==n.slideIdx?n.slideIndex:n.slideIdx,a=n.shapePath;if(n.shapes){for(var o=n.shapes||n.animations,s=o.length,l=0;l<s;l++){var u=Object.assign({slideIdx:i,shapePath:a},o[l]);if(!Object(De.b)(r,u))return!1}return!0}return!1}},{key:"_canMergeModifySlideProps",value:function(e,t){if(t.name===le.default.modifySlideProps){var r=e.param,n=t.param;if(Object(De.c)(r,n))return null!=r.slideProps.applyForAll===(null!=n.slideProps.applyForAll)}return!1}},{key:"_canmergeModifyTblProps",value:function(e,t){if(t.name===le.default.tableHandler){var r=e.param,n=t.param;if(Object(De.b)(r,n)){var i=r.optType;if(i!==n.optType)return!1;var a=r.range,o=n.range;switch(i){case m.TableOPT.ModTable:return!0;case m.TableOPT.SetHoriPos:case m.TableOPT.SetVertPos:return this._canmergeSetCellBorderPos(i,r,n);case m.TableOPT.ModCells:case m.TableOPT.SetColWidth:case m.TableOPT.SetRowHeight:if(l=o,(s=a).startRow===l.startRow&&s.startCol===l.startCol&&s.endRow===l.endRow&&s.endCol===l.endCol)return!0}}}var s,l;return!1}},{key:"_mergeInsertText",value:function(e,t,r){var n=e.param,i=t.param;if(t.name===le.default.txtStrmInsert){var a=i.text;r&&(a=a.replace("\r","\n")),n.text=n.text+a}else{var o=n.text.length-i.text.length;if(n.text=n.text.slice(0,o),0===n.text.length)return-1}return 1}},{key:"_mergeDeleteText",value:function(e,t){var r=e.param,n=t.param;return r.gcp==n.gcp?r.text=r.text+n.text:n.gcp+n.text.length==r.gcp&&(r.gcp=n.gcp,r.text=n.text+r.text),!0}},{key:"_mergeModifyShapeProps",value:function(e,t){var r=e.param,n=t.param,i=r.shapes;return n.shapes.forEach((function(e){for(var t=!1,r=i.length-1;r>=0;--r){var n=i[r];if(Object(De.b)(n,e)){Le(n,e,"/props/",{names:["extendProps/transform"],merger:function(e,t,r,n){if("/props/extendProps/transform"==t){return{succ:!0,result:r&&n?{x:r.x+n.x,y:r.y+n.y,width:r.width+n.width,height:n.height+n.height}:r||n}}}});var a=n.props,o=a.rect,s=a.anchorRect,l=a.transform2DInfo;o&&s&&!e.props.rect&&(a.rect=s,l&&delete l.rect,delete a.extendProps.transform,delete a.anchorRect),t=!0;break}}t||i.push(e)})),!0}},{key:"_mergeShapeInsert",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r)return!0;for(var n=e.param.slideProps.cmdName,i=e.param.slideProps[n],a=i.modifyProps||{},o=t.param.shapes,s=0;s<o.length;s++){var l=o[s].props;i.modifyProps=Le(a,l,"/",{names:["extendProps/transform","transform2D","transform2DInfo","rect","newInkData","inkData"],merger:function(e,t,r,n){if("/extendProps/transform"==t||"/transform2D"==t||"/transform2DInfo"==t||"rect"==t||"/newInkData"==t||"/inkData"==t)return{succ:!0,result:null}}})}return!0}},{key:"_mergeModifySlideProps",value:function(e,t){var r=e.param,n=t.param,i=!!r.slideProps.applyForAll,a=i?r.slideProps.applyForAll:r.slideProps,o=i?n.slideProps.applyForAll:n.slideProps,s=Object(Y.deepMergeWithConfigs)([a.background,o.background],{deeps:2}),l=Object(Y.deepMergeWithConfigs)([a,o],{names:["/background"],merger:function(e,t,r,n){if("/background"===t)return{succ:!0,result:s}}});i?(r.slideProps.applyForAll=null,n.slideProps.applyForAll=null):(r.slideProps=null,n.slideProps=null);var u=Object(Y.deepMergeWithConfigs)([r,n]);return i?u.slideProps.applyForAll=l:u.slideProps=l,e.param=u,!0}},{key:"_mergeModifyTblProps",value:function(e,t){var r=e.param,n=t.param,i=r.optType;switch(i){case m.TableOPT.ModTable:return this._mergeModifyTable(r,n);case m.TableOPT.SetHoriPos:case m.TableOPT.SetVertPos:return this._mergeModifyCellProps(i,r,n);case m.TableOPT.ModCells:return this._mergeModifyCellProps(r,n)}return!1}},{key:"_mergeModifyTable",value:function(e,t){var r=e.extraDatas,n=t.extraDatas;if(r&&n){var i=r.props,a=n.props;if(!i||!a)return!0;if(i.fill&&a.fill)return delete i.fill,i.fill=a.fill,!0;if(i.outlineData&&a.outlineData)return delete i.outlineData,i.outlineData=a.outlineData,!0}return!0}},{key:"_canmergeSetCellBorderPos",value:function(e,t,r){var n=t.range,i=r.range;if(e===m.TableOPT.SetHoriPos){if(n.startCol===i.startCol)return!0}else if(e===m.TableOPT.SetVertPos&&n.startRow===i.startRow)return!0;return!1}},{key:"_mergeModifyCellProps",value:function(e,t){var r=e.extraDatas,n=t.extraDatas;if(r&&n){var i=r.props,a=n.props;if(!i||!a)return!0;if(i.fill&&a.fill){var o=Object(Y.deepMergeWithConfigs)([i.fill,a.fill],Y.FillMergeConfig);return i.fill=o,!0}if(i.outlineData&&a.outlineData){var s=i.outlineData.tag,l=a.outlineData.tag,u=Object(Y.deepMergeWithConfigs)([i.outlineData,a.outlineData],Y.OutlineMergeConfig);return s!==l&&(u.tag="none"),i.outlineData=u,!0}}return!0}},{key:"mergeLocalCommandExt",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t)return!1;if(this.mergeHandle[e.name]){var n=this.mergeHandle[e.name].apply(this,[e,t,r]);if(n)return n}return console.assert("merge error!!!"),!1}},{key:"mergeLocalCommand",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.mergeLocalCommandExt(e,t,r);return!!n}},{key:"canMergeLocalCommand",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!e||!t)&&!(!this.canMergeTest[e.name]||!this.canMergeTest[e.name].apply(this,[e,t,r]))}},{key:"sendCommand",value:function(e){if(!Object.isEmpty(e)){e._transact=g_rpt.transacts[g_rpt.transacts.length-1];var t=e,r=e.name;if(e.beforeSendFunc&&(t=e.beforeSendFunc(e),delete t.beforeSendFunc),"batchCommands"===r)for(var n=e.param.commands,i=0;i<n.length;++i){var a=n[i];a.beforeSendFunc&&(n[i]=a.beforeSendFunc(a),n[i].beforeSendFunc&&delete n[i].beforeSendFunc)}window.session.sendCommandQueue([t])}}},{key:"hasCommandQueue",value:function(){return window.session.hasCommands()}}]),e}(),Me=r(1716),Fe=r(2248),Be=r.n(Fe),je=function(e){function t(e){i()(this,t);var r=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data||{},r.listenPropertyChanged(["slideWidth","slideHeight"],(function(e,t,n){r._onPropertyChanged(e,t,n)})),r}return p()(t,e),o()(t,[{key:"clone",value:function(){return new t({data:this.private})}},{key:"getProps",value:function(e){return this.private[e]}},{key:"_onPropertyChanged",value:function(e,t,r){var n=void 0,i=void 0;switch(e){case"slideWidth":case"slideHeight":t!==r&&(n=k.default.modify_page_setup,i=this.private)}n&&window.APP.presentation._bubbleUpEvent(n,i)}},{key:"_fireChanged",value:function(){var e=window.APP.presentation,t=t=k.default.modify_page_setup;e._bubbleUpEvent(t,this.private)}}]),t}(ke.AbsCustomObject);Object(b.e)(je.prototype,!1);var Ve=function(){function e(){i()(this,e),this.arr=[]}return o()(e,[{key:"transDepositedGetArray",value:function(){return this.arr}},{key:"addItem",value:function(e){this.arr.push(e)}}]),e}();function He(e,t,r){if(e&&t&&e.objID===t.objID){var n=e.objID;if(t.objType===l.default.OType_Nake||t.isGeometry2D)return t;if(!r||0===r.length)return e;for(var i=0;i<r.length;++i){if(r[i].id===n)return t}}return t}var Ge=function(){function e(){i()(this,e)}return o()(e,[{key:"createObjectForSvrInner",value:function(e,t,r){var n=null,i={clsName:t};switch(t){case"wpp.Shape":n=new F.a(r);break;case"drawing.Geometry2D":n=new G.a(r);break;case"wpp.TextFrame":n=new V.a(r);break;case"wpp.TextStream":n=new se.a(r);break;case"wpp.ShapeTree":n=new j.a(r);break;case"wpp.GroupShape":n=new B.default(r);break;case"wpp.Background":n=new Ee.a(r);break;case"wpp.Slide":n=new I.a(r);break;case"wpp.SlideLayout":n=new L(r);break;case"wpp.SlideMaster":n=new N(r);break;case"wpp.NotesPage":n=new M.a(r);break;case"wpp.NotesMaster":case"wpp.HandoutMaster":n=new H(r);break;case"wpp.TableCell":n=new W.a(r);break;case"wpp.Table":n=new U.a(r);break;case"wpp.SlideContainer":case"wpp.SlideContainerLazy":n=new E(r);break;case"wpp.Presentation":n=new u.a(r);break;case"wpp.KObjWppDocLayer":n=new T(r);break;case"wpp.Timing":n=new oe.a(r);break;case"wpp.TableStyle":n=new ie(r);break;case"wpp.TablePartStyle":n=new ae(r);break;case"wpp.AeoTimeLine":n=new he.a(r);break;case"wpp.AeoSequence":n=new Se.a(r);break;case"wpp.AeoEffect":n=new Te.a(r);break;case"wpp.AeoMedia":n=new Me.a(r);break;case"wpp.AeoBehavior":n=function(e){switch(e.data.type){case _e.AnimBehaviorType.Set:return new fe.a(e);case _e.AnimBehaviorType.Property:return new pe.a(e);case _e.AnimBehaviorType.Color:return new ve.a(e);case _e.AnimBehaviorType.Rotation:return new ye.a(e);case _e.AnimBehaviorType.Scale:return new ge.a(e);case _e.AnimBehaviorType.Command:return new me.a(e);default:return new de.a(e)}}(r),i.clsName=t+r.data.type;break;case"wpp.AeoBuild":n=Object(be.b)(r),i.clsName=t+r.data.tag;break;case"wpp.AeoBuilds":n=new be.a(r);break;case"wpp.AeoVector":n=new ce.a(r);break;case"wpp.slideData":n=new A.a(r);break;case"wpp.comments":n=new we(r);break;case"wpp.comment":n=new xe(r);break;case"wpp.commentItems":n=new Pe(r);break;case"wpp.chartLayer":n=new Be.a(r);break;case"wpp.pageSetup":n=new je(r)}return n}},{key:"createObjectForSvr",value:function(e,t,r){var n=this.createObjectForSvrInner(e,t,r);return null==n&&(n=this.rpt.defaultFactory.createObjectForSvr(e,t,r)),n&&(n.objID=r.id),n}},{key:"createTopObjectForSvr",value:function(e,t,r){var n=this.createObjectForSvrInner(e,t,r);return null==n&&(n=this.rpt.defaultFactory.createTopObjectForSvr(e,t,r)),n&&(n.objID=r.id),n}},{key:"createBinVarNamedObj",value:function(e){return e}}]),e}(),Ue=function(){function e(){i()(this,e)}return o()(e,[{key:"init",value:function(e,t){this.rpt=e,this.transact=t}},{key:"getMainCommand",value:function(){if(this.transact&&this.transact.mainOperstes){var e=this.transact.mainOperstes[this.rpt.buddy.objID];if(e&&e.length>0)return e}return[]}},{key:"validPasteExtRanges",value:function(e,t,r){var n=null;this.rpt.getTransDepositedContainer().transDepositedGetArray().forEach((function(t){if(null!=t.transDepositedInstall&&null!=t.transDepositedClone){var i=e.extRanges.get(t);i&&(n=r?i.beginRgs:i.endRgs)}}));var i=t.param;if(n&&i&&i.cvCmds&&!n.validRange){n.validRange=!0;for(var a=-1,o=[],s=null,l=i.cvCmds,u=null,c=n,h=c.category,d=c.layerType,p=0;p<l.length;p++){var f=l[p];if(f.name===le.default.slideInsert)a=f.param.slideIdx;else if(f.name===le.default.shapeInsert){var v=f.param,y=v.slideIdx,g=v.shapePath,m=v.slideProps;o.push({category:h,layerType:d,slideIdx:y,shapePath:g.slice(0),insertText:m&&m.insertText})}else f.name===le.default.tableHandler?u=f.param:f.name===le.default.txtStrmInsert&&(s=f.param)}a>=0?this._validSlide(n,a):o.length>1||1===o.length&&!s&&!u?this._validShapes(n,o):u?this._validCellRange(n,u):s&&this._validText(n,s)}}},{key:"validServerInsertShapeExtRanges",value:function(e,t,r){var n=t.param;if(n){var i=n.slideProps;if(i){var a=-1;if("insertChart"===i.cmdName){a=i.insertChart.phIndex;var o=null;if(this.rpt.getTransDepositedContainer().transDepositedGetArray().forEach((function(t){if(null!=t.transDepositedInstall&&null!=t.transDepositedClone){var n=e.extRanges.get(t);n&&(o=r?n.beginRgs:n.endRgs)}})),o){var s=n.category,l=n.layerType,u=n.slideIdx,c=n.shapePath;a>=0&&(c=[a]),this._validShapes(o,[{category:s,layerType:l,slideIdx:u,shapePath:c}])}}}}}},{key:"_validSlide",value:function(e,t){e.state=ue.c.select_slide,e.activeSlide=t,e.shapes=null,e.table=null,e.tableActive=!1,e.tableRange=null,e.begin=0,e.end=0}},{key:"_validShapes",value:function(e,t){for(var r=-1,n=[],i=0;i<t.length;i++)r<0&&(r=t[i].slideIdx),r===t[i].slideIdx&&n.push(t[i]);var a=e.category,o=e.layerType;r>=0&&(this.rpt.buddy.fetchSlide({category:a,layerType:o,slideIdx:r})&&n.length>0&&(e.state=1===n.length?ue.c.select_shape:ue.c.select_multi_shape,e.activeSlide=r,e.shapes=n,e.table=null,e.tableActive=!1,e.tableRange=null,e.begin=0,e.end=0,1===n.length&&n[0].insertText&&(e.state=ue.c.select_text,e.begin=n[0].insertText.length,e.end=n[0].insertText.length)))}},{key:"_validCellRange",value:function(e,t){var r=t.slideIdx,n=t.shapePath,i=t.range,a=e.category,o=e.layerType,s=this.rpt.buddy.fetchShape({category:a,layerType:o,slideIdx:r,shapePath:n});s&&(s.getTableFrame()&&(e.state=ue.c.select_text,e.activeSlide=r,e.tableActive=!0,i.endRow=i.startRow+1,i.endCol=i.startCol+1,e.cellRange=i,e.begin=0,e.end=0))}},{key:"_validText",value:function(e,t){var r=e.category,n=e.layerType,i=t.slideIndex,a=t.slideIdx,o=t.shapePath,s=t.cellRange,l=t.gcp,u=t.text;a=null!=i?i:a;var c=this.rpt.buddy.fetchSlide({category:r,layerType:n,slideIdx:a}),h=this.rpt.buddy.fetchShape({category:r,layerType:n,slideIdx:a,shapePath:o});c&&h&&(s&&-1!==s.startRow&&-1!==s.startCol&&(e.tableActive=!0),e.state=ue.c.select_text,e.activeSlide=a,e.shapes=[{category:r,layerType:n,slideIdx:a,shapePath:o.slice(0)}],e.cellRange=s,e.begin=l+u.length,e.end=l+u.length)}},{key:"applyRecordItem",value:function(e,t,r,n){if("begin"===e||"end"===e)for(var i=0;i<t.length;i++){var a=t[i],o=a.id,s=a.data;if(o&&s){var l=this.rpt.newObjMap[o],u=r[o];if(l){var c=this.rpt.processRecordData(s);if(u&&l===u.obj)"begin"===e?(u.obj.private=c,this.rpt.buddy.removeNewestFlag(u.obj)):"end"===e&&u.data&&(u.data=c,u.bRecord=!0);else if("end"===e){var h={opType:4,obj:l,data:c,bRecord:!0};n.push(h),r[o]=h}}}}}},{key:"applyRecordObjects",value:function(e,t,r){for(var n=[],i=0;i<e.length;i++){var a=e[i].param;a&&a.userData&&a.userData.cmdSeq&&n.push(a.userData.cmdSeq)}for(var o=r.length,s={},l=0;l<o;l++){var u=r[l],c=u.opType,h=u.obj;h&&4===c&&(s[h.objID]=u)}for(var d=0;d<t.length;d++){var p=t[d].param;if(p&&p.records){for(var f=p.records,v=0;v<f.length;v++){var y=f[v],g=y.record,m=y.newObjs;if(g&&g.tag&&g.objs){if(m)for(var _=0;_<m.length;_++){var S=m[_];S&&S.objID&&(window.g_rpt.newObjMap[S.objID]=S)}g.cmdSeq>0&&n.indexOf(g.cmdSeq)>=0&&(this.applyRecordItem(g.tag,g.objs,s,r),g.objs=null)}}p.records=null}}}}]),e}(),We=new Ge,ze=new Ne;function Ye(e){var t=window.g_rpt;return window.APP&&window.APP.curIsCacheData&&t.newObjMap[e]?t.newObjMap[e]:t._innerGetServerObjectByID.apply(t,arguments)}function qe(e,t,r,n){var i=n.overrideIds,a=window.g_rpt,o=a.newObjMap[r.id],s=a._innerCreateObjectForSvr(e,t,r);return s&&(s.objID=r.id),e===l.default.OType_Nake?s:He(o,s,i)}function Ke(e,t,r,n){var i=n.overrideIds,a=window.g_rpt,o=a.newObjMap[r.id],s=a._innerCreateTopObjectForSvr(e,t,r);return s&&(s.objID=r.id),e===l.default.OType_Nake?s:He(o,s,i)}var Qe="#_ABSOBJECT_#@".length;function Xe(e){if(e)if("Array"===e.constructor.name)for(var t=0;t<e.length;t++){var r=e[t];if("string"==typeof r&&0===r.indexOf("#_ABSOBJECT_#@")){var n=r.slice(Qe);e[t]=window.g_rpt.newObjMap[n]}else r instanceof Object&&(e[t]=Xe(r))}else for(var i in e){var a=e[i];if("string"==typeof a&&0===a.indexOf("#_ABSOBJECT_#@")){var o=a.slice(Qe);e[i]=window.g_rpt.newObjMap[o]}else a instanceof Object&&(e[i]=Xe(a))}return e}var Je=function(e){We.rpt=e,e.setCustomFactory(We),e.setCommandProc(ze),e.setTransDepositedContainer(new Ve),e.processRecordData=Xe,e._wppInited||(e._wppInited=!0,e._innerGetServerObjectByID=e.getServerObjectByID,e._innerCreateObjectForSvr=e.createObjectForSvr,e._innerCreateTopObjectForSvr=e.createTopObjectForSvr,e.getServerObjectByID=Ye,e.createObjectForSvr=qe,e.createTopObjectForSvr=Ke);var t=new Ue;s.a.prototype.forward=function(){t.init(e,this);for(var r=[],n=0;n<this.operates.length;){var i=this.operates[n];i.data&&i.data.isRecordOperate&&"RECORDS"===i.data.name?(r.push(i.data),this.operates.splice(n,1)):n++}var a=t.getMainCommand();r.length>0&&t.applyRecordObjects(a,r,this.operates);for(var o=this.operates.length,s=0;s<o;s++){var l=this.operates[s];if(l.isForward=!0,e.buddy.isNewestObject(l.obj))l.obj.buildTree&&l.obj.buildTree(l.obj.parent),l.obj._fireChanged(l);else l.obj.forward(l),l.obj.buildTree&&l.obj.buildTree(l.obj.parent),l.obj._fireChanged(l);l.isForward=!1}a&&a.length>0&&(a[0].name===le.default.paste?this.isSelf&&!this.isLocal&&e.buddy&&(t.validPasteExtRanges(t.transact,a[0],!1),this.swapExtObjRanges(!1)):a[0].name===le.default.shapeInsert&&this.isSelf&&!this.isLocal&&e.buddy&&(t.validServerInsertShapeExtRanges(t.transact,a[0],!1),this.swapExtObjRanges(!1)))}},Ze=r(1270),$e=r(146),et=r(7),tt=0,rt=1,nt=2,it=3,at=4,ot=function(){function e(t){i()(this,e),this.app=t,this._state=tt}return o()(e,[{key:"canMakeNewSelectionVer",value:function(){return this._state===tt||this._state===it}},{key:"onHandleExtraDatas",value:function(e){var t=this.presentation;e&&t&&e.depth&&t.setShapeDepthDatas(e.depth)}},{key:"preprocessData",value:function(e){var t=this.app;t.curIsCacheData=!1;var r=window.g_rpt,n=t.presentation;if(e.bPreview)t.curIsCacheData=!0,e.versions=[],e.baseDataVer=r.baseVersion,e.curDataVer=r.curVersion,e._createBy=t.session.getConnId(),this._cachePreviewData(e);else if(e.initQueryVer)r.curVersion=e.dataVer,r.baseVersion=e.dataVer,r.initVersion=e.dataVer,r.taskVersion=e.taskVer,r.reachVersion=e.dataVer,n.onInitInfoResponse(e);else if(e._isQuery&&(e._createBy||e._initToken)){if((t.session.getConnId()!==e._createBy||n.userInitToken!==e._initToken)&&(t.curIsCacheData=!0,e.baseDataVer!==r.baseVersion)){e.baseDataVer=r.baseVersion,e.curDataVer=r.curVersion;for(var i=[],a=e.versions,o=0;o<a.length;o++){var s=a[o];e.newObjs=e.newObjs.concat(s.newObjs),s.delayNewObjs&&(i=i.concat(s.delayNewObjs))}i.length>0&&(e.delayNewObjs=i),e.versions=[]}t.curIsCacheData=0===e.versions.length}}},{key:"_cachePreviewData",value:function(e){this._previewCache||(this._previewCache={images:{},medias:{},shapes:{},shapeExtras:{}});var t=this._previewCache,r=e.blockSummary,n=e.shapeExtras;r&&(this._previewCache.blockSummary=r);var i=function(e,t,r){if(t=t||{},e)for(var n=0;n<e.length;n++){var i=e[n][r];t[i]||(t[i]=[]),t[i].push(e[n])}return t};if(t.images=i(e.images,t.images,"imageId"),t.medias=i(e.medias,t.medias,"mediaId"),t.shapes=i(e.shapes,t.shapes,"slideId"),n)for(var a in n){var o=t.shapeExtras[a]||[];t.shapeExtras[a]=o.concat(n[a])}}},{key:"getPreviewBlockSummary",value:function(){if(this._previewCache)return this._previewCache.blockSummary}},{key:"onOpen",value:function(e){var t=this.app;t.curIsCacheData=!1,Je(t.rpt),t.presentation&&t.presentation.destroy(),e.bPreview&&(e._createBy=t.session.getConnId(),this._cachePreviewData(e));var r=t.rpt.applyServerInitData(e);return t.presentation=r,r.init(t.rpt,t.session,e,t.getAuthorityMgr()),t.utils=r.utils,r}},{key:"onCmdResponse",value:function(e){var t=this.app.presentation;if(this._decodeQueryCacheData(e),this._updateFontTable(e),e.error)console.log("error:",e.error);else{var r=!1;try{var n=t.selection;"response"===n.mockCore&&n.handleMockError("mock response error"),this.handleCmdResponse(t,e),r=!0}catch(e){var i={type:"response",name:"edit_blocking",err:e.toString(),stack:e.stack};throw new Error(JSON.stringify(i))}finally{r||t.fire("error_core")}}}},{key:"_handleCmdResponseError",value:function(e){switch(e.errName){case"E_WPP_CENSOR_DECLINED":window.Toast.error(_i18n("applications.presentation.core.commandCensorFailed", ""));break;case"E_WPP_SLIDE_SIZE_FAILED":this.presentation.fire(u.a.EventTypes.SLIDE_SIZE_FAILED);break;case"E_FAIL":switch(e.cmdName){case"documentBeautify":this.presentation.fire(u.a.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,{err:-1})}}}},{key:"_decodeQueryCacheData",value:function(e){if(e.queryCache){var t=e.queryCache;if(Array.isArray(t)&&t[0]){var r=t[0],n=new r.constructor(r).buffer;t=et.binReader(n)}else t.byteLength&&(t=et.binReader(t));var i=t,a=i._createBy,o=i._initToken,s=i.__namedObjRefers,l=i.__objRefers;delete e.queryCache,Object.assign(t,e),Object.assign(e,t,{_createBy:a,_initToken:o,__namedObjRefers:s,__objRefers:l})}}},{key:"_updateFontTable",value:function(e){if(e.fontTable){var t=this.app.presentation;t&&t.updateFontTable(e.fontTable)}}},{key:"handleCmdResponse",value:function(e,t){this._state=tt;var r=this.app;if(t.res)for(var n=0;n<t.res.length;++n){var i=t.res[n];i.errName&&this._handleCmdResponseError(i)}if(this.preprocessData(t),window.g_rpt.isInitializeData(t))console.error("server data error");else if(t.initQueryVer)e.slide_loader.queryInitVersionComplete();else{if(t.simpleQuery)return t.versions=t.versions||[],void window.g_rpt.assembleNewObjects(t,window.g_rpt);var a=e.getBuddy(),o=null,s=window.g_rpt.getCurrentVersion(),l=s!==t.baseDataVer||s!==t.curDataVer,u=e.slidesPreviewLimit()>=0;0===t.versions.length&&t.baseDataVer===window.g_rpt.baseVersion&&t.baseDataVer===t.curDataVer&&t.undoSteps===window.g_rpt.undoSteps&&(l=!1),t.extraDatas&&this.onHandleExtraDatas(t.extraDatas);if(r.rpt.buddy=a,l&&!u){this._state=rt;var c=t.newObjs.slice(0,t.newObjs.length),h=t.orgObjs.slice(0,t.orgObjs.length),d=[];t.versions.forEach((function(e){c=c.concat(e.newObjs);var t=function(e){for(var t=r.rpt.transacts,n=0;n<t.length;n++){var i=t[n];if(i.isSelf&&!i.isLocal&&i.bornTaskVer===e)return i}return null}(e.bornTaskVer);t&&t.isSelf&&e.self&&(e.extRanges=t.extRanges,d.push(t))}));var p=new Set,f=t.overrideIds;c.forEach((function(e){var t=e.id;if(null==window.g_rpt.newObjMap[t])p.add(e.id);else if(f.length>0)for(var r=0;r<f.length;++r)t===f[r].id&&p.add(e.id)}));var v=new Set;h.forEach((function(e){v.add(e.id)}));var y=e.selection;y._memoTrans=null;var g=window.getTransaction(),m=null;(g.isInTransaction()||g.isInBatchCommand())&&(m=g.backupTransact());var _=y.transDepositedClone(),S=!0;if(a.setNewObjectIds(p),a.setOrgObjectIds(v),e.selection.beforeApplyVersions(),o=r.rpt.applyServerVersions(t),console.assert(null!=o),a.setNewObjectIds(null),a.setOrgObjectIds(null),g._isReplace){var T=r.presentation.searcherMgr.getSearcher("text");T&&T.updateReplacedState(o)}if(window.OperationTransform){this._state=nt;var b=new window.OperationTransform(o,e),k=b.process();if(k.length>0){this._state=it,r.session.clearCommands();for(var C=b.getWrapOps(k),w=0;w<C.length;w++){var P=C[w];if(m&&!P.op.needClose){var x=1e3,O=m.bDelayEnd;w===C.length-1&&(x=m.bDelayEnd?m.waitMSeconds:-1,O||m.bLocked||(O=!0,x="forever")),P.setDelayTransact(O,m.waitForCmds,x)}if(P.apply(),w===C.length-1&&P.hasNewSelection){var E=o.localVersions[o.localVersions.length-1],I=E&&E.extRanges.get(y);I&&I.endRgs&&_.ver===I.endRgs.ver&&(_=y.transDepositedClone(),S=!1)}}}this._state=at,this.adjustSelection(b,o,{curSelect:_,bNeedTransCurSelect:S})}if(r.rpt.updateExtObjectsAfterApply(),m&&g.isInTransaction()){var A=g.getCurrentTransact(),R=g.getCommandsAfterOptrans();R&&(m.transData.localData.cmds=R,A.localCommand=null,g.restoreTransact(m))}if(r._cbAfterCmdResp){for(var D=0;D<r._cbAfterCmdResp.length;D++){var L=r._cbAfterCmdResp[D];L&&L()}r._cbAfterCmdResp=null}this._state=tt,e.selection.afterApplyVersions(o)}else window.g_rpt.assembleNewObjects(t,window.g_rpt);r._doc_saveing&&!r.rpt.canUndoLocal()&&(r._doc_saveing=!1,$e.default.dispatchEvent($e.default.names.cooper.ON_DOCUMENT_SAVE_SUCCESS)),r.curIsCacheData=!1}}},{key:"adjExtRangesFunc",value:function(e,t,r){t.forEach((function(t){var n=t.beginRgs,i=t.endRgs,a=e.transSelectionRange(n,r);a&&(t.beginRgs=a);var o=e.transSelectionRange(i,r);o&&(t.endRgs=o)}))}},{key:"adjustReExecExRanges",value:function(e,t){var r=t.applyVersions.length,n=t.resetBaseVersions.length;if(r>0&&n>0)for(var i=0;i<r;++i)for(var a=t.applyVersions[i],o=0;o<n;++o){var s=t.resetBaseVersions[o];if(a.bornTaskVer===s.bornTaskVer||a.bornTaskVer===s.taskVer){for(var l={applyVersions:[],resetBaseVersions:[]},u=0;u<i;++u)l.applyVersions.push(t.applyVersions[u]);for(var c=0;c<o;++c)l.resetBaseVersions.push(t.resetBaseVersions[c]);(l.applyVersions.length>0||l.resetBaseVersions.length>0)&&this.adjExtRangesFunc(e,a.extRanges,l);break}}}},{key:"adjustLocalCommitedExRange",value:function(e,t){if(t.localCommitedVersion.length>0)for(var r=0;r<t.applyVersions.length;++r){var n=t.applyVersions[r];if(n.isSelf){for(var i={applyVersions:[],resetBaseVersions:[]},a=0;a<=r;++a){var o=t.applyVersions[a];o.isSelf||i.applyVersions.push(o)}for(var s=0;s<t.resetBaseVersions.length;++s){var l=t.resetBaseVersions[s];l.isSelf||l.taskVer>n.taskVer||i.resetBaseVersions.push(l)}0===i.applyVersions.length&&0===i.resetBaseVersions.length||this.adjExtRangesFunc(e,n.extRanges,i)}}}},{key:"adjustSelection",value:function(e,t,r){var n=this.presentation,i=n.selection,a=r.curSelect,o=r.bNeedTransCurSelect,s=null;if(i._restoreTrans){var l=Ze.c(i._restoreTrans,t,!0);(l.applyVersions.length>0||l.resetBaseVersions.length>0)&&(s=e.transSelectionRange(i._restoreMemo,l))}else s=o?e.transSelectionRange(a,t):a;s&&i.transDepositedInstall(s),i._restoreMemo=null,i._restoreTrans=null,this.adjustLocalCommitedExRange(e,t),this.adjustReExecExRanges(e,t);for(var u=n.copypasteMgr.clipboardHistory,c={},h=Object.keys(u),d=0;d<h.length;d++){var p=h[d],f=u[p];if(f&&(c[p]=f,f.range)){var v=n.copypasteMgr.copyRangeToSelectRange(f.range),y=e.transCopyRange(v,t);f.range=n.copypasteMgr.selectRangeToCopyRange(y)}}n.copypasteMgr.updateHistory(c)}},{key:"presentation",get:function(){return this.app&&this.app.presentation}},{key:"doingCmdResponse",get:function(){return this._state!==tt}},{key:"state",get:function(){return this._state}}]),e}(),st=function(){function e(t){i()(this,e),this.session=t}return o()(e,[{key:"_checkPreviewSlidesCache",value:function(e,t){var r=window.APP.svrDataHandler.getPreviewBlockSummary();if(!r)return console.error("Not found preview block summary"),!1;var n=e.querySlides,i=n.category,a=n.start,o=n.len,s=window.APP.presentation.getContainerByCategory(i);if(!s)return console.error("Not found SlideContainer with category:",i),!1;for(var l=a,u=0;u<o;u++)if(!s.getSlideAt(a+u)){l=a+u;break}for(var c=r.blocks.slides,h=null,d=0;d<c.length;d++){var p=c[d];if(p.category===i&&l>=p.begin&&l<=p.end){h=p;break}}return!!h&&(e={queryPreviewBlock:{action:"slides",detail:Object(Y.deepClone)(h)}},this.session._client.send("presentation.query",e,t))}},{key:"_checkPreviewImageCache",value:function(e){for(var t=window.APP.svrDataHandler._previewCache.images,r=e.images,n={images:[]},i=0;i<r.length;i++){var a=r[i],o=a.image_id,s=a.quality,l=a.vWidth,u=a.token,c=t[o];if(c&&0!==c.length){for(var h=c[0],d=1;d<c.length;d++){var p=c[d];null!=l?p.width>h.width&&(h=p):s>=75&&p.isOrigin&&(h=p)}(h=Object(Y.deepClone)(h)).token=u,n.images.push(h)}else n.images.push({token:u,error:"Not found image "+o+" in preview cache"})}var f=this.session;return setTimeout((function(){f._client.emit("presentation.getImages",n)}),0),!0}},{key:"_checkPreviewMediaCache",value:function(e){for(var t=window.APP.svrDataHandler._previewCache.medias,r=e.medias,n={medias:[]},i=0;i<r.length;i++){var a=r[i],o=a.media_id,s=a.token,l=t[o];if(l&&0!==l.length){var u=Object(Y.deepClone)(l[0]);u.token=s,n.medias.push(u)}else n.medias.push({token:s,error:"Not found media "+o+" in preview cache"})}var c=this.session;return setTimeout((function(){c._client.emit("presentation.getImages",n)}),0),!0}},{key:"_checkPreviewUpdateShapesCache",value:function(e){for(var t=window.APP.svrDataHandler._previewCache.shapes,r=e.shapes,n={shapes:[]},i=0;i<r.length;i++){var a=r[i],o=a.slide_id,s=a.shape_id,l=a.zoom,u=a.token,c=t[o];if(c&&0!==c.length){for(var h=null,d=null,p=0;p<c.length;p++){var f=c[p];if(f.shapeId===s&&(d?f.zoom>d.zoom&&(d=f):d=f,null!=l&&l===f.zoom)){h=f;break}}(h=null!=l&&h||d)?((h=Object(Y.deepClone)(h)).token=u,n.shapes.push(h)):n.shapes.push({token:u,error:"Not found updateshape in preview cache (slide:"+o+",shape:"+s+")"})}else n.shapes.push({token:u,error:"Not found updateshape in preview cache (slide:"+o+",shape:"+s+")"})}var v=this.session;return setTimeout((function(){v._client.emit("presentation.updateShapes",n)}),0),!0}},{key:"_checkPreviewProcessonCache",value:function(e){if(!e)return!1;for(var t=window.APP.svrDataHandler._previewCache.shapeExtras.processon,r=null,n=0;n<t.length;n++){var i=t[n];if(e.slide_id===i.slide_id&&e.shape_id===i.shape_id){r=i;break}}if(r){var a=this.session;setTimeout((function(){a._client.emit("presentation.getProcessOnData",r)}),0)}return null!==r}},{key:"_checkPreviewCache",value:function(e,t,r){var n=window.APP;if(!n||!n.svrDataHandler||!n.svrDataHandler._previewCache)return{bNeedSend:!0};var i={bNeedSend:!0};if("presentation.query"===e)t&&t.querySlides&&(i.bNeedSend=!1,i.result=this._checkPreviewSlidesCache(t,r));else{if("presentation.getImages"===e)return t.images?this._checkPreviewImageCache(t,r):t.medias?this._checkPreviewMediaCache(t,r):{bNeedSend:!1,result:!0};if("presentation.updateShapes"===e)return this._checkPreviewUpdateShapesCache(t,r);if("presentation.getProcessOnData"===e)return this._checkPreviewProcessonCache(t,r)}return i}},{key:"send",value:function(e,t,r){if(this.session&&this.session._client){var n=this._checkPreviewCache(e,t,r);return n.bNeedSend?this.session._client.send(e,t,r):n.result}return!1}},{key:"sendJson",value:function(e,t,r){if(this.session&&this.session._client){var n=this._checkPreviewCache(e,t,r);return n.bNeedSend?this.session._client.sendJson(e,t,r):n.result}return!1}},{key:"callBinVar",value:function(e,t,r,n){if(this.session&&this.session._client){var i=this._checkPreviewCache(e,t);return i.bNeedSend?this.session._client.callBinVar(e,t,r,n):i.result}return!1}}]),e}(),lt=r(44),ut=r.n(lt),ct=function(e){function t(e,r,n,a,o,s){i()(this,t);var l=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n,a,o,s)),u=l;return l._data.onSelectionDataRestore=function(){u._validSelectionData()},l._backendMap=new Map,l._backCount=0,l}return p()(t,e),o()(t,[{key:"getSyncMemo",value:function(){return this._data.getMemo2()}},{key:"_restoreSyncMemo",value:function(e){this._lastSyncMemo=null,this._data.restoreMemo2(e),!this._data.activeSlide&&e.slideId>0&&(this._lastSyncMemo=e)}},{key:"restoreSyncMemo",value:function(e){var t=this._data.activeSlide;this._restoreSyncMemo(e);var r=this._data.activeSlide;t!==r&&this._fireSlideSelectionChange(t,r),this._fireSelectionChange()}},{key:"delayRestoreSyncMemo",value:function(e){var t=this._data.activeSlide;this._restoreSyncMemo(e);var r=this._data.activeSlide;t!==r&&this._fireSlideSelectionChange(t,r)}},{key:"transInsertText",value:function(e,t,r,n){var i={bChanged:!1,begin:e,end:t};return r<=e?(i.begin+=n,i.end+=n,i.bChanged=!0):r>e&&r<t&&(i.end+=n,i.bChanged=!0),i}},{key:"transDeleteText",value:function(e,t,r,n){var i=r+n,a={bChanged:!1,begin:e,end:t};return i<=e?(a.begin-=n,a.end-=n):r>=e&&i<=t?a.end-=n:r<e?(a.begin=r,a.end=i<=t?t-n:r):r<t&&(a.end=r),e===a.begin&&t===a.end||(a.bChanged=!0),a}},{key:"isValidShape",value:function(e){for(var t=e;t;){if(t===this.presentation)return!0;t=t.parent}return!1}},{key:"isValidShapeInActiveSlide",value:function(e){for(var t=e;t;){if(t.isSlideType&&t===this._data.activeSlide)return!0;t=t.parent}return!1}},{key:"beforeApplyVersions",value:function(){}},{key:"_getTransactMainCommand",value:function(e){if(e&&e.mainOperstes){var t=e.mainOperstes[this.rpt.buddy.objID];if(t&&t.length>0)return t[0]}}},{key:"_matchServerVersion",value:function(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n&&n.isSelf){var i=this._getTransactMainCommand(n);if(i&&t(i))return n}}}},{key:"_matchLocalVersion",value:function(e,t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n&&n.isSelf){var i=n.localCommand;if(i&&t(i))return n}}}},{key:"afterApplyVersions",value:function(e){var t=this;this.updateBackendCmdState(e),this.handleDrawingShapesState(e),this.disableUpdateActiveConnId((function(){t._validSelectionData()}))}},{key:"disableUpdateActiveConnId",value:function(e){this.bDisbleUpdateActiveConnId=!0;var t=e&&e();return this.bDisbleUpdateActiveConnId=!1,t}},{key:"updateBackendCmdState",value:function(e){if(this._backCount<0)return!1;this.updateBackendCMD(e)}},{key:"_validSelectionData",value:function(){var e=this._data,t=e.shapes;if(t){for(var r=[],n=0;n<t.length;n++)this.isValidShapeInActiveSlide(t[n])&&r.push(t[n]);0===r.length?e.changeToState(ue.c.select_slide):1===r.length&&e.state===ue.c.select_multi_shape&&e.changeToState(ue.c.select_shape),e.shapes=r.length>0?r:null}e.shapes=this._checkHiddenInkShapes(e.shapes),e.shapes&&0===e.shapes.length&&(e.shapes=null,e.changeToState(ue.c.select_slide)),this._fireSelectionChange()}},{key:"_checkHiddenInkShapes",value:function(e){if(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];n&&!n.isHidden()&&t.push(n)}e=t}return e}},{key:"startPasteCommand",value:function(e){var t=Object(w.a)();e.genid=t,this._backendMap[t]={genid:t,name:"paste",eventType:k.default.server_paste_complete,startTime:Date.now(),failTimes:0,bMatched:!1},this._backCount++,console.log("******************** Paste start"),this.presentation._bubbleUpEvent(k.default.server_paste_start,{})}},{key:"startDocTemplateCommand",value:function(e){var t=Object(w.a)();e.genid=t,this._backendMap[t]={genid:t,name:"docTemplate",eventType:k.default.server_doctemplate_end,startTime:Date.now(),failTimes:0,bMatched:!1},this._backCount++,this.presentation._bubbleUpEvent(k.default.server_doctemplate_start,{})}},{key:"startPageSetupCommand",value:function(e){var t=Object(w.a)();e.genid=t,this._backendMap[t]={genid:t,name:"modifyPresentation",eventType:k.default.server_pagesetup_end,startTime:Date.now(),failTimes:0,bMatched:!1},this._backCount++,this.presentation._bubbleUpEvent(k.default.server_pagesetup_start,{})}},{key:"startInsertChart",value:function(e){var t=Object(w.a)();e.genid=t,this._backendMap[t]={genid:t,name:"shapeInsert",eventType:k.default.server_chart_insert_end,startTime:Date.now()},this._backCount++,this.presentation._bubbleUpEvent(k.default.server_chart_insert_start,{})}},{key:"startDocumentBeautifyCommand",value:function(e){var t=Object(w.a)();e.genid=t,this._backendMap[t]={genid:t,name:"documentBeautify",eventType:k.default.server_documentbeautify_end,startTime:Date.now(),failTimes:0,bMatched:!1},this._backCount++,this.presentation._bubbleUpEvent(k.default.server_documentbeautify_start,{})}},{key:"updateBackendCMD",value:function(e){var t=this;if(e){var r=e.localCommitedVersion,n=e.applyVersions,i=e.resetBaseVersions;if(r&&r.length>0&&n&&n.length>0){var a=this._backendMap,o=[];if(this._matchLocalVersion(r,(function(e){var t=e.param.genid;if(!t)return null;o.push(a[t])})),o.length<=0)return!1;var s=[];if(n.forEach((function(e){!0===e.isVerOfCurExec&&e.isSelf&&s.push(e)})),o.length>0&&s.length>0){this._matchServerVersion(s,(function(e){for(var r=0;r<o.length;++r){var n=o[r],i=n.name,a=n.genid,s=n.eventType,l=n.startTime,u=n.bMatched,c=e.param.userData,h=!1;c&&c.genid===a&&(h=!0),i===e.name&&h&&!u&&(console.log("**** Exec backend command time elapse:",i,Date.now()-l,"ms"),t.presentation._bubbleUpEvent(s,{success:!0,data:e.param}),o[r].bMatched=!0,t._backCount--)}}));for(var l=0;l<o.length;++l){var u=o[l],c=u.name,h=u.eventType,d=u.startTime,p=u.failTimes;console.log("**** Exec backend command time elapse:",c,Date.now()-d,"ms"),3===p&&(this.presentation._bubbleUpEvent(h,{success:!1}),o[l].bMatched=!0,this._backCount--),o[l].failTimes++}}}else if(i&&i.length>0){var f=[];i.forEach((function(e){!0===e.isVerOfCurExec&&e.isSelf&&f.push(e)})),this._matchServerVersion(f,(function(e){var r=e.param.userData.genid;if(r){var n=t._backendMap[r];n&&n.name===e.name&&n.bMatched&&(n.bMatched=!1,t._backCount++)}}))}else if(n&&n.length>0){var v=[];n.forEach((function(e){!0===e.isVerOfCurExec&&e.isSelf&&v.push(e)})),this._matchServerVersion(v,(function(e){var r=e.param.userData.genid;if(r){var n=t._backendMap[r];n&&(n.name!==e.name||n.bMatched||(t.presentation._bubbleUpEvent(n.eventType,{success:!0,data:e.param}),n.bMatched=!0,t._backCount--))}}))}}}},{key:"saveCurrentState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getSyncMemo();t.ver=this._data.ver;var r=this,n={memo:t,isValid:!0,textStream:null,textStreamNotifyer:null};if(this.state===ue.c.select_text){var i=this._data.getTextStream();i&&(n.textStream=i,n.textStreamNotifyer={onInsertTextObserved:function(e,n){var i=r.transInsertText(t.begin,t.end,e,n),a=i.bChanged,o=i.begin,s=i.end;a&&(t.begin=o,t.end=s)},onDeleteTextObserved:function(e,n){var i=r.transDeleteText(t.begin,t.end,e,n),a=i.bChanged,o=i.begin,s=i.end;a&&(t.begin=o,t.end=s)}},i.addObserver(n.textStreamNotifyer))}var a=function(e){e.textStream&&e.textStreamNotifyer&&(e.textStream.removeObserver(e.textStreamNotifyer),e.textStreamNotifyer=null),e.isValid=!1},o={isValid:function(){return n.isValid},isSameVersion:function(e){return e===n.memo.ver},getSavedState:function(){return n.memo},restore:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.isValid||console.error("selection.saveCurrentState"),e||r.beginBatchSelect(),r.restoreSyncMemo(n.memo),e||r.endBatchSelect(),a(n)},discard:function(){a(n)}};return e&&setTimeout((function(){a(n)}),0),o}},{key:"handleDrawingShapesState",value:function(e){var t=this,r=this.presentation;e.applyVersions.forEach((function(e){var n=t._getTransactMainCommand(e);if(n&&"shapeInsert"===n.name){var i=n.param.slideProps;i&&i.insertInk&&r.drawingNotifyer.removeDrawingShape(i.insertInk.drawingToken)}}))}},{key:"state",get:function(){return this._data.state}}]),t}(ue.d),ht=r(2261),dt=r(360),pt=r(204),ft=function(){function e(t){i()(this,e),this.parent=t,this.selectData=this.parent._data}return o()(e,[{key:"makeNewVer",value:function(){return this.selectData.makeNewVer()}},{key:"selectText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=this.parent;if(console.log(e,t,"selectText"),this.selectData.canSelectText()){if(!Object.isEmpty(e)){t<e&&(t=e),this.selectData.getTextFrame();var n=this.selectData.getTextStream();if(n){var i=n.end-1;e>i||t>i||r.state===m.SelectType.select_text&&this.selectData.begin===e&&this.selectData.end===t||(this.selectData.begin=e,this.selectData.end=t,n._fontProp=null,r._fireSelectionChange())}}}else console.error("wrong select state:"+r._getStateString())}},{key:"clearTextSelect",value:function(){var e=this.parent;e.state===m.SelectType.select_text&&(this.selectData.clearText(),e._fireSelectionChange())}},{key:"selectShapeAt",value:function(e){if(null!==this.selectData.activeSlide){var t=this.selectData.activeSlide.getShapeAt(e);this.selectShape(t)}}},{key:"selectShape",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.parent,n=this._checkCanSelectedShapes([e]);0!==n.length&&(this.selectData.isActive=t,1===this.selectData.selectedShapeCount()&&r.state===m.SelectType.select_shape&&this.selectData.selectedShape(e)||(this.checkNeedRemoved([e]),this.selectData.clearShapes(),this.selectData.addShape(e),this.onShapeSelChange(),r._fireSelectionChange()))}},{key:"selectShapes",value:function(e){if(0!==(e=this._checkCanSelectedShapes(e)).length){this.selectData.shapes=[];for(var t=0;t<e.length;t++)this.selectData.addShape(e[t]);this.parent._fireSelectionChange()}else this.clearShapeSelect()}},{key:"addSelectShapeAt",value:function(e){if(null!==this.selectData.activeSlide){var t=this.selectData.activeSlide.getShapeAt(e);this.addSelectShape(t)}}},{key:"addSelectShape",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this._checkCanSelectedShapes([e]);0!==r.length&&(this.selectData.isActive=t,this.selectData.addShape(e),this.parent._fireSelectionChange())}},{key:"removeSelectShape",value:function(e){this.selectData.removeShape(e)&&this.parent._fireSelectionChange()}},{key:"clearShapeSelect",value:function(){delete this.selectData.isActive,0!==this.selectData.selectedShapeCount()&&(this.checkNeedRemoved(),this.selectData.clearShapes(),this.parent._fireSelectionChange())}},{key:"selectSlideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slides",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D.WppLayerType.WppLayerNormalSlide,n=this.parent;n._delayLoadIdx=null;var i=n.presentation.getSlideByIdx(r,t,e);i instanceof M.a&&(i=i.parent),this.selectSlide(i),!i&&e>=0&&(n._delayLoadIdx={idx:e,category:t,layerType:r})}},{key:"selectSlide",value:function(e){var t=this.parent;if(t._delayLoadIdx=null,e){var r=this.selectData.activeSlide,n=e,i=null;if(e.isSlideIdxProxy&&(i=e,!(n=t.presentation.getSlideByProxy(i))))return r&&this.checkNeedRemoved(),this.selectData.activeSlide=null,this.selectData.activeSlideProxy=i,void(t._delayLoadIdx={idx:i.idx,category:i.category,layerType:-1});n!==this.selectData.activeSlide&&(r&&this.checkNeedRemoved(),this.selectData.activeSlide=n,this.selectData.activeSlideProxy=i||t.presentation.getSlideProxy(n),this.checkNeedRemoved(),t._fireSlideSelectionChange(r,n),t._fireSelectionChange())}}},{key:"selectPreviousSlide",value:function(){var e=this.parent,t=e.getPreviousSlideProxy(e.getActiveSlideProxy());t&&this.selectSlide(t)}},{key:"selectNextSlide",value:function(){var e=this.parent,t=e.getNextSlideProxy(e.getActiveSlideProxy());t&&this.selectSlide(t)}},{key:"clearSlideSelect",value:function(){var e=this.parent;if(e.state!==m.SelectType.select_none){this.checkNeedRemoved();var t=this.selectData.activeSlide;this.selectData.clearSlide(),e._fireSlideSelectionChange(t,null),e._fireSelectionChange()}}},{key:"selectTableCellAt",value:function(e){var t=this.selectData.getTableFrame();if(t){var r=t.visual.getCellGridDataByIdx(e),n=t.getCell(r.startRow,r.startCol),i=this.selectData.tableCells;if(i&&1===i.length&&i[0]===n)return;this.selectData.clearTableCells(),this.selectData.tableRange.setRowRange(r.startRow,r.endRow),this.selectData.tableRange.setColumnRange(r.startCol,r.endCol),this.selectData.addTableCell(n),this.parent._fireSelectionChange()}}},{key:"selectTableCell",value:function(e,t){var r=this.selectData.getTableFrame();if(r){var n=r.visual.getCellGridData(e,t),i=r.getCell(n.startRow,n.startCol),a=this.selectData.tableCells;if(a&&1===a.length&&a[0]===i)return;this.selectData.clearTableCells(),this.selectData.tableRange.setRowRange(n.startRow,n.endRow),this.selectData.tableRange.setColumnRange(n.startCol,n.endCol),this.selectData.addTableCell(i),this.parent._fireSelectionChange()}}},{key:"selectTableCells",value:function(e,t,r,n){var i=this.selectData.getTableFrame();if(i){var a=this._calcRealRange(i,e,t,r,n),o=i.getCells(a.startRow,a.startCol,a.endRow,a.endCol);if(0===o.length)return;this.selectData.clearTableCells(),this.selectData.tableRange.setRowRange(a.startRow,a.endRow),this.selectData.tableRange.setColumnRange(a.startCol,a.endCol);for(var s=0;s<o.length;s++)this.selectData.addTableCell(o[s]);this.parent._fireSelectionChange()}}},{key:"selectTblRange",value:function(e){this.selectTableCells(e.startRow,e.startCol,e.endRow,e.endCol)}},{key:"clearCellSelect",value:function(){0!==this.selectData.selectedTableCellCount()&&(this.selectData.clearTableCells(),this.parent._fireSelectionChange())}},{key:"selectAnimAt",value:function(e){if(this.selectData.activeSlide){var t=this.selectData.activeSlide.getTiming().mainSequence;if(t){var r=t.subNode(e);this.selectAnimation(r)}}}},{key:"selectAnimations",value:function(e){if(this.selectData.activeSlide&&0!==this._checkCanSelectedShapes(e).length){for(var t=[],r=0;r<e.length;++r){var n=pt.a.getEffects(e[r]);t.concat(n)}if(t.length>0){this.selectData.clearAnimations();for(var i=0;i<t.length;++i)this.selectData.addAnimation(t[i]);this.parent._fireSelectionChange()}}}},{key:"selectAnimsDirectly",value:function(e){if(this.selectData.activeSlide&&e.length>0){this.selectData.clearAnimations();for(var t=0;t<e.length;++t)this.selectData.addAnimation(e[t]);this.parent._fireSelectionChange()}}},{key:"selectAnimation",value:function(e){this.selectData.clearAnimations(),this.selectData.addAnimation(e),this.parent._fireSelectionChange()}},{key:"clearAnimationSelect",value:function(){this.selectData.clearAnimations(),this.parent._fireSelectionChange()}},{key:"selectNotePageText",value:function(){var e=this.parent,t=e.getActiveSlide();if(t&&"slides"===t.getCategory()){var r=t&&t.getNotesPage(),n=r&&r.getNotesTextFrame();n&&(e.beginBatchSelect(),this.selectShape(n.parent),this.selectText(0,0),e.endBatchSelect())}}},{key:"selectRemark",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.parent.getActiveSlide(),n=r&&r.getNotesPage(),i=n&&n.getNotesTextFrame();if(i){this.selectSlide(r),this.selectData.shapes=[];var a=i.parent;this.selectData.addShape(a),this.selectData.textFrame=i;var o=i.getTextStream();o&&(this.selectData.textStream=o,this.selectText(e,t)),this.parent._fireSelectionChange()}}},{key:"addShapeListener",value:function(e){var t=this.parent;t._spListeners||(t._spListeners=[]),t._spListeners.push(e)}},{key:"removeShapeListener",value:function(e){var t=this.parent;if(t._spListeners)for(var r=0;r<t._spListeners.length;++r){if(t._spListeners[r]===e){t._spListeners.splice(r,1);break}}}},{key:"onShapeSelChange",value:function(){var e=this.parent;e._spListeners&&e._spListeners.length>0&&e._spListeners.forEach((function(e){e()}))}},{key:"checkNeedRemoved",value:function(e){var t=this.parent;if(!t.rpt.getCurrentTransact()&&!1!==t._autoRemoveTextBox&&!window.APP.isDoingCmdResponse)try{if(t.readonly||!window.CoreDataEditor)return;for(var r=[],n=this.selectData.shapes?this.selectData.shapes:[],i=0;i<n.length;i++)(!e||e.indexOf(n[i])<0)&&r.push(n[i]);var a=this.shapesNeedRemove(r);if(a.length>0){var o=t.getActiveSlide();t.getShapeSelection()._deleteShapes(o,a),this.selectData.clearShapes()}}catch(e){console.error(e)}}},{key:"shapesNeedRemove",value:function(e){var t=[];if(!e)return t;for(var r=this.otherUserSelectedShapes(),n=0;n<e.length;n++){var i=e[n];if(!(r.indexOf(i)>=0)&&(!i.isPlaceHolder()&&i.visual.isRootShape()&&i.isTextBox())){var a=i.getTextFrame?i.getTextFrame():null;if(a){var o=a.getTextStream();if(o&&!(o.getCharCount()>1)){var s=i.visual.getFill();if(!s||0===s.type){var l=i.visual.getOutline();l&&l.fill&&0!==l.fill.type||i.parent&&t.indexOf(i)<0&&t.push(i)}}}}}return t}},{key:"otherUserSelectedShapes",value:function(){for(var e=this.parent,t=[],r=e.presentation.getSelectionsMgr().getSelectionArray(),n=0;n<r.length;n++){var i=r[n];if(i!==e){var a=i._data.shapes;a&&a.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))}}return t}},{key:"_calcRealRange",value:function(e,t,r,n,i){var a={};a.startRow=Object(dt.n)(0,t),a.startCol=Object(dt.n)(0,r);var o=e.getRowCount(),s=e.getColumnCount();for(a.endRow=Object(dt.o)(o,n),a.endCol=Object(dt.o)(s,i),r>=i&&(a.startCol=i-1),t>=n&&(a.startRow=n-1),t=a.startRow,n=a.endRow,r=a.startCol,i=a.endCol;;){for(var l=a.startRow,u=a.startCol,c=a.endRow,h=a.endCol,d=t;d<n;++d){var p=e.visual.getCellGridData(d,r);a.startCol=Object(dt.o)(a.startCol,p.startCol),p=e.visual.getCellGridData(d,i-1),a.endCol=Object(dt.n)(a.endCol,p.endCol)}for(var f=r;f<i;++f){var v=e.visual.getCellGridData(t,f);a.startRow=Object(dt.o)(a.startRow,v.startRow),v=e.visual.getCellGridData(n-1,f),a.endRow=Object(dt.n)(a.endRow,v.endRow)}if(u===a.startCol&&l===a.startRow&&c===a.endRow&&h===a.endCol)break}return a}},{key:"_checkCanSelectedShapes",value:function(e){for(var t=[],r=0;r<e.length;r++)this.parent.isValidShapeInActiveSlide(e[r])?t.push(e[r]):console.error("Select invalid shape.");return t}}]),e}(),vt=function(){function e(t){i()(this,e),this.coreSlt=t,this.selectData=this.coreSlt._data}return o()(e,[{key:"getText",value:function(){return this._text}},{key:"getType",value:function(){return this._type}},{key:"getState",value:function(){return this.selectData}},{key:"getCacheFontProp",value:function(){return this._fontProp}},{key:"getCacheFontStyle",value:function(){return this._currentFontStyle}},{key:"getCacheStypeProp",value:function(){return this._styleProp}},{key:"getCompositionStream",value:function(){return this.coreSlt.getActiveTextStream()}},{key:"startComposition",value:function(){if(this.selectData.state===m.SelectType.select_text){var e=this.getCompositionStream();if(this._text="",this._type=m.CompositionState.Start,this._fontProp=this.coreSlt._fontProp||e._fontProp,this._currentFontStyle=this.coreSlt._currentFontStyle,this.coreSlt._isValidTextStream(e)){var t=e.parent.visual.getCompleteTextPropsByGcp(this.selectData.begin);t&&t.chpProp&&(this._styleProp=t.chpProp)}}else console.error("Wrong select state in composition start !!")}},{key:"updateComposition",value:function(e,t){if(this.inComposition)if(t===m.CompositionState.Update){var r=this.getCompositionStream(),n=r.parent,i=r.getCharCount()-1,a=this.selectData;if(a.begin>i&&(a.begin=i),a.end>i&&(a.end=i),a.end>a.begin){var o=this.coreSlt.transaction;o.beginTransact(),r.initTransact(o);var s=this.coreSlt.getTextSelection(),l=r.getChpTbl().getItemByCP(a.begin);s.cmdDeleteText({data:a});var u=r.getParaTbl().getItemByCP(a.begin);a.begin===u.getBegin()&&(r._fontProp=Object.assign({},r._fontProp,l.getProp().private),this._fontProp=r._fontProp),a.end=a.begin,o.delayEndTransact(["txtStrmInsert","txtStrmDelete"],-1)}this._text=e,this._type=m.CompositionState.Update,n._fireChanged()}else console.error("Composition state error !!")}},{key:"endComposition",value:function(e,t){if(this.inComposition){if(t!==m.CompositionState.End)return console.error("Composition state error !!"),void this.clearCompositionState();var r=this.coreSlt.transaction;if(""===e)this.getCompositionStream().parent._fireChanged(),r.isInTransaction()&&r.forceCommit();else this.coreSlt.state===m.SelectType.select_text?this.coreSlt.insertText(e):r.isInTransaction()&&r.rollback();this.clearCompositionState()}else this.clearCompositionState()}},{key:"forceEndComposition",value:function(){var e=this.getText(),t=m.CompositionState.End;return this.endComposition(e,t)}},{key:"clearCompositionState",value:function(){delete this._text,delete this._type,delete this._fontProp,delete this._styleProp,delete this._currentFontStyle}},{key:"inComposition",get:function(){return this._type===m.CompositionState.Start||this._type===m.CompositionState.Update}}]),e}(),yt=r(2262),gt=function(e){function t(e,r,n,a,o,s){i()(this,t);var l=h()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n,a,o,s));return l.setBackGroundMusic=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return l._editCommon((function(){l.getShapeSelection().setBackGroundMusic(e)}))},l.setMediaAutoPlayMode=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return l._editCommon((function(){l.getShapeSelection().setMediaAutoPlayMode(e)}))},l._doingShapes=[],l}return p()(t,e),o()(t,[{key:"getVersion",value:function(){return this._data.ver}},{key:"getUid",value:function(){return this._data.uid}},{key:"getConnId",value:function(){return this._data.connid}},{key:"getToken",value:function(){return this._data.__token}},{key:"getActiveSlide",value:function(){return this._data.activeSlide}},{key:"getActiveSlideIdx",value:function(){var e=this.getActiveSlideProxy();return e?e.idx:-1}},{key:"getActiveSlideProxy",value:function(){return this.presentation.getSlideProxy(this._data.activeSlide)||this._data.activeSlideProxy}},{key:"getActiveSlideProxys",value:function(){var e=this.getSlideMarker(),t=e&&e.selected;return t&&0!==t.length?t:[this.getActiveSlideProxy()]}},{key:"getPresentation",value:function(){return this.presentation}},{key:"getActiveShapes",value:function(){return this._data.shapes}},{key:"getShapeActiveStatus",value:function(){return this._data.isActive}},{key:"getActiveTableFrame",value:function(){return this._data.table}},{key:"getActiveTableCells",value:function(){return this._data.tableCells}},{key:"getActiveTableRange",value:function(){return this._data.tableRange&&this._data.tableRange.range()}},{key:"getActiveTextFrame",value:function(){return this._data.textFrame}},{key:"getActiveTextStream",value:function(){return this._data.textStream}},{key:"getStart",value:function(){return this._data.begin}},{key:"getEnd",value:function(){return this._data.end}},{key:"getRange",value:function(){return{begin:this._data.begin,end:this._data.end}}},{key:"getActiveAnimations",value:function(){return this._data.animations}},{key:"getSlideMarker",value:function(){return this._data.slideMarker}},{key:"getSlideHiddenStatus",value:function(e){var t=this.presentation.slides.private.childs[e];return t&&!t.getHiddenStatus()}},{key:"getSlideCount",value:function(){return this.presentation.slides.getSlideCount()}},{key:"isSelectedShape",value:function(e){return this._data.selectedShape(e)}},{key:"getFontPropCache",value:function(){this._data.getTextFrame();var e=this._data.getTextStream();if(e)return this._fontProp||e._fontProp}},{key:"category",value:function(){var e=this._data.activeSlide;return e?e.getCategory():"slides"}},{key:"layerType",value:function(){var e=this._data.activeSlide,t=this._data.shapes;return t&&t.length>0&&(e=t[0].getSlide()||e),e?e.getLayerType():D.WppLayerType.WppLayerNormalSlide}},{key:"getText",value:function(){if(this.state===ue.c.select_text){var e=this._data.begin,t=this._data.end,r=this._data.getTextStream();if(null!==r&&e<t)return r.getText(e,t-e)}return null}},{key:"getPreviousSlideProxy",value:function(e){if(e){var t=this.presentation;return"slideLayouts"===e.category||"slideMasters"===e.category?t.masterTools.previous(e):t.previousSlideProxy(e)}}},{key:"getNextSlideProxy",value:function(e){if(e){var t=this.presentation;return"slideLayouts"===e.category||"slideMasters"===e.category?t.masterTools.next(e):t.nextSlideProxy(e)}}},{key:"getDiagramIdFromTransaction",value:function(){return yt.a.getDiagramIdFromTransaction(this)}},{key:"canGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(ht.a)(e||this.getActiveShapes())}},{key:"fetchAvailPh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.getSlideSelection().fetchAvailPh(e)}},{key:"getCompositionText",value:function(){return this._getTextCompositor().getText()}},{key:"getCompositionState",value:function(){return this._getTextCompositor().getState()}},{key:"getFormatBrush",value:function(){if(!this.formatApplyer){var e=window.CoreDataEditor.format_applyer;this.formatApplyer=new e.FormatApplyer(this.presentation),this.presentation.formatApplyer=this.formatApplyer}return this.formatApplyer}},{key:"recordDoingShapes",value:function(e){var t=this;t._doingShapes=[],e.forEach((function(e){e&&t._doingShapes.push({shape:e,slide:e.getSlide()})}))}},{key:"replaceLocalStream",value:function(e,t){}},{key:"doCacheProps",value:function(e,t){this.propsCache||(this.propsCache={}),this.propsCache[e]=t}},{key:"getCacheProps",value:function(e){return this.propsCache&&this.propsCache[e]}},{key:"clearPropsCache",value:function(){delete this.propsCache}},{key:"editBatchDatas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){if(!window.CoreDataEditor)return;var r=null;(t=t||{bKeepCurrentSeletion:!1,bFireSeletionChange:!0}).bKeepCurrentSeletion&&(r=this.saveCurrentState());var n=this.getActiveSlide();t.bFireSeletionChange||this.beginBatchSelect();try{this.transaction.beginBatchCommand(),e(),r&&(r.restore(!1),r.discard(),r=null),this.transaction.endBatchCommand()}catch(e){this.transaction.rollback(),console.error(e)}t.bFireSeletionChange||this.endBatchSelect(),r&&r.restore(!1);var i=this.getActiveSlide();n!==i&&this._fireSlideSelectionChange(n,i),this._fireSelectionChange()}}},{key:"insertText",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue.a.NoComposition;return this._editCommon((function(){return t.getTextSelection().insertText(e,r)}))}},{key:"replaceText",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this._editCommon((function(){return n.getTextSelection().replaceText(e,t,r,i)}))}},{key:"deleteText",value:function(e){var t=this;return this._editCommon((function(){return t.getTextSelection().deleteText(e)}))}},{key:"backspace",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this._editCommon((function(){return e.getTextSelection().backspace(t)}))}},{key:"deleteChar",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this._editCommon((function(){return e.getTextSelection().deleteChar(t)}))}},{key:"tabPress",value:function(e){var t=this;return this._editCommon((function(){return t.getTextSelection().tabPress(e)}))}},{key:"insertPara",value:function(e){var t=this;return this._editCommon((function(){return t.getTextSelection().insertPara(e)}))}},{key:"insertTextBoxWithContent",value:function(e,t){var r=this;this._editCommon((function(){return r.getTextSelection().insertTextBoxWithContent(e,t)}))}},{key:"fmtChpx",value:function(e){var t=this;return this._editCommon((function(){return t.getTextSelection().fmtInner(e,!0,"fmtChpx","txtStrmFmtChpxV2")}))}},{key:"fmtChpx2",value:function(e,t,r){var n=this;return this._editCommon((function(){return n.getTextSelection().fmtInner(e,!1,"fmtChpx","txtStrmFmtChpxV2",t,r)}))}},{key:"fmtPapx",value:function(e,t,r){var n=this;return this._editCommon((function(){return n.getTextSelection().fmtInner(e,!1,"fmtPapx","txtStrmFmtPapxV2",t,r)}))}},{key:"cmdFmtChpx",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._editCommon((function(){return n.getTextSelection().cmdFmtChpx(e,t,r,i)}))}},{key:"cmdFmtChpxCell",value:function(e,t,r,n){var i=this;this._editCommon((function(){return i.getTextSelection().cmdFmtChpxCell(e,t,r,n)}))}},{key:"cmdFmtPapx",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._editCommon((function(){return n.getTextSelection().cmdFmtPapx(e,t,r,i)}))}},{key:"modifyTextFrameProperty",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._editCommon((function(){return t.getTextSelection().modifyTextFrameProperty(e,r)}))}},{key:"insertShape",value:function(e,t,r,n,i){var a=this,o={group:e,item:t,rect:r,bCopyDefProps:n,bDefCreate:i};return this._insertShapeCommon(o,(function(){return a.getShapeSelection().insertShape(o)}))}},{key:"deleteShape",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._editCommon((function(){return e.getShapeSelection().deleteShape(t),!0}))}},{key:"moveShape",value:function(e){var t=this;return this._editCommon((function(){return t.getShapeSelection().moveShape(e),!0}))}},{key:"insertPicture",value:function(e,t,r){var n=this,i={rect:e,uploadId:t,extParams:r,bCopyDefProps:!1,bDefCreate:!1};return this._insertShapeCommon(i,(function(){return n.getShapeSelection().insertPicture(i)}))}},{key:"insertMedia",value:function(e,t,r,n,i,a,o){var s=this,l={rect:e,uploadId:t,mediaName:r,mediaDataType:n,mediaType:i,mediaSubType:a,extParams:o,bCopyDefProps:!1,bDefCreate:!1};return this._insertShapeCommon(l,(function(){return s.getShapeSelection().insertMedia(l)}))}},{key:"insertProcessOn",value:function(e,t,r,n,i){var a=this,o={rect:e,uploadId:t,category:r,fileId:n,definition:i,bCopyDefProps:!1};return this._insertShapeCommon(o,(function(){return a.getShapeSelection().insertProcessOn(o)}))}},{key:"insertSvgPicture",value:function(e,t){var r=this,n={rect:e,svgData:t,bCopyDefProps:!1};return this._insertShapeCommon(n,(function(){return r.getShapeSelection().insertSvgPicture(n)}))}},{key:"insertInk",value:function(e){var t=e.rect,r=e.brushColor,n=e.lineWidth,i=e.trace,a=this,o={rect:t,brushColor:r,lineWidth:n,trace:i};return this._insertShapeCommon(o,(function(){return a.getShapeSelection().insertInk(o)}))}},{key:"insertInkNoTransact",value:function(e){var t=e.rect,r=e.brushColor,n=e.lineWidth,i=e.trace,a=this,o={rect:t,brushColor:r,lineWidth:n,trace:i};return this._insertShapeCommon(o,(function(){return a.getShapeSelection().insertInkNoTransact(o)}),!0)}},{key:"deleteInkNoTransact",value:function(e){var t=this;return this._editCommon((function(){return t.getShapeSelection().deleteInkNoTransact(e),!0}),!0)}},{key:"deleteAllInkNoTransact",value:function(){var e=this;return this._editCommon((function(){return e.getPresentationSelection().deleteAllInkNoTransact(),!0}),!0)}},{key:"insertTextBox",value:function(e,t,r,n){var i=this,a={orientation:e,rect:t,bCopyDefProps:r,bDefCreate:n};return"object"===(void 0===e?"undefined":ut()(e))&&(t=e.rect,r=e.bCopyDefProps,n=e.bDefCreate,e=e.orientation,a={orientation:e,rect:t,bCopyDefProps:r,bDefCreate:n}),this._insertShapeCommon(a,(function(){return null==n&&("horizontal"===e?(t.width=3098800,t.height=368300):(t.width=459740,t.height=2184400),a.rect=t,a.bDefCreate=!1),i.getShapeSelection().insertTextBox(a)}))}},{key:"insertTable",value:function(e,t,r,n,i){var a=this,o=null;return o=n?{rect:e,rows:t,cols:r,styleId:n}:{rect:e,rows:t,cols:r},this._insertShapeCommon(o,(function(){return i?a.getShapeSelection().insertTable2Ph(o,i):a.getShapeSelection().insertTable(o)}))}},{key:"insertChart",value:function(e,t,r,n){return this.getChartSelection().insertChart(e,t,r,n)}},{key:"modifyShapeProperties",value:function(e){var t=this;return this._editCommon((function(){return t.getShapeSelection().modifyShapeProperties(e)}))}},{key:"modifyShapePropertiesBatch",value:function(e){var t=this;return this._editCommon((function(){return t.getShapeSelection().modifyShapePropertiesBatch(e)}))}},{key:"modifyTblCellProperties",value:function(e){var t=this;return this._editCommon((function(){if(null!=e)return t.getTableSelection().modifyCellsProperty(e)}))}},{key:"applyShapeModifiers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._editCommon((function(){var n=t.getShapeSelection(),i=n._createShapeModifierBatch(e,r);return n.modifyShapePropertiesBatch(i)}))}},{key:"applyShapeModifiersNoTransact",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._editCommon((function(){var n=t.getShapeSelection(),i=n._createShapeModifierBatch(e,r);return n.modifyShapePropsBatchNoTransact(i)}),!0)}},{key:"modifyShapeTransform2D",value:function(e){var t=this;return this._editCommon((function(){return t.getShapeSelection().modifyShapeTransform2D(e)}))}},{key:"shapeGroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._editCommon((function(){e.getShapeSelection().shapeGroup(t)}))}},{key:"shapeUngroup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._editCommon((function(){e.getShapeSelection().shapeUngroup(t)}))}},{key:"modifyConnectorRoute",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._editCommon((function(){t.getShapeSelection().modifyConnectorRoute(e,r)}))}},{key:"insertSlide",value:function(e,t){var r=this,n=this.getActiveSlide();if(!n||"slides"===n.category)return this._editCommon((function(){return r.getSlideSelection().insertSlide(e,t)}));console.log("Unsupport operation")}},{key:"insertSlideNoPh",value:function(e,t){var r=this,n=this.getActiveSlide();if(!n||"slides"===n.category)return this._editCommon((function(){return r.getSlideSelection().insertSlide(e,t,!0)}));console.log("Unsupport operation")}},{key:"insert3rdpartySlide",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments[2],i=this.getActiveSlide();if(!i||"slides"===i.category)return this._editCommon((function(){return t.getSlideSelection().insert3rdpartySlide(e,r,n)}));console.log("Unsupport operation")}},{key:"insert3rdpartySlides",value:function(e){var t=this;if(e&&0!==e.length){if("slides"===this.category())return this._editCommon((function(){return t.getSlideSelection().insert3rdpartySlides(e)}));console.warn("Unsupport operation")}}},{key:"deleteSlide",value:function(e){var t=this;return this._editCommon((function(){return t.getSlideSelection().deleteSlide(e)}))}},{key:"deleteSlideV2",value:function(){var e=this;return this._editCommon((function(){return e.getSlideSelection().deleteSlideV2()}))}},{key:"moveSlide",value:function(e,t){var r=this,n=this.getActiveSlide();if(n&&"slides"===n.category)return this._editCommon((function(){return r.getSlideSelection().moveSlide(e,t)}));console.log("Unsupport operation")}},{key:"moveSlideV2",value:function(e){var t=this;return this._editCommon((function(){return t.getSlideSelection().moveSlideV2(e)}))}},{key:"modifySlideProperties",value:function(e){var t=this;return this._editCommon((function(){return t.getSlideSelection().modifySlideProperties(e)}))}},{key:"modifySlidePropertiesV2",value:function(e){var t=this;return this._editCommon((function(){return t.getSlideSelection().modifySlidePropertiesV2(e)}))}},{key:"modifySlideBackground",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setFlag("applyForAll",t),this.modifySlideProperties(e)}},{key:"modifySlideTransition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setFlag("applyForAll",t),this.modifySlideProperties(e)}},{key:"modifyLocalLayout",value:function(e,t){var r=this;return this._editCommon((function(){return r.getSlideSelection().modifyLocalLayout(e,t)}))}},{key:"setAllInkHidden",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getPresentationSelection().setAllInkHidden(e,t)}},{key:"removeAllInk",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._editCommon((function(){return e.getPresentationSelection().removeAllInk(t)}))}},{key:"commentHandler",value:function(e,t,r,n){var i=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return this._editCommon((function(){return i.getSlideSelection().commentHandler(e,t,r,n,a)}),!0)}},{key:"commentModify",value:function(e,t,r){var n=this;this._editCommon((function(){n.getSlideSelection().commentModify(e,t,r)}),!0)}},{key:"modifyPresentationConfigs",value:function(e){var t=this;this._editCommon((function(){return t.getPresentationSelection().modifyPresentationConfigs(e)}))}},{key:"modifyPresentationProps",value:function(e){this.getPresentationSelection().modifyPresentationProps(e)}},{key:"startComposition",value:function(){return this._getTextCompositor().startComposition()}},{key:"updateComposition",value:function(e,t){var r=this;this._editCommon((function(){r._getTextCompositor().updateComposition(e,t)}))}},{key:"endComposition",value:function(e,t){var r=this;this._editCommon((function(){r._getTextCompositor().endComposition(e,t)}))}},{key:"forceEndComposition",value:function(){var e=this;this._editCommon((function(){e._getTextCompositor().forceEndComposition()}))}},{key:"updateRemark",value:function(e){var t=this;return this._editCommon((function(){return t.getTextSelection().updateRemark(e)}))}},{key:"applyDocumentBeautify",value:function(e,t){var r=this;return this._editCommon((function(){switch(e){case"slides":return r.getSlideSelection().applySlidesBeautify(t);case"shapes":return r.getShapeSelection().applyShapesBeautify(t)}}))}},{key:"insertDiagram",value:function(e,t){var r=this;return this._editCommon((function(){return r.getShapeSelection().insertDiagram(e,t)}))}},{key:"setTriggerStatus",value:function(e){this._isUserTriggered=e}},{key:"selectText",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectText(e,r)}))}},{key:"clearTextSelect",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().clearTextSelect()}))}},{key:"selectShapeAt",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectShapeAt(e)}))}},{key:"selectShape",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._changeCoreSltCommon((function(){t._getSelectionChanger().selectShape(e,r)}))}},{key:"selectShapes",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectShapes(e)}))}},{key:"addSelectShapeAt",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().addSelectShapeAt(e)}))}},{key:"addSelectShape",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._changeCoreSltCommon((function(){t._getSelectionChanger().addSelectShape(e,r)}))}},{key:"removeSelectShape",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().removeSelectShape(e)}))}},{key:"clearShapeSelect",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().clearShapeSelect()}))}},{key:"selectSlideAt",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"slides",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:D.WppLayerType.WppLayerNormalSlide;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectSlideAt(e,r,n)}))}},{key:"selectSlide",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectSlide(e)}))}},{key:"selectPreviousSlide",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().selectPreviousSlide()}))}},{key:"selectNextSlide",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().selectNextSlide()}))}},{key:"clearSlideSelect",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().clearSlideSelect()}))}},{key:"selectTableCellAt",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectTableCellAt(e)}))}},{key:"selectTableCell",value:function(e,t){var r=this;this._changeCoreSltCommon((function(){r._getSelectionChanger().selectTableCell(e,t)}))}},{key:"selectTableCells",value:function(e,t,r,n){var i=this;this._changeCoreSltCommon((function(){i._getSelectionChanger().selectTableCells(e,t,r,n)}))}},{key:"selectTblRange",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectTblRange(e)}))}},{key:"clearCellSelect",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().clearCellSelect()}))}},{key:"selectAnimAt",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectAnimAt(e)}))}},{key:"selectAnimations",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectAnimations(e)}))}},{key:"selectAnimsDirectly",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectAnimsDirectly(e)}))}},{key:"selectAnimation",value:function(e){var t=this;this._changeCoreSltCommon((function(){t._getSelectionChanger().selectAnimation(e)}))}},{key:"clearAnimationSelect",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().clearAnimationSelect()}))}},{key:"selectNotePageText",value:function(){var e=this;this._changeCoreSltCommon((function(){e._getSelectionChanger().selectNotePageText()}))}},{key:"selectRemark",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._changeCoreSltCommon((function(){e._getSelectionChanger().selectRemark(t,r)}))}},{key:"addShapeListener",value:function(e){this._getSelectionChanger().addShapeListener(e)}},{key:"removeShapeListener",value:function(e){this._getSelectionChanger().removeShapeListener(e)}},{key:"onShapeSelChange",value:function(){this._getSelectionChanger().onShapeSelChange()}},{key:"canCopy",value:function(){return this.presentation.copypasteMgr?this.state!==ue.c.select_text&&this.state!==ue.c.select_multi_animation||this._data.begin!==this._data.end:(console.warn("copypaste manager not ready"),!1)}},{key:"canCut",value:function(){return this.readonly?(this.fire(ue.b.ERROR_READONLY),!1):this.presentation.copypasteMgr?this.state!==ue.c.select_text&&this.state!==ue.c.select_multi_animation||this._data.begin!==this._data.end:(console.warn("copypaste manager not ready"),!1)}},{key:"canPaste",value:function(){return this.readonly?(this.fire(ue.b.ERROR_READONLY),!1):!!this.presentation.copypasteMgr||(console.warn("copypaste manager not ready"),!1)}},{key:"canStashFormat",value:function(){return this.presentation.formatBrush?this.state!==ue.c.select_none:(console.warn("format brush not ready"),!1)}},{key:"checkBrush",value:function(){return this.readonly?(this.fire(ue.b.ERROR_READONLY),!1):this.presentation.formatBrush.checkBrush()}},{key:"dragPasteShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._editCommon((function(){return e.presentation.copypasteMgr.dragPasteShapes(t)}))}},{key:"mockCoreError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"edit";this.mockCore=e}},{key:"handleMockError",value:function(e){throw new Error(e)}},{key:"_getEditor",value:function(e){if(!window.CoreDataEditor)return null;this._editors||(this._editors={});var t=this._editors[e];if(!t){var r=window.CoreDataEditor.selection;switch(e){case"Slide":t=new r.SlideSelection(this,this._data);break;case"Shape":t=new r.ShapeSelection(this,this._data);break;case"Text":t=new r.TextSelection(this,this._data);break;case"Table":t=new r.TableSelection(this,this._data);break;case"Animation":t=new r.AnimationSelection(this,this._data);break;case"Chart":t=new r.ChartSelection(this,this._data);break;case"Presentation":t=new r.PresentationSelection(this,this._data)}t&&(this._editors[e]=t)}return t}},{key:"_getSelectionChanger",value:function(){return this._sltChanger||(this._sltChanger=new ft(this)),this._sltChanger}},{key:"_getTextCompositor",value:function(){return this._textCompositor||(this._textCompositor=new vt(this)),this._textCompositor}},{key:"_isValidTextStream",value:function(e){for(var t=e;t;){if(t.isSlideType&&t===this._data.activeSlide)return!0;t=t.parent}return!1}},{key:"_getStateString",value:function(){return this._data.getStateStr()}},{key:"_doNotAutoRemoveTextBox",value:function(e){this._autoRemoveTextBox=!1,e(),this._autoRemoveTextBox=!0}},{key:"_fireReadOnly",value:function(){if(this.readonly)return this.fire(ue.b.ERROR_READONLY),!0}},{key:"_insertShapeCommon",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.readonly||r){var n=this.presentation,i=!1;try{if(!window.CoreDataEditor)return void(i=!0);if("edit"===this.mockCore&&this.handleMockError("mock selection edit error"),!e||"object"!==ut()(e.rect))return console.error("Invalid param rect"),void(i=!0);this.transaction.beginBatchCommand();var a=this._getSelectionChanger();a.checkNeedRemoved();var o=t();return o?(this.transaction.endBatchCommand(),this.fire(window.DataFace.Selection.EventTypes.SEND_SELECTION,{bUpdateActiveConnId:!0})):this.transaction.rollback(),i=!0,o}catch(e){console.error(e.stack);var s={name:"edit_blocking",type:"edit",err:e.toString(),stack:e.stack};throw console.error(e),new Error(JSON.stringify(s))}finally{i||n.fire(ue.b.ERROR_CORE)}}else this.fire(ue.b.ERROR_READONLY)}},{key:"_editCommon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.readonly&&!t)return this.fire(ue.b.ERROR_READONLY),{err:m.WppErrStr.E_WPP_READ_ONLY};var r=this.presentation,n=!1;try{if(!window.CoreDataEditor)return n=!0,{err:m.WppErrStr.E_WPP_CORE_EDITOR_UNLOADED};"edit"===this.mockCore&&this.handleMockError("mock selection edit error"),this._beforeExecCommand();var i=e();return this._afterExecCommand(),n=!0,i}catch(e){var a={name:"edit_blocking",type:"edit",err:e.toString(),stack:e.stack};throw new Error(JSON.stringify(a))}finally{n||r.fire(ue.b.ERROR_CORE)}}},{key:"_beforeExecCommand",value:function(){}},{key:"_afterExecCommand",value:function(){this.clearPropsCache(),this.fire(window.DataFace.Selection.EventTypes.SEND_SELECTION,{bUpdateActiveConnId:!0})}},{key:"_changeCoreSltCommon",value:function(e){var t=!1,r=this.getPresentation();try{"select"===this.mockCore&&this.handleMockError("mock selection change error"),this._beforeChangeCoreSlt(),e(),this._afterChangeCoreSlt(),t=!0}catch(e){var n={name:"edit_blocking",type:"selection",err:e.toString(),stack:e.stack};throw new Error(JSON.stringify(n))}finally{t||r.fire("error_core")}}},{key:"_beforeChangeCoreSlt",value:function(){this.inComposition&&this._isUserTriggered&&this.forceEndComposition(),this._data.resetStateList(),window.APP.isDoingCmdResponse||(this._doingShapes=[]),this._data._slideInsertion=null}},{key:"_afterChangeCoreSlt",value:function(){var e=this._data,t=e.getStateList();t&&0!==t.length&&(!window.APP.isDoingCmdResponse&&this._isUserTriggered&&delete this._fontProp,this._makeNewVer(),e.resetStateList())}},{key:"_makeNewVer",value:function(){this._getSelectionChanger().makeNewVer()}},{key:"_calcRealRange",value:function(e,t,r,n,i){return this._getSelectionChanger()._calcRealRange(e,t,r,n,i)}},{key:"_getSelectionData",value:function(){return this._data}},{key:"id",get:function(){return this.getUid()}},{key:"inComposition",get:function(){return!!this._textCompositor&&this._getTextCompositor().inComposition}},{key:"ksDocClipboardId",get:function(){return this.presentation.copypasteMgr.localClipboardID}}]),t}(ct),mt=(r(1714),function(){function e(t){i()(this,e),this.selection=t}return o()(e,[{key:"checkState",value:function(){return this.selection.state===m.SelectType.select_shape||this.selection.state===m.SelectType.select_multi_shape||this.selection.state===m.SelectType.select_text||this.selection.state===m.SelectType.select_multi_animation}},{key:"previewAnimation",value:function(e,t){if(!this.checkState())return!1;var r=this.selection.getActiveSlide();if(!r)return!1;var n=r.getTiming();if(!n)return!1;var i=this.selection.getActiveShapes();if(i&&!(i.length<=0)){for(var a=[],o=0;o<i.length;++o){var s=i[o].visual.getRootShape(),l=this._previewOneAnimation(s,e,t);l&&l.length>0&&(a=a.concat(l))}if(a.length>0){var u=pt.a.filterPreviewAnims(a);u.length>0&&n._firePreview(u)}}}},{key:"_previewOneAnimation",value:function(e,t,r){var n=pt.a.findEffectLevel(e),i=e.hasChartTemp()&&n!==_e.AnimLevel.LevelNone,a=this.selection.getRange();return i||r!==_e.AnimPresetType.ChangeFillColor&&r!==_e.AnimPresetType.ChangeLineColor?e.isGroupShape()||e.hasTable()?this._previewOneShapeAnim(e,t,r):this.selection.state===m.SelectType.select_text&&a.begin>=0&&a.end>=0?this._previewOneParaAnim(e,a,t,r):this._previewOneShapeAnim(e,t,r):this._previewOneSpecailAnim(e,t,r)}},{key:"_previewOneSpecailAnim",value:function(e,t,r){var n={presetId:r,targetShapeId:e.getId(),nodeType:_e.AnimNodeType.Effect,presetClass:Object(_e.animCategoryStr)(t)},i=pt.a.createNode(_e.AnimNodeType.Effect,n);if(!i)return!1;if(!window.aeoFactory)return console.assert("aeoFactory not load"),!1;var a=window.aeoFactory.get(t,r);if(a)return a.create(i),[i];console.error("effect wrapper not found")}},{key:"_previewOneParaAnim",value:function(e,t,r,n){var i=e.getTextFrame(),a=i&&i.getTextStream();if(!a)return!1;for(var o=[],s=a.papTbl.getItems(t.begin,t.end-t.begin),l=0;l<s.length;++l){var u=s[l].getBegin(),c={presetType:n,presetClass:Object(_e.animCategoryStr)(r),animCategory:r,targetShapeId:e.getId(),nodeType:_e.AnimNodeType.Effect},h=pt.a.createNode(_e.AnimNodeType.Effect,c);if(!h)return!1;if(!window.aeoFactory)return console.assert("aeoFactory not load"),!1;var d=window.aeoFactory.get(r,n);if(!d)return console.error("effect wrapper not found"),!1;d.create(h);var p=a.papTbl.findIndex(u);h.setParaStart(p),h.setParaEnd(p),o.push(h)}return o}},{key:"_previewOneShapeAnim",value:function(e,t,r){var n={presetType:r,presetClass:Object(_e.animCategoryStr)(t),animCategory:t,targetShapeId:e.getId(),nodeType:_e.AnimNodeType.Effect},i=pt.a.createNode(_e.AnimNodeType.Effect,n);if(!i)return!1;if(!window.aeoFactory)return console.assert("aeoFactory not load"),!1;var a=window.aeoFactory.get(t,r);if(a)return a.create(i),[i];console.error("effect wrapper not found")}}]),e}()),_t=r(1907),St=r(1148),Tt=r(3157),bt=r.n(Tt),kt=r(3158),Ct=r.n(kt);r(1712);function wt(){bt()((function(e){window.aeoFactory=e.aeoWrapperFactory}))}function Pt(){Ct()((function(e){window.CoreDataEditor=e}))}},154:function(e,t,r){"use strict";t.__esModule=!0;var n=a(r(270)),i=a(r(271));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,r,a){null===t&&(t=Function.prototype);var o=(0,i.default)(t,r);if(void 0===o){var s=(0,n.default)(t);return null===s?void 0:e(s,r,a)}if("value"in o)return o.value;var l=o.get;return void 0!==l?l.call(a):void 0}},158:function(e,t,r){"use strict";r.r(t),r.d(t,"UnitType",(function(){return u})),r.d(t,"FormatOpType",(function(){return c})),r.d(t,"StyleSti",(function(){return h})),r.d(t,"EditorEventTypes",(function(){return d})),r.d(t,"DirectionTypes",(function(){return p})),r.d(t,"UserEventTypes",(function(){return f})),r.d(t,"FocusTargetsDef",(function(){return v})),r.d(t,"ModelNamesDef",(function(){return y})),r.d(t,"DeviceType",(function(){return g})),r.d(t,"actionType",(function(){return m})),r.d(t,"ShapeGroupType",(function(){return _})),r.d(t,"RotateType",(function(){return S})),r.d(t,"TileTypes",(function(){return T})),r.d(t,"BorderType",(function(){return b})),r.d(t,"TblStyleOp",(function(){return k})),r.d(t,"TblSelBorderType",(function(){return C})),r.d(t,"LinkType",(function(){return w})),r.d(t,"WppLayerType",(function(){return P})),r.d(t,"FeatureType",(function(){return x})),r.d(t,"BlibFillType",(function(){return O})),r.d(t,"LineType",(function(){return E})),r.d(t,"LineValueMap",(function(){return I})),r.d(t,"USER_CUSTOM_CURSOR",(function(){return A})),r.d(t,"LineEndType",(function(){return R})),r.d(t,"ExplainBehaviorCmd",(function(){return D})),r.d(t,"ExplainType",(function(){return L})),r.d(t,"ExplainMode",(function(){return N})),r.d(t,"SlideType",(function(){return M}));var n=r(150),i=r.n(n),a=r(167);r.d(t,"ListType",(function(){return a.ListType})),r.d(t,"HorzAlignMode",(function(){return a.HorzAlignMode})),r.d(t,"ViewModes",(function(){return a.ViewModes})),r.d(t,"TextDirectionType",(function(){return a.TextDirectionType})),r.d(t,"TextAnchoringType",(function(){return a.TextAnchoringType})),r.d(t,"AutoFit",(function(){return a.AutoFit})),r.d(t,"TextWrap",(function(){return a.TextWrap})),r.d(t,"CursorType",(function(){return a.CursorType})),r.d(t,"SelectType",(function(){return a.SelectType})),r.d(t,"CommentActionType",(function(){return a.CommentActionType})),r.d(t,"CompositionState",(function(){return a.CompositionState})),r.d(t,"NoWidthLineStyle",(function(){return a.NoWidthLineStyle})),r.d(t,"UnderlineMode",(function(){return a.UnderlineMode})),r.d(t,"FillType",(function(){return a.FillType})),r.d(t,"VIEW_EVENT_TYPES",(function(){return a.VIEW_EVENT_TYPES})),r.d(t,"PlaceholderType",(function(){return a.PlaceholderType})),r.d(t,"WpActionType",(function(){return a.WpActionType})),r.d(t,"ShapeType",(function(){return a.ShapeType})),r.d(t,"TblBorderType",(function(){return a.TblBorderType})),r.d(t,"ShapeModeType",(function(){return a.ShapeModeType})),r.d(t,"MediaType",(function(){return a.MediaType})),r.d(t,"MediaSubType",(function(){return a.MediaSubType})),r.d(t,"MediaDataType",(function(){return a.MediaDataType})),r.d(t,"TableOPT",(function(){return a.TableOPT})),r.d(t,"WhiteBoardShapeType",(function(){return a.WhiteBoardShapeType})),r.d(t,"FormatBrushType",(function(){return a.FormatBrushType})),r.d(t,"PartOfShapeName",(function(){return a.PartOfShapeName})),r.d(t,"ShowAdvanceMode",(function(){return a.ShowAdvanceMode})),r.d(t,"CoreErrorType",(function(){return a.CoreErrorType})),r.d(t,"ActionLinkToType",(function(){return a.ActionLinkToType})),r.d(t,"DefThemeLangInfo",(function(){return a.DefThemeLangInfo}));var o=r(664);r.d(t,"OPENAPI_EVENT",(function(){return o.OPENAPI_EVENT}));var s,l=r(144);r.d(t,"userAgent",(function(){return l}));var u={Unit_pt:0,Unit_inc:1,Unit_cm:2,Unit_mm:3,Unit_ref:4,Unit_ti:5},c={Font_Bold:0,Font_Italic:1,Font_Underline:2,Font_StrikeThrough:3,Font_FontSize:4,Font_GrowUp:5,Font_Superscript:6,Font_Subscript:7,Font_Name:8,Font_Color:9,Para_ChangeIndent:10,Para_Alignment:11,Style_ApplyToRange:12,Para_LineSpacingRel:13,Para_ChangeFirstLineIndent:14,List_ApplyToRange:15,Para_RemoveIndent:16,Font_HighlightColor:99,Font_AllCaps:50,Font_SmallCaps:51,Font_DoubleStrikeThrough:52,Font_EmphasisMark:53,Font_Hidden:54,Font_Scaling:55,Font_Spacing:56,Font_Actions:57,Para_ReadingOrder:100,Para_LeftIndentAbsAndRef:101,Para_FirstLineIndentAbsAndRef:102,Para_RightIndentAbsAndRef:103,Para_SpaceBeforeAbsAndRef:104,Para_SpaceAfterAbsAndRef:105,Para_OutlineLevel:106,Para_FarEastLineBreakControl:107,Para_WordWrap:108,Para_HangingPunctuation:109,Para_HalfWidthPunctuationOnTopOfLine:110,Para_AddSpaceBetweenFarEastAndAlpha:111,Para_AddSpaceBetweenFarEastAndDigit:112,Para_Indentation:113,Sec_Margins:200,Sec_PageOrientation:201},h={stiNormal:0,stiLev1:1,stiLev2:2,stiLev3:3,stiLev4:4,stiNormalChar:65,stiMax:260,stiUser:4094,stiNil:4095},d={SELECT_CHANGE:"select_change",PICTURE_INSERT:"picture_insert",PICTURE_EDIT:"picture_edit"},p={LEFT:"left",RIGHT:"right",BOTTOM_RIGHT:"BOTTOM_RIGHT",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_CENTER:"BOTTOM_CENTER",BOTTOM:"BOTTOM",TOP:"TOP",TOP_RIGHT:"TOP_RIGHT",TOP_LEFT:"TOP_LEFT",TOP_CENTER:"TOP_CENTER",RIGHT_TOP:"RIGHT_TOP",RIGHT_CENTER:"RIGHT_CENTER",RIGHT_BOTTOM:"RIGHT_BOTTOM",COOP_ICON_HOVER_RIGHT:"COOP_ICON_HOVER_RIGHT"},f={KEY_EVENT:"key_event",MOUSE_ACTION:"mouse_action"},v={COMMON:"common",CONTAINER:"container",SLIDE:"slide",SHAPE:"shape",PLAY_View:"play_view",PREVIEW:"preview"},y={paragraph:"paragraph",chapter:"chapter",common:"common",container:"container",slide:"slide",shape:"shape",link:"link",fill:"fill",outline:"outline",action:"action",ink:"ink",connector:"connector",explain:"explain"},g={DEVICE_PC:0,DEVICE_MOBILE:1},m={Move_Shape:1,Resize_Shape:2,Rotate_Shape:3,Modify_Picture:4,Modify_Processon:5,Modify_Fill:6,Modify_Outline:7,Modify_Geometry:8,Modify_TextFont:9,Modify_Media:10,Modify_Table:11,Modify_Chart:12,Modify_InkData:13,Shape_Replace:14,Modify_Hyperlink:15,Modify_TextFrameProps:16,Modify_Property:17,Tile_Shapes:18,Modify_Line:19,Modify_Picture_Props:20,not_used:21,Modify_Border:22,Modify_Effects:23,Modify_ExtData:24,Modify_Actions:25},_={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9},S={VerticalFlipped:"verticalFlipped",HorizontalFlipped:"horizontalFlipped",Right:"right",Left:"left",Some:"some",Reset:"reset"},T={Top:"top",Right:"right",Bottom:"bottom",Left:"left",Center:"center",VerCenter:"ver_center",VerAverage:"ver_average",HorCenter:"hor_center",HorAverage:"hor_average"},b={BorderTop:1,BorderLeft:2,BorderBottom:3,BorderRight:4,BorderDiagonalDown:5,BorderDiagonalUp:6,BorderHorizontal:7,BorderVertical:8},k={HeaderRow:1,FirstCol:2,TotalRow:3,LastCol:4,BandedRows:5,BandedCols:6},C={Invalid:0,AllBorder:1,MiddleBorder:2,LeftBorder:3,RightBorder:4,TopBorder:5,BottomBorder:6,InsideHBorder:7,InsideVBorder:8,OutBorder:9,NonBorder:10},w={web:"web",email:"email",slideRlt:"slideRelative",slideAsl:"slideAbsolute"},P={WppLayerDocument:65536,WppLayerSlideContainer:65537,WppLayerNormalSlide:65538,WppLayerMasterSlide:65539,WppLayerLayoutSlide:65540,WppLayerHandoutSlide:65541,WppLayerNotesMaster:65542,WppLayerNotesPage:65543},x={index:"ppt",whiteboard:"kw"},O={scaleFill:0,scaleSuit:1,stretch:2,tile:3,other:4},E={SINGLE:"single",DOUBLE:"double",THIN_THICK:"thin_thick",THICK_THIN:"thick_thin",THIN_THICK_THIN:"thin_thick_thin",ROUND_DOT:"round_dot",SHORT_DASH:"short_dash",DASH_DOT:"dash_dot",DOUBLE_DOT:"double_dot",OTHER:"..."},I=(s={},i()(s,E.SINGLE,{compoundLine:0,dashType:0}),i()(s,E.DOUBLE,{compoundLine:1,dashType:0}),i()(s,E.THIN_THICK,{compoundLine:3,dashType:0}),i()(s,E.THICK_THIN,{compoundLine:2,dashType:0}),i()(s,E.THIN_THICK_THIN,{compoundLine:4,dashType:0}),i()(s,E.ROUND_DOT,{compoundLine:0,dashType:8}),i()(s,E.SHORT_DASH,{compoundLine:0,dashType:2}),i()(s,E.DASH_DOT,{compoundLine:0,dashType:4}),i()(s,E.DOUBLE_DOT,{compoundLine:1,dashType:8}),s),A={rowSelect:"cursor-row-select",colSelect:"cursor-col-select-down",rowSelectLeft:"cursor-row-select-left",rowSelectUp:"cursor-col-select-up",brushPosition:"cursor-format-position",brushAnime:"cursor-format-anime",brushPointer:"cursor-format-pointer",brushText:"cursor-format-text"},R={LineEndTypeNone:0,LineEndTypeTriangle:1,LineEndTypeStealth:2,LineEndTypeDiamond:3,LineEndTypeOval:4,LineEndTypeArrow:5},D="webwpp_explain",L={shapeAnime:"shapeAnimeExplain",slideAnime:"slideAnimeExplain"},N={play:"play",edit:"edit"},M={slide:"slides",layout:"slideLayouts",master:"slideMasters"}},167:function(e,t,r){"use strict";r.r(t),r.d(t,"MediaDataType",(function(){return i.a})),r.d(t,"MediaType",(function(){return i.c})),r.d(t,"MediaSubType",(function(){return i.b})),r.d(t,"DefThemeLangInfo",(function(){return a.a})),r.d(t,"UnderlineMode",(function(){return o})),r.d(t,"NoWidthLineStyle",(function(){return s})),r.d(t,"HorzAlignMode",(function(){return l})),r.d(t,"TextFrameAlignType",(function(){return u})),r.d(t,"ParagraphReadingOrder",(function(){return c})),r.d(t,"ListType",(function(){return h})),r.d(t,"PlaceholderType",(function(){return d})),r.d(t,"WpPlaceholder",(function(){return p})),r.d(t,"TextStyleType",(function(){return f})),r.d(t,"PlaceholderSizeType",(function(){return v})),r.d(t,"TextDirectionType",(function(){return y})),r.d(t,"TextAnchoringType",(function(){return g})),r.d(t,"TextVerticalType",(function(){return m})),r.d(t,"TextWrap",(function(){return _})),r.d(t,"AutoFit",(function(){return S})),r.d(t,"DirectionKey",(function(){return T})),r.d(t,"CursorType",(function(){return b})),r.d(t,"GlyphFactor",(function(){return k})),r.d(t,"LineSpaceRule",(function(){return C})),r.d(t,"ViewModes",(function(){return w})),r.d(t,"EditMode",(function(){return P})),r.d(t,"PhTextModifyRules",(function(){return x})),r.d(t,"SelectType",(function(){return O})),r.d(t,"CompositionState",(function(){return E})),r.d(t,"FillType",(function(){return I})),r.d(t,"WpActionType",(function(){return A})),r.d(t,"ActionLinkToType",(function(){return R})),r.d(t,"ShapeTreeInsertCommandTypes",(function(){return D})),r.d(t,"UnitsLength",(function(){return L})),r.d(t,"InkBrushType",(function(){return N})),r.d(t,"InkBrushTip",(function(){return M})),r.d(t,"InkBrushRasterOp",(function(){return F})),r.d(t,"ShapeMoveType",(function(){return B})),r.d(t,"TableOPT",(function(){return j})),r.d(t,"TblBorderType",(function(){return V})),r.d(t,"CommentActionType",(function(){return H})),r.d(t,"FormatBrushType",(function(){return G})),r.d(t,"VIEW_EVENT_TYPES",(function(){return n.VIEW_EVENT_TYPES})),r.d(t,"UpdatePartOfShape",(function(){return U})),r.d(t,"PartOfShapeName",(function(){return W})),r.d(t,"ShapeType",(function(){return z})),r.d(t,"ShapeModeType",(function(){return Y})),r.d(t,"WhiteBoardShapeType",(function(){return q})),r.d(t,"DefaultTextSize",(function(){return K})),r.d(t,"ShowAdvanceMode",(function(){return Q})),r.d(t,"CoreErrorType",(function(){return X})),r.d(t,"WppBeautifyType",(function(){return J})),r.d(t,"TransActionType",(function(){return Z})),r.d(t,"WppErrStr",(function(){return $})),r.d(t,"DocerSlideActionType",(function(){return ee}));var n=r(563),i=r(522),a=r(873),o={None:0,Normal:1,Wordonly:2},s={None:0,Single:1,Hairline:2,Double:3,Dotted:4,Hidden:5,Thick:6,Dash:7,Dot:8,DotDash:9,DotDotDash:10,Wave:11,DottedHeavy:12,DashedHeavy:13,DashLong:14,DashLongHeavy:15,DashDotHeavy:16,DashDotDotHeavy:17,WavyHeavy:18,WavyDouble:19},l={Auto:0,Left:1,Center:2,Right:3,Adjustify:4,FullAdjustify:5,MiddleJustify:6,CenterAcross:7,HighJustify:8,LowJustify:9,ThaiFullAdjustify:10},u={Left:0,Center:1,Right:2},c={ReadingOrderLtr:0,ReadingOrderRtl:1},h={NoNumbering:0,Bullet:1,Numbering:2,TaskList:3},d={Title:0,Body:1,CenterTitle:2,SubTitle:3,DateTime:4,SlideNumber:5,Footer:6,Header:7,Object:8,Chart:9,Table:10,ClipArt:11,Diagram:12,Media:13,SlideImage:14,Picture:15},p={Title:1,Body:2,CenterTitle:3,SubTitle:4,VerticalTitle:5,VerticalBody:6,Object:7,Chart:8,Bitmap:9,MediaClip:10,OrgChart:11,Table:12,SlideNumber:13,Header:14,Footer:15,Date:16},f={Title:"title",Body:"body",Other:"other",Notes:"notes"},v={PlaceholderSizeTypeFull:0,PlaceholderSizeTypeHalf:1,PlaceholderSizeTypeQuarter:2},y={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7},g={Top:0,Center:1,Bottom:2,Justified:3,Distributed:4},m={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7},_={None:0,Square:1},S={None:0,Normal:1,Advanced:2},T={Up:1,Down:2,Left:3,Right:4},b={Text:1,TextBorder:11,Shape:2,ShapeBoder:21,Table:3,TableBoder:31,TableCell:32,CellText:33,TableTop:34,TableBottom:35,TableLeft:36,TableRight:37,TableBorderVert:38,TableBorderHori:39,Link:41,Image:42,ProcessOn:43,resourceReload:66},k={compressWidth:.6,scriptHeight:.2},C={Auto:"auto",Exact:"exact",Least:"atLeast"},w={EditView:"edit",PlayView:"play",PreView:"preview",ThmubnailView:"thumbnail",NotesBody:"notesbody",Snapshot:"snapshot",Review:"review",MasterView:"masterView",MasterThumbnailView:"masterThumbnailView"},P={slide:2,layout:1,master:0},x=[{src:"",dst:""},{src:/\u6807\u9898\u6837\u5f0f/g,dst:""},{src:/edit master/gi,dst:"edit"},{src:/title style/gi,dst:"title"},{src:/\u6587\u672c\u6837\u5f0f/g,dst:""},{src:/text style/gi,dst:"text"}],O={select_none:0,select_slide:1,select_multi_slide:2,select_shape:3,select_multi_shape:4,select_table:5,select_cell:6,select_multi_cell:7,select_text:8,select_multi_animation:9,_strs:["select_none","select_slide","select_multi_slide","select_shape","select_multi_shape","select_table","select_cell","select_multi_cell","select_text","select_multi_animation"],toString:function(e){return this._strs[e]},canSelectTextType:function(e){return e===this.select_shape||e===this.select_cell||e===this.select_text||e===this.select_multi_animation}},E={NoComposition:0,Start:1,Update:2,End:3},I={FillTypeNone:0,FillTypeBackground:1,FillTypeSolidColor:2,FillTypePattern:3,FillTypeBlip:4,FillTypeGradient:5,FillTypeGroup:6},A={ActionMixed:-2,ActionNull:-1,ActionNone:0,ActionNextSlide:1,ActionPreviousSlide:2,ActionFirstSlide:3,ActionLastSlide:4,ActionLastSlideViewed:5,ActionEndShow:6,ActionHyperlink:7,ActionRunMacro:8,ActionRunProgram:9,ActionNamedSlideShow:10,ActionOLEVerb:11,ActionPlay:12},R={CustomShow:6,Slide:7,URL:8,otherPres:9,otherFile:10,None:255},D={InsertTable:0,InsertPicture:1,InsertShape:2,InsertTextBox:3,InsertProcessOn:4,InsertInk:5,InsertMedia:6,InsertSvgPicture:7},L={m:0,cm:1,mm:2,in:3,pt:4,ti:5,pc:6,em:7,ex:6},N={brushDefaultWidth4Ellipse:19050,brushDefaultHeight4Ellipse:19050,waterColorBrushDefaultWidth4Ellipse:34925,waterColorBrushDefaultHeight4Ellipse:34925,brushDefaultWidth4Rectangle:31750,brushDefaultHeight4Rectangle:127e3},M={ellipse:0,rectangle:1,drop:2},F={CopyPen:0,MaskPen:1,NoOperation:2},B={Front:1,Back:2,Forward:3,Backward:4},j={InsertRow:1,InsertCol:2,DeleteRows:3,InsertRowFake:4,DeleteCols:5,InsertColFake:6,SplitCells:7,UnSplitCells:8,MergeCells:9,UnMergeCells:10,ModCells:11,ModTable:12,DistributeRows:13,DistributeCols:14,SetVertPos:15,SetHoriPos:16,SetRowHeight:17,SetColWidth:18},V={Top:1,Left:2,Right:3,Bottom:4,TL2BR:5,TR2BL:6},H={AddComment:0,DeleteComment:1,ModifyComment:2,ThumbsUpComment:3,OnceMoreComment:4},G={Invalid:-1,Common:0,Transform2D:1,Animation:2},U={UpdateShape:1,UpdateText:2,UpdateTableCell:3,UpdateShapePic:4,UpdateShapePicFill:5},W={Shape:function(e){return"s_"+e},BackendShape:function(e){return"backend_s_"+e},Geomerty:function(e){return"s_"+e+"_geomerty"},Media:function(e){return"s_"+e+"_media"},Text:function(e){return"s_"+e+"_text"},TextParagraph:function(e){return"s_"+e+"_textParagraph"},Ink:function(e){return"s_"+e+"_ink"},Table:function(e){return"s_"+e+"_table"},TableCell:function(e){return"s_"+e+"_tableCell"},TableText:function(e){return"s_"+e+"_tableText"},TableBorder:function(e){return"s_"+e+"_tableBorder"},ShapeFill:function(e,t){return"s_"+e+"_shapeFill_"+t},ShapeImage:function(e,t){return"s_"+e+"_image_"+t},ShapeFillPath:function(){return"shape_fill"},ShapeOutlinePath:function(){return"shape_outline"}},z={Picture:1,NormalShape:2,TextBox:3,Processon:4,Table:5,SmartArt:6,Diagram:7,Chart:8,Slicer:9,Media:10,OleShape:11,GroupShape:12,Background:13,Ink:14},Y={MODEL_CHART:0,MODEL_DIAGRAM:1,MODEL_DIAGRAM_SHAPETREE:2,MODEL_DIAGRAM_GROUPSHAPE:3,MODEL_DIAGRAM_SHAPE:4,MODEL_SMARTART:5,MODEL_SMARTART_SHAPETREE:6,MODEL_SMARTART_GROUPSHAPE:7,MODEL_SMARTART_SHAPE:8,MODEL_SMARTART_PICTURE_PLACEHOLDER:9,MODEL_OBJTABLE:10,MODEL_OBJTABLE_CELL:11,MODEL_TEXTFRAME:12,MODEL_OUTLINE:13,MODEL_SLICER:14,MODEL_CHART_SUBMODEL_BEGIN:15,MODEL_CHART_SUBMODEL_END:270,MODEL_CUSTOM:65536,MODEL_SLIDECONTAINER:65537,MODEL_NORMALSLIDE:65538,MODEL_MASTERSLIDE:65539,MODEL_LAYOUTSLIDE:65540,MODEL_HANDOUTMASTER:65541,MODEL_NOTESMASTER:65542,MODEL_NOTESPAGE:65543,MODEL_SHAPETREE:65544,MODEL_BGSHAPE:65545,MODEL_GROUPSHAPE:65546,MODEL_SHAPE:65547,MODEL_OUTLINE_TEXTFRAME:65548},q={StickyNotes:1},K=18,Q={mixed:-2,onClick:1,onTime:2},X={LocalTransactErr:1,ServerDataErr:2,ServerQueryErr:3,SessionErr:4,SelectionErr:5},J={Invalid:-1,Presentation:0,Slide:1,Shape:2},Z={None:"none",Forward:"forward",BackWard:"backward"},$={E_WPP_READ_ONLY:"read_only",E_WPP_CORE_INTERNAL_ERROR:"core_internal_error",E_WPP_CORE_EDITOR_UNLOADED:"core_editor_unloaded",E_WPP_INVALID_IN_PARAMETER:"invalid_in_parameter",E_WPP_INVALID_SELECT_STATE:"invalid_select_state",E_WPP_SLIDES_UNLOADED:"slides_unloaded"},ee={Invalid:-1,InsertSlide:0,ModifySlide:1,InsertDesign:2,DeleteDesign:3,InsertSlides:4}},1711:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return h}));var n=r(26),i=r.n(n),a=Math.atan2,o=Math.sin,s=Math.cos,l=Math.PI/180;function u(e,t,r){var n=a(e.y-t.y,e.x-t.x),i=a(r.y-t.y,r.x-t.x),o=(i-n)/l;return o<0&&(o=360+o),o%=360}function c(e,t,r){var n=e.x,i=e.y,a=e.width,l=e.height,u=Math.PI/180*r,c=(n-t.x)*s(u)-(i-t.y)*o(u)+t.x,h=(n-t.x)*o(u)+(i-t.y)*s(u)+t.y,d=((n+=a)-t.x)*s(u)-(i-t.y)*o(u)+t.x,p=(n-t.x)*o(u)+(i-t.y)*s(u)+t.y;i+=l;var f=(n-t.x)*s(u)-(i-t.y)*o(u)+t.x,v=(n-t.x)*o(u)+(i-t.y)*s(u)+t.y,y=((n-=a)-t.x)*s(u)-(i-t.y)*o(u)+t.x,g=(n-t.x)*o(u)+(i-t.y)*s(u)+t.y,m=Math.min(c,d,f,y),_=Math.min(h,p,v,g),S=Math.max(h,p,v,g);return{x:m,y:_,width:Math.max(c,d,f,y)-m,height:S-_}}function h(e,t){var r=i()({},e);return["x","y","width","height","top","left","bottom","right"].forEach((function(n){Object.isEmpty(e[n])||(r[n]=e[n]*t)})),r}window.zoomRect=h},1712:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=function(){function e(t,r){i()(this,e),this.className=t,this.name=r,this.__wrapperCallbacks={}}return o()(e,[{key:"_setCallback",value:function(e,t){"before"===e?this._callbackBeforeEach=t:"after"===e&&(this._callbackAfterEach=t)}},{key:"_setFunctionCallback",value:function(e,t,r){var n=this.__wrapperCallbacks[t]||{};"before"===e?n.before=r:"after"===e&&(n.after=r),this.__wrapperCallbacks[t]=n}}]),e}();function l(e,t,r){e[r]=function(){var n=arguments,i=void 0;try{t._wrapperCall={bWrapperCalled:!0,funcName:r},"function"==typeof e._callbackBeforeEach&&e._callbackBeforeEach();var a=e.__wrapperCallbacks&&e.__wrapperCallbacks[r];a&&"function"==typeof a.before&&a.before();var o=t[r];o?i=o.apply(t,n):console.error("Invalid call function "+r+" from wrapper!"),a&&"function"==typeof a.after&&a.after(),"function"==typeof e._callbackAfterEach&&e._callbackAfterEach(),t._wrapperCall=null}catch(e){throw t._wrapperCall=null,e}return i}}function u(e,t,r,n){var i=void 0,a=void 0;n.get&&(i=function(){return t[r]}),n.set&&(a=function(e){t[r]=e}),Object.defineProperty(e,r,{key:r,get:i,set:a})}function c(e,t,r,n){if(t&&r){var i=Object.getOwnPropertyDescriptors(r);for(var a in i)if("constructor"!==a&&!a.startsWith("_")&&void 0===t[a]){var o=i[a];"function"==typeof o.value?l(t,e,a):"function"!=typeof o.get&&"function"!=typeof o.set||u(t,e,a,o)}}}function h(e,t){if(e){var r=new s(e.constructor.name,t);c(e,r,e);for(var n=Object.getPrototypeOf(e);n&&"Object"!==n.constructor.name;)c(e,r,n),n=Object.getPrototypeOf(n);return r}}},1713:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=function(){function e(){i()(this,e)}return o()(e,null,[{key:"encodeComment",value:function(e,t){var r="@";return r=(r=(r=(r=r.concat(e)).concat("(")).concat(t)).concat("):")}},{key:"decodeComment",value:function(e){var t="",r=null;if(e.startsWith("@")){var n=e.indexOf("("),i=e.indexOf("):");r=e.substr(n+1,i-n-1),t=e.substr(i+2,e.length-i-2),(!r||r.length<=0)&&(t=e,r=null)}return{content:t,replyId:r}}},{key:"parseComments",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];if(!e)return{commentMap:t,replicas:r};var n=0,i=e.childs;return i.length<1||(e.version||(e.version=0),e.version++,i.forEach((function(a){if(n++,a.index=n,a.isReply){var o=a.getReplyID(),s=t[o];if(s){a.version!==e.version&&a.resetThumbsList(),a.version=e.version;var l=s.getReplyList(),u=a.getContent();if("/like"===u)s.getThumbsList().push(a);else if("/+1"===u){s.getOnceList().push(a)}else l.push(a)}else{var c=e.queryComment(o);if(-1===c)return;var h=i[c];h.version!==e.version&&h.resetThumbsList(),h.version=e.version;var d=a.getContent();if("/like"===d)h.getThumbsList().push(a);else if("/+1"===d){h.getOnceList().push(a)}}}else{var p=a.getCommentId();Object.isEmpty(t[p])?(t[p]=a,a.resetReplyList(),a.resetThumbsList()):(a.invalid=!0,r.push(a))}}))),{commentMap:t,replicas:r}}}]),e}();t.a=s},1714:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s={language:"zh-CN",altLanguage:"en-US"};Object.freeze(s);var l={language:"en-US",altLanguage:"zh-CN"};Object.freeze(l);var u={language:"ar-SA"};Object.freeze(u);var c=new(function(){function e(){i()(this,e),this.en_pnct=",./<>?;':\"[]{}\\|=-_+)(*&^%$#@!~`",this.cn_pnct="=+-&#@";var t=function(e){for(var t={},r=0,n=e.length;r<n;++r)t[e[r]]=!0;return t};this.is_cn_punc=t(this.cn_pnct),this.is_en_punc=t(this.en_pnct)}return o()(e,[{key:"isNum",value:function(e){return e>="0"&&e<="9"}},{key:"isLetter",value:function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}},{key:"isChinese",value:function(e){return e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""}},{key:"isJapanese",value:function(e){return e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""}},{key:"isArabic",value:function(e){return e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<="\ufeff"}},{key:"isSpace",value:function(e){return" "===e}},{key:"isPunctuation",value:function(e){return!0===this.is_cn_punc[e]||!0===this.is_en_punc[e]}},{key:"getLangCode",value:function(e){return this.isChinese(e)||!0===this.is_cn_punc[e]?s:this.isLetter(e)||this.isNum(e)||!0===this.is_en_punc[e]?l:this.isArabic(e)?u:void 0}}]),e}());window.langCode=c,t.a=c},1715:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(446),d=r(304),p=r(262),f=r(875),v=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.aeoVector=e,r.listener.on(h.b.INSERT,(function(e){return r._onDataChanged(p.default.op_add,e)})),r.listener.on(h.b.MODIFY,(function(e){return r._onDataChanged(p.default.op_modify,e)})),r.listener.on(h.b.REMOVE,(function(e){return r._onDataChanged(p.default.op_remove,e)})),r.listener.on(h.b.MOVE,(function(e){return r._onDataChanged(p.default.op_move,e)})),r.listener.on(h.b.RESET,(function(e){return r._onDataChanged(p.default.op_replace,e)})),r}return c()(t,e),o()(t,[{key:"initialize",value:function(){this.objType=d.default.OType_Vector}},{key:"_onDataChanged",value:function(e,t){var r=[];e===p.default.op_add||e===p.default.op_modify?r=[t.value]:e===p.default.op_replace&&(r=t.value);for(var n=this.getCoreObject(),i=0;i<r.length;i++){var a=r[i];a.buildTree?a.buildTree(n):a.parent=n}}},{key:"getDataIdx",value:function(e){return this.vector.indexOf(e)}},{key:"_fireChanged",value:function(e){this._core._fireChanged(e)}},{key:"insert",value:function(e,t){var r=this.vector,n=this.getDataIdx(t);n>=0&&n<r.length||((r.length<e||e<0)&&(e=r.length),r.splice(e,0,t),this.addVectorOperate(this,d.default.otInsert,e,t),t.parent=this.getCoreObject())}},{key:"removeAt",value:function(e){var t=this.vector;e>=0&&e<t.length&&this.remove(t[e])}},{key:"remove",value:function(e){var t=this.vector,r=this.getDataIdx(e);r>=0&&r<t.length&&(t.splice(r,1),this.addVectorOperate(this,d.default.otRemove,r,e),delete e.parent)}},{key:"move",value:function(e,t){var r=null,n=this.vector;if(e+t<0||e+t>n.length)return-1;this.isTopObject()||(r=n[e]),t<0?(n.splice(e,1),n.splice(e+t,0,r)):t>0&&(n.splice(e+t,0,r),n.splice(e,1)),this.addVectorOperate(this,d.default.otMove,e,r,void 0,t)}},{key:"insertNoTransact",value:function(e,t){var r=this.vector,n=this.getDataIdx(t);n>=0&&n<r.length||((r.length<e||e<0)&&(e=r.length),r.splice(e,0,t))}},{key:"getCoreObject",value:function(){return this._core.core}},{key:"listAtomProperties",get:function(){return["vector"]}},{key:"vector",get:function(){return this.aeoVector.private}}]),t}(h.c);v.prototype._doOperate=function(e){var t=this.vector;switch(e.opType){case d.default.otInsert:t.splice(e.pos,0,e.data),e.data.parent=this.getCoreObject(),this._fireDataChanged(h.b.INSERT,{index:e.pos,value:e.data,isForward:e.isForward});break;case d.default.otRemove:var r=t[e.pos];t.splice(e.pos,1),delete r.parent,this._fireDataChanged(h.b.REMOVE,{index:e.pos,value:e.data,isForward:e.isForward});break;case d.default.otMove:e.offset<0?(t.splice(e.pos,1),t.splice(e.pos+e.offset,0,e.data)):e.offset>0&&(t.splice(e.pos+e.offset,0,e.data),t.splice(e.pos,1)),this._fireDataChanged(h.b.MOVE,{index:e.pos,offset:e.offset,value:e.data,isForward:e.isForward});break;case d.default.otModify:t[e.pos]=e.data,e.data.parent=this.getCoreObject(),this._fireDataChanged(h.b.MODIFY,{index:e.pos,value:e.data,isForward:e.isForward});break;case d.default.otReplaceData:for(var n=t,i=0;i<n.length;i++)delete n[i].parent;t.splice(0);for(var a=0;a<e.data.length;a++)t.push(e.data[a]),e.data[a].parent=this.getCoreObject();this._fireDataChanged(h.b.RESET,{value:t,isForward:e.isForward})}};var y=function(){function e(t){i()(this,e),this.private=t.data,this.listDelegate=new v(this),Object(f.a)(this)}return o()(e,[{key:"_fireChanged",value:function(e){this._bubbleUpEvent(p.default.animation_notify,Object.assign({},e||{},{data:this}))}},{key:"vector",get:function(){return this.private}}]),e}();t.a=y,Object(h.d)(y,{ListAtomDelegateClass:v,selfAtomeType:"customAtom"})},1716:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(1260),d=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.private=e&&e.data||{},r}return c()(t,e),o()(t,[{key:"create",value:function(){return new t({})}},{key:"getTargetShapeId",value:function(){return this.private.targetElement}},{key:"getEndAfterSlide",value:function(){return this.private.endAfterSlide}},{key:"setVolume",value:function(e){e>=0&&e<=100&&this.setProperty("volume",t.REAL2INT(parseFloat(e)/100))}},{key:"getVolume",value:function(){return this.private.volume}},{key:"setMute",value:function(e){this.setProperty("mute",e)}},{key:"getMute",value:function(){var e=this.private.mute||!1;return-1!==e&&e}},{key:"setHideWhenStopped",value:function(e){this.setProperty("hideWhenStopped",e)}},{key:"getHideWhenStopped",value:function(){var e=this.private.hideWhenStopped||!1;return-1!==e&&e}},{key:"setZoomFullScreen",value:function(e){this.setProperty("zoomFullScreen",e)}},{key:"getZoomFullScreen",value:function(){var e=this.private.zoomFullScreen||!1;return-1!==e&&e}},{key:"setRewindWhileDone",value:function(e){e?this.setProperty("fill",1):this.setProperty("fill",3)}},{key:"getRewindWhileDone",value:function(){return 1===(this.private.fill||!1)}},{key:"setLoopUntilStop",value:function(e){e?this.setProperty("repeateCount",-1):this.setProperty("repeateCount",1)}},{key:"getLoopUntilStop",value:function(){return-1===this.private.repeateCount}},{key:"isMediaNode",get:function(){return!0}}],[{key:"REAL2INT",value:function(e){return e>0?parseInt(1e3*e+.5):1e3*e}}]),t}(h.a)},1717:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;i()(this,e),this._max=t,this._keyList=[],this._map={}}return o()(e,[{key:"reset",value:function(){this._keyList=[],this._map={}}},{key:"destroy",value:function(){delete this._keyList,delete this._map,this._keyList=[],this._map={}}},{key:"_updateLRU",value:function(e){for(var t=this._keyList,r=t.indexOf(e);r>-1;)t.splice(r,1),r=t.indexOf(e);t.unshift(e)}},{key:"delete",value:function(e){delete this._map[e];for(var t=this._keyList,r=t.indexOf(e);r>-1;)t.splice(r,1),r=t.indexOf(e)}},{key:"set",value:function(e,t){for(this._map[e]=t,this._updateLRU(e);this.size()>this._max;)this.pop()}},{key:"pop",value:function(){var e=this._keyList.pop(),t=this._map[e];return delete this._map[e],t}},{key:"get",value:function(e){var t=this._map[e];return t&&this._updateLRU(e),t}},{key:"size",value:function(){return this._keyList.length}},{key:"isFull",value:function(){return this.size()>=this._max}}]),e}();!function(){function e(t){i()(this,e),this._imageSha1={},this._sha1Base64={}}o()(e,[{key:"isFull",value:function(){return!1}},{key:"set",value:function(e,t){var r=t&&t.data;r&&r.sha1&&(this._imageSha1[e]=r.sha1,this._sha1Base64[r.sha1]={data:t,timestamp:Date.now()},this.clean())}},{key:"get",value:function(e){var t=this._imageSha1[e],r=this._sha1Base64[t];if(t&&r)return r.timestamp=Date.now(),r.data}},{key:"setSha1",value:function(e,t){e&&t&&(this._imageSha1[e]=t)}},{key:"destroy",value:function(){delete this._imageSha1,this._imageSha1={},this.clean()}},{key:"clean",value:function(){var e=Object.values(this._sha1Base64);if(e.length>50){e.sort((function(e,t){return e.timestamp-t.timestamp}));for(var t=0;t<e.length-50;t++){var r=e[t],n=r&&r.data.sha1;n&&delete this._sha1Base64[n]}}}}])}()},1860:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(150),d=r.n(h),p=r(335),f=r(1712);function v(e,t,r){var n="get"+r,i=t[n];i&&(e[n]=function(){var n="_val"+r;if(e[n])return e[n];var a=i.apply(t,[]);if(a){var o=Object(f.a)(a,r);return e[n]=o,o}})}var y=function(e){function t(e,r,n,a,o){i()(this,t);var s=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));s.selections={},s.rpt=e,s.presentation=r,s.local_slt=new window.DataFace.Selection(e,r,n,a,!0,o),s.selections[s.local_slt.getUid()]=d()({},s.local_slt.getConnId(),s.local_slt),s.sltCnt=1,s.slide_slts={};var u,c,h=s.local_slt;return h.on(window.DataFace.Selection.EventTypes.SLIDE_CHANGE,(function(e){s._onSldeSelectChange(h,e.oldSlide,e.curSlide)})),h.on(window.DataFace.Selection.EventTypes.ERROR_READONLY,(function(e){s._onSlideError(e)})),h.on(window.DataFace.Selection.EventTypes.SEND_SELECTION,(function(e){s._onSendSelection(e)})),h.on(window.DataFace.Selection.EventTypes.SYNC_SELECTION,(function(e){s._onSyncSelection(e)})),s.local_slt_wrapper=(u=s.local_slt,(c=Object(f.a)(u,"selection")).constructor.EventTypes=u.constructor.EventTypes,c._setCallback("before",(function(){u.setTriggerStatus(!0)})),c._setCallback("after",(function(){u.setTriggerStatus(!1)})),v(c,u,"TableSelection"),v(c,u,"AnimSelection"),v(c,u,"ShapeSelection"),v(c,u,"SlideSelection"),v(c,u,"TextSelection"),v(c,u,"PresentationSelection"),c),s}return c()(t,e),o()(t,[{key:"_onSyncSelection",value:function(){var e=this,t={type:"sync"};window.session.execSimpleQuery("QuerySelectionNotify",t,(function(t){return 0===t.error?e.applyServerSelections(t):void console.error("SyncSelection Failed !!")}))}},{key:"_onSendSelection",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.bUpdateActiveConnId,n=t.bResend,i=void 0;if(n&&this.hasUnsentSelection())i=this._sendData,this._sendData.leftSpan--,0===this._sendData.leftSpan&&delete this._sendData;else{var a=this.local_slt.getSyncMemo();if(a.slideId<0)return void setTimeout((function(){e._onSendSelection(t)}),100);i={type:"update",bUpdateActiveConnId:r,selectRange:a},this.sendSltTimeout&&this.hasUnsentSelection()&&(i.bUpdateActiveConnId=r||this._sendData.bUpdateActiveConnId),this._sendData=i,this._sendData.leftSpan=3}clearTimeout(this.sendSltTimeout),this.sendSltTimeout=setTimeout((function(){console.log("***********************QuerySelectionNotify",i),window.session.execSimpleQuery("QuerySelectionNotify",i,(function(t){0===t.error?delete e._sendData:console.error("SendSelection Failed !!")})),delete e.sendSltTimeout}),1e3)}},{key:"hasUnsentSelection",value:function(){return null!=this._sendData}},{key:"getSelections",value:function(){return this.selections}},{key:"getSelectionArray",value:function(){var e=[];for(var t in this.selections){var r=this.selections[t];for(var n in r)e.push(r[n])}return e}},{key:"getSelectionsCount",value:function(){return this.sltCnt}},{key:"getLocalSelection",value:function(){return this.local_slt}},{key:"getLocalSelectionWrapper",value:function(){return this.local_slt_wrapper}},{key:"hasSelection",value:function(e,t){return this.selections[e]&&null!=this.selections[e][t]}},{key:"getSelection",value:function(e,r){if(this.hasSelection(e,r))return this.selections[e][r];var n=window.DataFace.Selection,i=new n(this.rpt,this.presentation,e,r,!1);this.selections[e]||(this.selections[e]={}),this.selections[e][r]=i,this.sltCnt+=1,this.fire(t.EventTypes.NEW_SELECTION,i);var a=this;return i.on(n.EventTypes.SLIDE_CHANGE,(function(e){a._onSldeSelectChange(i,e.oldSlide,e.curSlide)})),this.selections[e][r]}},{key:"getSelectionsByUid",value:function(e){return this.selections[e]}},{key:"removeSelection",value:function(e,r){if(this.hasSelection(e,r)){var n=this.selections[e][r];this.fire(t.EventTypes.DEL_SELECTION,n),this.sltCnt-=1;var i=n.getActiveSlide();this._onSldeSelectChange(n,i,null),delete this.selections[e][r],0===Object.keys(this.selections[e])&&delete this.selections[e]}}},{key:"applyServerSelections",value:function(e){var t=this;if(e){var r=e.users;if(r){for(var n=this.getSelections(),i=Object.keys(n),a=function(e){var a=r[e],o=a.userId,s=a.conns;if(0===s.length)return"continue";var l=i.indexOf(o);l>=0&&i.splice(l,1);for(var u=[],c=n[o]&&Object.keys(n[o])||[],h=0;h<s.length;++h){var d=s[h],p=d.connId,f=d.selectRange,v=d.token,y=c.indexOf(p);y>=0&&c.splice(y,1);var g=Object.assign({token:v},f),m=t.getSelection(o,p);if(m.getToken()!==v||0===m.state)m.disableBroadcastSelection=!0,m.restoreSyncMemo(g),m.disableBroadcastSelection=!1;else m._getSelectionData().setActiveConnId(f.activeConnId),u.push(m)}u.forEach((function(e){t.activeConnIdChanged(e)})),c.forEach((function(e){t.removeSelection(o,e)}))},o=0;o<r.length;++o)a(o);i.forEach((function(e){if("local"!==e){var r=t.getSelectionsByUid(e);if(r)Object.keys(r).forEach((function(r){t.removeSelection(e,r)}))}}))}else console.error("Invalid selection data !!")}}},{key:"_activeSelections",value:function(e){var t=this,r=[],n=this.local_slt.getUid();return"local"===n?[]:(e.forEach((function(e){e._data.activeConnId===e._data.connid&&e.getUid()!==n&&r.push(e),e===t.local_slt&&r.push(e)})),r)}},{key:"getSlideSelections",value:function(e){if(!e)return[];var t=this.slide_slts[e.getId()];return this._activeSelections(t||[])}},{key:"getSelectionsBySlideIndex",value:function(e){var t=this.presentation.getSlideAt(e);return this.getSlideSelections(t)}},{key:"_onSlideError",value:function(e){this.fire(t.EventTypes.ERROR_READONLY,e)}},{key:"_onSldeSelectChange",value:function(e,r,n){if(r===n&&null!=n){var i=n.getId(),a=this.slide_slts[i];return a||(a=[],this.slide_slts[n.getId()]=a),a.indexOf(e)<0&&a.push(e),a=this._activeSelections(a),void this.fire(t.EventTypes.SLIDE_SELECT_CHANGE,{slide:n,selectionsList:a})}if(r){var o=r.getId(),s=this.slide_slts[o];if(s){var l=s.indexOf(e);l>=0&&(s.splice(l,1),0===s.length&&delete this.slide_slts[o],s=this._activeSelections(s),this.fire(t.EventTypes.SLIDE_SELECT_CHANGE,{slide:r,selectionsList:s}))}}if(n){var u=this.slide_slts[n.getId()];u||(u=[],this.slide_slts[n.getId()]=u),u.push(e),u=this._activeSelections(u),this.fire(t.EventTypes.SLIDE_SELECT_CHANGE,{slide:n,selectionsList:u})}}},{key:"activeConnIdChanged",value:function(e,t,r){this._onSldeSelectChange(e,e.getActiveSlide(),e.getActiveSlide())}},{key:"fireSelectionChanged",value:function(e){this._onSldeSelectChange(e,e.getActiveSlide(),e.getActiveSlide())}},{key:"resyncDelayLoadSlides",value:function(){var e=this.local_slt;if(null==e.getActiveSlide()&&null!=e._delayLoadIdx){var t=e._delayLoadIdx,r=t.idx,n=t.category,i=t.layerType;e.selectSlideAt(r,n,i)}Object.values(this.selections).forEach((function(t){t!==e&&t._lastSyncMemo&&t.delayRestoreSyncMemo(t._lastSyncMemo)}))}}]),t}(p.a);y.EventTypes={NEW_SELECTION:"new_selection",DEL_SELECTION:"del_selection",SLIDE_SELECT_CHANGE:"slide_select_change",ERROR_READONLY:"error_readonly"},y.EventArgs={};var g=y,m=r(262),_=r(43),S=r.n(_),T=r(167),b=function(e){function t(e,r){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.presentation=e,n.session=r,n._slideQueryList=[],n._loadNext=n._loadNext.bind(n),n._reload_time_gap=3e3,r.setQuerySlidesCallback(n),n.containers=[].concat(S()(e.container));var a=e.getSlides();return n.setTopPriority(a),n.updateVisibleSlide(0,0),n.listenDataCompleted(),n}return c()(t,e),o()(t,[{key:"listenDataCompleted",value:function(){var e=this;window.APP.dataCompletedPromise=new Promise((function(r){e.on(t.EventTypes.DATA_COMPLETED,(function(){window.APP.shellFactory&&window.APP.shellFactory.initRoot(),window.selection.fire(window.DataFace.Selection.EventTypes.SYNC_SELECTION),r()}))}))}},{key:"isCompleted",value:function(){return"completed"===this._queryVerType}},{key:"destroy",value:function(){this.loadTimeout&&(clearTimeout(this.loadTimeout),delete this.loadTimeout)}},{key:"updateMode",value:function(e){this.mode=e}},{key:"updateActiveSlide",value:function(e){this.slideActiveIdx=e}},{key:"updateVisibleSlide",value:function(e,t){this.slideVisibleStartIdx=e,this.slideVisibleEndIdx=t}},{key:"setTopPriority",value:function(e){var t=this.containers.indexOf(e);t>=0&&0!==t&&(this.containers.splice(t,1),this.containers.unshift(e)),this.checkMastersPriority()}},{key:"checkMastersPriority",value:function(){for(var e=["slideMasters","notesMasters","handoutMasters"],t=[],r=[],n=0;n<this.containers.length;n++){var i=this.containers[n];if(i){var a=i.getCategory(),o=e.indexOf(a);o>=0?t[o]=i:r.push(i)}}this.containers=r.concat(t)}},{key:"queryInitVersionComplete",value:function(){"queryInit"===this._queryVerType?this._queryVerType="queryVersion":this._queryVerType="normal"}},{key:"pushSvrData",value:function(e,r){if(e){var n=e.category,i=e.partSerial,a=e.msgLength,o=e.childs;if(i)for(var s=i.start,l=i.len,u=0;u<this._slideQueryList.length;++u){var c=this._slideQueryList[u];if(n===c.category&&s===c.start&&l===c.len&&null==c.timeEnd){c.timeEnd=window.performance.now(),c.msgLength=a;var h=Math.round(c.timeEnd-c.timeBegin);window.collection("experience",{event:"reading_request_success",times:h,value:a}),o&&o.length===l||(this._wrongBlockCnt=null!=this._wrongBlockCnt?this._wrongBlockCnt+1:1,window.collection("experience",{event:"reading_request_fail",value:this._wrongBlockCnt}));break}}}this._queryVerType=r?"queryInit":"normal",this.presentation.pushSvrData(e),"queryInit"===this._queryVerType&&this.session.queryInitVersionInfo(),this._loadNext(),e&&this.fire(t.EventTypes.DATA_LOADED,e)}},{key:"_removeLimitBlocks",value:function(e,t){if(this.presentation.slidesPreviewLimit()>=0&&"slides"===e&&t.length>0){for(var r=this.presentation.slidesLimit,n=this.presentation.slides.private.childs,i=[],a=0;a<t.length;a++){var o=Object.assign({},t[a]);if(!(o.start>=r)){if(o.start+o.len>=r){o.len=r-o.start;for(var s=!1,l=o.start,u=o.start+o.len;l<u;l++)if(!n[l]){s=!0;break}if(!s)continue}i.push(o)}}return i}return t}},{key:"_loadNext",value:function(){if(this.loadTimeout&&(clearTimeout(this.loadTimeout),delete this.loadTimeout),window.RPCClient&&window.RPCClient.connected()&&"CONNECTED"===window.RPCClient.getState()&&!this.session.sender.isExecuting()){if("queryInit"===this._queryVerType)return this.session.queryInitVersionInfo(),void(this.loadTimeout=setTimeout(this._loadNext,this._reload_time_gap));this.checkMastersPriority();for(var e=!1,r=0,n=this.containers.length;r<n;++r){var i=this.containers[r];if(i){var a=i.getCategory();if("unknown"!==a){var o=i.getPendingBlocks();if((o=this._removeLimitBlocks(a,o)).length>0&&this._loadBlock(o,a))return void(this.loadTimeout=setTimeout(this._loadNext,this._reload_time_gap));e=e||o.length>0}}}e?this.loadTimeout=setTimeout(this._loadNext,this._reload_time_gap):(this.presentation.slideLazyComplete=!0,"queryVersion"===this._queryVerType&&this.session.queryVersion({lazyComplete:!0}),this._queryVerType="completed",this.fire(t.EventTypes.DATA_COMPLETED),this._slideQueryList=[],this._wrongBlockCnt=0)}else this.loadTimeout=setTimeout(this._loadNext,100)}},{key:"_binarySearch",value:function(e,t){if(void 0===t)return-1;for(var r=0,n=e.length-1;r<n;){var i=parseInt((r+n)/2),a=e[i];if(t<a.start)n=i-1;else{if(!(t>=a.start+a.len))return i;r=i+1}}return r}},{key:"_removeLoaded",value:function(e,t){if(t<0||null==t){for(var r=0;r<e.length;){var n=e[r];!n||n.loaded?e.splice(r,1):r++}return e.length>0?0:-1}for(var i=e[t];i&&i.loaded;)e.splice(t,1),t>=e.length&&(t=e.length-1),i=e[t];for(;t>0&&e[t-1].loaded;)e.splice(t-1,1),--t;return t}},{key:"_slidesLoader",value:function(e,t){var r=Date.now();this._removeLoaded(e);var n=this._binarySearch(e,this.slideActiveIdx),i=e[n=this._removeLoaded(e,n)];if(void 0===i)n=this._binarySearch(e,this.slideVisibleStartIdx),n=this._removeLoaded(e,n);else if(i.start>this.slideActiveIdx||i.start+i.len<=this.slideActiveIdx){var a=parseInt((this.slideVisibleStartIdx+this.slideVisibleEndIdx)/2),o=this._binarySearch(e,a);if(this.mode===T.ViewModes.PlayView){n>(o=this._removeLoaded(e,o))&&(n=this._binarySearch(e,i.start));var s=e[o];Math.abs(a-s.start)<Math.abs(this.slideActiveIdx-i.start)&&(n=o)}else n=o,n=this._removeLoaded(e,n)}if(!(i=e[n])&&e.length>0&&(n=0,i=e[0]),!i)return!1;if(this.mode===T.ViewModes.PlayView);else if(i.start<=this.slideActiveIdx&&this.slideActiveIdx<i.start+i.len);else if(this.slideVisibleStartIdx<=i.start&&i.start<this.slideVisibleEndIdx);else if(n>0&&i.start>=this.slideVisibleEndIdx){var l=e[n-1];this.slideVisibleStartIdx-l.start+6<i.start-this.slideVisibleEndIdx&&(i=l,--n)}else if(n<e.length-1&&i.start+i.len<this.slideVisibleStartIdx){var u=e[n+1],c=u.start-this.slideVisibleEndIdx;this.slideVisibleStartIdx-(i.start+i.len)+6<c&&(i=u,++n)}return!(r-i.time<this._reload_time_gap)&&(console.log("loadslides send",i.start,i.len,t,i.loaded),this.session.querySlides(t,i.start,i.len),this._slideQueryList.push({category:t,start:i.start,len:i.len,timeBegin:window.performance.now()}),window.collection("experience",{event:"reading_request_send",value:this._slideQueryList&&this._slideQueryList.length}),i.time=r,!0)}},{key:"_defaultLoader",value:function(e,t){for(var r=Date.now();e.length>0;){var n=e[0];if(void 0!==n&&!n.loaded)return!(r-n.time<this._reload_time_gap)&&(this.session.querySlides(t,n.start,n.len),this._slideQueryList.push({category:t,start:n.start,len:n.len,timeBegin:window.performance.now()}),window.collection("experience",{event:"reading_request_send",value:this._slideQueryList&&this._slideQueryList.length}),n.time=r,!0);e.splice(0,1)}return!1}},{key:"_loadBlock",value:function(e,t){return!(!t||"unknown"===t)&&("slides"===t||"slideLayouts"===t||"slideMasters"===t?this._slidesLoader(e,t):this._defaultLoader(e,t))}}]),t}(p.a);b.EventTypes={DATA_LOADED:"data_loaded",DATA_COMPLETED:"data_completed"};var k=b,C=r(470),w=r(1013),P=r(268),x=r(522),O=r(762),E=r(461),I=r(2241);function A(e,t){if(e){switch((e=Object(P.a)(e)).type){case T.FillType.FillTypeGradient:for(var r=e.stops,n=0;n<r.length;n++){var i=r[n];i.color=Object(w.g)(i.color,t)}break;case T.FillType.FillTypePattern:e.color=Object(w.g)(e.color,t),e.backgroundColor=Object(w.g)(e.backgroundColor,t);break;case T.FillType.FillTypeSolidColor:e.color=Object(w.g)(e.color,t);break;case T.FillType.FillTypeGroup:var a=t&&t.shape,o={type:0};if(a){var s=a.visual.getParent();s&&(o=s.getFill(),a=s.coredata)}e=A(o,t);break;case T.FillType.FillTypeBlip:e.blip&&e.blip.effects&&(e.blip.effects=R(e.blip.effects,t))}return e}}function R(e,t){if(!e)return e;for(var r=Object.keys(e),n=0;n<r.length;n++){var i=e[r[n]];if(i instanceof Object){for(var a in i)if("fill"==a)i.fill=i.fill=A(i.fill,t);else if("color"==a||"replacement"==a||"color1"==a||"color2"==a||"primaryColor"==a||"secondaryColor"==a)i[a]=Object(w.g)(i[a],t);else if("colors"==a)for(var o=0;o<i.colors.length;o++)i.colors[o]=Object(w.g)(i.colors[o],t);else"cont"==a&&i.cont.effects&&(i.cont.effects=R(i.cont.effects,t));i.from&&i.to&&(i.from=Object(w.g)(i.from,t),i.to=Object(w.g)(i.to,t))}}return e}function D(e){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("<html>"))return x.c.presMediaUnknown;var t,r=e.substr(e.lastIndexOf(".")+1).toLowerCase();return["asf","asx","dvr-ms","wpl","wm","wmx","wmd","wmz","avi","mov","mp4","m4v","mp4v","3gp","3gpp","3g2","3gp2","mpeg","mpg","mpe","m1v","m2v","mod","mpv","mpv2","mp2v","mpa","m2ts","m2t","ts","tts","wmv","wvx","swf"].includes(t=r)?x.c.presMediaVideo:["adts","adt","aac","aif","aifc","aiff","au","snd","mid","wma","wax","mp3","mp2","m3u","m4a","midi","rmi","wav"].includes(t)?x.c.presMediaAudio:x.c.presMediaUnknown}var L={getMediaSubType:function(e){var t=e.substr(e.lastIndexOf(".")+1);return x.b.MediaSubType_Unk,D(e)===x.c.presMediaVideo?"avi"===t?x.b.MediaSubType_Avi:x.b.MediaSubType_OtherVideo:"avi"===t?x.b.MediaSubType_Wave:x.b.MediaSubType_OtherAudio},getMediaDataType:function(e){if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("<html>"))return x.a.MediaDataTypeOnlineVideo;var t,r=e.substr(e.lastIndexOf(".")+1).toLowerCase();return["asf","asx","dvr-ms","wpl","wm","wmx","wmd","wmz","avi","mov","mp4","m4v","mp4v","3gp","3gpp","3g2","3gp2","mpeg","mpg","mpe","m1v","m2v","mod","mpv","mpv2","mp2v","mpa","m2ts","m2t","ts","tts","wmv","wvx"].includes(t=r)?x.a.MediaDataTypeMovie:["adts","adt","aac","aif","aifc","aiff","au","snd","mid","wav","wma","wax","mp3","mp2","m3u","m4a","midi","rmi"].includes(t)?x.a.MediaDataTypeSound:["swf"].includes(t)?x.a.MediaDataTypeOnlineVideo:["gif"].includes(t)?x.a.MediaDataTypeGif:x.a.MediaDataTypeNone},getMediaType:D},N={Color:w.a,ColorType:w.c,ScRgb:w.e,ShapeGroupItems:C.ShapeGroupItems},M={createModifier:function(){var e;return window.CoreDataEditor?(e=window.CoreDataEditor).createModifierByName.apply(e,arguments):null},ColorSchemeData:w.b,getColorDelegation:function(e,t,r){var n=null;return t&&(n=t.isBackground()?t.visual.getColorScheme(r):t.colorScheme).setColorUsedFor(e),n},interpretColor:function(e,t){return null==e?null:Object(w.g)(e,t)},interpretFill:function(e,t){return e?A(e,t):e},interpretOutline:function(e,t){return e?(e.fill&&(e.fill=A(e.fill,t)),e):e},interpretEffects:function(e,t){return e?R(e,t):e},deepCompare:E.deepCompare,MediaTypeFunc:L,PlaceHolderHelper:O.a,getFakeTransaction:function(e){return I.TransactionInstances.getInstance(e)}};window.CoreTypes=N,window.CoreUtils=M;var F=r(304),B=r(696),j=r(315),V=r(2242),H=[B.default.slideInsert,B.default.paste,B.default.effectMove];var G=function(){function e(t){i()(this,e),this.commandProc=t}return o()(e,[{key:"setTransact",value:function(e){this.transact=e,!e||e._localData||e._locked||(e._localData={cmds:[],token:Object(j.a)(),userData:{CMDVER:1}})}},{key:"isNull",value:function(){return null==this.transact}},{key:"isValid",value:function(){return this.transact&&!this.transact._locked}},{key:"isLocked",value:function(){return this.transact&&this.transact._locked}},{key:"setActionName",value:function(e){this.transact._locked||(this.transact._localData.action=e)}},{key:"getActionName",value:function(){if(this.transact&&this.transact._localData)return this.transact._localData.action}},{key:"setUserData",value:function(e,t){this.transact._locked||(this.transact._localData.userData[e]=t)}},{key:"getUserData",value:function(e){if(this.transact&&this.transact._localData){var t=this.transact._localData.userData;return t&&t[e]}}},{key:"setMainCommand",value:function(e){this.transact._locked||(this.transact._localData.mainCommand=e)}},{key:"getMainCommand",value:function(){if(!this.transact._locked){var e=this.transact._localData;if(e.mainCommand)return e.mainCommand;var t=e.cmds;return t.length>0?t[0].name:null}}},{key:"markData",value:function(e,t){var r=this.transact;r?(r._marks||(r._marks={}),r._marks[e]=t):console.error("Transaction::markData error, transaction not begin.")}},{key:"getMarkDatas",value:function(){return this.transact&&this.transact._marks}},{key:"getCommands",value:function(){if(this.transact&&!this.transact._locked)return this.transact._localData.cmds}},{key:"addCommand",value:function(e,t,r){if(!this.transact._locked){var n={name:e,param:t,beforeSendFunc:r},i=this.transact._localData.cmds,a=i.length;if(a>0)if(this.commandProc.canMergeLocalCommand(i[a-1],n))return void(this.commandProc.mergeLocalCommandExt(i[a-1],n)<0&&i.splice(a-1,1));i.push(n)}}},{key:"gainCommand",value:function(){var e=this.transact;if(e._localData){var t=e._localData.cmds;1===t.length?e.localCommand=t[0]:t.length>1&&(e.localCommand={name:"batchCommands",param:{commands:t}}),e.localCommand&&(e.localCommand.param.token=e._localData.token,e.localCommand.param.mainCommand=e._localData.mainCommand||"",e.localCommand.param.actionName=e._localData.action,e.localCommand.param.userData=e._localData.userData),delete e._localData}e._locked=!0}},{key:"isEmpty",value:function(){var e=this.transact;return!e||(e._localData?0===e._localData.cmds.length:!e.localCommand)}}]),e}(),U=function(){function e(t,r){i()(this,e),this.rpt=t,this.presentation=r,this.commandProc=t.commandProc,this._inner=new G(this.commandProc),this._batchLevel=0}return o()(e,[{key:"getCurrentTransact",value:function(){return this._inner.transact}},{key:"getToken",value:function(){var e=this._inner.transact;if(e&&e._localData)return e._localData.token}},{key:"markData",value:function(e,t){this._inner.markData(e,t)}},{key:"getMarkDatas",value:function(){return this._inner.getMarkDatas()}},{key:"setActionName",value:function(e){this._inner.isValid()?this._inner.setActionName(e):console.error("setActionName("+e+") failed: transact not begin.")}},{key:"getActionName",value:function(){return this._inner.getActionName()}},{key:"setUserData",value:function(e,t){this._inner.isValid()?this._inner.setUserData(e,t):console.error("setUserData(key="+e+") failed: transact not begin.")}},{key:"getUserData",value:function(e){return this._inner.getUserData(e)}},{key:"setCooperHandler",value:function(e){if(null==this.getUserData("_COOPER_HANDLER"))return this.setUserData("_COOPER_HANDLER",e),!0}},{key:"addServerOnlyAffects",value:function(e){if(e){for(var t=this.getUserData("_SERVER_ONLY_AFFECTS")||[],r=0;r<e.length;r++)t.indexOf(e[r])<0&&t.push(e[r]);this.setUserData("_SERVER_ONLY_AFFECTS",t)}}},{key:"resetServerOnlyAffects",value:function(e){if(this.setUserData("_SERVER_ONLY_AFFECTS",null),e){for(var t=[],r=0;r<e.length;r++)t.indexOf(e[r])<0&&t.push(e[r]);this.setUserData("_SERVER_ONLY_AFFECTS",t)}}},{key:"setMainCommand",value:function(e){this._inner.isValid()?this._inner.setMainCommand(e):console.error("setMainCommand() failed: transact not begin.")}},{key:"getMainCommand",value:function(){return this._inner.isValid()?this._inner.getMainCommand():null}},{key:"getCommands",value:function(){return this._inner.getCommands()}},{key:"isLocked",value:function(){return this._inner.isLocked()}},{key:"isNewObject",value:function(e){if(this._inner.transact){var t=this._inner.transact.newObjects;if(t&&t.indexOf(e)>=0)return!0}return!1}},{key:"beginBatchCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isLocked()&&(e=!0),e&&((this._batchLevel>0||this.isInTransaction())&&this.endBatchCommand(!0),this._batchLevel=0),this._batchLevel<=0){if(this._delayTimeout>-1)return clearTimeout(this._delayTimeout),this._delayTimeout=-1,void(this._batchLevel=1);this._autoEndPreviewTransact(),this.rpt.beginTransact(),this._inner.setTransact(this.rpt.getCurrentTransact()),this._batchLevel=1,this._bNeedCensor=t}else this._batchLevel+=1,this._bNeedCensor||(this._bNeedCensor=t)}},{key:"endBatchCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isLocked()&&(e=!0),this._batchLevel=e?0:this._batchLevel-1,this._batchLevel<=0&&(this._delayTimeout>-1&&(clearTimeout(this._delayTimeout),this._delayTimeout=-1),delete this._bNeedCensor),"forever"===t||t>=0||r&&r.length>0?this._delayEndTransact(r,t):this._endTransact(!1)}},{key:"beginTransact",value:function(){this.beginBatchCommand()}},{key:"endTransact",value:function(){this.endBatchCommand()}},{key:"isInTransaction",value:function(){return this.rpt.isInTransaction()}},{key:"isInBatchCommand",value:function(){return this._batchLevel>0}},{key:"isInCensorTransaction",value:function(){return!!this.rpt.isInTransaction()&&this._bNeedCensor}},{key:"isDelayEndTransact",value:function(){return this._delayTimeout>0}},{key:"addCommand",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!1;if(this._waitForCmds)if(this._waitForCmds instanceof Array)this._waitForCmds.indexOf(e)<0&&(n=!0);else{var i=this._waitForCmds,a=i.all,o=i.exclude,s=i.waitFor,l=s?s.indexOf(e)>=0:!!a;n=!l,o&&o.indexOf(e)>=0&&(n=!0)}else this.commandCanFollow(e,t)||(n=!0);n&&(this._autoEndPreviewTransact(),this.rpt.beginTransact(),this._inner.setTransact(this.rpt.getCurrentTransact())),this._inner.addCommand(e,t,r)}},{key:"commandCanFollow",value:function(e,t){var r=this._inner.getCommands();if(0===r.length)return!0;var n=this.getMainCommand();if(H.indexOf(e)>=0||H.indexOf(n)>=0)return!1;if(e===B.default.shapeInsert||e===B.default.tableHandler)return!1;var i=this.getUserData("_SERVER_ONLY_AFFECTS")||[];if(i.indexOf(e)>=0||i.indexOf("*")>=0)return console.error("add server only affect command in batchCommand!!!"),!1;for(var a=r[r.length-1],o=r.length-1;o>=0;o--)if(r[o].name===n){a=r[o];break}return a.name!==B.default.shapeInsert||function(e,t){var r=e.slideIdx,n=e.shapePath,i=null==t.slideIdx?t.slideIndex:t.slideIdx,a=t.shapePath;if(t.shapes||t.animations){for(var o=t.shapes||t.animations,s=o.length,l=0;l<s;l++){var u=o[l],c=null==u.slideIdx?i:u.slideIdx,h=null==u.shapePath?a:u.shapePath;if(r!==c||!Object(V.a)(n,h))return!1}return!0}return r===i&&Object(V.a)(n,a)}(a.param,t)}},{key:"setWaitCommands",value:function(e){this._waitForCmds=e}},{key:"_delayEndTransact",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;if(!(this._batchLevel>0)){this._waitForCmds=e,this._waitMSeconds="forever"===t?-1:t;var r=this;this._delayTimeout=setTimeout((function(){t>=0?(r._delayTimeout=-1,r.commit()):r._delayEndTransact(e,t)}),t>=0?t:1e4)}}},{key:"delayEndTransact",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;this.endBatchCommand(!1,t,e)}},{key:"endTopTransact",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.addCommand(e,t,r),this.endTransact()}},{key:"commit",value:function(){this.endTransact(!1)}},{key:"forceCommit",value:function(){clearTimeout(this._delayTimeout),this._waitForCmds=null,this._delayTimeout=-1,this._batchLevel=0,this._endTransact(!1)}},{key:"rollback",value:function(){this._endTransact(!0)}},{key:"_endTransact",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.default.ctCommit;if(this.isInTransaction())if(e)clearTimeout(this._delayTimeout),this._waitForCmds=null,this._waitMSeconds=0,this._delayTimeout=-1,this._batchLevel=0,this._owners=null,this.rpt.endTransact(e,t),this._inner.setTransact(null);else{if(this._delayTimeout>-1)return clearTimeout(this._delayTimeout),void(this._delayTimeout=-1);if(this._batchLevel>0)return;if(this._waitForCmds=null,this._waitMSeconds=0,this._inner.isEmpty()&&(e=!0),this._endNotify){for(var r=0;r<this._endNotify.length;r++){var n=this._endNotify[r];n(e)}this._endNotify=null}this._inner.isValid()&&this._inner.gainCommand(),this._owners=null,this.rpt.endTransact(e,t),this._inner.setTransact(null),!e&&this.presentation&&this.presentation.onLocalEditCommit()}}},{key:"_autoEndPreviewTransact",value:function(){this._batchLevel=0,this.rpt.isInTransaction()&&this.forceCommit()}},{key:"registerEndNotify",value:function(e){this._endNotify||(this._endNotify=[]),this._endNotify.push(e)}},{key:"backupTransact",value:function(){var e={localData:{}},t=this._inner.transact;t&&(e={localData:Object(E.deepClone)(t._localData)||{},locked:t._locked});var r={bLocked:this.isLocked(),bDelayEnd:this._delayTimeout>-1,batchLevel:this._batchLevel,waitForCmds:Object(E.deepClone)(this._waitForCmds),waitMSeconds:this._waitMSeconds,owners:this._owners,transData:e};return this._batchLevel=0,this._delayTimeout>-1&&(clearTimeout(this._delayTimeout),this._delayTimeout=-1),this._endTransact(!1,F.default.ctCommit_UnClose),r}},{key:"getCommandsAfterOptrans",value:function(){var e=this._inner.transact;if(e){var t=e.localCommand,r=e._localData&&e._localData.cmds;return t&&t.name&&t.param?[t]:r}}},{key:"restoreTransact",value:function(e){var t=this._inner.transact;t&&(this._batchLevel=e.batchLevel,this._waitForCmds=e.waitForCmds,this._waitMSeconds=e.waitMSeconds,this._owners=e._owners,t._localData=e.transData.localData,t._locked=e.transData.locked)}},{key:"record",value:function(e,t,r){this.rpt.addCustomOperate(e,{name:t,param:r})}},{key:"setOwner",value:function(e){this._inner.transact&&(this._owners||(this._owners=[]),this._owners.indexOf(e)<0&&this._owners.push(e))}},{key:"owners",value:function(){return this._owners}},{key:"lastCommand",value:function(){if(!this.isLocked()){var e=this._inner.getCommands();return e&&e[e.length-1]}}},{key:"_getLastCmdSelectRange",value:function(){var e=this.lastCommand();if(e){var t=e.param,r=t.shapes;return r&&(t=r[r.length-1]),t}}},{key:"lastCmdIsSameSlideWith",value:function(e){return e&&Object(V.c)(this._getLastCmdSelectRange(),e)}},{key:"lastCmdIsSameShapeWith",value:function(e){return e&&Object(V.b)(this._getLastCmdSelectRange(),e)}},{key:"lastCmdIsSameTextFrameWith",value:function(e){return e&&Object(V.d)(this._getLastCmdSelectRange(),e)}}]),e}();window.getTransaction=function(){return window._glbTransaction};var W=function(){function e(t){i()(this,e),this._origin=t,t&&t._localData&&(this.token=t._localData.token)}return o()(e,[{key:"isValid",value:function(){return null!=this.transaction}},{key:"isOriginal",value:function(){return!!this._origin&&this._origin===window._glbTransaction.getCurrentTransact()}},{key:"markData",value:function(e,t){var r=this.transaction;r?r.markData(e,t):console.error('TransactProxy::markData("'+e+'") failed, invalid transact.(token='+this.token+")")}},{key:"match",value:function(e){var t=null;if(this._origin){var r=this._origin._marks||{};for(var n in r)if(r.hasOwnProperty(n)&&r[n]===e){t=n;break}}if(!t)return console.error("Not found marked data."),null;var i=this.transaction;if(i){var a=i.getMarkDatas();if(a&&a.hasOwnProperty(t))return a[t]}return console.error("Not found marked data: "+t),null}},{key:"setOwner",value:function(e){var t=this.transaction;t&&t.setOwner(e)}},{key:"transaction",get:function(){var e=window._glbTransaction.getCurrentTransact();return this.token&&e&&e._localData&&this.token===e._localData.token?window._glbTransaction:null}}]),e}();window.beginBatchCommand=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window._glbTransaction;return e||(e=!(r.isInBatchCommand()||!r.isDelayEndTransact())||!r.isInBatchCommand()&&!r.isDelayEndTransact()),r.beginBatchCommand(e,t),new W(r.getCurrentTransact())},window.endBatchCommand=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window._glbTransaction;r.endBatchCommand(t,e,null)},window.isCommandStarted=function(e){var t=window._glbTransaction.owners();return t&&t.indexOf(e)>=0},window.serverOnlyCommandAffects=function(e){return(e.param.userData||{})._SERVER_ONLY_AFFECTS||[]},window.isServerOnlyAffectedCommand=function(e,t){if(e&&e.length>0&&t){var r=t.name,n=t.param;if("batchCommands"!==r)return e.indexOf(r)>=0;for(var i=n.commands,a=0;a<i.length;a++)if(e.indexOf(i[a].name)>=0)return!0}return!1};var z=r(1146),Y=r(158),q=r(1259),K=r(1147);function Q(e){return"number"==typeof e&&!isNaN(e)}var X=["Art::GVML ClipFormat","Et Internal Shape","Art::Table ClipFormat","WPS Drawing Shape Format","Office Drawing Shape Format","PowerPoint 14.0 Slides Package","kso slide package type","Art::Text ClipFormat","text/plain","text/html","image/png","Kingsoft Data Descriptor"],J=function(){function e(t){i()(this,e),this.pres=t,this.clipboardHistory={},this.localConnID=this.pres.session.getConnId(),this.localClipboardID=null}return o()(e,[{key:"getSelectRangeMimeTypes",value:function(e,t){if(!e)return null;var r=[],n=e.state;if(n===q.c.select_slide)if("slides"===e.category())r=this.getMimeTypes("slides",e,t);else if("slideLayouts"===e.category())r=this.getMimeTypes("layouts",e,t);else{if("slideMasters"!==e.category())return null;r=this.getMimeTypes("masters",e,t)}else n===q.c.select_shape||n===q.c.select_multi_shape||n===q.c.select_table?r=this.getMimeTypes("shapes",e,t):n===q.c.select_cell||n===q.c.select_multi_cell?r=this.getMimeTypes("cells",e,t):n===q.c.select_text&&(r=this.getMimeTypes("text",e,t));return r}},{key:"getMimeTypes",value:function(e,t,r){if(!e||!t)return null;var n=[];switch(e){case"slides":n.push("PowerPoint 14.0 Slides Package"),n.push("kso slide package type"),r.bCopyImage&&n.push("image/png"),n.push("Kingsoft Data Descriptor");break;case"layouts":case"masters":break;case"shapes":var i=t.getActiveShapes();if(i.length<=0)break;var a=i[0];if(1===i.length&&(a.hasTable()||a.isOle()))a.hasTable()?(n.push("Art::Table ClipFormat"),n.push("text/html")):a.isOle()&&(n.push("Kingsoft WPP 10.0 Format"),n.push("WPS Drawing Shape Format"));else{n.push("Art::GVML ClipFormat");for(var o=!1,s=0;s<i.length;++s)if(i[s].hasTable()){o=!0;break}!o&&n.push("WPS Drawing Shape Format")}r.bCopyImage&&n.push("image/png"),n.push("Kingsoft Data Descriptor");break;case"cells":n.push("text/plain"),n.push("text/html"),n.push("Art::Table ClipFormat"),n.push("Kingsoft Data Descriptor");break;case"text":n.push("text/plain"),n.push("Art::Text ClipFormat"),n.push("Kingsoft Data Descriptor")}return n}},{key:"createClipboardDatas",value:function(e,t,r,n){var i={};e&&(i["text/plain"]=e),r&&(i["text/ksdocclipboardid"]=r),t||(e||(e=""),t="<html><body>"+e+"</body></html>"),t=this.addClipboardIdToHtml(t,r),i["text/html"]=t;var a=[],o=[];if(n)for(var s=0;s<n.length;s++){var l=n[s];if(o.push(l.type),l.type&&0===l.type.indexOf("image/")){var u=l.width,c=l.height,h=l.sha1;a.push({width:u,height:c,sha1:h})}if(l.data){var d=atob(l.data);d.length%2!=0&&(d+=String.fromCharCode(0));for(var p="",f=0;f<d.length;){var v=d.charCodeAt(f),y=d.charCodeAt(f+1);p+=String.fromCharCode((v<<8)+y),f+=2}i[l.type]=p}}var g={},m={images:a,mimeTypes:o,items:function(){var e=[];for(var t in i)if(i[t]){var r={type:t,value:i[t]};g[t]&&(r=Object.assign(r,g[t])),e.push(r)}return e},get:function(e){return i[e]},set:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i[e]=t,r&&(g[e]=r)}};if(r){var _={from:"webwpp",id:r,mimeTypes:["text/html"]};m.set("text/ksDocClipBoardInfo",JSON.stringify(_),{writeLocalStorage:!1})}return m}},{key:"addImageToHtml",value:function(e,t){var r=e.indexOf("</body>");return r>=0?e=e.slice(0,r)+t+e.slice(r):(r=e.indexOf("</html>"),e=r>=0?e.slice(0,r)+"<body>"+t+"</body>"+e.slice(r):t+e),e}},{key:"addClipboardIdToHtml",value:function(e,t){var r='<meta ksdocclipboardid="'+t+'" app="wpp">',n=e.indexOf("</body>");return n>=0?e=e.slice(0,n)+r+e.slice(n):(n=e.indexOf("</html>"),e=n>=0?e.slice(0,n)+"<body>"+r+"</body>"+e.slice(n):r+e),e}},{key:"_handleServerData",value:function(e,t,r){var n=this;if(r=r||{},e&&0===e.error){var i=e.ksDocClipboardId,a=e.data,o=a.text,s=a.html,l=a.mimeDatas;e.hasPlainData=!(!o&&!s);var u=this.createClipboardDatas(o,s,i,l);s=u.get("text/html");var c={from:"webwpp",id:i,mimeTypes:["text/html"]};if(u.set("text/ksDocClipBoardInfo",JSON.stringify(c),{writeLocalStorage:!1}),e.copyHtml=s,e.images=u.images,e.items=u.items(),t){var h=!0;if(null!=r.bNeedImage&&(h=!!r.bNeedImage),h&&!e.hasPlainData&&e.images.length>0){var d=e.images[0],p={};p[d.sha1]=d;var f=Object.keys(p);this.pres.session.getImageUrlFromServer(f).then((function(r){e.imageSuccess=!0;for(var a="",o=r.urls,s=0;s<f.length;s++){var l=f[s],c=o[l];if(c){var h=p[l];a+="<img src="+c+" width="+h.width+" height="+h.height+' ksdocclipboardid="'+i+'" app="wpp">',d.url=c}}if(""!==a){var v=n.addImageToHtml(e.copyHtml,a);u.set("text/html",v),e.copyHtml=v,e.items=u.items()}t(e)})).catch((function(r){e.imageSuccess=!1,e.imageError=r,console.error("Get copy image url failed:",r),t(e)}))}else t(e)}}else t&&t(e)}},{key:"_fillCopyParams",value:function(e,t){if(e.bCopyImage=!0,t)for(var r in t){var n=t[r];"bCopyImage"===r?e.bCopyImage=!!n:e[r]=n}e.bCopyImage||(e.imageFormats=[])}},{key:"_createClipboardId",value:function(e){var t=this.pres.session.getConnId(),r=t.substring(t.length-8,t.length)+Object(j.a)();return e&&(r=e+"_"+r),r}},{key:"checkClipboardIdTag",value:function(e,t){return 0===e.indexOf(t+"_")}},{key:"copy",value:function(e){var t=e.callback,r=e.userArgs,n=e.clipboardId,i=this,a=this.pres.session.getConnId(),o={timestamp:Date.now(),select:this.getCopyPasteRange(),ksDocClipboardId:n,imageFormats:[]};this._fillCopyParams(o,r);var s=this.getSelectRangeMimeTypes(this.pres.selection,r);return o.extArgs=[{type:"ksDocClipboard",data:{ksDocClipboardId:o.ksDocClipboardId,hasHtml:"false",priorityFormats:s}}],this.setCopyRange(a,n,Object(E.deepClone)(o.select)),this.pres.session.execQuery("copy",o,(function(e){e&&0===e.error&&i.setCopyData(a,n,e),t&&i._handleServerData(e,t,r)}),1e4),n}},{key:"cut",value:function(e){var t=e.getWriteClipboardResult,r=e.callback,n=e.userArgs,i=e.clipboardId;if(t){var a=this,o=this.pres.selection,s=this.pres.session.getConnId(),l={timestamp:Date.now(),select:this.getCopyPasteRange(),ksDocClipboardId:i,imageFormats:[]};this._fillCopyParams(l,n);var u=this.getSelectRangeMimeTypes(o,n);l.extArgs=[{type:"ksDocClipboard",data:{ksDocClipboardId:l.ksDocClipboardId,hasHtml:"false",priorityFormats:u}}],this.setCopyRange(s,i,Object(E.deepClone)(l.select));var c=l.select.slides,h=[];if(c&&c.length>1){var d=this.pres.getContainerByCategory(l.select.category);if(d)for(var p=0;p<c.length;++p){var f=d.getSlideIdxProxy(c[p]);f&&h.push(f)}}var v=o.saveCurrentState(!1);return this.pres.session.execQuery("copy",l,(function(e){if(t()||(e.error=-1),e&&0===e.error){a.setCopyData(s,i,e);var l=v.getSavedState(),u=l.state,c=o._data.fetchSelectObjsById(l),d=c.slide,p=c.shapes,f=c.shapeRanges;if(!d)return;if(p&&u!==q.c.select_none&&u!==q.c.select_slide){for(var y=[],g=0;g<p.length;g++)o.isValidShape(p[g])&&y.push(f[g]);if(0===y.length)return;l.shapes=y}if(v.restore(),h.length>1)o.getSlideMarker().update(l.category,h);var m=!0;switch(u){case q.c.select_slide:case q.c.select_multi_slide:m=o.deleteSlideV2();break;case q.c.select_shape:case q.c.select_multi_shape:case q.c.select_table:m=o.deleteShape();break;case q.c.select_cell:case q.c.select_multi_cell:m=o.getTableSelection().cutCellRange()}m||(e.error=-1)}v.discard(),r&&a._handleServerData(e,r,n)})),i}}},{key:"paste",value:function(e){if(e){var t=this.pres.selection,r={timestamp:Date.now(),select:this.getCopyPasteRange(),extraDatas:{}},n=e.localData;if(n){for(var i in r.localDatas=[],n)n.hasOwnProperty(i)&&"fromWPS"!==i&&r.localDatas.push({type:i,value:n[i]});r.localDatas.push({type:"Kingsoft Data Descriptor",value:"true"})}else{if(!e.ksDocClipboardId)return void console.log("Paste error!");var a=[],o=null;if(e.mimeTypes){for(var s=0;s<e.mimeTypes.length;++s){var l=e.mimeTypes[s];X.includes(l)&&a.push(l)}if(0===a.length)return void console.warn("Paste error, No matched priorityFormats !!")}e.ksDocClipboardId&&(0===a.length&&(a=X.slice(0)),r.extraDatas.priorityFormats=a,r.extraDatas.fromApp=e.fromApp||"",r.ksDocClipboardId=e.ksDocClipboardId,r.bDelayCopy=!0);var u=e.ksDocClipboardId.includes(window.fileInfo.id);e.fromApp&&!u||this.fillPasteParam(e.ksDocClipboardId,r),o={ksDocClipboardId:r.ksDocClipboardId,hasHtml:"false",priorityFormats:a,delayCopy:!0},e.text&&(r.text=e.text),e.html&&(r.html=e.html),r.bDelayCopy&&(r.extArgs=[{type:"ksDocClipboard",data:o}])}this._checkExtraParams(r,e.extraDatas),t.startPasteCommand(r),t.transaction.beginTransact(),t.transaction.addServerOnlyAffects(["*"]),r.genid&&t.transaction.setUserData("genid",r.genid),t.transaction.endTopTransact("paste",r),t._data._slideInsertion=r.select.activeSlide+1}else console.log("Paste error!")}},{key:"duplicate",value:function(e){var t=this.pres.selection,r=this.pres.session.getConnId(),n=r.substring(r.length-8,r.length)+Object(j.a)(),i=t._data.getSelectRanges(),a={timestamp:Date.now(),select:i,bDelayCopy:!1,copyRange:i,canUseCopyRange:!0,ksDocClipboardId:n,slideType:-1};this._checkExtraParams(a,e),t.startPasteCommand(a),t.transaction.beginTransact(),a.genid&&t.transaction.setUserData("genid",a.genid),t.transaction.addServerOnlyAffects(["*"]),t.transaction.endTopTransact("paste",a),t._data._slideInsertion=a.select.activeSlide+1}},{key:"dragPasteShapes",value:function(e){var t=this.pres.selection,r=t.transaction;r.beginBatchCommand();var n=t.getShapeSelection().insertCloneShapes();if(n&&n.length>0){for(var i=[],a=0;a<n.length;a++){n[a].enableModifyProperty(["transform2D"]);var o=Object(K.d)(this.pres,n[a]),s=o.category,l=o.layerType,u=o.slideIdx,c=o.shapePath;i.push({name:"shapeInsert",param:{category:s,layerType:l,slideIdx:u,shapePath:c,slideProps:{}}})}var h=window.APP.utils.createModifier("PasteModifier",e||{});h.setFlag("actionName","DRAG_SHAPES");var d=h.modifiedData();this.duplicate(d&&d.extraDatas);var p=this;return r.registerEndNotify((function(e){if(!e){h.getFlag("actionName")&&r.setActionName(h.getFlag("actionName"));var t=r.getCommands(),n=t&&t[0];if(n&&"paste"===n.name){var a=n.param,o=h.modifiedData();p._checkExtraParams(a,o&&o.extraDatas),a.cvCmds=i}}})),t.selectShapes(n),r.markData("modifier",h),r.resetServerOnlyAffects(),r.endBatchCommand(),{shapes:n,modifier:h}}r.rollback()}},{key:"_checkExtraParams",value:function(e,t){if(e&&t){e.extraDatas||(e.extraDatas={});var r=e.extraDatas;for(var n in t){var i=t[n];"shapeOffset"===n||"adjustShapeType"===n?Q(i)&&(r[n]=i):"screenCenter"===n||"newPos"===n?i&&Q(i.x)&&Q(i.y)&&(r[n]={x:i.x,y:i.y}):"copyArgs"===n?this._fillCopyParams(r,i):r[n]=i}}}},{key:"setCopyRange",value:function(e,t,r){var n=this.clipboardHistory[e]||{};this.getRangeTokens(r),n.clipboardId===t?n.range=r:n={clipboardId:t,range:r},this.clipboardHistory[e]=n,e===this.localConnID&&(this.localClipboardID=t)}},{key:"setCopyData",value:function(e,t,r){var n=this.clipboardHistory[e]||{};n.clipboardId===t?n.data=r:n={clipboardId:t,data:r},this.clipboardHistory[e]=n}},{key:"removeCopyData",value:function(e){delete this.clipboardHistory[e]}},{key:"removeCopyDataByClipId",value:function(e){for(var t=Object.keys(this.clipboardHistory),r=null,n=0;n<t.length;n++){if(this.clipboardHistory[t[n]].clipboardId===e){r=t[n];break}}r&&delete this.clipboardHistory[r]}},{key:"getClipbardData",value:function(e){for(var t=Object.keys(this.clipboardHistory),r=0;r<t.length;r++){var n=this.clipboardHistory[t[r]];if(n.clipboardId===e)return n}}},{key:"fillPasteParam",value:function(e,t){t.bDelayCopy=!0,t.slideType=-1,t.ksDocClipboardId=e;var r=this.getClipbardData(e);if(!r)return t;var n=r.range,i=r.data,a=i&&i.data;return a&&(a.text&&(t.text=a.text),a.html&&(t.html=a.html),t.slideType=null==a.slideType?-1:a.slideType),n&&!n.bInValid&&(t.bDelayCopy=!1,t.copyRange=Object(E.deepClone)(n)),t}},{key:"getRangeTokens",value:function(e){var t=this.pres;if(e.slideToken=null,e.state!==q.c.select_none){if(null!=e.activeSlide&&e.activeSlide>=0){var r=t.getSlideByIdx(e.layerType,e.category,e.activeSlide);r&&(e.slideToken={dataToken:r.data_token,treeToken:r.tree_token})}if(null!=e.slideToken){if(e.state!==q.c.select_slide&&e.state!==q.c.select_multi_slide)if(e.shapes&&e.shapes.length>0)for(var n=t.getBuddy(),i=0;i<e.shapes.length;i++){var a=n.fetchShape(e.shapes[i]);if(!a)return void(e.bInValid=!0);e.shapes[i].token={dataToken:a.data_token,treeToken:a.tree_token}}else e.bInValid=!0}else e.bInValid=!0}else e.bInValid=!0}},{key:"updateHistory",value:function(e){for(var t=Object.keys(e),r=0;r<t.length;r++){var n=e[t[r]],i=n.range;if(i){var a=!1,o=Object(E.deepClone)(i);if(this.getRangeTokens(o),!o.bInValid&&o.state===i.state&&null!=i.slideToken&&null!=o.slideToken)if(i.state===q.c.select_slide||i.state===q.c.select_multi_slide)i.slideToken.dataToken===o.slideToken.dataToken&&i.slideToken.treeToken===o.slideToken.treeToken&&(a=!0);else{var s=i.shapes,l=i.shapes,u=s.length;if(u===l.length&&u>0){for(var c=0,h=0;h<u;h++){var d=s[h],p=l[h];p.token.dataToken===d.token.dataToken&&p.token.treeToken===d.token.treeToken&&(c+=1)}a=c===u}}n.range=a?o:null}}this.clipboardHistory=e}},{key:"getCopyPasteRange",value:function(){var e=this.pres.selection;e._data.state===q.c.select_multi_animation&&e.clearAnimationSelect();var t=e.getSlideMarker().fetchIdxs(),r=e._data.getSelectRanges();return r.slides=[],t.length>1?(r.state=q.c.select_multi_slide,r.slides=t.slice()):r.activeSlide&&r.slides.push(r.activeSlide),r.state===q.c.select_text&&(r.text={begin:r.begin,end:r.end},delete r.begin,delete r.end),r}},{key:"selectRangeToCopyRange",value:function(e){(e.slides=[],e.activeSlide&&e.slides.push(e.activeSlide),e.tableActive)&&(e.shapes&&e.shapes[0]||(e.table=null,e.tableRange=null));return e}},{key:"copyRangeToSelectRange",value:function(e){if(e.tableActive)if((e=Object(E.deepClone)(e)).shapes&&e.shapes[0]){var t=e.table;e.tableRange=t}else e.table=null,e.tableRange=null;return e}}]),e}(),Z=r(2243),$=function(){function e(t){i()(this,e),this.pres=t,this.pres.brushType=Y.FormatBrushType.Invalid,this.pres.stashCache={}}return o()(e,[{key:"saveFormat",value:function(e){var t=!1;switch(e){case Y.FormatBrushType.Common:t=this.stashCommon();break;case Y.FormatBrushType.Transform2D:t=this.stashTransform2D();break;case Y.FormatBrushType.Animation:t=this.stashAnimation()}t&&(this.pres.brushType=e)}},{key:"clearFormat",value:function(){this.pres.brushType=Y.FormatBrushType.Invalid,this.pres.stashCache&&(delete this.pres.stashCache,this.pres.stashCache=null)}},{key:"stashCommon",value:function(){var e=!1,t=this.pres.selection;switch(t.state){case q.c.select_slide:var r=t.getActiveSlide();e=this._stashSlide(r);break;case q.c.select_text:var n=t.getActiveTextFrame(),i=t.getRange();e=this._stashText(n,i);break;case q.c.select_shape:var a=t.getActiveShapes();1===a.length&&(e=this._stashShapeCommon(a[0]));break;case q.c.select_cell:case q.c.select_multi_cell:var o=t.getActiveTableFrame(),s=t.getActiveTableCells();e=this._stashTable(o,s)}return e}},{key:"_stashSlide",value:function(e){}},{key:"_stashText",value:function(e,t){var r=t.begin,n=t.end,i=r===n,a=e.getTextStream(),o=a.end,s=a.getParaTbl().getItems(r,n-r),l=null;if(i){var u=e.visual.getCompleteTextProps();if(!u||u.length<=0)return!1;for(var c=r,h=0;h<u.length;++h){var d=u[h];if(c>=d.begin&&c<d.end){d.begin===c&&c>0?c++:c>d.begin&&c--;break}if(c===d.end&&c===o){c-=2;break}}if(!(l=e.visual.getCompleteTextPropsByGcp(c)))return!1;l.paraProp&&delete l.paraProp}else if(1===s.length){if(!(l=e.visual.getCompleteTextPropsByGcp(r)))return!1;l.paraProp&&delete l.paraProp}else l=e.visual.getCompleteTextPropsByGcp(r);this.pres.stashCache&&delete this.pres.stashCache,l.chpProp&&Z.a.formatChpProps(l.chpProp),l.paraProp&&Z.a.formatPapProps(e,l.paraProp);var p={textProp:l,stashType:"text"};return this.pres.stashCache=p,!0}},{key:"_stashShapeCommon",value:function(e){if(e.hasTable()){var t=e.getTableFrame();return this._stashTable(t)}return e.isInk()?this._stashInkShape(e):this._stashShape(e)}},{key:"_stashShape",value:function(e){if(e.hasTable()||e.hasChart()||e.hasSmartArt()||e.isOle()||e.isGroupShape())return!1;this.pres.stashCache&&delete this.pres.stashCache;var t={stashType:"shape"},r=e.getTextFrame();if(r&&r.getTextStream()){var n=r.visual.getCompleteTextPropsByGcp(0);n.chpProp&&Z.a.formatChpProps(n.chpProp),n.paraProp&&Z.a.formatPapProps(r,n.paraProp),t.textProp=n;var i={},a=r.visual.getCompleteTextFrameProps();Z.a.copyData(i,a),Z.a.formatTextFrameProps(r,i),t.txtFrameProp=i}var o=e.visual.getFill();if(o){var s={};if(Z.a.copyData(s,o),s.color){var l=window.CoreUtils.getColorDelegation("fill",e,e.getSlide());s.pretColor=window.CoreUtils.interpretColor(s.color,l);var u=[{op:0,val:s.pretColor.alpha}],c=window.CoreTypes.Color.fromString(s.pretColor.toRGB,u);s.pretColor=c.data}t.fill=s}var h=e.visual.getOutline();if(h){var d={},p=window.CoreUtils.getColorDelegation("fill",e,e.getSlide());if(Z.a.copyData(d,h),d.fill){var f=d.fill;if(f.color){d.fill.pretColor=window.CoreUtils.interpretColor(f.color,p);var v=[{op:0,val:d.fill.pretColor.alpha}],y=window.CoreTypes.Color.fromString(d.fill.pretColor.toRGB,v);d.fill.pretColor=y.data}}t.outline=d}var g=e.getStyle();return g&&(t.shapeStyle=Object(P.a)(g)),this.pres.stashCache=t,!0}},{key:"_stashTable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.getChilds();if(!r||r.length<1)return!1;var n=null;n=t?t[0]:r[0],this.pres.stashCache||delete this.pres.stashCache;var i={stashType:"text"},a=n.getTextFrame(),o=a.visual.getCompleteTextPropsByGcp(0);return o.chpProp&&Z.a.formatChpProps(o.chpProp),o.paraProp&&Z.a.formatPapProps(a,o.paraProp),i.textProp=o,this.pres.stashCache=i,!0}},{key:"_stashInkShape",value:function(e){var t=e.getInkData().brushMap;if(!t)return!1;this.pres.stashCache&&delete this.pres.stashCache;var r={stashType:"shape",brushMap:Object(P.a)(t)};return this.pres.stashCache=r,!0}},{key:"stashTransform2D",value:function(){var e=this.pres.selection,t=e.state;if(t!==q.c.select_text&&t!==q.c.select_shape&&t!==q.c.select_multi_shape&&t!==q.c.select_cell&&t!==q.c.select_multi_cell)return!1;var r=e.getActiveShapes();if(!r||r.length<=0)return!1;this.pres.stashCache&&delete this.pres.stashCache;for(var n=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=0;a<r.length;++a){var o=r[a].visual.getRealTransform2D(),s=o.x,l=o.y;s<n&&(n=s),l<i&&(i=l)}return this.pres.stashCache={stashType:"trans2D",trans2D:{x:n,y:i}},!0}},{key:"stashAnimation",value:function(){var e=this.pres.selection,t=e.state;if(t!==q.c.select_text&&t!==q.c.select_shape&&t!==q.c.select_cell&&t!==q.c.select_multi_cell&&t!==q.c.select_multi_animation)return!1;var r=e.getActiveSlide();if(!r)return!1;var n=e.getActiveShapes();if(!n||1!==n.length)return!1;var i=n[0].visual.getRootShape(),a=r.getTiming();if(!a)return!1;var o=a.mainSequence;if(!o)return!1;var s=o.getEffect(i.getId());if(s.length<1)return!1;var l=[],u=null;return s.forEach((function(e){if(!e.isMedia){if(e.hasPara()){if(u)return;return(u=Z.a.copyAnimData(e)).isPara=!0,void l.push(u)}l.push(Z.a.copyAnimData(e))}})),!(l.length<=0)&&(this.pres.stashCache&&delete this.pres.stashCache,this.pres.stashCache={stashType:"animation",animations:l},!0)}},{key:"checkBrush",value:function(){if(this.pres.brushType===Y.FormatBrushType.Invalid)return!1;if(!this.pres.stashCache)return!1;var e=this.pres.selection.state;return e===q.c.select_slide||e===q.c.select_shape||e===q.c.select_cell||e===q.c.select_multi_cell||e===q.c.select_text}}]),e}(),ee=r(2244),te=function(){function e(t){i()(this,e),this.pres=t,this.masters=t.masters,this.layouts=t.layouts,this.mastersProxys=this.masters.getProxys(),this.layoutsProxys=this.layouts.getProxys(),this.masters.addProxyNotifiers(this),this.layouts.addProxyNotifiers(this)}return o()(e,[{key:"init",value:function(e){var t=null,r=null;if(e)try{t=(e=JSON.parse(e)).masterList,r=[];for(var n=e.layoutMasterPairs.split(","),i=0;i<n.length;i++){var a=n[i].split("-");2===a.length&&r.push({id:parseInt(a[0]),follow:parseInt(a[1])})}}catch(e){t=null,r=null}if(t&&r){this.private={masterList:t,layoutMasterPairs:r};for(var o={},s=0;s<t.length;s++){var l=t[s],u=l.masterId,c=l.name,h=this.mastersProxys.ensureAt(s);h.setSlideId(u),h.name=c,h.followed=[],o[u]=h.followed}for(var d=0;d<r.length;d++){var p=r[d],f=p.id,v=o[p.follow];if(v){var y=this.layoutsProxys.ensureAt(d);y.setSlideId(f),v.push(y)}}}}},{key:"getMasterProxy",value:function(e){var t=-1,r=this.private&&this.private.masterList;if(r)for(var n=0;n<r.length;n++)if(e===r[n].masterId){t=n;break}if(t>=0)return this.mastersProxys.ensureAt(t)}},{key:"getProxy",value:function(e,t){if("slideMasters"===e)return this.getMasterProxy(t);if("slideLayouts"===e){var r=this.private&&this.private.layoutMasterPairs;if(r)for(var n=0;n<r.length;n++)if(r[n].id===t)return this.layouts.getSlideIdxProxy(n)}}},{key:"_updateMasterLayouts",value:function(e){var t=this.private&&this.private.layoutMasterPairs,r=this.getMasterProxy(e);if(r&&t){for(var n=r.followed||[],i=n.length,a=0,o=0;o<t.length;o++){var s=t[o],l=s.id;if(s.follow===e){var u=this.layoutsProxys.ensureAt(o);u.setSlideId(l),n[a]=u,a+=1}}i>a&&n.splice(a,i-a),r.followed=n}}},{key:"onProxyInserted",value:function(e,t){if("slideLayouts"===t.category){var r=this.private&&this.private.layoutMasterPairs;if(r){var n=this.pres.getSlideByProxy(t),i={id:n.getId(),follow:n.getFollowId()};console.assert(n.getFollowId()),r.splice(e,0,i),this._updateMasterLayouts(i.follow)}}else if("slideMasters"===t.category){var a=this.private&&this.private.masterList;if(a){var o=this.pres.getSlideByProxy(t),s=o&&o.getTheme(),l=s&&s.getName();a.splice(e,0,{masterId:o.getId(),name:l}),this._updateMasterLayouts(o.getId())}}}},{key:"onProxyRemoved",value:function(e,t,r){if("slideLayouts"===t.category){var n=this.private&&this.private.layoutMasterPairs;n&&(console.assert(r.getFollowId()),n.splice(e,1),this._updateMasterLayouts(r.getFollowId()))}else if("slideMasters"===t.category){var i=this.private&&this.private.masterList;i&&i.splice(e,1)}}},{key:"onProxyMoved",value:function(e,t,r){}},{key:"onProxyReseted",value:function(e){}},{key:"getLayoutCountById",value:function(e){for(var t=this.private,r=0;r<t.length;r++)if(t[r].masterId===e)return t[r].layouts.length;return 0}},{key:"getLayoutCount",value:function(e){return e?this.getLayoutCountById(e.getId()):0}},{key:"_getLayoutFollowMaster",value:function(e){var t=this.private&&this.private.layoutMasterPairs;if(t){for(var r=-1,n=0;n<t.length;n++){var i=t[n],a=i.id,o=i.follow;if(a===e.slideId){r=o;break}}return this.getMasterProxy(r)}}},{key:"_getLayoutIdxInMaster",value:function(e,t){for(var r=t.followed,n=0;n<r.length;n++)if(r[n]===e)return n;return-1}},{key:"previous",value:function(e){if(e){var t=null;if("slideMasters"===e.category){var r=this.pres.previousSlideProxy(e);if(r){var n=r.followed,i=n.length;t=i>0?n[i-1]:r}}else if("slideLayouts"===e.category){var a=this._getLayoutFollowMaster(e);if(a){var o=a.followed,s=this._getLayoutIdxInMaster(e,a);t=0===s?a:o[s-1]}}return t}}},{key:"next",value:function(e){if(e){var t=null;if("slideMasters"===e.category){var r=e.followed;t=0===r.length?this.pres.nextSlideProxy(e):r[0]}else if("slideLayouts"===e.category){var n=this._getLayoutFollowMaster(e);if(n){var i=n.followed,a=i.length,o=this._getLayoutIdxInMaster(e,n);t=o<a-1?i[o+1]:this.pres.nextSlideProxy(n)}}return t}}}]),e}(),re=r(1713),ne=r(2245),ie=r(263),ae=r(446),oe=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.parent=e,r.private={},r.listenPropertyChanged(["customProps","showSettings","pageSetup"],(function(e,t,n){r._onPropertyChanged(e,t,n)})),r}return c()(t,e),o()(t,[{key:"addProps",value:function(e,t){this.private[e]=t}},{key:"getShowSettings",value:function(){return this.private.showSettings}},{key:"getPageSetup",value:function(){return this.private.pageSetup}},{key:"getCustomProps",value:function(){return this.private.customProps}},{key:"modifyProps",value:function(e,t,r){this.setPropertyValue(e,r?Object(P.a)(t):t);var n={};return t?n[e]=r?Object(P.a)(t):t:n.undefineds=[e],{newval:n}}},{key:"_onPropertyChanged",value:function(e,t,r){var n=void 0,i=void 0;switch(e){case"pageSetup":n=m.default.modify_page_setup,i=this.getPageSetup()}n&&this.parent._bubbleUpEvent(n,i)}},{key:"_fireChanged",value:function(e){console.log("*****************op",e)}}]),t}(ie.AbsCustomObject);Object(ae.e)(oe.prototype,!1),window.CoreExports=ne,window.CoreTypes=N,window.CoreUtils=M;var se=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r.container=r.private.childs,r.is_presentation=!0,r.fontTable={},r.updateFontTable(r.private.fontTable),r}return c()(t,e),o()(t,[{key:"init",value:function(e,r,n,i){var a=this;if(console.log("*****init presentation:",this.private.readonly),this._cstimestamp=n._starttime,this._isPreviewCache=n.bPreview,function(e,t){e.transLevel=0,window._glbTransaction=new U(e,t)}(e,this),this.secDocInfo=n.secDocInfo,this.private.docConfig)try{this.private.docConfig=JSON.parse(this.private.docConfig)}catch(e){this.private.docConfig={}}this.initPropsContainer(),this.session=r,i.setPresentation(this);var o=r.getUserId(),s=r.getConnId();this.rpt=e,this.containerMap={},this.container.forEach((function(e){a.containerMap[e.category]=e,e.init(r)})),this.buildTree(),this.slides=this.private.slides,this.layouts=this.getContainerByCategory("slideLayouts"),this.masters=this.getContainerByCategory("slideMasters"),this.selections_mgr=new g(e,this,o,s,i),this.selection=this.selections_mgr.getLocalSelection(),this.private.woObj.init(this),this.masterTools=new te(this),this._localID=0,this.selections_mgr.on(g.EventTypes.ERROR_READONLY,(function(e){a.fire(t.EventTypes.ERROR_READONLY,e)})),window.selection=this.selection,this._imageIdMap={},this._mediaIdMap={},this.updateInitProps(n),this.slide_loader=new k(this,r),this.slide_loader.pushSvrData(n.slides,this.bNeedQueryInitVer),this.utils=window.CoreUtils,this.drawingNotifyer=new z.a({pres:this,selection:this.selection,EventTypes:t.EventTypes}),this.copypasteMgr=new J(this),this.searcherMgr=new ee.a(this),this.formatBrush=new $(this),this.commentHelper=re.a}},{key:"installRecoverHandler",value:function(e){this.recoverHandler=e,this.session.regAckHandler(e),this.recoverHandler.installRecoverFilter(this.recoverFilter)}},{key:"updateInitProps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.secDocInfo=e.secDocInfo,"number"==typeof e.slideslimit&&e.slideslimit>=0?this.slidesLimit=e.slideslimit:this.slidesLimit=-1,e.extraDatas&&this.masterTools.init(e.extraDatas.masterSummary);var r=this.session.getConnId(),n=!(e._createBy&&r!==e._createBy);t||n?(this.bNeedQueryInitVer=!1,this.userInitToken=e._initToken):n||(this.bNeedQueryInitVer=!0)}},{key:"onInitInfoResponse",value:function(e){this.updateInitProps(e,!0),this.session.setPermisions()}},{key:"destroy",value:function(){this.searcherMgr.discardAll(),this.slide_loader&&this.slide_loader.destroy(),delete this.slide_loader,delete this.selections_mgr,delete this.drawingNotifyer,delete this.copypasteMgr,delete this.formatBrush}},{key:"getLoaderMgr",value:function(){return this.slide_loader}},{key:"getFollowingCategory",value:function(e){switch(e){case"slides":return"slideLayouts";case"slideLayouts":return"slideMasters"}}},{key:"initPropsContainer",value:function(){var e=this,t=this.ensurePropContainer();["customProps","showSettings","pageSetup"].forEach((function(r){e.private[r]&&(t.addProps(r,e.private[r]),delete e.private[r])}))}},{key:"ensurePropContainer",value:function(){return this.private.propsContainer||(this.private.propsContainer=new oe(this)),this.private.propsContainer}},{key:"pushSvrData",value:function(e){if(e){var t=[];this.container.forEach((function(r){e.category===r.category&&(t.push({slideCont:r,data:e}),r.pushSvrData(e))}));for(var r=e.childs,n=0;n<r.length;n++)for(var i=r[n],a=i&&i.getFollowing();a;){var o=this.getFollowingCategory(i.getCategory()),s=this.getContainerByCategory(o);if(s&&s.getSlideIdx(a)<0){var l=this.masterTools.getProxy(o,a.getId());if(l){var u={category:o,partSerial:{start:l.idx,len:1,count:s.getSlideCount()},childs:[a]};t.push({slideCont:s,data:u}),s.pushSvrData(u)}}a=(i=a).getFollowing()}for(var c=0;c<t.length;c++){var h=t[c];h.slideCont.fireSvrDataLoaded(h.data)}this.selections_mgr&&this.selections_mgr.resyncDelayLoadSlides()}}},{key:"getContainerIdxByCategory",value:function(e){for(var t=0,r=this.container.length;t<r;++t){var n=this.container[t];if(n&&n.getCategory()===e)return t}return-1}},{key:"getContainerByCategory",value:function(e){return this.containerMap[e]}},{key:"getContainerAt",value:function(e){return this.container[e]}},{key:"getContainerSize",value:function(){return this.container.length}},{key:"getSelectionsMgr",value:function(){return this.selections_mgr}},{key:"getSelection",value:function(){return this.selection}},{key:"getMasters",value:function(){return this.masters}},{key:"getLayouts",value:function(){return this.layouts}},{key:"getSlides",value:function(){return this.slides}},{key:"getSlideAt",value:function(e){return this.slides.getSlideAt(e)}},{key:"getSlideCount",value:function(){return this.slides.getSlideCount()}},{key:"getSlideIdxById",value:function(e){return this.slides.getSlideIdxById(e)}},{key:"getSlideById",value:function(e){return this.slides.getSlideById(e)}},{key:"getSlideById2",value:function(e,t,r){var n=this.getContainerByCategory(e);if(n){if(t!==Y.WppLayerType.WppLayerNotesPage)return n.getSlideById(r);for(var i=n.getSlideCount(),a=0;a<i;a++){var o=n.getSlideAt(a);if(o){var s=o.getNotesPage();if(s&&s.getId()===r)return s}}}}},{key:"getSlideIdx",value:function(e){if(e){var t=this.getContainerByCategory(e.getCategory());if(t){var r=e;return e.layerType===Y.WppLayerType.WppLayerNotesPage&&(r=e.parent),t.getSlideIdx(r)}}return-1}},{key:"getSlideByIdx",value:function(e,t,r){var n=this.getContainerByCategory(t),i=void 0;return n&&(i=n.getSlideAt(r)),i&&e==Y.WppLayerType.WppLayerNotesPage&&(i=i.getNotesPage()),i}},{key:"buildTree",value:function(){var e=this;this.container.forEach((function(t){return t.buildTree(e)}))}},{key:"isDataLoadCompleted",value:function(){var e=this.getLoaderMgr();return e&&e.isCompleted()}},{key:"_bubbleUpEvent",value:function(e,r){try{if(e===m.default.collect_path)return;r.event=e;var n=r&&r.data,i=n&&n.getActionType&&n.getActionType();if(i){r.actionType=i,n.clearActionType();var a=this.selection.transaction;if(!a.isInTransaction()){var o=a.rpt.transacts;o.length>0&&(a=o[o.length-1])}a&&(r.isSelf=a.isSelf,r.isLocal=a.isLocal),n.apiShell&&n.apiShell.buildTree(r.apiShell)}switch(m.default.modify_types_start<e&&e<m.default.modify_types_end?this.fire(t.EventTypes.MODIFY,r):m.default.edit_slide_start<e&&e<m.default.edit_slide_end?this.fire(t.EventTypes.UPDATE_THUMBNAIL,r):e===m.default.animation_notify?this.fire(t.EventTypes.NOTIFY_ANIMATION,r):e===m.default.animation_preview?this.fire(t.EventTypes.NOTIFY_ANIMATION_PREVIEW,r):e===m.default.modify_comment&&this.fire(t.EventTypes.NOTIFY_COMMENT,r),e===m.default.update_slides&&this.fire(t.EventTypes.UPDATE_SLIDES,r),e===m.default.modify_slide_container&&this.fire(t.EventTypes.MODIFY_SLIDE_CONTAINER,r),e===m.default.modify_page_setup&&this.fire(t.EventTypes.MODIFY_PAGE_SETUP,r),e){case m.default.server_paste_start:case m.default.server_doctemplate_start:case m.default.server_doctemplate_end:this.fire(t.EventTypes.NOTIY_BACKEND_CMD,{event:e,param:r});break;case m.default.server_chart_insert_end:break;case m.default.server_paste_complete:this.onPasteComplete(r);break;case m.default.server_pagesetup_end:r.finish=!0,this.fire(t.EventTypes.MODIFY_PAGE_SETUP,{event:e,param:r});break;case m.default.server_documentbeautify_end:this.fire(t.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,{event:e,param:r})}}catch(e){console.error(e)}}},{key:"onLocalEditCommit",value:function(){this.fire(t.EventTypes.MODIFY_COMMIT)}},{key:"onMultiSlides",value:function(){this.fire(t.EventTypes.MULTI_SLIDE)}},{key:"onPasteComplete",value:function(e){this.selection.getSlideMarker().clear()}},{key:"getMainObjID",value:function(){return null==this.private.woObj?null:this.private.woObj.private.objID}},{key:"getBuddy",value:function(){return this.private.woObj}},{key:"isReadOnly",value:function(){return!!this.private.readonly||this.bNeedQueryInitVer}},{key:"allocateLocalId",value:function(){var e=Date.now();return e=e<<17|2147483648,this._localID=this._localID+1&65535,e|this._localID}},{key:"getUploadId",value:function(e){return this._imageIdMap[e]}},{key:"getMediaUploadId",value:function(e){return this._mediaIdMap[e]}},{key:"setShapeDepthDatas",value:function(e){this._shapeDepth=e}},{key:"getShapeDepth",value:function(e,t){if(this._shapeDepth)for(var r=e+"_"+t,n=0;n<this._shapeDepth.length;n++){var i=this._shapeDepth[n];if(i.id==r)return i.v}return null}},{key:"convertStyleFormat",value:function(e){var t=["lvl1pPr","lvl2pPr","lvl3pPr","lvl4pPr","lvl5pPr","lvl6pPr","lvl7pPr","lvl8pPr","lvl9pPr"];if(!e)return null;for(var r={chpStyles:[],paraStyles:[]},n=0,i=t.length;n<i;n++){var a={prop:{}},o={prop:{}},s=e[t[n]];s&&(a.prop=s.runPr.private,o.prop=s.paraPr.private),r.chpStyles.push(a),r.paraStyles.push(o)}return r}},{key:"getDefaultTextStyle",value:function(){return this._defaultTextStyle=this._defaultTextStyle||this.convertStyleFormat(this.private.defaultTextStyle),this._defaultTextStyle}},{key:"getDefaultTblStyleID",value:function(){return this.private.defaultTBStyleId}},{key:"getPresetTblStyleList",value:function(){return this.private.presetTblStyles}},{key:"getPresetAudioIcons",value:function(){return this.private.woObj.private.presetAudioIcons}},{key:"getShowSettings",value:function(){return this.ensurePropContainer().getShowSettings()}},{key:"getPageSetup",value:function(){return this.ensurePropContainer().getPageSetup()}},{key:"getSlideSize",value:function(){var e=this.getPageSetup();return e||console.error("Could Not Found PageSetup !!"),{type:e.getProps("slideSizeType"),width:e.getProps("slideWidth"),height:e.getProps("slideHeight")}}},{key:"getAdvanceMode",value:function(){var e=this.getShowSettings();return e&&e.private&&e.private.advanceMode}},{key:"getCustomProps",value:function(){return this.ensurePropContainer().getCustomProps()}},{key:"getConfigs",value:function(){var e=this.getCustomProps();if(!e||!e.vector)return null;for(var t=0;t<e.vector.length;++t){var r=e.vector[t];if(r.private&&r.private.docConfig)return r.private.docConfig.private}return null}},{key:"getLocalConfigs",value:function(){return this.private.docConfig}},{key:"setLocalConfigs",value:function(e){var t={docConfig:Object(E.deepClone)(this.private.docConfig)};this._recordChanged("docConfig",e,t.docConfig);var r=window.getTransaction();r.isInTransaction()&&r.record(this,"modifyPresentation",{data:{docConfig:JSON.stringify(e)},oldval:t}),this.private.docConfig=Object.assign({},this.private.docConfig||{},e||{})}},{key:"setShowSettings",value:function(e){return this.ensurePropContainer().modifyProps("showSettings",e,!1)}},{key:"setCustomProps",value:function(e){return this.ensurePropContainer().modifyProps("customProps",e,!1)}},{key:"setPageSetup",value:function(e){return this.ensurePropContainer().modifyProps("pageSetup",e,!1)}},{key:"queryComment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"invalid",r=arguments[2],n=this.session;e.type=t,n.execSimpleQuery("comment",e,r)}},{key:"queryFont",value:function(){this.session.execSimpleQuery("fontMatchTable",{},(function(e){console.info("--------query font table",e)}))}},{key:"forward",value:function(e){var t=e.data,r=t.name,n=t.param;if("modifyPresentation"==r&&n&&n.data){var i={},a=n.data.docConfig;if(a)try{a=JSON.parse(a),i.docConfig=Object(E.deepClone)(this.private.docConfig||{}),this._recordChanged("docConfig",a,i.docConfig);var o=this.private.docConfig||{};this.private.docConfig=Object.assign({},o,a||{})}catch(e){}n.oldval=i}}},{key:"backward",value:function(e){var t=this,r=this,n=function(e){var n=e.name,i=e.param;if("modifyPresentation"==n&&i){var a=i.oldval;if(a.docConfig){var o=r.private.docConfig;t._recordChanged("docConfig",a.docConfig,o),r.private.docConfig=a.docConfig}}};if(e.data instanceof Array){var i=[];Object.assign(i,e.data),i.reverse();for(var a=0;a<i.length;++a)n(i[a])}else n(e.data)}},{key:"_recordChanged",value:function(e,t,r){this._changed||(this._changed={});var n=this._changed[e]||{};this._changed[e]={newval:Object.assign({},n.newval||{},t),oldval:Object.assign({},n.oldval||{},r)}}},{key:"_fireChanged",value:function(){if(this._changed){var e=this._changed.docConfig;if(e&&e.newval){var t=e.newval,r=t.hideAllInk,n=t.hiddenInkSlides,i=t.shownInkSlides;e.oldval&&e.oldval.hideAllInk===r&&(r=null);var a=this.slides.children;if(null!=r)for(var o=0;o<a.length;o++)a[o]&&a[o]._fireChangedInner({flags:{hiddenInkChanged:!0}});else{var s=Object(E.arrayUnion)([],n,i);if(s)for(var l=this.container,u=0;u<l.length;u++)for(var c=l[u].children,h=0;h<c.length;h++){var d=c[h];d&&s.indexOf(d.getId())>=0&&d._fireChangedInner({flags:{hiddenInkChanged:!0}})}}}this._changed=null}}},{key:"getCommentAuthors",value:function(){return this.private.commentAuthors}},{key:"getCommentHelper",value:function(){return this.commentHelper}},{key:"slidesPreviewLimit",value:function(){return"number"==typeof this.slidesLimit&&this.slidesLimit>=0?this.slidesLimit:-1}},{key:"getSecDocInfo",value:function(){return this.secDocInfo}},{key:"getSlideProxy",value:function(e){var t=e&&e.parent;if(t){var r=t.getSlideIdx(e);if(r>=0)return t.getSlideIdxProxy(r)}}},{key:"getSlideByProxy",value:function(e){if(e){var t=e.category,r=this.getContainerByCategory(t);if(r)return r.getSlideByIdxProxy(e)}}},{key:"previousSlideProxy",value:function(e){if(e){var t=e.category,r=this.getContainerByCategory(t);if(r){var n=e.idx;if(n-1>=0)return r.getSlideIdxProxy(n-1)}}}},{key:"nextSlideProxy",value:function(e){if(e){var t=e.category,r=this.getContainerByCategory(t);if(r){var n=r.getSlideCount(),i=e.idx;if(i+1<n)return r.getSlideIdxProxy(i+1)}}}},{key:"getFollowedSlides",value:function(e){var t=e&&e.getCategory(),r=e&&e.getId();return this.getFollowedSlidesBySlideId(r,t)}},{key:"getFollowedSlidesById",value:function(e,t){if(Object.isEmpty(e)||Object.isEmpty(t))return[];var r=null;"slideMasters"===t?r="slideLayouts":"slideLayouts"===t&&(r="slides");var n=[],i=r&&this.getContainerByCategory(r);if(i)for(var a=e,o=i.getSlideCount(),s=0;s<o;s++){var l=i.getSlideAt(s);l&&l.getFollowId()===a&&n.push(l)}return n}},{key:"isSlideFollowedByOthers",value:function(e){if(!e)return!1;var t=e.getCategory(),r=[];if("slideLayouts"===t)r=[e.getId()];else if("slideMasters"===t)for(var n=this.getSlideProxy(e).followed,i=0;i<n.length;i++)r.push(n[i].slideId);if(r.length>0)for(var a=this.slides,o=a.getSlideCount(),s=0;s<o;s++){var l=a.getSlideAt(s);if(r.indexOf(l.getFollowId())>=0)return!0}return!1}},{key:"isPreviewCache",value:function(){return!!this._isPreviewCache}},{key:"recoverFilter",value:function(e){if(!e||e.length<=0)return null;for(var t=function(e,t,r){for(var n=0;n<t.length;++n){var i=t[n],a=i.name,o=i.param;switch(a){case"txtStrmInsert":case"txtStrmDelete":r.push({name:a,timestamp:e,slideIdx:o.slideIdx,text:o.text});break;case"commentAdd":var s=o.comment;r.push({name:a,timestamp:e,slideIdx:o.slideIdx,text:s.content})}}},r=[],n=0;n<e.length;++n){var i=e[n].args,a=i.commands,o=i.timestamp;if(a)for(var s=0;s<a.length;++s){var l=a[s],u=l.name,c=l.param;t(o,"batchCommands"===u?c.commands:[a[s]],r)}}return r}},{key:"getFont",value:function(e){if(this.fontTable)return this.fontTable[e]}},{key:"updateFontTable",value:function(e){if(e)for(var t=0;t<e.length;t++){var r=e[t].id;this.fontTable[r]=e[t]}}}]),t}(p.a);se.EventTypes={MODIFY:"modify",MODIFY_COMMIT:"modify_commit",UPDATE_SLIDES:"update_slides",MODIFY_SLIDE_CONTAINER:"modify_slide_container",UPDATE_THUMBNAIL:"update_thumbnail",ERROR_READONLY:"error_readonly",NOTIFY_ANIMATION:"animation_notify",NOTIFY_ANIMATION_PREVIEW:"animation_preview",NOTIFY_COMMENT:"comment_notify",NOTIY_BACKEND_CMD:"backend_cmd",MULTI_SLIDE:"multi_slide",MODIFY_PAGE_SETUP:"modify_page_setup",SLIDE_SIZE_FAILED:"slide_size_failed",MODIFY_DOCUMENT_BEAUTIFY:"modify_document_beautify"},se.EventArgs={category:"category",slideId:"slideId",shapeIds:"shapeIds",cpStart:"cpStart",cpEnd:"cpEnd"};t.a=se},1866:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(875),d=r(543),p=r(763),f=r(268),v=r(167),y=r(360),g=r(606),m=function(){function e(){i()(this,e)}return o()(e,null,[{key:"isValidRowCol",value:function(e,t,r){return!(t<0||r<0||t>=e.getRowCount()||r>=e.getColumnCount())}},{key:"firstRowBottomProp",value:function(e,t){var r=e.visual.getStyle();return t.endCol===e.getColumnCount()&&e.visual.useLastCol?r.getNeCellBottomProp():0===t.startCol&&e.visual.useFirstCol?r.getNwCellBottomProp():r.getFirstRowBProp()}},{key:"lastRowTopProp",value:function(e,t){var r=e.visual.getStyle();return 0===t.startCol&&e.visual.useFirstCol?r.getSwCellTopProp():t.endCol===e.getColumnCount()&&e.visual.useLastCol?r.getSeCellTopProp():r.getLastRowTProp()}},{key:"firstColRightProp",value:function(e,t){var r=e.visual.getStyle();return 0===t&&e.visual.useFirstRow?r.getNwCellRightProp():t+1===e.getRowCount()&&e.visual.useLastRow?r.getSwCellRightProp():r.getFirstColRProp()}},{key:"bandRowBottomProp",value:function(e,t){var r=e.visual.useFirstRow?1:0,n=e.visual.getStyle();return(t-r)%2==0?n.getBand1HBottomProp()||n.getBand1HTopProp():n.getBand2HBottomProp()||n.getBand1HTopProp()}},{key:"bandColRightProp",value:function(e,t){var r=e.visual.useFirstCol?1:0,n=e.visual.getStyle();return(t-r)%2==0?n.getBand1VRightProp()||n.getBand2VLeftProp():n.getBand2VRightProp()||n.getBand2VLeftProp()}},{key:"lastColLeftProp",value:function(e,t){var r=e.visual.getStyle();return 0===t&&e.visual.useFirstRow?r.getNeCellLBProp():t+1===e.getRowCount()&&e.visual.useLastRow?r.getSeCellLeftProp():r.getLastColLProp()}},{key:"useFirstColRBorder",value:function(e,t,r){if(t+1===e.getRowCount())return!1;var n=e.visual.getCellGridData(t,r),i=e.visual.getCellGridData(t+1,r);return 0===n.startCol?0!==i.startCol:0===i.startCol}},{key:"useLastColLBorder",value:function(e,t,r){if(t+1===e.getRowCount())return!1;var n=e.visual.getCellGridData(t,r),i=e.visual.getCellGridData(t+1,r),a=e.getColumnCount();return n.endCol===a?i.endCol!==a:i.endCol===a}},{key:"useFirstRowBBorder",value:function(e,t,r){if(r+1===e.getColumnCount())return!1;var n=e.visual.getCellGridData(t,r),i=e.visual.getCellGridData(t,r+1);return 0===n.startRow?0!==i.startRow:0===i.startRow}},{key:"useLastRowTBorder",value:function(e,t,r){if(r+1===e.getColumnCount())return!1;var n=e.getRowCount(),i=e.visual.getCellGridData(t,r),a=e.visual.getCellGridData(t,r+1);return i.endRow===n?a.endRow!==n:a.endRow===n}},{key:"useFirstRowVBorder",value:function(e,t,r){var n=e.visual.getCellGridData(t,r);if(0!==n.startRow||n.endCol===e.getColumnCount())return!1;var i=e.visual.getCellGridData(t,r+1);return n.startRow===i.startRow&&n.endRow<=i.endRow}},{key:"useLastRowVBorder",value:function(e,t,r){var n=e.visual.getCellGridData(t,r);if(n.endRow!==e.getRowCount()||n.endCol===e.getColumnCount())return!1;var i=e.visual.getCellGridData(t,r+1);return t>=i.startRow&&i.endRow===e.getRowCount()}},{key:"topLineProp",value:function(t,r,n){if(!e.isValidRowCol(t,r,n))return null;var i=e.topLinePropInner(t,r,n);if(i)return i.defVal=!1,i;var a=t.visual.getStyle();if(a)return null;var o=t.visual.getCellGridData(r,n);return 0===o.startRow&&o.endRow===t.getRowCount()&&t.visual.useLastRow&&(i=e.lastRowTopProp(t,o))||t.visual.usebandRow&&(i=a.getBand1HTopProp())?(i.defVal=!0,i):a.getWholeTblHBProp(r,t.getRowCount())}},{key:"bottomLineProp",value:function(t,r,n){if(!e.isValidRowCol(t,r,n))return null;var i=t.visual.getCellGridData(r,n),a=e.bottomLinePropInner(t,r,n);if(a)return a.defVal=!1,a;var o=t.visual.getStyle();if(Object.isEmpty(o))return null;if(t.visual.useFirstRow&&0===i.startRow&&(a=e.firstRowBottomProp(t,i)))return a.defVal=!0,a;if(r+1!==t.getRowCount()){var s=t.visual.getCellGridData(r+1,n);if(s.endRow===t.getRowCount()&&t.visual.useLastRow&&(a=e.lastRowTopProp(t,s)))return a.defVal=!0,a}if(t.visual.useFirstCol&&e.useFirstColRBorder(t,r,n)&&(a=o.getFirstColRProp()))return a.defVal=!0,a;if(t.visual.useLastCol&&e.useLastColLBorder(t,r,n)&&(a=o.getLastColLProp()))return a.defVal=!0,a;if(i.endRow!==t.getRowCount()){if(i.endCol===t.getColumnCount()&&t.visual.useLastCol&&(a=o.getLastColHProp()))return a.defVal=!0,a;if(0===i.startCol&&t.visual.useFirstCol&&(a=o.getFirstColHProp()))return a.defVal=!0,a}return t.visual.usebandRow&&(a=e.bandRowBottomProp(t,r))?(a.defVal=!0,a):o.getWholeTblHBProp(r+1,t.getRowCount())}},{key:"leftLineProp",value:function(t,r,n){var i=e.leftLinePropInner(t,r,n);if(i)return i.defVal=!1,i;var a=t.visual.getStyle();return Object.isEmpty(a)?null:n+1===t.getColumnCount()&&t.visual.useLastCol&&(i=e.lastColLeftProp(t,r))||t.visual.usebandCol&&(i=a.getBand2VLeftProp())?(i.defVal=!0,i):a.getWholeTblVBProp(n,t.getColumnCount())}},{key:"rightLineProp",value:function(t,r,n){if(!e.isValidRowCol(t,r,n))return null;var i=e.rightLinePropInner(t,r,n);if(i)return i.defVal=!1,i;var a=t.visual.getStyle();if(Object.isEmpty(a))return null;if(t.visual.useFirstRow){if(e.useFirstRowVBorder(t,r,n)&&(i=a.getFirstRowVProp()))return i.defVal=!0,i;if(e.useFirstRowBBorder(t,r,n)&&(i=a.getFirstRowBProp()))return i.defVal=!0,i}if(t.visual.useLastRow){if(e.useLastRowVBorder(t,r,n)&&(i=a.getLastRowTProp()))return i.defVal=!0,i;if(e.useLastRowTBorder(t,r,n)&&(i=a.getLastRowTProp()))return i.defVal=!0,i}var o=t.visual.getCellGridData(r,n);if(t.visual.useFirstCol&&0===o.startCol&&(i=e.firstColRightProp(t,r)))return i.defVal=!0,i;if(n+1!==t.getColumnCount()){if(t.visual.getCellGridData(r,n+1).endCol===t.getColumnCount()&&t.visual.useLastCol&&(i=e.lastColLeftProp(t,r)))return i.defVal=!0,i;if(0===r&&t.visual.useFirstRow&&(i=a.getFirstRowVProp()))return i.defVal=!0,i;if(r+1===t.getRowCount()&&t.visual.useLastRow&&(i=a.getLastRowVProp()))return i.defVal=!0,i}return t.visual.usebandCol&&(i=e.bandColRightProp(t,n))?(i.defVal=!0,i):a.getWholeTblVBProp(n+1,t.getColumnCount())}},{key:"topLinePropInner",value:function(e,t,r){var n=e.visual.getCellGridData(t,r),i=e.getCell(n.startRow,n.startCol);if(n.startRow>0){var a=e.visual.getCellGridData(t-1,r);if(a.startCol>n.startCol){var o=e.getCell(a.startRow,a.startCol);if(o){var s=o.visual.getBorder(),l=s&&s.bottom;if(l)return l}}else if(i){var u=i.visual.getBorder(),c=u&&u.top;if(c)return c}}else if(i){var h=i.visual.getBorder(),d=h&&h.top;if(d)return d}return null}},{key:"bottomLinePropInner",value:function(e,t,r){var n=e.visual.getCellGridData(t,r),i=e.getCell(n.endRow-1,n.startCol);if(n.endRow!==e.getRowCount()){var a=e.visual.getCellGridData(t+1,r);if(a.startCol>n.startCol){var o=e.getCell(a.startRow,a.startCol).visual.getBorder(),s=o&&o.top;if(s)return s}else if(i){var l=e.getCell(n.endRow,n.startCol);if(l){var u=l.visual.getBorder(),c=u&&u.bottom;if(c)return c}var h=i.visual.getBorder(),d=h&&h.bottom;if(d)return d}}else if(i){var p=e.getCell(n.startRow,n.startCol);if(p){var f=p.visual.getBorder(),v=f&&f.bottom;if(v)return v}var y=i.visual.getBorder(),g=y&&y.bottom;if(g)return g}return null}},{key:"leftLinePropInner",value:function(e,t,r){var n=e.visual.getCellGridData(t,r),i=e.getCell(n.startRow,n.startCol);if(n.startCol>0){var a=e.visual.getCellGridData(t,r-1);if(n.startRow<a.startRow){var o=e.getCell(a.startRow,a.startCol);if(o){var s=o.visual.getBorder(),l=s&&s.right;if(l)return l}}else if(i){var u=i.visual.getBorder(),c=u&&u.left;if(c)return c}}var h=i.visual.getBorder();return h&&h.left}},{key:"rightLinePropInner",value:function(e,t,r){var n=e.visual.getCellGridData(t,r),i=e.getCell(n.startRow,n.endCol-1);if(n.endCol<e.getColumnCount()){var a=e.visual.getCellGridData(t,r+1);if(n.startRow<a.startRow){var o=e.getCell(a.startRow,a.startCol).visual.getBorder(),s=o&&o.right;if(s)return s}var l=e.getCell(n.startRow,n.endCol-1),u=e.getCell(n.startRow,n.startCol);if(u){var c=u.visual.getBorder(),h=c&&c.right;if(h)return h}var d=l.visual.getBorder(),p=d&&d.right;if(p)return p}var f=e.getCell(n.startRow,n.startCol);if(f){var v=f.visual.getBorder(),y=v&&v.right;if(y)return y}var g=i.visual.getBorder();return g&&g.right}},{key:"syncTextFont",value:function(e,t){}}]),e}(),_=r(1148),S=window.Emu2Ti,T=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"getShape",value:function(){return this.parent}},{key:"getFill",value:function(){return this._coredata.private.fill}},{key:"getStyle",value:function(){var e=this._coredata,t=e.private.style;if(t)return t;var r=e.tblStyleList;if(Object.isEmpty(r))return null;var n=this.getStyleId();return t=Object.isEmpty(n)?r[7]:r[n]}},{key:"updateStyle",value:function(e){}},{key:"clearStyle",value:function(){}},{key:"getWidth",value:function(){var e=this._coredata.private.vertborderpos;return e[e.length-1]}},{key:"getHeight",value:function(){var e=this._coredata.private.horiborderpos;return e[e.length-1]}},{key:"getRowHeight",value:function(e){var t=this._coredata;if(e<0||e>t.getRowCount())return-1;var r=this.getHoriBorderPosV();return r[e+1]-r[e]}},{key:"setHoriborderposV",value:function(e){this._coredata.setPropertyValue("horiborderpos",e)}},{key:"setVertBorderPosV",value:function(e){this._coredata.setPropertyValue("vertborderpos",e)}},{key:"getColWidth",value:function(e){var t=this._coredata;if(e<0||e>t.getColumnCount())return-1;var r=this.getVertBorderPosV();return r[e+1]-r[e]}},{key:"getEffects",value:function(){var e=this._coredata,t=e.private.style;return e.private.effects?e.private.effects:t&&t.private?t.private.effects:void 0}},{key:"getStyleId",value:function(){return this._coredata.private.styleId}},{key:"getLayer",value:function(){return this._coredata.private.layer}},{key:"syncLeftBorder",value:function(e,t,r){var n=this._coredata,i=m.leftLineProp(n,t,r);i&&i.defVal?delete i.defVal:i&&!i.defVal&&(delete i.defVal,e.visual.setBorderLineStyle(v.TblBorderType.Left,i))}},{key:"syncRightBorder",value:function(e,t,r){var n=this._coredata,i=m.rightLineProp(n,t,r);i&&i.defVal?delete i.defVal:i&&!i.defVal&&(delete i.defVal,e.visual.setBorderLineStyle(v.TblBorderType.Right,i))}},{key:"syncTopBorder",value:function(e,t,r){var n=this._coredata,i=m.topLineProp(n,t,r);i&&i.defVal?delete i.defVal:i&&!i.defVal&&(delete i.defVal,e.visual.setBorderLineStyle(v.TblBorderType.Top,i))}},{key:"syncBottomBorder",value:function(e,t,r){var n=this._coredata,i=m.bottomLineProp(n,t,r);i&&i.defVal?delete i.defVal:i&&!i.defVal&&(delete i.defVal,e.visual.setBorderLineStyle(v.TblBorderType.Bottom,i))}},{key:"interpretedStyle",value:function(){for(var e=this._coredata,t=e.parent;t&&!t.isShape;)t=t.parent;if(t){var r=t.colorScheme,n=e.private.style;return n&&n.interpret(r)}}},{key:"getHoriBorderPos",value:function(e){var t=this.getHoriBorderPosV();if(!(e<0||e>t.length))return t[e]}},{key:"setHoriBorderPos",value:function(e,t){var r=this.getHoriBorderPosV();if(!(e<0||e>r.length)){var n=t-r[e],i=Object(f.a)(r);if(0===e){i[0]+=n,n=i[0];for(var a=0;a<i.length;++a)i[a]-=n}else for(var o=0;o<i.length;++o)i[o]+=n;this._coredata.setPropertyValue("horiborderpos",i)}}},{key:"getVertBorderPos",value:function(e){var t=this.getVertBorderPosV();if(!(e<0||e>t.length))return t[e]}},{key:"setVertBorderPos",value:function(e,t){var r=this.getVertBorderPosV();if(!(e<0||e>r.length)){for(var n=Object(f.a)(r),i=t-n[e],a=0;a<n.length;++a)n[a]=n[a]+i;if(0===e)for(var o=0;o<n.length;++o)n[o]=n[o]-t;this.setVertBorderPosV(n)}}},{key:"modifyVertBorderPos",value:function(e,t){var r=this._coredata,n=this.getVertBorderPosV();if(e<=0||e>=n.length)return!1;r.getColumnCount();var i=0;return i=0===e?n[1]-t:t-n[e-1],e--,i=Object(y.n)(i,0),_.b.setColWidth(r,e,i),!0}},{key:"modifyHoriBorderPos",value:function(e,t){var r=this._coredata,n=this.getHoriBorderPosV();if(e<=0||e>=n.length)return!1;var i=0;return i=0===e?n[1]-t:(r.getRowCount(),t-n[e-1]),e--,i=Object(y.n)(i,0),_.b.setRowHeight(r,e,i),!0}},{key:"getVertBorderPosV",value:function(){return this._coredata.private.vertborderpos}},{key:"getHoriBorderPosV",value:function(){var e=this._coredata.private.horiborderpos||[],t=e.length;if(!(e[t-1]-e[0]))for(var r=0;r<t;r++)e[r]=116840*r;return e}},{key:"getHoriBorderPosVisualV",value:function(){return this._coredata.private.horiborderposVisual}},{key:"getVertBorderPosVisualV",value:function(){return this._coredata.private.vertborderposVisual}},{key:"getCellGridDataByIdx",value:function(e){for(var t=this._coredata,r=t.getRowCount(),n=t.getColumnCount(),i=0;i<r;++i)for(var a=0;a<n;++a){var o=t.getCell(i,a);if(o&&o.getIdx()===e)return this.getCellGridData(i,a)}}},{key:"getCellGridDataByCell",value:function(e){for(var t=this._coredata,r=t.getChilds().length,n=t.getColumnCount(),i=0;i<r;++i)if(t.getChildAt(i)===e){var a=Math.floor(i/n),o=i%n;return this.getCellGridData(a,o)}}},{key:"getCellGridData",value:function(e,t){var r=this._coredata,n={},i=r.getCell(e,t);if(n.index=i?i.getIdx():-1,-1===n.index)return null;var a=r.topLeftPair(e,t);n.startRow=a.row,n.startCol=a.col;var o=r.rightBottomPair(e,t);return n.endRow=++o.row,n.endCol=++o.col,n.upCell=n.startRow?r.getCellIdx(n.startRow-1,n.startRow):-1,n.downCell=n.endRow===r.getRowCount()?-1:r.getCellIdx(n.endRow,n.startRow),n.leftCell=n.endCol?r.getCellIdx(n.startRow,n.startCol-1):-1,n.rightCell=n.endCol===r.getColumnCount()?-1:r.getCellIdx(n.startRow,n.endCol),n.x=this.getVertBorderPos(n.startCol),n.y=this.getHoriBorderPos(n.startRow),n.width=this.getVertBorderPos(n.endCol)-this.getVertBorderPos(n.startCol),n.height=this.getHoriBorderPos(n.endRow)-this.getHoriBorderPos(n.startRow),n.cell=i,n}},{key:"getCellRect",value:function(e,t){var r=this.private,n=r.horiborderpos,i=r.vertborderpos;return{x:S(i[t]),y:S(n[e]),width:S(i[t+1]-i[t]),height:S(n[e+1]-n[e])}}},{key:"getTopBorderStyle",value:function(e,t){}},{key:"setTopBoderStyle",value:function(e,t,r){var n=this._coredata;n.getCell(e,t).visual.setBorderLineStyle(v.TblBorderType.Top,r);var i=this.getCellGridData(e,t);i.startCol===t&&e!==i.startRow&&n.getCell(i.startRow,i.startCol).visual.setBorderLineStyle(v.TblBorderType.Top,r)}},{key:"setLeftBorderStyle",value:function(e,t,r){var n=this._coredata;n.getCell(e,t).visual.setBorderLineStyle(v.TblBorderType.Left,r);var i=this.getCellGridData(e,t);i.startRow===e&&i.startCol!==t&&n.getCell(i.startRow,i.startCol).visual.setBorderLineStyle(v.TblBorderType.Left,r)}},{key:"setBottomBorderStyle",value:function(e,t,r){var n=this._coredata;n.getCell(e,t).visual.setBorderLineStyle(v.TblBorderType.Bottom,r);var i=this.getCellGridData(e,t);i.startCol===t&&e!==i.startRow&&n.getCell(i.startRow,i.startCol).visual.setBorderLineStyle(v.TblBorderType.Bottom,r)}},{key:"setRightBorderStyle",value:function(e,t,r){var n=this._coredata;n.getCell(e,t).visual.setBorderLineStyle(v.TblBorderType.Right,r);var i=this.getCellGridData(e,t);i.startRow===e&&t!==i.startCol&&n.getCell(i.startRow,i.startCol).visual.setBorderLineStyle(v.TblBorderType.Right,r)}},{key:"isValidRange",value:function(e){var t=this._coredata;return e.endCol-e.startCol>=1&&e.endRow-e.startRow>=1&&e.startCol<t.getColumnCount()&&e.endCol<=t.getColumnCount()&&e.startRow<t.getRowCount()&&e.endRow<=t.getRowCount()}},{key:"modifySize",value:function(e,t){for(var r=this._coredata,n=r.private.vertborderpos,i=r.private.horiborderpos,a=Object(f.a)(n),o=Object(f.a)(i),s=0;s<a.length;s++)a[s]=a[s]*e;for(var l=0;l<o.length;l++)o[l]=o[l]*t;for(var u=r.private.vertborderposVisual,c=r.private.horiborderposVisual,h=Object(f.a)(u),d=Object(f.a)(c),p=0;p<h.length;p++)h[p]=h[p]*e;for(var v=0;v<d.length;v++)d[v]=d[v]*t;return r.setPropertyValue("vertborderpos",a),r.setPropertyValue("horiborderpos",o),r.setPropertyValue("vertborderposVisual",h),r.setPropertyValue("horiborderposVisual",d),{}}},{key:"adjustWidth",value:function(e,t){for(var r=t/e.last(),n=1;n<e.length;++n)e[n]=e[n]*r;for(var i=e[0],a=0,o=1;o<e.length;++o){var s=e[o]-i;a+=Object(y.n)(0,208280-s),i=e[o],e[o]=e[o]+a}}},{key:"setFill",value:function(e){var t=null;return this._coredata.getChilds().forEach((function(r){t=r.visual.setFill(e)})),t}},{key:"autoFit",value:function(){var e=this._coredata.parent;if(e){var t=new window.Rect(0,0,S(this.getWidth()),S(this.getHeight())),r=e.visual.getAnchorRect();if(Object(y.h)(t.width()-r.width())>1||Object(y.h)(t.height()-r.height())>1){r.setWidth(t.width()),r.setHeight(t.height());var n=g.a.create(t).getRect(),i=e.getTransform2D(),a=void 0;if(e.isChildShape()){var o=e.visual.layerRectToCurrentRect(n),s=e.visual.getParent().calcChildPosData(o,e.visual.getRotation());a=Object.assign({},i,s)}else a=Object.assign({},i,{x:i.x,y:i.y,width:635*n.width,height:635*n.height});e.setTransform2D(a)}}}},{key:"usebandRow",get:function(){return!0===this._coredata.private.usebandrow}},{key:"usebandCol",get:function(){return!0===this._coredata.private.usebandcol}},{key:"useFirstRow",get:function(){return!0===this._coredata.private.usefirstrow}},{key:"useFirstCol",get:function(){return!0===this._coredata.private.usefirstcol}},{key:"useLastRow",get:function(){return!0===this._coredata.private.uselastrow}},{key:"useLastCol",get:function(){return!0===this._coredata.private.uselastcol}},{key:"useneCell",get:function(){return!0===this._coredata.private.usenecell}},{key:"useseCell",get:function(){return!0===this._coredata.private.usesecell}},{key:"useswCell",get:function(){return!0===this._coredata.private.useswcell}},{key:"usewwCell",get:function(){return!0===this._coredata.private.usewwcell}}]),t}(p.a);var b=r(927),k=r(262),C=r(446),w=r(158),P=r(2663),x=r(315),O=window.Emu2Ti,E=window.Px2Emu,I=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r.data_token=Object(x.a)(),r.tree_token=r.data_token,r.listDelegate=new A(r),r._visual=new T(r),Object(h.a)(r),r}return c()(t,e),o()(t,[{key:"getPresentation",value:function(){if(this.pres)return this.pres;var e=this.parent.getSlide(),t=e&&e.getPresentation();return this.pres=t,this.pres}},{key:"matchText",value:function(e){if(!e)return null;var t=this.getChilds();if(!t)return null;for(var r=[],n=0;n<t.length;++n){var i=this.getChildAt(n);if(i.matchText){var a=i.matchText(e);a&&(r=r.concat(a))}}return r}},{key:"getProperty",value:function(){return this.private}},{key:"buildTree",value:function(e){this.parent=e;var t=this.private.childs;if(t)for(var r=0,n=t.length;r<n;++r){var i=t[r];i&&i.buildTree&&i.buildTree(this)}}},{key:"initData",value:function(e,t,r,n){this.private.horiborderpos||(this.private.horiborderpos=[]),this.private.vertborderpos||(this.private.vertborderpos=[]);for(var i=0;i<t;++i)for(var a=0;a<r;++a){var o=new P.a({id:e.allocateLocalId(),data:{childs:[]}});o.initData(e,this.increaseIndex(),!0),this.push(o)}this.private.usebandrow=!1,this.private.usebandcol=!1,this.private.usefirstrow=!1,this.private.usefirstcol=!1,this.private.usesecell=!1,this.private.useswcell=!1,this.private.usewwcell=!1,n&&(this.private.usefirstrow=!0,this.private.usebandrow=!0,this.private.style=n);for(var s={width:12700,dashType:0,compoundLine:0,fill:{color:{isAutoColor:!1,sRgb:0,toRGB:"#ff000000",type:0,transOp:[{op:0,val:1}]},type:2}},l=0;l<t;++l)for(var u=0;u<r;++u){var c=this.getCell(l,u);c.visual.setBorderLineStyle(w.TblBorderType.Left,s),c.visual.setBorderLineStyle(w.TblBorderType.Top,s),c.visual.setBorderLineStyle(w.TblBorderType.Right,s),c.visual.setBorderLineStyle(w.TblBorderType.Bottom,s)}this.border=s}},{key:"increaseIndex",value:function(){return this.private.curIndex++}},{key:"_fireChanged",value:function(e){if(this._fireChangeData){var t=this._fireChangeData,r=t.type,n=t.param;this._fireChangeData=null;var i=[n.value];n.value instanceof Array&&(i=n.value),this._bubbleUpEvent(k.default.modify_table_frame,{data:this,op:r,vals:i})}else this._bubbleUpEvent(k.default.modify_table_frame,Object.assign({},e||{},{data:this}))}},{key:"_bubbleUpEvent",value:function(e,t){k.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(x.a)():this.tree_token=Object(x.a)());var r=this.parent;t.parent=r,r&&r._bubbleUpEvent&&r._bubbleUpEvent(e,t)}},{key:"getChilds",value:function(){return this.private.childs||[]}},{key:"getChildIdx",value:function(e){var t=this.private.childs;if(!t)return-1;for(var r=0,n=t.length;r<n;++r)if(e===t[r])return r;return-1}},{key:"getCellRange",value:function(e){var t=this.getChildIdx(e),r=this.getColumnCount(),n=Math.floor(t/r),i=Math.floor(t%r);return{startRow:n,startCol:i,endRow:n+1,endCol:i+1}}},{key:"getChildAt",value:function(e){var t=this.private.childs.length;return e>=0&&e<t?this.private.childs[e]:null}},{key:"getTextFrame",value:function(e,t){var r=this.getRowCount(),n=this.getColumnCount();if(e<0||e>=r||t<0||t>=n)return null;var i=this.getCell(e*n,t);return i&&i.getTextFrame()}},{key:"getCell",value:function(e,t){if(e<0||t<0)return null;var r=this.getChilds(),n=this.getColumnCount();return e*n+t>=r.length?null:this.getChildAt(e*n+t)}},{key:"getCellIdx",value:function(e,t){var r=this.getCell(e,t);return r?r.getIdx():-1}},{key:"collectCellsIdx",value:function(e){for(var t=this.getRowCount(),r=this.getColumnCount(),n=[],i=e.startRow;i<e.endRow&&i<t;++i)for(var a=e.startCol;a<e.endCol&&a<r;++a){var o=this.getCell(i,a).getIdx();n.includes(o)||n.push(o)}return n}},{key:"getCells",value:function(e,t,r,n){for(var i=[],a=e;a<r;++a)for(var o=t;o<n;++o){var s=this.getCell(a,o);s&&s.getTextFrame()&&i.push(s)}return i}},{key:"getRowCount",value:function(){return this.private.horiborderpos.length-1}},{key:"getVertBorderPos",value:function(){return this.private.vertborderpos}},{key:"getHoriBorderPos",value:function(){return this.private.horiborderpos}},{key:"getColumnCount",value:function(){var e=this.private.vertborderpos,t=this.private.getvertborderpos;return(e=e||t).length-1}},{key:"getRect",value:function(e,t){var r=this.private,n=r.horiborderpos,i=r.vertborderpos,a=r.getvertborderpos;return{x:O((i=i||a)[t]),y:O(n[e]),width:O(i[t+1]-i[t]),height:O(n[e+1]-n[e])}}},{key:"getPosition",value:function(){return{x:0,y:0}}},{key:"topLeftPair",value:function(e,t){var r={row:e,col:t},n=this.getCellIdx(e,t);if(-1===n)return r;for(var i=t;i>=0;--i){if(this.getCell(e,i).getIdx()!==n)break;r.col=i}for(var a=e;a>=0;--a){if(this.getCell(a,t).getIdx()!==n)break;r.row=a}return r}},{key:"rightBottomPair",value:function(e,t){var r={row:e,col:t},n=this.getRowCount(),i=this.getColumnCount(),a=this.getCellIdx(e,t);if(-1===a)return r;for(var o=t;o<i&&this.getCellIdx(e,o)===a;++o)r.col=o;for(var s=e;s<n&&this.getCellIdx(s,t)===a;++s)r.row=s;return r}},{key:"collectLBorders",value:function(e){var t=[];if(0===e.startCol){for(var r={direction:"left",cell:this.getCell(e.startRow,e.startCol)},n=e.startRow;n<e.endRow;++n)t.push(r);return t}for(var i={direction:"left",cell:this.getCell(e.startRow,e.startCol)},a=e.startRow;a<e.endRow;++a){var o=this.visual.getCellGridData(a,e.endCol-1);if(e.startRow<=o.startRow){var s={direction:"right",cell:this.getCell(o.startRow,o.endCol-1)};t.push(s)}else t.push(i)}return t}},{key:"collectRBorders",value:function(e){var t=[];if(e.endCol===this.getColumnCount()){for(var r={direction:"right",cell:this.getCell(e.startRow,e.startCol-1)},n=e.startRow;n<e.endRow;++n)t.push(r);return t}for(var i={direction:"right",cell:this.getCell(e.startRow,e.startCol)},a=e.startRow;a<e.endRow;++a){var o=this.visual.getCellGridData(a,e.endCol);if(e.startRow<=o.startRow){var s={direction:"left",cell:this.getCell(o.startRow,o.startCol)};t.push(s)}else t.push(i)}return t}},{key:"collectTBorders",value:function(e){var t=[];if(0===e.startRow){for(var r={direction:"top",cell:this.getCell(e.startRow,e.startCol)},n=e.startCol;n<e.endCol;++n)t.push(r);return t}for(var i={direction:"top",cell:this.getCell(e.startRow,e.startCol)},a=e.startCol;a<e.endCol;++a){var o=this.visual.getCellGridData(e.startRow-1,a);if(e.startCol<=o.startCol){var s={direction:"bottom",cell:this.getCell(o.endRow-1,o.startCol)};t.push(s)}else t.push(i)}return t}},{key:"collectBBorders",value:function(e){var t=[];if(e.endCol===this.getColumnCount()){for(var r={direction:"bottom",cell:this.getCell(e.endRow-1,e.startCol)},n=e.startCol;n<e.endCol;++n)t.push(r);return t}for(var i={direction:"bottom,",cell:this.getCell(e.endRow-1,e.startCol)},a=e.startCol;a<e.endCol;++a){var o=this.visual.getCellGridData(e.endRow,a);if(e.startCol<=o.startCol){var s={direction:"top",cell:this.getCell(o.startRow,o.startCol)};t.push(s)}else t.push(i)}return t}},{key:"syncBorder",value:function(e,t,r){var n=t.cell,i=t.direction;switch(r){case"left":if("left"===i){var a=n.visual.getBorderProp("left");a?e.visual.setBorderProp("left",a):e.visual.setBorderProp("left",null)}else if("right"===i){var o=n.visual.getBorderProp("right");o?e.visual.setBorderProp("right",o):e.visual.setBorderProp("right",null)}break;case"right":if("left"===i){var s=n.visual.getBorderProp("left");s?e.visual.setBorderProp("left",s):e.visual.setBorderProp("left",null)}else if("right"===i){var l=n.visual.getBorderProp("right");l?e.visual.setBorderProp("right",l):e.visual.setBorderProp("right",null)}break;case"top":if("top"===i){var u=n.visual.getBorderProp("top");u?e.visual.setBorderProp("top",u):e.visual.setBorderProp("top",null)}else if("bottom"===i){var c=n.visual.getBorderProp("top");c?e.visual.setBorderProp("top",c):e.visual.setBorderProp("top",null)}break;case"bottom":if("top"===i){var h=n.visual.getBorderProp("top");h?e.visual.setBorderProp("top",h):e.visual.setBorderProp("top",null)}else if("bottom"===i){var d=n.visual.getBorderProp("bottom");d?e.visual.setBorderProp("bottom",d):e.visual.setBorderProp("bottom",null)}}}},{key:"distributeRows",value:function(e,t,r){for(var n=Object(f.a)(this.visual.getHoriBorderPosV()),i=t-e,a=(r[t]-r[e])/i,o=n[e]+a*i-n[t],s=1;s<=i;++s)n[e+s]=n[e]+a*s;for(var l=t+1;l<r.length;++l)n[l]+=o;for(var u=!0,c=r[e+1]-r[e],h=e+1;h<t;++h){var d=r[h+1]-r[h];u&&d===c||(u=!1,c=Object(y.n)(c,d))}for(var p=e;p<t;++p)for(var v=c-(n[p+1]-n[p]),g=p+1;g<=t;++g)n[g]+=v;return this.setPropertyValue("horiborderpos",n),{avgHeight:a,maxHeight:c}}},{key:"distributeCols",value:function(e,t){for(var r=Object(f.a)(this.visual.getVertBorderPosV()),n=t-e,i=(r[t]-r[e])/n,a=r[e]+i*n-r[t],o=1;o<=n;++o)r[e+o]=r[e]+i*o;for(var s=t+1;s<r.length;++s)r[s]+=a;return this.setPropertyValue("vertborderpos",r),!0}},{key:"insertRowAbove",value:function(e){return this.listDelegate.insertRowAbove(e)}},{key:"insertRowAboveByRow",value:function(e,t){return this.listDelegate.insertRowAboveInner(e,t)}},{key:"insertRowBellow",value:function(e){return this.listDelegate.insertRowBellow(e)}},{key:"insertRowBellowByRow",value:function(e,t){return this.listDelegate.insertRowBellowInner(e,t)}},{key:"insertColLeft",value:function(e){return this.listDelegate.insertColLeft(e)}},{key:"insertColLeftByCol",value:function(e,t){return this.listDelegate.insertColLeftInner(e,t)}},{key:"insertColRight",value:function(e){return this.listDelegate.insertColRight(e)}},{key:"insertColRightByCol",value:function(e,t){return this.listDelegate.insertColRightInner(e,t)}},{key:"removeRows",value:function(e){return this.listDelegate.removeRows(e)}},{key:"removeRow",value:function(e,t){return this.listDelegate.removeRowInner(e,t)}},{key:"removeCols",value:function(e){return this.listDelegate.removeCols(e)}},{key:"removeCol",value:function(e,t){return this.listDelegate.removeColInner(e,t)}},{key:"mergeCells",value:function(e){return this.listDelegate.mergeCells(e)}},{key:"unMergeCells",value:function(e){return this.listDelegate.unMergeCells(e)}},{key:"isTableFrame",get:function(){return!0}},{key:"visual",get:function(){return this._visual}}]),t}(d.a),A=(t.a=I,function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.table=e,r.listener.on(C.b.INSERT,(function(e){return r._onDataChanged(k.default.op_add,e)})),r.listener.on(C.b.MODIFY,(function(e){return r._onDataChanged(k.default.op_modify,e)})),r.listener.on(C.b.REMOVE,(function(e){return r._onDataChanged(k.default.op_remove,e)})),r.listener.on(C.b.MOVE,(function(e){return r._onDataChanged(k.default.op_move,e)})),r.listener.on(C.b.RESET,(function(e){return r._onDataChanged(k.default.op_replace,e)})),r}return c()(t,e),o()(t,[{key:"_onDataChanged",value:function(e,t){var r=[];e===k.default.op_add||e===k.default.op_modify?r=[t.value]:e===k.default.op_replace&&(r=t.value);for(var n=this.table,i=0;i<r.length;i++){var a=r[i];a.buildTree?a.buildTree(n):a.parent=n}this.table._fireChangeData={type:e,param:t}}},{key:"_fireChanged",value:function(e){this.table._fireChanged(e)}},{key:"removeCell",value:function(e,t,r){var n=t*e.getColumnCount()+r;this.remove(n)}},{key:"removeRowInner",value:function(e,t){for(var r=this.table,n=r.getColumnCount(),i=e+t-1;i>=e;--i)for(var a=n-1;a>=0;--a)this.removeCell(r,i,a)}},{key:"removeColInner",value:function(e,t){for(var r=this.table,n=r.getRowCount()-1;n>=0;--n)for(var i=e+t-1;i>=e;--i)this.removeCell(r,n,i)}},{key:"insertRowAbove",value:function(e){var t=this.table,r=t.getPresentation(),n=e.endRow-e.startRow;if(n<=0)return!1;var i=t.visual.getHoriBorderPosV(),a=Object(f.a)(i),o=a[e.startRow+1]-a[e.startRow];this.insertRowAboveInner(e.startRow,n);for(var s=0;s<n;++s)a.push(a[a.length-1]);for(var l=a.length-1;l>=e.startRow+n;--l)a[l]=a[l-n]+o*n;for(var u=1,c=e.startRow;u<n;++u,++c)a[c+1]=a[c]+o;t.setPropertyValue("horiborderpos",a);for(var h=t.getColumnCount(),d=e.startRow;d<e.endRow;++d){var p=0,v=-1,y=t.getCellIdx(e.startRow-1,p),g=t.getCellIdx(e.endRow,p);if(0!==e.startRow&&y===g)v=g,t.getCell(d,p).setPropertyValue("idx",v),++p;for(;p<h;++p){var _=t.getCell(d,p),S=t.getCell(e.startRow-1,p),T=t.getCell(e.endRow,p);y=S&&S.getIdx(),g=T&&T.getIdx();var k=T&&T.visual.getFill();if(0===e.startRow||y!==g){if(v!==g){v=g,_.setPropertyValue("idx",t.increaseIndex());var C=b.a.createNewTextFrame(r);_.addTextFrame(C),m.syncTextFont(C,T.getTextFrame()),k&&_.visual.setFill(k)}else{var w=t.getCell(d,p-1);_.setPropertyValue("idx",w.getIdx())}_.cloneProp(T),t.visual.syncRightBorder(_,e.endRow,p),t.visual.syncBottomBorder(_,e.endRow,p),k&&_.visual.setFill(k)}else v=g,_.setPropertyValue("idx",v),_.cloneProp(T),t.visual.syncRightBorder(_,e.endRow,p),t.visual.syncBottomBorder(_,e.endRow,p)}}return!0}},{key:"insertRowAboveInner",value:function(e,t){for(var r=this.table,n=r.getPresentation(),i=r.getColumnCount(),a=0;a<t;++a)for(var o=i;o>=1;--o){var s=new P.a({id:n.allocateLocalId(),data:{childs:[],idx:-1}});this.insert(e*i,s)}}},{key:"insertRowBellowInner",value:function(e,t){this.insertRowAboveInner(e,t)}},{key:"insertRowBellow",value:function(e){var t=this.table,r=e.endRow-e.startRow;if(r<=0)return!1;var n=t.visual.getHoriBorderPosV(),i=Object(f.a)(n);this.insertRowBellowInner(e.endRow,r);for(var a=n.length-1,o=n[e.endRow]-n[e.endRow-1],s=0;s<r;++s)i.push(i.last());for(var l=i.length-1;l>=e.endRow+r;--l)i[l]=i[l-r]+o*r;for(var u=1,c=e.endRow;u<r;++u,++c)i[c+1]=i[c]+o;t.setPropertyValue("horiborderpos",i);for(var h=e.endRow;h<e.endRow+r;++h){var d=0,p=-1,v=t.getCellIdx(e.endRow-1,d),y=t.getCellIdx(e.endRow+r,d);if(e.endRow!==a&&v===y)p=v,t.getCell(h,d).setPropertyValue("idx",p),++d;for(;d<t.getColumnCount();++d){var g=t.getCell(h,d),_=t.getCell(e.endRow-1,d),S=t.getCell(e.endRow+r,d);if(v=_&&_.getIdx(),y=S&&S.getIdx(),e.endRow===a||v!==y){if(p!==v){g.setPropertyValue("idx",t.increaseIndex());var T=t.getPresentation(),k=b.a.createNewTextFrame(T);g.addTextFrame(k),p=v;var C=t.visual.getCellGridData(e.endRow-1,d),w=t.getCell(C.startRow,C.startCol);m.syncTextFont(k,w.getTextFrame());var P=w.visual.getFill();P&&g.setPropertyValue("fill",P)}else{t.getCell(h,d).setPropertyValue("idx",t.getCell(h,d-1).getIdx())}g.cloneProp(_),t.visual.syncRightBorder(g,e.endRow-1,d),t.visual.syncBottomBorder(g,e.endRow-1,d);var x=t.visual.getCellGridData(e.endRow-1,d),O=t.getCell(x.startRow,x.startCol).visual.getFill();O&&g.setPropertyValue("fill",O)}else p=v,g.setPropertyValue("idx",p),g.cloneProp(_),t.visual.syncRightBorder(g,e.endRow-1,d),t.visual.syncBottomBorder(g,e.endRow-1,d)}}return!0}},{key:"insertColLeft",value:function(e){var t=this.table,r=e.endCol-e.startCol;if(r<=0)return!1;var n=t.visual.getVertBorderPosV(),i=Object(f.a)(n);this.insertColLeftInner(e.startCol,r);for(var a=n.last(),o=n[e.startCol+1]-n[e.startCol],s=0;s<r;++s)i.push(i.last());for(var l=i.length-1;l>=e.startCol+r;--l)i[l]=i[l-r]+o*r;for(var u=1,c=e.startCol;u<r;++u,++c)i[c+1]=i[c]+o;t.visual.adjustWidth(i,a),t.setPropertyValue("vertborderpos",i);for(var h=e.startCol;h<e.startCol+r;++h){var d=0,p=-1,v=t.getCellIdx(d,e.startCol-1),y=t.getCellIdx(d,e.endCol);if(0!==e.startCol&&v===y)p=y,t.getCell(d,h).setPropertyValue("idx",p),++d;for(;d<t.getRowCount();++d){var g=t.getCell(d,h),_=t.getCell(d,e.startCol-1),S=t.getCell(d,e.endCol);if(v=_&&_.getIdx(),y=S&&S.getIdx(),0===e.startCol||v!==y){if(p!==y){p=y,g.setPropertyValue("idx",t.increaseIndex());var T=t.getPresentation(),k=b.a.createNewTextFrame(T);g.addTextFrame(k),m.syncTextFont(k,S.getTextFrame())}else g.setPropertyValue("idx",t.getCell(d-1,h).getIdx());g.cloneProp(S),t.visual.syncRightBorder(g,d,e.endCol),t.visual.syncBottomBorder(g,d,e.endCol);var C=S.visual.getFill();C&&g.setPropertyValue("fill",C)}else p=y,g.setPropertyValue("idx",p),g.cloneProp(S),t.visual.syncRightBorder(g,d,e.endCol),t.visual.syncBottomBorder(g,d,e.endCol)}}return!0}},{key:"insertColRight",value:function(e){var t=this.table,r=e.endCol-e.startCol;if(r<=0)return!1;var n=t.visual.getVertBorderPosV(),i=Object(f.a)(n);this.insertColRightInner(e.endCol,r);for(var a=n.length-1,o=n.last(),s=n[e.endCol]-n[e.endCol-1],l=0;l<r;++l)i.push(i.last());for(var u=i.length-1;u>=e.endCol+r;--u)i[u]=i[u-r]+s*r;for(var c=1,h=e.endCol;c<r;++c,++h)i[h+1]=i[h]+s;t.visual.adjustWidth(i,o),t.setPropertyValue("vertborderpos",i);for(var d=e.endCol;d<e.endCol+r;++d){var p=0,v=-1,y=t.getCellIdx(p,e.endCol-1),g=t.getCellIdx(p,e.endCol+r);if(e.endCol!==a&&y===g)v=y,t.getCell(p,d).setPropertyValue("idx",v),++p;for(;p<t.getRowCount();++p){var _=t.getCell(p,d),S=t.getCell(p,e.endCol-1),T=t.getCell(p,e.endCol+r);if(y=S&&S.getIdx(),g=T&&T.getIdx(),e.endCol===a||y!==g){var k=t.visual.getCellGridData(p,e.endCol-1),C=t.getCell(k.startRow,k.startCol);if(v!==y){v=y,_.setPropertyValue("idx",t.increaseIndex());var w=t.getPresentation(),P=b.a.createNewTextFrame(w);_.addTextFrame(P);var x=C.getTextFrame();m.syncTextFont(P,x)}else _.setPropertyValue("idx",t.getCell(p-1,d).getIdx());_.cloneProp(S),t.visual.syncRightBorder(_,p,e.endCol-1),t.visual.syncBottomBorder(_,p,e.endCol-1);var O=C.visual.getFill();O&&_.setPropertyValue("fill",O)}else v=y,_.setPropertyValue("idx",v),_.cloneProp(S),t.visual.syncRightBorder(_,p,e.endCol-1),t.visual.syncBottomBorder(_,p,e.endCol-1)}}return!0}},{key:"insertColLeftInner",value:function(e,t){for(var r=this.table,n=r.getPresentation(),i=r.getColumnCount(),a=r.getRowCount()-1;a>=0;--a)for(var o=0;o<t;++o){var s=new P.a({id:n.allocateLocalId(),data:{childs:[]}});this.insert(a*i+e,s)}}},{key:"insertColRightInner",value:function(e,t){this.insertColLeftInner(e,t)}},{key:"removeRows",value:function(e){var t=this.table,r=e.startRow,n=e.endRow,i=n-r;if(i<=0)return!1;for(var a=t.getColumnCount(),o=t.collectCellsIdx(e),s=0;s<o.length;++s){var l=t.visual.getCellGridDataByIdx(o[s]);if(l.startRow>=r&&l.endRow>n){var u=t.getCell(l.startRow,l.startCol),c=u.getTextFrame();u.removeTextFrame();var h=t.getCell(n,l.startCol);h.addTextFrame(c),h.cloneProp(u);var d=u.visual.getBorderProp("left");if(0===l.startCol&&d&&h.visual.setBorderProp("left",d),l.endCol===a){var p=m.rightLineProp(t,l.startRow,a-1);t.getCell(n,a-1).visual.setBorderProp("right",p)}}}this.removeRowInner(r,i);for(var v=Object(f.a)(t.visual.getHoriBorderPosV()),y=v[n]-v[r],g=n;g<v.length;++g)v[g-i]=v[g]-y;for(var _=0;_<i;++_)v.pop();return t.setPropertyValue("horiborderpos",v),!0}},{key:"removeCols",value:function(e){var t=this.table,r=e.startCol,n=e.endCol,i=n-r;if(i<=0)return!1;for(var a=t.getRowCount(),o=t.collectCellsIdx(e),s=0;s<o.length;++s){var l=t.visual.getCellGridDataByIdx(o[s]);if(l.startCol>=r&&l.endCol>n){var u=t.getCell(l.startRow,l.startCol),c=u.getTextFrame();u.removeTextFrame();var h=t.getCell(l.startRow,l.startCol);h.addTextFrame(c),h.cloneProp(u);var d=u.visual.getBorderProp("top");if(0===l.startRow&&d&&h.visual.setBorderProp("top",d),l.endRow===a){var p=m.bottomLineProp(t,a-1);t.getCell(a-1,n).visual.setBorderProp("bottom",p)}}}this.removeColInner(r,i);for(var v=Object(f.a)(t.visual.getVertBorderPosV()),y=v[n]-v[r],g=n;g<v.length;++g)v[g-i]=v[g]-y;for(var _=0;_<i;++_)v.pop();return t.setPropertyValue("vertborderpos",v),!0}},{key:"mergeCells",value:function(e){var t=this.table;if(e.startRow>=e.endRow||e.startCol>=e.endCol)return!1;for(var r=t.getCellIdx(e.startRow,e.startCol),n=[],i=e.startRow;i<e.endRow;++i)for(var a=e.startCol;a<e.endCol;++a){var o=t.getCellIdx(i,a),s=n.includes(o);o===r||s||n.push(o)}var l=t.visual.getCellGridData(e.startRow,e.startCol),u=t.visual.getCellGridData(e.startRow,e.endCol-1),c=t.visual.getCellGridData(e.endRow-1,e.startCol),h=t.visual.getCellGridData(e.endRow-1,e.endCol-1);if(Object(y.n)(c.endRow,h.endRow)-Object(y.o)(l.startRow,u.startRow)>1){var d=t.getCell(l.startRow,l.startCol),p=Object(y.n)(c.endRow,h.endRow)-1,f=Object(y.o)(l.startCol,h.startCol),v=t.visual.getCellGridData(p,f),g=t.getCell(v.startRow,v.startCol).visual.getBorderProp(w.TblBorderType.Bottom);g?d.visual.setBorderProp(w.TblBorderType.Bottom,g):d.visual.setBorderProp(w.TblBorderType.Bottom,null)}if(Object(y.n)(u.endCol,h.endCol)-Object(y.o)(l.startCol,c.startCol)>1){var m=t.getCell(l.startRow,l.startCol),_=Object(y.o)(l.startRow,u.startRow),S=Object(y.n)(u.endCol,h.endCol)-1,T=t.visual.getCellGridData(_,S),b=t.getCell(T.startRow,T.startCol).visual.getBorderProp(w.TblBorderType.Right);b?m.visual.setBorderProp(w.TblBorderType.Right,b):m.visual.setBorderProp(w.TblBorderType.Right,null)}for(var k=0;k<n.length;++k)for(var C=t.visual.getCellGridDataByIdx(n[k]),P=C.startRow;P<C.endRow;++P)for(var x=C.startCol;x<C.endCol;++x){var O=t.getCell(P,x);O.removeTextFrame(),O.setPropertyValue("idx",r)}for(var E=l.startRow;E<l.endRow;++E)for(var I=l.startCol;I<l.endCol;++I){t.getCell(E,I).setPropertyValue("idx",r)}return t._fireChanged(),!0}},{key:"unMergeCells",value:function(e){var t=this.table,r=t.collectCellsIdx(e);if(r.length<=0)return!1;for(var n=0;n<r.length;++n){var i=t.visual.getCellGridDataByIdx(r[n]);if(i.endRow-i.startRow>1||i.endCol-i.startCol>1){var a=Object(y.n)(i.startRow,e.startRow),o=Object(y.n)(i.endRow,e.endRow),s={startRow:a,startCol:Object(y.n)(i.startCol,e.startCol),endRow:o,endCol:Object(y.n)(i.endCol,e.endCol)};this.unMergeInner(s,i)}}return t._fireChanged(),!0}},{key:"unMergeInner",value:function(e,t){for(var r=this.table,n=r.getPresentation(),i=e.startRow;i<e.endRow;++i)for(var a=e.startCol;a<e.endCol;++a)if(i!==t.startRow||a!==t.startCol){var o=r.increaseIndex(),s=r.getCell(i,a);s.setPropertyValue("idx",o);var l=b.a.createNewTextFrame(n);s.addTextFrame(l)}var u=-1;if(e.startRow>t.startRow&&e.startCol>t.startCol){u=r.increaseIndex();for(var c=e.startRow;e.endRow;++c)for(var h=t.startCol;h<e.startCol;++h){var d=r.getCell(c,h);if(d.setPropertyValue("idx",u),c===e.startRow&&h===t.startCol){var p=b.a.createNewTextFrame(n);d.addTextFrame(p)}}}if(e.endCol<t.endCol){u=r.increaseIndex();for(var f=e.startRow;f<e.endRow;++f)for(var v=e.endCol;v<t.endCol;++v){var y=r.getCell(f,v);if(y.setPropertyValue("idx",u),f===e.startRow&&v===e.endCol){var g=b.a.createNewTextFrame(n);y.addTextFrame(g)}}}if(e.endRow<t.endRow){u=r.increaseIndex();for(var m=t.endRow;m<t.endRow;++m)for(var _=t.startCol;_<t.endCol;++_){var S=r.getCell(m,_);if(S.setPropertyValue("idx",u),m===e.endRow&&_===t.startCol){var T=b.a.createNewTextFrame(n);S.addTextFrame(T)}}}}},{key:"listAtomProperties",get:function(){return["childs"]}}]),t}(C.c));I.createNewTableFrame=function(e,t,r,n,i){for(var a=t.visual.getAnchorRect(),o=a.height()/r,s=new Array(r+1),l=0;l<=r;++l)s[l]=E(l*o,1);for(var u=a.width()/n,c=new Array(n+1),h=0;h<=n;++h)c[h]=E(h*u,1);for(var d=new Array(r+1),p=0;p<=r;++p)d[p]=p*o;for(var f=new Array(n+1),v=0;v<=n;++v)f[v]=v*u;var y={data:{horiborderpos:s,vertborderpos:c,horiborderposVisual:d,vertborderposVisual:f,modelType:w.ShapeModeType.MODEL_OBJTABLE,curIndex:0,childs:[]},id:e.allocateLocalId()},g=new I(y);return g.initData(e,r,n,i),g},Object(C.e)(I.prototype,!1),Object(C.d)(I,{ListAtomDelegateClass:A,selfAtomeType:"customAtom"}),I.createDefTableFrame=function(e,t,r,n){var i=e.getDefaultTblStyleID(),a=e.getPresetTblStyleList()[i];return I.createNewTableFrame(e,t,r,n,a)},I.createTableFrameNoStyle=function(e,t,r,n){var i=e.getPresetTblStyleList()[7];return I.createNewTableFrame(e,t,r,n,i)},I.createTableFrame=function(e,t,r,n,i){var a=e.getPresetTblStyleList();if(!(i<0||i>=a.length)){var o=a[i];return I.createNewTableFrame(e,t,r,n,o)}}},1906:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(152),i=r.n(n),a=r(0),o=r.n(a),s=r(3),l=r.n(s),u=r(360),c=r(724),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;o()(this,e),this.setMatrix(t,r,n,i,a,s)}return l()(e,[{key:"m11",value:function(){return this._m11}},{key:"m12",value:function(){return this._m12}},{key:"m21",value:function(){return this._m21}},{key:"m22",value:function(){return this._m22}},{key:"dx",value:function(){return this._dx}},{key:"dy",value:function(){return this._dy}},{key:"toString",value:function(){return"matrix("+this._m11+", "+this._m12+", "+this._m21+", "+this._m22+", "+this._dx+", "+this._dy+")"}},{key:"setMatrix",value:function(e,t,r,n,i,a){this._m11=e,this._m12=t,this._m21=r,this._m22=n,this._dx=i,this._dy=a}},{key:"setTranslate",value:function(e,t){this._dx=e,this._dy=t}},{key:"clone",value:function(){return new e(this._m11,this._m12,this._m21,this._m22,this._dx,this._dy)}},{key:"assign",value:function(t){return t instanceof e?(this.setMatrix(t._m11,t._m12,t._m21,t._m22,t._dx,t._dy),this):(console.error("matrix is no instanceof QMartix"),null)}},{key:"Map",value:function(e){if(e){if(e.isQPoint)return this.map_point(e);if(Object(u.f)(e)){var t=this.MAPDOUBLE(e.x,e.y),r=i()(t,2);return{x:r[0],y:r[1]}}if(e.isQLine);else{if(e.isQRect||e.isRect)return this.mapRect(e);if(e.isQPainterPath)return this.mapPainterPath(e);e.isQPolygon||e.isQRegion}}return console.error("Invalid argument for QMatrix.Map():",e),null}},{key:"map",value:function(e,t,r,n){return this.MAPINT(e,t,r,n)}},{key:"mapDouble",value:function(e,t,r,n){return this.MAPDOUBLE(e,t,r,n)}},{key:"map_path",value:function(e){if(0===e.length)return[];var t=[];if(1===this._m11&&1===this._m22&&0===this._m12&&0===this._m21)if(0!==this._dx||0!==this._dy)for(var r=0;r<e.length;++r){var n=e[r];if(n.type===c.d.Close)t.push(n);else{var i={type:n.type,x:n.x+this._dx,y:n.y+this._dy};t.push(i)}}else t=Object(u.d)(e);else for(var a=0;a<e.length;++a){var o=e[a],s=o.x,l=o.y;if(o.type===c.d.Close)t.push(o);else{var h={type:o.type,x:this._m11*s+this._m21*l+this._dx,y:this._m12*s+this._m22*l+this._dy};t.push(h)}}return t}},{key:"map_point",value:function(e){if(!e||!e.isQPoint)throw Error(e+" is not instanceof Point!");var t=e.x(),r=e.y(),n=e.clone();return n.setPoint(this._m11*t+this._m21*r+this._dx,this._m12*t+this._m22*r+this._dy),n}},{key:"mapContext",value:function(e){return e.transform&&e.transform(this._m11,this._m12,this._m21,this._m22,this._dx,this._dy),!0}},{key:"mapRect",value:function(e){if(!e||!e.isQRect&&!e.isRect)throw Error(e+" is not instanceof Rect!");var t=e.clone();if(0===this._m12&&0===this._m21){var r=this._m11*e.x()+this._dx,n=this._m22*e.y()+this._dy,a=this._m11*e.width(),o=this._m22*e.height();a<0&&(r-=a=-a),o<0&&(n-=o=-o),t.setRect(r,n,a,o)}else{var s=void 0,l=void 0,u=void 0,c=void 0,h=this.MAPDOUBLE(e.x(),e.y(),s,l),d=i()(h,2),p=s=d[0],f=l=d[1],v=s,y=l,g=this.MAPDOUBLE(e.x()+e.width(),e.y(),u,c),m=i()(g,2);u=m[0],c=m[1],p=Math.min(p,u),f=Math.min(f,c),v=Math.max(v,u),y=Math.max(y,c);var _=this.MAPDOUBLE(e.x()+e.width(),e.y()+e.height(),u,c),S=i()(_,2);u=S[0],c=S[1],p=Math.min(p,u),f=Math.min(f,c),v=Math.max(v,u),y=Math.max(y,c);var T=this.MAPDOUBLE(e.x(),e.y()+e.height(),u,c),b=i()(T,2);u=b[0],c=b[1],p=Math.min(p,u),f=Math.min(f,c),v=Math.max(v,u),y=Math.max(y,c),t.setRect(p,f,v-p,y-f)}return t}},{key:"MAPINT",value:function(e,t,r,n){var i=e,a=t;return[Math.round(this._m11*i+this._m21*a+this._dx),Math.round(this._m12*i+this._m22*a+this._dy)]}},{key:"MAPDOUBLE",value:function(e,t,r,n){var i=e,a=t;return[this._m11*i+this._m21*a+this._dx,this._m12*i+this._m22*a+this._dy]}},{key:"scale",value:function(e,t){return this._m11*=e,this._m12*=e,this._m21*=t,this._m22*=t,this}},{key:"translate",value:function(e,t){return this._dx+=e*this._m11+t*this._m21,this._dy+=t*this._m22+e*this._m12,this}},{key:"rotate",value:function(e){var t=0,r=0;if(90===e||-270===e)t=1;else if(270===e||-90===e)t=-1;else if(180===e)r=-1;else{var n=e*Math.PI/180;t=Math.sin(n),r=Math.cos(n)}var i=r*this._m11+t*this._m21,a=r*this._m12+t*this._m22,o=-t*this._m11+r*this._m21,s=-t*this._m12+r*this._m22;return this._m11=i,this._m12=a,this._m21=o,this._m22=s,this}},{key:"shear",value:function(e,t){var r=t*this._m21,n=t*this._m22,i=e*this._m11,a=e*this._m12;return this._m11+=r,this._m12+=n,this._m21+=i,this._m22+=a,this}},{key:"isInvertible",value:function(){return!Object(u.l)(this._m11*this._m22-this._m12*this._m21)}},{key:"determinant",value:function(){return this._m11*this._m22-this._m12*this._m21}},{key:"invertible",value:function(){return 0!==this.determinant()}},{key:"inverted",value:function(){var t=this.determinant();if(0===t)return new e(1,0,0,1,0,0);var r=1/t;return new e(this._m22*r,-this._m12*r,-this._m21*r,this._m11*r,(this._m21*this._dy-this._m22*this._dx)*r,(this._m12*this._dx-this._m11*this._dy)*r)}},{key:"isEqualsTo",value:function(t){return e.isEquals(this,t)}},{key:"multiply",value:function(t){return e.multiply(this,t)}},{key:"*",value:function(e){var t=this._m11*e._m11+this._m12*e._m21,r=this._m11*e._m12+this._m12*e._m22,n=this._m21*e._m11+this._m22*e._m21,i=this._m21*e._m12+this._m22*e._m22,a=this._dx*e._m11+this._dy*e._m21+e._dx,o=this._dx*e._m12+this._dy*e._m22+e._dy;return this._m11=t,this._m12=r,this._m21=n,this._m22=i,this._dx=a,this._dy=o,this}},{key:"multiply2",value:function(t){return e.multiply2(this,t)}},{key:"mapPainterPath",value:function(e){if(!e||!e.isQPainterPath||e.isEmpty())return e;var t=e.clone();t.setDirty(!0);for(var r=t.data,n=0,i=t.elementCount();n<i;++n){var a=r.elements[n],o=this.map_point(a.toPoint());a.x=o.x(),a.y=o.y()}return t}},{key:"isQMatrix",get:function(){return!0}}],[{key:"SetMatrixFromMartix",value:function(t){return t instanceof e?t.clone():(console.error("matrix is no instanceof Qmartix"),null)}},{key:"inverted",value:function(e){return e.inverted()}},{key:"isEquals",value:function(e,t){return e._m11===t._m11&&e._m12===t._m12&&e._m21===t._m21&&e._m22===t._m22&&e._dx===t._dx&&e._dy===t._dy}},{key:"multiply",value:function(t,r){return new e(t._m11*r._m11+t._m21*r._m12+0,t._m12*r._m11+t._m22*r._m12+0,t._m11*r._m21+t._m21*r._m22+0,t._m12*r._m21+t._m22*r._m22+0,t._m11*r._dx+t._m21*r._dy+t._dx,t._m12*r._dx+t._m22*r._dy+t._dy)}},{key:"multiply2",value:function(t,r){return e.multiply(r,t)}}]),e}();window.QMatrix=h},1907:function(e,t,r){"use strict";var n,i,a,o,s,l,u,c,h=r(0),d=r.n(h),p=r(3),f=r.n(p),v=r(150),y=r.n(v),g=window.CoreExports.animation,m=g.AnimPresetType,_=g.AnimCategory,S=(n={},y()(n,_.Entrance,{}),y()(n,_.Exit,{}),y()(n,_.Emphasis,{}),n),T=(i={},y()(i,_.Entrance,{}),y()(i,_.Exit,{}),y()(i,_.Emphasis,{disable:[m.ChangeFillColor,m.ChangeLineColor]}),i),b=(a={},y()(a,_.Entrance,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),y()(a,_.Emphasis,{enable:[m.GrowShrink,m.Transparency,m.Spin,m.FlashBulb,m.Teeter,m.Wink]}),y()(a,_.Exit,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),a),k=(o={},y()(o,_.Entrance,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),y()(o,_.Emphasis,{enable:[m.GrowShrink,m.ChangeFillColor,m.ChangeLineColor,m.Transparency,m.Spin,m.Lighten,m.ComplementaryColor,m.ComplementaryColor2,m.Desaturate,m.VerticalGrow,m.ContrastingColor,m.FlashBulb,m.Teeter,m.ColorBlend,m.Darken,m.Flicker,m.Blast,m.Wink]}),y()(o,_.Exit,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),o),C=(s={},y()(s,_.Entrance,{disable:[m.FadedSwivel,m.GrowAndTurn,m.Spinner,m.ColorReveal,m.Unfold,m.Boomerang,m.Float,m.Whip,m.Swish,m.Flip,m.Pinwheel]}),y()(s,_.Emphasis,{enable:[m.GrowShrink,m.Transparency,m.FlashBulb,m.Wink]}),y()(s,_.Exit,{disable:[m.FadedSwivel,m.GrowAndTurn,m.Spinner,m.ColorReveal,m.Unfold,m.Boomerang,m.Float,m.Whip,m.Swish,m.Flip,m.Pinwheel]}),s),w=(l={},y()(l,_.Entrance,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),y()(l,_.Emphasis,{enable:[m.GrowShrink,m.ChangeFillColor,m.ChangeLineColor,m.Transparency,m.Spin,m.FlashBulb,m.Teeter,m.Wink]}),y()(l,_.Exit,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),l),P=(u={},y()(u,_.Entrance,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),y()(u,_.Emphasis,{enable:[m.GrowShrink,m.ChangeFillColor,m.ChangeLineColor,m.Transparency,m.Spin,m.Lighten,m.ComplementaryColor,m.ComplementaryColor2,m.Desaturate,m.VerticalGrow,m.ContrastingColor,m.FlashBulb,m.ColorBlend,m.Darken,m.Teeter,m.Flicker,m.Blast,m.Wink]}),y()(u,_.Exit,{disable:[m.ColorReveal,m.FadedSwivel,m.Unfold,m.Whip,m.Swish,m.Flip]}),u),x=(c={},y()(c,_.Entrance,{disable:[m.FadedSwivel,m.ColorReveal,m.Unfold,m.Whip,m.Swish,m.Flip]}),y()(c,_.Emphasis,{enable:[m.GrowShrink,m.Transparency,m.Spin,m.FlashBulb,m.Teeter,m.Wink]}),y()(c,_.Exit,{disable:[m.FadedSwivel,m.ColorReveal,m.Unfold,m.Whip,m.Swish,m.Flip]}),c),O=function(){function e(){d()(this,e)}return f()(e,null,[{key:"optCheck",value:function(e,t,r){var n=e[t];if(!n)return!0;var i=n.disable;if(i&&-1!==i.indexOf(r))return!1;var a=n.enable;return!(!a||-1===a.indexOf(r))||!a}},{key:"isTextLegal",value:function(t,r,n){return t.visual.hasArtText()?e.optCheck(T,r,n):e.optCheck(S,r,n)}},{key:"isAnimLegal",value:function(t,r,n){if(!t||!t.parent)return!1;if((t=t.visual.getRootShape()).isGroupShape())return e.optCheck(x,r,n);if(t.isOleControlShape())return!1;if(t.isInk())return!1;if(t.hasSmartArt()||t.isConnector())return e.optCheck(P,r,n);var i=t.getTextFrame();if(i){var a=i.getTextStream();if(a&&a.getCharCount()>1)return e.isTextLegal(i,r,n)}return t.hasTable()||t.isMath()||t.isOle()||t.hasChart()?e.optCheck(b,r,n):t.isVideo()?e.optCheck(C,r,n):t.isAudio()?e.optCheck(w,r,n):e.optCheck(k,r,n)}}]),e}();t.a=O},1908:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonSlidesShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="commonSlide",r}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"Count",{get:function(){return this.private.childs&&this.private.childs.length||0},enumerable:!1,configurable:!0}),t.prototype.Item=function(e){return this.private.childs[e]},t.prototype.FindBySlideId=function(e){var t=this.coreData.getSlideById(e);return t&&t.apiShell},t.prototype.buildTree=function(e){var t=this.coreData.private.childs;if(t){this.private.childs=[];for(var r=0;r<t.length;++r){var n=t[r],i=window.APP.shellFactory.create(n,this.tag);i&&(this.private.childs.push(i),i.buildTree&&i.buildTree(this))}this.parent=e}},t}(r(1016).IShell);t.CommonSlidesShell=i},2002:function(e,t,r){"use strict";r.d(t,"a",(function(){return ie}));var n=r(152),i=r.n(n),a=r(0),o=r.n(a),s=r(3),l=r.n(s),u=r(360),c=r(1906),h=r(606),d=r(43),p=r.n(d),f=r(808),v=r(1012),y=r(2720),g=r(2240),m=0,_=1,S=2,T=3,b=4,k=0,C=1,w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o()(this,e),this.x=t,this.y=r,this.type=n,this.isClosed=i}return l()(e,[{key:"clone",value:function(){return new e(this.x,this.y,this.type)}},{key:"isMoveTo",value:function(){return this.type===m}},{key:"isLineTo",value:function(){return this.type===_}},{key:"isCurveTo",value:function(){return this.type===S}},{key:"toPoint",value:function(){return new f.a(this.x,this.y)}},{key:"isEquals",value:function(e){return e&&e.isElement===this.isElement&&Object(u.k)(this.x,e.x())&&Object(u.k)(this.y,e.y())&&this.type===e.type}},{key:"isElement",get:function(){return!0}}]),e}();function P(e){return e.isQPoint?{x:e.x(),y:e.y()}:e}function x(e){return!e.isQPoint&&Object(u.f)(e)?new f.a(e.x,e.y):e}var O=function(){function e(){o()(this,e),this.cStart=0,this.fillRule=k,this.dirtyBounds=!1,this.dirtyControlBounds=!1,this.pathConverter=null,this.require_moveTo=!1,this.convex=!1,this.bounds=new h.a,this.controlBounds=new h.a,this.elements=[],this.elements.push(new w)}return l()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){var t,r;return this.cStart=e.cStart,this.fillRule=e.fillRule,this.dirtyBounds=e.dirtyBounds,this.dirtyControlBounds=e.dirtyControlBounds,this.pathConverter=null,this.require_moveTo=!1,this.convex=e.convex,this.bounds=e.bounds.clone(),this.controlBounds=e.controlBounds.clone(),this.elements=(t=e.elements,r=[],t.forEach((function(e){return r.push(e.clone())})),r),this}},{key:"isClosed",value:function(){var e=this.elements.length,t=this.elements[this.cStart],r=this.elements[e-1];return V(t.x-r.x)&&V(t.y-r.y)}},{key:"close",value:function(){this.require_moveTo=!0;var e=this.elements.length,t=this.elements[this.cStart],r=this.elements[e-1];t.x!==r.x||t.y!==r.y?Object(u.k)(t.x,r.x)&&Object(u.k)(t.y,r.y)?(r.x=t.x,r.y=t.y):this.elements.push(new w(t.x,t.y,_,!0)):!r.isClosed&&Object(u.k)(t.x,r.x)&&Object(u.k)(t.y,r.y)&&this.elements.push(new w(t.x,t.y,b,!0))}},{key:"maybeMoveTo",value:function(){if(this.require_moveTo){var e=this.elements.length,t=this.elements[e-1].clone();t.type=m,this.elements.push(t),this.require_moveTo=!1}}},{key:"getPathElementAt",value:function(e){return this.elements[e]}},{key:"length",get:function(){return this.elements.length}}]),e}(),E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o()(this,e),this.data=null,t&&(this.data=new O,this.data.elements.push(new w(t.x,t.y,m)))}return l()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"assign",value:function(e){return this.data=e.data?e.data.clone():null,this}},{key:"isEmpty",value:function(){return!this.data||1===this.data.elements.length&&this.data.elements[0].type===m}},{key:"elementCount",value:function(){return this.data?this.data.elements.length:0}},{key:"elementAt",value:function(e){if(this.data)return this.data.elements[e]}},{key:"fillRule",value:function(){return this.isEmpty()?k:this.data.fillRule}},{key:"setFillRule",value:function(e){this.ensureData(),this.data.fillRule=e}},{key:"addRect",value:function(e){if(isFinite(e.x())&&isFinite(e.y())&&isFinite(e.width())&&isFinite(e.height())&&!e.isNull()){this.ensureData(),this.setDirty(!0);var t=this.data.elements.length<2;this.moveTo(e.x(),e.y()),this.data.elements.push(new w(e.x()+e.width(),e.y(),_)),this.data.elements.push(new w(e.x()+e.width(),e.y()+e.height(),_)),this.data.elements.push(new w(e.x(),e.y()+e.height(),_)),this.data.elements.push(new w(e.x(),e.y(),_)),this.data.require_moveTo=!0,this.data.convex=t}}},{key:"moveTo",value:function(){var e=arguments,t=void 0,r=void 0;if(1===e.length){var n=P(e[0]);t=n.x,r=n.y}else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=e[0],r=e[1]}if(isFinite(t)&&isFinite(r)){this.ensureData(),this.setDirty(!0);var i=this.data;i.require_moveTo=!1;var a=this.data.elements.length,o=i.elements[a-1];o.type===m?(o.x=t,o.y=r):i.elements.push(new w(t,r,m)),i.cStart=i.elements.length-1}else console.error("Invalid argument for painterPath lineTo!")}},{key:"lineTo",value:function(){var e=arguments,t=void 0;if(1===e.length)t=x(e[0]);else{if(2!==e.length)return void console.error("Invalid argument for painterPath lineTo!");t=new f.a(e[0],e[1])}if(t.isQPoint&&isFinite(t.x())&&isFinite(t.y())){this.ensureData(),this.setDirty(!0);var r=this.data,n=this.data.elements.length;if(n>0){if(r.maybeMoveTo(),t.isEquals(r.elements[n-1].toPoint()))return;var i=new w(t.x(),t.y(),_);r.elements.push(i),r.convex=3===r.elements.length||4===r.elements.length&&r.isClosed()}}else console.error("Invalid argument for painterPath lineTo!")}},{key:"quadTo",value:function(){var e=void 0,t=void 0,r=arguments;if(2===r.length?(e=r[0],t=r[1]):4===r.length?(e=new f.a(r[0]),t=new f.a(r[1])):console.error("Invalid argument for painterPath quadTo!"),e.isQPoint&&t.isQPoint){this.ensureData(),this.setDirty(!0);var n=this.data,i=n.elements.last(),a=new f.a(i.x,i.y);if(!a.isEquals(e)||!e.isEquals(t)){var o=new f.a((a.x()+2*e.x())/3,(a.y()+2*e.y())/3),s=new f.a((t.x()+2*e.x())/3,(t.y()+2*e.y())/3);this.cubicTo(o,s,t)}}else console.error("Invalid argument for painterPath quadTo!")}},{key:"cubicTo",value:function(){var e=void 0,t=void 0,r=void 0,n=arguments;if(3===n.length)e=n[0],t=n[1],r=n[2];else{if(6!==n.length)return;e=new f.a(n[0],n[1]),t=new f.a(n[2],n[3]),r=new f.a(n[4],n[5])}if(e.isQPoint&&t.isQPoint&&r.isQPoint){this.ensureData(),this.setDirty(!0);var i=this.data;i.elements.last().toPoint().isEquals(e)&&e.isEquals(t)&&t.isEquals(r)||(i.maybeMoveTo(),i.elements.push(new w(e.x(),e.y(),S)),i.elements.push(new w(t.x(),t.y(),T)),i.elements.push(new w(r.x(),r.y(),T)))}}},{key:"bezierCurveTo",value:function(){this.cubicTo.apply(this,arguments)}},{key:"quadraticCurveTo",value:function(){this.quadTo.apply(this,arguments)}},{key:"arcTo",value:function(){}},{key:"ellipse",value:function(e,t,r,n){this.addEllipse(new h.a(e-r,t-n,2*r,2*n))}},{key:"addEllipse",value:function(e){if(e&&e.isQRect&&!e.isNull()&&Object(u.p)(e.x())&&!isNaN(e.x())&&Object(u.p)(e.y())&&!isNaN(e.y())&&Object(u.p)(e.height())&&!isNaN(e.height())&&Object(u.p)(e.width())&&!isNaN(e.width())){this.ensureData(),this.setDirty(!0);var t=this.data,r=t.elements.length<2,n=[],a=Object(g.a)(e,0,-360,n,void 0),o=i()(a,1)[0];this.moveTo(o),this.cubicTo(n[0],n[1],n[2]),this.cubicTo(n[3],n[4],n[5]),this.cubicTo(n[6],n[7],n[8]),this.cubicTo(n[9],n[10],n[11]),t.require_moveTo=!0,t.convex=r}else console.error("QPainterPath::addEllipse: Adding ellipse where a parameter is NaN or Inf, ignoring call")}},{key:"closeSubpath",value:function(){this.isEmpty()||(this.setDirty(!0),this.data.close())}},{key:"boundingRect",value:function(){return this.data?(this.data.dirtyBounds&&this.computeBoundingRect(),this.data.bounds):new h.a}},{key:"ensureData",value:function(){this.data||(this.data=new O)}},{key:"detach",value:function(){this.setDirty(!0)}},{key:"setDirty",value:function(e){this.data.dirtyBounds=e,this.data.dirtyControlBounds=e,this.data.pathConverter=null,this.data.convex=!1}},{key:"computeBoundingRect",value:function(){var e=this.data;e.dirtyBounds=!1;var t=void 0,r=void 0,n=void 0,i=void 0;t=r=e.elements[0].x,n=i=e.elements[0].y;for(var a=1;a<e.elements.length;++a){var o=e.elements[a];switch(o.type){case m:case _:o.x>r?r=o.x:o.x<t&&(t=o.x),o.y>i?i=o.y:o.y<n&&(n=o.y);break;case S:var s=e.elements[a-1],l=e.elements[a+1],u=e.elements[a+2],c=L({x1:s.x,y1:s.y,x2:o.x,y2:o.y,x3:l.x,y3:l.y,x4:u.x,y4:u.y}),d=c.right(),p=c.bottom();c.x()<t&&(t=c.x()),d>r&&(r=d),c.y()<n&&(n=c.y()),p>i&&(i=p),a+=2}}e.bounds=new h.a(t,n,r-t,i-n)}},{key:"contains",value:function(e){return e&&e.isQRect?this.containsRect(e):e&&e.isQPoint?this.containsPoint(e):void console.error("Invalid argument for painterPath contains!")}},{key:"containsPointNearly",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!e||!e.isQPoint)return!1;if(this.containsPoint(e))return!0;var r=new h.a(e.x()-t,e.y()-t,2*t,2*t);return!!(this.containsPoint(r.topLeft())||this.containsPoint(r.topRight())||this.containsPoint(r.bottomRight())||this.containsPoint(r.bottomLeft()))||void 0}},{key:"containsPoint",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;for(var t=this.data,r=0,n=new f.a,i=new f.a,a=0;a<t.elements.length;++a){var o=t.elements[a].toPoint();switch(t.elements[a].type){case m:a>0&&(r=B(n,i,e,r)),i=n=o;break;case _:r=B(n,o,e,r),n=o;break;case S:var s=t.elements[++a].toPoint(),l=t.elements[++a].toPoint();r=j(y.a.fromPoints(n,o,s,l),e,r),n=l}}return n!==i&&(r=B(n,i,e,r)),t.fillRule===C?0!==r:r%2!=0}},{key:"containsRect",value:function(e){if(this.isEmpty()||!this.controlPointRect().contains(e))return!1;if(function(e,t){for(var r=new f.a,n=new f.a,i=0;i<e.elementCount();++i){var a=e.elementAt(i);switch(a.type){case m:if(i>0&&Object(u.k)(r.x(),n.x())&&Object(u.k)(r.y(),n.y())&&N(r.x(),r.y(),n.x(),n.y(),t))return!0;n=r=a.toPoint();break;case _:if(N(r.x(),r.y(),a.x,a.y,t))return!0;r=a.toPoint();break;case S:var o=e.elementAt(++i).toPoint(),s=e.elementAt(++i).toPoint(),l=y.a.fromPoints(r,a,o,s);if(M(l,t.top(),t.left(),t.right())||M(l,t.bottom(),t.left(),t.right())||F(l,t.left(),t.top(),t.bottom())||F(l,t.right(),t.top(),t.bottom()))return!0;r=s}}if(r!==n&&N(r.x(),r.y(),n.x(),n.y(),t))return!0;return!1}(this,e)){if(this.fillRule()===k)return!1;if(!(this.contains(e.topLeft())&&this.contains(e.topRight())&&this.contains(e.bottomRight())&&this.contains(e.bottomLeft())))return!1}if(!this.contains(e.center()))return!1;for(var t=this.data,r=0;r<t.elements.length;++r){var n=t.elements[r];if(n.type===m&&e.contains(n)){if(this.fillRule()===k)return!1;for(var i=!1;!i&&r<t.elements.length;++r){var a=t.elements[r];switch(a.type){case m:i=!0;break;case _:if(!this.contains(a))return!1;break;case S:if(!this.contains(t.elements[r+2]))return!1;r+=2}}--r}}return!0}},{key:"controlPointRect",value:function(){if(this.data){var e=this.data;return e.dirtyControlBounds&&this.computeControlPointRect(),e.controlBounds}this.controlBounds=new h.a}},{key:"computeControlPointRect",value:function(){if(this.data){var e=this.data;e.dirtyControlBounds=!1;var t=void 0,r=void 0,n=void 0,i=void 0;t=r=e.elements[0].x,n=i=e.elements[0].y;for(var a=1;a<e.elements.length;++a){var o=e.elements[a];o.x>r?r=o.x:o.x<t&&(t=o.x),o.y>i?i=o.y:o.y<n&&(n=o.y)}e.controlBounds=new h.a(t,n,r-t,i-n)}else this.controlBounds=new h.a}},{key:"addPolygon",value:function(e){if(Array.isArray(e)){if(0!==e.length){this.ensureData(),this.setDirty(!0),this.moveTo(e[0]);for(var t=0,r=e.length;t<r;t++){var n=e[t];this.lineTo(n)}e.isClosed&&this.closeSubpath()}}else console.error("QPainterPath addPolygon param is not array :",e)}},{key:"connectPolygon",value:function(e){if(Array.isArray(e)){this.ensureData(),this.setDirty(!0);for(var t=0,r=e.length;t<r;t++){var n=e[t];this.lineTo(n)}e.isClosed&&this.closeSubpath()}else console.error("QPainterPath addPolygon param is not array :",e)}},{key:"addPointPath",value:function(e){if(e){this.ensureData(),this.setDirty(!0);var t=e.type,r=e.x,n=e.y;switch(t){case m:this.moveTo(new f.a(r,n));break;case _:this.lineTo(new f.a(r,n))}}}},{key:"addPath",value:function(e){var t;if(e&&e.isQPainterPath&&!e.isEmpty()){this.ensureData(),this.setDirty(!0);var r=this.data;r.elements.last().type===m&&r.elements.splice(r.elements.length-1,1);var n=e.data,i=r.elements.length+e.data.cStart;(t=r.elements).push.apply(t,p()(n.elements)),r.cStart=i,r.require_moveTo=n.isClosed()}else console.error("addPath error!!!",e)}},{key:"toSubpathPolygons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(this.isEmpty())return[];e||(e=new c.a);var r=[],n=[];n.isClosed=!1;for(var i=this.data,a=0,o=i.elements.length;a<o;a++){var s=i.elements[a];switch(s.type){case m:if(0!==n.length){var l=Array.from(n);l.isClosed=n.isClosed,H(n)&&(l.isClosed=!0),r.push(l),n.length=0,n.isClosed=!1,n.push(e.map_point(s.toPoint()))}else n.push(e.map_point(s.toPoint()));break;case _:n.push(e.map_point(s.toPoint()));break;case S:if(!i.elements[a-1]||i.elements[a+1].type!==T||i.elements[a+2].type!==T){console.error("this element data error! check");break}var u=s.toPoint(),h=i.elements[a+1].toPoint(),d=i.elements[a+2].toPoint(),p=i.elements[a-1].toPoint(),f=y.a.fromPoints(e.map_point(p),e.map_point(u),e.map_point(h),e.map_point(d));f.addToPolygon(n,t),a+=2}}return H(n)&&(n.isClosed=!0),r.push(n),r}},{key:"translate",value:function(e,t){var r=0,n=0;e.isQPoint?(r=e.x(),n=e.y()):"number"==typeof e&&"number"==typeof t&&(r=e,n=t);var i=this.data;if(i&&(0!==r||0!==n))for(var a=i.elements.length-1,o=i.elements;a>=0;)o[a].x+=r,o[a].y+=n,a--}},{key:"toContextPath",value:function(e){if(!this.isEmpty()&&e.moveTo)for(var t=this.data,r=t.elements,n=0,i=r.length;n<i;n++){var a=r[n],o=a.type,s=a.toPoint();if(a.isClosed)e.closePath&&e.closePath();else switch(o){case m:e.moveTo&&e.moveTo(s.x(),s.y());break;case _:e.lineTo&&e.lineTo(s.x(),s.y());break;case S:if(!t.elements[n-1]||t.elements[n+1].type!==T||t.elements[n+2].type!==T){console.error("this element data error! check");break}var l=s,u=r[n+1].toPoint(),c=r[n+2].toPoint();e.bezierCurveTo&&e.bezierCurveTo(l.x(),l.y(),u.x(),u.y(),c.x(),c.y())}}}},{key:"getPathElementAt",value:function(e){return this.data?this.data.getPathElementAt(e):null}},{key:"isQPainterPath",get:function(){return!0}},{key:"length",get:function(){return this.data?this.data.length:0}}]),e}();function I(e,t){return 3*(-e[t+"1"]+3*e[t+"2"]-3*e[t+"3"]+e[t+"4"])}function A(e,t){return 6*(e[t+"1"]-2*e[t+"2"]+e[t+"3"])}function R(e,t){return 3*(-e[t+"1"]+e[t+"2"])}function D(e,t,r){if(t>=0&&t<=1){var n=Object(v.c)(e,t);n.x<r.minx?r.minx=n.x:n.x>r.maxx&&(r.maxx=n.x),n.y<r.miny?r.miny=n.y:n.y>r.maxy&&(r.maxy=n.y)}}function L(e){var t=void 0,r=void 0,n=void 0,i=void 0;e.x1<e.x4?(t=e.x1,n=e.x4):(t=e.x4,n=e.x1),e.y1<e.y4?(r=e.y1,i=e.y4):(r=e.y4,i=e.y1);var a={minx:t,miny:r,maxx:n,maxy:i},o=I(e,"x"),s=A(e,"x"),l=R(e,"x");if(Object(u.l)(o)){if(!Object(u.l)(s))D(e,-l/s,a)}else{var c=s*s-4*o*l;if(c>=0){var d=Math.sqrt(c),p=1/(2*o);D(e,(-s+d)*p,a),D(e,(-s-d)*p,a)}}var f=I(e,"y"),v=A(e,"y"),y=R(e,"y");if(Object(u.l)(f)){if(!Object(u.l)(v))D(e,-y/v,a)}else{var g=v*v-4*f*y;if(g>0){var m=Math.sqrt(g),_=1/(2*f);D(e,(-v+m)*_,a),D(e,(-v-m)*_,a)}}return new h.a(a.minx,a.miny,a.maxx-a.minx,a.maxy-a.miny)}function N(e,t,r,n,i){var a=i.left(),o=i.right(),s=i.top(),l=i.bottom(),u=(e<a)<<0|(e>o)<<1|(t<s)<<2|(t>l)<<3,c=(r<a)<<0|(r>o)<<1|(n<s)<<2|(n>l)<<3;if(u&c)return!1;if(u|c){var h=r-e,d=n-t;return e<a?(t+=d/h*(a-e),e=a):e>o&&(t-=d/h*(e-o),e=o),r<a?(n+=d/h*(a-r),r=a):r>o&&(n-=d/h*(r-o),r=o),(u=(t<s)<<2|(t>l)<<3)&(c=(n<s)<<2|(n>l)<<3)?!1:(t<s?(e+=h/d*(s-t),t=s):t>l&&(e-=h/d*(t-l),t=l),n<s?(r+=h/d*(s-n),n=s):n>l&&(r-=h/d*(n-l),n=l),!((u=(e<a)<<0|(e>o)<<1)&(c=(r<a)<<0|(r>o)<<1)))}return!1}function M(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.bounds();if(t>=a.top()&&t<a.bottom()&&a.right()>=r&&a.left()<n){var o=.01;if(32===i||a.width()<o&&a.height()<o)return!0;var s=new y.a,l=new y.a;if(e.split(s,l),M(s,t,r,n,i+1)||M(l,t,r,n,i+1))return!0}return!1}function F(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=e.bounds();if(t>=a.left()&&t<a.right()&&a.bottom()>=r&&a.top()<n){var o=.01;if(32===i||a.width()<o&&a.height()<o)return!0;var s=new y.a,l=new y.a;if(e.split(s,l),F(s,t,r,n,i+1)||F(l,t,r,n,i+1))return!0}return!1}function B(e,t,r,n){var i=e.x(),a=e.y(),o=t.x(),s=t.y(),l=r.y(),c=1;if(Object(u.k)(a,s))return n;if(s<a){var h=o;o=i,i=h;var d=s;s=a,a=d,c=-1}l>=a&&l<s&&(i+(o-i)/(s-a)*(l-a)<=r.x()&&(n+=c));return n}function j(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.y(),a=t.x(),o=e.bounds();if(i>=o.y()&&i<o.y()+o.height()){var s=.001;if(32===n||o.width()<s&&o.height()<s)return e.pt1().x()<=a&&(r+=e.pt4().y()>e.pt1().y()?1:-1),r;var l=new y.a,u=new y.a;e.split(l,u),r=j(l,t,r,n+1),r=j(u,t,r,n+1)}return r}function V(e){return Math.abs(e)<1e-7}function H(e){var t=e.length;return t>1&&V(e[0].x()-e[t-1].x())&&V(e[0].y()-e[t-1].y())}window.QPainterPath=E;var G=0,U=1,W=2,z=4,Y=8,q=16;var K=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o()(this,e),this.x=t,this.y=r,this.w=n}return l()(e,[{key:"toPoint",value:function(){var e=1/this.w;return{x:this.x*e,y:this.y*e}}}]),e}();function Q(e,t){var r=new K;return r.x=e.m11()*t.x()+e.m21()*t.y()+e.m31(),r.y=e.m12()*t.x()+e.m22()*t.y()+e.m32(),r.w=e.m13()*t.x()+e.m23()*t.y()+e.m33(),r}function X(e,t,r,n,i){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=Q(t,r),s=Q(t,n);if(o.w<u.c&&s.w<u.c)return!1;if(s.w<u.c){var l=(u.c-s.w)/(o.w-s.w);s.x+=(o.x-s.x)*l,s.y+=(o.y-s.y)*l,s.w=u.c}else if(o.w<u.c){var c=(u.c-o.w)/(s.w-o.w);o.x+=(s.x-o.x)*c,o.y+=(s.y-o.y)*c,o.w=u.c;var h=o.toPoint();i?(e.moveTo(h),i=!1):e.lineTo(h)}return i&&e.moveTo(o.toPoint()),a&&e.lineTo(s.toPoint()),!0}function J(e,t,r,n,i,a,o){for(var s=function(e){var t=null,r=e.type();if(r<=U)return{isSameScaleXY:!0,scale:t=1,xScale:1,yScale:1};if(r===W){var n=Math.abs(e.m11()),i=Math.abs(e.m22());return t=Map.max(n,i),{isSameScaleXY:Object(u.k)(n,i),scale:t,xScale:n,yScale:i}}var a=e.m11()*e.m11()+e.m21()*e.m21(),o=e.m12()*e.m12()+e.m22()*e.m22(),s=e.m11()*e.m11()+e.m12()*e.m12(),l=e.m21()*e.m21()+e.m22()*e.m22();return Math.abs(a-o)>Math.abs(s-l)?(t=Math.sqrt(Math.max(a,o)),{isSameScaleXY:r===z&&Object(u.k)(a,o),scale:t}):(t=Math.sqrt(Math.max(s,l)),{isSameScaleXY:r===z&&Object(u.k)(s,l),scale:t})}(t).scale,l=0===s?.25:.25/s,c=Object(v.e)({},l),h=0;h<c.length-1;++h)X(e,t,c[h],c[h+1],o)&&(o=!1);return!o}var Z=window.Point,$=1,ee=2,te=0,re=1,ne=2,ie=function(){function e(t){o()(this,e),this.affine=t?t.clone():new c.a,this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=G,this.m_dirty=t?Y:G}return l()(e,[{key:"clone",value:function(){return(new e).assign(this)}},{key:"setElements",value:function(e,t,r,n,i,a,o,s,l){this.affine.setMatrix(e,t,n,i,o,s),this.m_13=r,this.m_23=a,this.m_33=l,this.m_type=G,this.m_dirty=q}},{key:"setMatrix",value:function(e,t,r,n,i,a){this.affine.setMatrix(e,t,r,n,i,a),this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=G,this.m_dirty=Y}},{key:"setQMatrix",value:function(e){this.affine.setMatrix(e._m11,e._m12,e._m21,e._m22,e._dx,e._dy),this.m_13=0,this.m_23=0,this.m_33=1,this.m_type=G,this.m_dirty=Y}},{key:"reset",value:function(){this.affine._m11=this.affine._m22=this.m_33=1,this.affine._m12=this.m_13=this.affine._m21=this.m_23=this.affine._dx=this.affine._dy=0,this.m_type=G,this.m_dirty=G}},{key:"m11",value:function(){return this.affine._m11}},{key:"m12",value:function(){return this.affine._m12}},{key:"m13",value:function(){return this.m_13}},{key:"m21",value:function(){return this.affine._m21}},{key:"m22",value:function(){return this.affine._m22}},{key:"m23",value:function(){return this.m_23}},{key:"m31",value:function(){return this.affine._dx}},{key:"m32",value:function(){return this.affine._dy}},{key:"m33",value:function(){return this.m_33}},{key:"dx",value:function(){return this.affine._dx}},{key:"dy",value:function(){return this.affine._dy}},{key:"inline_type",value:function(){return this.m_dirty===G?this.m_type:this.type()}},{key:"type",value:function(){if(this.m_dirty===G||this.m_dirty<this.m_type)return this.m_type;switch(this.m_dirty){case q:if(!Object(u.l)(this.m_13)||!Object(u.l)(this.m_23)||!Object(u.l)(this.m_33-1)){this.m_type=q;break}case Y:case z:if(!Object(u.l)(this.affine._m12)||!Object(u.l)(this.affine._m21)){var e=this.affine._m11*this.affine._m12+this.affine._m21*this.affine._m22,t=this.affine._m11*this.affine._m21+this.affine._m12*this.affine._m22;Object(u.l)(e)||Object(u.l)(t)?this.m_type=z:this.m_type=Y;break}case W:if(!Object(u.l)(this.affine._m11-1)||!Object(u.l)(this.affine._m22-1)){this.m_type=W;break}case U:if(!Object(u.l)(this.affine._dx)||!Object(u.l)(this.affine._dy)){this.m_type=U;break}case G:this.m_type=G}return this.m_dirty=G,this.m_type}},{key:"determinant",value:function(){var e=this.affine;return e._m11*(this.m_33*e._m22-e._dy*this.m_23)-e._m21*(this.m_33*e._m12-e._dy*this.m_13)+e._dx*(this.m_23*e._m12-e._m22*this.m_13)}},{key:"isAffine",value:function(){return this.inline_type()<q}},{key:"isIdentity",value:function(){return this.inline_type()===G}},{key:"isInvertible",value:function(){return!Object(u.l)(this.determinant())}},{key:"isScaling",value:function(){return this.type()>=W}},{key:"isRotating",value:function(){return this.inline_type()>=z}},{key:"isTranslating",value:function(){return this.inline_type()>=U}},{key:"inverted",value:function(t){var r=new e,n=!0;switch(this.inline_type()){case G:break;case U:r.affine._dx=-this.affine._dx,r.affine._dy=-this.affine._dy;break;case W:n=!Object(u.l)(this.affine._m11),(n&=!Object(u.l)(this.affine._m22))&&(r.affine._m11=1/this.affine._m11,r.affine._m22=1/this.affine._m22,r.affine._dx=-this.affine._dx*r.affine._m11,r.affine._dy=-this.affine._dy*r.affine._m22);break;case z:case Y:n=this.affine.invertible(),r.affine=this.affine.inverted();break;default:var i=this.determinant();(n=!Object(u.l)(i))&&(r=this.adjoint()/i)}return t&&(t.invertible=n),n&&(r.m_type=this.m_type,r.m_dirty=this.m_dirty),r}},{key:"adjoint",value:function(){var t,r,n,i,a,o,s,l,u,c=this.affine,h=this.m_13,d=this.m_23,p=this.m_33;t=c._m22*p-d*c._dy,i=d*c._dx-c._m21*p,s=c._m21*c._dy-c._m22*c._dx,r=h*c._dy-c._m12*p,a=c._m11*p-h*c._dx,l=c._m12*c._dx-c._m11*c._dy,n=c._m12*d-h*c._m22,o=h*c._m21-c._m11*d,u=c._m11*c._m22-c._m12*c._m21;var f=new e;return f.setElements(t,r,n,i,a,o,s,l,u),f}},{key:"transposed",value:function(){var t=this.affine,r=this.m_13,n=this.m_23,i=this.m_33,a=new e;return a.setElements(t._m11,t._m21,t._dx,t._m12,t._m22,t._dy,r,n,i),a.m_type=this.m_type,a.m_dirty=this.m_dirty,a}},{key:"translate",value:function(e,t){if(0===e&&0===t)return this;switch(this.inline_type()){case G:this.affine._dx=e,this.affine._dy=t;break;case U:this.affine._dx+=e,this.affine._dy+=t;break;case W:this.affine._dx+=e*this.affine._m11,this.affine._dy+=t*this.affine._m22;break;case q:this.m_33+=e*this.m_13+t*this.m_23;case Y:case z:this.affine._dx+=e*this.affine._m11+t*this.affine._m21,this.affine._dy+=t*this.affine._m22+e*this.affine._m12}return this.m_dirty<U&&(this.m_dirty=U),this}},{key:"fromTranslate",value:function(t,r){var n=new e;return n.setElements(1,0,0,0,1,0,t,r,1),n.m_type=0===t&&0===r?G:U,n.m_dirty=G,n}},{key:"scale",value:function(e,t){if(1===e&&1===t)return this;switch(this.inline_type()){case G:case U:this.affine._m11=e,this.affine._m22=t;break;case q:this.m_13*=e,this.m_23*=t;case z:case Y:this.affine._m12*=e,this.affine._m21*=t;case W:this.affine._m11*=e,this.affine._m22*=t}return this.m_dirty<W&&(this.m_dirty=W),this}},{key:"shear",value:function(e,t){if(0===e&&0===t)return this;switch(this.inline_type()){case G:case U:this.affine._m12=t,this.affine._m21=e;break;case W:this.affine._m12=t*this.affine._m22,this.affine._m21=e*this.affine._m11;break;case q:var r=t*this.m_23,n=e*this.m_13;this.m_13+=r,this.m_23+=n;case z:case Y:var i=t*this.affine._m21,a=e*this.affine._m12,o=t*this.affine._m22,s=e*this.affine._m11;this.affine._m11+=i,this.affine._m12+=o,this.affine._m21+=s,this.affine._m22+=a}return this.m_dirty<Y&&(this.m_dirty=Y),this}},{key:"rotate",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee;if(0===t)return this;var n=0,i=0;if(90===t||-270===t)n=1;else if(270===t||-90===t)n=-1;else if(180===t)i=-1;else{var a=.017453292519943295*t;n=Math.sin(a),i=Math.cos(a)}if(r===ee){var o=this.affine,s=this.m_13,l=this.m_23;switch(this.inline_type()){case G:case U:o._m11=i,o._m12=n,o._m21=-n,o._m22=i;break;case W:var u=i*o._m11,c=n*o._m22,h=-n*o._m11,d=i*o._m22;o._m11=u,o._m12=c,o._m21=h,o._m22=d;break;case q:var p=i*s+n*l,f=-n*s+i*l;this.m_13=p,this.m_23=f;break;case z:case Y:var v=i*o._m11+n*o._m21,y=i*o._m12+n*o._m22,g=-n*o._m11+i*o._m21,m=-n*o._m12+i*o._m22;o._m11=v,o._m12=y,o._m21=g,o._m22=m}this.m_dirty<z&&(this.m_dirty=z)}else{var _=new e;r===$?(_.affine._m11=i,_.m_13=1/1024*-n):(_.affine._m22=i,_.m_23=1/1024*-n),_.m_type=q,this.assign(_.multiplySwap(this))}return this}},{key:"rotateRadians",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee,n=Math.sin(t),i=Math.cos(t);if(r===ee){var a=this.affine,o=this.m_13,s=this.m_23;switch(this.inline_type()){case G:case U:a._m11=i,a._m12=n,a._m21=-n,a._m22=i;break;case W:var l=i*a._m11,u=n*a._m22,c=-n*a._m11,h=i*a._m22;a._m11=l,a._m12=u,a._m21=c,a._m22=h;break;case q:var d=i*o+n*s,p=-n*o+i*s;this.m_13=d,this.m_23=p;break;case z:case Y:var f=i*a._m11+n*a._m21,v=i*a._m12+n*a._m22,y=-n*a._m11+i*a._m21,g=-n*a._m12+i*a._m22;a._m11=f,a._m12=v,a._m21=y,a._m22=g}this.m_dirty<z&&(this.m_dirty=z)}else{var m=new e;r===$?(m.affine._m11=i,m.m_13=1/1024*-n):(m.affine._m22=i,m.m_23=1/1024*-n),m.m_type=q,this.assign(m.multiply(this))}return this}},{key:"assign",value:function(e){return this.affine=e.affine,this.m_13=e.m_13,this.m_23=e.m_23,this.m_33=e.m_33,this.m_type=e.m_type,this.m_dirty=e.m_dirty,this}},{key:"isEquals",value:function(e){var t=this.affine,r=this.m_13,n=this.m_23,i=this.m_33;return t._m11===e.affine._m11&&t._m12===e.affine._m12&&t._m21===e.affine._m21&&t._m22===e.affine._m22&&t._dx===e.affine._dx&&t._dy===e.affine._dy&&r===e.m_13&&n===e.m_23&&i===e.m_33}},{key:"multiply",value:function(e){var t=e.inline_type();if(t===G)return this;var r=this.inline_type();if(r===G)return this.assign(e);var n=this.affine,i=this.m_13,a=this.m_23,o=this.m_33,s=Math.max(r,t);switch(s){case G:break;case U:n._dx+=e.affine._dx,n._dy+=e.affine._dy;break;case W:var l=n._m11*e.affine._m11,u=n._m22*e.affine._m22,c=n._dx*e.affine._m11+e.affine._dx,h=n._dy*e.affine._m22+e.affine._dy;n._m11=l,n._m22=u,n._dx=c,n._dy=h;break;case z:case Y:var d=n._m11*e.affine._m11+n._m12*e.affine._m21,p=n._m11*e.affine._m12+n._m12*e.affine._m22,f=n._m21*e.affine._m11+n._m22*e.affine._m21,v=n._m21*e.affine._m12+n._m22*e.affine._m22,y=n._dx*e.affine._m11+n._dy*e.affine._m21+e.affine._dx,g=n._dx*e.affine._m12+n._dy*e.affine._m22+e.affine._dy;n._m11=d,n._m12=p,n._m21=f,n._m22=v,n._dx=y,n._dy=g;break;case q:var m=n._m11*e.affine._m11+n._m12*e.affine._m21+i*e.affine._dx,_=n._m11*e.affine._m12+n._m12*e.affine._m22+i*e.affine._dy,S=n._m11*e.m_13+n._m12*e.m_23+i*e.m_33,T=n._m21*e.affine._m11+n._m22*e.affine._m21+a*e.affine._dx,b=n._m21*e.affine._m12+n._m22*e.affine._m22+a*e.affine._dy,k=n._m21*e.m_13+n._m22*e.m_23+a*e.m_33,C=n._dx*e.affine._m11+n._dy*e.affine._m21+o*e.affine._dx,w=n._dx*e.affine._m12+n._dy*e.affine._m22+o*e.affine._dy,P=n._dx*e.m_13+n._dy*e.m_23+o*e.m_33;n._m11=m,n._m12=_,this.m_13=S,n._m21=T,n._m22=b,this.m_23=k,n._dx=C,n._dy=w,this.m_33=P}return this.m_dirty=s,this.m_type=s,this}},{key:"multiplyNumber",value:function(e){return 1===e||(this.affine._m11*=e,this.affine._m12*=e,this.m_13*=e,this.affine._m21*=e,this.affine._m22*=e,this.m_23*=e,this.affine._dx*=e,this.affine._dy*=e,this.m_33*=e,this.m_dirty<W&&(this.m_dirty=W)),this}},{key:"dividedNumber",value:function(e){return 0===e?this:this.multiplyNumber(1/e)}},{key:"addNumber",value:function(e){return 0===e||(this.affine._m11+=e,this.affine._m12+=e,this.m_13+=e,this.affine._m21+=e,this.affine._m22+=e,this.m_23+=e,this.affine._dx+=e,this.affine._dy+=e,this.m_33+=e,this.m_dirty=q),this}},{key:"subNumber",value:function(e){return this.addNumber(-e)}},{key:"MAP",value:function(e,t){var r=this.affine,n=this.m_13,i=this.m_23,a=this.m_33,o=0,s=0,l=this.inline_type();switch(l){case G:o=e,s=t;break;case U:o=e+r._dx,s=t+r._dy;break;case W:o=r._m11*e+r._dx,s=r._m22*t+r._dy;break;case z:case Y:case q:if(o=r._m11*e+r._m21*t+r._dx,s=r._m12*e+r._m22*t+r._dy,l===q){var u=n*e+i*t+a;u<1e-6&&(u=1e-6),o*=u=1/u,s*=u}}return[o,s]}},{key:"mapPoint",value:function(e){var t=this.MAP(e.x(),e.y()),r=i()(t,2),n=r[0],a=r[1],o=e.clone();return o.setPoint(n,a),o}},{key:"mapLine",value:function(e){var t=this.mapPoint(e.p1()),r=this.mapPoint(e.p2());return e.clone().setPoints(t,r)}},{key:"mapRect",value:function(e){var t=e.clone(),r=this.affine,n=this.inline_type();if(n<=U)return t.translate(new Z(r._dx,r._dy));if(n<=W){var a=r._m11*t.x()+r._dx,o=r._m22*t.y()+r._dy,s=r._m11*t.width(),l=r._m22*t.height();return s<0&&(a-=s=-s),l<0&&(o-=l=-l),t.setRect(a,o,s,l),t}if(n<q||!Object(u.g)(t,this)){var c=0,h=0,d=this.MAP(t.x(),t.y()),p=i()(d,2),f=c=p[0],v=h=p[1],y=c,g=h,m=this.MAP(t.x()+t.width(),t.y()),_=i()(m,2);c=_[0],h=_[1],f=Math.min(f,c),v=Math.min(v,h),y=Math.max(y,c),g=Math.max(g,h);var S=this.MAP(t.x()+t.width(),t.y()+t.height()),T=i()(S,2);c=T[0],h=T[1],f=Math.min(f,c),v=Math.min(v,h),y=Math.max(y,c),g=Math.max(g,h);var b=this.MAP(t.x(),t.y()+t.height()),k=i()(b,2);return c=k[0],h=k[1],f=Math.min(f,c),v=Math.min(v,h),y=Math.max(y,c),g=Math.max(g,h),t.setRect(f,v,y-f,g-v),t}var C=new E;return C.addRect(t),this.map(C).boundingRect()}},{key:"mapPolygon",value:function(e){}},{key:"mapRegion",value:function(e){}},{key:"mapPainterPath",value:function(t){var r=this.inline_type();if(r===G||0===t.elementCount())return t;if(r>=q)return e.mapProjective(this,t);var n=t.clone();if(r===U)n.translate(this.affine._dx,this.affine._dy);else{n.detach();for(var a=0;a<t.elementCount();++a){var o=n.elementAt(a),s=this.MAP(o.x,o.y),l=i()(s,2),u=l[0],c=l[1];o.x=u,o.y=c}}return n}},{key:"Map",value:function(e){if(e){if(Object(u.e)(e))return this.mapRect(new h.a(e.x,e.y,e.width,e.height)).getRect();if(Object(u.f)(e)){var t=this.MAP(e.x,e.y),r=i()(t,2);return{x:r[0],y:r[1]}}if(e.isQPoint)return this.mapPoint(e);if(e.isQLine)return this.mapLine(e);if(e.isQRect||e.isRect)return this.mapRect(e);if(e.isQPainterPath)return this.mapPainterPath(e);if(e.isQPolygon)return this.mapPolygon(e);if(e.isQRegion)return this.mapRegion(e)}return console.error("Invalid argument for QTransform.map():",e),null}},{key:"isQTransform",get:function(){return!0}}],[{key:"multiply",value:function(e,t){return e.clone().multiply(t)}},{key:"mapProjective",value:function(e,t){for(var r=new E,n=void 0,i=void 0,a=!0,o=0;o<t.elementCount();++o)switch(t.elementAt(o).type){case te:o>0&&i!==n&&X(r,e,n,i,a),i=t.elementAt(o),n=t.elementAt(o),a=!0;break;case re:X(r,e,n,t.elementAt(o),a)&&(a=!1),n=t.elementAt(o);break;case ne:J(r,e,0,t.elementAt(o),t.elementAt(o+1),t.elementAt(o+2),a)&&(a=!1),o+=2,n=t.elementAt(o)}return t.elementCount()>0&&i!==n&&X(r,e,n,i,a,!1),r.setFillRule(t.fillRule()),r}}]),e}();window.QTransform=ie},201:function(e,t,r){"use strict";r.r(t),r.d(t,"AnimPresetType",(function(){return i})),r.d(t,"AnimBuildCategory",(function(){return s})),r.d(t,"AnimNodeType",(function(){return l})),r.d(t,"PresetFill",(function(){return u})),r.d(t,"AnimAttrType",(function(){return a})),r.d(t,"AnimBuildType",(function(){return o})),r.d(t,"AnimAfterType",(function(){return c})),r.d(t,"fillTypeEnum",(function(){return d})),r.d(t,"animCategoryStr",(function(){return p})),r.d(t,"makePropertyFunctions",(function(){return h}));var n=r(258);r.d(t,"AnimProperty",(function(){return n.AnimProperty})),r.d(t,"AnimLevel",(function(){return n.AnimLevel})),r.d(t,"AnimTriggerType",(function(){return n.AnimTriggerType})),r.d(t,"AnimDirection",(function(){return n.AnimDirection})),r.d(t,"AnimSpeed",(function(){return n.AnimSpeed})),r.d(t,"AnimRepeatTimes",(function(){return n.AnimRepeatTimes})),r.d(t,"AnimCategory",(function(){return n.AnimCategory})),r.d(t,"AnimBehaviorType",(function(){return n.AnimBehaviorType}));var i={Custom:0,Appear:1,Fly:2,Blinds:3,Box:4,Checkerboard:5,Circle:6,Crawl:7,Diamond:8,Dissolve:9,Fade:10,FlashOnce:11,Peek:12,Plus:13,RandomBars:14,Spiral:15,Split:16,Stretch:17,Strips:18,Swivel:19,Wedge:20,Wheel:21,Wipe:22,Zoom:23,RandomEffects:24,Boomerang:25,Bounce:26,ColorReveal:27,Credits:28,EaseIn:29,Float:30,GrowAndTurn:31,LightSpeed:32,Pinwheel:33,RiseUp:34,Swish:35,ThinLine:36,Unfold:37,Whip:38,Ascend:39,CenterRevolve:40,FadedSwivel:41,Descend:42,Sling:43,Spinner:44,Stretchy:45,Zip:46,ArcUp:47,FadedZoom:48,Glide:49,Expand:50,Flip:51,Shimmer:52,Fold:53,ChangeFillColor:54,ChangeFont:55,ChangeFontColor:56,ChangeFontSize:57,ChangeFontStyle:58,GrowShrink:59,ChangeLineColor:60,Spin:61,Transparency:62,BoldFlash:63,Blast:64,BoldReveal:65,BrushOnColor:66,BrushOnUnderline:67,ColorBlend:68,ColorWave:69,ComplementaryColor:70,ComplementaryColor2:71,ContrastingColor:72,Darken:73,Desaturate:74,FlashBulb:75,Flicker:76,GrowWithColor:77,Lighten:78,StyleEmphasis:79,Teeter:80,VerticalGrow:81,Wave:82,MediaPlay:83,MediaPause:84,MediaStop:85,PathCircle:86,PathRightTriangle:87,PathDiamond:88,PathHexagon:89,Path5PointStar:90,PathCrescentMoon:91,PathSquare:92,PathTrapezoid:93,PathHeart:94,PathOctagon:95,Path6PointStar:96,PathFootball:97,PathEqualTriangle:98,PathParallelogram:99,PathPentagon:100,Path4PointStar:101,Path8PointStar:102,PathTeardrop:103,PathPointyStar:104,PathCurvedSquare:105,PathCurvedX:106,PathVerticalFigure8:107,PathCurvyStar:108,PathLoopdeLoop:109,PathBuzzsaw:110,PathHorizontalFigure8:111,PathPeanut:112,PathFigure8Four:113,PathNeutron:114,PathSwoosh:115,PathBean:116,PathPlus:117,PathInvertedTriangle:118,PathInvertedSquare:119,PathLeft:120,PathTurnRight:121,PathArcDown:122,PathZigzag:123,PathSCurve2:124,PathSineWave:125,PathBounceLeft:126,PathDown:127,PathTurnUp:128,PathArcUp:129,PathHeartbeat:130,PathSpiralRight:131,PathWave:132,PathCurvyLeft:133,PathDiagonalDownRight:134,PathTurnDown:135,PathArcLeft:136,PathFunnel:137,PathSpring:138,PathBounceRight:139,PathSpiralLeft:140,PathDiagonalUpRight:141,PathTurnUpRight:142,PathArcRight:143,PathSCurve1:144,PathDecayingWave:145,PathCurvyRight:146,PathStairsDown:147,PathUp:148,PathRight:149,Wink:150,Flash:151,PathCustom:152};Object.freeze(i);var a={None:0,X:1,Y:2,Width:3,Height:4,Opacity:5,Rotation:6,Color:7,Visibility:8,Xshear:9,TextFontBold:100,TextFontColor:101,TextFontEmboss:102,TextFontItalic:103,TextFontName:104,TextFontShadow:105,TextFontSize:106,TextFontSubscript:107,TextFontSuperscript:108,TextFontUnderline:109,TextFontStrikeThrough:110,TextBulletCharacter:111,TextBulletFontName:112,TextBulletNumber:113,TextBulletColor:114,TextBulletRelativeSize:115,TextBulletStyle:116,TextBulletType:117,ShapePictureContrast:1e3,ShapePictureBrightness:1001,ShapePictureGamma:1002,ShapePictureGrayscale:1003,ShapeFillOn:1004,ShapeFillColor:1005,ShapeFillOpacity:1006,ShapeFillBackColor:1007,ShapeLineOn:1008,ShapeLineColor:1009,ShapeShadowOn:1010,ShapeShadowType:1011,ShapeShadowColor:1012,ShapeShadowOpacity:1013,ShapeShadowOffsetX:1014,ShapeShadowOffsetY:1015,ShapeFillType:1016,ShapeStyleRotation:1017,XY:1018,TextFontTransform:1019,TextFontOutline:1020,TextFontSRotation:1021,ShapePictureCropTop:1022,ShapePictureCropBottom:1023,ShapePictureCropLeft:1024,ShapePictureCropRight:1025,ShapePictureGain:1026,ShapePictureBlackLevel:1027,ShapePictureChromakey:1028,ShapeFillMethod:1029,ShapeFillBackOpacity:1030,ShapeFillAngle:1031,ShapeFillFocus:1032,ShapeFillFocusPositionX:1033,ShapeFillFocusPositionY:1034,ShapeFillFocussizeX:1035,ShapeFillFocussizeY:1036,ShapeLineWeight:1037,ShapeLineOpacity:1038,ShapeLineStyle:1039,ShapeLineDashStyle:1040,ShapeLineFillType:1041,ShapeLineSrc:1042,ShapeLineBackColor:1043,ShapeLineImagesizeX:1044,ShapeLineImagesizeY:1045,ShapeLineStratArrow:1046,ShapeLineEndArrow:1047,ShapeLineStartArrowWidth:1048,ShapeLineStartArrowLength:1049,ShapeLineEndArrowWidth:1050,ShapeLineEndArrowLength:1051,ShapeShadowBackColor:1052,ShapeShadowBackOffsetX:1053,ShapeShadowBackOffsetY:1054,ShapeShadowOriginX:1055,ShapeShadowOriginY:1056,ShapeShadowMatrixXtox:1057,ShapeShadowMatrixYtox:1058,ShapeShadowMatrixYtoy:1059,ShapeShadowMatrixPerspectiveX:1060,ShapeShadowMatrixPerspectiveY:1061,ShapeSkewOn:1062,ShapeSkewOffsetX:1063,ShapeSkewOffsetY:1064,ShapeSkewOriginX:1065,ShapeSkewOriginY:1066,ShapeSkewMatrixXtox:1067,ShapeSkewMatrixYtox:1068,ShapeSkewMatrixYtoy:1069,ShapeSkewMatrixPerspectiveX:1070,ShapeSkewMatrixPerspectiveY:1071,ExtrusionOn:1072,ExtrusionType:1073,ExtrusionRender:1074,ExtrusionViewpointoriginX:1075,ExtrusionViewpointoriginY:1076,ExtrusionViewpointX:1077,ExtrusionViewpointY:1078,ExtrusionViewpointZ:1079,ExtrusionPlane:1080,ExtrusionSkewangle:1081,ExtrusionSkewamt:1082,ExtrusionBackDepth:1083,ExtrusionForeDepth:1084,ExtrusionOrientationX:1085,ExtrusionOrientationY:1086,ExtrusionOrientationZ:1087,ExtrusionOrientationAngle:1088,ExtrusionColor:1089,ExtrusionRotationAngleX:1090,ExtrusionRotationAngleY:1091,ExtrusionLockRotationCenter:1092,ExtrusionAutoRotationCenter:1093,ExtrusionRotationCenterX:1094,ExtrusionRotationCenterY:1095,ExtrusionRotationCenterZ:1096,ExtrusionColorMode:1097};Object.freeze(a);var o={AllAtOnce:0,ByParagraph:1,AsWhole:3};Object.freeze(o);var s={BuildMixed:-1,BuildDiagram:0,BuildGraphic:1,BuildOleChart:2,BuildParagraph:3};Object.freeze(s);var l={None:0,Effect:1,WithEffect:3,ClickEffect:4,AfterEffect:5,Sound:8,Audio:9,Video:10,InteractiveSeq:11,TimingRoot:18,MainSeq:24,Behavior:25,Motion:26,Color:27,Scale:28,Rotation:29,Property:30,Command:31,Filter:32,Set:33,Iterate:34};Object.freeze(l);var u={Remove:1,Freeze:2,Hold:3,Transition:4};Object.freeze(u);Object.freeze({animColorTypeMixed:-2,animColorTypeRGB:1,animColorTypeSchemaIndex:2,animColorTypeHls:3,animColorTypeCMS:4,animColorTypeInk:5,animColorTypeCRGB:6,animColorTypePreset:7,animColorTypeSystem:8,animColorTypeCount:9});var c={Mixed:-1,None:0,Dim:1,Hide:2,HideOnNextClick:3};Object.freeze(c);function h(e,t){var r=function(t){return function(){var r=this.private[t];return Object.isEmpty(r)?e[t]:r}};for(var n in e){if(e.hasOwnProperty(n))t["get"+n.substr(0,1).toUpperCase()+n.substr(1)]=r(n)}}function d(e){switch(e){case u.Remove:return"remove";case u.Freeze:return"freeze";case u.Hold:return"hold";case u.Transition:return"transition";default:return"error"}}function p(e){switch(e){case n.AnimCategory.Entrance:return"entrance";case n.AnimCategory.Exit:return"exit";case n.AnimCategory.Emphasis:return"emphasis";case n.AnimCategory.Path:return"path";case n.AnimCategory.MediaCall:return"media";default:return"error"}}Object.freeze({TypeMixed:-1,TypeString:0,TypeNumber:1,TypeColor:2,TypeBool:3,TypeFloat:4})},204:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(201),l=r(2251),u=r(2252),c=r(2253),h=r(1716),d=r(2255),p=r(2256),f=r(2257),v=r(2258),y=r(2259),g=r(2260),m=r(764),_=r(167),S=r(762),T=r(268),b=r(258),k=[C(s.AnimCategory.Emphasis,b.KsoAnimEffect.ColorWave),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.BrushOnColor),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.BrushOnUnderline),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.Wave),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.ChangeFontColor),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.Flash),C(s.AnimCategory.Emphasis,b.KsoAnimEffect.BoldReveal)];function C(e,t){return e<<4+t}var w=function(){function e(){i()(this,e)}return o()(e,null,[{key:"createNode",value:function(e,t){switch(e){case s.AnimNodeType.TimingRoot:return this._createTimeline(t);case s.AnimNodeType.MainSeq:return this._createSequence(!0,t);case s.AnimNodeType.InteractiveSeq:return this._createSequence(!1,t);case s.AnimNodeType.Audio:case s.AnimNodeType.Video:return this._createMedia(t);case s.AnimNodeType.Effect:case s.AnimNodeType.Iterate:return this._createEffect(t);case s.AnimNodeType.Set:case s.AnimNodeType.Scale:case s.AnimNodeType.Rotation:case s.AnimNodeType.Filter:case s.AnimNodeType.Command:case s.AnimNodeType.Color:case s.AnimNodeType.Sound:case s.AnimNodeType.Property:case s.AnimNodeType.Motion:return this._createBehavior(e,t)}return null}},{key:"_createTimeline",value:function(t){var r={nodeType:s.AnimNodeType.TimingRoot,duration:-1,restart:3,fill:0,triggerType:9};e.mergeProperties(r,t);var n={data:r};return new l.a(n)}},{key:"_createSequence",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments[1];if(t){var n={nodeType:s.AnimNodeType.MainSeq,duration:-1,restart:3,fill:0};e.mergeProperties(n,r);var i={data:n},a=new u.a(i);return a}var o={nodeType:s.AnimNodeType.InteractiveSeq,duration:-1,restart:3,fill:0};e.mergeProperties(o,r);var l={data:o},c=new u.a(l);return c}},{key:"_createEffect",value:function(t){var r={nodeType:s.AnimNodeType.Effect};e.mergeProperties(r,t);var n={data:r,islocal:!0};return new c.a(n)}},{key:"_createMedia",value:function(t){var r={};e.mergeProperties(r,t);var n={data:r};return new h.a(n)}},{key:"_createBehavior",value:function(t,r){var n={nodeType:t,type:t-s.AnimNodeType.Behavior};e.mergeProperties(n,r);var i={data:n};switch(t){case s.AnimNodeType.Set:return new d.a(i);case s.AnimNodeType.Property:return new p.a(i);case s.AnimNodeType.Color:return new f.a(i);case s.AnimNodeType.Rotation:return new v.a(i);case s.AnimNodeType.Scale:return new y.a(i);case s.AnimNodeType.Command:return new g.a(i);default:return new m.a(i)}}},{key:"mergeProperties",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Object.isEmpty(t)&&!Object.isEmpty(e))for(var n in t){var i=t[n];if(!Object.isEmpty(i)){var a=e[n];Object.isEmpty(a)&&(e[n]=r?Object(T.a)(i):n)}}}},{key:"findEffectLevel",value:function(e){var t=s.AnimLevel.LevelMixed,r=e.getSlide().getTiming();if(e.isPlaceHolder()){var n=e.getPlaceHolder(),i=n&&n.type?n.type:_.WpPlaceholder.Body;t=_.WpPlaceholder.Body===i||_.WpPlaceholder.SubTitle===i||_.WpPlaceholder.VerticalBody===i||_.WpPlaceholder.Object===i?s.AnimLevel.TextByFirstLevel:s.AnimLevel.LevelNone}var a=this._getBuildType(r,e);if(t===s.AnimLevel.TextByFifthLevel&&a===s.AnimBuildType.BuildAsWhole?t=s.AnimLevel.LevelNone:t!==s.AnimLevel.LevelNone&&a!==s.AnimBuildType.BuildByParagraph||(t=s.AnimLevel.TextByAllLevels),t===s.AnimLevel.LevelNone){var o=r.getBuilds();if(o)for(var l=e.getId(),u=o.getOneShapeCnt(e),c=0;c<u;++c){var h=o.getBuildByIndex(l,c);if(h){var d=h.getBuildType();d!==s.AnimBuildType.ByParagraph&&d!==s.AnimBuildType.AllAtOnce||(t=s.AnimLevel.TextByAllLevels)}}}return t}},{key:"_getBuildType",value:function(e,t){var r=e.getBuilds(),n=s.AnimBuildType.AsWhole;if(null!=r)for(var i=t.getId(),a=r.getOneShapeCnt(t),o=0;o<a;o++){var l=r.getBuildByIndex(i,o);if(null!=l){var u=l.getBuildType();if(0!==o&&(u===s.AnimBuildType.AsWhole&&n!==s.AnimBuildType.AsWhole||u!==s.AnimBuildType.AsWhole&&n===s.AnimBuildType.AsWhole))return n;if(l&&l.getBuildDiagram&&null!=l.getBuildDiagram&&l.getBuildAsOnce&&null!=l.getBuildAsOnce){n=s.AnimBuildType.AsWhole;continue}n=u}}return n}},{key:"cloneNode",value:function(t){var r=e.createNode(t.getNodeType());for(var n in t.private)"container"!==n&&(r.private[n]=Object(T.a)(t.private[n]));for(var i=0;i<t.length;++i){var a=t.subNode(i),o=e.cloneNode(a);r.insertSubNode(r.length,o)}return r}},{key:"getMediaEffect",value:function(t){if(t){var r=e.getEffects(t);if(r&&0!==r.length){var n=[];if(r.forEach((function(e){e.getCategory()===s.AnimCategory.MediaCall&&n.push(e)})),!(n.length>1))return n[0];console.error("mediaEffect's data error, count != 1!")}}}},{key:"getEffects",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e.getSlide(),r=t&&t.getTiming(),n=r&&r.getTimeLine();if(n){var i=[];n.mainSequence&&(i=i.concat(n.mainSequence)),n.allInterSeq&&(i=i.concat(n.allInterSeq));for(var a=[],o=0;o<i.length;++o){var s=e?i[o].getEffect(e.getId()):i[o].allEffects();s&&(a=a.concat(s))}return a}}},{key:"getMediaNode",value:function(e){if(e){var t=e.getSlide(),r=t&&t.getTiming(),n=r&&r.getTimeLine();return n?n.getMediaNode(e):null}}},{key:"filterPreviewAnims",value:function(t){var r=[];return t.map((function(t){t&&t.getCategory()!==s.AnimCategory.MediaCall&&r.push(e.cloneNode(t))})),r}},{key:"canAddObjectEffect",value:function(e,t,r){if(!e)return!1;if(k.includes(C(t,r)))return!1;var n=e.getPlaceHolder();if(!n)return!0;if(S.a.phTypeFollowCommon(n)!==_.PlaceholderType.Body)return!0;var i=e.getTextFrame();if(!i)return!0;var a=i&&i.getTextStream();if(a&&a.end<=1)return!0;var o=function(e){var t=e.getFill(),r=!(!t||t.type===_.FillType.FillTypeNone),n=e.getOutline();return r|=!(!n||!n.fill||n.fill.type===_.FillType.FillTypeNone),r|=!!e.getStyle(),r|=!!e.getEffects()};if(o(e))return!0;for(var s=e.getSlide().getPhShapes(e),l=0;l<s.length;l++)if(o(s[l].shape))return!0;return!1}},{key:"canAddParaEffect",value:function(t,r){if(!t)return!1;if(t.hasSmartArt())return r!==s.AnimLevel.LevelNone;var n=t.getTextFrame();if(!n)return!1;var i=n.getTextStream();if(!i)return!1;var a=i.getAllText();if(!a||a.length<=1)return!1;var o=t.getPlaceHolder();if(o){var l=S.a.phTypeFollowCommon(o);if(l&&l===_.PlaceholderType.Body)return!0}var u=e.getEffects(t);if(!u||0===u.length)return!1;for(var c=0;c<u.length;++c){if(u[c].hasPara())return!0}return!1}},{key:"getNode",value:function(e,t){if(e&&t&&!(t.length<=0)){var r=e.getTiming(),n=r&&r.getTimeLine();if(0!==n.length){for(var i=void 0,a=n,o=0;o<t.length;++o){if(!(i=a.subNode(t[o])))return;a=i}return i}}}},{key:"getAnimateTextDefaultValue",value:function(e){if(e)switch(e.getType()){case s.AnimPresetType.Appear:case s.AnimPresetType.RandomEffects:return.5;case s.AnimPresetType.ColorReveal:case s.AnimPresetType.Swish:return 50;case s.AnimPresetType.GrowAndTurn:return 5;case s.AnimPresetType.ChangeFont:case s.AnimPresetType.ChangeFontStyle:case s.AnimPresetType.Transparency:case s.AnimPresetType.StyleEmphasis:return 5;case s.AnimPresetType.BoldReveal:return.03;case s.AnimPresetType.BrushOnColor:case s.AnimPresetType.BrushOnUnderline:return 4;case s.AnimPresetType.ChangeFontSize:return 10;case s.AnimPresetType.ChangeFillColor:case s.AnimPresetType.ChangeLineColor:case s.AnimPresetType.ChangeFontColor:default:return 10}}}]),e}();t.a=w},208:function(e,t,r){"use strict";r.r(t);var n=r(158);r.d(t,"userAgent",(function(){return n.userAgent})),r.d(t,"ViewModes",(function(){return n.ViewModes})),r.d(t,"VIEW_EVENT_TYPES",(function(){return n.VIEW_EVENT_TYPES})),r.d(t,"FocusTargetsDef",(function(){return n.FocusTargetsDef}))},224:function(e,t,r){var n=r(11),i=r(5),a=r(17);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],o={};o[e]=t(r),n(n.S+n.F*a((function(){r(1)})),"Object",o)}},2240:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(152),i=r.n(n),a=r(360);function o(e,t,r,n,o){o=0;var u=e.x(),c=e.y(),h=e.width(),d=e.width()/2,p=.5522847498*d,f=e.height(),v=e.height()/2,y=.5522847498*v,g=[new window.Point(u+h,c+v),new window.Point(u+h,c+v+y),new window.Point(u+d+p,c+f),new window.Point(u+d,c+f),new window.Point(u+d-p,c+f),new window.Point(u,c+v+y),new window.Point(u,c+v),new window.Point(u,c+v-y),new window.Point(u+d-p,c),new window.Point(u+d,c),new window.Point(u+d+p,c),new window.Point(u+h,c+v-y),new window.Point(u+h,c+v)];if(r>360?r=360:r<-360&&(r=-360),0===t){if(360===r){for(var m=11;m>=0;--m)n[o++]=g[m];return[g[12],o]}if(-360===r){for(var _=1;_<=12;++_)n[o++]=g[_];return[g[0],o]}}var S=parseInt(Math.floor(t/90),10),T=parseInt(Math.floor((t+r)/90),10),b=(t-90*S)/90,k=(t+r-90*T)/90,C=r>0?1:-1;C<0&&(b=1-b,k=1-k),Object(a.l)(b-1)&&(b=0,S+=C),Object(a.l)(k)&&(k=1,T-=C),b=s(90*b),k=s(90*k);var w=!Object(a.l)(b),P=!Object(a.l)(k-1),x=T+C;if(S===x){var O=3*(3-(S%4+4)%4);return[C>0?g[O+3]:g[O],o]}var E=new window.Point,I=new window.Point;!function(e,t,r,n,a){if(e.isNull())return;for(var o=e.width()/2,u=e.height()/2,c=[t,t+r],h=[n,a],d=window.Point,p=0;p<2;++p)if(h[p]){var f=(c[p]-360*Math.floor(c[p]/360))/90,v=parseInt(Math.floor(f),10);f=s(90*(f-=v)),1&v&&(f=1-f);var y=void 0,g=void 0,m=void 0,_=void 0,S=l(f,y,g,m,_),T=i()(S,4);y=T[0],g=T[1],m=T[2],_=T[3];var b=new window.Point(y+g+.5522847498*m,_+m+.5522847498*g);1!==v&&2!==v||b.setX(-b.x()),0!==v&&1!==v||b.setY(-b.y()),h[p].setFromPoint(d["+"](e.center(),new window.Point(o*b.x(),u*b.y())))}}(e,t,r,E,I);for(var A=window.QBezier,R=S;R!==x;R+=C){var D=3*(3-(R%4+4)%4),L=void 0;if(L=C>0?A.fromPoints(g[D+3],g[D+2],g[D+1],g[D]):A.fromPoints(g[D],g[D+1],g[D+2],g[D+3]),S===T&&Object(a.k)(b,k))return[E,o];R===S?R===T&&P?L=L.bezierOnInterval(b,k):w&&(L=L.bezierOnInterval(b,1)):R===T&&P&&(L=L.bezierOnInterval(0,k)),n[o++]=L.pt2(),n[o++]=L.pt3(),n[o++]=L.pt4()}return n[o-1]=I,[E,o]}function s(e){if(Object(a.l)(e))return 0;if(Object(a.k)(e,90))return 1;var t=Math.PI*e/180,r=Math.cos(t),n=Math.sin(t),i=e/90;i-=(((2-3*.5522847498)*i+3*-.4477152502)*i*i+1-r)/(((6-4.9705627482)*i+6*-.4477152502)*i);var o=i-=(((2-3*.5522847498)*i+3*-.4477152502)*i*i+1-r)/(((6-4.9705627482)*i+6*-.4477152502)*i);return o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-n)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498),.5*(i+(o-=((((3*.5522847498-2)*o-6*.5522847498+3)*o+3*.5522847498)*o-n)/(((4.9705627482-6)*o+12*.5522847498-6)*o+3*.5522847498)))}function l(e,t,r,n,i){var a=1-e;return i=(n=e*e)*e,[(r=a*a)*a,r*=3*e,n*=3*a,i]}},2241:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionInstances=void 0;var n=r(143),i=(0,n.__importDefault)(r(304)),a=(0,n.__importDefault)(r(262)),o=function(e){function t(){var t=e.call(this)||this;return t.states=[],t.cmds=[],t.initVer=0,t.dataVer=0,t.taskVer=0,t.reachVer=0,t.level=0,t.undoSteps=0,t.cmds=[],t.states=[],t.initVer=0,t.dataVer=0,t.taskVer=0,t.reachVer=0,t.level=0,t.undoSteps=0,t}return(0,n.__extends)(t,e),t.prototype.beginTransact=function(){this.level+=1},t.prototype.endTransact=function(){if(this.isInTransaction()||console.error("Not in fakeTransaction !!"),this.level-=1,!(this.level>0))if(0!==this.cmds.length){if(this.undoSteps>0){for(var e=0;e<this.states.length&&this.states[e].dataVer!==this.dataVer;++e);this.states=this.states.slice(0,e+1),this.undoSteps=0,this.reachVer=this.dataVer+1}else this.reachVer+=1;var t={cmds:this.cmds,dataVer:this.dataVer+1,taskVer:this.taskVer+1};this.states.push(t),this.cmds=[],this.dataVer+=1,this.taskVer+=1}else this.rollback()},t.prototype.rollback=function(){this.cmds=[],this.level=0},t.prototype.isInTransaction=function(){return-1!==this.level},t.prototype.addCommand=function(e){this.isInTransaction()&&this.cmds.push(e)},t.prototype.canUndo=function(){return this.dataVer>this.initVer},t.prototype.undo=function(){var e;if(this.canUndo()){for(var t,r=this.dataVer,o=0;o<this.states.length;++o){var s=this.states[o];if(s.dataVer===r){t=s.cmds;break}}if(t){for(o=0;o<t.length;++o){var l=t[o],u=l.index,c=l.shapetree,h=void 0;if("insert"===l.type){var d=l.obj;d.length<=0&&console.error("Empty drawingShapes !!");var p=d[u];d.splice(u,1),h={opType:i.default.otRemove,data:c,op:a.default.op_remove,vals:[p],isDrawingShape:!0}}else if("delete"===l.type){var f=l.data;(e=l.obj).splice.apply(e,(0,n.__spreadArray)([u,0],f,!1)),h={opType:i.default.otInsert,data:c,op:a.default.op_add,vals:f,isDrawingShape:!0}}c._fireChanged(h)}this.dataVer-=1,this.undoSteps+=1}else console.error("Could not find cmd, dataVer: ",r)}},t.prototype.canRedo=function(){return this.dataVer<this.reachVer},t.prototype.redo=function(){if(this.canRedo()){for(var e,t=this.dataVer+1,r=0;r<this.states.length;++r){var n=this.states[r];if(n.dataVer===t){e=n.cmds;break}}if(e){for(r=0;r<e.length;++r){var o=e[r],s=o.index,l=o.shapetree;if("insert"===o.type){var u=o.data;(h=o.obj).splice(s,0,u);var c={opType:i.default.otInsert,data:l,op:a.default.op_add,vals:[u],isDrawingShape:!0};l._fireChanged(c)}else if("delete"===o.type){var h;(h=o.obj).length<=0&&console.error("Empty Inkshapes !!");var d=o.data;h.splice(s,d.length);c={opType:i.default.otRemove,data:l,op:a.default.op_remove,vals:d,isDrawingShape:!0};l._fireChanged(c)}}this.dataVer+=1,this.undoSteps-=1}else console.error("Could not find cmd, dataVer: ",t)}},t}(function(){function e(){}return e.prototype.beginTransact=function(){},e.prototype.endTransact=function(){},e.prototype.rollback=function(){},e.prototype.isInTransaction=function(){},e.prototype.addCommand=function(e){},e.prototype.canUndo=function(){},e.prototype.undo=function(){},e.prototype.canRedo=function(){},e.prototype.redo=function(){},e}()),s=function(){function e(){}return e.getInstance=function(t){var r=e;switch(t){case"inkShapes":return r.inkTransaction||(r.inkTransaction=new o),r.inkTransaction}},e}();t.TransactionInstances=s},2242:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return s}));var n=r(158);function i(e,t){if(e&&t&&e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}function a(e,t){if(!e||!t)return!1;var r=e.category||"slides",i=t.category||"slides",a=e.layerType||n.WppLayerType.WppLayerNormalSlide,o=t.layerType||n.WppLayerType.WppLayerNormalSlide;return r===i&&a===o&&e.slideIdx===t.slideIdx}function o(e,t){return!!a(e,t)&&function(e,t){if(e&&t&&e.length===t.length){for(var r=e.length,n=0;n<r;++n){var i=e[n],a=t[n];if("number"!=typeof i&&(i=i[0]),"number"!=typeof a&&(a=a[0]),i!==a)return!1}return!0}return!1}(e.shapePath,t.shapePath)}function s(e,t){if(o(e,t)){var r=!!e.cellRange;if(r===!!t.cellRange)return!r||(n=e.cellRange,i=t.cellRange,n&&i?n.startRow===i.startRow&&n.startCol===i.startCol&&n.endRow===i.endRow&&n.endCol===i.endCol:!n&&!i)}var n,i;return!1}},2243:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(268),l=function(){function e(){i()(this,e)}return o()(e,null,[{key:"copyData",value:function(e,t){if(Object.isEmpty(t))return!1;for(var r in t){var n=t[r];Object.isEmpty(n)||(e[r]=Object(s.a)(n))}return!0}},{key:"getAutoNum",value:function(e,t){if(!e)return null;var r=e.getTextStream();if(!r)return null;var n=r.getAutonumMgr(),i=e.visual.getTextStyle(),a=i&&i.listNumbers,o=t.outline,s=t.listType,l=t.autoNum;o?o<0?o=0:o>8&&(o=8):o=0,s=s||0;var u=n.at(l);!u&&a&&((u=a["lvl"+o])||(u=a.def));return u||2!==s||(u={getStart:function(){return 1},getType:function(){return 3}}),u}},{key:"formatTextFrameProps",value:function(e,t){Object.isEmpty(t.anchorType)&&(t.anchorType=0)}},{key:"formatPapProps",value:function(t,r){Object.isEmpty(r.bBullet)&&(r.bBullet=!1),Object.isEmpty(r.listType)&&(r.listType=0);var n=e.getAutoNum(t,r);!Object.isEmpty(r.autoNum)&&n&&(r.autoNumType=n.getType(),delete r.autoNum)}},{key:"translateThmeFont",value:function(e){if(!Object.isEmpty(e.themeIndex)){var t=null;switch(t="minor"===e.themeIndex?"+min":"+maj",e.themeScript){case"drawing.latin":t+="l";break;case"drawing.eastAsian":t+="e";break;case"drawing.complexScript":t+="c"}e.name=t}}},{key:"formatThemeFont",value:function(t){Object.isEmpty(t.fontNameAscii)||e.translateThmeFont(t.fontNameAscii),Object.isEmpty(t.fontNameAsiaEast)||e.translateThmeFont(t.fontNameAsiaEast),Object.isEmpty(t.fontNameComplex)||e.translateThmeFont(t.fontNameComplex)}},{key:"formatChpProps",value:function(t){if(e.formatThemeFont(t),Object.isEmpty(t.bold)||(t.bold=!!t.bold),Object.isEmpty(t.italic)||(t.italic=!!t.italic),Object.isEmpty(t.strikeThrough)||(t.strikeThrough=!!t.strikeThrough),!Object.isEmpty(t.textColor)){var r=t.textColor;if(r){var n=r.color;n&&n.toRGB&&delete n.toRGB}}Object.isEmpty(t.actions)||delete t.actions,Object.isEmpty(t.fontSize)&&(t.fontSize=360)}},{key:"copyAnimProperty",value:function(e,t){var r=t.private;for(var n in r)"container"!==n&&(e[n]=Object(s.a)(r[n]))}},{key:"copyAnimData",value:function(t){var r={};if(Object.isEmpty(t))return!1;var n=t.getBehaviors();return n.length>0&&(r.behaviors=[],n.forEach((function(t){var n={};e.copyAnimProperty(n,t),r.behaviors.push(n)}))),e.copyAnimProperty(r,t),r}}]),e}();t.a=l},2244:function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"a",(function(){return w}));var n=r(25),i=r.n(n),a=r(42),o=r.n(a),s=r(0),l=r.n(s),u=r(3),c=r.n(u),h=r(335),d=r(315),p=r(268),f=r(262),v=r(158),y=function(e){function t(e,r,n,a){l()(this,t);var o=i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._txstream=e,o.sourceToken=e.create_token,o._text=r,o._initState(n,a),o}return o()(t,e),c()(t,[{key:"_initState",value:function(e,t){var r={};this._txstream._bubbleUpEvent(f.default.collect_path,r),r.begin=e,r.end=t,r.token=Object(d.a)(),r.data_token=this._txstream.data_token,this._proxyState={state:r,isValid:!0,isDataValid:!0}}},{key:"clone",value:function(){var e=this._txstream,r=this._text,n=Object(p.a)(this.getState());return new t(e,r,n.begin,n.end)}},{key:"isSameTxStreamWith",value:function(e){if(!e)return!1;var t=this.getState(),r=e.getState();if(t.slideId!==r.slideId)return!1;if(t.shapeIds.length!==r.shapeIds.length)return!1;return!!function(){for(var e=!0,n=0;n<t.shapeIds.length;++n)t.shapeIds[n]!==r.shapeIds[n]&&(e=!1);return e}()&&t.cellIdx===r.cellIdx}},{key:"canReplace",value:function(e){if(!e||0===Object.keys(e).length)return!0;var t=e[this.sourceToken];if(!t||0===t.length)return!0;for(var r=this.getState(),n=0;n<t.length;++n){var i=t[n],a=i.getState();if(i.isValid()&&(this.isSameTxStreamWith(i)&&r.begin<a.end&&r.end>a.begin))return!i._proxyState.isReplaced}return!0}},{key:"dataSource",value:function(){return this._txstream}},{key:"isValid",value:function(){return this._proxyState.isValid&&this._checkDataValid(),this._proxyState.isValid&&this._proxyState.isDataValid}},{key:"_checkDataValid",value:function(){if(this._proxyState.isValid){var e=this._proxyState.state;if(e.end-e.begin!==this._text.length)return void(this._proxyState.isDataValid=!1);var t=this._txstream,r=t.parent,n=r&&r.visual.getSlideVisual();if(!n||!n.coredata.parent||n.coredata.getId()!==e.slideId)return void(this._proxyState.isDataValid=!1);var i=t.getText(e.begin,e.end-e.begin).join("");this._proxyState.isDataValid=i.toLowerCase()===this._text.toLowerCase()}else this._proxyState.isDataValid=!1}},{key:"getState",value:function(){return this._proxyState.state}},{key:"discard",value:function(){this._proxyState.isDataValid=!1,this._proxyState.isValid=!1}},{key:"doObserver",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=this.getState(),n=this._text.length,i=this._proxyState,a=this.dataSource();a&&t?(i.textStreamNotifyer&&(a.removeObserver(i.textStreamNotifyer),i.textStreamNotifyer=null),i.textStreamNotifyer={onInsertTextObserved:function(t,i){var a=e.transInsertText(r.begin,r.end,t,i),o=a.bChanged,s=a.begin,l=a.end;o&&(r.begin=s===l&&n>0?l-i:s,r.end=l)},onDeleteTextObserved:function(t,n){var i=e.transDeleteText(r.begin,r.end,t,n),a=i.bChanged,o=i.begin,s=i.end;a&&(r.begin=o,r.end=s)}},a.addObserver(i.textStreamNotifyer)):a&&!t&&(a.removeObserver(i.textStreamNotifyer),i.textStreamNotifyer=null)}},{key:"transInsertText",value:function(e,t,r,n){var i={bChanged:!1,begin:e,end:t};return r<=e?(i.begin+=n,i.end+=n,i.bChanged=!0):r>e&&r<t&&(i.end+=n,i.bChanged=!0),i}},{key:"transDeleteText",value:function(e,t,r,n){var i=r+n,a={bChanged:!1,begin:e,end:t};return i<=e?(a.begin-=n,a.end-=n):r>=e&&i<=t?a.end-=n:r<e?(a.begin=r,a.end=i<=t?t-n:r):r<t&&(a.end=r),e===a.begin&&t===a.end||(a.bChanged=!0),a}}]),t}(function(){function e(){l()(this,e),this._searcher=null}return c()(e,[{key:"dataSource",value:function(){}},{key:"isValid",value:function(){}},{key:"getState",value:function(){}},{key:"discard",value:function(){}}]),e}()),g="search_at_end",m="search_result_changed",_="search_result_add",S="search_result_remove",T="search_index_change",b="modify",k="update_thumbnail",C=function(e){function t(e){l()(this,t);var r=i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._modifiedStreams=[],r._newObjects=[],r}return o()(t,e),c()(t,[{key:"updateReplacedState",value:function(e){for(var t=this,r=function(e){if(e._oldText){var t=e._text;e._text=e._oldText,e._oldText=t}},n=e.applyVersions,i=e.localVersions,a=e.resetBaseVersions,o=Object.keys(this._replaced),s=0;s<o.length;++s)for(var l=this._replaced[o[s]],u=0;u<l.length;++u){var c=l[u],h=c._proxyState;if(!0===h.isReplaced)for(var d=0;d<a.length;++d)a[d].taskVer===h.taskVer&&a[d].dataVersion<=h.dataVer&&(r(c),h.isReplaced=!1,this._curSearchSlt=c.clone(),this._curSearchSlt.doObserver(!0),setTimeout((function(){t.updateSearchSlt()}),0));if(!1===h.isReplaced)for(var p=0;p<n.length;++p)n[p].taskVer===h.taskVer&&n[p].dataVersion>=h.dataVer&&(r(c),h.isReplaced=!0);for(var f=0;f<i.length;++f)i[f].dataVersion===h.dataVer&&(h.dataVer+=1,h.taskVer+=1)}}},{key:"getResultByParams",value:function(e){if(0===this.count)return[];if(!e)return this.getSortedResults();var t=e.slideId,r=e.shapeId,n=this._pres.getSlideById(t);if(!n)return null;var i=n.findShapeById(r);if(!i)return null;if(i.hasTable()){for(var a=[],o=i.getTableFrame().getChilds(),s=0;s<o.length;++s){var l=o[s].getTextFrame(),u=l&&l.getTextStream();if(u){var c=u.create_token;if(!this._resultCache[c])continue;for(var h=0;h<this._resultCache[c].length;++h)a.push(this._resultCache[c][h])}}return a}var d=i.getTextFrame(),p=d&&d.getTextStream();if(p){var f=p.create_token;return this._resultCache[f]}}},{key:"updateSearchSlt",value:function(){var e=this;if(this._curSearchSlt){this._searchSltIndex=function(){var t=-1;if(!e._curSearchSlt)return t;for(var r=e._curSearchSlt.sourceToken,n=e._curSearchSlt.getState(),i=n.begin,a=(n.end,e.getSortedSlideIds()),o=0;o<a.length;++o)for(var s=e._sourceSequence[a[o]],l=0;l<s.length;++l){var u=s[l];if(u.sourceToken===r){var c=e._resultCache[r];if(c)for(var h=0;h<c.length;++h){c[h].getState().end<=i&&t++}return e._curSearchSlt.isValid()?t+1:e.count>0?t<e.count-1?t+1:0:-1}t+=u.count}}(),-1!==this._searchSltIndex&&this.gotoResult(this._searchSltIndex),this.fire(T,{index:this._searchSltIndex})}}},{key:"getSearchSltIndex",value:function(){return this._searchSltIndex}},{key:"changeSltByItem",value:function(e){if(e){var t=e.getState(),r=t.slideId,n=t.shapeIds,i=t.cellRange,a=t.begin,o=t.end,s=this._pres.selection,l=this._pres.getSlideById(r);s.selectSlide(l),n&&n.forEach((function(e){var t=l.findShapeById(e);s.selectShape(t)})),null!=i&&s.selectTblRange(i),s.selectText(a,o)}}},{key:"addReplacedItems",value:function(e,t,r){if(e&&0!==e.length)for(var n=r.length-t.length,i=0;i<e.length;++i){var a=e[i].clone(),o=a.getState();o.begin+=n*i,o.end=o.begin+r.length,a._text=r,a._oldText=t,a._proxyState.dataVer=window.g_rpt.baseVersion+1,a._proxyState.taskVer=window.g_rpt.taskVersion+1,a._proxyState.isReplaced=!0,this._replaced[a.sourceToken]||(this._replaced[a.sourceToken]=[]),a.doObserver(!0),this._replaced[a.sourceToken].push(a)}}},{key:"replace",value:function(e){var t=this;if(this._curSearchSlt)if(this._curSearchSlt.canReplace(this._replaced)){var r=Object(p.a)(this._curSearchSlt.getState());this.changeSltByItem(this._curSearchSlt);var n=this._pres.selection,i=n.transaction;i._isReplace=!0,i.beginBatchCommand(),i.setCooperHandler("replaceText"),i.setUserData("oldText",this._searchData),i.setUserData("newText",e),n.replaceText(this._searchData,e,[r])&&(""!==e&&this.addReplacedItems([this._curSearchSlt],this._searchData,e),function(r){var n=t.getSearchSltIndex(),i=n<t.count-1?n+1:0,a=t.resultAt(i);if(a&&a.isSameTxStreamWith(t._curSearchSlt)){var o=e.length-t._searchData.length,s=t._curSearchSlt.sourceToken,l=t._resultCache[s];if(l)for(var u=0;u<l.length;++u){var c=l[u].getState();c.begin>=r.end&&(c.begin+=o,c.end+=o)}}}(r),this._validCount>1?this.toNext(!0):n.selectText(r.begin,r.begin+e.length)),i.forceCommit()}else this.toNext()}},{key:"replaceAll",value:function(e){var t=this;if(this._curSearchSlt){var r=this._curSearchSlt.clone(),n=this._pres.selection,i=n.transaction;i.beginBatchCommand(),i.setCooperHandler("replaceText"),i.setUserData("oldText",this._searchData),i.setUserData("newText",e),i.setUserData("isReplaceAll",!0);for(var a=Date.now(),o=this.getSortedSlideIds(),s=0;s<o.length;++s)for(var l=this._sourceSequence[o[s]],u=0;u<l.length;++u){var c=l[u],h=c.count,d=c.sourceToken;h>0&&function(){var r=t._resultCache[d];t.changeSltByItem(r[0]);var i,a=(i=[],r.forEach((function(e){i.push(Object(p.a)(e.getState()))})),i);n.replaceText(t._searchData,e,a)&&t.addReplacedItems(r,t._searchData,e),t._validCount-=h}()}this._replacedTime=Date.now()-a,i._isReplace=!0,i.forceCommit();var f=r.getState();return f.end=f.begin+e.length,this.changeSltByItem(r),0===this._validCount}}},{key:"_onDataChanged",value:function(e){var t=this,r=e.data,n=e.event,i=e.op,a=e.vals,o=!1;if(n===f.default.insert_text||n===f.default.delete_text){var s={};if(r._bubbleUpEvent(f.default.collect_path,s),s.layerType===v.WppLayerType.WppLayerNotesPage)return;this._modifiedStreams.indexOf(r)<0&&this._modifiedStreams.push(r),o=!0}else if(n===f.default.modify_slide_container){var l=e.optype,u=e.opvalue.value;if(!u.isNormalSlide)return;if(l===f.default.op_remove){var c=u.getId(),h=this._sourceSequence[c];if(!h)return;for(var d=0;d<h.length;++d){var p=h[d].sourceToken;if(this._resultCache[p])for(var y=0;y<this._resultCache[p].length;++y)this._resultCache[p][y].discard(),this._validCount--,this.fire(S,{searcher:this,item:this._resultCache[p][y]});delete this._resultCache[p]}if(delete this._sourceSequence[c],this._curSearchSlt)if(this._curSearchSlt.getState().slideId===c){var g=e.opvalue.index,m=this._pres.getSlideCount()>g?g:g-1,_=this._pres.getSlideAt(m);setTimeout((function(){t.initSearchSlt(_)}),0)}else this.updateSearchSlt();return}if(l===f.default.op_add)for(var T=u.getShapeCount(),b=function(e){!function e(r){if(r.isGroupShape())for(var n=r.private.childs,i=0;i<n.length;++i)e(n[i]);else{var a=r.getTextFrame(),s=a&&a.getTextStream();s&&(t._modifiedStreams.push(s),o=!0)}}(u.getShapeAt(e))},k=0;k<T;++k)b(k);else l===f.default.op_move&&this.updateSearchSlt()}else!a||i!==f.default.op_add&&i!==f.default.op_replace?i===f.default.op_remove&&(o=!0):(this._newObjects=this._newObjects.concat(a),o=!0);if(this.atEnd()){var C=this;o&&(this._searchTimeout&&clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout((function(){C._searchTimeout=null,C.__handleModifiedStreams(),C.__handleNewObjs(),C.__handleCheckValidData()}),0)),this._searchTimeout||(this._searchTimeout=setTimeout((function(){C._searchTimeout=null,C.__handleCheckValidData()}),0))}}},{key:"__handleModifiedStreams",value:function(){if(0!==this._modifiedStreams.length){for(var e={},t=0;t<this._modifiedStreams.length;t++){var r=this._modifiedStreams[t];if(r&&r.matchText&&this.__isValidObject(r.parent)){var n=r.matchText(this._searchData,this._replaced);e[r.create_token]=n}}this._addNewResults(e),this._curSearchSlt||this.initSearchSlt(this._pres.selection.getActiveSlide()),this._modifiedStreams=[]}}},{key:"__handleNewObjs",value:function(){if(0!==this._newObjects.length){for(var e=0;e<this._newObjects.length;e++){var t=this._newObjects[e];if(t&&t.matchText&&this.__isValidObject(t)){var r=t.matchText(this._searchData);this._addNewResults(this._resultListToMap(r))}}this._curSearchSlt||this.initSearchSlt(this._pres.selection.getActiveSlide()),this._newObjects=[]}}},{key:"__handleCheckValidData",value:function(){var e=this._resultCache,t=[],r=this.count;for(var n in e){var i=e[n];if(i&&i.length>0){var a=i[0],o=a.dataSource().parent;this.__isValidObject(o)||(t=t.concat(i),this._updateSourceResults(a.sourceToken,null))}}this.__updateValidCount(r-t.length);for(var s=0;s<t.length;s++)t[s].discard(),this.fire(S,{searcher:this,item:t[s]});this.updateSearchSlt()}},{key:"__isValidObject",value:function(e){var t=e&&e.visual.getSlideVisual();return t&&t.coredata.parent}},{key:"_onSearchAtEnd",value:function(){this.__handleModifiedStreams(),this.__handleNewObjs()}},{key:"_onReset",value:function(){for(var e in this._notifys){this._notifys[e].discard()}this._notifys={};var t=this._pres;this._start=0,this._end=t.getSlideCount()-1}},{key:"_onSearchCurrentBlock",value:function(e){var t=this._current,r=this._blockStep,n=this._pres.getSlides();if(n&&n.matchText){var i=n.matchText(e,t,r);if(i){var a=this._resultListToMap(i);if(a&&this._modifiedStreams.length>0)for(var o=Object.keys(a),s=0;s<o.length;s++)this._modifiedStreams.remove(o[s]);return a}}}},{key:"_resultListToMap",value:function(e){if(e&&e.length>0){for(var t={},r=0;r<e.length;r++){var n=e[r],i=n.sourceToken;t[i]?t[i].push(n):t[i]=[n]}return t}}}]),t}(function(e){function t(e){l()(this,t);var r=i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r._manager=e,r._pres=e.pres,r._current=-1,r._start=-1,r._end=-1,r._blockStep=1,r._searchData=null,r._resultCache={},r._sourceSequence={},r._validCount=0,r._curSearchSlt=null,r._bNext=!0,r._replaced={},r._searchSltIndex=-1;var n=r;return r._pres.on(b,(function(e){n.__coreDataChanged(e)})),r._pres.on(k,(function(e){n.__coreDataChanged(e)})),r}return o()(t,e),c()(t,[{key:"getSortedResults",value:function(){for(var e=[],t=this.getSortedSlideIds(),r=0;r<t.length;++r)for(var n=this._sourceSequence[t[r]],i=0;i<n.length;++i)for(var a=n[i].sourceToken,o=0;o<n[i].count;++o)e.push(this._resultCache[a][o]);return e}},{key:"getSortedSlideIds",value:function(){for(var e=Object.keys(this._sourceSequence),t=[],r=this._pres.getSlideCount(),n=0;n<r;++n){var i=this._pres.getSlideAt(n).getId();e.includes(i.toString())&&t.push(i)}return t}},{key:"resultAt",value:function(e){for(var t=0,r=this.getSortedSlideIds(),n=0;n<r.length;++n)for(var i=this._sourceSequence[r[n]],a=0;a<i.length;a++){var o=i[a],s=o.sourceToken,l=o.count;if(e>=t&&e<t+l)return this._resultCache[s][e-t];t+=l}}},{key:"reset",value:function(){for(var e in this._resultCache){var t=this._resultCache[e];if(t)for(var r=0;r<t.length;r++){t[r].discard()}}this._validCount=0,this._current=-1,this._blockStep=1,this._resultCache={},this._sourceSequence={},this._curSearchSlt=null,this._bNext=!0,this._replaced={},this._pres.selection.transaction._isReplace=!1,this._pres.selection.clearTextSelect(),this._onReset()}},{key:"setBlockSize",value:function(e){this._blockStep=e>0?e:1}},{key:"setSearchBegin",value:function(e){this._begin=e}},{key:"setSearchEnd",value:function(e){this._end=e}},{key:"hasNextBlock",value:function(){return this._start>=0&&this._end>=this._start&&this._current<this._end}},{key:"toNextBlock",value:function(){if(this.hasNextBlock()){if(this._current<this._start)this._current=this._start;else{var e=Math.floor(this._current/this._blockStep),t=e*this._blockStep,r=t+this._blockStep-1;this._current>=t&&this._current<r?this._current+=1:this._current=(e+1)*this._blockStep}return!0}return!1}},{key:"search",value:function(e){this._searchData=e,this._startTime=Date.now(),this.reset(),this.searchNextBlock()}},{key:"setDefSearchDirect",value:function(e){this._bNext=e}},{key:"toNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._curSearchSlt){var t=this._pres.selection,r=this._curSearchSlt.getState();if(e||t._data.textStream&&t._data.textStream.create_token===this._curSearchSlt.sourceToken&&t._data.begin===r.begin&&t._data.end===r.end){var n=this.getSearchSltIndex(),i=this.count;this._searchSltIndex=n===i-1?0:n+1,this.gotoResult(this._searchSltIndex),this.changeSltByItem(this._curSearchSlt),this.fire(T,{index:this.getSearchSltIndex()})}else this.changeSltByItem(this._curSearchSlt)}}},{key:"toPrev",value:function(){if(this._curSearchSlt){var e=this.getSearchSltIndex(),t=this.count;this._searchSltIndex=0===e?t-1:e-1,this.gotoResult(this._searchSltIndex),this.changeSltByItem(this._curSearchSlt),this.fire(T,{index:this.getSearchSltIndex()})}}},{key:"gotoResult",value:function(e){var t=this.resultAt(e);t&&(this._curSearchSlt=t.clone(),this._curSearchSlt.doObserver(!0))}},{key:"initSearchSlt",value:function(e){if(e){var t=this,r=this._pres,n=function(){var n=r.getSlideIdxById(e.getId());if(-1===n)return null;for(var i=r.getSlideCount(),a=i;a;){var o=e.getId(),s=t._sourceSequence[o];if(s&&s.length>0)for(var l=0;l<s.length;++l){var u=s[l].sourceToken,c=s[l].count;if(c>0){var h=t._bNext?0:c-1;return t._resultCache[u][h]}}n=t._bNext?n===i-1?0:n+1:0===n?i-1:n-1,e=r.getSlideAt(n),a--}return null}();n&&(this._curSearchSlt=n.clone(),this._curSearchSlt.doObserver(!0)),this.updateSearchSlt()}}},{key:"searchNextBlock",value:function(){if(this.toNextBlock()){var e=this._onSearchCurrentBlock(this._searchData);if(this._addNewResults(e),this._current=this._current+this._blockStep-1,this._current>=this._end)this._current=this._end+1,this._onSearchAtEnd(),this.initSearchSlt(this._pres.selection.getActiveSlide()),this._curSearchSlt||this.gotoResult(0),this._curSearchSlt&&this.changeSltByItem(this._curSearchSlt),this._usedTime=Date.now()-this._startTime,this.fire(g,this);else{var t=this;setTimeout((function(){t.searchNextBlock()}),0)}}}},{key:"discard",value:function(){this.reset(),this._searchData=null,this._current=-1,this._start=-1,this._end=-1,this._blockStep=1}},{key:"atEnd",value:function(){return this._current>this._end}},{key:"__coreDataChanged",value:function(e){this._onDataChanged(e)}},{key:"__updateValidCount",value:function(e){this._validCount=e}},{key:"_onResultItemChanged",value:function(e){this.fire(m,{searcher:this,item:e})}},{key:"_addNewResults",value:function(e){if(e){for(var t in e){var r=e[t],n=this._resultCache[t];if(this._updateSourceResults(t,r),n){this._validCount=this._validCount+r.length-n.length;for(var i=0;i<n.length;i++)n[i].discard(),this.fire(S,{searcher:this,item:n[i]})}else this._validCount=this._validCount+r.length;for(var a=0;a<r.length;a++){var o=r[a];o._searcher=this,this._onAddNewResult(o),this.fire(_,{searcher:this,item:o})}}this.updateSearchSlt()}}},{key:"_updateSourceResults",value:function(e,t){if(e){for(var r=!t||0===t.length,n=!1,i=Object.keys(this._sourceSequence),a=0;a<i.length;++a){var o=this._sourceSequence[i[a]];if(o)for(var s=0;s<o.length;s++){var l=o[s];if(l.sourceToken===e){n=!0,l.count=r?0:t.length;break}}}if(!n&&!r){var u=t[0].getState()&&t[0].getState().slideId;this._sourceSequence[u]||(this._sourceSequence[u]=[]),this._sourceSequence[u].push({sourceToken:e,count:t.length})}this._resultCache[e]=r?null:t}}},{key:"getSearchSltIndex",value:function(){}},{key:"updateSearchSlt",value:function(){}},{key:"_onReset",value:function(){}},{key:"_onSearchCurrentBlock",value:function(e){}},{key:"_onDataChanged",value:function(e){}},{key:"_onAddNewResult",value:function(e){}},{key:"_onSearchAtEnd",value:function(){}},{key:"count",get:function(){return this._validCount}}]),t}(h.a)),w=function(){function e(t){l()(this,e),this.pres=t,this._searchs={},this._searcherCreator={text:C}}return c()(e,[{key:"getSearcher",value:function(e){return this._searchs[e]}},{key:"ensureSearcher",value:function(e){var t=this._searchs[e];if(!t){var r=this._searcherCreator[e];r&&(t=new r(this),this._searchs[e]=t)}return t}},{key:"startNewSearch",value:function(e){var t=this._searchs[e];if(t)t.discard();else{var r=this._searcherCreator[e];r&&(t=new r(this),this._searchs[e]=t)}return t}},{key:"discardAll",value:function(){for(var e in this._searchs){this._searchs[e].discard()}this._searchs={}}}]),e}()},2245:function(e,t,r){"use strict";r.r(t),r.d(t,"color",(function(){return S})),r.d(t,"animation",(function(){return T})),r.d(t,"table",(function(){return b})),r.d(t,"format_brush",(function(){return k})),r.d(t,"Qt",(function(){return C})),r.d(t,"helper",(function(){return w}));var n=r(1258);r.d(t,"Slide",(function(){return n.a}));var i=r(1014);r.d(t,"Shape",(function(){return i.a}));var a=r(1149);r.d(t,"GroupShape",(function(){return a.default}));var o=r(1384);r.d(t,"ShapeTree",(function(){return o.a}));var s=r(1013),l=r(1146);r.d(t,"InkData",(function(){return l.b})),r.d(t,"getPtLength",(function(){return l.c}));var u=r(1147),c=r(2243),h=r(461);r.d(t,"utils",(function(){return h}));var d=r(762);r.d(t,"PlaceHolderHelper",(function(){return d.a}));var p=r(2261),f=r(201),v=r(204),y=r(167),g=r(1148),m=r(606),_=r(470);r.d(t,"TypeDefines",(function(){return _}));var S={Color:s.a,ColorType:s.c,TransformOperation:s.f,ScRgb:s.e,ColorSchemeData:s.b,interpretColorInner:s.g},T=Object.assign({AnimHelper:v.a},f),b={TableOpType:y.TableOPT,TableHelper:g.b},k={FormatBrushType:y.FormatBrushType,FormatHelper:c.a},C={QRect:m.a},w={getEditObjectPath:u.d,fillEditObjectPath:u.c,effectNodePath:u.b,collectPath:u.a,canGroup:p.a}},2246:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"BackgroundShape"))}return c()(t,e),o()(t,[{key:"isBackground",value:function(){return!0}},{key:"isChildShape",value:function(){return!1}}]),t}(r(1014).a);t.a=h},2247:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=function(){function e(t){i()(this,e),this._theme=t}return o()(e,[{key:"data",value:function(){return this._theme}},{key:"getFormatScheme",value:function(){this._formatScheme||(this._formatScheme=new u({}));var e=this._theme.baseStyle.formatScheme;return this._formatScheme.init(e),this._formatScheme}},{key:"getFontScheme",value:function(){this._fontScheme||(this._fontScheme=new l({}));var e=this._theme.baseStyle.fontScheme;return this._fontScheme.init(e),this._fontScheme}},{key:"getColorIndex",value:function(e){var t=this._theme.colorMapping;return t&&t[0][e]||0}},{key:"getColorAt",value:function(e){var t=this.getColorIndex(e),r=this._theme.baseStyle;if(r&&r.colorScheme){var n=r.colorScheme.colors;if((n=n||[]).length>t)return n[t]}return null}},{key:"getColorMapping",value:function(){this._colorMapping||(this._colorMapping=new c({}));var e=this._theme.colorMapping;return this._colorMapping.init(e),this._colorMapping}},{key:"getColorScheme",value:function(){this._colorScheme||(this._colorScheme=new h(e&&e.colorScheme||{}));var e=this._theme.baseStyle;return this._colorScheme.init(e&&e.colorScheme||{}),this._colorScheme}}],[{key:"getInstance",value:function(t){this._instance=this._instance||{};var r=t&&t.getId();t&&!this._instance[r]&&(this._instance[r]=new e({baseStyle:{},colorMapping:{}}));var n=this._instance[r];return n&&(n._theme=t&&t.getThemeData()),n}}]),e}();t.a=s;var l=function(){function e(t){i()(this,e),this.props=t||{}}return o()(e,[{key:"init",value:function(e){this.props=e||{}}},{key:"getDefaultFont",value:function(e){var t=e.themeIndex,r=this.props,n=r.majorFont,i=r.minorFont,a=n;return"minor"===t&&(a=i),a}},{key:"getFontAt",value:function(e){var t=e.themeIndex,r=e.themeScript,n=e.script,i=this.props,a=i.majorFont,o=i.minorFont;r&&(r="drawing.eastAsia"===r?"eastAsianFont":r.replace("drawing.","")+"Font");var s=a;"minor"===t&&(s=o);var l=s;if(s){var u=s.supplemental;if(n&&u)for(var c=0;c<u.length;c++){var h=u[c];if(h.script===n)return h.typeface}s=s[r]}var d=void 0;if(s&&(d=s.name),!d){if(l){var p=l.latinFont,f=l.eastAsianFont,v=l.complexScriptFont,y=l[r];if(d=y&&y.name)return d;if(p&&p.name)return p.name;if(f&&f.name)return f.name;if(v&&v.name)return v.name}d=r&&-1!==r.indexOf("eastAsia")?"":"Arial"}return d}}]),e}(),u=function(){function e(t){i()(this,e),this.props=t||{}}return o()(e,[{key:"init",value:function(e){this.props=e||{}}},{key:"getRealIndex",value:function(e){return e>=1e3?e-=1e3:e+=1,e}},{key:"getBackgroundFillAt",value:function(e){var t=this.props.backgroundFill;return t?(e=this.getRealIndex(e),t[Math.min(e,t.length-1)]):{type:0}}},{key:"getEffectsAt",value:function(e){var t=this.props.effects;return e<=0||!t||0===t.length?null:t[Math.min(e,t.length)-1]}},{key:"getFillAt",value:function(e){var t=this.props.fill;return e>=1e3?this.getBackgroundFillAt(e):t?t[Math.min(e,t.length-1)]:{type:0}}},{key:"getLineAt",value:function(e){var t=this.props.lines;return 0!==e&&t&&0!==t.length?t[Math.min(e,t.length)-1]:null}},{key:"getScene3dAt",value:function(e){var t=this.props.scene3d;return t?t[e]:null}},{key:"getShape3dAt",value:function(e){var t=this.props.shape3d;return t?t[e]:null}}]),e}(),c=function(){function e(t){i()(this,e),this.colorMapping=t}return o()(e,[{key:"init",value:function(e){this.colorMapping=e}},{key:"mapColor",value:function(e){var t=this.colorMapping&&this.colorMapping[0],r=t&&t[e];return Object.isEmpty(r)?e:r}}]),e}(),h=function(){function e(t){i()(this,e),this.colorScheme=t}return o()(e,[{key:"init",value:function(e){this.colorScheme=e}},{key:"getColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.colorScheme){var r=this.colorScheme.colors||[];if(r.length>e)return r[e]}return t||{type:0,isAutoColor:!1,sRgb:16777215,toRGB:"#00ffffff"}}}]),e}()},2248:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=(0,n.__importDefault)(r(1149)),a=r(3155),o=function(e){function t(t){var r=e.call(this,t)||this;return r.chartSha1="",r}return(0,n.__extends)(t,e),t.prototype.getChartData=function(){return this.private.chartData},t.prototype.getSha1=function(){return this.chartSha1},t.prototype.updateChartSha1=function(e){this.chartSha1=e},t.prototype.canAddTrendline=function(e,t){var r=this.getChartData().seriescollection,n=null;if(e===a.ChartElementType.TrendlineAddExponential||e===a.ChartElementType.TrendlineAddTwoPeriodMovingAverage){for(var i=0;i<r.length;++i){if(r[i].order===t){n=r[i];break}}if(!n)return!1;if(e===a.ChartElementType.TrendlineAddExponential){var o=!1;for(i=0;i<n.dataPoints.length;++i){var s=n.dataPoints[i];if(s.valid&&(o=!0,s.value<=0))return!1}return o}return n.dataPoints.length>2}return!0},t}(i.default);t.default=o},2249:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(543),d=r(446),p=r(262),f=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r}return c()(t,e),o()(t,[{key:"buildTree",value:function(e){this.parent=e;var t=this.private.timing;t&&t.buildTree(e);var r=this,n=this.private.textStyle;if(n){Object(h.d)(n,(function(e){e===r.private.textStyle&&r._fireTextStyleChanged()}));var i=this.getTextStyles();if(i)for(var a in i.private)Object(h.d)(i.private[a],(function(e){var t=r.getTextStyles();if(t)for(var n in t.private)if(t.private[n]===e){r._fireTextStyleChanged();break}}))}}},{key:"getTextStyles",value:function(){for(var e=this.private.textStyle;e&&e.private.proxy;)e=e.private.proxy;return e}},{key:"_fireTextStyleChanged",value:function(){var e=this.core;e&&e._bubbleUpEvent(p.default.modify_master_text_style,{data:e,optype:p.default.op_modify})}},{key:"_fireChanged",value:function(e){var t=this.core;t&&(t._syncFollowing(),t._fireChanged())}},{key:"getFollowId",value:function(){return this.private.followId}},{key:"setFollowId",value:function(e){this.private.followId!==e&&(this.setPropertyValue("followId",e),this.core._syncFollowing(),this.core._fireChanged())}},{key:"getThemeOverride",value:function(){return this.private.themeOverride}}]),t}(h.b);t.a=f,Object(d.e)(f.prototype,!1)},2250:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(543),d=r(446),p=r(875),f=r(204),v=r(201),y=r(262),g=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,Object(p.a)(r),r}return c()(t,e),o()(t,[{key:"buildTree",value:function(e){this.parent=e;var t=this.private.timeNodes;t&&t.buildTree(this);var r=this.private.builds;r&&r.buildTree(this)}},{key:"_firePreview",value:function(e){e&&e.length>0&&this._bubbleUpEvent(y.default.animation_preview,e)}},{key:"_fireChanged",value:function(){var e=this.private.timeNodes;e&&e.buildTree(this);var t=this.private.builds;t&&t.buildTree(this)}},{key:"setTimeline",value:function(e){this.private.timeNodes=e}},{key:"getBuilds",value:function(){return this.private.builds}},{key:"setBuilds",value:function(e){this.private.builds=e}},{key:"getTimeLine",value:function(){return this.private.timeNodes}},{key:"getIdByTimeNode",value:function(e){var t=this.getTimeLine();return this._findIdByTimeNode(t,e,1),1}},{key:"getTimeNodeById",value:function(e){var t=this.getTimeLine();return this._findById(t,e)}},{key:"mainSequence",get:function(){var e=this.private.timeNodes;return e||(e=f.a.createNode(v.AnimNodeType.TimingRoot),this.private.timeNodes=e),e?e.mainSequence:null}},{key:"timeLine",get:function(){return this.private.timeNodes}}]),t}(h.b);t.a=g,Object(d.e)(g.prototype,!1)},2251:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(1260),d=r(1716),p=r(201),f=r(167),v=r(262),y=r(315),g=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.private=e&&e.data||{},r}return c()(t,e),o()(t,[{key:"_bubbleUpEvent",value:function(e,t){v.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(y.a)():this.tree_token=Object(y.a)());var r=this.parent;r&&r._bubbleUpEvent&&r._bubbleUpEvent(e,t)}},{key:"interSeq",value:function(e){if(e<0||e>=this.length)return!1;for(var t=0;t<this.length;++t){var r=this.subNode(t);if(!r)return!1;if(r.type===p.AnimNodeType.InteractiveSeq)return r}return null}},{key:"insertInterSeq",value:function(e){if(e<0||e>this.length)return!1;var t=window.timing.createInstance(p.AnimNodeType.InteractiveSeq);return t.buildTree(this),t}},{key:"addMediaNode",value:function(e,t){var r=this.getMediaNode(e);return r||((r=new d.a({})).setProperty("fill",3),t===f.MediaDataType.MediaDataTypeMovie?r.setProperty("nodeType",10):r.setProperty("nodeType",9),r.setProperty("duration",0),r.setProperty("targetElType",3),r.setProperty("targetElement",e.getId()),r.setProperty("subItem",3),r.setProperty("display",1),r.setProperty("volume",500.5),t===f.MediaDataType.MediaDataTypeMovie&&r.setProperty("zoomFullScreen",0),r.setProperty("repeateCount",1),r.setProperty("targetDocument",1),this.insertSubNode(-1,r),r)}},{key:"getMediaNode",value:function(e){if(e)for(var t=0;t<this.length;++t){var r=this.subNode(t);if(r.isMediaNode&&r.getTargetShapeId()===e.getId())return r}}},{key:"removeAllShapeNodes",value:function(e){if(e){for(var t=e.getId(),r=this.length,n=[],i=0;i<r;i++){var a=this.subNode(i),o=a.getNodeType();if(o===p.AnimNodeType.MainSeq||o===p.AnimNodeType.InteractiveSeq)for(var s=a.length,l=0;l<s;++l){var u=a.subNode(l);u&&(u.getTargetShapeId()===t&&(a.deleteSubNode(l),n.push({type:"effect",nodePath:[i,l],node:u}),s-=1,l-=1))}else a.getTargetShapeId()===t&&(this.deleteSubNode(i),n.push({type:"media",nodePath:[i],node:a}),r-=1,i-=1)}return n.length>0?n:void 0}}},{key:"mainSequence",get:function(){for(var e=0;e<this.length;e++){var t=this.subNode(e);if(t.type===p.AnimNodeType.MainSeq)return t}return null}},{key:"interSeqCount",get:function(){for(var e=0,t=0;t<this.length;++t){this.subNode(t).type===p.AnimNodeType.InteractiveSeq&&e++}return e}},{key:"allInterSeq",get:function(){for(var e=[],t=0;t<this.length;++t){var r=this.subNode(t);r.type===p.AnimNodeType.InteractiveSeq&&e.push(r)}return e}}]),t}(h.a)},2252:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.shapeIds={},r}return c()(t,e),o()(t,[{key:"allEffects",value:function(){return this.childs}},{key:"getEffects",value:function(){return this.supportedEffects()}},{key:"getEffect",value:function(e){for(var t=[],r=0;r<this.length;++r){var n=this.childs[r];n.getTargetShapeId()===e&&t.push(n)}return t}},{key:"supportedEffects",value:function(){var e=this.childs,t=[];if(this.shapeIds={},e)for(var r=0;r<e.length;r++)t.push(e[r]);return t}},{key:"effectIndex",value:function(e){for(var t=this.childs.length,r=0;r<t;r++){var n=this.subNode(r);if(n&&n===e)return r}return-1}},{key:"insertEffect",value:function(e,t){this.insert(t,e)}},{key:"deleteEffect",value:function(e){for(var t=this.length,r=0;r<t;++r){this.subNode(r)===e&&this.deleteSubNode(r)}}},{key:"moveEffect",value:function(e,t){return this.moveSubNode(e,t)}},{key:"presetType",get:function(){return this.private.presetClass}},{key:"type",get:function(){return this.private.nodeType}}]),t}(r(1260).a)},2253:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(1260),d=r(201),p=r(2254),f=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.private=e.data||{},r}return c()(t,e),o()(t,[{key:"getTriggerObj",value:function(){return this.private.triggerObj}},{key:"getShapeId",value:function(){return this.private.targetShapeId}},{key:"getpresetType",value:function(){return this.private.presetType}},{key:"getType",value:function(){return this.private.presetType}},{key:"getPresetClass",value:function(){return this.private.presetClass}},{key:"getCategory",value:function(){return this.private.animCategory}},{key:"getTiming",value:function(){var e=this.parent;if(!e)return null;var t=e.parent;return t?t.parent:null}},{key:"getGroupId",value:function(){return this.private.groupID}},{key:"setGroupId",value:function(e){this.private.groupID=e}},{key:"isEntrance",value:function(){return this.private.animCategory?this.private.animCategory===d.AnimCategory.Entrance:null}},{key:"gettargetShapeId",value:function(){return this.private.targetShapeId}},{key:"getBehaviors",value:function(){return this.childs}},{key:"getEnhanceBehaviors",value:function(){return[]}},{key:"getTimerProperty",value:function(){return this.private.timer}},{key:"getInfoProperty",value:function(){return this.private.info}},{key:"setInfoProperty",value:function(e){return this._modifyPrivate("info",e,!0)}},{key:"setParaStart",value:function(e){for(var t=0;t<this.length;++t){this.subNode(t).setProperty("paraStart",e)}}},{key:"setParaEnd",value:function(e){for(var t=0;t<this.length;++t){this.subNode(t).setProperty("paraEnd",e)}}},{key:"getPlayProperty",value:function(){return this.private.play}},{key:"setPlayProperty",value:function(e){return this._modifyPrivate("play",e,!0)}},{key:"getSetProperty",value:function(){return this.private.set}},{key:"getDirection",value:function(){var e=this.private.set;if(e)return e.direction}},{key:"findBuildLevel",value:function(){var e=this.getTiming();if(!e)return d.AnimLevel.LevelMixed;var t=e.getBuilds();if(!t)return d.AnimLevel.LevelMixed;var r=this.getGroupId();if(-1===r)return d.AnimLevel.LevelMixed;var n=this.getShapeId(),i=t.getBuildByIndex(n,r);if(!i)return d.AnimLevel.LevelMixed;switch(i.getBuildType()){case d.AnimBuildType.AsWhole:return d.AnimLevel.LevelNone;case d.AnimBuildType.AllAtOnce:return d.AnimLevel.TextByAllLevels;case d.AnimBuildType.ByParagraph:var a=i.getBuildLevel();return d.AnimLevel.TextByAllLevels+a;default:return d.AnimLevel.LevelMixed}}},{key:"hasPara",value:function(){for(var e=0;e<this.length;++e){var t=this.subNode(e).getPropertyValue("paraStart");if(!Object.isEmpty(t))return!0}return!1}},{key:"createBuilds",value:function(){return new p.a({data:{}})}},{key:"setBuildLevel",value:function(e){var t=this.getTiming();if(!t)return!1;var r=t.getBuilds();r||(r=this.createBuilds(),t.setBuilds(r));var n=this.getGroupId();if(-1!==n){var i=this.getShapeId(),a=r.getTargetBuild(i,n);if(!a)return!1;e===d.AnimLevel.LevelNone?a.setBuildType(d.AnimBuildType.AsWhole):e===d.AnimLevel.TextByAllLevels?a.setBuildType(d.AnimBuildType.AllAtOnce):e>d.AnimLevel.TextByAllLevels&&(a.setBuildType(d.AnimBuildType.ByParagraph),a.setBuildLevel(e-d.AnimLevel.TextByAllLevels))}return!0}},{key:"modifySetProperty",value:function(e){return this._modifyPrivate("set",e)}},{key:"modifyTimerProperty",value:function(e){return this._modifyPrivate("timer",e)}},{key:"modifyInfoProperty",value:function(e){return this._modifyPrivate("info",e)}},{key:"modifyPalyProperty",value:function(e){return this._modifyPrivate("paly",e)}},{key:"isMedia",get:function(){return this.getCategory()===d.AnimCategory.MediaCall}},{key:"isTriggerEffect",get:function(){return null!=this.private.triggerType}}]),t}(h.b)},2254:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return g}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(1715),d=r(543),p=r(201),f=r(446);function v(e){return new y(e)}var y=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data||{},r}return c()(t,e),o()(t,[{key:"buildTree",value:function(e){this.parent=e}},{key:"getShapeId",value:function(){return this.private.shapeId}},{key:"getGroupId",value:function(){return this.private.groupId}},{key:"getBuildType",value:function(){return this.private.buildType}},{key:"getBuildLevel",value:function(){return this.private.buildLevel}},{key:"setBuildType",value:function(e){this.setPropertyValue("buildType",e)}},{key:"setBuildLevel",value:function(e){this.setPropertyValue("buildLevel",e)}}]),t}(d.a),g=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data||{},r}return c()(t,e),o()(t,[{key:"buildTree",value:function(e){var t=this;this.parent=e,this.childs.forEach((function(e){e.buildTree(t)}));var r=this.private.container;r.core||(r.core=this)}},{key:"_fireChanged",value:function(){}},{key:"getCount",value:function(){return this.childs.length}},{key:"getOneShapeCnt",value:function(e){for(var t=e.getId(),r=0,n=0;n<this.childs.length;n++){var i=this.childs[n];if(i)i.getShapeId()==t&&r++}return r}},{key:"getBuildByIndex",value:function(e,t){for(var r=0,n=0;n<this.childs.length;n++){var i=this.childs[n];if(i)if(i.getShapeId()!=e);else{if(r==t)return i;r++}}return null}},{key:"addBuild",value:function(e){var t=null;switch(e){case p.AnimBuildCategory.BuildParagraph:t=this._createParagraph();break;case p.AnimBuildCategory.BuildDiagram:t=this._createDiagram();break;case p.AnimBuildCategory.BuildGraphic:t=this._createGrahic();break;case p.AnimBuildCategory.BuildOleChart:t=this._createChart()}return t&&t.setCategory(e),this._addSubNode(this.childs.length,t),t}},{key:"maxGroupId",value:function(){for(var e=-1,t=this.childs,r=0;r<t.length;r++){var n=t[r].getGroupId();n>e&&(e=n)}return e}},{key:"_removeSubNode",value:function(e){this.container.removeAt(e)}},{key:"_addSubNode",value:function(e,t){this.container.insert(e,t)}},{key:"removeByShape",value:function(e,t){for(var r=0;r<this.childs.length;r++){var n=this.childs[r];if(n)if(n.getShapeId()==e)this._removeSubNode(r),n.getGroupID()==t&&this._removeSubNode(r)}}},{key:"getTargetBuild",value:function(e,t){for(var r=this.childs,n=0;n<r.length;++n){var i=r[n];if(i.getShapeId()===e)if(t===i.getGroupId())return i}return null}},{key:"childs",get:function(){var e=this.private.container;if(!e){this.private.container=new h.a({data:[]}),e=this.private.container}return e.core||(e.core=this),e.vector}},{key:"container",get:function(){var e=this.private.container;if(!e){this.private.container=new h.a({data:[]}),e=this.private.container}return e.core||(e.core=this),e}}]),t}(d.a);Object(f.e)(y.prototype,!1)},2255:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"getToValue",value:function(){return this.private.to}},{key:"getToType",value:function(){return this.private.toType}},{key:"setToValue",value:function(e){this.setPropertyValue("to",e)}},{key:"setToType",value:function(e){this.setPropertyValue("toType",e)}}]),t}(r(764).a)},2256:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(25),i=r.n(n),a=r(42),o=r.n(a),s=r(0),l=r.n(s),u=r(3),c=r.n(u),h=r(764),d=0,p=function(){function e(t){l()(this,e),this.value=t}return c()(e,[{key:"getType",value:function(){return d}},{key:"getValue",value:function(){return this.value}}]),e}(),f=function(){function e(t){l()(this,e),this.obj=t}return c()(e,[{key:"getTime",value:function(){return this.obj.time}},{key:"getValue",value:function(){return new p(this.obj.value)}},{key:"getFormula",value:function(){return this.obj.formula}}]),e}(),v=function(e){function t(e){return l()(this,t),i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o()(t,e),c()(t,[{key:"getCalcMode",value:function(){return this.private.calcMode}},{key:"getCalcType",value:function(){return this.private.calcType}},{key:"getValueType",value:function(){return this.private.valueType}},{key:"getTimeValues",value:function(){return this._getTimeVals()}},{key:"_getTimeVals",value:function(){if(!this.timevalues){var e=this.private.keyValues;if(e){var t=e.length;this.timevalues=new Array(t);for(var r=0;r<t;r++)this.timevalues[r]=new f(e[r])}}return this.timevalues}},{key:"getFrom",value:function(){return this.private.from}},{key:"getTo",value:function(){return this.private.to}},{key:"getBy",value:function(){return this.private.by}}]),t}(h.a)},2257:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"setColorTo",value:function(e){this.setPropertyValue("colorTo",e)}},{key:"setColorType",value:function(e){this.setPropertyValue("colorType",e)}}]),t}(r(764).a)},2258:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"setByAngle",value:function(e){this.setPropertyValue("byAngle",e)}}]),t}(r(764).a)},2259:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"setByX",value:function(e){this.setPropertyValue("byX",e)}},{key:"setByY",value:function(e){this.setPropertyValue("byY",e)}}]),t}(r(764).a)},2260:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(0),i=r.n(n),a=r(25),o=r.n(a),s=r(42),l=r.n(s),u=function(e){function t(e){return i()(this,t),o()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l()(t,e),t}(r(764).a)},2261:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(158);function i(e){if(!e||e.length<1)return{errtype:"INVALID_SHAPES"};if(1===e.length)return{errtype:"ONE_SHAPE"};for(var t=0;t<e.length;++t)if(null!=e[t].getTags())return{errtype:"HAS_TAGS"};for(var r=null,i=null,a=[],o=0;o<e.length;o++){var s=e[o];if(!s)return{errtype:"INVALID_SHAPES",error:"group shapes failed!"};var l="",u=s.private.flags;if(s.isPlaceHolder()?l="PLACEHOLDER":u&&u.isOleControlShape?l="OLE_CONTROL":s.getShapeType()===n.ShapeType.Table?l="TABLE":s.hasSmartArt()&&(l="SMART_ART"),""!==l)return{errtype:l};var c=s.visual.getRootShape();if(c&&a.indexOf(c)<0){a.push(c);var h=c.getSlide();if(!h)return{errtype:"INVALID_SHAPES",error:"group shapes failed, cannot find slide!"};if(r){if(r!==h)return{errtype:"INVALID_SHAPES",error:"group shapes failed, shapes not in same slide!"};if(i!==s.getParent())return{errtype:"HAS_GROUPED",error:"group shapes failed, contains child shape!"}}else i=(r=h).getShapeTree()}}return a.length>1?{errtype:"NOERROR",slide:r,shapetree:i,shapes:a}:{errtype:"HAS_GROUPED"}}},2262:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(167),l=r(1860),u=r(1014),c=r(1147),h=r(1383),d=function(){function e(){i()(this,e)}return o()(e,null,[{key:"applyShapesBeautify",value:function(t,r){var n=r.uploadId,i=r.shapes;if(!i||i.length<=0)return{err:s.WppErrStr.E_WPP_INVALID_IN_PARAMETER};var a=t.parent,o=window.getTransaction(),u=a.getPresentation();o.beginBatchCommand();var h=a.getActiveSlide(),d=h&&u.getSlideIdx(h);if(null==d)return{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};var p=function(e){for(var t=void 0,r=h.getShapeTree().childShapes,n=!1,i=0;i<r.length;++i){for(var a=0;a<e.length;++a)if(e[a].getId()===r[i].getId()){t=r[i],n=!0;break}if(n)break}return Object(c.d)(u,t).shapePath}(i),f={beautifyType:s.WppBeautifyType.Shape,uploadId:n,state:s.SelectType.select_shape,slideIdx:d,shapePath:p,bOnlyServerCmd:!0,category:a.category(),layerType:a.layerType(),commands:this._createDeleteShapeCmd(u,i)};u.on(l.a.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,e.onDocumentBeautfiyEnd),a.startDocumentBeautifyCommand(f),f.genid&&o.setUserData("genid",f.genid),o.setCooperHandler("beautifyHandler"),o.addCommand("documentBeautify",f),o.addServerOnlyAffects(["shapeInsert","shapeDelete","shapeMove","shapeGroup","shapeUngroup","slideInsert","slideDelete","slideMove"]),o.endBatchCommand()}},{key:"insertDiagram",value:function(t,r,n){if(!r)return{err:s.WppErrStr.E_WPP_INVALID_IN_PARAMETER};var i=t.parent,a=i.getPresentation(),o=i.transaction,u=i.getActiveSlide();if(!u)return{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};var c=i.presentation.getSlideIdx(u),h=u.getShapeCount();o.beginBatchCommand();var d={beautifyType:s.WppBeautifyType.Shape,uploadId:r,fileKey:n,state:s.SelectType.select_shape,slideIdx:c,shapePath:[h],bOnlyServerCmd:!0,commands:[],category:i.category(),layerType:i.layerType()};a.on(l.a.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,e.onDocumentBeautfiyEnd),i.startDocumentBeautifyCommand(d),d.genid&&o.setUserData("genid",d.genid),o.setCooperHandler("beautifyHandler"),o.setUserData("bInsert",!0),o.addCommand("documentBeautify",d),o.addServerOnlyAffects(["shapeInsert","shapeDelete","shapeMove","shapeGroup","shapeUngroup","slideInsert","slideDelete","slideMove"]),o.endBatchCommand()}},{key:"applySlideBeautify",value:function(t,r,n){if(!r)return{err:s.WppErrStr.E_WPP_INVALID_IN_PARAMETER};var i=t.parent,a=i.presentation,o=i.transaction,u=i.getActiveSlideProxys();if(!u||0===u.length)return{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};u.sort((function(e,t){return t.idx-e.idx}));var c=u[u.length-1].idx;if(c<0)return console.error("Invalid slideIdx, callName: applySlideBeautify !"),{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};var h=this._createDeleteSlideCmds(a,u);if(h.err)return{err:h.err};var d={beautifyType:s.WppBeautifyType.Slide,uploadId:r,fileKey:n,state:s.SelectType.select_slide,slideIdx:c,bOnlyServerCmd:!0,commands:h,category:i.category(),layerType:i.layerType()};a.on(l.a.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,e.onDocumentBeautfiyEnd),o.beginBatchCommand(),i.startDocumentBeautifyCommand(d),d.genid&&o.setUserData("genid",d.genid),o.setCooperHandler("beautifyHandler"),o.addCommand("documentBeautify",d),o.addServerOnlyAffects(["slideInsert","slideDelete","slideMove"]),o.endBatchCommand()}},{key:"onDocumentBeautfiyEnd",value:function(t){if(t&&(!t.err||-1!==t.err)){var r=t.param,n=r.data.beautifyType,i=r.data.fakeCmds;if(i)switch(n){case s.WppBeautifyType.Shape:return e._onBeautifyShapes(i);case s.WppBeautifyType.Slide:return e._onBeautifySlides(i);case s.WppBeautifyType.Presentation:return e._onBeautifyPresentation(i)}}}},{key:"_onBeautifyShapes",value:function(e){if(e)for(var t=window.selection.getActiveSlide().getPresentation(),r=0;r<e.length;++r){var n=e[r];if("shapeInsert"===n.name){var i=t.getBuddy().fetchShape(n.param);if(i&&i.isDiagramShape()){window.selection.selectShape(i);break}}}}},{key:"_onBeautifySlides",value:function(e){if(e)for(var t=0;t<e.length;++t){var r=e[t];if("slideInsert"===r.name){var n=r.param.slideIdx;window.selection.selectSlideAt(n);break}}}},{key:"_onBeautifyPresentation",value:function(e){}},{key:"getDiagramIdFromTransaction",value:function(e){var t=e.transaction.rpt.transacts,r=t&&t[t.length-1];if(!r||!r.isSelf)return null;var n=r&&r.mainOperstes,i=void 0;for(var a in n){for(var o=n[a],s=0;s<o.length;++s)if("documentBeautify"===o[s].name){i=!0;break}if(i)break}if(!i)return null;for(var l=void 0,c=r.operates,d=0;d<c.length;++d)if(c[d].obj instanceof u.a&&4===c[d].opType){var p=c[d].obj;l=new h.b(p.getTags()).getRootDiagramId();break}return l}},{key:"_createDeleteShapeCmd",value:function(e,t){if(!t||t.length<=0)return{err:s.WppErrStr.E_WPP_INVALID_IN_PARAMETER};for(var r=[],n=t[0].getSlide(),i=e.getSlideIdx(n),a=0;a<t.length;++a){var o=t[a],l={name:"shapeDelete"},u={};u.slideIdx=i,u.bOnlyServerCmd=!0;var h=Object(c.d)(e,o);u.shapes=[h],l.param=u;for(var d=0;d<r.length;++d){var p=r[d].param,f=p.shapes&&p.shapes[0];f||console.error("Invalid shape, call: applyShapesBeautify!!");var v=f&&f.shapePath[0];if(h.shapePath[0]>v){r.splice(d,0,l);break}}d===r.length&&r.push(l)}return r}},{key:"_createDeleteSlideCmds",value:function(e,t){if(!t||0===t.length)return console.error("invalid slides !!"),{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};for(var r=[],n=0;n<t.length;++n){var i=t[n],a=e.getSlideAt(i.idx);if(a){var o=a.getCategory();if("slides"!==o)return console.error("Unsupported operateion: deleteSlide in category "+o),{err:s.WppErrStr.E_WPP_INVALID_SELECT_STATE};if(!e.slides.isAllLoaded())return console.log("wait for all slides loaded!!!"),{err:s.WppErrStr.E_WPP_SLIDES_UNLOADED};var l=i.idx,u=a.getId(),c=null,h=a.getMaster();h&&h.isMasterSlide&&(c=h.getId()),r.push({name:"slideDelete",param:{bOnlyServerCmd:!0,category:o,slideIdx:l,slideProps:{slideId:u,masterId:c,name:a.getName()}}})}}return r}}]),e}()},2263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseSlideShell=void 0;var n=r(143),i=r(1016),a=r(4285),o=r(2264),s=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"Tags",{get:function(){return new a.TagsShell(this.coreData.getTags(),this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SlideId",{get:function(){return this.coreData.getId()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SlideIndex",{get:function(){var e=this.parent,t=e&&e.coreData;return t&&t.getSlideIdx(this.coreData)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Shapes",{get:function(){var e=this.private.shapeTree;return e&&e.Shapes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Background",{get:function(){return this.private.background},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NotesPage",{get:function(){return this.private.notesPage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Hyperlinks",{get:function(){for(var e=new o.HyperlinksShell([]),t=this.Shapes,r=0;r<t.Count;++r){var n=t.Item(r).GetHyperlinks();n&&e.concat(n)}return e},enumerable:!1,configurable:!0}),t.prototype.buildTree=function(e){var t=this.coreData;if(t){for(var r=t.private.childs,n=0;n<r.length;++n){var i=r[n],a=void 0;i.isShapeTree?(a=window.APP.shellFactory.create(i,"shapeTree"),this.private.shapeTree=a):i.isNotesPage?(a=window.APP.shellFactory.create(i,"notesPage"),this.private.notesPage=a):i.isBackground&&(a=window.APP.shellFactory.create(i,"background"),this.private.background=a),a&&(a.buildTree&&a.buildTree(this))}this.parent=e}},t}(i.IShell);t.BaseSlideShell=s},2264:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinksShell=void 0;var n=function(){function e(e){this.hyperlinks=e}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.hyperlinks.length},enumerable:!1,configurable:!0}),e.prototype.Item=function(e){return this.hyperlinks&&this.hyperlinks[e]},e.prototype.concat=function(e){e&&(this.hyperlinks=this.hyperlinks.concat(e.hyperlinks))},e}();t.HyperlinksShell=n},2265:function(e,t,r){e.exports=function(e,t){r.e(223).then(r.bind(null,4200)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},237:function(e,t,r){"use strict";r.r(t);var n=r(146),i=r(335),a=r(158),o=n.default.cooper,s=n.default.names,l=n.default.dispatchEvent,u=Math.round(100*Math.random());function c(e){return e+ ++u}var h={DOC_SELECTION_CHANGED:"wpp.selectionChanged",DOC_READONLY_SELECTION_CHANGED:"wpp.readonly.selectionChanged",DOC_COOPERATION_MODE_TOGGLED:"wpp.update.coopinfo",DOC_COOPINFO_UPDATED:"wpp.coopinfo.updated",DOC_SCROLL_INTO_VIEW:"wpp.scroll.into.view",DOC_SHOW_FIND_PANEL:"wpp.show.find.panel",DOC_SHOW_REPLACE_PANEL:"wpp.show.replace.panel",DOC_FIND_RESULT:"wpp.find.result",DOC_REPLACE_RESULT:"wpp.replace.result",DOC_WORKSPACE_SCROLL:"wpp.workspace.scroll",WPP_SHOW_CONTEXT_MENU:"wpp.show.context.menu",WPP_SHOW_READONLY_CONTEXT_MENU:"wpp.show.readonly.context.menu",WPP_CLOSE_CONTEXT_MENU:"wpp.close.context.menu",WPP_SHOW_CONTEXT_MENU_IN_WRAP:"wpp.show.context.menu.in.wrap",CLIPBOARD_COPY:"CLIPBOARD_COPY",CLOSE_DROPDOWN_PANEL:"CLOSE_DROPDOWN_PANEL",ON_OPEN_IMAGE_VIEWER:"wpp.slide.openImageViewer",ON_IMAGE_VIEWER_MSG:"wpp.slide.ImageViewerMsg",ON_IMAGE_VIEWER_DID_MOUNT:"on_image_viewer_did_mount",REQ_OPEN_INK_EDITOR:"wpp.open.ink.editor",ON_OPEN_INK_EDITOR:"wpp.ink.editor.open",ON_CLOSE_INK_EDITOR:"wpp.ink.editor.close",ON_UPDATE_INK_EDITOR:"wpp.update.ink.editor",ON_SHOW_INK_STYLEPANEL:"wpp.show.ink.stylepanel",ON_HIDE_INK_STYLEPANEL:"wpp.hide.ink.stylepanel",ON_TOGGLE_INK_VISIBLE:"wpp.toggle.ink.visible",ON_TOGGLE_INK_MODAL_VISIBLE:"wpp.ink.modal.visible",ON_SHOW_DEL_INK_MODAL:"wpp.ink.del.ink.modal",ON_CHANGE_MASTER_VIEW:"wpp.change.master.view",ON_COMMENT_CHANGE:"comment_notify",ON_SHOW_EDIT_PANEL:"on_show_edit_panel",SHOW_FUNCGUIDES_MOBILE_EDIT:"SHOW_FUNCGUIDES_MOBILE_EDIT",WPP_GUEST_CONFIRM_LOGIN:"WPP_GUEST_CONFIRM_LOGIN",ON_SLIDE_CHANGE:"wpp.slide.change",REQ_OPEN_LASERPEN:"wpp.toggle.laserpen",ON_GET_MEDIA_PLAY_MSG:"on_get_media_play_msg",ON_VIDEO_FULLSCREEN:"on_video_fullscreen",ON_TOGGLE_REMARKS_VIEW:"on_toggle_remarks_view",ON_POST_REMARKS_DATA:"on_post_remarks_data",ON_GET_REMARKS_LASERPEN:"on_get_remarks_laserpen",NOTIFY_LASERPEN_UPDATE:c("n_u_"),NOTIFY_INK_BTN_PERMISION:c("n_u_"),DOC_INIT_DONE:c("n_u_"),NOTIFY_FULLSCREEN_ENTER:"wpp.play.enter.fullscreen",NOTIFY_FULLSCREEN_EXIT:"wpp.play.exit.fullscreen",ON_EDITVIEW_SCROLL_UPDATE:"on_editview_scroll_update",ON_EDITVIEW_SCROLL_UPDATE_BASE_PREV:"on_editview_scroll_update_base_prev",ON_SELECT_CONTACT:"on_select_contact",ON_COMMENT_FOCUS:"on_comment_focus",ON_COMMENT_BLUR:"on_comment_blur",ON_REPLY_FOCUS:"on_reply_focus",ON_COMMENT_ITEM_MOUSEENTER:"on_comment_item_mouseenter",ON_COMMENT_ITEM_MOUSElEAVE:"on_comment_item_mouseleave",ON_COMMENT_ITEM_DELETE:"on_comment_item_delete",ON_TOGGLE_EXPLAIN_VIEW:c("e_"),CHANGE_EXPLAIN_TYPE:c("e_"),EXPLAIN_ZAN_STATUS_CHANGE:c("e_"),EXIT_AUTOPALY_MODE:c("e_"),MEDIA_PLAY_UIL_LOADED:"media_play_uil_loaded",NOTIFY_ON_LAST_SLIDE:"NOTIFY_ON_LAST_SLIDE",ON_CONTROL_HIDE:"ON_CONTROL_HIDE",UIL_VIEW_DID_MOUNT:"uil_view_did_mount",ON_EXIT_IMAGE_VIEWER:"on_exit_image_viewer",ON_STOP_KEY_EVENT:"on_stop_key_event"},d={names:h,guideTips:f,mobile:{ON_WP_SLIDE_CHANGE:"ON_WP_SLIDE_CHANGE",ON_THUMB_SLIDE_CHANGE:"ON_THUMB_SLIDE_CHANGE",ON_THUMBNAIL_SCROLL:"ON_THUMBNAIL_SCROLL",ON_SWITCH_TO_PREVIEW:"ON_SWITCH_TO_PREVIEW",ON_SWITCH_TO_PLAY:"ON_SWITCH_TO_PLAY",PREVIEW_THUMBNAIL_UPDATE:"PREVIEW_THUMBNAIL_UPDATE",PREVIEW_ON_MEDIA_PLAY:"PREVIEW_ON_MEDIA_PLAY",EDITPAGE_REPLACE_IMAGE:"EDITPAGE_REPLACE_IMAGE",EDITPAGE_EDIT_QRCODE:"EDITPAGE_EDIT_QRCODE",EDITPAGE_KEEP_INPUT_FOCUS:"EDITPAGE_KEEP_INPUT_FOCUS",EDITPAGE_TOGGLE_TOOLTABS:"EDITPAGE_TOGGLE_TOOLTABS",EDITPAGE_LAYOUT_PREPARED:"EDITPAGE_LAYOUT_PREPARED",EDITPAGE_CLOSE_MENU:"EDITPAGE_CLOSE_MENU",EDITPAGE_SHOW_FULLPANEL:"EDITPAGE_SHOW_FULLPANEL",EDITPAGE_SCROLL_SVG_THUMBNAIL:"EDITPAGE_SCROLL_SVG_THUMBNAIL",EDITPAGE_CHANGE_SLIDE:"EDITPAGE_CHANGE_SLIDE",EDITPAGE_REFRESH_SVG_THUMBNAIL:"EDITPAGE_REFRESH_SVG_THUMBNAIL",EDITPAGE_BEEN_COVERED:"EDITPAGE_BEEN_COVERED",ON_MEIDA_CLICK:"ON_MEIDA_CLICK",ON_MEDIA_PLAY:"ON_MEDIA_PLAY",ON_MEDIA_DESTROY:"ON_MEDIA_DESTROY",ON_VIDEO_DESTROY:"ON_VIDEO_DESTROY",ON_PLAY_AUDIO_CLICK:"ON_PLAY_AUDIO_CLICK",ON_PLAY_VIDEO_CLICK:"ON_PLAY_VIDEO_CLICK",ON_MENU_MEDIA_CLICK:"ON_MENU_MEDIA_CLICK",ON_MORE_VISIBLE_CHANGE:"ON_MORE_VISIBLE_CHANGE",ON_SHOW_DIALOG:"ON_SHOW_DIALOG",ON_TOGGLE_REVIEW:"m_wpp_toggle_review",ON_TOGGLE_EDIT_MODE:"ON_TOGGLE_EDIT_MODE",ON_VOICE_COMMENT_PLAY:"ON_VOICE_COMMENT_PLAY",ON_HYPERLINK_CLICK:"ON_HYPERLINK_CLICK",ON_SHOW_HYPERLINK_PANEL:"ON_SHOW_HYPERLINK_PANEL",ON_TOUCH_SCALE:"ON_TOUCH_SCALE",ON_PLAY_AUTO_SWITCH_BANED:"ON_PLAY_AUTO_SWITCH_BANED",ON_MEDIA_AVAILABLE:"ON_MEDIA_AVAILABLE",ON_PLAY_END:"ON_PLAY_END"},pc:{ON_REMARK_VISIBLE_CHANGE:"ON_REMARK_VISIBLE_CHANGE",ON_THUMBNAIL_RESIZE:"ON_THUMBNAIL_RESIZE",ON_THUMBNAIL_SCROLL:"ON_THUMBNAIL_SCROLL",ON_START_PLAY:"ON_START_PLAY",ON_TEMPLATE_VISIBLE_CHANGE:"ON_TEMPLATE_VISIBLE_CHANGE",ON_INSERT_SLIDE:"ON_INSERT_SLIDE",ON_SET_ACTIVE_SLIDE:"ON_SET_ACTIVE_SLIDE",ON_PANEL_VISIBLE:"ON_PANEL_VISIBLE",ON_PREVIEW_START:"ON_PREVIEW_START",ON_PREVIEW_STOP:"ON_PREVIEW_STOP",ON_EDITVIEW_RESIZE_ZOOM:"ON_EDITVIEW_RESIZE_ZOOM",ON_SET_SLIDEBAR_TAB:"ON_SET_SLIDEBAR_TAB",ON_DOWNLOAD_PICTURE:"ON_DOWNLOAD_PICTURE",ON_DOWNLOAD_ACTIVE_PICTURE:"ON_DOWNLOAD_ACTIVE_PICTURE",ON_TASKPANE_VISIBLE:"ON_TASKPANE_VISIBLE",ON_MATERIAL_VISIBLE:"ON_MATERIAL_VISIBLE",ON_REMARK_VIEW_UNSUPPORT:"ON_REMARK_VIEW_UNSUPPORT",OPEN_REMARK_VIEW_AUDIENCE:"open_remark_view_audience",ON_WPP_IMAGE_CLIP:"ON_WPP_IMAGE_CLIP",ON_CLIP_START:"ON_CLIP_START",ON_CLIP_END:"ON_CLIP_END",TEXTTOOL_DROPDOWN_MENU:"texttool_dropdown_menu",ON_EDITVIEW_SCROLL:"on_editview_scroll",ON_RIGHT_TASKBAR_TOGGLED:"ON_RIGHT_TASKBAR_TOGGLED",CLOSE_TASK_PANEL:"close_task_panel",ON_CANVAS_RESIZE:"ON_CANVAS_RESIZE",ON_EDITVIEW_SCROLL_X:"on_editview_scroll_x",ON_EDITVIEW_SCROLL_Y:"on_editview_scroll_y",UPDATE_EDITVIEW_SCROLL:"update_editview_scroll",ON_INSERT_COMMENT:"on_insert_comment",ON_CLOSE_MATERIAPANEL:"on_close_materiapaner",ON_EDIT_QRCODE:"on_edit_qrcode",picture:{ON_PICTURE_INSERT:c("p_i_"),ON_PICTURE_LOADING:c("p_i_"),ON_DOC_PICTURE_INSERT:c("p_i_"),ON_PICTURE_REPLACE:c("p_i_"),ON_PICTURE_FILE_UPLOAD:c("p_i_")},link:{ON_LINK_INSERT:c("p_l_"),UPDATE_FLOAT_LINK:c("p_l_"),OPEN_LINK_TO_SLIDE:c("p_l_"),OPEN_COPY_LINK_MODAL:c("p_l_"),ON_OPEN_LINK:c("p_l_"),ON_LINK_INSERT_CLOSE:c("p_l_")},play:{CLICK_EXIT_FULLSCREEN:c("p_v_"),CLICK_LANCH_FULLSCREEN:c("p_v_"),CLICK_END_PLAY:c("p_v_"),CLICK_SHOW_PAGE:c("p_v_"),CLICK_AUTO_PLAY_MODE:c("p_v_"),CLICK_START_AUTO_PLAY:c("p_v_"),CLICK_STOP_AUTO_PLAY:c("p_v_"),CLICK_SHOW_MORE:c("p_v_"),CLICK_SHOW_MINI_THUMBNAIL:c("p_v_"),CLICK_CLOSE_MINI_THUMBNAIL:c("p_v_"),CLICK_SHOW_TOOLBAR:c("p_v_"),CLICK_OPEN_INK_EDITOR:h.ON_OPEN_INK_EDITOR,CLICK_TOGGLE_INK_VISIBLE:h.ON_TOGGLE_INK_VISIBLE,CLICK_CONTAINER_DIV:c("p_v_"),CLICK_SHOW_SET_COUNTDOWN:c("p_v_"),CLICK_CLOSE_SET_COUNTDOWN:c("p_v_"),CLICK_SHOW_TIME_COUNT:c("p_v_"),START_RESIZE_REMARKS_AREA:c("p_v_"),ON_RESIZE_REMARKS_AREA:c("p_v_"),STOP_TOOLBAR_MOUSE_MOVE_EVENT:c("p_v_"),CLICK_RESIZE_FULLSCREEN:c("p_v_")},readonly:{PEVIEW_ORIGIN_PICTURE:"PEVIEW_ORIGIN_PICTURE"},media:{ON_MEDIA_INSERT:c("p_m_")},ON_FULLSCREEN_CHANGE:"onFullscreenChange",master:{ON_MASTER_SLIDE_SELECT_CHANGE:"on_master_slide_select_change"},CLICK_PROPSNAV_CHANGE:c("c_b_"),CLICK_PROPSNAV_CLOSE:c("c_b_"),MOVING_SHAPE_BOX:"moving_shape_box",ON_FORMAT_BRUSH_CHANGE:"on_format_brush_change",ON_FORMAT_BRUSH_CLICK:"on_format_brush_click",BEFORE_CHANGE_SELECT:"before_change_select",SET_MEDIA_TOOL_CONTAINER:"set_media_tool_container",MEDIA_TOOL_DID_MOUNT:"media_tool_did_mount",UPDATE_WATER_DROP_STATUS:"update_water_drop_status",RENDER_LAYOUT:"render_layout",UN_RENDER_LAYOUT:"un_render_layout",OPEN_LATEX_PANEL:"open_latex_panel",OPEN_CHART_EDIT_PANEL:"open_chart_edit_panel",CHART_EDIT_VISIBLE_CHANGE:"chart_edit_visible_change",ON_HOVER_PREVIEW_PANEL:"on_hover_preview_panel",UPDATE_FLOAT_MENU:"update_float_menu",ON_RESIZE_TOOLTIP_SHOW:c("r_t_"),ON_RESOZE_TOOLTIP_UPDATE:c("r_t_"),ON_RESIZE_TOOLTIP_TIMER:c("r_t_"),PAUSE_PLAY:"pause_play",START_PLAY:"start_play",ON_CANCEL_THUMB_HOVER:"ON_CANCEL_THUMB_HOVER",OPEN_PPT_FILE_SELECTOR:"open_ppt_file_selector",OPEN_SLIDE_SELECTOR:"open_slide_selector",CLOSE_SLIDE_SELECTOR:"close_slide_selector"}},p=new i.a;window.__uilDispatcher=p;var f={MasterViewGuideTips:"MasterViewGuideTips",Comment_QuickReply_tips:"Comment_QuickReply_tips",Clip_Guide_Tips:"Clip_Guide_Tips",RemarksViewGuideTips:"RemarksViewGuideTips",AnimGuideTips:"AnimGuideTips"},v={ON_DISCONNECTED:s.network.ON_DISCONNECTED,ON_CONNECT_ERROR:s.network.ON_CONNECT_ERROR,ON_CONNECTED:s.network.ON_CONNECTED,OFF_LINE:"offline",ON_LINE:"online"};t.default={names:h,thumbnailImg:{ON_IMG_NEW:"wpp.thumbnail.img.new",ON_IMG_IMPORT:"wpp.thumbnail.img.import",ON_IMG_HIDE:"wpp.thumbnail.img.hide",ON_IMG_SHOW:"wpp.thumbnail.img.show",ON_IMG_DELETE:"wpp.thumbnail.img.delete",ON_COOP_PANEL_SHOW:"thumbnail_coop_show_panel",ON_COOP_PANEL_CLOSE:"thumbnail_coop_close_panel"},thumbnailLine:{ON_LINE_NEW:"wpp.thumbnail.line.new"},slideStyles:{ON_SHOW_PANEL:"ON_SHOW_PANEL",ON_CLOSE_PANEL:"ON_CLOSE_PANEL"},eventTypes:d,dispatchEvent:l,dispatchKeyEvent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=document.createEvent("CustomEvent");i.initCustomEvent("key_event",r,n,{type:e,data:t}),window.dispatchEvent(i)},pubNames:s,uilDispatcher:p,hyperlinkType:d.pc.link,comment:{ON_COMMENT_TOGGLE:"wpp_toggle_comment",ON_COMMENT_INSERT:"wpp_insert_comment",ON_COMMENT_CLOSE:"wpp_comment_close",ON_COMMENT_SHOW:"wpp_comment_show",ON_COMMENT_PLAY:"wpp_comment_play"},OPENAPI_EVENT:a.OPENAPI_EVENT,guideTips:f,remarkEvent:{REQUEST_INFO:"remark_request_info",REQUEST_PICTURE_VIEWER_INFO:"request_picture_viewer_info",PLAY_INFO:"remark_play_info",LASER_INFO:"remark_laser_info",NORMAL_INFO:"remark_normal_info",BEFOREUNLOAD_INFO:"remark_beforeunload_info",AUDIENCE_FULL_SCREEN:"remark_audience_full_screen",AUDIENCE_END_PLAY:"remark_audience_end_play"},networkStatus:v,cooper:o}},258:function(e,t,r){"use strict";r.r(t),r.d(t,"KwoAnimAttributeName",(function(){return n})),r.d(t,"TransitionType",(function(){return i})),r.d(t,"TIME_NODE_LIST_ELEMENT",(function(){return a})),r.d(t,"VariantType",(function(){return o})),r.d(t,"TIME_NODE_PRESET_CLASS",(function(){return s})),r.d(t,"TIME_NODE_FILL",(function(){return l})),r.d(t,"KsoAnimEffect",(function(){return u})),r.d(t,"TRIGGER_TIME_TYPE",(function(){return c})),r.d(t,"EffectNodeType",(function(){return h})),r.d(t,"RAW_DURATION_INFINITE",(function(){return d})),r.d(t,"INDEFINITE_TIMING",(function(){return p})),r.d(t,"SCENE_NODE_STATUS",(function(){return f})),r.d(t,"AnimAfterType",(function(){return v})),r.d(t,"AnimCategory",(function(){return y})),r.d(t,"AnimTriggerType",(function(){return g})),r.d(t,"AnimSpeed",(function(){return m})),r.d(t,"AnimRepeatTimes",(function(){return _})),r.d(t,"AnimProperty",(function(){return S})),r.d(t,"AnimDirection",(function(){return T})),r.d(t,"AnimLevel",(function(){return b})),r.d(t,"AnimBehaviorType",(function(){return k})),r.d(t,"ShowAdvanceMode",(function(){return C})),r.d(t,"TextRangeType",(function(){return w})),r.d(t,"AnimFilterEffectType",(function(){return P})),r.d(t,"AnimFilterEffectSubtype",(function(){return x})),r.d(t,"SchemeTypeMap",(function(){return O})),r.d(t,"AnimeColorType",(function(){return E})),r.d(t,"FollowType",(function(){return I}));var n={kwoAnimNone:0,kwoAnimX:1,kwoAnimY:2,kwoAnimWidth:3,kwoAnimHeight:4,kwoAnimOpacity:5,kwoAnimRotation:6,kwoAnimColor:7,kwoAnimVisibility:8,kwoAnimXshear:9,kwoAnimTextFontBold:100,kwoAnimTextFontColor:101,kwoAnimTextFontEmboss:102,kwoAnimTextFontItalic:103,kwoAnimTextFontName:104,kwoAnimTextFontShadow:105,kwoAnimTextFontSize:106,kwoAnimTextFontSubscript:107,kwoAnimTextFontSuperscript:108,kwoAnimTextFontUnderline:109,kwoAnimTextFontStrikeThrough:110,kwoAnimTextBulletCharacter:111,kwoAnimTextBulletFontName:112,kwoAnimTextBulletNumber:113,kwoAnimTextBulletColor:114,kwoAnimTextBulletRelativeSize:115,kwoAnimTextBulletStyle:116,kwoAnimTextBulletType:117,kwoAnimShapePictureContrast:1e3,kwoAnimShapePictureBrightness:1001,kwoAnimShapePictureGamma:1002,kwoAnimShapePictureGrayscale:1003,kwoAnimShapeFillOn:1004,kwoAnimShapeFillColor:1005,kwoAnimShapeFillOpacity:1006,kwoAnimShapeFillBackColor:1007,kwoAnimShapeLineOn:1008,kwoAnimShapeLineColor:1009,kwoAnimShapeShadowOn:1010,kwoAnimShapeShadowType:1011,kwoAnimShapeShadowColor:1012,kwoAnimShapeShadowOpacity:1013,kwoAnimShapeShadowOffsetX:1014,kwoAnimShapeShadowOffsetY:1015,kwoAnimShapeFillType:1016,kwoAnimShapeStyleRotation:1017,kwoAnimXY:1018,kwoAnimTextFontTransform:1019,kwoAnimTextFontOutline:1020,kwoAnimTextFontSRotation:1021,kwoAnimShapePictureCropTop:1022,kwoAnimShapePictureCropBottom:1023,kwoAnimShapePictureCropLeft:1024,kwoAnimShapePictureCropRight:1025,kwoAnimShapePictureGain:1026,kwoAnimShapePictureBlackLevel:1027,kwoAnimShapePictureChromakey:1028,kwoAnimShapeFillMethod:1029,kwoAnimShapeFillBackOpacity:1030,kwoAnimShapeFillAngle:1031,kwoAnimShapeFillFocus:1032,kwoAnimShapeFillFocusPositionX:1033,kwoAnimShapeFillFocusPositionY:1034,kwoAnimShapeFillFocussizeX:1035,kwoAnimShapeFillFocussizeY:1036,kwoAnimShapeLineWeight:1037,kwoAnimShapeLineOpacity:1038,kwoAnimShapeLineStyle:1039,kwoAnimShapeLineDashStyle:1040,kwoAnimShapeLineFillType:1041,kwoAnimShapeLineSrc:1042,kwoAnimShapeLineBackColor:1043,kwoAnimShapeLineImagesizeX:1044,kwoAnimShapeLineImagesizeY:1045,kwoAnimShapeLineStratArrow:1046,kwoAnimShapeLineEndArrow:1047,kwoAnimShapeLineStartArrowWidth:1048,kwoAnimShapeLineStartArrowLength:1049,kwoAnimShapeLineEndArrowWidth:1050,kwoAnimShapeLineEndArrowLength:1051,kwoAnimShapeShadowBackColor:1052,kwoAnimShapeShadowBackOffsetX:1053,kwoAnimShapeShadowBackOffsetY:1054,kwoAnimShapeShadowOriginX:1055,kwoAnimShapeShadowOriginY:1056,kwoAnimShapeShadowMatrixXtox:1057,kwoAnimShapeShadowMatrixYtox:1058,kwoAnimShapeShadowMatrixYtoy:1059,kwoAnimShapeShadowMatrixPerspectiveX:1060,kwoAnimShapeShadowMatrixPerspectiveY:1061,kwoAnimShapeSkewOn:1062,kwoAnimShapeSkewOffsetX:1063,kwoAnimShapeSkewOffsetY:1064,kwoAnimShapeSkewOriginX:1065,kwoAnimShapeSkewOriginY:1066,kwoAnimShapeSkewMatrixXtox:1067,kwoAnimShapeSkewMatrixYtox:1068,kwoAnimShapeSkewMatrixYtoy:1069,kwoAnimShapeSkewMatrixPerspectiveX:1070,kwoAnimShapeSkewMatrixPerspectiveY:1071,kwoAnimExtrusionOn:1072,kwoAnimExtrusionType:1073,kwoAnimExtrusionRender:1074,kwoAnimExtrusionViewpointoriginX:1075,kwoAnimExtrusionViewpointoriginY:1076,kwoAnimExtrusionViewpointX:1077,kwoAnimExtrusionViewpointY:1078,kwoAnimExtrusionViewpointZ:1079,kwoAnimExtrusionPlane:1080,kwoAnimExtrusionSkewangle:1081,kwoAnimExtrusionSkewamt:1082,kwoAnimExtrusionBackDepth:1083,kwoAnimExtrusionForeDepth:1084,kwoAnimExtrusionOrientationX:1085,kwoAnimExtrusionOrientationY:1086,kwoAnimExtrusionOrientationZ:1087,kwoAnimExtrusionOrientationAngle:1088,kwoAnimExtrusionColor:1089,kwoAnimExtrusionRotationAngleX:1090,kwoAnimExtrusionRotationAngleY:1091,kwoAnimExtrusionLockRotationCenter:1092,kwoAnimExtrusionAutoRotationCenter:1093,kwoAnimExtrusionRotationCenterX:1094,kwoAnimExtrusionRotationCenterY:1095,kwoAnimExtrusionRotationCenterZ:1096,kwoAnimExtrusionColorMode:1097},i={none:0,cut:257,cutThroughBlack:258,random:513,blindsHorizontal:769,blindsVertical:770,checkerboardAcross:1025,checkerboardDown:1026,coverLeft:1281,coverUp:1282,coverRight:1283,coverDown:1284,coverLeftUp:1285,coverRightUp:1286,coverLeftDown:1287,coverRightDown:1288,dissolve:1537,fade:1793,uncoverLeft:2049,uncoverUp:2050,uncoverRight:2051,uncoverDown:2052,uncoverLeftUp:2053,uncoverRightUp:2054,uncoverLeftDown:2055,uncoverRightDown:2056,randomBarsHorizontal:2305,randomBarsVertical:2306,stripsLeftUp:2565,stripsRightUp:2566,stripsLeftDown:2567,stripsRightDown:2568,wipeLeft:2817,wipeUp:2818,wipeRight:2819,wipeDown:2820,boxOut:3073,boxIn:3074,splitHorizontalOut:3585,splitHorizontalIn:3586,splitVerticalOut:3587,splitVerticalIn:3588,circleOut:3845,diamondOut:3846,combHorizontal:3847,combVertical:3848,fadeSmoothly:3849,newsflash:3850,plusOut:3851,pushDown:3852,pushLeft:3853,pushRight:3854,pushUp:3855,wedge:3856,wheel1Spoke:3857,wheel2Spokes:3858,wheel3Spokes:3859,wheel4Spokes:3860,wheel8Spokes:3861,morphByObject:3954,morphByWord:3955,morphByChar:3956},a={PARALLEL_TIME_NODE:0,SEQUENCE_TIME_NODE:1,ANIMATE_EFFECT:2,SET_TIME_NODE_BEHAVIOR:3,AUDIO:4,ANIMATE_SCALE:5,ANIMATE_MOTION:6,COMMAND:7,EXCLUSIVE:8,ANIMATE:9,ANIMATE_COLOR_BEHAVIOR:10,ANIMATE_ROTATION:11,VIDEO:12,UNSUPPORTED_BEHAVIOR:-1},o={typeString:0,typeFloat:1,typeInteger:2,typeColor:3},s={ENTRANCE_PRESET:"entrance",EXIT_PRESET:"exit",EMPHASIS_PRESET:"emphasis",PATH_PRESET:"path",MEDIA_CALL_PRESET:"mediaCall"},l={REMOVE:1,FREEZE:2,HOLD:3,TRANSITION:4},u={Custom:0,Appear:1,Fly:2,Blinds:3,Box:4,Checkerboard:5,Circle:6,Crawl:7,Diamond:8,Dissolve:9,Fade:10,FlashOnce:11,Peek:12,Plus:13,RandomBars:14,Spiral:15,Split:16,Stretch:17,Strips:18,Swivel:19,Wedge:20,Wheel:21,Wipe:22,Zoom:23,RandomEffects:24,Boomerang:25,Bounce:26,ColorReveal:27,Credits:28,EaseIn:29,Float:30,GrowAndTurn:31,LightSpeed:32,Pinwheel:33,RiseUp:34,Swish:35,ThinLine:36,Unfold:37,Whip:38,Ascend:39,CenterRevolve:40,FadedSwivel:41,Descend:42,Sling:43,Spinner:44,Stretchy:45,Zip:46,ArcUp:47,FadedZoom:48,Glide:49,Expand:50,Flip:51,Shimmer:52,Fold:53,ChangeFillColor:54,ChangeFont:55,ChangeFontColor:56,ChangeFontSize:57,ChangeFontStyle:58,GrowShrink:59,ChangeLineColor:60,Spin:61,Transparency:62,BoldFlash:63,Blast:64,BoldReveal:65,BrushOnColor:66,BrushOnUnderline:67,ColorBlend:68,ColorWave:69,ComplementaryColor:70,ComplementaryColor2:71,ContrastingColor:72,Darken:73,Desaturate:74,FlashBulb:75,Flicker:76,GrowWithColor:77,Lighten:78,StyleEmphasis:79,Teeter:80,VerticalGrow:81,Wave:82,MediaPlay:83,MediaPause:84,MediaStop:85,PathCircle:86,PathRightTriangle:87,PathDiamond:88,PathHexagon:89,Path5PointStar:90,PathCrescentMoon:91,PathSquare:92,PathTrapezoid:93,PathHeart:94,PathOctagon:95,Path6PointStar:96,PathFootball:97,PathEqualTriangle:98,PathParallelogram:99,PathPentagon:100,Path4PointStar:101,Path8PointStar:102,PathTeardrop:103,PathPointyStar:104,PathCurvedSquare:105,PathCurvedX:106,PathVerticalFigure8:107,PathCurvyStar:108,PathLoopdeLoop:109,PathBuzzsaw:110,PathHorizontalFigure8:111,PathPeanut:112,PathFigure8Four:113,PathNeutron:114,PathSwoosh:115,PathBean:116,PathPlus:117,PathInvertedTriangle:118,PathInvertedSquare:119,PathLeft:120,PathTurnRight:121,PathArcDown:122,PathZigzag:123,PathSCurve2:124,PathSineWave:125,PathBounceLeft:126,PathDown:127,PathTurnUp:128,PathArcUp:129,PathHeartbeat:130,PathSpiralRight:131,PathWave:132,PathCurvyLeft:133,PathDiagonalDownRight:134,PathTurnDown:135,PathArcLeft:136,PathFunnel:137,PathSpring:138,PathBounceRight:139,PathSpiralLeft:140,PathDiagonalUpRight:141,PathTurnUpRight:142,PathArcRight:143,PathSCurve1:144,PathDecayingWave:145,PathCurvyRight:146,PathStairsDown:147,PathUp:148,PathRight:149,Wink:150,Flash:151,PathCustom:152},c={presTriggerTimeOnBegin:1,presTriggerTimeOnEnd:2,presTriggerTimeBegin:3,presTriggerTimeEnd:4,presTriggerTimeOnclick:5,presTriggerTimeOnDblClick:6,presTriggerTimeOnMouseOver:7,presTriggerTimeOnMouseOut:8,presTriggerTimeOnpptNext:9,presTriggerTimeOnpptPrev:10,presTriggerTimeOnStopAudio:11,presTriggerTimeOnMediaBmk:12},h={CLICK:0,WITH:1,AFTER:2,TRANS:3},d="infinite",p=Number.MAX_SAFE_INTEGER,f={WAITING:0,RUNNING:1,FINISHED:2},v={Mixed:-1,None:0,Dim:1,Hide:2,HideOnNextClick:3},y={Entrance:1,Exit:2,Emphasis:3,Path:4,MediaCall:6};Object.freeze(y);var g={Mixed:-1,Node:0,OnPageClick:1,WithPrevious:2,AfterPrevious:3,OnShapeClick:4};Object.freeze(g);var m={verySlow:5,slow:3,medium:2,fast:1,veryFast:.5};Object.freeze(m);var _={None:1,Twice:2,Third:3,Fourth:4,Fifth:5,Tenth:10,UntilEndOfSlide:-1,UntilNextClick:-2};Object.freeze(_);var S={Type:0,EffectCategory:1,GroupIndex:2,SerialNumber:3,TriggerType:4,Text:5,GroupText:6,Speed:7,Direction:8,Scale:9,ScaleDirection:10,Rotation:11,RotationDirection:12,FontName:13,FontStyle:14,FontSize:15,FontSizeStyle:16,Transparency:17,ColorFormat1Type:18,ColorFormat1:19,ColorFormat2Type:20,ColorFormat2:21,ColorStyle:22,Relative:23,AfterEffect:24,DimColorFormatType:25,DimColorFormat:26,SoundEffectType:27,SoundEffectBuildInID:28,SoundEffectName:29,ImportFromFile:30,SoundEffectVolume:31,SoundEffectMute:32,IsTextUnitEnable:33,TextUnitEffect:34,TextUnitInterval:35,DelayTime:36,DelayTimeAndSpeed:37,RepeatCount:38,SmoothStart:39,SmoothEnd:40,AutoReverse:41,IsLevelEnable:42,MinIdentLevel:43,MaxIdentLevel:44,BuildByLevel:45,AfterEffectEnable:46,BeginOffset:47,TextUnitCount:48,ItemExpanded:49,TriggerText:50,TriggerShapeObj:51,SmartArtNodeEffect:52};Object.freeze(S);var T={None:0,Up:1,Right:2,Down:3,Left:4,OrdinalMask:5,UpLeft:6,UpRight:7,DownRight:8,DownLeft:9,Top:10,Bottom:11,TopLeft:12,TopRight:13,BottomRight:14,BottomLeft:15,Horizontal:16,Vertical:17,Across:18,In:19,Out:20,Clockwise:21,Counterclockwise:22,HorizontalIn:23,HorizontalOut:24,VerticalIn:25,VerticalOut:26,Slightly:27,Center:28,InSlightly:29,InCenter:30,InBottom:31,OutSlightly:32,OutCenter:33,OutBottom:34,FontBold:35,FontItalic:36,FontUnderline:37,FontStrikethrough:38,FontShadow:39,FontAllCaps:40,Instant:41,Gradual:42,CycleClockwise:43,CycleCounterclockwise:44,Wheel1:45,Wheel2:46,Wheel3:47,Wheel4:48,Wheel8:49};Object.freeze(T);var b={LevelMixed:-1,LevelNone:0,TextByAllLevels:1,TextByFirstLevel:2,TextBySecondLevel:3,TextByThirdLevel:4,TextByFourthLevel:5,TextByFifthLevel:6,ChartAllDirectAtOnce:7,ChartByCategory:8,ChartByCategoryElements:9,ChartBySeries:10,ChartBySeriesElements:11};Object.freeze(b);var k={Mixed:-2,None:0,Motion:1,Color:2,Scale:3,Rotation:4,Property:5,Command:6,Filter:7,Set:8};Object.freeze(k);var C={mixed:-2,onClick:1,onTime:2},w={presTextRangeMixed:-1,presTextRangePara:0,presTextRangeChar:1},P={AnimFilterEffectTypeNone:0,AnimFilterEffectTypeBarn:1,AnimFilterEffectTypeBlinds:2,AnimFilterEffectTypeBox:3,AnimFilterEffectTypeCheckerboard:4,AnimFilterEffectTypeCircle:5,AnimFilterEffectTypeDiamond:6,AnimFilterEffectTypeDissolve:7,AnimFilterEffectTypeFade:8,AnimFilterEffectTypeImage:9,AnimFilterEffectTypePixelate:10,AnimFilterEffectTypePlus:11,AnimFilterEffectTypeRandomBar:12,AnimFilterEffectTypeSlide:13,AnimFilterEffectTypeStretch:14,AnimFilterEffectTypeStrips:15,AnimFilterEffectTypeWedge:16,AnimFilterEffectTypeWheel:17,AnimFilterEffectTypeWipe:18},x={AnimFilterEffectSubtypeNone:0,AnimFilterEffectSubtypeInVertical:1,AnimFilterEffectSubtypeOutVertical:2,AnimFilterEffectSubtypeInHorizontal:3,AnimFilterEffectSubtypeOutHorizontal:4,AnimFilterEffectSubtypeHorizontal:5,AnimFilterEffectSubtypeVertical:6,AnimFilterEffectSubtypeIn:7,AnimFilterEffectSubtypeOut:8,AnimFilterEffectSubtypeAcross:9,AnimFilterEffectSubtypeFromLeft:10,AnimFilterEffectSubtypeFromRight:11,AnimFilterEffectSubtypeFromTop:12,AnimFilterEffectSubtypeFromBottom:13,AnimFilterEffectSubtypeDownLeft:14,AnimFilterEffectSubtypeUpLeft:15,AnimFilterEffectSubtypeDownRight:16,AnimFilterEffectSubtypeUpRight:17,AnimFilterEffectSubtypeSpokes1:18,AnimFilterEffectSubtypeSpokes2:19,AnimFilterEffectSubtypeSpokes3:20,AnimFilterEffectSubtypeSpokes4:21,AnimFilterEffectSubtypeSpokes8:22,AnimFilterEffectSubtypeLeft:23,AnimFilterEffectSubtypeRight:24,AnimFilterEffectSubtypeDown:25,AnimFilterEffectSubtypeUp:26},O={dk1:0,lt1:1,dk2:2,lt2:3,accent1:4,accent2:5,accent3:6,accent4:7,accent5:8,accent6:9,hlink:10,folHlink:11,bg1:1,tx1:0,bg2:3,tx2:2},E={mixed:-2,rgb:1,schemeIndex:2,hls:3,cms:4,ink:5,crgb:6,preset:7,system:8,count:9},I={FollowNone:-1,FollowFirstPara:0,FollowShape:1}},262:function(e,t,r){"use strict";r.r(t);var n={modify_types_start:0,insert_text:1,delete_text:2,modify_fmt:3,modify_slide:4,modify_layout:5,modify_master:6,modify_shape:7,modify_shapetree:8,modify_text_frame:9,modify_table_frame:10,modify_table_cell:11,modify_paragraph_attr:12,modify_chapter_attr:13,modify_notespage:14,modify_textframe_style:15,modify_shape_style:16,modify_master_text_style:17,modify_types_end:99,update_types_start:100,update_slides:101,update_types_end:109,edit_slide_start:110,modify_slide_container:111,edit_slide_end:119,animation_notify:120,animation_preview:121,modify_comment:122,modify_comment_container:123,modify_page_setup:124,error_readonly:220,collect_path:221,server_paste_start:222,server_paste_complete:223,server_doctemplate_start:224,server_doctemplate_end:225,server_chart_insert_start:226,server_chart_insert_end:227,server_pagesetup_start:226,server_pagesetup_end:227,server_documentbeautify_start:228,server_documentbeautify_end:229,operate_types_begin:999,op_modify:1e3,op_add:1001,op_remove:1002,op_move:1003,op_replace:1004,operate_types_end:1006,toString:function(e){var t=this._strs[e];return t||""},isModifyEvent:function(e){return e>this.modify_types_start&&e<this.modify_types_end}};!function(){var e={};for(var t in n){var r=n[t];"number"==typeof r&&(e[r]=t)}n._strs=e}(),Object.freeze(n),t.default=n},263:function(e,t,r){"use strict";r.r(t),r.d(t,"AbsObject",(function(){return i})),r.d(t,"AbsTopObject",(function(){return s})),r.d(t,"AbsCustomObject",(function(){return o})),r.d(t,"AbsVectorObject",(function(){return a})),r.d(t,"AbsTopVectorObject",(function(){return l})),r.d(t,"AbsTopCustomObject",(function(){return u}));var n=r(304);function i(){this.objType,this.private=null,this.initialize()}function a(){this.vector=new Array,this.initialize()}function o(){this.initialize()}function s(){this.initialize()}function l(){this.initialize()}function u(){this.initialize()}i.prototype.initialize=function(){this.objType=n.default.OType_Data,this.private=null,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this)},i.prototype.isTopObject=function(){return!1},i.prototype.isMainObject=function(){return!1},i.prototype.writeLock=function(){this.objType==n.default.OType_Data?this.__modified||window.g_rpt.addDataNotify(this):console.error("object type error")},i.prototype.isNewest=function(){return!(null==this.newest||0==this.newest)},i.prototype.forward=function(e){if(e.opType===n.default.otReplaceData&&0==this.isNewest()){var t=this.private;this.private=e.data,e.data=t}return null},i.prototype.backward=function(e){if(e.opType==n.default.otReplaceData){var t=this.private;this.private=e.data,e.data=t}},i.prototype.on=function(e){this.onChangedCB=e},i.prototype._fireChanged=function(e){this.onChangedCB&&this.onChangedCB(this,e)},a.prototype=new i,a.prototype.initialize=function(){this.objType=n.default.OType_Vector,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this)},a.prototype.writeLock=function(){},a.prototype.at=function(e){return this.vector[e]},a.prototype.length=function(){return this.vector.length},a.prototype.set=function(e,t){if(this.vector.length<=e)return-1;var r=this.vector[e];return this.vector[e]=t,window.g_rpt.addVectorOperate(this,n.default.otModify,e,t,r),0},a.prototype.push=function(e){return this.vector.push(e),window.g_rpt.addVectorOperate(this,n.default.otInsert,this.vector.length-1,e),0},a.prototype.pop=function(){this.remove(this.length()-1)},a.prototype.insert=function(e,t){return this.vector.length<e?-1:(this.vector.splice(e,0,t),window.g_rpt.addVectorOperate(this,n.default.otInsert,e,t),0)},a.prototype.remove=function(e){if(this.vector.length<=e)return-1;var t=this.vector[e];return this.vector.splice(e,1),window.g_rpt.addVectorOperate(this,n.default.otRemove,e,t),0},a.prototype.move=function(e,t){if(e+t<0||e+t>this.vector.length)return-1;var r=this.vector[e];return t<0?(this.vector.splice(e,1),this.vector.splice(e+t,0,r)):t>0&&(this.vector.splice(e+t,0,r),this.vector.splice(e,1)),window.g_rpt.addVectorOperate(this,n.default.otMove,e,r,void 0,t),0},a.prototype.forward=function(e){switch(e.opType){case n.default.otInsert:this.vector.splice(e.pos,0,e.data);break;case n.default.otRemove:this.vector.splice(e.pos,1);break;case n.default.otMove:e.offset<0?(this.vector.splice(e.pos,1),this.vector.splice(e.pos+e.offset,0,e.data)):e.offset>0&&(this.vector.splice(e.pos+e.offset,0,e.data),this.vector.splice(e.pos,1));break;case n.default.otModify:this.vector[e.pos]=e.data;break;case n.default.otReplaceData:var t=this.vector;this.vector=e.data,e.data=t}},a.prototype.backward=function(e){var t=new Object;switch(t.object=e.object,t.pos=e.pos,e.opType){case n.default.otInsert:t.opType=n.default.otRemove,t.data=e.data;break;case n.default.otRemove:t.opType=n.default.otInsert,t.data=e.data;break;case n.default.otMove:t.opType=n.default.otMove,t.pos=e.pos+e.offset,t.offset=-e.offset,t.data=e.data;break;case n.default.otModify:t.opType=n.default.otModify,t.oldData=e.data,t.data=e.oldData;break;case n.default.otReplaceData:t=e}this.forward(t)},a.prototype.foreEachNewChildInOp=function(e,t){switch(e.opType){case n.default.otInsert:case n.default.otModify:t(e.data);break;case n.default.otReplaceData:for(var r=0;r<this.vector.length;++r)t(this.vector[r]);break;case n.default.otMove:case n.default.otRemove:break;default:console.error("foreEachNewChildInOp invalid op.opType")}},o.prototype=new i,o.prototype.initialize=function(){this.objType=n.default.OType_Custom,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this)},o.prototype.writeLock=function(){},o.prototype.forward=function(e){},o.prototype.backward=function(e){},o.prototype.on=function(e){this.onChangedCB=e},s.prototype=new i,s.prototype.initialize=function(){this.objType=n.default.OType_Data,void 0!==window.g_rpt&&window.g_rpt.registerTopObject(this)},s.prototype.isTopObject=function(){return!0},l.prototype=new a,l.prototype.initialize=function(){this.objType=n.default.OType_Vector,void 0!==window.g_rpt&&window.g_rpt.registerTopObject(this)},l.prototype.isTopObject=function(){return!0},u.prototype=new o,u.prototype.initialize=function(){this.objType=n.default.OType_Custom,void 0!==window.g_rpt&&window.g_rpt.registerTopObject(this)}},2662:function(e,t,r){"use strict";var n=r(25),i=r.n(n),a=r(42),o=r.n(a),s=r(0),l=r.n(s),u=r(3),c=r.n(u),h=r(543),d=r(875),p=r(262),f=r(43),v=r.n(f),y=r(268),g=r(624),m=r(263),_=r(809);function S(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(e=e||{}).prop||{};e.prop=new g.a,e.prop.private=r,e.prop.__isNew=!0,e.prop.__modify=!1;var n=new m.AbsObject;return n.private=e,n.__isNew=!0,n.__modify=!1,t&&Object(g.d)(n),n}var T=function(){function e(t){l()(this,e),this.tbl=t}return c()(e,[{key:"isPap",value:function(){return"pap"===this.tbl.tag}},{key:"isChp",value:function(){return"chp"===this.tbl.tag}},{key:"offsetItems",value:function(e,t){for(var r=this.items;e<r.length();++e){var n=r.at(e);n.setBegin(n.getBegin()+t)}}},{key:"getItemEndByIndex",value:function(e){var t=this.items.at(e);return t.getBegin()+t.getCcp()}},{key:"deleteText",value:function(e){for(var t=this.tbl,r=this.isPap(),n=e.gcp,i=e.text,a=e.optype,o=i.length,s=n+o,l=t.findIndex(n),u=this.items,c=l;c<u.length();c++){var h=u.at(c),d=h.getBegin(),p=h.getCcp(),f=d+p;if(d===n)if(s<f)h.setCcp(p-o);else{var v=u.at(c+1);v&&("deleteChar"===a?(h.setBegin(d),h.setCcp(p+v.getCcp()),u.remove(c+1),c--):(v.setBegin(d),v.setCcp(p+v.getCcp()),u.remove(c--)))}else if(d<n)if(s<f)h.setCcp(p-o);else if(r){for(var y=u.at(c+1),g=p;y;){if(!(d+g+y.getCcp()<=n+o)){g+=y.getCcp();break}g+=y.getCcp(),u.remove(c+1),y=u.at(c+1)}y?(h.setCcp(g-o),u.remove(c+1)):h.setCcp(n-d)}else h.setCcp(n-d);else s<=d?h.setBegin(d-o):s<f?(h.setBegin(n),h.setCcp(p-(s-d))):(u.remove(c),c--)}}},{key:"getActions",value:function(e){return e.getProp().private.actions}},{key:"_checkProperty",value:function(e,t){for(var r=e.getProp().private,n=Object.keys(t),i=0;i<n.length;i++){var a=n[i];if(r[a]!==t[a])return!1}return!0}},{key:"cloneItemAndInsert",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.tbl.cloneItem(e);o.setBegin(r),o.setCcp(n);var s=o.private.prop;if(a&&delete s.private.actions,i)for(var l in i)i.hasOwnProperty(l)&&(null==i[l]?delete s[l]:s.private[l]=i[l]);this.items.insert(t,o)}},{key:"insertText",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this,i=n.tbl,a=e.gcp,o=e.text,s=n.items;if(0===s.length())return console.assert(0===e.gcp),void s.push(S({begin:0,ccp:o.length}));var l=i.findIndex(a),u=i.getItemAt(l);if(null!=u)for(var c=n.isPap(),h=!c&&!!r,d=o===_.d.EndPara,p=o.length,f=u.getBegin()===a&&!t&&l>0,v=this.getActions(u),y=l;y<s.length();y++){var g=s.at(y),m=g.getBegin(),T=g.getCcp(),b=m+T;if(m===a)if(h=h||!!v,f&&y===l){var k=s.at(y-1),C=this.getActions(k);h&&r&&this._checkProperty(k,r)&&(h=C&&!v),h?(this.cloneItemAndInsert(k,y,a,p,r,!v||!C),y++):k.setCcp(k.getCcp()+p),g.setBegin(m+p)}else{var w=this.getActions(g);if(h&&r&&this._checkProperty(g,r)&&(h=w&&!v),d||h){var P=y>0?s.at(y-1):null,x=P&&this.getActions(P);this.cloneItemAndInsert(g,y,a,p,r,!v||!x),y++,g.setBegin(a+p)}else g.setCcp(T+p)}else m<a?a<b?!d||h&&!this._checkProperty(g,r)?(h&&r&&this._checkProperty(g,r)&&(h=!1),h?(g.setCcp(a-m),this.cloneItemAndInsert(g,y+1,a,p,r),this.cloneItemAndInsert(g,y+2,a+p,b-a),y+=2):g.setCcp(T+p)):(g.setCcp(a-m+p),this.cloneItemAndInsert(g,y+1,a+p,b-a),y++):console.error("text prop insert error!"):g.setBegin(m+p)}else i.lastItem.setCcp(a+o.length-i.lastItem.getBegin())}},{key:"replaceText",value:function(e,t,r){var n=this.tbl,i=t.length-e.length;if(0!==i){for(var a={},o=function(){for(var e=[],t=0;t<r.length;++t){var i=r[t].begin,a=n.getItemByCP(i);e.push(a)}return e}(),s=0;s<r.length;++s)for(var l=r[s],u=l.begin,c=l.end,h=n.findIndex(o[s].getBegin()),d=n.getItemsArray(),p=h;p<d.length;++p){var f=d[p];null!=f.replaceCnt?(u+=f.replaceCnt*i,c+=f.replaceCnt*i):(u=l.begin,c=l.end);var v=f.getBegin(),y=f.getCcp();if(v>=c){a[p]=d[h].replaceCnt;break}v<=u?(v+y>c?f.setCcp(y+i):f.setCcp(u-v+t.length),null==f.replaceCnt?f.replaceCnt=1:f.replaceCnt++):v+y>c?f.setCcp(v+y-c):f.setCcp(0)}for(var g=n.getItemsArray(),m=0;m<g.length;++m)delete g[m].replaceCnt;for(var _=Object.keys(a),S=0;S<_.length;++S)for(var T=parseInt(_[S]),b=a[T],k=_[S+1]?_[S+1]:g.length,C=T;C<k;++C)g[C].setBegin(g[C].getBegin()+i*b)}}},{key:"removeItems",value:function(e,t){var r=this.items;if(e>=0&&e<=t&&t<=r.length())for(var n=e;n<t;++n)r.remove(e)}},{key:"splitItem",value:function(e){var t=this.tbl,r=t.findIndex(e),n=t.getItemAt(r),i=n.getBegin()+n.getCcp();if(console.assert(n.getBegin()<=e&&e<=i),n.getBegin()!==e&&e<i){var a=t.cloneItem(n);a.setBegin(e),a.setCcp(i-e),n.setCcp(n.getCcp()-a.getCcp()),t.items.insert(r+1,a)}}},{key:"items",get:function(){return this.tbl.items}}]),e}();function b(e,t){var r,n=Array.from(arguments);n=n.slice(2),(r=e.inner)[t].apply(r,v()(n)),e.validateData()}var k=function(){function e(t,r){l()(this,e),this.tag=r,this.stream=t,this.inner=new T(this)}return c()(e,[{key:"getItemCount",value:function(){return this.items?this.items.length():0}},{key:"getItemAt",value:function(e){return this.items&&this.items.at(e)}},{key:"getItemByCP",value:function(e){if(this.items){var t=this.findIndex(e);if(t>=0&&t<this.items.length())return this.items.at(t)}return null}},{key:"findIndex",value:function(e){var t=this.items;if(!t)return-1;for(var r=0,n=t.length()-1;r<=n;){var i=Math.floor((r+n)/2),a=t.at(i);if(e>=a.getBegin()){if(!(e>=a.getBegin()+a.getCcp()))return i;if(i+1>n&&e===a.getBegin()+a.getCcp())return i;r=i+1}else n=i-1}return-1}},{key:"getItemsArray",value:function(){return this.items.vector}},{key:"getItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=this.items;if(null==e||null==t||e<0||t<0||!n)return r;for(var i=this.findIndex(e),a=n.length(),o=i,s=a;o<s;++o){var l=n.at(o),u=l.getBegin();if(t>0&&u>=e+t||0===t&&u>e)break;r.push(l)}return r}},{key:"validateData",value:function(e){if(window.APP.dbgCheck){for(var t=this.items,r=0,n=0;n<t.length();++n)0===t.at(n).getCcp()&&console.assert(!1),r!==t.at(n).getBegin()&&console.assert(!1),r+=t.at(n).getCcp();void 0!==e&&console.assert(e===r)}}},{key:"insertText",value:function(e,t,r){b(this,"insertText",e,t,r)}},{key:"deleteText",value:function(e){b(this,"deleteText",e)}},{key:"replaceText",value:function(e,t,r){b(this,"replaceText",e,t,r)}},{key:"clearProp",value:function(e,t){this.clearProps(e,[t])}},{key:"clearProps",value:function(e,t){var r=this.getItemByCP(e);if(r){var n=r.getProp(),i=n&&n.private;if(i){for(var a=!1,o=Object(y.a)(i),s=0;s<t.length;s++){var l=t[s];o.hasOwnProperty(l)&&(delete o[l],a=!0)}if(a){var u=new g.a;u.private=o,Object(g.g)(r,"prop",u)}}}}},{key:"callFmt",value:function(e,t,r,n){for(var i=this.findIndex(e);i<this.getItemCount();++i){var a=this.getItemAt(i);if(e+t<=a.getBegin())break;a.setProp(Object(y.b)(a.getProp()));var o=a.getProp();Object(g.g)(o,r,n)}}},{key:"splitItem",value:function(e){b(this,"splitItem",e)}},{key:"cloneItem",value:function(e){var t=Object(y.a)(e.getProp().private);return S({begin:e.getBegin(),ccp:e.getCcp(),prop:t},!1)}},{key:"cloneItemByRange",value:function(e,t,r){return S({begin:t,ccp:r,prop:Object(y.a)(e.getProp().private)},!1)}},{key:"items",get:function(){var e=this.stream.private;return("chp"===this.tag?e.chpTbl:e.papTbl).private.data}},{key:"begin",get:function(){return this.items?this.firstItem.getBegin():0}},{key:"end",get:function(){if(this.items){var e=this.lastItem;return e?e.getBegin()+e.getCcp():0}return 0}},{key:"firstItem",get:function(){return this.items&&this.items.at(0)}},{key:"lastItem",get:function(){return this.items.at(this.items.length()-1)}}]),e}(),C=r(315),w=r(167),P=r(2244),x=function(e,t,r){if(e===t.obj)for(var n=function(e,t){if(t){var r=[];return Object.assign(r,e),r.reverse(),r}return e}(t.data,!r),i=0;i<n.length;++i){var a=n[i];e[a.name](a.param,r)}else console.error("wrong op.obj!")};var O=function(){function e(t){l()(this,e),this.strm=t,this.papxHandle={},this.papxHandle.leftIndent=function(e,r,n){for(var i=t.getParaTbl().getItems(r,n),a=0,o=i.length;a<o;++a){var s=i[a],l=Object(y.b)(s.getProp());s.setProp(l);var u=Object(y.b)(e);validateSetField(l,"leftIndent",u)}},this.papxHandle.firstIndent=function(e,r,n){for(var i=t.getParaTbl().getItems(r,n),a=0,o=i.length;a<o;++a){var s=i[a],l=Object(y.b)(s.getProp());s.setProp(l);var u=Object(y.b)(e);validateSetField(l,"firstIndent",u)}},this.papxHandle.tabIndent=function(e,r,n){if(0!==e&&t.canTabIndent(e<0,r,n))for(var i=t.getParaTbl().getItems(r,n),a=0,o=i.length;a<o;++a){var s=i[a],l=validateGetField(s.getProp(),"outline")||0,u=e>0?l+1:l-1,c=s.getProp();c=Object(y.b)(c),s.setProp(c),validateSetField(c,"outline",u)}},this.papxHandle.autoNumType=function(e,r,n){var i=e,a=t.getParaTbl(),o=a.findIndex(r),s=a.getItemAt(o),l=s.getProp(),u=t.getAutonumMgr();if(u){var c=function(){var e=new h.b;return e.private={},validateSetField(e,"start",1),validateSetField(e,"type",i),e},d=validateGetField(l,"autoNum");if(!d)return u.push(c()),void a.callFmt(r,n,"autoNum",u.length()-1);var p=u.at(d);if(1===validateGetField(p,"start"))validateSetField(p,"type",i);else if(0===o||a.at(o-1).getProp().getAutoNum()!==l.getAutoNum())validateSetField(p,"type",i),validateSetField(p,"start",1);else{u.push(c());for(var f=u.length()-1,v=validateGetField(l,"outline"),y=o,g=a.getItemCount();y<g;++y){var m=a.at(y);if(m.getOutline()!==v||m.getAutoNum()!==d)break;validateSetField(m,"autoNum",f)}}r+n>s.getBegin()+s.getCcp()&&(d=validateGetField(l,"autoNum"),a.callFmt(r,n,"autoNum",d))}},this.papxHandle.listType=function(e,r,n){for(var i=t.getParaTbl().getItems(r,n),a=0,o=i.length;a<o;++a){var s=i[a],l=s.getProp();l=Object(y.b)(l),s.setProp(l),validateSetField(l,"listType",e),0!==e&&2!==e||validateSetField(l,"bulletChar",void 0)}}}return c()(e,[{key:"insertText",value:function(e,t,r){var n={gcp:t,text:e,prop:r},i=this.strm,a=i.getParaTbl(),o=i.getChpTbl(),s=a.getItemByCP(t),l=null!=s&&s.getBegin()===t;o.insertText(n,l,r),a.insertText(n,l),this.execAndRecord("txtStrmInsert",n)}},{key:"deleteText",value:function(e,t,r){var n=this.strm,i={gcp:e,optype:r,text:n.text.slice(e,e+t).join("")};n.getChpTbl().deleteText(i),n.getParaTbl().deleteText(i),this.execAndRecord("txtStrmDelete",i)}},{key:"replaceText",value:function(e,t,r){for(var n=this.strm,i=t.length-e.length,a=0;a<r.length;++a){var o=r[a],s=o.begin,l=o.props,u={gcp:s+i*a,text:e};this.execAndRecord("txtStrmDelete",u);var c={gcp:s+i*a,text:t,prop:l};this.execAndRecord("txtStrmInsert",c)}0!==i&&(n.getChpTbl().replaceText(e,t,r),n.getParaTbl().replaceText(e,t,r));return!0}},{key:"fmtChpx",value:function(e,t,r){var n=this.strm;for(var i in n.getChpTbl().splitItem(e),n.getChpTbl().splitItem(e+t),r)r.hasOwnProperty(i)&&n.getChpTbl().callFmt(e,t,i,r[i]);var a={gcp:e,ccp:t};this.execAndRecord("txtStrmFmtChpxV2",a)}},{key:"fmtPapx",value:function(e,t,r){var n=this.strm;for(var i in r)r.hasOwnProperty(i)&&(this.papxHandle[i]?this.papxHandle[i](r[i],e,t):n.getParaTbl().callFmt(e,t,i,r[i]));var a={gcp:e,ccp:t};this.execAndRecord("txtStrmFmtPapxV2",a)}},{key:"execAndRecord",value:function(e,t){var r=this.strm;t.isLocal=!0,r[e](t,!0),t.isLocal=!1;var n=window.getTransaction();null!=n&&n.record(r,e,t)}}]),e}(),E=function(e){function t(e){l()(this,t);var r,n=i()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.private=e.data,n.data_token=Object(C.a)(),n.tree_token=n.data_token,n.create_token=Object(C.a)(),(r=n).forward=function(e){r.setActionType(w.TransActionType.Forward),x(this,e,!0)},r.backward=function(e){r.setActionType(w.TransActionType.BackWard),x(this,e,!1)},r.setActionType=function(e){r.actionType=e},r.getActionType=function(){return r.actionType},r.clearActionType=function(){delete r.actionType},r._fireChanged||(r._fireChanged=function(){}),Object(d.a)(n),n.observers=[],n.papTbl=new k(n,"pap"),n.chpTbl=new k(n,"chp"),n.local=new O(n),n}return o()(t,e),c()(t,[{key:"buildTree",value:function(e){this.parent=e;var t=this.private;t.text&&(this.text=t.text.split(""),delete t.text),this.textHeader=t.textHeader,this.autonumMgr=t.autonumMgr}},{key:"initTransact",value:function(e){this.transact=e}},{key:"addObserver",value:function(e){null!==e&&this.observers.push(e)}},{key:"removeObserver",value:function(e){if(null!==e){var t=this.observers.indexOf(e);t>=0&&this.observers.splice(t,1)}}},{key:"getCharCount",value:function(){return this.text.length}},{key:"getCharAt",value:function(e){return this.text[e]}},{key:"getAllText",value:function(){return this.text}},{key:"getAutonumMgr",value:function(){return this.autonumMgr}},{key:"getText",value:function(e,t){return this.text.slice(e,e+t)}},{key:"getParaTbl",value:function(){return this.papTbl}},{key:"getChpTbl",value:function(){return this.chpTbl}},{key:"getHyperLink",value:function(e){var t=this.getChpTbl().getItemByCP(e),r=t&&t.getProp();return r&&r.private.actions}},{key:"getTextStyleType",value:function(){return this.isTextStyleBody()?w.TextStyleType.Body:this.isTextStyleTitle()?w.TextStyleType.Title:w.TextStyleType.Other}},{key:"isMainObject",value:function(){return!0}},{key:"isTextStyleTitle",value:function(){var e=this.textHeader;return"TextStyleTitle"===e||"TextStyleCenterTitle"===e}},{key:"isTextStyleBody",value:function(){var e=this.textHeader;return"TextStyleBody"===e||"TextStyleCenterBody"===e||"TextStyleHalfBody"===e||"TextStyleQuarterBody"===e}},{key:"insertText",value:function(e,t,r){this.local.insertText(e,t,r)}},{key:"deleteText",value:function(e,t,r){this.local.deleteText(e,t,r)}},{key:"replaceText",value:function(e,t,r){return this.local.replaceText(e,t,r)}},{key:"fmtChpx",value:function(e,t,r){this.local.fmtChpx(e,t,r);var n={data:this,cpStart:e,cpEnd:e+t};return this._bubbleUpEvent(p.default.modify_fmt,n),!0}},{key:"fmtPapx",value:function(e,t,r){this.local.fmtPapx(e,t,r);var n={data:this,cpStart:e,cpEnd:e+t};return this._bubbleUpEvent(p.default.modify_fmt,n),!0}},{key:"txtStrmInsert",value:function(e,t){this.adjustTextInner(e,t),t&&(this.chpTbl.validateData(this.text.length),this.papTbl.validateData(this.text.length))}},{key:"txtStrmDelete",value:function(e,t){this.adjustTextInner(e,!t),t&&(this.chpTbl.validateData(this.text.length),this.papTbl.validateData(this.text.length))}},{key:"txtStrmFmtChpxV2",value:function(e,t){if(e.fmt){var r=null,n=e.fmt;t&&void 0!==n.autoFit?r=n.autoFit:!t&&n.oldval&&void 0!==n.oldval.autoFit&&(r=n.oldval.autoFit),Object.isEmpty(r)||(this.parent.private.prop.autoFit=r)}if(e.isLocal){var i={data:this,cpStart:e.gcp,cpEnd:e.gcp+e.ccp};this._bubbleUpEvent(p.default.modify_fmt,i)}else this.fireBubbleUp(p.default.modify_fmt,e)}},{key:"txtStrmFmtPapxV2",value:function(e){var t={data:this,cpStart:e.gcp,cpEnd:e.gcp+e.ccp};this._bubbleUpEvent(p.default.modify_fmt,t)}},{key:"adjustTextInner",value:function(e,t){t?this.bareInsertText(e):this.bareDeleteText(e)}},{key:"bareInsertText",value:function(e){for(var t=e.text.split(""),r=e.gcp,n=t.length,i="",a=r;a<this.text.length;a++)i+=this.text[a];for(var o=(i=e.text+i).length,s=0;s<o;s++)this.text[r]=i[s],r++;this.fireInsertText(e.gcp,n)}},{key:"bareDeleteText",value:function(e){if(e.isPaste){var t=this.text.slice(e.gcp,e.gcp+e.text.length).join("");e.text=t,delete e.isPaste}this.text.splice(e.gcp,e.text.length),this.fireDeleteText(e.gcp,e.text.length)}},{key:"fireInsertText",value:function(e,t){var r={data:this,cpStart:e,cpEnd:e+t};this._bubbleUpEvent(p.default.insert_text,r);for(var n=this.observers.length,i=0;i<n;++i)this.observers[i].onInsertTextObserved(e,t)}},{key:"fireDeleteText",value:function(e,t){var r={data:this,cpStart:e,cpEnd:e+t};this._bubbleUpEvent(p.default.delete_text,r);for(var n=this.observers.length,i=0;i<n;++i)this.observers[i].onDeleteTextObserved(e,t)}},{key:"fireBubbleUp",value:function(e,t){this.chpTbl.validateData(this.text.length),this.papTbl.validateData(this.text.length);var r={data:this,cpStart:t.gcp,cpEnd:t.gcp};Object.isEmpty(t.ccp)?r.cpEnd+=t.text.length:r.cpEnd+=t.ccp,this._bubbleUpEvent(e,r)}},{key:"canTabIndent",value:function(e,t,r){var n=this.getParaTbl().getItems(t,r);if(0===n.length)return!1;for(var i=!0,a=0,o=n.length;a<o;++a){var s=n[a],l=validateGetField(s.getProp(),"outline");if(e){if(l<=0){i=!1;break}}else if(l>=8){i=!1;break}}return i}},{key:"matchText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||0===e.length)return[];e=e.toLowerCase();var r=this.text.join("").toLowerCase(),n=[],i=0,a=-1,o=t&&t[this.create_token];if(o&&o.length>0){for(var s=[],l=0;l<o.length;++l)o[l].isValid()&&o[l]._proxyState.isReplaced&&s.push(o[l].getState());s.sort((function(e,t){return e.begin-t.begin}));for(var u=0;u<s.length;++u){var c=s[u],h=c.begin,d=c.end;for(a=r.indexOf(e,i);a>-1&&a+e.length<=h;){var p=new P.b(this,e,a,a+e.length);n.push(p),a=r.indexOf(e,a+e.length)}i=d}}for(a=r.indexOf(e,i);a>-1;){var f=new P.b(this,e,a,a+e.length);n.push(f),a=r.indexOf(e,a+e.length)}return n}},{key:"begin",get:function(){return 0}},{key:"end",get:function(){return this.text.length}},{key:"isTextStream",get:function(){return!0}}]),t}(h.a);t.a=E},2663:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(875),d=r(543),p=r(763),f=r(268),v=r(167),y=r(461),g=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"getAnchor",value:function(){return this._coredata.private.anchor}},{key:"isAnchorCenter",value:function(){return this._coredata.private.anchorCenter}},{key:"hasHoriOverflow",value:function(){return this._coredata.private.horzOverflow}},{key:"getTxtDirection",value:function(){return this._coredata.private.textDirection}},{key:"getMargin",value:function(){return this._coredata.private.margin}},{key:"getPos",value:function(){var e=this._coredata,t=e.parent;if(!t)return{row:-1,col:-1};for(var r=t.getColumnCount(),n=t.getChilds(),i=0;i<n.length;++i){if(t.getChildAt(i)===e)return{row:Math.floor(i/r),col:i%r}}return{row:-1,col:-1}}},{key:"getTableCell3D",value:function(){return this._coredata.private.tableCell3D}},{key:"getFill",value:function(){var e=this._coredata;if(e.private.fill)return Object(f.a)(e.private.fill);var t=this.getPartStyle("fill");if(t){var r=t.private.cellStyle;if(r)return Object(f.a)(r.fill)}return null}},{key:"getFillNoStyle",value:function(){var e=this._coredata;return e.private.fill?Object(f.a)(e.private.fill):e.private.fill}},{key:"setOpacity",value:function(e){var t=this.getFillProp();if(t&&(t.type===v.FillType.FillTypeSolidColor||t.type===v.FillType.FillTypeBlip||t.type===v.FillType.FillTypeGradient||t.type===v.FillType.FillTypePattern)){var r=Object(f.a)(t),n=window.CoreUtils.createModifier("Color",r.color);return n.setOpacity(e),r.color=n.modifiedData(),r._isFullValue=!0,this.setFill(r)}return{}}},{key:"getFillProp",value:function(){return this.getFill()}},{key:"getRowBegin",value:function(){return this._getCellGridData().startRow}},{key:"getColBegin",value:function(){return this._getCellGridData().startCol}},{key:"getRowEnd",value:function(){return this._getCellGridData().endRow}},{key:"getColEnd",value:function(){return this._getCellGridData().endCol}},{key:"getBorder",value:function(){return this._coredata.private.border||{}}},{key:"getBorderProp",value:function(e){var t=this.getBorder();switch(e){case v.TblBorderType.Left:return t.left;case v.TblBorderType.Right:return t.right;case v.TblBorderType.Top:return t.top;case v.TblBorderType.Bottom:return t.bottom}return null}},{key:"setBorderProp",value:function(e,t){var r=this._coredata,n=r.private.border,i={};n&&(i=Object(f.a)(n));var a=!1;switch(e){case v.TblBorderType.Left:i.left&&(i.left=t,a=!0);break;case v.TblBorderType.Right:i.right&&(i.right=t,a=!0);break;case v.TblBorderType.Top:i.top&&(i.top=t,a=!0);break;case v.TblBorderType.Bottom:i.bottom&&(i.bottom=t,a=!0)}return!!a&&r.setPropertyValue("border",i)}},{key:"getCell3D",value:function(){return this._coredata.private.tableCell3D}},{key:"getRange",value:function(){var e=this._getCellGridData();return{startRow:e.startRow,startCol:e.endRow,endRow:e.endRow,endCol:e.endCol}}},{key:"_getCellGridData",value:function(){var e=this._coredata.parent;if(!e)return null;var t=this._coredata;return e._visual.getCellGridDataByCell(t)}},{key:"isLeftBorder",value:function(){return 0===this._getCellGridData().startCol}},{key:"isTopBorder",value:function(){return 0===this._getCellGridData().startRow}},{key:"setFill",value:function(e){return this._coredata.modifyPrivate("fill",e,!0)}},{key:"checkOutline",value:function(e){(!e.width||e.width<12700)&&(e.width=12700),null==e.dashType&&(e.dashType=0),null==e.compoundLine&&(e.compoundLine=0),e.fill||(e.fill={color:{isAutoColor:!1,sRgb:11449792,toRGB:"#ffaeb5c0",type:0,transOp:[{op:0,val:1}]},type:2})}},{key:"setOutLine",value:function(e,t){var r=this._coredata;this.checkOutline(e);var n=this.getBorder(),i=Object(f.a)(n);switch(t){case v.TblBorderType.Top:i.top=e;break;case v.TblBorderType.Left:i.left=e;break;case v.TblBorderType.Right:i.right=e;break;case v.TblBorderType.Bottom:i.bottom=e;break;default:return!1}return r.setPropertyValue("border",i),!0}},{key:"getPartStyleProp",value:function(e,t){if(e){if("textStyle"===t)return e.private.textStyle;var r=e.private.cellStyle;return r&&r[t]}}},{key:"getPartStyle",value:function(e){var t,r,n=this.coredata.parent;if(n){var i=n.visual.interpretedStyle(),a=this.getPos(),o=a.row,s=a.col;if(i&&o>=0&&s>=0){var l={startRow:o,endRow:o+1,startCol:s,endCol:s+1},u=n.getRowCount(),c=n.getColumnCount(),h=n.visual;if(0===l.startRow&&l.endCol===c&&h.useneCell&&this.getPartStyleProp(i.private.neCell,e))return i.private.neCell;if(0===l.startRow&&0===l.startCol&&h.usewwCell&&this.getPartStyleProp(i.private.nwCell,e))return i.private.nwCell;if(l.endRow===u&&l.endCol===c&&h.useseCell&&this.getPartStyleProp(i.private.seCell,e))return i.private.seCell;if(l.endRow===u&&0===l.startCol&&h.useswCell&&this.getPartStyleProp(i.private.swCell,e))return i.private.swCell;if(0===l.startRow&&h.useFirstRow&&this.getPartStyleProp(i.private.firstRow,e))return i.private.firstRow;if(l.endRow===u&&h.useLastRow&&this.getPartStyleProp(i.private.lastRow,e))return i.private.lastRow;if(0===l.startCol&&h.useFirstCol&&this.getPartStyleProp(i.private.firstColumn,e))return i.private.firstColumn;if(l.endCol===c&&h.useLastCol&&this.getPartStyleProp(i.private.lastColumn,e))return i.private.lastColumn;var d=h.useFirstRow?1:0,p=h.useFirstCol?1:0,f=function(e,t){return(t-e)%2==0};if(h.usebandRow&&(t=l.startRow,r=l.endRow,!(h.useFirstRow&&0===t||h.useLastRow&&r===u)||"fill"!==e))if(f(d,o)){if(this.getPartStyleProp(i.private.band1H,e))return i.private.band1H}else if(this.getPartStyleProp(i.private.band2H,e))return i.private.band2H;if(h.usebandCol&&!function(t,r){return(h.useFirstRow&&0===t||h.useLastCol&&r===c)&&"fill"===e}(l.startCol,l.endCol))if(f(p,s)){if(this.getPartStyleProp(i.private.band1V,e))return i.private.band1V}else if(this.getPartStyleProp(i.private.band2V,e))return i.private.band2V;if(this.getPartStyleProp(i.private.wholeTable,e))return i.private.wholeTable}}return null}},{key:"_getTableTextStyle",value:function(){var e=this.coredata.parent;if(e){var t=e.private.styleid;if(this._tableTextStyle&&this._tableTextStyle.styleToken===t)return this._tableTextStyle;var r=Object(f.a)(this.getPartStyle("textStyle"));if(r){var n=null,i=r.private.textStyle,a={};if(["fontSize","bold","italic","underline"].forEach((function(e){null!=i[e]&&(a[e]=i[e])})),i.fontColor&&(a.textColor={type:2,color:i.fontColor}),i.textStyleSheet){var o=i.textStyleSheet;a=Object.assign({},o.private.prop,a)}n={chpStyles:[]};for(var s=0;s<9;++s)n.chpStyles.push({prop:a});return this._tableTextStyle={styleToken:t,style:n},this._tableTextStyle}}return{styleToken:""}}},{key:"getTextStyle",value:function(e,t){var r=this.getTextStyleSheets(e,t);return r&&!r.bMerged&&(r.style=Object(y.deepMergeWithConfigs)(r.styles,y.TextStyleConfig),r.bMerged=!0),r}},{key:"getTextStyleSheets",value:function(e){var t=this,r=this._getTableTextStyle(),n=function(){for(var r=null,n=t.getParent();n;){if(n.getTextStyleSheets){r=n.getTextStyleSheets(e);break}n=n.getParent()}return r}(),i=Object(y.hash)(n.styleToken+r.styleToken);if(this._textStyleCache&&this._textStyleCache.styleToken===i)return this._textStyleCache;var a=[];return n.bMerged?n.style&&(a=[n.style]):a=n.styles,r.style&&(a=a.concat(r.style)),this._textStyleCache={styleToken:i,style:null,styles:a,matchShapes:n.matchShapes,bMerged:!1},this._textStyleCache}},{key:"setBorderLineStyle",value:function(e,t){var r=this._coredata,n=Object(f.a)(this.getBorder());switch(n||(n={}),e){case v.TblBorderType.Top:return n.top=t,r.modifyPrivate("border",n,!0);case v.TblBorderType.Bottom:return n.bottom=t,r.modifyPrivate("border",n,!0);case v.TblBorderType.Left:return n.left=t,r.modifyPrivate("border",n,!0);case v.TblBorderType.Right:return n.right=t,r.modifyPrivate("border",n,!0);case v.TblBorderType.TL2B:return n.tl2br=t,r.modifyPrivate("border",n,!0);case v.TblBorderType.TR2BL:return n.tr2bl=t,r.modifyPrivate("border",n,!0)}}},{key:"setBorderDirectly",value:function(e){return this._coredata.modifyPrivate("border",e,!0)}},{key:"resetBorder",value:function(){var e={fill:{type:0}};return this.setBorderLineStyle(v.TblBorderType.Top,e),this.setBorderLineStyle(v.TblBorderType.Left,e),this.setBorderLineStyle(v.TblBorderType.Right,e),this.setBorderLineStyle(v.TblBorderType.Bottom,e),this.setBorderLineStyle(v.TblBorderType.TL2BR,e),this.setBorderLineStyle(v.TblBorderType.TR2BL,e),!0}}]),t}(p.a);var m=r(446),_=r(927),S=r(315),T=r(262),b=r(158),k=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.private=e.data,r.data_token=Object(S.a)(),r.tree_token=r.data_token,r.listDelegate=new C(r),r._visual=new g(r),r.batchNotify=!1,Object(h.a)(r),r}return c()(t,e),o()(t,[{key:"initData",value:function(e,t,r){if(this.private.idx=t,r){var n=_.a.createNewTextFrame(e);this.private.childs[0]=n}}},{key:"matchText",value:function(e){if(!e)return null;var t=this.getTextFrame();return t&&t.matchText?t.matchText(e):null}},{key:"setBatchNotify",value:function(e){this.batchNotify=e}},{key:"_fireChanged",value:function(){this.batchNotify||this._bubbleUpEvent(T.default.modify_table_cell,{data:this})}},{key:"buildTree",value:function(e){this.parent=e;var t=this.private.childs;if(t)for(var r=0,n=t.length;r<n;++r){var i=t[r];i&&i.buildTree&&i.buildTree(this)}}},{key:"_bubbleUpEvent",value:function(e,t){T.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(S.a)():this.tree_token=Object(S.a)());var r=this.parent;t.parent=r,r&&r._bubbleUpEvent&&(t.cellRange=r.getCellRange(this),r._bubbleUpEvent(e,t))}},{key:"getTextFrame",value:function(){var e=this.private.childs;return e&&e[0]}},{key:"getBorder",value:function(){return this.private.border}},{key:"getIdx",value:function(){return this.private.idx}},{key:"hasText",value:function(){var e=this.getTextFrame();return e&&e.getTextStream().getCharCount()>1}},{key:"modifyPrivate",value:function(e,t,r){this.setPropertyValue(e,r?Object(f.a)(t):t);var n={};return Object.isEmpty(t)?n.undefineds=[e]:n[e]=r?Object(f.a)(t):t,{newval:n}}},{key:"cloneProp",value:function(e){this.cloneTxtProp(e);var t=e.visual.getBorderProp(b.TblBorderType.Left);t&&this.visual.setBorderProp(b.TblBorderType.Left,t);var r=e.visual.getBorderProp(b.TblBorderType.Right);r&&this.visual.setBorderProp(b.TblBorderType.Right,r);var n=e.visual.getBorderProp(b.TblBorderType.Top);n&&this.visual.setBorderProp(b.TblBorderType.Top,n);var i=e.visual.getBorderProp(b.TblBorderType.Bottom);i&&this.visual.setBorderProp(b.TblBorderType.Bottom,i);var a=e.visual.getFill();a&&this.visual.setFill(a)}},{key:"cloneTxtProp",value:function(e){e.visual.getAnchor()?this.setPropertyValue("anchor",e.visual.getAnchor()):this.setPropertyValue("anchor",null),e.visual.isAnchorCenter()?this.setPropertyValue("anchorCenter",e.visual.isAnchorCenter()):this.setPropertyValue("anchorCenter",null),e.visual.hasHoriOverflow()?this.setPropertyValue("horzOverflow",e.visual.hasHoriOverflow()):this.setPropertyValue("horzOverflow",null),e.visual.getTxtDirection()?this.setPropertyValue("textDirection",e.visual.getTxtDirection()):this.setPropertyValue("textDirection",null),e.visual.getMargin()?this.setPropertyValue("margin",e.visual.getMargin()):this.setPropertyValue("margin",null)}},{key:"addTextFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.insert(t,e)}},{key:"removeTextFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.remove(e)}},{key:"isTableCell",get:function(){return!0}},{key:"visual",get:function(){return this._visual}}]),t}(d.a),C=(t.a=k,function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.cell=e,r.listener.on(m.b.INSERT,(function(e){return r._onDataChanged(T.default.op_add,e)})),r.listener.on(m.b.REMOVE,(function(e){return r._onDataChanged(T.default.op_remove,e)})),r}return c()(t,e),o()(t,[{key:"_onDataChanged",value:function(e,t){var r=[];e===T.default.op_add||e===T.default.op_modify?r=[t.value]:e===T.default.op_replace&&(r=t.value);for(var n=this.cell,i=0;i<r.length;i++){var a=r[i];a.buildTree?a.buildTree(n):a.parent=n}this.cell._fireChanged()}},{key:"_fireChanged",value:function(){this.cell._fireChanged()}},{key:"listAtomProperties",get:function(){return["childs"]}}]),t}(m.c));Object(m.e)(k.prototype,!1),Object(m.d)(k,{ListAtomDelegateClass:C,selfAtomeType:"customAtom"})},2669:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(543),d=r(262),p=r(315),f=r(268),v=r(470),y=r(154),g=r.n(y),m=r(763),_=r(167),S=r(461),T=r(360),b=r(606),k=r(1013),C=r(762),w=r(1383),P=r(809),x=r(808),O=r(2867),E=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"getBackgroundVisual",value:function(){var e=this.getSlideVisual();return e&&e.getBackgroundVisual()}},{key:"isRootShape",value:function(){var e=this._coredata.parent;return e&&e.isShapeTree}},{key:"getRootShape",value:function(){for(var e=this._coredata;e;){var t=e.parent;if(t&&t.isShapeTree)break;e=t}return e}},{key:"getCompleteProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this._coredata,i=function(r){return null!=t?t(r):r.private[e]};if(n.isPlaceHolder()){var a=i(n),o=[a],s=n.getSlideFollowing();if(s)for(var l=s.getPhShapes(n),u=0;u<l.length;u++){var c=i(l[u].shape);o.splice(0,0,c)}var h=Object.assign({bClone:!0},r);return Object(S.deepMergeWithConfigs)(o,h)}return i(n)}},{key:"getAllProperties",value:function(){var e=this.coredata.getProperty();return e.transform2D=this.getTransform2D(),e.geometry2D=this.getGeometry2D(),e.fill=this.getFill(),e.outline=this.getOutline(),e.effects=this.getEffects(),e.scene3D=this.getScene3D(),e.shape3D=this.getShape3D(),e.picture=this.getPicture(),e}},{key:"isBackgroundFillUsed",value:function(){var e=this.coredata.getFill();return(!e||e.type===_.FillType.FillTypeBackground)&&this.coredata.private.backgroundFillUsed}},{key:"getFillProp",value:function(){var e=this._coredata,t=e.getFill(),r=null,n=e.getStyle();if(n&&null!=n.fillIndex){var i=this.getTheme();i&&(r=Object(S.deepClone)(i.getFormatScheme().getFillAt(n.fillIndex)))}return r&&t&&r.type===t.type?Object(S.deepMergeWithConfigs)([r,t],S.FillMergeConfig):t?Object(S.deepClone)(t):Object(S.deepClone)(r)}},{key:"getFill",value:function(){var e=this;if(this.isBackgroundFillUsed()){if(this.isBackground())return this.getFillProp();var t=this.getBackgroundVisual();return t&&t.getFill()}var r=this.getCompleteProperty("fill",(function(t){var r=t.visual,n=r.getFillProp();if(n)if(n.type===_.FillType.FillTypeGroup){var i=r.getParent();n=i?i.getFill():null}else if(n.type===_.FillType.FillTypeBackground)if(e.isBackground())n=null;else{var a=e.getBackgroundVisual();n=a&&a.getFillProp()}return n}),S.FillMergeConfig);return r||(r={type:_.FillType.FillTypeNone}),r}},{key:"setFill",value:function(e){var t=this._coredata;return t.getShapeGroup()!==v.ShapeGroupType.LineGroup?t.setFill(e):{newval:{}}}},{key:"setOpacity",value:function(e){var t=this.getFillProp();if(t&&(t.type===_.FillType.FillTypeSolidColor||t.type===_.FillType.FillTypeBlip||t.type===_.FillType.FillTypeGradient||t.type===_.FillType.FillTypePattern)){var r=Object(S.deepClone)(t),n=window.CoreUtils.createModifier("Color",r.color);return n.setOpacity(e),r.color=n.modifiedData(),r._isFullValue=!0,this.setFill(r)}return{newval:{}}}},{key:"getOutlineProp",value:function(){var e=this._coredata,t=e.getOutline(),r=null,n=e.getStyle();if(n&&null!=n.lineIndex){var i=this.getTheme();i&&(r=Object(S.deepClone)(i.getFormatScheme().getLineAt(n.lineIndex)))}return Object(S.deepMergeWithConfigs)([r,t],S.OutlineMergeConfig)}},{key:"getOutline",value:function(){return this.getCompleteProperty("outline",(function(e){return e.visual.getOutlineProp()}),S.OutlineMergeConfig)}},{key:"setOutline",value:function(e){return this._coredata.setOutline(e)}},{key:"setPicture",value:function(e){return this._coredata.setPicture(e)}},{key:"getTransform2D",value:function(){var e=Object(S.deepClone)(this.getCompleteProperty("transform2D"));return e||{x:0,y:0,width:1440,height:1440,horizontalFlipped:!1,rotation:0,verticalFlipped:!1}}},{key:"geometryTransform",value:function(){var e=this.getTransform2D();if(this.coredata.isChildShape()){if(e.width<0||e.height<0)return Object.assign(e,{x:0,y:0,width:0,height:0});var t=this.getParent(),r=t.geometryTransform(),n=t.coredata.private,i=n.childOffset,a=n.childExtents,o=a.width,s=a.height,l={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height};if(o>0||s>0){var u=1,c=1;Object(T.l)(o)||(u=r.width/o),Object(T.l)(s)||(c=r.height/s);var h=this.calcShapePosData(l,u,c,e.rotation);return Object.assign(e,h)}return Object.assign(e,l)}return e.x=e.x*(1/635),e.y=e.y*(1/635),e.width=(e.width||1)*(1/635),e.height=(e.height||1)*(1/635),e}},{key:"getRotationProp",value:function(){return this.getTransform2D().rotation}},{key:"getRotation",value:function(){for(var e=this.getRotationProp(),t=this.getParent();t;){var r=t.coredata;if(!r||!r.isGroupShape()||r.isShapeTree)break;var n=t.getTransform2D(),i=n.horizontalFlipped,a=n.verticalFlipped;e=n.rotation+e*(i?-1:1)*(a?-1:1),t=t.getParent()}return Object(m.b)(e)}},{key:"getAnchorRect",value:function(){var e=this._rect(),t={x:e.x+e.width/2,y:e.y+e.height/2},r=this.calcTransFromCurrent2Layer().Map(t);return new window.Rect(r.x-e.width/2,r.y-e.height/2,e.width,e.height)}},{key:"getRealTransform2D",value:function(){for(var e=this._coredata,t=this.getAnchorRect().getRect(),r=this.getTransform2D(),n=r.horizontalFlipped,i=r.verticalFlipped,a=e.parent;a&&a.isGroupShape()&&!a.isShapeTree;){var o=a.visual.getTransform2D();n=n!==o.horizontalFlipped,i=i!==o.verticalFlipped,a=a.parent}var s=this.getRotation();return{x:635*t.x,y:635*t.y,width:635*t.width,height:635*t.height,rotation:s,horizontalFlipped:n,verticalFlipped:i}}},{key:"getConnectionSiteCount",value:function(){if(this.connectionSites)return this.connectionSites.length;var e=this.getGeometry2D(),t=e&&e.getGeometry();return t&&t.getConnectionCount()}},{key:"setConnectionSites",value:function(e){this.connectionSites=e}},{key:"getConnectionSites",value:function(){if(!this.connectionSites){var e=this.getGeometry2D().geometry;this.connectionSites=e&&e.getConnectionSites()}return this.connectionSites}},{key:"transform2DScale",value:function(){var e=this._coredata,t={width:1,height:1};if(!e.parent)return t;for(var r=e.parent;r&&r.isGroupShape()&&!r.isShapeTree;){var n=r.private.childExtents,i=r.visual.getTransform2D();n.width&&(t.width=t.width*(i.width/n.width)),n.height&&(t.height=t.height*(i.height/n.height)),r=r.parent}return t.width=0===t.width?1:t.width,t.height=0===t.height?1:t.height,t}},{key:"transform2DRelativeToParent",value:function(e){var t={};if(this.coredata.isChildShape()){var r={x:e.x*(1/635),y:e.y*(1/635),width:e.width*(1/635),height:e.height*(1/635)},n=this.layerRectToCurrentRect(r),i=this.getParent(),a=i.calcChildPosData(n,i.getRotationProp());t=Object.assign({},e,a);var o=i.getRealTransform2D(),s=o.horizontalFlipped!==o.verticalFlipped,l=Object(m.b)(e.rotation);l=(l-o.rotation)*(s?-1:1),t.rotation=Object(m.b)(l),t.horizontalFlipped=e.horizontalFlipped!==o.verticalFlipped,t.verticalFlipped=e.verticalFlipped!==o.verticalFlipped}else t=Object.assign({},e);return t}},{key:"calcShapeRect",value:function(){var e=this.getTransform2D(),t=e.x+e.width/2,r=e.y+e.height/2,n=e.x,i=e.y,a=e.width,o=e.height;return this.isSwapWidthAndHeight(e.rotation)&&(n=t-o/2,i=r-a/2,a=e.height,o=e.width),{left:Object(m.d)(n),top:Object(m.d)(i),right:Object(m.d)(n+a),bottom:Object(m.d)(i+o)}}},{key:"updatePosInfo",value:function(){var e=this._coredata,t=e.parent,r=e.isChildShape();if(e.isGroupShape()){for(var n=e.private.childs,i=[],a=0;a<n.length;a++){var o=n[a].visual.calcShapeRect();i.push({shape:n[a],rect:o})}if(i.length>0){for(var s=i[0].rect,l=1;l<i.length;l++)s=this.caleMaxBound(s,i[l].rect);s.x=s.left,s.y=s.top,s.width=s.right-s.left,s.height=s.bottom-s.top;var u=e.private.childOffset,c=e.private.childExtents,h=Object.assign({},u,c),d=0===h.width?0:(s.x-h.x)/h.width,p=0===h.height?0:(s.y-h.y)/h.height,f=this.getTransform2D(),v={x:f.x,y:f.y},y={width:f.width,height:f.height},g={x:v.x+y.width/2,y:v.y+y.height/2},_={x:v.x+d*y.width,y:v.y+p*y.height},S={width:0===h.width?0:y.width*s.width/h.width,height:0===h.height?0:y.height*s.height/h.height},T={x:_.x+S.width/2,y:_.y+S.height/2},b=this.calcFlipRotatedTransform(g,Object(m.b)(f.rotation),f.horizontalFlipped,f.verticalFlipped).Map(T);f.x=b.x-S.width/2,f.y=b.y-S.height/2,f.width=S.width,f.height=S.height,e.setPropertyValue("childOffset",{x:s.x,y:s.y}),e.setPropertyValue("childExtents",{width:s.width,height:s.height}),e.setPropertyValue("transform2D",f),r&&t.visual.updatePosInfo()}}else r&&t.visual.updatePosInfo()}},{key:"modifyShapeTransform2D",value:function(e){var t=this.getRealTransform2D(),r=window.CoreUtils.createModifier("Transform2D",t);for(var n in e)r.modify(n,e[n]);var i=r.modifiedData();i.width<0&&(i.width=-i.width),i.height<0&&(i.height=-i.height);var a={},o={transform2DInfo:a},s=this._coredata,l=s.getTextFrame();if(l&&l.private.prop&&(t.width!==e.width||t.height!==e.height)&&l.private.prop.autoFit===v.TextAutoFitType.AdvancedAutoFit){var u=window.CoreUtils.createModifier("TextFrameProps",l.getProperty());u.modify("autoFit",_.AutoFit.None),u.modify("textWrap",_.TextWrap.Square);var c=u.modifiedData();delete c.textInset,l.modifyProps(c);var h={textFrameProps:c};o=Object.assign(o,h)}if(t.x!==i.x||t.y!==i.y||t.width!==i.width||t.height!==i.height){var d=b.a.create(i);d.scale(1/635,1/635),this.setAnchorRect(d);var p={},f={x:i.x-t.x,y:i.y-t.y,width:i.width-t.width,height:i.height-t.height};Object(T.l)(f.width)&&Object(T.l)(f.height)?(p.x=i.x,p.y=i.y,f.x=0,f.y=0):(p.width=i.width,p.height=i.height,f.width=0,f.height=0),o.extendProps={transform:f},a.rect=p,o.anchorRect=d.getAlignedBounds()}if(t.verticalFlipped!==i.verticalFlipped||t.horizontalFlipped!==i.horizontalFlipped||t.rotation!==i.rotation){var y=this._calcFlipRotation(t,i.horizontalFlipped,i.verticalFlipped,t.rotation!==i.rotation?i.rotation:null),g=y.transform2d,m=y.changed;if(s.isInk()||s.isGroupShape()){var S=t.horizontalFlipped!==i.horizontalFlipped,k=t.verticalFlipped!==i.verticalFlipped;this._dealInkShapeFlip(s,S,k)}if(s.setTransform2D(g),a.flipRotation=m,this.coredata.isChildShape()){var C=this.getParent();C&&C.updatePosInfo()}}return O.a.updateAllConnections(this.coredata),{newval:o}}},{key:"_dealInkShapeFlip",value:function(e,t,r){var n=this;e.isGroupShape()&&e.getChilds().forEach((function(e){(e.isInk()||e.isGroupShape())&&n._dealInkShapeFlip(e,t,r)}));if(e.isInk()){var i=Object(S.deepClone)(e.getInkData()),a=i.vecTrace;if(a.length&&a[0].vecPoints.length){for(var o=a[0].vecPoints[0].px,s=a[0].vecPoints[0].py,l=o,u=s,c=0,h=a.length;c<h;c++)for(var d=a[c].vecPoints,p=0,f=d.length;p<f;p++){var v=d[p],y=v.px,g=v.py;y>l?l=y:y<o&&(o=y),g>u?u=g:g<s&&(s=g)}for(var m={x:o+(l-o)/2,y:s+(u-s)/2},_=this.calcFlipRotatedTransform(m,0,t,r),T=0,b=a.length;T<b;T++){for(var k=a[T].vecPoints,C=_.Map({x:k[0].px,y:k[0].py}),w=C.x+" "+C.y,P=0,x=k.length;P<x;P++){var O=k[P],E=_.Map({x:O.px,y:O.py});if(k[P]={px:E.x,py:E.y},P>0)w+=","+(E.x-C.x)+" "+(E.y-C.y),C=E}a[T].strPoints=w}}e.setInkData(i)}}},{key:"_calcFlipRotation",value:function(e,t,r,n){var i=this.getTransform2D(),a=this.coredata,o={};if(a.canRotate()&&null!=t&&e.horizontalFlipped!==t&&(i.horizontalFlipped=!i.horizontalFlipped,o.horizontalFlipped=t,this.coredata.isInk()||(n=Object(m.b)(null==n?-e.rotation:n))),a.canRotate()&&null!=r&&e.verticalFlipped!==r&&(i.verticalFlipped=!i.verticalFlipped,o.verticalFlipped=r,this.coredata.isInk()||(n=Object(m.b)(null==n?-e.rotation:n))),null!=n&&e.rotation!==n){if(this.coredata.isChildShape()){var s=this.getParent().getRealTransform2D(),l=s.horizontalFlipped!==s.verticalFlipped;i.rotation=Object(m.b)((n-s.rotation)*(l?-1:1))}else i.rotation=Object(m.b)(i.rotation+(n-e.rotation));o.rotation=n}return{transform2d:i,changed:o}}},{key:"setRotation",value:function(e){var t=this._calcFlipRotation(this.getRealTransform2D(),null,null,e),r=t.transform2d,n=t.changed;return this.coredata.setTransform2D(r),{newval:{transform2DInfo:{flipRotation:n}}}}},{key:"setAnchorRect",value:function(e){var t=b.a.create(e),r=t.getRect(),n=this.getTransform2D(),i=void 0;if(this.coredata.isChildShape()){var a=this.layerRectToCurrentRect(r),o=this.getParent().calcChildPosData(a,this.getRotation());i=Object.assign({},n,o)}else i=Object.assign({},n,{x:635*r.x,y:635*r.y,width:635*r.width,height:635*r.height});var s=this.coredata,l=s.setTransform2D(i);if(l&&!s.isGroupShape()&&(n.width!==i.width||n.height!==i.height))for(var u=s.private.childs,c=i.width/n.width,h=i.height/n.height,d=0;d<u.length;d++){var p=u[d];if(p.modifySize){if(!p.modifySize(c,h))return}else if(p.visual&&p.visual.modifySize&&!p.visual.modifySize(c,h))return}if(this.coredata.isChildShape()){var f=this.getParent();f&&f.updatePosInfo()}if(O.a.updateAllConnections(s),l)return{newval:{rect:t.getAlignedBounds()}}}},{key:"setAnchorOffset",value:function(e){var t=this.getAnchorRect();t.moveTopLeft(e),this.setAnchorRect(t.getRect())}},{key:"setAnchorSize",value:function(e){var t=this.getAnchorRect();t.setSize(e),this.setAnchorRect(t.getRect())}},{key:"modifySize",value:function(e,t){var r=this.getAnchorRect();return this.setAnchorRect({x:r.x(),y:r.y(),width:r.width()*e,height:r.height()*t})}},{key:"setGeometry2D",value:function(e){var t=this.coredata.setGeometry2D(e);return O.a.updateAllConnections(this.coredata),t}},{key:"getGeometry2D",value:function(){var e=this._coredata;return e.hasTable()?e.private.geometry2D:this.getCompleteProperty("geometry2D",(function(e){return e.getGeometry2D()}),{deeps:0,clone:function(e){return e}})}},{key:"getEffectsProp",value:function(){var e=this.coredata,t=e.getEffects();if(!t){var r=e.getStyle();if(r&&null!=r.effectsIndex){var n=this.getTheme();n&&(t=n.getFormatScheme().getEffectsAt(r.effectsIndex))}}return Object(S.deepClone)(t)}},{key:"getEffects",value:function(){return this.getCompleteProperty("effects",(function(e){return e.visual.getEffectsProp()}))}},{key:"getScene3DProp",value:function(){var e=this.coredata,t=e.getScene3D();if(!t){var r=e.getStyle();if(r&&null!=r.effectsIndex){var n=this.getTheme();n&&(t=n.getFormatScheme().getScene3dAt(r.effectsIndex))}}return Object(S.deepClone)(t)}},{key:"getScene3D",value:function(){return this.getCompleteProperty("scene3D",(function(e){return e.visual.getScene3DProp()}))}},{key:"getShape3DProp",value:function(){var e=this.coredata,t=e.getShape3D();if(!t){var r=e.getStyle();if(r&&null!=r.effectsIndex){var n=this.getTheme();n&&(t=n.getFormatScheme().getShape3dAt(r.effectsIndex))}}return Object(S.deepClone)(t)}},{key:"getShape3D",value:function(){return this.getCompleteProperty("shape3D",(function(e){return e.visual.getShape3DProp()}))}},{key:"getPicture",value:function(){return Object(S.deepClone)(this.coredata.private.picture)}},{key:"getColorScheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){var t=e.colorScheme,r=this.coredata.getStyle();return r&&r.fillColor&&t.setPhColor(new k.a(r.fillColor)),t.setShape(this.coredata),t}return this.coredata.colorScheme}},{key:"setSimpleProperties",value:function(e){var t={};for(var r in e){var n=e[r];this.coredata.setPropertyValue(r,Object(S.deepClone)(n)),null!=n?t[r]=Object(S.deepClone)(n):(t.undefineds||(t.undefineds=[]),t.undefineds.push(r))}return{newval:t}}},{key:"getShapeTextStyle",value:function(){var e=this.getShapeTextStyleSheets();if(e&&!e.bMerged){var t=Object(S.deepMergeWithConfigs)(e.styles,{deeps:2,bClone:!0}),r=(t||{}).fontColor,n={chpStyles:[],paraStyles:[]};if(r)for(var i=0;i<9;i++)n.chpStyles.push({prop:{textColor:{type:2,color:r}}});e.style=t,e.textStyle=n,e.bMerged=!0}return e.style}},{key:"getShapeTextStyleSheets",value:function(){var e=this.coredata,t=[{shape:e}],r=null;if(e.isPlaceHolder()){var n=e.getSlide(),i=n&&n.getFollowing();if(i)for(var a=i.getPhShapes(e),o=0;o<a.length;o++)t.splice(0,0,a[o]);r=t}for(var s="",l=[],u=0;u<t.length;u++){var c=t[u].shape;s+=c.data_token;var h=c.getStyle();h&&l.push(h)}if(s=Object(S.hash)(s),this._shapeStyle&&s===this._shapeStyle.styleToken)return this._shapeStyle;for(var d=[],p=0;p<l.length;p++){var f=(l[p]||{}).fontColor,v={chpStyles:[],paraStyles:[]};if(f)for(var y=0;y<9;y++)v.chpStyles.push({prop:{textColor:{type:2,color:f}}});d.push(v)}return this._shapeStyle={styleToken:s,shapes:r,style:null,textStyle:null,styles:l,textStyles:d,bMerged:!1},this._shapeStyle}},{key:"getTextStyle",value:function(e,t){var r=this.getTextStyleSheets(e,t);return r&&!r.bMerged&&(r.style=Object(S.deepMergeWithConfigs)(r.styles,S.TextStyleConfig),r.bMerged=!0),r}},{key:"getTextStyleSheets",value:function(e){var t=this,r=this.coredata,n=!1,i=r.hasTable(),a=this.isRootShape();a&&(n=r.isPlaceHolder());var o=this.getShapeTextStyleSheets(),s=o.styleToken,l=o.textStyle,u=o.textStyles,c=o.shapes,h=function(){var o=window.APP.presentation,s={styleToken:""};if(i)s=t.getSlideVisual().getTextStyle(_.TextStyleType.Other);else if(n){var l=t.getSlideVisual(),u=r.getPlaceHolder();if(C.a.isHeaderFooter(u.type)){var c=o.getDefaultTextStyle();s.style=c,s.styles=[c],s.isDefault=!0}else s=l.getTextStyle(e)}else if(a){var h=o.getDefaultTextStyle();s.style=h,s.styles=[h],s.isDefault=!0}else for(var d=t.getParent();d;){if(d.getTextStyleSheets){s=d.getTextStyleSheets();break}d=d.getParent()}return s}(),d=Object(S.hash)(h.styleToken+s);if(this._textStyleCache&&d===this._textStyleCache.styleToken)return this._textStyleCache;var p=[];return h.bMerged?h.style&&p.push(h.style):p=h.styles,u.length>0&&(o.bMerged?p.push(l):p=p.concat(u)),this._textStyleCache={style:null,styleToken:d,styles:p,matchShapes:h.matchShapes,bMerged:!1,isRootShape:a},a&&(this._textStyleCache.matchShapes={shape:r,shapes:c}),this._textStyleCache}},{key:"useMasterTextStyle",value:function(){var e=this.coredata;if(e.hasTable())return!0;if(e.isPlaceHolder()){var t=e.getPlaceHolder();return!C.a.isHeaderFooter(t.type)}return!1}},{key:"getTagsWrapper",value:function(){if(!this.coredata.hasTags())return null;var e=this.coredata.getTags();return new w.b(e)}},{key:"interpretTextBoxRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.coredata;return r.hasTxGeometry2D()?r.getTxGeometry2D().interpretTextBoxRect(e,t):r.getGeometry2D().interpretTextBoxRect(e,t)}},{key:"updateShapeAnchorRect",value:function(e){if(!e&&!(e=window.selection.getCacheProps("textRect")))return;var t=this.geometryTransform();if(t){var r=new b.a(t.x,t.y,t.width,t.height),n={width:e.width,height:e.height},i={width:t.width,height:t.height},a=!1,o=this.coredata.getGeometry2D();if(o.hasGeometry2DData()){var s=o.interpretShapeSize(n,i);-1!=s.width&&-1!=s.height&&(r.setWidth(s.width),r.setHeight(s.height),a=!0)}if(!a){var l=new b.a;o.hasGeometry2DData()?l=b.a.create(this.interpretTextBoxRect(i)):(l.setWidth(i.width()),l.setHeight(i.height())),r.setWidth(e.width+i.width-l.width()),r.setHeight(e.height+i.height-l.height())}var u=this.coredata.getTextFrame(),c=u&&u.getProperty(),h=c&&null!=c.anchorType?c.anchorType:_.TextAnchoringType.Center,d=c&&null!=c.vertType?c.vertType:_.TextVerticalType.Horizontal,p=c&&null!=c.textWrap?c.textWrap:P.g.TextWrapNone;if(null!=u){if(d==_.TextVerticalType.Horizontal)switch(h){case _.TextAnchoringType.Center:r.moveTop(t.y-(r.height()-t.height)/2);break;case _.TextAnchoringType.Bottom:r.moveTop(t.y+t.height-r.height())}else switch(h){case _.TextAnchoringType.Center:r.moveLeft(t.x-(r.width()-t.width)/2);break;case _.TextAnchoringType.Top:d!=_.TextVerticalType.Vertical270&&r.moveLeft(t.x+t.width-r.width())}if(p==P.g.TextWrapSquare)d==_.TextVerticalType.Horizontal?r.setWidth(t.width):r.setHeight(t.height);else{var f=u.getAlignType(),v=new x.a;if(u.visual.isChangeRect(d))switch(f){case _.TextFrameAlignType.Center:v.setY((t.height-r.height())/2);break;case _.TextFrameAlignType.Right:v.setY(t.height-r.height())}else switch(f){case _.TextFrameAlignType.Center:v.setX(t.width-r.width()/2);break;case _.TextFrameAlignType.Right:v.setX(t.width-r.width())}r.translate(v)}}var y=this.calCurShapeRect2LayerRect(r);this.setAnchorRect(y)}}},{key:"calCurShapeRect2LayerRect",value:function(e){if(e){var t=e.center(),r=this.calcTransFromCurrent2Layer(),n={},i=this.transform().inverted(n).multiply(r);if(n.invertible){var a=i.mapPoint(t);return new b.a(a.x()-e.width()/2,a.y()-e.height()/2,e.width(),e.height())}}}}]),t}(m.a),I=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"setFill",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=g()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setFill",this).call(this,e);if(n&&r){for(var i=!0,a=this._coredata.childShapes,o=0;o<a.length&&(a[o].isInk()||(i=!!a[o].visual.setFill({type:6,_isFullValue:!0},r)));o++);if(!i)return null}return n}},{key:"setOpacity",value:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=g()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setOpacity",this).call(this,e);if(n&&r){for(var i=!0,a=this._coredata.childShapes,o=0;o<a.length&&(i=!!a[o].visual.setOpacity(e,r));o++);if(!i)return null}return n}},{key:"calcChildPosData",value:function(e,t){var r=this.coredata.private,n=r.childOffset,i=r.childExtents;if(i.width>0&&i.height>0){var a=this.geometryTransform(),o=a.width/i.width,s=a.height/i.height,l=this.calcShapePosData(e,1/o,1/s,t);return l.x=l.x+n.x,l.y=l.y+n.y,l}return{x:0,y:0,width:0,height:0}}}]),t}(E),A=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return c()(t,e),o()(t,[{key:"isBackground",value:function(){return!0}},{key:"geometryTransform",value:function(){var e=this.getSlideVisual();return e?e.geometryTransform():{x:0,y:0,width:1,height:1,horizontalFlipped:!1,verticalFlipped:!1,rotation:0}}}]),t}(E);var R=r(446),D=r(158),L=function(e){function t(e,r){i()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.private=e.data||{},n.formatPrivate(e.data),n.data_token=Object(p.a)(),n.tree_token=n.data_token,n._visual=function(e,t){switch(e){case"GroupShape":return new I(t);case"BackgroundShape":return new A(t)}return new E(t)}(r,n),n._backendHelper=null,n.on("onForward",(function(e){return n.__onForward(e)})),n.on("onBackward",(function(e){return n.__onBackward(e)})),n.listenPropertyChanged(["inkData","childs","extData"],(function(e,t,r){n._onPropertyChanged(e,t,r)})),n}return c()(t,e),o()(t,[{key:"getBackendShapeHelper",value:function(){return this._backendHelper}},{key:"setBackendShapeHelper",value:function(e){this._backendHelper=e}},{key:"_createFakeData",value:function(e,t){switch(e){case"transform2D":case"fill":case"outline":case"shape3D":case"scene3D":case"effects":return Object(f.a)(t)}}},{key:"createFakeShape",value:function(){var e=this.cloneFake(),t=null!=this.private.orgShapeId?this.private.orgShapeId:this.private.shapeId;return e.private.shapeId=window.APP.presentation.allocateLocalId(),e.private.orgShapeId=t,e}},{key:"formatPrivate",value:function(e){e&&e.inkData&&this._formatPrivate("inkData",e.inkData),e&&e.extData&&this._formatPrivate("extData",e.extData)}},{key:"__onForward",value:function(e){this.childsBuildTree()}},{key:"__onBackward",value:function(e){this.childsBuildTree()}},{key:"childsBuildTree",value:function(){for(var e=this.getChilds(),t=0;t<e.length;t++){var r=e[t];r.parent||(r.buildTree?r.buildTree(this):r.parent=this)}}},{key:"_onPropertyChanged",value:function(e,t,r){switch(e){case"inkData":case"extData":return this._formatPrivate(e,r);case"childs":return this.childsBuildTree()}}},{key:"getShapeTree",value:function(){var e=this.getSlide();return e&&e.getSpTree()}},{key:"getId",value:function(){return this.private.shapeId}},{key:"getType",value:function(){return this.private.type}},{key:"getDataToken",value:function(){return this.data_token}},{key:"getTreeToken",value:function(){return this.tree_token}},{key:"getParent",value:function(){return this.parent}},{key:"getSlide",value:function(){for(var e=this.getParent();e&&!e.isSlideType;)e=e.getParent();return e}},{key:"getSlideId",value:function(){var e=this.getSlide();return e&&e.getId()}},{key:"getSlideFollowing",value:function(){var e=this.getSlide();return e&&e.getFollowing()}},{key:"getTransform2D",value:function(){return this.private.transform2D}},{key:"getChildExtents",value:function(){return this.private.childExtents}},{key:"getChildOffset",value:function(){return this.private.childOffset}},{key:"getAngle",value:function(){return this.private.angle}},{key:"getFill",value:function(){return this.private.fill}},{key:"getPicture",value:function(){return this.private.picture}},{key:"getOutline",value:function(){return this.private.outline}},{key:"getEffects",value:function(){return this.private.effects}},{key:"getScene3D",value:function(){return this.private.scene3D}},{key:"getShape3D",value:function(){return this.private.shape3D}},{key:"getRect",value:function(){return this._rectToken===this.data_token||(this.private.rect=this.visual.getAnchorRect().getAlignedBounds(),this._rectToken=this.data_token),this.private.rect}},{key:"isGroupShape",value:function(){return this.private.group}},{key:"isPlaceHolder",value:function(){return this.private.placeholder}},{key:"isBackground",value:function(){return!!this.private.background}},{key:"isMedia",value:function(){return!!this.private.media||!(!this.private.flags||!this.private.flags.hasMedia)}},{key:"isVideo",value:function(){var e=this.getMedia();switch(e&&e.mediaType){case _.MediaType.presMediaVideo:case _.MediaType.presMediaAviVideo:return!0;default:return!1}}},{key:"isAudio",value:function(){var e=this.getMedia();switch(e&&e.mediaType){case _.MediaType.presMediaCDAudio:case _.MediaType.presMediaAudio:case _.MediaType.presMediaWavAudio:return!0;default:return!1}}},{key:"isMath",value:function(){return!(!this.private.flags||!this.private.flags.isMath)}},{key:"isLatexMath",value:function(){var e=this.getExtData();return e&&e.isLatexMath}},{key:"isOle",value:function(){return!(!this.private.flags||!this.private.flags.isOle)}},{key:"isControlShape",value:function(){return!(!this.private.flags||!this.private.flags.isControlShape)}},{key:"isOleControlShape",value:function(){return!(!this.private.flags||!this.private.flags.isOleControlShape)}},{key:"isBackgroundFillUsed",value:function(){return!!this.private.backgroundFillUsed}},{key:"isTextBox",value:function(){return this.getShapeType()===D.ShapeType.TextBox}},{key:"isQRCode",value:function(){var e=this.getExtData();return e&&e.isQrcode}},{key:"hasChartTemp",value:function(){var e=this.getChilds();return 1===e.length&&e[0].private.modelType===D.ShapeModeType.MODEL_CHART}},{key:"hasChart",value:function(){return this.hasChartTemp()}},{key:"hasTable",value:function(){var e=this.getChilds();return 1===e.length&&e[0].private.modelType===D.ShapeModeType.MODEL_OBJTABLE}},{key:"hasSmartArt",value:function(){var e=this.getChilds();if(!this.isGroupShape())return 1===e.length&&e[0].private.modelType===D.ShapeModeType.MODEL_SMARTART;for(var t=0;t<e.length;t++)if(e[t].hasSmartArt())return!0;return!1}},{key:"isInk",value:function(){return this.private.isInk}},{key:"getInkData",value:function(){return this.private.inkData}},{key:"isNiteInk",value:function(){var e=this.getInkData();if(e&&Array.isArray(e.vecTrace)&&e.vecTrace.length>0){var t=e.vecTrace[0].brushRef,r=e.brushMap,n=r&&r[t];if(n&&1===n.tip)return!0}return!1}},{key:"isConnector",value:function(){return null!=this.private.connector}},{key:"getConnector",value:function(){if(!this.isConnector())return null;var e={},t=this.private.connector||{},r=t.startConnector,n=t.endConnector;return r&&r.site>=0&&(e.startConnector=r),n&&n.site>=0&&(e.endConnector=n),e}},{key:"isConnected",value:function(){var e=this,t=this.getSlide(),r=t&&t.getShapeTree(),n=r&&r.getChildShapesRecurse((function(t){if(!t.isConnector())return!1;for(var r=[t.startConnection(),t.endConnection()],n=0;n<r.length;++n){var i=r[n];if((i&&i.shapeId)===e.getId())return!0}return!1}));return n&&n.length>0}},{key:"startConnection",value:function(){return this.isConnector()?this.private.connector.startConnector:null}},{key:"endConnection",value:function(){return this.isConnector()?this.private.connector.endConnector:null}},{key:"isBackgroundMusic",value:function(){var e=this.getSlide();if(!e)return!1;var t=e.getTiming().getTimeLine(),r=t&&t.getMainSequence();if(!t||!r)return!1;var n=t.getMediaNode(this);return!!n&&(1===n.private.hideWhenStopped&&999===n.private.endAfterSlide&&-1===n.private.repeateCount)}},{key:"isTriggerShape",value:function(){var e=this.getSlide();if(!e)return!1;var t=e.getTiming(),r=t&&t.getTimeLine(),n=r&&r.allInterSeq;if(!n)return!1;for(var i=0;i<n.length;++i){var a=n[i].getEffects();if(a)for(var o=0;o<a.length;++o){var s=a[o];if(s.isTriggerEffect&&s.getTriggerObj()===this.getId())return!0}}return!1}},{key:"isCustomCurve",value:function(){var e=this.getGeometry2D();return e&&e.isCustomGeometry()}},{key:"setParent",value:function(e){this.parent=e}},{key:"buildTree",value:function(e){this.parent=e;var t=this.private.childs;if(t)for(var r=0,n=t.length;r<n;++r){var i=t[r];i&&i.buildTree&&i.buildTree(this)}}},{key:"_bubbleUpEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(p.a)():this.tree_token=Object(p.a)());var r=this.parent;r&&r._bubbleUpEvent&&(t.shapeIds||(t.shapeIds=[]),t.shapeIds.unshift(this.getId()),t.data!==this&&t.parent!==this||(t.modifiedShapeId=this.getId()),delete t.parent,r._bubbleUpEvent(e,t))}},{key:"getChilds",value:function(){return this.private.childs||[]}},{key:"getTextFrame",value:function(){return null}},{key:"ensureTextFrame",value:function(){return null}},{key:"getPlaceHolder",value:function(){return this.private.placeholder}},{key:"getPlaceHolderType",value:function(){var e=this.getPlaceHolder();return e&&void 0!==e.type?e.type:_.PlaceholderType.Object}},{key:"getGeometry2D",value:function(){return this.private.geometry2D}},{key:"hasTxGeometry2D",value:function(){return null!=this.private.txGeometry2D}},{key:"getTxGeometry2D",value:function(){return this.private.txGeometry2D}},{key:"getExtData",value:function(){return this.private.extData}},{key:"getProperty",value:function(){var e=this.private.geometry2D,t=this.private.transform2D,r=this.private.fill,n=this.private.picture,i=this.private.outline,a=this.private.effects,o=this.private.scene3D,s=this.private.shape3D,l=this.private.hyperlink;return{transform2D:t,geometry2D:e,fill:r,picture:n,outline:i,effects:a,scene3d:o,shape3d:s,inkData:Object(f.a)(this.private.inkData),hyperlink:l}}},{key:"getStyle",value:function(){return this.private.style}},{key:"isHidden",value:function(){var e=this.getSlide(),t=e&&e.isHideAllInk,r=this.isInk()&&t;return this.private.hide||r||!1}},{key:"isViablePhShape",value:function(){var e=this.getShapeType(),t=this.getTextFrame(),r=this.isMedia(),n=t&&t.getTextStream(),i=n&&n.getCharCount()>1;return i=i||this.private.picture||this.private.fill||this.private.outline||this.private.effects||this.private.shape3D||this.private.scene3D||e===D.ShapeType.Table||e===D.ShapeType.Diagram||e===D.ShapeType.Chart||e===D.ShapeType.SmartArt||r}},{key:"hasContent",value:function(){if(this.isPlaceHolder()){var e=this.getShapeType(),t=this.getTextFrame(),r=this.isMedia(),n=t&&t.getTextStream();return n&&n.getCharCount()>1||this.private.picture||e===D.ShapeType.Table||e===D.ShapeType.Diagram||e===D.ShapeType.Chart||e===D.ShapeType.SmartArt||e===D.ShapeType.Slicer||this.private.isOle||r}return!0}},{key:"isEmptyTextStream",value:function(){var e=this.getTextFrame(),t=e&&e.getTextStream();return t&&t.getCharCount()<=1}},{key:"_getShapeTypeCoreData",value:function(e){var t=void 0,r=e.private,n=r.modelType;if(this.isMedia())t=D.ShapeType.Media;else if(this.isInk())t=D.ShapeType.Ink;else if(r.isOle)t=D.ShapeType.OleShape;else if(n===D.ShapeModeType.MODEL_OBJTABLE)t=D.ShapeType.Table;else if(n===D.ShapeModeType.MODEL_DIAGRAM)t=D.ShapeType.Diagram;else if(n===D.ShapeModeType.MODEL_CHART)t=D.ShapeType.Chart;else if(n===D.ShapeModeType.MODEL_SMARTART)t=D.ShapeType.SmartArt;else if(n===D.ShapeModeType.MODEL_SLICER)t=D.ShapeType.Slicer;else if(r.picture)t=r.extData&&r.extData.isProcessOn?D.ShapeType.Processon:D.ShapeType.Picture;else{t=D.ShapeType.NormalShape,(e.getTextFrame?e.getTextFrame():null)&&r.flags&&r.flags.isTextBox&&(t=D.ShapeType.TextBox)}return t}},{key:"getShapeType",value:function(){if(this.isGroupShape())return D.ShapeType.GroupShape;var e=void 0,t=this.private.childs[0],r=this.private.modelType;return(e=this._getShapeTypeCoreData(this))===D.ShapeType.NormalShape&&t&&r===D.ShapeModeType.MODEL_SHAPE&&(e=this._getShapeTypeCoreData(t)),e}},{key:"getTags",value:function(){return this.private.tags}},{key:"hasTags",value:function(){return null!=this.private.tags}},{key:"isDiagramShape",value:function(){return w.a.isDiagramShape(this)}},{key:"isDiagramSubShape",value:function(){return w.a.isDiagramSubShape(this.getSlide(),this)}},{key:"getRootDiagramId",value:function(){return w.a.getRootDiagramId(this.getSlide(),this)}},{key:"canRotate",value:function(){return!(this.hasGraphicData()||this.isOle()||this.isMedia()||this.isMath())}},{key:"hasGraphicData",value:function(){return this.childModelType===D.ShapeModeType.MODEL_DIAGRAM||this.childModelType===D.ShapeModeType.MODEL_OBJTABLE||this.childModelType===D.ShapeModeType.MODEL_CHART||this.childModelType===D.ShapeModeType.MODEL_SMARTART||this.childModelType===D.ShapeModeType.MODEL_SLICER}},{key:"canMoveHierarchy",value:function(e){var t=this.getParent(),r=t&&t.getChilds();if(!r)return!1;var n=r.indexOf(this);return(n!==r.length-1||e!==_.ShapeMoveType.Front&&e!==_.ShapeMoveType.Forward)&&(0!==n||e!==_.ShapeMoveType.Back&&e!==_.ShapeMoveType.Backward)}},{key:"getShapeGroup",value:function(){var e=v.ShapeGroupItems,t=this.getPresetShapeType();for(var r in e)if(-1!==e[r].subTypes.indexOf(parseInt(t)))return r;return-1}},{key:"getPresetShapeType",value:function(){var e=null,t=v.PresetShapeInfo,r=v.PresetShapeType.ShapeInvalid;if(this.isPlaceHolder())for(var n=this.getSlideFollowing(),i=n?n.getPhShapes(this):[],a=0;a<i.length;a++){var o=i[a].shape;if(o&&(e=o.getGeometry2D()))break}else e=this.getGeometry2D();if(!e)return r;var s=e.getGeometryType();for(var l in t)if(s===t[l].text){r=l;break}return r}},{key:"isTowControlPointShapeType",value:function(){var e=this.getGeometry2D();if(!e)return!1;var t=e.getGeometryType();return!!["line","straightConnector1","bentConnector2","bentConnector3","bentConnector4","bentConnector5","curvedConnector2","curvedConnector3","curvedConnector4","curvedConnector5"].includes(t)}},{key:"getHyperlink",value:function(){return this.private.hyperlink}},{key:"getActions",value:function(){return this.private.actions}},{key:"getMedia",value:function(){if(this.isMedia())return this.private.media}},{key:"getDescription",value:function(){return this.private.description}},{key:"getWhiteboard",value:function(){return this.private.whiteboard}},{key:"isChildShape",value:function(){var e=this.parent;return!(!e||!e.isGroupShape()||e.isShapeTree)}},{key:"_modifyPrivate",value:function(e,t,r){this.setPropertyValue(e,r?Object(f.a)(t):t);var n={};return t?n[e]=r?Object(f.a)(t):t:n.undefineds=[e],{newval:n}}},{key:"_formatPrivate",value:function(e,t){switch(e){case"inkData":if(t&&t.vecTrace)for(var r=t.vecTrace,n=0;n<r.length;++n){r[n].vecPoints=[];for(var i=r[n].strPoints.split(","),a=0,o=0,s=0;s<i.length;++s)a+=parseInt(i[s].split(" ")[0]),o+=parseInt(i[s].split(" ")[1]),r[n].vecPoints.push({px:a,py:o})}break;case"extData":if(t&&t.whiteboard)try{this.private.whiteboard=JSON.parse(t.whiteboard)}catch(e){this.private.whiteboard=null}else this.private.whiteboard=null}}},{key:"modifySize",value:function(e,t){return this.visual.modifySize(e,t)}},{key:"modifyShapeHyperlink",value:function(e){var t={hyperlink:e};e._EMPTY&&(t={undefineds:["hyperlink"]}),this.delegate._modifyPrivatePropertys(t)}},{key:"setTransform2D",value:function(e){return this._modifyPrivate("transform2D",e,!0)}},{key:"setFill",value:function(e){return this._modifyPrivate("fill",e,!0)}},{key:"setOutline",value:function(e){return this._modifyPrivate("outline",e,!0)}},{key:"setPicture",value:function(e){return this._modifyPrivate("picture",e,!0)}},{key:"setGeometry2D",value:function(e){return this._modifyPrivate("geometry2D",e,!1)}},{key:"setActions",value:function(e){return this._modifyPrivate("actions",e,!0)}},{key:"setPlaceholder",value:function(e){return this._modifyPrivate("placeholder",e,!0)}},{key:"setInkData",value:function(e){return this._modifyPrivate("inkData",e,!1)}},{key:"setScene3D",value:function(e){return this._modifyPrivate("scene3D",e,!0)}},{key:"setShape3D",value:function(e){return this._modifyPrivate("shape3D",e,!0)}},{key:"setEffects",value:function(e){return this._modifyPrivate("effects",e,!0)}},{key:"setMedia",value:function(e){return this._modifyPrivate("media",e,!0)}},{key:"setChilds",value:function(e){return this._modifyPrivate("childs",e,!1)}},{key:"setWhiteboard",value:function(e){var t=Object.assign(this.private.extData||{},{whiteboard:JSON.stringify(e)});return this._modifyPrivate("extData",t,!0)}},{key:"setExtData",value:function(e){return this._modifyPrivate("extData",e,!0)}},{key:"setShapeStyle",value:function(e){return this._modifyPrivate("style",e,!0)}},{key:"setConnector",value:function(e){return this._modifyPrivate("connector",e,!0)}},{key:"setTags",value:function(e){return this._modifyPrivate("tags",e,!0)}},{key:"broadcastToOthers",value:function(){if(this.__isNew){var e=this.getSlide(),t=e&&e.getPresentation();e&&t&&t.drawingNotifyer.notify("SHAPE_CREATED",e,this)}}},{key:"getBackendShapePictureToken",value:function(){return this._backendHelper?this._backendHelper.getToken():""}},{key:"isShape",get:function(){return!0}},{key:"modelType",get:function(){return this.private.modelType}},{key:"visual",get:function(){return this._visual}},{key:"childModelType",get:function(){var e=this.private.childs[0];if(e)return e.private.modelType}},{key:"colorScheme",get:function(){this._colorScheme||(this._colorScheme=new k.d);var e=this.getSlide(),t=null;if(e){var r=(t=e.visual.getTheme()).getColorScheme(),n=e.getThemeOverride();n&&n.colorScheme&&r.init(n.colorScheme),this._colorScheme.setColorScheme(r),this._colorScheme.setColorMapping(t.getColorMapping())}var i=this.getStyle();return i&&(this._colorScheme.setStyle(i),this._colorScheme.setColorUsedFor("fill")),this._colorScheme.setShape(this),this._colorScheme.setTheme(t),this._colorScheme}}]),t}(h.a);t.a=L;Object(R.e)(L.prototype,!1)},268:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r(44),i=r.n(n);function a(e,t){var r=void 0;if(null==e||"object"!==(void 0===e?"undefined":i()(e)))return e;if(e instanceof Date)return(r=new Date).setTime(e.getTime()),r;if(e instanceof Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array){r=[];for(var n=0,o=e.length;n<o;n++)r[n]=a(e[n],t);return r}if(e instanceof Function)return r=function(){return e.apply(this,arguments)};if(e instanceof Object){for(var s in r=t?new e.constructor:{},e)e.hasOwnProperty(s)&&(r[s]=a(e[s],t));return r}throw new Error("Unable to copy obj as type isn't supported "+e.constructor.name)}function o(e){return a(e,!1)}function s(e){return a(e,!0)}},270:function(e,t,r){e.exports={default:r(277),__esModule:!0}},271:function(e,t,r){e.exports={default:r(279),__esModule:!0}},2718:function(e,t,r){"use strict";var n=r(44),i=r.n(n),a=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-10;return"string"==typeof e||"string"==typeof t?e===t:Math.abs(e-t)<r};t.a={equals:function e(t,r,n){if(Object.isEmpty(t))return t===r;if((void 0===t?"undefined":i()(t))!==(void 0===r?"undefined":i()(r)))return!1;if(t instanceof Array){for(var o=0,s=t.length;o<s;o++){if(!e(t[o],r[o]))return!1}return!0}if("object"===(void 0===t?"undefined":i()(t))){for(var l in t){if(t.hasOwnProperty(l))if(!e(t[l],r[l]))return!1}return!0}return a(t,r,n)}}},2719:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(360),l=2*Math.PI,u=function(){function e(t,r){i()(this,e);var n=window.Point;if(!(t instanceof n&&r instanceof n))throw new Error(t+" or "+r+" is not instanceof Point");this._pt1=new window.Point(t.x(),t.y()),this._pt2=new window.Point(r.x(),r.y())}return o()(e,[{key:"clone",value:function(){return new e(this._pt1.clone(),this._pt2.clone())}},{key:"assign",value:function(e){return this._pt1=e._pt1.clone(),this._pt2=e._pt2.clone(),this}},{key:"p1",value:function(){return new window.Point(this._pt1.x(),this._pt1.y())}},{key:"p2",value:function(){return new window.Point(this._pt2.x(),this._pt2.y())}},{key:"isNull",value:function(){return Object(s.k)(this._pt1.x(),this._pt2.x())&&Object(s.k)(this._pt1.y(),this._pt2.y())}},{key:"setLength",value:function(e){var t=this.unitVector();this._pt2=new window.Point(this._pt1.x()+t.dx()*e,this._pt1.y()+t.dy()*e)}},{key:"length",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y();return Math.sqrt(e*e+t*t)}},{key:"angle",value:function(){var e=this._pt2.x()-this._pt1.x(),t=this._pt2.y()-this._pt1.y(),r=360*Math.atan2(-t,e)/l,n=r<0?r+360:r;return Object(s.k)(n,360)?0:n}},{key:"translate",value:function(e,t){var r=window.Point,n=new r(e,t);this._pt1=r["+"](this._pt1,n),this._pt2=r["+"](this._pt2,n)}},{key:"normalVector",value:function(){var t=window.Point;return new e(this.p1(),t["+"](this.p1(),new t(this.dy(),-this.dx())))}},{key:"intersect",value:function(t,r){var n=window.Point,i=n["-"](this._pt2,this._pt1),a=n["-"](t.p1(),t.p2()),o=n["-"](this._pt1,t.p1()),s=i.y()*a.x()-i.x()*a.y();if(0===s||!isFinite(s))return e.IntersectType.NoIntersection;var l=1/s,u=(a.y()*o.x()-a.x()*o.y())*l;if(r){var c=n["+"](this._pt1,n["*"](u,i));r.setX(c.x()),r.setY(c.y())}if(u<0||u>1)return e.IntersectType.UnboundedIntersection;var h=(i.x()*o.y()-i.y()*o.x())*l;return h<0||h>1?e.IntersectType.UnboundedIntersection:e.IntersectType.BoundedIntersection}},{key:"angleTo",value:function(t){if(!(t instanceof e))throw new Error(t+" is not instance of Line");if(this.isNull()||t.isNull())return 0;var r=this.angle(),n=t.angle()-r,i=n<0?n+360:n;return Object(s.k)(n,360)?0:i}},{key:"unitVector",value:function(){var t=this._pt2.x()-this._pt1.x(),r=this._pt2.y()-this._pt1.y(),n=Math.sqrt(t*t+r*r);return new e(this.p1(),new window.Point(this._pt1.x()+t/n,this._pt1.y()+r/n))}},{key:"dx",value:function(){return this._pt2.x()-this._pt1.x()}},{key:"dy",value:function(){return this._pt2.y()-this._pt1.y()}},{key:"setP1",value:function(e){this._pt1=e}},{key:"setP2",value:function(e){this._pt2=e}},{key:"setPoints",value:function(e,t){return this._pt1=e,this._pt2=t,this}},{key:"setLine",value:function(e,t,r,n){this._pt1=new window.Point(e,t),this._pt2=new window.Point(r,n)}},{key:"setNewLine",value:function(t){if(!(t instanceof e))throw new Error(t+" is no instanceof Line");this.setLine(t.p1().x(),t.p1().y(),t.p2().x(),t.p2().y())}},{key:"pointAt",value:function(e){var t=this._pt2.x()-this._pt1.x(),r=this._pt2.y()-this._pt1.y();return new window.Point(this.pt1.x()+t*e,this.pt1.y()+r*e)}},{key:"toLine",value:function(){return new e(this._pt1.toPoint(),this._pt2.toPoint())}},{key:"isQLine",get:function(){return!0}}]),e}();u.IntersectType={NoIntersection:0,BoundedIntersection:1,UnboundedIntersection:2},window.Line=u},2720:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(808),l=r(606),u=r(1012),c=function(){function e(){i()(this,e),this.setBezier(0,0,0,0,0,0,0,0)}return o()(e,[{key:"clone",value:function(){var t=new e;return t.setBezier(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3,this.x4,this.y4),t}},{key:"setBezier",value:function(e,t,r,n,i,a,o,s){this.x1=e,this.y1=t,this.x2=r,this.y2=n,this.x3=i,this.y3=a,this.x4=o,this.y4=s}},{key:"assign",value:function(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this.x4=e.x4,this.y4=e.y4,this}},{key:"bezierOnInterval",value:function(t,r){if(0===t&&1===r)return this;var n=new e;this.parameterSplitLeft(t,n);var i=(r-t)/(1-t);return this.parameterSplitLeft(i,n),n}},{key:"parameterSplitLeft",value:function(e,t){t.x1=this.x1,t.y1=this.y1,t.x2=this.x1+e*(this.x2-this.x1),t.y2=this.y1+e*(this.y2-this.y1),t.x3=this.x2+e*(this.x3-this.x2),t.y3=this.y2+e*(this.y3-this.y2),this.x3=this.x3+e*(this.x4-this.x3),this.y3=this.y3+e*(this.y4-this.y3),this.x2=t.x3+e*(this.x3-t.x3),this.y2=t.y3+e*(this.y3-t.y3),t.x3=t.x2+e*(t.x3-t.x2),t.y3=t.y2+e*(t.y3-t.y2),t.x4=this.x1=t.x3+e*(this.x2-t.x3),t.y4=this.y1=t.y3+e*(this.y2-t.y3)}},{key:"pt1",value:function(){return new s.a(this.x1,this.y1)}},{key:"pt2",value:function(){return new s.a(this.x2,this.y2)}},{key:"pt3",value:function(){return new s.a(this.x3,this.y3)}},{key:"pt4",value:function(){return new s.a(this.x4,this.y4)}},{key:"pointAt",value:function(e){var t=Object(u.c)(this,e),r=t.x,n=t.y;return new s.a(r,n)}},{key:"addToPolygon",value:function(e,t){Object(u.b)(this,e,t)}},{key:"split",value:function(e,t){Object(u.d)(this,e,t)}},{key:"bounds",value:function(){var e=this.x1,t=this.x2,r=this.x3,n=this.x4,i=this.y1,a=this.y2,o=this.y3,s=this.y4,u=e,c=e;t<u?u=t:t>c&&(c=t),r<u?u=r:r>c&&(c=r),n<u?u=n:n>c&&(c=n);var h=i,d=i;return a<h?h=a:a>d&&(d=a),o<h?h=o:o>d&&(d=o),s<h?h=s:s>d&&(d=s),new l.a(u,h,c-u,d-h)}},{key:"isQBezier",get:function(){return!0}}],[{key:"createBezierFromPoints",value:function(t){if(t&&!(t.length<4)){var r=e.calculateControlPoints(t[0],t[1],t[2]).c2,n=e.calculateControlPoints(t[1],t[2],t[3]).c1;return e.fromPoints(new s.a(t[0].x,t[0].y),r,n,new s.a(t[2].x,t[2].y))}}},{key:"fromPoints",value:function(t,r,n,i){var a=new e;return a.x1=t.x(),a.y1=t.y(),a.x2=r.x(),a.y2=r.y(),a.x3=n.x(),a.y3=n.y(),a.x4=i.x(),a.y4=i.y(),a}},{key:"calculateControlPoints",value:function(e,t,r){var n=e.x-t.x,i=e.y-t.y,a=t.x-r.x,o=t.y-r.y,l=(e.x+t.x)/2,u=(e.y+t.y)/2,c=(t.x+r.x)/2,h=(t.y+r.y)/2,d=Math.sqrt(n*n+i*i),p=Math.sqrt(a*a+o*o),f=p/(d+p),v=c+(l-c)*f,y=h+(u-h)*f,g=t.x-v,m=t.y-y;return{c1:new s.a(l+g,u+m),c2:new s.a(c+g,h+m)}}}]),e}();window.QBezier=c},2721:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeoutPromise=t.getDiagramItemsCnt=void 0,t.getDiagramItemsCnt=function(e){if(!e)return null;var t=0;if(e.tr){t=e.tr.cpl&&e.tr.cpl.cnt;for(var r=e.tr.cpl&&e.tr.cpl.cpls,n=0;n<r.length;++n)if(r[n].cpl){t+=r[n].cpl.cnt||0;break}}else if(e.dis){for(r=e.dis.cpl&&e.dis.cpl.cpls,n=0;n<r.length;++n)if(r[n].cpl){t+=r[n].cpl.cnt||0;break}}else e.stp?t+=e.stp.cpl&&e.stp.cpl.cnt||0:e.cst?t+=e.cst.cstT&&e.cst.cstT.cnt||0:e.cir?t+=e.cir.cpl&&e.cir.cpl.cnt||0:e.pyr&&(t+=e.pyr.cpl&&e.pyr.cpl.cnt||0);return t},t.getTimeoutPromise=function(e,t,r){return void 0===t&&(t=1e4),void 0===r&&(r=null),new Promise((function(n,i){var a=setTimeout((function(){a=null,i(r||new Error("[openAPI] promise timeout"))}),t),o=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];a&&(clearTimeout(a),a=null,e.apply(void 0,t))}};e(o(n),o(i))}))}},277:function(e,t,r){r(278),e.exports=r(5).Object.getPrototypeOf},278:function(e,t,r){var n=r(20),i=r(63);r(224)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},279:function(e,t,r){r(280);var n=r(5).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},280:function(e,t,r){var n=r(13),i=r(46).f;r(224)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},2867:function(e,t,r){"use strict";r.d(t,"a",(function(){return B}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(763),l=r(808),u=3.141592653589793,c=0,h=1,d=2,p=3,f=0,v=1,y=0,g=1,m=2,_=3,S=r(470),T=function(){function e(){i()(this,e)}return o()(e,null,[{key:"isVertical",value:function(e){return!(e!==_&&e!==g)}},{key:"isHorizontal",value:function(e){return!(e!==m&&e!==y)}},{key:"angle2Dir",value:function(e){return 45<=(e=Object(s.b)(e))&&e<135?g:135<=e&&e<225?m:225<=e&&e<315?_:y}},{key:"dir2Angle",value:function(e){return[0,90,180,270][e]}},{key:"revDirect",value:function(e){return[m,_,y,g][e]}},{key:"isParallel",value:function(e,t){return!(this.isHorizontal(e)^this.isHorizontal(t))}},{key:"toRad",value:function(e){return e/180*u}},{key:"toDegree",value:function(e){return e/u*180}},{key:"transAngle",value:function(e,t){var r=Math.cos(this.toRad(t)),n=Math.sin(this.toRad(t)),i=r*e.m11()+n*e.m21(),a=r*e.m12()+n*e.m22(),o=new l.a(i,a);o.x()*o.x()+o.y()*o.y()==0&&console.error("values of cos and sin cannot be zero at the same time");var s=o.x()/Math.sqrt(o.x()*o.x()+o.y()*o.y()),u=parseInt(this.toDegree(Math.acos(s)));if(!((u=o.y()<0?-Math.abs(u):Math.abs(u))<-180||u>180))return u}}]),e}(),b=function(){function e(){i()(this,e)}return o()(e,null,[{key:"center",value:function(e,t){var r=(e.x()+t.x()+1)/2,n=(e.y()+t.y()+1)/2;return new l.a(r,n)}},{key:"notHorizontalAndVertical",value:function(e,t){return e.x()!==t.x()&&e.y()!==t.y()}},{key:"setPosForComp",value:function(e,t,r){t===y||t===m?e.setX(r):e.setY(r)}},{key:"setPosForOppComp",value:function(e,t,r){t===y||t===m?e.setY(r):e.setX(r)}},{key:"isInSameLine",value:function(e){for(var t=!0,r=!0,n=0;n<e.length-2;++n)if(r&&e[n].x()!==e[n+1].x()&&(r=!1),t&&e[n].y()!==e[n+1].y()&&(t=!1),!t||!r)return!1;return!0}},{key:"isSameDir",value:function(e,t,r){var n=!1;switch(e){case _:t.y()>=r.y()&&(n=!0);break;case m:t.x()>=r.x()&&(n=!0);break;case g:t.y()<=r.y()&&(n=!0);break;case y:t.x()<=r.x()&&(n=!0)}return n}},{key:"calcDirection",value:function(e,t){var r=t.subtracter(e);return Math.abs(r.x())>Math.abs(r.y())?r.x()>=0?y:m:r.y()>=0?g:_}}]),e}(),k=function(){function e(){i()(this,e)}return o()(e,null,[{key:"getSide",value:function(e,t){switch(t){case y:return e.right();case g:return e.bottom();case m:return e.left();case _:return e.top()}}},{key:"xOverlapsWith",value:function(e,t){return e.left()<=t.right()&&e.right()>=t.left()}},{key:"yOverlapsWith",value:function(e,t){return e.top()<=t.bottom()&&e.bottom()>=t.top()}},{key:"intersects",value:function(t,r){return e.xOverlapsWith(t,r)&&e.yOverlapsWith(t,r)}}]),e}();var C={mid:function(e,t){return(e+t+1)/2},comp:function(e,t){return[e.x(),e.y(),e.x(),e.y()][t]},oppcomp:function(e,t){return[e.y(),e.x(),e.y(),e.x()][t]},extremum:function(e){return[Math.max,Math.max,Math.min,Math.min][e]},compareSide:function(e,t,r){switch(e){case y:case g:return t>r;case m:case _:return t<r}},oppSideRange:function(e,t,r){return[[e.top(),e.bottom()],[e.left(),e.right()],[e.top(),e.bottom()],[e.left(),e.right()]][t][r]},getConnectorType:function(e){var t=S.LineType.StraightLine,r=S.LineType.BentLine,n=S.LineType.CurveLine,i=parseInt(e.getPresetShapeType());return t.includes(i)?c:r.includes(i)?h:n.includes(i)?d:p}},w=r(606),P=function(){function e(t){i()(this,e),t.shape&&null!=t.site?this.initFromShape(t.shape,t.site):t.point&&this.initFromPoint(t.point)}return o()(e,[{key:"initFromShape",value:function(e,t){var r=e.visual,n=r.getConnectionSiteCount();if(0!==n&&n>t){var i=r.getConnectionSites()[t],a=i.x,o=i.y,s=i.angle,u=r.calcTransFromCurrent2Layer(),c=r._rect();this._dir=T.angle2Dir(T.transAngle(u,s)),this._pos=u.mapPoint(new l.a(a/635,o/635)),this._rect=u.mapRect(new w.a(c.x,c.y,c.width,c.height)),this._wrapRect=this._rect.adjusted(-375,-375,375,375)}}},{key:"initFromPoint",value:function(e){this._pos=new l.a(e.x,e.y);var t={x:e.x,y:e.y,width:1,height:1};this._rect=new w.a(t.x,t.y,t.width,t.height),this._wrapRect=this._rect.adjusted(-375,-375,375,375)}},{key:"pos",get:function(){return this._pos},set:function(e){this._pos=e}},{key:"dir",get:function(){return this._dir},set:function(e){this._dir=e}},{key:"rect",get:function(){return this._rect},set:function(e){this._rect=e}},{key:"wrapRect",get:function(){return this._wrapRect},set:function(e){this._wrapRect=e}}]),e}(),x=r(2002),O=r(1284),E=C.compareSide,I=C.oppSideRange,A=C.mid,R=C.extremum,D=C.oppcomp,L=C.comp,N=function(){function e(t,r,n){i()(this,e),this.begin=r,this.end=n,this.connector=t,this.connectorVisual=this.connector.visual,this.connectType=C.getConnectorType(this.connector),this.result=[]}return o()(e,[{key:"rerouteConnector",value:function(){return this.arrange(),this.convertToShape(!0)}},{key:"initMeetingPos",value:function(){var e=this.beginPos,t=this.endPos,r=this.beginRect,n=this.endRect;if(this.meetingPos=b.center(e,t),k.xOverlapsWith(r,n)){var i=Math.max(r.left(),n.left()),a=Math.min(r.right(),n.right());this.meetingPos.setX(A(i,a))}else if(r.center().x()<n.center().x()){var o=A(r.right(),n.left());this.meetingPos.setX(o)}else{var s=A(r.left(),n.right());this.meetingPos.setX(s)}if(k.yOverlapsWith(r,n)){var l=Math.max(r.top(),n.top()),u=Math.min(r.bottom(),n.bottom());this.meetingPos.setY(A(l,u))}else if(r.center().y()<n.center().y()){var c=A(r.bottom(),n.top());this.meetingPos.setY(c)}else{var h=A(r.top(),n.bottom());this.meetingPos.setY(h)}}},{key:"adjustMeetingPosForSameDirectionEnd",value:function(){var e=b.setPosForComp,t=k.getSide,r=k.intersects,n=T.isVertical,i=T.isHorizontal,a=this.beginDir,o=this.endDir,s=this.beginPos,l=this.endPos,u=this.beginRect,c=this.endRect,h=this.beginWrapRect,d=this.endWrapRect;if(n(a)){var p=A(s.x(),l.x());this.meetingPos.setX(p)}if(i(a)){var f=A(s.y(),l.y());this.meetingPos.setY(f)}var v=D(s,a)<=I(c,a,0)||I(c,a,1)<=D(s,a),y=D(l,o)<=I(u,o,0)||I(u,o,1)<=D(l,o);if(r(u,c)||v&&y){var g=t(h,a),m=t(d,a);e(this.meetingPos,a,R(a)(g,m))}}},{key:"adjustMeetingPosForParallelEnd",value:function(){var e=b.isSameDir,t=k.yOverlapsWith,r=k.xOverlapsWith,n=T.isVertical,i=T.isHorizontal,a=this.beginDir,o=this.endDir,s=this.beginPos,l=this.endPos,u=this.beginRect,c=this.endRect,h=this.beginWrapRect,d=this.endWrapRect;if(!e(a,s,l)&&(i(a)&&t(u,c)||n(a)&&r(u,c)))if(D(s,a)>=D(l,o)){var p=h.topLeft(),f=d.topLeft();this.meetingPos.setX(Math.min(p.x(),f.x())),this.meetingPos.setY(Math.min(p.y(),f.y()))}else{var v=h.bottomRight(),y=d.bottomRight();this.meetingPos.setX(Math.max(v.x(),y.x())),this.meetingPos.setY(Math.max(v.y(),y.y()))}}},{key:"adjustMeetingPosForOrthogonalEnd",value:function(){var e=T.revDirect,t=T.isHorizontal,r=b.setPosForComp,n=b.isSameDir,i=k.getSide,a=this.beginDir,o=this.endDir,s=this.beginPos,l=this.endPos,u=this.beginRect,c=this.endRect,h=this.beginWrapRect,d=this.endWrapRect,p=n(a,s,l),f=n(o,l,s);if(p&&f)t(a)?this.meetingPos.setPoint(l.x(),s.y()):this.meetingPos.setPoint(s.x(),l.y());else{if(E(a,i(u,a),i(c,e(a)))){var v=i(h,a),y=i(d,a);r(this.meetingPos,a,R(a)(v,y))}if(E(o,i(c,o),i(u,e(o)))){var g=i(h,o),m=i(d,o);r(this.meetingPos,o,R(o)(g,m))}}}},{key:"trackToMeetingPos",value:function(e,t,r,n){var i=b.setPosForComp,a=b.setPosForOppComp,o=b.isSameDir,s=k.getSide,l=this.meetingPos,u=[];u.push(e);var c=e.clone();return o(t,e,l)?i(c,t,L(l,t)):i(c,t,s(n,t)),this._beginSection&&c.x()>e.x()&&console.log("_beginSection*******",c,e),u.push(c.clone()),L(c,t)!==L(l,t)&&(D(l,t)<=I(r,t,0)||I(r,t,1)<=D(l,t)?a(c,t,D(l,t)):D(l,t)<D(c,t)?a(c,t,I(n,t,0)):a(c,t,I(n,t,1)),u.push(c.clone()),D(c,t)!==D(l,t)&&(i(c,t,L(l,t)),u.push(c.clone()))),u}},{key:"calculateConnectionTrack",value:function(){var e=this.beginDir,t=this.endDir,r=this.beginPos,n=this.endPos,i=this.beginRect,a=this.endRect,o=this.beginWrapRect,s=this.endWrapRect;this._beginSection=!0;var l=this.trackToMeetingPos(r,e,i,o);this._beginSection=!0;var u=this.trackToMeetingPos(n,t,a,s);this.result=this.result.concat(l);var c=l[l.length-1],h=u[u.length-1];b.notHorizontalAndVertical(c,h)&&this.result.push(this.meetingPos.clone()),this.result=this.result.concat(u.reverse())}},{key:"eliminateRedundantPoints",value:function(){for(var e=0;e<this.result.length-2;)this.result[e].isEquals(this.result[e+1])&&this.result[e].isEquals(this.result[e+2])?this.result.splice(e+1,1):e++;if(this.result.length>3&&(this.connectType!==h||!b.isInSameLine(this.result))){var t=[];t.push(this.result[0]);for(var r=0,n=1;n<this.result.length;++n)this.result[r].isEquals(this.result[n])||(t.push(this.result[n]),r=n);this.result=t}}},{key:"arrangeBentOrCurved",value:function(){var e=b.setPosForComp,t=k.getSide;if(this.beginPos.isEquals(this.endPos)){this.result.push(this.beginPos);var r=this.beginPos.clone();e(r,this.beginDir,t(this.beginWrapRect,this.beginDir)),this.result.push(r),this.result.push(r),this.result.push(this.endPos)}else this.initMeetingPos(),this.beginDir===this.endDir?this.adjustMeetingPosForSameDirectionEnd():T.isParallel(this.beginDir,this.endDir)?this.adjustMeetingPosForParallelEnd():this.adjustMeetingPosForOrthogonalEnd(),this.calculateConnectionTrack(),this.eliminateRedundantPoints()}},{key:"arrangeStraight",value:function(){this.result.push(this.beginPos),this.result.push(this.endPos)}},{key:"arrange",value:function(){this.result=[],this.connectType===c?this.arrangeStraight():this.arrangeBentOrCurved()}},{key:"resetConnectorType",value:function(){var e=this.result.length-3,t=S.PresetShapeType.ShapeLine;e>=0&&(t=this.connectType===h?S.PresetShapeType.ShapeBentConnector2:S.PresetShapeType.ShapeCurvedConnector2,t+=e);var r=parseInt(this.connector.getPresetShapeType());if(r!==S.PresetShapeType.ShapeStraightConnector1&&r!==S.PresetShapeType.ShapeLine)return t}},{key:"calcRealAngle",value:function(e){for(var t=this.connectorVisual.getParent();t;){var r=t.coredata;if(!r||!r.isGroupShape()||r.isShapeTree)break;var n=t.getTransform2D(),i=n.horizontalFlipped,a=n.verticalFlipped;e=n.rotation+e*(i?-1:1)*(a?-1:1),t=t.getParent()}return Object(s.b)(e)}},{key:"resetConnectorAngle",value:function(e){var t=T.dir2Angle(e);t=this.calcRealAngle(t),this.connectorVisual.setRotation(t),console.log("***********resetConnectorAngle",t)}},{key:"resetDmlBentConntorFilp",value:function(e,t,r){var n=this.connectorVisual.calcTransFromCurrent2Layer(),i=void 0,a=void 0,o={};if(i=n.inverted(o).mapPoint(t),!o||!o.invertible)return null;if(i=this.connectorVisual.transform().mapPoint(i),a=n.inverted(o).mapPoint(r),!o||!o.invertible)return null;a=this.connectorVisual.transform().mapPoint(a);var s=T.dir2Angle(e),l=new x.a;l.rotate(-s),i=l.mapPoint(i),a=l.mapPoint(a);var u=i.x()>a.x(),c=i.y()>a.y(),h=this.connector.getTransform2D();this.connector.setTransform2D(Object.assign({},h,{horizontalFlipped:u,verticalFlipped:c}))}},{key:"resetConnectorRect",value:function(e,t,r,n){var i={x:Math.min(t.x(),r.x()),y:Math.min(t.y(),r.y()),width:Math.max(Math.abs(r.x()-t.x()),5),height:Math.max(Math.abs(r.y()-t.y()),5)},a=this.connectorVisual.layerRectToCurrentRect(i);i=new w.a(a.x,a.y,a.width,a.height);var o=new x.a,s=i.center(),l=this.connectorVisual.getTransform2D(),u=l.horizontalFlipped,c=l.verticalFlipped;o.translate(s.x(),s.y()),o.scale(u?-1:1,c?-1:1),o.translate(-s.x(),-s.y()),o.translate(s.x(),s.y()),o.rotate(-T.dir2Angle(e)),o.translate(-s.x(),-s.y());var h=o.mapRect(i),d=this.connectorVisual.currentRectToLayerRect(h.getRect());return 0===(h=new w.a(d.x,d.y,d.width,d.height)).width()&&h.setRight(h.right()+5),0===h.height()&&h.setBottom(h.bottom()+5),n&&this.connectorVisual.setAnchorRect(h.getRect()),h}},{key:"resetConnectorAdjustPoint",value:function(e,t){for(var r=this.connectorVisual.calcTransFromCurrent2Layer().inverted(),n=(new x.a).scale(1e5/e.width(),1e5/e.height()),i=r.multiply(n),a=this.result.slice(0),o=0;o<a.length;++o)a[o]=i.mapPoint(a[o]);for(var s={},l=0;l<t;++l){var u="adj"+(l+1),c=l%2?a[1+l].y():a[1+l].x();s[u]=c}return console.log("adjustValus***********",s),s}},{key:"convertToStraightConnector",value:function(){if(2===this.result.length){var e=this.result[0],t=this.result[this.result.length-1],r=this.connectorVisual.calcTransFromCurrent2Layer(),n=void 0,i=void 0,a={};if(n=r.inverted(a).mapPoint(e),!a||!a.invertible)return null;if(n=this.connectorVisual.transform().mapPoint(n),i=r.inverted(a).mapPoint(t),!a||!a.invertible)return null;i=this.connectorVisual.transform().mapPoint(i);var o=Object.assign({},this.connector.getTransform2D());o.rotation=0,o.horizontalFlipped=n.x()>i.x(),o.verticalFlipped=n.y()>i.y(),this.connector.setTransform2D(o);var s={x:Math.min(n.x(),i.x()),y:Math.min(n.y(),i.y()),width:Math.abs(n.x()-i.x()),height:Math.abs(n.y()-i.y())},l=this.connectorVisual.currentRectToLayerRect(s);this.connectorVisual.setAnchorRect(l)}else console.error("Invalid Length of result !!")}},{key:"convertToBentConnector",value:function(e){var t=this.resetConnectorType(),r=this.result[0],n=this.result[this.result.length-1],i=b.calcDirection(this.result[0],this.result[1]);this.resetConnectorAngle(i),this.resetDmlBentConntorFilp(i,r,n);var a=this.resetConnectorRect(i,r,n,e),o=this.result.length-3,s=this.resetConnectorAdjustPoint(a,o),l=window.APP.workspace.presentation.allocateLocalId(),u=new O.a({data:{presetType:S.PresetShapeInfo[t].text,adjustValues:s},id:l,type:1});this.connector.setGeometry2D(u)}},{key:"convertToShape",value:function(e,t){if(0!==this.result.length)return this.connectType===c?2===this.result.length&&this.convertToStraightConnector(e,t):3<=this.result.length&&this.result.length<=6&&this.convertToBentConnector(e,t),!0}},{key:"beginPos",get:function(){return this.begin.pos}},{key:"endPos",get:function(){return this.end.pos}},{key:"beginRect",get:function(){return this.begin.rect}},{key:"endRect",get:function(){return this.end.rect}},{key:"beginDir",get:function(){return this.begin.dir}},{key:"endDir",get:function(){return this.end.dir}},{key:"beginWrapRect",get:function(){return this.begin.wrapRect}},{key:"endWrapRect",get:function(){return this.end.wrapRect}}]),e}(),M=function(){function e(){i()(this,e)}return o()(e,null,[{key:"collectAllChildShape",value:function(e,t){if(!e)return null;for(var r=0;r<e.getChildCount();++r){var n=e.getChildAt(r);n&&!n.isConnector()&&(n.isGroupShape()?this.collectAllChildShape(n,t):t.push(n))}}},{key:"recursionLookupConnectFrom",value:function(t,r,n,i,a){for(var o=t.getChildCount(),s=0;s<o;++s){var l=t.getChildAt(s);if(!l)return null;if(l.isGroupShape())e.recursionLookupConnectFrom(l,r,n,i,a);else{var u=!1;if(l.isConnector()){var c=l.startConnection(),h=l.endConnection();if(c&&c.shapeId===n&&(u=!0,a.push(l),c.site===r)){i.push(l);continue}h&&h.shapeId===n&&(u||a.push(l),h.site===r&&i.push(l))}}}}},{key:"lookupConnectFrom",value:function(t,r,n){var i=[],a=t.getShapeTree(),o=t.getId();return e.recursionLookupConnectFrom(a,r,o,i,n),i}},{key:"getConnectee",value:function(e,t){var r=e.getShapeTree();if(!r)return null;if(!(t===!!f?!!e.startConnection():!!e.endConnection()))return null;var n=t===!!f?e.startConnection():e.endConnection(),i=n.shapeId,a=n.site;if(!i)return null;var o=r.findShapeById(i);return o?{connectee:o,site:a}:null}}]),e}(),F=function(){function e(t,r){i()(this,e),this.index=0,this.currSite=0,this.siteCount=0,this.connecteeId=0,this.currConnector=null,this.vecConnectors=[],this.visitConnectors=[],this.connectee=t,this.topLevelShape=r,this.endType=f,this.init()}return o()(e,[{key:"init",value:function(){if(!this.connectee)return null;this.connecteeId=this.connectee.getId();var e=this.connectee.visual;if(this.siteCount=e.getConnectionSiteCount(),!this.siteCount)return null;var t=[],r=M.lookupConnectFrom(this.connectee,0,t);this.vecConnectors.push(r);for(var n=1;n<this.siteCount;++n){for(var i=[],a=0;a<t.length;++a){var o=t[a],s=o.startConnection(),l=o.endConnection();(s&&s.shapeId===this.connecteeId&&s.site===n||l&&l.shapeId===this.connecteeId&&l.site===n)&&i.push(o)}this.vecConnectors.push(i)}if(this.topLevelShape)for(var u=0;u<this.siteCount;++u)for(var c=this.vecConnectors[u],h=0;h<c.length;){var d=c[h];this.isSameTopLevel(d,this.topLevelShape)?c.splice(h,1):++h}this.getNextConnector()}},{key:"isSameTopLevel",value:function(e,t){for(var r=e.parent;r;){if(r===t)return!0;r=r.parent}return!1}},{key:"getNextConnector",value:function(){for(this.currConnector=null;this.currSite<this.siteCount;){for(var e=this.vecConnectors[this.currSite],t=e.length;this.index<t;)if(this.currConnector=e[this.index++],this.currConnector!==this.connectee&&!this.visitConnectors.includes(this.currConnector))return void this.visitConnectors.push(this.currConnector);if(this.index=0,this.currSite===this.siteCount-1)return void(this.currConnector=null);this.currSite++}}},{key:"next",value:function(){return this.endType=f,this.getNextConnector(),this.currConnector}},{key:"getCurrConnector",value:function(){return this.currConnector}},{key:"getEndType",value:function(){var e=this.getCurrConnector().startConnection(),t=this.getCurrConnector().endConnection();return e&&e.shapeId===this.connecteeId&&e.site===this.currSite?f:t&&t.shapeId===this.connecteeId&&t.site===this.currSite?v:f}},{key:"getCurrSite",value:function(){return this.currSite}}]),e}(),B=function(){function e(){i()(this,e)}return o()(e,null,[{key:"updateSingleConnector",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.isConnector()){var r=e.getSlide(),n=e.getConnector(),i=Object.keys(n),a=function(e){if(e){var t=r.findShapeById(n[e].shapeId),i=n[e].site;return new P({shape:t,site:i})}},o=void 0,s=void 0;if(i.includes("startConnector")&&i.includes("endConnector"))o=a("startConnector"),s=a("endConnector");else if(i.includes("startConnector"))o=a("startConnector"),(s=new P({point:t.val})).dir=b.calcDirection(s.pos,o.pos);else if(i.includes("endConnector"))o=new P({point:t.val}),s=a("endConnector"),o.dir=b.calcDirection(o.pos,s.pos);else{if(!t)return;var l=t.tag,u=t.val;if(null==u)return;var c=e.getGeometry2D(),h=c.geometry&&c.geometry.getConnectionEndsPoint(c.sink);if(!h||null==h.start||null==h.end)return void console.warn("Invalid geometry2D.sink !!");var d=e.visual.calcTransFromCurrent2Layer();switch(h.start=d.Map(h.start),h.end=d.Map(h.end),l){case"begin":o=new P({point:u}),s=new P({point:h.end});break;case"end":o=new P({point:h.start}),s=new P({point:u})}o.dir=b.calcDirection(o.pos,s.pos),s.dir=b.calcDirection(s.pos,o.pos)}var p=new N(e,o,s);return p.rerouteConnector()}}},{key:"updateAllConnections",value:function(t){if(!(t._isLocalNew||t.isShapeTree||t.isConnector()||t.isInk()))if(t.isGroupShape()){var r=[];M.collectAllChildShape(t,r),r.forEach((function(r){e.UpdateSelfConnections(r,t)}))}else e.UpdateSelfConnections(t)}},{key:"UpdateSelfConnections",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.isConnected())for(var r=new F(e,t);r;){var n=r.getCurrConnector();if(!n)return null;if(!n.isGroupShape()){var i=M.getConnectee(n,!r.getEndType());if(i){var a=e,o=i.connectee,s=r.getCurrSite(),l=i.site;if(r.getEndType()===v){var u=[o,a];a=u[0],o=u[1];var c=[l,s];s=c[0],l=c[1]}var h=new P({shape:a,site:s}),d=new P({shape:o,site:l}),p=new N(n,h,d);p.rerouteConnector()}else this.modifyConnectorPos(n,r.getEndType(),e,r.getCurrSite());r.next()}}}},{key:"modifyConnectorPos",value:function(e,t,r,n){if(e&&r){var i=r.visual,a=i.getConnectionSites()[n],o=a.x,s=a.y,u=i.calcTransFromCurrent2Layer().mapPoint(new l.a(o/635,s/635)),c=e.visual._rect(),h=new l.a;t===v&&(h.setX(c.x+c.width),h.setY(c.y+c.height)),h=e.visual.calcTransFromCurrent2Layer().mapPoint(h);var d={x:u.x()-h.x(),y:u.y()-h.y()},p=e.visual.getAnchorRect();p.translate(d),e.visual.setAnchorRect(p)}}}]),e}()},304:function(e,t,r){"use strict";r.r(t);t.default={OType_Nake:0,OType_Data:1,OType_Vector:2,OType_Custom:3,otModify:0,otInsert:1,otRemove:2,otMove:3,otReplaceData:4,vtDataVersion:0,vtTaskVersion:1,vtLocalCmdVersion:2,vtInitialData:3,ctCommit:0,ctCommit_UnClose:1,ctCommit_Merge:2,ctCommit_MergeAndClose:3}},3121:function(e,t,r){e.exports=function(e,t){r.e(368).then(r.bind(null,4437)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},315:function(e,t,r){"use strict";var n,i;t.a=(n=new Date-0,i=0,function(e){return e?e.toString(16):(n+i++).toString(16)})},3155:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrendLineType=t.ChartElementType=void 0;var n={ChartTitleNone:0,ChartTitleCenteredOverlay:1,ChartTitleAboveChart:2,LegendNone:100,LegendRight:101,LegendTop:102,LegendLeft:103,LegendBottom:104,LegendRightOverlay:105,LegendLeftOverlay:106,DataLabelNone:200,DataLabelShow:201,DataLabelCenter:202,DataLabelInsideEnd:203,DataLabelInsideBase:204,DataLabelOutSideEnd:205,DataLabelLeft:206,DataLabelRight:207,DataLabelTop:208,DataLabelBottom:209,DataLabelBestFit:210,DataLabelCallout:211,PrimaryCategoryAxisTitleNone:300,PrimaryCategoryAxisTitleAdjacentToAxis:301,PrimaryCategoryAxisTitleBelowAxis:302,PrimaryCategoryAxisTitleRotated:303,PrimaryCategoryAxisTitleVertical:304,PrimaryCategoryAxisTitleHorizontal:305,PrimaryValueAxisTitleNone:306,PrimaryValueAxisTitleAdjacentToAxis:307,PrimaryValueAxisTitleBelowAxis:308,PrimaryValueAxisTitleRotated:309,PrimaryValueAxisTitleVertical:310,PrimaryValueAxisTitleHorizontal:311,SecondaryCategoryAxisTitleNone:312,SecondaryCategoryAxisTitleAdjacentToAxis:313,SecondaryCategoryAxisTitleBelowAxis:314,SecondaryCategoryAxisTitleRotated:315,SecondaryCategoryAxisTitleVertical:316,SecondaryCategoryAxisTitleHorizontal:317,SecondaryValueAxisTitleNone:318,SecondaryValueAxisTitleAdjacentToAxis:319,SecondaryValueAxisTitleBelowAxis:320,SecondaryValueAxisTitleRotated:321,SecondaryValueAxisTitleVertical:322,SecondaryValueAxisTitleHorizontal:323,SeriesAxisTitleNone:324,SeriesAxisTitleRotated:325,SeriesAxisTitleVertical:326,SeriesAxisTitleHorizontal:327,PrimaryValueGridLinesNone:328,PrimaryValueGridLinesMinor:329,PrimaryValueGridLinesMajor:330,PrimaryValueGridLinesMinorMajor:331,PrimaryCategoryGridLinesNone:332,PrimaryCategoryGridLinesMinor:333,PrimaryCategoryGridLinesMajor:334,PrimaryCategoryGridLinesMinorMajor:335,SecondaryValueGridLinesNone:336,SecondaryValueGridLinesMinor:337,SecondaryValueGridLinesMajor:338,SecondaryValueGridLinesMinorMajor:339,SecondaryCategoryGridLinesNone:340,SecondaryCategoryGridLinesMinor:341,SecondaryCategoryGridLinesMajor:342,SecondaryCategoryGridLinesMinorMajor:343,SeriesAxisGridLinesNone:344,SeriesAxisGridLinesMinor:345,SeriesAxisGridLinesMajor:346,SeriesAxisGridLinesMinorMajor:347,PrimaryCategoryAxisNone:348,PrimaryCategoryAxisShow:349,PrimaryCategoryAxisWithoutLabels:350,PrimaryCategoryAxisReverse:351,PrimaryValueAxisNone:352,PrimaryValueAxisShow:353,PrimaryValueAxisThousands:354,PrimaryValueAxisMillions:355,PrimaryValueAxisBillions:356,PrimaryValueAxisLogScale:357,SecondaryCategoryAxisNone:358,SecondaryCategoryAxisShow:359,SecondaryCategoryAxisWithoutLabels:360,SecondaryCategoryAxisReverse:361,SecondaryValueAxisNone:362,SecondaryValueAxisShow:363,SecondaryValueAxisThousands:364,SecondaryValueAxisMillions:365,SecondaryValueAxisBillions:366,SecondaryValueAxisLogScale:367,SeriesAxisNone:368,SeriesAxisShow:369,SeriesAxisWithoutLabeling:370,SeriesAxisReverse:371,PrimaryCategoryAxisThousands:372,PrimaryCategoryAxisMillions:373,PrimaryCategoryAxisBillions:374,PrimaryCategoryAxisLogScale:375,SecondaryCategoryAxisThousands:376,SecondaryCategoryAxisMillions:377,SecondaryCategoryAxisBillions:378,SecondaryCategoryAxisLogScale:379,DataTableNone:500,DataTableShow:501,DataTableWithLegendKeys:502,TrendlineNone:600,TrendlineAddLinear:601,TrendlineAddExponential:602,TrendlineAddLinearForecast:603,TrendlineAddTwoPeriodMovingAverage:604,ErrorBarNone:700,ErrorBarStandardError:701,ErrorBarPercentage:702,ErrorBarStandardDeviation:703,LineNone:800,LineDropLine:801,LineHiLoLine:802,LineSeriesLine:803,LineDropHiLoLine:804,UpDownBarsNone:900,UpDownBarsShow:901,PlotAreaNone:1e3,PlotAreaShow:1001,ChartWallNone:1100,ChartWallShow:1101,ChartFloorNone:1200,ChartFloorShow:1201};t.ChartElementType=n,Object.freeze(n);var i={Exponential:5,Linear:-4132,Logarithmic:-4133,MovingAvg:6,Polynomial:3,Power:4};t.TrendLineType=i,Object.freeze(i)},3156:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackendShapeHelper=void 0;var n=r(158),i=function(){function e(e){this._shape=e,this._backendToken="empty"}return e.prototype.isShapeTransform=function(e){var t=e.data[0];if("modifyShapeProps"!==t.name)return!1;var r=t.param.cmdExtends;return(r&&r.actionType)!==n.actionType.Resize_Shape},e.prototype.forward=function(e){if(e&&e.data&&"[object Array]"===Object.prototype.toString.call(e.data)){var t=e.data[0];if(t&&!this.isShapeTransform(e)){var r=t.param,n=t.execToken;r&&r.execToken&&("[object String]"!==Object.prototype.toString.call(n)&&(t.execToken=this._backendToken),this._backendToken=r.execToken)}}},e.prototype.backward=function(e){if(e&&e.data&&"[object Array]"===Object.prototype.toString.call(e.data)&&!this.isShapeTransform(e)){var t=e.data[0];if(t){var r=t.param,n=t.execToken;r&&r.execToken&&(this._backendToken=n)}}},e.prototype._fireChanged=function(e){this._shape&&this._shape._fireChanged(e)},e.prototype.getToken=function(){return this._backendToken},e}();t.BackendShapeHelper=i},3157:function(e,t,r){e.exports=function(e,t){r.e(221).then(r.bind(null,4647)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},3158:function(e,t,r){e.exports=function(e,t){r.e(222).then(r.bind(null,4654)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},3159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorFormat=void 0;var n=/^#[a-fA-F0-9]+$/,i=function(){function e(e,t,r){this.color=e||{},this.layer=t,this.context=r}return Object.defineProperty(e.prototype,"RGB",{get:function(){var e,t=this.color.toRGB;if(!t)return console.error("Error: none toRGB properties !!"),null;try{e=window.CoreTypes.ScRgb.fromStringColor(t)}catch(e){return console.error("invalid color format !!"),null}var r=e.toString("rgb").split("#")[1];if(r.length>6){var n=r&&r.slice(2);return n?"#"+n.toUpperCase():(console.error("Error: Invalid RGB Value !!"),null)}return"#"+r.toUpperCase()},set:function(e){if(e&&e.startsWith("#")&&!(e.length>7)&&n.test(e)){var t,r=e.slice(1),i="#"+(r=r.padStart(8,"0"));try{t=window.CoreTypes.ScRgb.fromStringColor(i)}catch(e){return void console.error("invalid color format !!")}this.color={toRGB:t.toString("rgb")};var a=this.context.supperProps;this.layer[a]=this}else console.error("Invalid Color Value !!")},enumerable:!1,configurable:!0}),e}();t.ColorFormat=i},335:function(e,t,r){"use strict";var n=r(43),i=r.n(n),a=r(0),o=r.n(a),s=r(3),l=r.n(s),u=function(){function e(){o()(this,e),this._listeners={}}return l()(e,[{key:"on",value:function(e,t){return e?this._on(e,{handler:t}):(console.trace("this evenName is empty",e),null)}},{key:"once",value:function(e,t){return e?this._on(e,{handler:t,once:!0}):(console.trace("this evenName is empty",e),null)}},{key:"off",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._listeners[e];if(e)if(t){if(r){for(var n=0;n<r.length;n++)r[n].handler===t&&(r.splice(n,1),n--);0===r.length&&delete this._listeners[e]}}else delete this._listeners[e];else this._listeners={};return this}},{key:"fire",value:function(e){var t=this._listeners[e];if(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var a=t.length-1;a>=0;--a){var o=t[a];o?(o.handler&&o.handler.apply(o,n),t[a]&&t[a].once&&(t.splice(a,1),0===t.length&&delete this._listeners[e])):console.warn("fire handler is undefined")}}return this}},{key:"fireDirect",value:function(e){var t=this._listeners[e];if(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var a=t.length-1;a>=0;--a){var o=t[a];o.handler.apply(o,n),o&&o.once&&(t.splice(a,1),0===t.length&&delete this._listeners[e])}}return this}},{key:"_on",value:function(e,t){return this._listeners[e]?(this._listeners[e].some((function(e){return e.handler===t.handler}))||this._listeners[e].push(t),this):(this._listeners[e]=[t],this)}},{key:"simpleOn",value:function(e,t){this._listeners[e]=[{handler:t}]}},{key:"fireAsync",value:function(e){var t=this,r=this._listeners[e];if(r){for(var n=arguments.length,a=Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];for(var s=function(n){var o=r[n];if(o.data=a,!o.runner){o.data=a;o.runner=requestAnimationFrame((function(){o.runner=null,o.handler&&o.handler.apply(o,i()(o.data)),r[n]&&r[n].once&&(r.splice(n,1),0===r.length&&delete t._listeners[e])}))}},l=r.length-1;l>=0;--l)s(l)}return this}},{key:"destroy",value:function(){this._listeners={}}}]),e}();t.a=u},360:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"m",(function(){return u})),r.d(t,"k",(function(){return c})),r.d(t,"l",(function(){return h})),r.d(t,"i",(function(){return d})),r.d(t,"n",(function(){return p})),r.d(t,"o",(function(){return f})),r.d(t,"h",(function(){return v})),r.d(t,"j",(function(){return y})),r.d(t,"g",(function(){return g})),r.d(t,"p",(function(){return m})),r.d(t,"f",(function(){return _})),r.d(t,"e",(function(){return S}));var n=r(44),i=r.n(n),a=1e-6;function o(e,t,r){if(!e)throw new Error(t+" is Assert Because "+r+"!!")}function s(e){if(!e)throw new Error("there is a assert!!")}function l(e){return function e(t){if(!t||"object"!==(void 0===t?"undefined":i()(t)))return t;var r=new t.constructor;for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];r[n]="object"===(void 0===a?"undefined":i()(a))?e(a):a}return r}(e)}function u(e){return Object.isEmpty(e)}function c(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function h(e){return Math.abs(e)<=1e-12}function d(e,t,r){return p(e,f(r,t))}function p(e,t){return e>t?e:t}function f(e,t){return e<t?e:t}function v(e){return e>=0?e:-1*e}function y(e){return Math.ceil(e)}function g(e,t){return Math.min(t.m13()*e.left(),t.m13()*e.right())+Math.min(t.m23()*e.top(),t.m23()*e.bottom())+t.m33()<1e-6}var m=isFinite;function _(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")}function S(e){return e&&"Object"===e.constructor.name&&e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&e.hasOwnProperty("width")&&e.hasOwnProperty("height")}},4285:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TagsShell=void 0;var n=function(){function e(e,t){this.tags=e||[],this.parent=t}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.tags.length},enumerable:!1,configurable:!0}),e.prototype.Has=function(e){for(var t=0;t<this.tags.length;++t){if(this.tags[t].name===e)return!0}return!1},e.prototype.Item=function(e){for(var t=0;t<this.tags.length;++t){var r=this.tags[t];if(r.name===e)return r.value}return null},e.prototype.Name=function(e){var t;return null===(t=this.tags[e])||void 0===t?void 0:t.name},e.prototype.Value=function(e){var t;return null===(t=this.tags[e])||void 0===t?void 0:t.value},e.prototype.Add=function(e,t){var r,n,i=window.APP.coreAPI.createModifier("Tags");i.modify(e,t);var a=null===(n=null===(r=window.APP)||void 0===r?void 0:r.presentation)||void 0===n?void 0:n.selection,o=this.parent;if(null==o?void 0:o.coreData.isShape){var s=o.coreData;null==a||a.applyShapeModifiers([i],[s])}else if(null==o?void 0:o.coreData.isSlideType){var l=[{slide:o.coreData,modifier:i}];null==a||a.modifySlidePropertiesV2(l)}},e.prototype.Delete=function(e){var t,r,n=window.APP.coreAPI.createModifier("Tags");n.modify(e,"");var i=null===(r=null===(t=window.APP)||void 0===t?void 0:t.presentation)||void 0===r?void 0:r.selection,a=this.parent;if(null==a?void 0:a.coreData.isShape){var o=a.coreData;null==i||i.applyShapeModifiers([n],[o])}else if(null==a?void 0:a.coreData.isSlideType){var s=[{slide:a.coreData,modifier:n}];null==i||i.modifySlidePropertiesV2(s)}},Object.defineProperty(e.prototype,"Parent",{get:function(){return this.parent},enumerable:!1,configurable:!0}),e}();t.TagsShell=n},4286:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupShapeShell=void 0;var n=r(143),i=r(4287),a=r(2264),o=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"Shapes",{get:function(){return this.private.shapes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GroupItems",{get:function(){return this.Shapes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HasTableFrame",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TableFrame",{get:function(){return null},enumerable:!1,configurable:!0}),t.prototype.GetHyperlinks=function(){for(var e=new a.HyperlinksShell([]),t=this.Shapes,r=0;r<t.Count;++r){var n=t.Item(r),i=null==n?void 0:n.GetHyperlinks();i&&e.concat(i)}return e},t.prototype.buildTree=function(e){var t=this.coreData;if(t){var r=t.private.childs,n=window.APP.shellFactory.create({shapes:r},"shapes");if(!n)return;this.private.shapes=n,n.buildTree&&n.buildTree(this)}this.parent=e},t}(i.ShapeShell);t.GroupShapeShell=o},4287:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeShell=void 0;var n=r(143),i=r(4288),a=r(2264),o=r(1016),s=r(4285),l=r(4878),u=r(4879),c=r(4880),h=r(2721),d=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.IsShape=function(){return!0},t.prototype.getFill=function(){return this.coreData.visual.getFill()},t.prototype.getOutline=function(){return this.coreData.visual.getOutline()},Object.defineProperty(t.prototype,"Id",{get:function(){return this.coreData.getId()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Tags",{get:function(){var e=this.coreData.getTags();return new s.TagsShell(e,this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HasTextFrame",{get:function(){return null!=this.coreData.getTextFrame()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TextFrame",{get:function(){var e=this.coreData.getTextFrame();return null==e?void 0:e.apiShell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HasTableFrame",{get:function(){return null!=this.coreData.getTableFrame()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TableFrame",{get:function(){var e=this.coreData.getTableFrame();return null==e?void 0:e.apiShell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return this.coreData.getShapeType()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"AutoShapeType",{get:function(){var e=this.coreData.getPresetShapeType();return parseInt(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){var e=this.coreData.getRect();return e&&(0,l.Ti2Px)(e.bottom-e.top,!0)},set:function(e){if(e<0)console.error("Invalid Height Value !!");else{var t=this.coreData.getRect(),r={x:t.left,y:t.top,height:(0,l.Px2Ti)(e),width:t.right-t.left},n=window.APP.coreAPI.createModifier("Transform2D");n.modify("anchorRect",r);var i=window.selection,a=this.coreData;i.applyShapeModifiers([n],[a]),console.log("Set Shape.Height Succeeded")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){var e=this.coreData.getRect();return e&&(0,l.Ti2Px)(e.right-e.left,!0)},set:function(e){if(e<0)console.error("Invalid Width Value !!");else{var t=this.coreData.getRect(),r={x:t.left,y:t.top,height:t.bottom-t.top,width:(0,l.Px2Ti)(e)},n=window.APP.coreAPI.createModifier("Transform2D");n.modify("anchorRect",r);var i=window.selection,a=this.coreData;i.applyShapeModifiers([n],[a]),console.log("Set Shape.Width Succeeded")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Left",{get:function(){var e=this.coreData.getRect();return e&&(0,l.Ti2Px)(e.left,!0)},set:function(e){var t=this.coreData.getRect(),r={x:(0,l.Px2Ti)(e),y:t.top,height:t.bottom-t.top,width:t.right-t.left},n=window.APP.coreAPI.createModifier("Transform2D");n.modify("anchorRect",r);var i=window.selection,a=this.coreData;i.applyShapeModifiers([n],[a]),console.log("Set Shape.Left Succeeded")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){var e=this.coreData.getRect();return e&&(0,l.Ti2Px)(e.top,!0)},set:function(e){var t=this.coreData.getRect(),r={x:t.left,y:(0,l.Px2Ti)(e),height:t.bottom-t.top,width:t.right-t.left},n=window.APP.coreAPI.createModifier("Transform2D");n.modify("anchorRect",r);var i=window.selection,a=this.coreData;i.applyShapeModifiers([n],[a]),console.log("Set Shape.Top Succeeded")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Fill",{get:function(){return new u.FillFormat(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OutLine",{get:function(){return new c.LineFormat(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Shadow",{get:function(){var e=this.coreData.getEffects();return{innerShadow:e&&e.innerShadow,outerShadow:e&&e.outerShadow,presetShadow:e&&e.presetShadow,lagacyShadow:e&&e.lagacyShadow}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Glow",{get:function(){var e=this.coreData.getEffects();return e&&e.glow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ZOrderPosition",{get:function(){var e=this.parent&&this.parent.private&&this.parent.private.childs;return e&&0!==e.length?e.indexOf(this):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Rotation",{get:function(){var e=this.coreData.getTransform2D();return e&&e.rotation},enumerable:!1,configurable:!0}),t.prototype.GetShapeImage=function(){var e=this;return(0,h.getTimeoutPromise)((function(t,r){var n=e.coreData,i=n.getSlideId(),a={category:"slides",shapes:[{shapeId:n.getId()}],slideId:i,type:4},o=window.APP.presentation;o.session.execSimpleQuery("images",a,(function(e){var n=null==e?void 0:e.sha1;n?o.session.getImageUrlFromServer([n]).then((function(e){var r=e.urls[n];t(r)})).catch((function(){r(new Error("Get Shape Image Failed"))})):r(new Error("Get Shape Image Failed"))}))}),1e4,new Error("Get Shape Image Timeout"))},t.prototype.IsShapeShell=function(){return!0},t.prototype.GetHyperlinks=function(){var e,t,r=new a.HyperlinksShell([]),n=this.coreData.getActions(),o=null===(e=null==n?void 0:n.mouseClick)||void 0===e?void 0:e.hyperlink;if(o){var s=new i.HyperlinkShell(o,this);r.concat(new a.HyperlinksShell([s]))}if(this.HasTextFrame){var l=this.TextFrame.TextStream;t=null==l?void 0:l.GetHyperlinks()}else if(this.HasTableFrame){var u=this.TableFrame.TableCells;t=null==u?void 0:u.GetHyperlinks()}return r.concat(t),r},t.prototype.buildTree=function(e){var t=this.coreData;if(t){for(var r=t.private.childs,n=0;n<r.length;++n){var i=r[n],a=void 0;i.isTextFrame?(a=window.APP.shellFactory.create(i,"textframe"),this.private.textFrame=a):i.isTableFrame&&(a=window.APP.shellFactory.create(i,"tableframe"),this.private.tableFrame=a),a&&(a.buildTree&&a.buildTree(this))}this.parent=e}},Object.defineProperty(t.prototype,"Description",{get:function(){var e;return null===(e=this.coreData.private)||void 0===e?void 0:e.description},enumerable:!1,configurable:!0}),t}(o.IShell);t.ShapeShell=d},4288:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperlinkShell=void 0;var n=r(143),i=r(158),a=(0,n.__importDefault)(r(262)),o="Address",s="SubAddress",l="EmailSubject",u="TextToDisplay",c="ScreenTip",h=function(){function e(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null),this.hyperlink=e,this.parent=t,this.begin=r,this.end=n}return Object.defineProperty(e.prototype,"Parent",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Address",{get:function(){var e,t=null===(e=this.hyperlink)||void 0===e?void 0:e.address;return t&&!t.startsWith("mailto:")?t:null},set:function(e){this.setProperties(o,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SubAddress",{get:function(){var e,t;return(null===(e=this.hyperlink)||void 0===e?void 0:e.link)||(null===(t=this.hyperlink)||void 0===t?void 0:t.subAdress)},set:function(e){this.setProperties(s,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"EmailSubject",{get:function(){var e,t=null===(e=this.hyperlink)||void 0===e?void 0:e.address;return t&&t.startsWith("mailto:")?t:null},set:function(e){this.setProperties(l,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TextToDisplay",{get:function(){if(this.IsShapeHyperlink())return"";var e=this.parent&&this.parent.coreData;if(!e)return"";var t=e.getText(this.begin,this.end-this.begin);return t&&0!==t.length?t.join(""):""},set:function(e){this.setProperties(u,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ScreenTip",{get:function(){var e;return null===(e=this.hyperlink)||void 0===e?void 0:e.screenTip},set:function(e){this.setProperties(c,e)},enumerable:!1,configurable:!0}),e.prototype.IsTextHyperlink=function(){var e,t;return null===(t=(e=this.parent).IsTextStreamShell)||void 0===t?void 0:t.call(e)},e.prototype.IsShapeHyperlink=function(){var e,t;return null===(t=(e=this.parent).IsShapeShell)||void 0===t?void 0:t.call(e)},Object.defineProperty(e.prototype,"Begin",{get:function(){return this.IsTextHyperlink()?this.begin:-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"End",{get:function(){return this.IsTextHyperlink()?this.end:-1},enumerable:!1,configurable:!0}),e.prototype.setProperties=function(e,t){if(e&&null!=t){var r=window.APP.workspace.getSelection();if(r){var n;switch(e){case o:n={action:i.WpActionType.ActionHyperlink,linkTo:i.ActionLinkToType.URL,hyperlink:{address:t}};break;case s:n={action:i.WpActionType.ActionHyperlink,linkTo:i.ActionLinkToType.Slide,hyperlink:{subAddress:t}};break;case l:n={action:i.WpActionType.ActionHyperlink,linkTo:i.ActionLinkToType.URL,hyperlink:{address:"mailto:".concat(t)}};break;case c:n={hyperlink:Object.assign(this.hyperlink,{screenTip:t})};break;case u:if(this.IsTextHyperlink()&&t.length>0){var h=this.parent.coreData,d=h.getText(this.begin,this.end-this.begin).join(""),p=t,f={};return h._bubbleUpEvent(a.default.collect_path,f),f.begin=this.begin,f.end=this.end,r.replaceText(d,p,[f],h)}}if(n)if(this.IsShapeHyperlink()){var v=window.APP.utils.createModifier("Actions");v.modify("mouseClick",n);var y=this.parent.coreData;r.applyShapeModifiers([v],[y])}else{var g=this.Begin,m=this.End,_=this.parent.coreData,S=_&&_.parent;if(!S)return;window.APP.coreAPI.beginCommand(this),r.cmdFmtChpx({actions:{mouseClick:n}},g,m-g,S),window.APP.coreAPI.endCommand()}else console.warn("Invalid Hyperlink type !!")}}},e}();t.HyperlinkShell=h},4289:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WOErrorCode=void 0,t.WOErrorCode={WO_OK:0,WO_FAIL:-1,WO_NOTIMPL:-2,WO_NEED_PASSWORD:-3,WO_INVALID_PASSWORD:-4,WO_NEED_MODIFY_PASSWORD:-5,WO_INVALID_MODIFY_PASSWORD:-6,WO_NOT_SUPPORT_SECURITY_DOC:-7,WO_NOTHING_TO_PRINT:-8,WO_EXCEED_EXPORT_PAGES_LIMIT:-9,WO_SECDOC_NEED_PERMISSION:-10,WO_SECDOC_NETWORK_UNREACHABLE:-11,WO_SAVED_EMPTY:-12,WO_READ_ONLY_SAVE_FAIL:-13,WO_PREVIEW_PAGE_OVER_LIMIT:-14,WO_FILE_PROTECTED:-15,WO_IO_CANCEL:-16,WO_SVG_EXPORT_CANCELLED:-17,WO_INVALID_ARG:-18,WO_AUTOPASSWD_NOT_FOUND:-19,WO_SHARED_LINK_INVALID:-20,WO_SHARED_LINK_ACCESS_DENIED:-21,WO_CORE_DATA_ERROR:-22,WO_INVALID_COMMAND:-23,XVA_INVALID_ARG:-101,XVA_COMMAND_NOT_SUPPORT:-102,XVA_COMBINE_LIMIT:-103,XVA_SAVE_FAIL:-104,XVA_WATERMARK_NOT_EXIST:-105,XVA_PATH_NOT_EXIST:-106}},4290:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextRangeShell=void 0;var n=r(4883),i=function(){function e(e,t){this.textframe=e,this.textstream=e.TextStream,this.textrange=t||{}}return e.prototype.GetSupLayer=function(){return this.textframe},Object.defineProperty(e.prototype,"Begin",{get:function(){return this.textrange.begin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"End",{get:function(){return this.textrange.end},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.textstream&&this.textstream.GetText(this.Begin,this.End-this.Begin).join("")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Font",{get:function(){return new n.ShapeFontShell(this)},enumerable:!1,configurable:!0}),e.prototype.InsertText=function(e){},e}();t.TextRangeShell=i},4291:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=r(664),a=r(765),o=r(144),s=r(167),l=(0,n.__importDefault)(r(237)),u=function(){function e(e){var t=this;this.handleChange=function(){var e,r;null===(e=t.presentation)||void 0===e||e.off(l.default.names.ON_COMMENT_CHANGE,t.handleCommentChange),null===(r=t.presentation)||void 0===r||r.on(l.default.names.ON_COMMENT_CHANGE,t.handleCommentChange)},this.handleCommentChange=function(e){var r,n=e.op;(null==n?void 0:n.opType)?t.fireCommentModifyInfo(e):t.opName=null===(r=null==n?void 0:n.param)||void 0===r?void 0:r.op},this.fireCommentModifyInfo=function(e){var r,n,i=e.op,a=t.opName;switch(a){case"model_insert_data":a="insert";break;case"model_remove_data":a="delete";break;default:a="modify"}var o={opName:a,slideId:null==e?void 0:e.slideId,comment:(null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.private)||(null===(n=null==i?void 0:i.obj)||void 0===n?void 0:n.private)};t.doc.fire(l.default.OPENAPI_EVENT.COMMENT_MODIFY_MESSAGE,{param:o}),t.opName=""},this.goToItem=function(e,r){var n,a,l,u=null===(n=t.selection.getActiveSlide())||void 0===n?void 0:n.getId();if(o.isMobile){if(u===e&&t.doc.getMode()===s.ViewModes.Review)return t.doc.fire(i.OPENAPI_EVENT.GO_TO_COMMENTITEM,{slideId:e,commentId:r});window.wppCache.set("goToCommmenId",{commentId:r,slideId:e});var c=t.presentation.getSlideIdxById(e);window.switchPageTo(s.ViewModes.Review,c,!1,!1)}else{if(u!==e){null===(a=t.slideMarker)||void 0===a||a.clear();c=null===(l=t.selection.getPresentation())||void 0===l?void 0:l.getSlideIdxById(e);t.doc.setActiveSlide(c)}t.doc.fire(i.OPENAPI_EVENT.GO_TO_COMMENTITEM,{slideId:e,commentId:r})}},this.app=e,this.bindEvents()}return Object.defineProperty(e.prototype,"shell",{get:function(){var e;return null===(e=this.app)||void 0===e?void 0:e.shell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){var e;return null===(e=this.shell)||void 0===e?void 0:e.doc},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workspace",{get:function(){var e,t;return null===(t=null===(e=this.shell)||void 0===e?void 0:e.app)||void 0===t?void 0:t.workspace},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var e;return null===(e=this.workspace)||void 0===e?void 0:e.getSelection()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"presentation",{get:function(){var e;return null===(e=this.workspace)||void 0===e?void 0:e.presentation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slideMarker",{get:function(){return this.selection.getSlideMarker()},enumerable:!1,configurable:!0}),e.prototype.bindEvents=function(){l.default.uilDispatcher.on(l.default.eventTypes.names.DOC_INIT_DONE,this.handleChange)},e.prototype.Add=function(e){return(0,n.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,n.__generator)(this,(function(r){switch(r.label){case 0:return[4,window.APP.dispatch((0,a.postComment)(e)).then((function(r){var n,i=null===(n=t.selection.getPresentation())||void 0===n?void 0:n.getSlideById(e.curSlideId),a=r.response.body,o={authorId:a.user_info.id,authName:a.user_info.name},s={commentId:a.comment_id,content:e.text,time:(new Date).getTime(),shape:e.shape,media_type:"text"};return t.selection.commentHandler(i,0,o,s,e.replyer)}))];case 1:return[2,r.sent()]}}))}))},e.prototype.getInfo=function(e,t,r){void 0===t&&(t="invalid");var n=this.presentation;this.presentation.queryComment(e,t,(function(e){if(e.comments)for(var t=0;t<e.comments.length;t++)for(var i=0;i<e.comments[t].length;i++){var a=e.comments[t][i].item,o=n.getCommentHelper().decodeComment(a.content),s=o.content,l=o.replyId;l&&(a.content=s,a.replyId=l)}r(e)}))},e}();t.default=u},434:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var n=r(143);t.logger=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window.isDebugger&&console.log.apply(console,(0,n.__spreadArray)(["PluginMgr"],e,!1))}},446:function(e,t,r){"use strict";r.d(t,"a",(function(){return C})),r.d(t,"b",(function(){return S})),r.d(t,"e",(function(){return k})),r.d(t,"c",(function(){return w})),r.d(t,"d",(function(){return x}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(44),d=r.n(h),p=r(150),f=r.n(p),v=r(304),y=r(263),g=r(335),m=r(167),_=r(461),S={MODIFY:"model_modify_data",INSERT:"model_insert_data",REMOVE:"model_remove_data",MOVE:"model_move_data",RESET:"model_reset_data"};function T(e,t){var r=[];t&&t.disabled instanceof Array&&(r=t.disabled),e.getCoreObject=function(){return this},r.indexOf("at")<0&&(e.at=function(e){return this.private.childs[e]}),r.indexOf("indexOf")<0&&(e.indexOf=function(e){return this.private.childs.indexOf(e)}),r.indexOf("length")<0&&(e.length=function(){return this.private.childs.length}),r.indexOf("set")<0&&(e.set=function(e,t){var r=this.private.childs;if(r.length<=e)return-1;var n=r[e];return r[e]=t,t.parent=this.getCoreObject(),this.addVectorOperate(this,v.default.otModify,e,t,n),0}),r.indexOf("push")<0&&(e.push=function(e){var t=this.private.childs;return t.push(e),e.parent=this.getCoreObject(),this.addVectorOperate(this,v.default.otInsert,t.length-1,e),0}),r.indexOf("pop")<0&&(e.pop=function(){return this.remove(this.length()-1)}),r.indexOf("insert")<0&&(e.insert=function(e,t){var r=this.private.childs;return r.length<e?-1:(r.splice(e,0,t),t.parent=this.getCoreObject(),this.addVectorOperate(this,v.default.otInsert,e,t),0)}),r.indexOf("remove")<0&&(e.remove=function(e){var t=this.private.childs;if(t.length<=e||e<0)return-1;var r=t[e];return t.splice(e,1),delete r.parent,this.addVectorOperate(this,v.default.otRemove,e,r),0}),r.indexOf("move")<0&&(e.move=function(e,t){var r,n=this.private.childs;return e+t<0||e+t>n.length?-1:(r=n[e],t<0?(n.splice(e,1),n.splice(e+t,0,r)):t>0&&(n.splice(e+t,0,r),n.splice(e,1)),this.addVectorOperate(this,v.default.otMove,e,r,void 0,t),0)}),e.addVectorOperate=function(e,t,r,n,i,a){var o,s=(o={},f()(o,v.default.otModify,S.MODIFY),f()(o,v.default.otInsert,S.INSERT),f()(o,v.default.otRemove,S.REMOVE),f()(o,v.default.otMove,S.MOVE),f()(o,v.default.otReplaceData,S.RESET),o),l={index:r,value:n};null!=a&&(l.offset=a),this._fireDataChanged(s[t],l),this.isTopObject()||window.g_rpt.addVectorOperate(e,t,r,n,i,a>0?a-1:a)}}function b(e,t){e.initialize=function(){this.objType=v.default.OType_Vector,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this)},e.isTopObject=t?function(){return!0}:function(){return!1},Object.defineProperty(e,"listener",{key:"listener",get:function(){return this._listener||(this._listener=new g.a),this._listener}}),e.on=function(e,t){this.listener.on(e,t)},e.writeLock=function(){},e._fireDataChanged=function(e,t){t.obj=this,t.op=e;var r=this.getActionType();if(r){t.actionType=r,this.clearActionType();var n=window.selection.transaction;if(!n.isInTransaction()){var i=n.rpt.transacts;i.length>0&&(n=i[i.length-1])}n&&(t.isSelf=n.isSelf,t.isLocal=n.isLocal)}t.obj&&t.obj.apiShell&&t.obj.apiShell.buildTree(t.apiShell),this.listener.fire(e,t,!0)},e.childsBuildTree=function(){var e=this.private.childs,t=this.getCoreObject();if(t&&t.parent)t.buildTree&&t.buildTree(t.parent);else for(var r=0;r<e.length;r++){var n=e[r];n.buildTree?n.buildTree(t):n.parent=t}},e._doOperate=function(e){var t=this.private.childs;switch(e.opType){case v.default.otInsert:if(!e.data){var r=window.g_rpt.getCurTransactIndex(),n=window.g_rpt.transacts[r];throw new Error("{ mainOp: "+JSON.stringify(n&&n.mainOperstes)+", pos: "+e.pos+", constructor: "+this.constructor.name+', type: "insert", length: '+t.length+"}")}t.splice(e.pos,0,e.data),e.data.parent=this.getCoreObject(),this._fireDataChanged(S.INSERT,{index:e.pos,value:e.data,isForward:e.isForward});break;case v.default.otRemove:var i=t[e.pos];if(!i){var a=window.g_rpt.getCurTransactIndex(),o=window.g_rpt.transacts[a];throw new Error("{mainOp: "+JSON.stringify(o&&o.mainOperstes)+", pos: "+e.pos+", constructor: "+this.constructor.name+', type: "remove", length: '+t.length+"}")}t.splice(e.pos,1),delete i.parent,this._fireDataChanged(S.REMOVE,{index:e.pos,value:i,isForward:e.isForward});break;case v.default.otMove:e.offset<0?(t.splice(e.pos,1),t.splice(e.pos+e.offset,0,e.data)):e.offset>0&&(t.splice(e.pos+e.offset,0,e.data),t.splice(e.pos,1)),this._fireDataChanged(S.MOVE,{index:e.pos,offset:e.offset,value:e.data,isForward:e.isForward});break;case v.default.otModify:t[e.pos]=e.data,e.data.parent=this.getCoreObject(),this._fireDataChanged(S.MODIFY,{index:e.pos,value:e.data,isForward:e.isForward});break;case v.default.otReplaceData:for(var s=t,l=0;l<s.length;l++)delete s[l].parent;t.splice(0);for(var u=0;u<e.data.length;u++)t.push(e.data[u]),e.data[u].parent=this.getCoreObject();this._fireDataChanged(S.RESET,{value:t,isForward:e.isForward})}this.childsBuildTree()},e.forward=function(e){var t={obj:e.obj,data:e.data,opType:e.opType,pos:e.pos,offset:e.offset};t.opType===v.default.otMove&&t.offset>0&&(t.offset=t.offset+1),t.isForward=!0,e.isForward=!0,this.setActionType(m.TransActionType.Forward),this._doOperate(t)},e.backward=function(e){var t={};switch(t.obj=e.obj,t.pos=e.pos,e.opType){case v.default.otInsert:t.opType=v.default.otRemove,t.data=e.data;break;case v.default.otRemove:t.opType=v.default.otInsert,t.data=e.data;break;case v.default.otMove:t.opType=v.default.otMove,t.offset=e.offset,t.offset>0?(t.offset=t.offset+1,t.pos=e.pos+t.offset-1):t.pos=e.pos+t.offset,t.offset=1-t.offset,t.data=e.data;break;case v.default.otModify:t.opType=v.default.otModify,t.oldData=e.data,t.data=e.oldData;break;case v.default.otReplaceData:t=e}t.isForward=!1,e.isForward=!1,this.setActionType(m.TransActionType.BackWard),this._doOperate(t)},e.setActionType=function(e){this.actionType=e},e.getActionType=function(){return this.actionType},e.clearActionType=function(){delete this.actionType}}function k(e,t){e.initialize=function(){this.objType=v.default.OType_Custom,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this)},e.isTopObject=t?function(){return!0}:function(){return!1},e.writeLock=function(){if(!this.__modified){var e=this.private;for(var t in e)null==e[t]&&delete e[t];window.g_rpt.addDataNotify(this)}},Object.defineProperty(e,"listener",{key:"listener",get:function(){return this._listener||(this._listener=new g.a),this._listener}}),e.on=function(e,t){this.listener.on(e,t)},e.listenPropertyChanged=function(e,t){var r=[];this._inner&&(r=this._inner.listenNames||[]),e.forEach((function(e){r.indexOf(e)<0&&r.push(e)})),this._inner=Object.assign(this._inner||{},{listenNames:r}),this.listener.on("propertyChanged",(function(e){var r=e.name,n=e.oldval,i=e.newval;t(r,n,i)}))},e._firePropertyChanged=function(e,t,r){var n=this._inner&&this._inner.listenNames;n&&n.indexOf(e)>=0&&this.listener.fire("propertyChanged",{name:e,oldval:t,newval:r},!0)},e._applyOperate=function(e,t){if(e.opType===v.default.otModify||e.opType===v.default.otReplaceData){var r=this.private,n=Object.assign({},r);this.private=Object.assign({},e.data);var i=this._inner&&this._inner.listenNames;if(i)for(var a=0;a<i.length;a++){var o=i[a];this.listener.fire("propertyChanged",{name:o,oldval:n[o],newval:this.private[o]},!0)}e.data=n}else if(this._getOperateProperty){var s=e.opType;if(!t)if(s===v.default.otInsert)s=v.default.otRemove;else{if(s!==v.default.otRemove)return;s=v.default.otInsert}var l=this._getOperateProperty(Object.assign({},e,{opType:s}));if(l){var u=Object.keys(l),c=Object.assign({},this.private);if(s===v.default.otInsert)Object.assign(this.private,l);else if(s===v.default.otRemove)for(var h=0;h<u.length;h++)delete this.private[u[h]];for(var d=0;d<u.length;d++){var p=u[d];this._firePropertyChanged(p,c[p],s===v.default.otRemove?void 0:this.private[p])}}}else console.warn("Unhandled op:",e)},e.forward=function(e){switch(this.setActionType(m.TransActionType.Forward),e.opType){case v.default.otModify:case v.default.otReplaceData:case v.default.otInsert:case v.default.otRemove:case v.default.otMove:this._applyOperate(e,!0)}this.listener.fire("onForward",e,!0)},e.backward=function(e){if(this.setActionType(m.TransActionType.BackWard),e.data instanceof Array){var t=[];Object.assign(t,e.data),t.reverse();for(var r=0;r<t.length;++r){var n=t[r];n.primary=e,1==n.islocal?n.func in this&&this[n.func]instanceof Function?this[n.func](n.param.data):console.error("backward failed, not found function",n.func):this.listener.fire("onBackward",n,!0)}}else this._applyOperate(e,!1),this.listener.fire("onBackward",e,!0)},e.setActionType=function(e){this.actionType=e},e.getActionType=function(){return this.actionType},e.clearActionType=function(){delete this.actionType},e._enableModifyProperty=function(e){if(this._bFake&&e&&e.length>0){if(!this._createFakeData)return{error:1};this._fakeEnableProps||(this._fakeEnableProps=[]);for(var t=[],r=0;r<e.length;r++){var n=e[r];if(this._fakeEnableProps.indexOf(n)<0){var i=this.private[n];if(i){var a=this._createFakeData(n,i);a?(this.private[n]=a,this._fakeEnableProps.push(n)):t.push(n)}else this._fakeEnableProps.push(n)}}return{error:0,failNames:t}}return{error:2}},e.cloneFake=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new this.constructor({data:{}});if(Object.assign(t.private,this.private),t._bFake=!0,e){var r=this._enableModifyProperty(e),n=r.error,i=r.failNames;0===n?i&&i.length>0&&console.warn("cloneFake: "+JSON.stringify(i)+" will be not allowed modify!"):1===n&&console.warn("cloneFake: create a readonly object!")}return t},e.enableModifyProperty=function(e){var t=this._enableModifyProperty(e),r=t.error,n=t.failNames;0===r?n&&n.length>0&&console.warn("enableModifyProperty: "+JSON.stringify(n)+" will be not allowed modify!"):1===r&&console.warn("enableModifyProperty: enable "+JSON.stringify(e)+" failed!")},e._getPropertyValue=function(e){return this.private&&this.private[e]},e._setPropertyValue=function(e,t){if(!this._bFake||this._fakeEnableProps&&!(this._fakeEnableProps.indexOf(e)<0)){var r=this.getPropertyValue(e);if(Object(_.deepCompare)(r,t))return f()({},e,t);window.getTransaction().isInTransaction()&&this.writeLock();var n={};return null==t?n.undefineds=[e]:n[e]=t,this.private&&(this.private[e]=t),this._fireChanged&&this._fireChanged(),this._firePropertyChanged(e,r,t),n}console.error("Fake AbsObject can not modify property "+e)},e.getPropertyValue||(e.getPropertyValue=function(e){return this._getPropertyValue(e)}),e.setPropertyValue||(e.setPropertyValue=function(e,t){return this._setPropertyValue(e,t)}),e.modifyProperties=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null==e||"object"!=(void 0===e?"undefined":d()(e)))return null;var r=Object.assign({},e),n=r.undefineds;delete r.undefineds,delete r.childs,delete r.extendProps,delete r.cmdExtends,delete r.cmdFlags,delete r.modifiers,n&&n.forEach((function(e){return r[e]=null}));var i={undefineds:n=[]};for(var a in r){var o=r[a];o&&t&&(o=t(a,this.getPropertyValue(a),o));var s=this.setPropertyValue(a,o);s.undefineds&&(s.undefineds.forEach((function(e){return n.push(e)})),delete s.undefineds),Object.assign(i,s)}return{newval:i}}}var C=function(e){function t(e){return i()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return c()(t,e),o()(t,[{key:"applySvrData",value:function(e){this.private=e.data,this.objID=e.id,this.vector=e.data.childs}}]),t}(y.AbsObject);T(C.prototype),b(C.prototype,!1);var w=function(){function e(t){i()(this,e),this._core=t}return o()(e,[{key:"initialize",value:function(){this.objType=v.default.OType_Vector,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this._core)}},{key:"core",get:function(){return this._core}},{key:"private",get:function(){return this._core.private},set:function(e){this._core.private=e}}]),e}();T(w.prototype),b(w.prototype),w.prototype.getCoreObject=function(){return this._core};var P=function(){function e(t){i()(this,e),this._core=t}return o()(e,[{key:"initialize",value:function(){this.objType=v.default.OType_Custom,void 0!==window.g_rpt&&window.g_rpt.registerNewObject(this._core)}},{key:"core",get:function(){return this._core}},{key:"private",get:function(){return this._core.private},set:function(e){this._core.private=e}}]),e}();function x(e,t){if(e){var r=t.ListAtomDelegateClass,n=t.CustomAtomDelegateClass,i=t.selfAtomeType;if(r||n){var a=e.prototype,o=!!r,s=!!n,l="customAtom"===i,u="listAtom"===i;if(Object.defineProperty(a,"hasListDelegate",{key:"hasListDelegate",get:function(){return o||u}}),Object.defineProperty(a,"listAtomDelegate",{key:"listAtomDelegate",get:function(){return u?this:o?(this._listAtomDelegate||(this._listAtomDelegate=new r(this)),this._listAtomDelegate):null}}),Object.defineProperty(a,"hasCustomDelegate",{key:"hasCustomDelegate",get:function(){return s||l}}),Object.defineProperty(a,"customAtomDelegate",{key:"customAtomDelegate",get:function(){return l?this:s?(this._customAtomDelegate||(this._customAtomDelegate=new n(this)),this._customAtomDelegate):null}}),r){var c=["at","indexOf","length","set","push","pop","insert","remove","move","addVectorOperate","getShapeIndex","removeAt","isTopObject"];l||s||c.push("writeLock"),a._delegateListFuncs=[];for(var h=0;h<c.length;h++){var d=c[h];a.hasOwnProperty(d)||function(){a._delegateListFuncs.push(d);var e=r.prototype[d];a[d]=function(){return e.apply(this.listAtomDelegate,arguments)}}()}}if(n){var p=["isTopObject","writeLock"];a._delegateCustomFuncs=[];for(var f=0;f<p.length;f++){var y=p[f];a.hasOwnProperty(y)||function(){a._delegateCustomFuncs.push(y);var e=n.prototype[y];a[y]=function(){return e.apply(this.customAtomDelegate,arguments)}}()}}(l||u)&&(a.__forward=a.forward,a.__backward=a.backward);var g=function(e,t,r){var n=null;(n=t?e.listAtomProperties:e.listAtomDelegate.listAtomProperties)&&r&&r.data&&n.forEach((function(t){r.data[t]=e.private[t]}))};a.forward=function(e){this.setActionType(m.TransActionType.Forward),e.opType===v.default.otReplaceData&&this.hasCustomDelegate?(this.hasListDelegate&&g(this,u,e),l?this.__forward(e):this.customAtomDelegate.forward(e)):this.hasListDelegate&&(u?this.__forward(e):this.listAtomDelegate.forward(e)),this.afterForward&&this.afterForward(e)},a.backward=function(e){this.setActionType(m.TransActionType.BackWard),this.hasCustomDelegate&&(e.data instanceof Array||e.opType===v.default.otReplaceData)?(!this.hasListDelegate||e.data instanceof Array||e.opType!==v.default.otReplaceData||g(this,u,e),l?this.__backward(e):this.customAtomDelegate.backward(e)):this.hasListDelegate&&(u?this.__backward(e):this.listAtomDelegate.backward(e)),this.afterBackward&&this.afterBackward(e)},a.setActionType=function(e){this.actionType=e},a.getActionType=function(){return this.actionType},a.clearActionType=function(){delete this.actionType},a.on=function(e,t){this.hasCustomDelegate&&this.customAtomDelegate.listener.on(e,t),this.hasListDelegate&&this.listAtomDelegate.listener.on(e,t)}}}}k(P.prototype),P.prototype.getCoreObject=function(){return this._core}},461:function(e,t,r){"use strict";r.r(t),r.d(t,"ArrayMergeType",(function(){return i})),r.d(t,"arrayUnion",(function(){return a})),r.d(t,"deepCompare",(function(){return l})),r.d(t,"deepMergeWithConfigs",(function(){return u})),r.d(t,"deepMerge",(function(){return c})),r.d(t,"defaultMergeConfig",(function(){return h})),r.d(t,"FillMergeConfig",(function(){return d})),r.d(t,"TextStyleConfig",(function(){return p})),r.d(t,"OutlineMergeConfig",(function(){return f})),r.d(t,"deepCloneWithConfigs",(function(){return v})),r.d(t,"hash",(function(){return g}));var n=r(268);r.d(t,"deepClone",(function(){return n.a}));var i={REPLACE:0,CONCAT:1,UNION:2,DEEPMERGE:3,CUSTOM:4};function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t&&t.length>0){for(var n=null,i=0;i<t.length;i++){var a=t[i];if(null!=n){if(a)for(var o=0;o<a.length;o++)n.indexOf(a[o])<0&&n.push(a[o])}else n=a}return n}}function o(e,t,r){return r.bFastClone&&t instanceof Object?r.fastClone?r.fastClone(e,t):Object(n.a)(t):t}function s(e,t,r,l){if((t=t||{}).customDeepMerge)return t.customDeepMerge(e||[],t);var u=t,c=u.deeps,h=u.names,d=u.merger,p=u.clone,f=u.arrayMerger,v=u.arrayMergeType,y=u.bFastClone;t.init&&(e=t.init(e));for(var g=[],m=0;m<e.length;m++)null!=e[m]&&e[m]instanceof Object&&(t.bClone||0===g.length&&y?g.push(p?p(e[m]):Object(n.a)(e[m])):g.push(e[m]));if(0!==g.length){t.bClone&&(y=!1);for(var _={deeps:c,names:h,merger:d,arrayMerger:f,arrayMergeType:v,bFastClone:y,fastClone:t.fastClone},S=g[0],T=1;T<g.length;T++){var b=g[T];if(null!=c&&r>c)S=b;else for(var k=Object.keys(b),C=0;C<k.length;C++){var w=k[C],P=l+"/"+w;if(h&&d){for(var x=!1,O=0;O<h.length;O++)if(P===h[O]||"/"!==h[O]&&P.endsWith(h[O])){x=!0;break}if(x){var E=d(r,P,S[w],b[w]);if(E&&E.succ){S[w]=E.result;continue}}}if(null!=c&&r>=c)S[w]=b[w];else if(null==S[w])S[w]=o(P,b[w],t);else if(S[w]instanceof Object&&b[w]instanceof Object){if(!h&&d){var I=d(r,P,S[w],b[w]);if(I&&I.succ){S[w]=I.result;continue}}var A=S[w]instanceof Array,R=b[w]instanceof Array;A&&R?v===i.CONCAT?S[w]=S[w].concat(b[w]):v===i.UNION?a(S[w],b[w]):v===i.DEEPMERGE?S[w]=s([S[w],b[w]],_,r+1,l+"/"+w):v===i.CUSTOM&&f?S[w]=f(S[w],b[w]):S[w]=o(P,b[w],t):S[w]=A||R?o(P,b[w],t):s([S[w],b[w]],_,r+1,l+"/"+w)}else S[w]=o(P,b[w],t)}}return S}}function l(e,t){if(e===t)return!0;if(e&&t){if(e instanceof Array&&t instanceof Array)return function e(t,r){if(t instanceof Array){if(!r)return!1;if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(t[n]instanceof Array&&r[n]instanceof Array){if(!e(t[n],r[n]))return!1}else if(!l(t[n],r[n]))return!1;return!0}return l(t,r)}(e,t);if("Object"===e.constructor.name&&"Object"===t.constructor.name){var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0,a=r.length;i<a;++i){if(!l(e[r[i]],t[r[i]]))return!1}return!0}return!1}return!1}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return s(e,t,1,"")}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(t)}var h={deeps:1,bClone:!0},d=h,p={deeps:4,arrayMergeType:i.DEEPMERGE,bClone:!1,bFastClone:!0,clone:function(e){if(!e)return e;var t={};return e.chpStyles&&(t.chpStyles=Object(n.a)(e.chpStyles)),e.paraStyles&&(t.paraStyles=Object(n.a)(e.paraStyles)),e.listNumbers&&(t.listNumbers=Object.assign({},e.listNumbers)),t},fastClone:function(e,t){return"/listNumbers"===e?Object.assign({},t):e.startsWith("/listNumbers/")?t:Object(n.a)(t)},customDeepMerge:function(e,t){if(0!==e.length){var r=t.bClone||t.bFastClone;if(r&&1===e.length)return t.clone?t.clone(e[0]):Object(n.a)(e[0]);for(var i=r?{chpStyles:[],paraStyles:[]}:e[0],a=r?0:1;a<e.length;a++)for(var o=e[a],s=o.chpStyles,l=o.paraStyles,u=o.listNumbers,c=0;c<9;c++){if(s&&s[c]){var h=i.chpStyles[c]&&i.chpStyles[c].prop;i.chpStyles[c]={prop:Object.assign({},h,s[c].prop)}}if(l&&l[c]){var d=i.paraStyles[c]&&i.paraStyles[c].prop;i.paraStyles[c]={prop:Object.assign({},d,l[c].prop)}}u&&(i.listNumbers=Object.assign({},i.listNumbers,u))}return r?t.clone?t.clone(i):Object(n.a)(i):i}}},f={names:["/fill"],deeps:1,merger:function(e,t,r,n){if("/fill"===t)return{succ:!0,result:u([r,n],d)}},bClone:!0};function v(e,t){return u([e],Object.assign({},t,{bClone:!0}))}var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split("");function g(e){for(var t=5381,r=e.length-1;r>-1;r--)t+=(t<<5)+e.charCodeAt(r);var n=2147483647&t,i="";do{i+=y[63&n],n>>=6}while(n);return i}},4662:function(e,t,r){"use strict";r.r(t),r.d(t,"WppApplication",(function(){return Et}));var n={};r.r(n),r.d(n,"ShapeUtil",(function(){return He})),r.d(n,"Selection",(function(){return We})),r.d(n,"CoreAPI",(function(){return ze}));var i=r(147),a=r.n(i),o=r(0),s=r.n(o),l=r(3),u=r.n(l),c=r(43),h=r.n(c),d=r(44),p=r.n(d),f=r(25),v=r.n(f),y=r(154),g=r.n(y),m=r(42),_=r.n(m),S=r(315);var T=r(2718),b=r(158),k=r(335);r(4861);HTMLCollection.prototype.forEach=HTMLCollection.prototype.forEach||function(e){[].slice.call(this).forEach(e)},NodeList.prototype.forEach=NodeList.prototype.forEach||function(e){[].slice.call(this).forEach(e)},HTMLElement.prototype.remove=HTMLElement.prototype.remove||function(){this.removeNode(!0)},HTMLElement.prototype.contains=HTMLElement.prototype.contains||function(e){for(;e;){if(e===this)return!0;e=e.parentNode}return!1},SVGElement.prototype.contains=SVGElement.prototype.contains||function(e){for(;e;){if(e===this)return!0;e=e.parentNode}return!1},CSSKeyframesRule.prototype.appendRule=CSSKeyframesRule.prototype.appendRule||CSSKeyframesRule.prototype.insertRule,SVGElement.prototype.remove=SVGElement.prototype.remove||function(){this.parentNode&&this.parentNode.removeChild(this)},"outerHTML"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"outerHTML",{get:function(){var e,t=void 0;return t=document.createElement("div"),e=this.cloneNode(!0),t.appendChild(e),t.innerHTML.replace('xmlns="http://www.w3.org/2000/svg"','xmlns:xlink="http://www.w3.org/1999/xlink"')},enumerable:!1,configurable:!0}),"innerHTML"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var e=this.childNodes,t="",r=0,n=e.length;r<n;r++)t+=e[r].outerHTML;return t},set:function(e){var t=document.createElement("div");t.innerHTML="<svg>"+e+"</svg>";var r=t.childNodes[0].childNodes;H(this,this.childNodes);for(var n=void 0;n=r[0];)this.appendChild(n)},enumerable:!1,configurable:!0}),"innerText"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"innerText",{get:function(){return this.textContent},set:function(e){this.textContent=e},enumerable:!1,configurable:!0}),"path"in MouseEvent.prototype||Object.defineProperty(MouseEvent.prototype,"path",{get:function(){var e=this.composedPath&&this.composedPath()||this.path,t=this.target;if(!Object.isEmpty(e))return e.indexOf(window)<0?e.concat(window):e;if(t===window)return[window];return[t].concat(function e(t,r){r=r||[];var n=t.parentNode;return n?e(n,r.concat(n)):r}(t),window)}}),"children"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),"parentElement"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),"classList"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"classList",{get:function(){var e=this;function t(t){return function(r){var n=e.className.baseVal.split(/\s+/g),i=n.indexOf(r);t(n,i,r),e.setAttribute("class",n.join(" "))}}return{add:t((function(e,t,r){~t||e.push(r)})),remove:t((function(e,t){~t&&e.splice(t,1)})),toggle:t((function(e,t,r){~t?e.splice(t,1):e.push(r)})),contains:function(t){return!!~e.className.baseVal.split(/\s+/g).indexOf(t)},item:function(t){return e.className.baseVal.split(/\s+/g)[t]||null}}}}),SVGElement.prototype.isEqualNode_o=SVGElement.prototype.isEqualNode||function(e){return!!e&&this.outerHTML===e.outerHTML},SVGElement.prototype.isEqualNode=function(e){if(!e)return!1;var t=this.getAttribute("uid");return!(!t||t!==e.getAttribute("uid"))||this.isEqualNode_o(e)},HTMLElement.prototype.matches=HTMLElement.prototype.matches||HTMLElement.prototype.msMatchesSelector,SVGSVGElement.prototype.hide=SVGSVGElement.prototype.hide||function(){this.style.opacity=0},SVGSVGElement.prototype.show=SVGSVGElement.prototype.show||function(){this.style.opacity=1},SVGSVGElement.prototype.remove=SVGSVGElement.prototype.remove||function(){this.parentNode&&this.parentNode.removeChild(this)},SVGSVGElement.prototype.setTransform=SVGSVGElement.prototype.setTransform||function(e){var t=e.offsetX,r=void 0===t?0:t,n=e.offsetY,i=void 0===n?0:n,a=e.scale,o=void 0===a?1:a;this.style.transform="translate("+r+"px, "+i+"px) scale("+o+")"},HTMLDivElement.prototype.hide=HTMLDivElement.prototype.hide||function(){this.style.opacity=0},HTMLDivElement.prototype.show=HTMLDivElement.prototype.show||function(){this.style.opacity=1},HTMLDivElement.prototype.remove=HTMLDivElement.prototype.remove||function(){this.parentNode&&this.parentNode.removeChild(this)},HTMLDivElement.prototype.setTransform=HTMLDivElement.prototype.setTransform||function(e){var t=e.translateX,r=void 0===t?0:t,n=e.translateY,i=void 0===n?0:n,a=e.translateZ,o=void 0===a?0:a,s=e.scaleX,l=void 0===s?1:s,u=e.scaleY,c=void 0===u?1:u,h=e.scaleZ,d=void 0===h?1:h,p=e.rotateX,f=void 0===p?0:p,v=e.rotateY,y=void 0===v?0:v,g=e.rotateZ,m=void 0===g?0:g,_=e.skewX,S=void 0===_?0:_,T=e.skewY,b=void 0===T?0:T,k=e.transformOrigin,C=void 0===k?"center":k;this.style.transform="translateX("+r+"px) translateY("+i+"px) translateZ("+o+"px) scaleX("+l+") scaleY("+c+") scaleZ("+d+") rotateX("+f+"deg) rotateY("+y+"deg) rotateZ("+m+"deg) skewX("+S+"deg) skewY("+b+"deg)",this.style.transformOrigin=C},HTMLDivElement.prototype.setMatrix2D=HTMLDivElement.prototype.setMatrix||function(e){var t=e.originX,r=void 0===t?0:t,n=e.originY,i=void 0===n?0:n,a=e.translateX,o=void 0===a?0:a,s=e.translateY,l=void 0===s?0:s,u=e.scaleX,c=void 0===u?1:u,h=e.scaleY,d=void 0===h?1:h,p=e.rotate,f=(void 0===p?0:p)*Math.PI/180,v=c*Math.cos(f),y=c*Math.sin(f),g=-d*Math.sin(f),m=d*Math.cos(f),_=r*(1-c*Math.cos(f))+i*d*Math.sin(f)+o,S=i*(1-d*Math.cos(f))-r*c*Math.sin(f)+l;this.style.transform="matrix("+v+", "+y+", "+g+", "+m+", "+_+", "+S+")"},HTMLDivElement.prototype.translateX=HTMLDivElement.prototype.translateX||function(e){this.style.transform="translateX("+e+"px)"},HTMLDivElement.prototype.translateY=HTMLDivElement.prototype.translateY||function(e){this.style.transform="translateY("+e+"px)"},HTMLDivElement.prototype.scale=HTMLDivElement.prototype.scale||function(e,t){this.style.transform="scale("+e+","+t+")"},HTMLDivElement.prototype.scaleX=HTMLDivElement.prototype.scaleX||function(e){this.style.transform="scaleX("+e+")"},HTMLDivElement.prototype.scaleY=HTMLDivElement.prototype.scaleY||function(e){this.style.transform="scaleY("+e+")"};var C=!!(window.hasOwnProperty("ontouchstart")||window.navigator.maxTouchPoints>1),w=0;window.addEventListener&&window.addEventListener("touchstart",(function(e){w=Date.now()}),!0);var P=function(e){function t(e){s()(this,t);var r=v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.__onDomEvt=function(e){if(r.changeClientXY(e),-1===e.type.indexOf("mouse")&&-1===e.type.indexOf("click")||!(Date.now()-w<1e3)){var t=O[e.type]||e.type,n=r.catchEvt[t]=r.catchEvt[t]||{};"mousedown"===t?(-1!==e.type.indexOf("touchstart")&&(e._detail=e._detail||1,Date.now()-(n.curTime||0)<250?e._detail++:e._detail=1),n.curTime=Date.now()):"mouseup"===t&&(e.longTap=(Date.now()-n.curTime||0)>250),r.fire(t,e)}},r.props=e,r.catchEvt={},r.mProxyEvtNames=[],r}return _()(t,e),u()(t,[{key:"changeClientXY",value:function(e){e.touches&&(e.button=0,"touchend"===e.type?(e.clientX=e.changedTouches[0].clientX,e.clientY=e.changedTouches[0].clientY):(e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY))}},{key:"off",value:function(){var e=this;if(0!==Object.keys(this._listeners).length&&(g()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"off",this).apply(this,arguments),0===Object.keys(this._listeners).length)){var r=this.props.element;this.mProxyEvtNames.forEach((function(t){return e.delDomEvt(t)})),this.mProxyEvtNames.length=0,this.props.element=null,r.eventMgr=null}}},{key:"on",value:function(e){g()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"on",this).apply(this,arguments),this.addDomEvt(e)}},{key:"addDomEvt",value:function(e){if(e&&!this.mProxyEvtNames.includes(e)){var t=this.__onDomEvt,r=this.props.element;if(document.addEventListener){r.addEventListener(e,t,!1);var n=x[e]||e;n!==e&&C&&(this.mProxyEvtNames.push(n),r.addEventListener(n,t,!1))}else document.attachEvent&&r.attachEvent("on"+e,t,!1);this.mProxyEvtNames.push(e)}}},{key:"delDomEvt",value:function(e){var t=this.__onDomEvt,r=this.props.element;document.removeEventListener?r.removeEventListener(e,t,!1):r.detachEvent("off"+e,t,!1)}}]),t}(k.a);var x={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},O={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"};function E(e,t,r){if(e){var n=e.eventMgr;n&&n.off(t,r)}}function I(e){for(var t=0,r=0,n=document.documentElement,i=document.body;e&&(e.parentNode||e.host)&&((e=e.parentNode||e.host)===document?(t=i.scrollLeft||n.scrollLeft||0,r=i.scrollTop||n.scrollTop||0):(t+=e.scrollLeft||0,r+=e.scrollTop||0),1!==e.nodeType||"fixed"!==e.style.position););return{left:t,top:r}}function A(e,t){var r=document.defaultView.getComputedStyle(e,null);return r?r[t]:void 0}function R(e){var t=e&&e.ownerDocument,r={left:0,top:0},n={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!t)return r;for(var i in n)r[n[i]]+=parseInt(A(e,i),10);var a={left:0,top:0};void 0!==e.getBoundingClientRect&&(a=e.getBoundingClientRect());var o=I(e),s=t.documentElement;return{left:a.left+o.left-(s.clientLeft||0)+r.left,top:a.top+o.top-(s.clientTop||0)+r.top}}var D=function(){function e(e,t){var r=null;if(C){var n=e["touchend"===e.type?"changedTouches":"touches"];n&&n[0]&&(r=n[0][t])}return r||(r=e[t]),r}return function(t,r){var n=I(t.target),i=n.left+e(t,"clientX"),a=n.top+e(t,"clientY");if(r){var o=R(r);i-=o.left,a-=o.top}return{left:i,top:a}}}();function L(e,t){if(e&&e.style)for(var r in t)if(["left","top","width","height"].includes(r)){var n=t[r]+"";-1!==n.indexOf("px")||-1!==n.indexOf("%")?e.style[r]=t[r]:e.style[r]=t[r]+"px"}else e.style[r]=t[r]}function N(e){return{width:e.clientWidth,height:e.clientHeight}}var M,F,B=void 0,j=void 0;function V(e,t){for(var r in t){var n=t[r];Object.isEmpty(n)||e.setAttribute(r,n)}}function H(e,t){if(e&&t)for(;t&&t.length;)e.removeChild(t[0])}M={},F=function e(t,r,n){var i,a=M[t].size,o=N(r),s=M[t];a?T.a.equals(a.width,o.width,20)&&T.a.equals(a.height,o.height,20)||(s.size=o,n(o)):s.size=o,s&&M[t]&&(M[t].requestId=(i=function(){e(t,r,n)},(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)})(i)))},B=function(e,t){var r=Object(S.a)();return M[r]={},F(r,e,t),r},j=function(e){var t;M[e]&&(t=M[e].requestId,window.cancelAnimationFrame?window.cancelAnimationFrame(t):window.clearTimeout(t),M[e].timer&&window.clearTimeout(M[e].timer)),M[e]=null};var G=void 0;function U(){return G||(G=document.getElementById("root")),G}function W(e,t){document.lockFocus=e,t&&(document.focusElement=t),e||z()}function z(){document.focusElement&&document.focusElement.focus()}var Y=b.FocusTargetsDef.SLIDE;function q(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg",e);for(var n in t){var i=t[n];Object.isEmpty(i)||r.setAttribute(n,i)}return r}var K=null,Q=null;function X(){var e="common-defs",t=document.getElementById(e);return t||(L(t=q("svg",{id:e,width:0,height:0}),{position:"absolute",width:0,height:0,left:0,top:0,cursor:"not-allowed"}),Q=q("defs"),t.appendChild(Q),document.body.appendChild(t)),t}function J(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t&&t.querySelector("defs"),i=e&&e.firstElementChild;if(n||(n=q("defs"),t.appendChild(n)),i&&"defs"===i.tagName&&n&&"defs"===n.tagName)if(r){n.children||(n.children={});for(var a=i.childNodes,o=0,s=a.length;o<s;o++){var l=a[o];n.children[l.id]||(n.appendChild(l.cloneNode(!0)),n.children[l.id]||(n.children[l.id]=!0))}i.removeNodeIds&&te(e,t)}else{var u=t.querySelectorAll("._used_url");u.forEach((function(e){var t=/\((.+?)\)/g;[{attribute:"fill",dom:e},{attribute:"stroke",dom:e},{attribute:"clip-path",dom:e}].forEach((function(e){var r=e.dom,a=e.attribute,o=r.getAttribute(a);if(o&&"none"!==o){var s=o,l=t.exec(s);if(s&&s.includes("#")&&l&&l[1]){var u=i.querySelector(""+l[1]);if(u){var c=u.cloneNode(!0);c.id="__tmep__"+Date.now()+"__"+Math.random().toString(36).substr(2),r.setAttribute(e.attribute,"url(#"+c.id+")"),n.appendChild(c)}}}}))}))}}function Z(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&t){var n=t.childNodes;if($(e,t))return!0;if(!r)for(;n[0];)t.removeChild(n[0]);for(n=e.cloneNode(!0).childNodes;n[0];)t.appendChild(n[0])}}function $(e,t){var r=t.id;if(r&&"s_"===r.slice(0,2)){var n="g#"+r+"_table",i=t.querySelector(n),a=i&&e.querySelector(n);if(!i||!a||a.childElementCount!==i.childElementCount)return!1;for(var o=function(e){var t=a.children[e].children,r=i.children[e].children;if(t.length&&t.length===r.length){var n=!0;return[].concat(h()(r)).map((function(r,i){if(!n)return n;var o=r.id?a.children[e].querySelector("g#"+r.id):t[i];if(ee(o,r,"transform"),!r.isEqualNode(o)){if(r.id!==o.id)return n=!1;if(r.childElementCount===o.childElementCount)return{oNode:r,sNode:o};Z(o,r)}})).filter((function(e){if(n&&e){var t=e.oNode,r=e.sNode;[].concat(h()(t.childNodes)).forEach((function(e,t){var n=e.id?r.querySelector("g#"+e.id):r.children[t];ee(n,e,"transform"),e.isEqualNode(n)||Z(n,e)}))}})),n&&ee(a,i,"transform"),{v:n}}},s=0;s<i.childElementCount;s++){var l=o(s);if("object"===(void 0===l?"undefined":p()(l)))return l.v}return!1}}function ee(e,t,r){if(!t||!e)return!1;if(r instanceof Array){for(var n=0;n<r.length;n++){var i=r[n],a=e.getAttribute(i)||"";a!==(t.getAttribute(i)||"")&&t.setAttribute(i,a)}return!0}if(r){var o=e.getAttribute(r)||"";o!==(t.getAttribute(r)||"")&&t.setAttribute(r,o)}}function te(e,t){t=t||X();var r=e&&e.querySelector("defs"),n=t&&t.querySelector("defs");r&&r.removeNodeIds&&(r.timer&&clearTimeout(r.timer),r.timer=setTimeout((function(){r.removeNodeIds.forEach((function(e){var t=n.querySelector("#"+e);t&&t.remove(),(t=r.querySelector("#"+e))&&t.remove(),delete n.children[e]})),delete r.timer,delete r.removeNodeIds}),500))}function re(e,t,r,n){r!==n&&(Object.isEmpty(r)?e.removeAttribute(t):e.setAttribute(t,r))}function ne(e,t){var r=e.split(/\(|,|\)/);return(r=r.slice(1,r.length-1)).splice(3,1,t),"rgba("+r.join(",")+")"}var ie=window.navigator.userAgent.toLowerCase();var ae,oe,se,le=(ae=/Windows NT (\d+)/i,(se=ie.match(ae))?oe?oe(se):parseInt(se[1]):0),ue=C&&-1!==ie.indexOf("windows");window.setLockFocus=W,window.sameCmp=function e(t,r,n){var i=n||6;if(!t||(void 0===t?"undefined":p()(t))!==(void 0===r?"undefined":p()(r)))return!1;if(t===r)return!0;if(!(t instanceof Object&&r instanceof Object))return!1;if(t.objID&&t.objID!==r.objID)return!1;if(n<1)return!1;if(t instanceof Array){if(r instanceof Array&&r.length===t.length){for(var a=0;a<t.length;a++){var o=t[a];if(o instanceof Object){if(!e(o,r[a],i-1))return!1}else if(t[a]!==r[a])return!1}return!0}return!1}var s=Object.keys(t),l=Object.keys(r);if(s.length!==l.length)return!1;for(var u=0;u<s.length;u++){var c=s[u],h=t[c];if(h instanceof Object){if(!e(h,r[c],i-1))return!1}else if(t[c]!==r[c])return!1}return!0};var ce={addEventListener:function(e,t,r){if(E.apply(void 0,arguments),e){var n=e.eventMgr=e.eventMgr||new P({element:e});n.on(t,r)}},removeEventListener:E,getScrollLeftTop:I,getElementStyle:A,getElementInnerSize:N,getElementOffset:R,getPointer:D,setStyle:L,addResizeEventListener:B,removeResizeEventListener:j,createElement:function(e,t){var r=document.createElement(e);return V(r,t),r},setElementAttrs:V,removeChilds:H,removeChildsByClassname:function(e,t){if(e)for(var r=e.getElementsByClassName(t);r[0];)e.removeChild(r[0])},modifyElementSize:function(e,t){var r=e;r.style.top=t.y||t.top||"0px",r.style.left=t.x||t.left||"0px",r.style.width=t.width+"px",r.style.height=t.height+"px";var n=t.rotate;Object.isEmpty(n)||(r.style.transform="rotate("+n+"deg")},getElementRect:function(e){var t=e.style||{top:"0px",left:"0px",width:"0px",height:"0px"},r=t.top,n=t.left,i=t.width,a=t.height;return r=+r.slice(0,r.length-2),{x:n=+n.slice(0,n.length-2),y:r,width:i=+i.slice(0,i.length-2),height:a=+a.slice(0,a.length-2)}},getChildElementAbsPosition:function(e,t){var r=R(e);return(t=Object.assign({},t)).x-=r.left,t.y-=r.top,t},setCursor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments[1];(t=t||U()||document.body).style.cursor!==e&&(t.style.cursor=e)},setCursorClass:function(e,t){if(t=t||U()||document.body,e&&t.className.includes(e))t.style.cursor&&(t.style.cursor="");else{var r=Array.from(document.body.classList).filter((function(e){return 0!==e.indexOf("cursor-")}));e&&(r.push(e),t.style.cursor=""),t.className=r.join(" ")}},getCursor:function(){return document.body.style.cursor||"default"},attrs2Style:function(e){var t="",r=["x","left","y","top","width","height"];for(var n in e)-1===r.indexOf(n)&&(t+=n+":'"+e[n]+"';");var i=e.x,a=e.left,o=e.y;return t+="top:"+(a||o||0)+"px;left:"+(e.top||i||0)+"px;width:"+(e.width||0)+"px;height:"+(e.height||0)+"px;"},setLockFocus:W,requestFocus:z,setFocusTarget:function(e){Y=e},getFocusTarget:function(){return Y},createSvgNodeByTag:q,addCommonDefs:function(e,t){J(e,t=t||X())},cloneSvgDefs:J,addSvgDefs:function(e){K=K||X(),Q&&e&&Q.appendChild(e)},cloneChildNodes:Z,updateChildNodes:function(e,t,r,n){if(e&&t&&e.childElementCount>0&&t.childElementCount>0){if(!r){for(var i=e;i&&"svg"!==i.tagName;)i=i.parentNode;r=i&&i.firstElementChild}if(!n){var a=X();n=a&&a.querySelector("defs")}var o=[],s=[];if(function e(t,r,n,i,a,o){if(!t||!r)return!1;var s=t.childElementCount,l=r.childElementCount;if(s!==l){var u=t.querySelectorAll("#"+b.PartOfShapeName.ShapeOutlinePath()),c=r.querySelectorAll("#"+b.PartOfShapeName.ShapeOutlinePath());if(!Array.from(u).every((function(e){return e.parentNode===t}))||!Array.from(c).every((function(e){return e.parentNode===r})))return!1;c.forEach((function(e){return e.remove()})),u.forEach((function(e){return r.appendChild(e.cloneNode(!0))}))}for(var h="path"===t.tagName?["d","fill","stroke","stroke-width","stroke-dasharray","stroke-linejoin","paint-order","stroke-miterlimit","fill-rule","class"]:["clip-path","transform","opacity","x","y","width","height"],d=0,p=h.length;d<p;d++){var f=h[d],v=t.getAttribute(f),y=r.getAttribute(f);if("fill"===f&&v&&y&&v.indexOf("url")>-1&&y.indexOf("url")>-1){if(!n||!i)return console.error("defs node error"),!1;var g=v.slice(5,-1),m=y.slice(5,-1),_=n.querySelector("#"+g),S=i.querySelector("#"+m);if(!_||!S||!e(_,S,n,i,a,o))return!1;g!==m&&n.removeNodeIds&&(a.push(g),o.push(m))}else re(r,f,v,y)}for(var T=0,k=t.childElementCount;T<k;T++){var C=t.children[T],w=r.children[T],P=C&&w&&C.id!==w.id&&C.id+"_LD"!==w.id&&C.id+"_HD"!==w.id;if(!C||!w||P||!e(C,w,n,i,a,o))return!1}return!0}(e,t,r,n,o,s)){var l;if(r.removeNodeIds||(r.removeNodeIds=[]),o.length>0)(l=r.removeNodeIds).push.apply(l,h()(o.filter((function(e){return!r.removeNodeIds.includes(e)}))));return s.length>0&&s.forEach((function(e){var t=r.removeNodeIds.indexOf(e);t>-1&&r.removeNodeIds.splice(t,1)})),!0}}return!1},appendChildNodes:function(e,t,r){if(e&&t&&!t.contains(e)){for(var n=t.childNodes;!r&&n[0];)t.removeChild(n[0]);for(n=e.childNodes;n[0];)t.appendChild(n[0])}},insertUnshiftNodes:function(e,t){e&&t&&(t.children[0]?t.insertBefore(e,t.children[0]):t.appendChild(e))},getCommonSvg:X,removeCommonDefs:te,createElementNS:function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)},getLastTouchStartTime:function(){return w},getTextSize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,r=arguments[2],n=document.createElement("span"),i={width:n.offsetWidth,height:n.offsetHeight};n.style.cssText="position: absolute;left: 0;display: inline-block;visibility: hidden;font-size: "+t+"px;"+(r?"font-family: "+r:""),document.body.appendChild(n),void 0!==n.textContent?n.textContent=e:n.innerText=e;var a=window.getComputedStyle(n);return i.width=parseFloat(a.width)-i.width,i.height=parseFloat(a.height)-i.height,document.body.removeChild(n),i},setDomElementBgOpacity:function(e,t){if(e){var r=getComputedStyle(e),n=r.backgroundColor;n&&"rgba(0, 0, 0, 0)"!==n&&(e.style.backgroundColor=ne(n,t));var i=r.borderTopColor,a=r.borderBottomColor,o=r.borderLeftColor,s=r.borderRightColor,l=r.color,u={borderTopColor:i,borderBottomColor:a,borderLeftColor:o,borderRightColor:s};Object.values(u).some((function(e){return e!==l}))&&Object.keys(u).forEach((function(r){u[r]!==l&&(e.style[r]=ne(u[r],t))}))}},isMouseInElement:function(e,t){var r=e.clientX,n=e.clientY;if(isNaN(r)){var i=void 0;r=(i=e.touches&&e.touches.length>1?e.touches[0]:e.changedTouches[0]).clientX,n=i.clientY}var a=t.getBoundingClientRect(),o=a.top,s=a.bottom,l=a.left,u=a.right;return r>l&&r<u&&n>o&&n<s},isWindowsTocuhDevice:ue,getRootDom:U,windowsVersion:le,formatFontName:function(e,t){var r=e.split(" ");if(r.length>1){var n=!0,i=t;switch(r.pop().toLocaleLowerCase()){case"thin":i=100;break;case"ultralight":i=200;break;case"light":i=300;break;case"regular":i=400;break;case"medium":i=500;break;case"semibold":i=600;break;case"bold":i="bold";break;default:n=!1}n&&("bold"!==t&&(t=i),e=r.join(" "))}return{fontName:e,fontWeight:t}},isTouchSupported:C},he=r(808),de=r(606),pe=r(2719),fe=r(1906),ve=r(2002),ye=r(2720),ge=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ti",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/15;switch(s()(this,e),this.ti2pxScale=n,r){case"px":this.ti=t*n;break;case"pt":this.ti=20*t;break;case"in":this.ti=1440*t;break;case"emu":this.ti=t/635;break;default:this.ti=t}}return u()(e,[{key:"pt",get:function(){return this.ti/20}},{key:"px",get:function(){return this.ti*this.ti2pxScale}},{key:"inch",get:function(){return this.ti/1440}},{key:"emu",get:function(){return 914400*this.ti}}]),e}();function me(e,t){if(!(t=t||1/15))throw new Error("scale is invalid!");if("object"===(void 0===e?"undefined":p()(e))){var r={};for(var n in e)r[n]=me(e[n],t);return r}return new ge(e,"ti",t).px}function _e(e){return parseInt(e/635)}function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/15;return 635*e/t}var Te=function(){function e(){s()(this,e),this.initFilterEvent()}return u()(e,[{key:"initFilterEvent",value:function(){this.filterMap=new Map([["mousedown",["touchstart","tap","doubletap"]],["mousemove",["touchmove","tap"]],["mouseup",["touchend","tap","touchstart"]],["click",["tap","touchstart"]],["panstart",["touchstart"]],["panmove",["touchmove"]],["panend",["touchend"]]]),this.checkMap=new Map([["touchstart",!1],["touchmove",!1],["touchend",!1],["tap",!1],["doubletap",!1]])}},{key:"isFileter",value:function(e){var t=e.type;return!!this.isNeedFilterEvent(t)||(this.checkMap.has(t)&&this.checkMap.set(t,!0),!1)}},{key:"isNeedFilterEvent",value:function(e){var t=this.filterMap.get(e);if(t)for(var r=0;r<t.length;r++){var n=t[r];if(this.checkMap.get(n))return this.checkMap.set(n,!1),!0;this.checkMap.set(n,!1)}return!1}}]),e}(),be=r(1711),ke=r(470),Ce=r(4862);Object.isEmpty=function(e){return null==e},window.domTools=ce,window.QMatrix=fe.a,window.Point=he.a,window.Line=pe.a,window.QTransform=ve.a,window.Rect=de.a,window.QBezier=ye.a,window.Ti2Px=me,window.Emu2Ti=_e,window.Px2Emu=Se,window.ti2pxRatio=1/15,window.PadActionHelper=Te,window.zoomRect=be.c,window.rectOnPointRotate=be.b,window.shapeDefaultSize=ke.shapeDefaultSize,Object(Ce.initPrototype)();var we,Pe={domTools:ce,QBezier:ye.a,QMatrix:fe.a,QTransform:ve.a,Point:he.a,Rect:de.a,Ti2Px:me,Emu2Ti:_e,Px2Emu:Se,ti2pxRatio:1/15},xe=r(26),Oe=r.n(xe),Ee=r(713),Ie=r(27),Ae=r(995),Re=r(146),De=r(324),Le=r(162),Ne=r(1512),Me=function(){function e(){s()(this,e)}return u()(e,[{key:"onOpen",value:function(e){console.log("onOpen:",e)}},{key:"onCmdResponse",value:function(e){console.log("onCmdResponse:",e)}},{key:"onOthersSelectChange",value:function(e){console.log("onOthersSelectChange:",e)}},{key:"onUserChange",value:function(e){console.log("onUserChange:",e)}},{key:"onUserBroadcast",value:function(e){console.log("onUserBroadcast:",e)}},{key:"onReconnect",value:function(e){}}]),e}(),Fe=(we=void 0,function(e){return e&&(we=e),we}),Be=function(){function e(t){var r,n=this;s()(this,e),this._onDocumentOpen=(r=a()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.reset(),e.next=3,n.cb_funcs.onOpen(t);case 3:n._documentOpened=!0,n.sender.cb_funcs=n.cb_funcs,n._openCallback(n._sessInfo);case 6:case"end":return e.stop()}}),e,n)}))),function(e){return r.apply(this,arguments)});var i=Fe();if(i)return null==t&&(t=new Me),i.cb_funcs=t,i;this._documentOpened=!1,this._fileid="",this._acl="none",this._permissions=null,null==t&&(t=new Me),this.cb_funcs=t,this.commandQueue=[],this.cmdBlocking=!1,this.sender=new je(t,this),this.processonTimer=null,this.inOfflineSimulate=!1,this.enableUpdateAckMap=!0,Fe(this),window.session=this,this._client=Ie.b(),this.registerEventHandlers(),window.backendImageManager?window.backendImageManager.onGetUrlCmd((function(e){n.getImageUrl(e)})):(window.imageMgrTask=window.imageMgrTask||[],window.imageMgrTask.push({key:"onGetUrlCmd",data:function(e){return n.getImageUrl(e)}})),this._queryCmdSeq=0,this._queryCallbacks={},this._execAckMap=new Map}return u()(e,[{key:"getUserId",value:function(){return this._userid}},{key:"getConnId",value:function(){return this._client.clientID}},{key:"getCooper",value:function(){return Re.default.cooper}},{key:"getAckMap",value:function(){return this._execAckMap}},{key:"regAckHandler",value:function(e){this.ackHandler=e}},{key:"openFile",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._fileid=e,this._openCallback=t,this._client.connect(n,r,i,!0),this._client.enable()}},{key:"updateToken",value:function(e){this.send("token.update",{token:e})}},{key:"postObjectURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window.officeType===Le.default.whiteboard?"kw":"wpp";return Ae.e(this._fileid,r,e,t)}},{key:"fetchImage",value:function(e){var t=e.slideId,r=e.shapeId,n=e.imageId,i=e.cb;console.log(t,r,n,i)}},{key:"send",value:function(e,t){return this.sender.send(e,t)}},{key:"rollback",value:function(e){this.send("presentation.rollback",{revision:e})}},{key:"rollbackByRevision",value:function(e){this.send("presentation.rollback",{revision:e})}},{key:"rollbackByVersion",value:function(e){this.send("presentation.rollback",{version:e})}},{key:"tryLock",value:function(){return!window.__WPSENV__.conflictLock.tryLock(!1)||(console.log("lock is fired"),!1)}},{key:"sendCommandBlock",value:function(e,t){throw new Error("wpp unsupport block command!")}},{key:"sendCommandQueue",value:function(e){if(this.tryLock()){var t=this.commandQueue;if(t.length>0&&this.baseVersion!==window.g_rpt.getCurTaskVersion())throw new Error("version difference");if(this.baseVersion=window.g_rpt.getCurTaskVersion(),e.forEach((function(e){e.timeFlag=Date.now(),t.push(e)})),!this.inOfflineSimulate){var r=this,n=this.sender;clearTimeout(this._execTimer),this._execTimer=null,window.APP.isDoingCmdResponse||this.cmdBlocking?this._execTimer=setTimeout((function(){n.isIdle()&&(n.exec(),Ae.d(),clearTimeout(r._execTimer),r._execTimer=null)}),0):(n.isIdle()&&n.exec(),Ae.d())}}}},{key:"sendUndo",value:function(){if(!this.inOfflineSimulate)return!!this.sender.isIdle()&&this.sender.sendUndo();console.error("undo redo but net not working....")}},{key:"sendRedo",value:function(){if(!this.inOfflineSimulate)return!!this.sender.isIdle()&&this.sender.sendRedo();console.error("undo redo but net not working....")}},{key:"hasBlocking",value:function(){return this.cmdBlocking}},{key:"hasCommands",value:function(){return this.commandQueue.length>0}},{key:"gainCommands",value:function(){var e=this.commandQueue;return this.commandQueue=[],e}},{key:"isWholeIdle",value:function(){return this.sender.isIdle()&&!this.hasCommands()}},{key:"reset",value:function(){this.commandQueue=[],this._execAckMap=new Map,this.cmdBlocking=!1,this.sender.reset()}},{key:"clearCommands",value:function(){this.cmdBlocking?this.commandQueue.splice(0,this.commandQueue.length-1):this.commandQueue=[]}},{key:"pushCommand",value:function(e){this.cmdBlocking?this.commandQueue.splice(this.commandQueue.length-1,0,e):this.commandQueue.push(e)}},{key:"popCommand",value:function(){!this.cmdBlocking&&this.commandQueue.length>0&&this.commandQueue.pop()}},{key:"getImageUrl",value:function(e){if(e){var t="presentation.updateShapes";if(e.images){t="presentation.getImages";for(var r=0,n=e.images.length;r<n;r++){var i=e.images[r].image_id;if("string"==typeof i)return void console.error('Exception: Invalid "image_id" ('+i+") when call session.getImageUrl()")}}e.medias&&(t="presentation.getImages"),this.sender.send(t,e)}}},{key:"getImageUrlFromServer",value:function(e){var t="/api/v3/office/file/"+this._fileid+"/shapes";return new Promise((function(r,n){if(window.__WPSENV__&&window.__WPSENV__.callJSON){var i={body:{ids:e}};return window.__WPSENV__.callJSON("POST",t,i).then((function(e){e&&200===e.status&&e.body&&e.body.urls?(e.body.error=0,r(e.body)):n({error:-1,msg:"getImageUrlFromServer resp error"})})).catch((function(){n({error:-1,msg:"getImageUrlFromServer failed"})}))}n({error:-1,msg:"getImageUrlFromServer failed, callAPI error!"})}))}},{key:"getPermissions",value:function(){return this._permissions}},{key:"getReadOnly",value:function(){return!this._acl||"read"===this._acl||!(this._permissions&&(!this._permissions||this._permissions.edit))}},{key:"getProcessonEditData",value:function(e){var t=this,r="presentation.getProcessOnData";if(this._client&&e){if(this.processonTimer)return;this.sender.send(r,e),this.presentation_isEdit=e.isProcessonEdit,this.presentation_reEditData=e.reEditPictureData,this.processonTimer=setTimeout((function(){t._client.off(r),t.processonTimer=null,Re.default.dispatchEvent(Re.default.names.processon.ON_PROCESSON_UPDATE,Oe()({error:"timeout"},e))}),3e3)}}},{key:"queryOmathData",value:function(e){var t=e.shapes;if(t&&1===t.length){var r=t[0],n=r.shape_id,i=r.slide_id,a={doc_type:"wps",origin_arg:{id:r.token,shapeId:n,slideId:i},export_arg:{dpi:200}};this._client&&a&&this.sender.send("presentation.queryOmath",a)}}},{key:"query",value:function(e,t,r){return this.sender.query(e,t,r)}},{key:"execQuery",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e3;this._queryCmdSeq+=1;var i={commands:[{name:e,param:t,seq:this._queryCmdSeq}]};if(r){var a=this._queryCmdSeq;this._queryCallbacks[a]=r;var o=this;setTimeout((function(){o._queryCallbacks[a]&&(r({error:-1,msg:"timeout"}),delete o._queryCallbacks[a])}),n)}var s=t.extArgs;return delete t.extArgs,this.sender.query(!0,i,s)}},{key:"execSimpleQuery",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3;this._queryCmdSeq+=1;var a=this._queryCmdSeq,o={name:e,param:t,seq:a},s=this;if(this._sendingQueryCommands)return this._sendingQueryCommands.push(o),void(r&&(this._queryCallbacks[a]=r,setTimeout((function(){s._queryCallbacks[a]&&(r({error:-1,msg:"timeout"}),delete s._queryCallbacks[a])}),i)));this._sendingQueryCommands=[o],setTimeout((function(){var e={commands:s._sendingQueryCommands};s._sendingQueryCommands=null,r&&(s._queryCallbacks[a]=r,setTimeout((function(){s._queryCallbacks[a]&&(r({error:-1,msg:"timeout"}),delete s._queryCallbacks[a])}),i));var o=t.extArgs;delete t.extArgs,s.sender.simpleQuery(e,o),n&&n()}),10)}},{key:"querySlides",value:function(e,t,r){var n={querySlides:{category:e,start:t,len:r}};this.sender.query(!0,n)}},{key:"queryInitVersionInfo",value:function(){this.sender.simpleQuery({initQueryVer:!0})&&(this.sender.cmdExecuting=!0)}},{key:"reopenFile",value:function(){var e="store-"+window.urlFileId,t=window.localStorage&&JSON.parse(window.localStorage.getItem(e)),r=t&&t.data||t,n=0;r&&(n=r.slideIndex||0)<0&&(n=0);var i={category:"slides",start:n,len:8};this.sender.simpleQuery({bExecInit:!0,slideRange:i})&&(this.sender.cmdExecuting=!0)}},{key:"setQuerySlidesCallback",value:function(e){this._querySlidesCB=e}},{key:"queryComments",value:function(e,t){var r={queryComments:{start:e,end:t}};this.sender.query(!0,r)}},{key:"gainEditAuthor",value:function(){this.sender.gainEditAuthor()}},{key:"isConnected",value:function(){return this._isConnected}},{key:"_onConnected",value:function(){this._isConnected=!0,Re.default.dispatchEvent(Re.default.names.network.ON_CONNECTED)}},{key:"_onDisconnected",value:function(e){this._isConnected=!1,Re.default.dispatchEvent(Re.default.names.network.ON_DISCONNECTED,e)}},{key:"renewSession",value:function(e){this._documentOpened=!1,this._serverid=e.serverid,console.log("session: renew serverid:",e.serverid),this.sender.sendJson("session.renew",{serverid:this._serverid}),!0===e.forbid_open||(this.commandQueue=[],this.cmdBlocking=!0,this.sender.reset(),this.sender.send("presentation.open",null)),Re.default.cooper.onNewCooperHistory()}},{key:"registerEventHandlers",value:function(){var e,t=this;this._client.on(Ie.a.OFFLINE,(function(){t._onDisconnected({clientStatus:"offline"})})),this._client.on(Ie.a.ONLINE,(function(){t._onConnected()})),this._client.on(Ie.a.CLOSED,(function(){t._onDisconnected({clientStatus:"closed"})})),this._client.on("presentation.rollback",(function(e){(Object.isEmpty(e.error)||!0!==e.error)&&(console.log("session: file rollback to revision:",e.revision,"reopen document"),t.renewSession(e))})),this._client.on("update_version_reconnect",(function(e){t.renewSession(e),Re.default.dispatchEvent(Re.default.names.network.UPDATE_NEW_VERSION)})),this._client.on("security_doc_change_reconnect",(function(e){1!==e.change_type&&2!==e.change_type||(t.renewSession(e),Re.default.dispatchEvent(Re.default.names.network.UPDATE_NEW_VERSION),Re.default.dispatchEvent(Re.default.names.file.ON_SECURITY_DOC_CHANGE_RECONNECT,e))})),this._client.on("presentation.changed",(function(e){t._onChangedNotify(e)})),this._client.on("presentation.init",(function(e){t._onInitNotify(e)})),this._client.on("user.list",(function(e){Re.default.cooper.onUserListInit(e)})),this._client.on("user.change",(function(e){t._onUserChange(e)})),this._client.on("user.selection.change",(function(e){t._onOthersSelectChange(e)})),this._client.on("session.open",(function(e){Ae.a(e.fileid),t._onSessionOpen(e)})),this._client.on("doc.permission",(function(e){t._permissions=e,t.setPermisions()})),this._client.on("securitydoc.permission.change",(function(e){Re.default.dispatchEvent(Re.default.names.file.ON_SECURITY_DOC_PERMISSION_CHANGE,e)})),this._client.on("session.pong",(function(e){var t=(new Date).getTime()-e.start;Re.default.dispatchEvent(Re.default.names.network.ON_NETWORK_SPEED_CHANGE,t)})),this._client.on("presentation.open",(e=a()(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.error){e.next=4;break}console.log("open document failed!, reason:",r.reason),e.next=7;break;case 4:return console.log("open document success"),e.next=7,t._onDocumentOpen(r);case 7:case"end":return e.stop()}}),e,t)}))),function(t){return e.apply(this,arguments)})),this._client.on("presentation.updateShapes",(function(e){window.backendImageManager?window.backendImageManager.fireGetUrlSucceed(e):window.imageMgrTask.push({key:"fireGetUrlSucceed",data:e})})),this._client.on("presentation.queryOmath",(function(e){if(e){var t={token:e.id,sha1:e.sha1};e.shapes=[t],window.backendImageManager?window.backendImageManager.fireGetUrlSucceed(e):window.imageMgrTask.push({key:"fireGetUrlSucceed",data:e})}})),this._client.on("presentation.getImages",(function(e){window.backendImageManager?window.backendImageManager.fireGetUrlSucceed(e):window.imageMgrTask.push({key:"fireGetUrlSucceed",data:e})})),this._client.on("session.shapeUrlPrefix",(function(e){e&&e.urlprefix||console.warn("shape url prefix is illegal")})),this._client.on("session.error",(function(e){var r=Ae.c(e);t._client.close(),r&&t._client.reconnect()})),this._client.on("presentation.exec",(function(e){t._onDocumentExec(e)})),this._client.on("comment.exec",(function(e){t._onDocumentExec(e)})),this._client.on("presentation.query",(function(e){t._onDocumentQuery(e)})),this._client.on("presentation.save",(function(e){t._save_cb&&t._save_cb(e)})),this._client.on("session.full",(function(){console.log("session: max users exceed, retry later..."),Re.default.dispatchEvent(Re.default.names.network.ON_FILE_OPEN_ERROR,{type:De.default.SessionFull}),t._client.close()})),this._client.on("presentation.getProcessOnData",(function(e){console.log("presentation.getProcessOnData:",e);var r={processonData:e};t.presentation_isEdit&&(r.error=null,r.isProcessonEdit=t.presentation_isEdit),r.reEditPictureData=t.presentation_reEditData,clearTimeout(t.processonTimer),t.processonTimer=null,t.presentation_isEdit?Re.default.dispatchEvent(Re.default.names.processon.ON_PROCESSON_UPDATE,r):Re.default.dispatchEvent(Re.default.names.processon.ON_PROCESSON_GETDETAIL,r)})),this._client.on("user.broadcast",(function(e){console.log("recv user.broadcast",e);var r=!1;t.cb_funcs&&(r=t.cb_funcs.onUserBroadcast(e)),r||(e.message=JSON.parse(e.message),e.error||Re.default.dispatchEvent(Re.default.names.cooper.ON_BROADCAST_MSG,e))})),this._client.on("space.full",(function(e){var t=Object.assign({manual:!0},e);Re.default.dispatchEvent(Re.default.names.ON_FILE_SPACE_CHANGE,t)})),this._client.on("space.info",(function(e){var t=Object.assign({manual:!1},e);Re.default.dispatchEvent(Re.default.names.ON_FILE_SPACE_CHANGE,t)})),this._client.on("link_permission_change",(function(e){var t=Object.assign({eventName:"permission_change"},e);Re.default.dispatchEvent(Re.default.names.file.ON_FILE_INFO_CHANGE,t)})),this._client.on("update_version",(function(e){var t=Object.assign({eventName:"update_version"},e);Re.default.dispatchEvent(Re.default.names.file.ON_FILE_INFO_CHANGE,t)})),this._client.on("version.upgrade",(function(){Re.default.dispatchEvent(Re.default.names.file.ON_FILE_INFO_CHANGE,{eventName:"force_refresh"})})),this._client.on("online_mode_change",(function(e){return Ae.b(e)})),this._client.on("session.ready",(function(){t.queryVersion(),window.backendImageManager?window.backendImageManager.setSocketReady():(window.imageMgrTask=window.imageMgrTask||[],window.imageMgrTask.push({key:"setSocketReady",data:!0}))}))}},{key:"queryVersion",value:function(e){window.APP.presentation&&window.APP.presentation.slideLazyComplete&&this.sender.query(!0,e)}},{key:"setPermisions",value:function(){this._timeoutPermission&&clearTimeout(this._timeoutPermission);var e=window.APP.presentation;if(e&&!e.bNeedQueryInitVer)window.__WPSENV__.reduxDispatch(Object(Ee.d)(this._permissions)),Re.default.dispatchEvent(Re.default.names.file.SET_FILE_PERMISSIONS,this._permissions);else{var t=this;this._timeoutPermission=setTimeout((function(){t.setPermisions()}),100)}}},{key:"beginOfflineSimulate",value:function(){this.inOfflineSimulate=!0}},{key:"endOfflineSimulate",value:function(){if(this.inOfflineSimulate=!1,this.commandQueue.length>0){this.sender.query();var e=this;setTimeout((function(){e.sender.exec()}),0)}else this.sender.query()}},{key:"enableAckMapUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.enableUpdateAckMap=e}},{key:"endOfflineSimulate2",value:function(){this.inOfflineSimulate=!1,this.sender.query()}},{key:"_onSessionOpen",value:function(e){console.log("session: opened with connid:",e.connid,"serverid:",e.serverid,"acl:",e.acl),this._acl=e.acl,this._userid=e.userid;var t=!1;this._documentOpened&&e.serverid===this._client.serverID&&this._client.serverIDEqual&&!e.will_query_init?(this.sender.onReconnect(),t=!0):(this.reset(),this._client.serverIDEqual=!0,this._documentOpened=!1),this._client.serverID=e.serverid,this._sessInfo=e,t&&this.cb_funcs.onReconnect&&this.cb_funcs.onReconnect(e);var r=window.APP&&window.APP.presentation;if(r){var n=r.selection,i=r.getSelectionsMgr();n.setConnectionInfo(this.getUserId(),this.getConnId()),i.fireSelectionChanged(n)}}},{key:"_onUserChange",value:function(e){Re.default.cooper.onUserChange(e),Re.default.cooper.onNewCooperHistory(),this.cb_funcs.onUserChange(e)}},{key:"_onOthersSelectChange",value:function(e){Re.default.cooper.onOthersSelectChange(e),this.cb_funcs.onOthersSelectChange(e)}},{key:"_onChangedNotify",value:function(e){var t=this;this.sender.onNotifyChange(e),setTimeout((function(){t.isWholeIdle()&&t.sender.query()}))}},{key:"_onInitNotify",value:function(e){e&&e.bNeedQueryInit&&this.reopenFile()}},{key:"_onDocumentQuery",value:function(e){this.sender.onQuery(e),Re.default.cooper.onNewCooperHistory(),this._isError(e)&&console.error("server error!",e),this.isWholeIdle()&&this.sender.needQuery()&&!this._isError(e)&&this.sender.query()}},{key:"_onDocumentExec",value:function(e){this.sender.hasBlocking()&&(this.cmdBlocking=!1),this.sender.onExec(e),this._isError(e)&&console.error("server error!",e),this.isWholeIdle()&&this.sender.needQuery()&&!this._isError(e)&&this.sender.query()}},{key:"_isError",value:function(e){return void 0!==e.error}},{key:"sendBroadcast",value:function(e){this.send("user.broadcast",{message:JSON.stringify(e)})}}]),e}(),je=function(){function e(t,r){s()(this,e),this.cb_funcs=t,this.parent=r,this.cmdSeq=1,this.executingCmds=null,this.cmdExecuting=!1,this.isBlocking=!1,this.baseVersion=-1,this.updateVersion=-1,this.util=new Ne.i(r),this._execAckMap=new Map}return u()(e,[{key:"send",value:function(e,t,r){return this.util.send(e,t,r)}},{key:"sendJson",value:function(e,t,r){return this.util.sendJson(e,t,r)}},{key:"callBinVar",value:function(e,t,r,n){return this.util.callBinVar(e,t,r,n)}},{key:"exec",value:function(){if(!0!==this.cmdExecuting){var e=this.parent.gainCommands();if(0!==e.length){this.isBlocking=this.parent.hasBlocking();for(var t=null,r=e.length,n=[],i=[],a=0;a<r;++a){var o=e[a];if(window.isServerOnlyAffectedCommand(i,o)){r=a;break}var s=window.serverOnlyCommandAffects&&window.serverOnlyCommandAffects(o);if(s&&s.length>0){if(i.length>0){r=a;break}i=s||[]}if(n.push(o),null!=o.param&&o.param.extArgs){t=o.param.extArgs,r=a+1;break}if(i&&i.indexOf("*")>=0){r=a+1;break}}r!==e.length&&(e.splice(0,r),this.parent.commandQueue=e);var l={commands:[]};(e=n).forEach((function(e){l.commands.push(e)})),l.commands.forEach((function(e){delete e.timeFlag,delete e.cmdFlag,e._transact&&(e._transact._cmdSended=!0,delete e._transact)})),this._callCmds(l,this.cmdSeq,t),this.cmdSeq++}}}},{key:"query",value:function(e,t,r){if(!this.cmdExecuting&&!this.parent.inOfflineSimulate&&(e||this.updateVersion>=window.g_rpt.getCurTaskVersion())&&(null==t&&(t={}),t._token=Object(S.a)(),window.g_rpt.appendVersionInfo(t),this.cmdExecuting=!0,this.isQuerying=!0,this.parent._client))try{this.send("presentation.query",t,r)}catch(e){}}},{key:"simpleQuery",value:function(e,t){if(!this.parent.inOfflineSimulate&&null!=e&&(this.isQuerying=!0,e.simpleQuery=!0,e._token=Object(S.a)(),window.g_rpt.appendVersionInfo(e),this.parent._client))try{return this.send("presentation.query",e,t),!0}catch(e){}}},{key:"sendUndo",value:function(){if(!0===this.cmdExecuting||this.parent.hasCommands())return!1;this.isBlocking=this.parent.hasBlocking();return this._callCmds({undo:!0},this.cmdSeq),this.cmdSeq++,!0}},{key:"sendRedo",value:function(){if(!0===this.cmdExecuting||this.parent.hasCommands())return!1;this.isBlocking=this.parent.hasBlocking();return this._callCmds({redo:!0},this.cmdSeq),this.cmdSeq++,!0}},{key:"onReconnect",value:function(){if(!1!==this.cmdExecuting){if(null!=this.executingCmds&&null!=this.parent._client)try{window.collectionOnce(),this.send("presentation.exec",this.executingCmds)}catch(e){}this.executingCmds=null,this.cmdExecuting=!1}}},{key:"_handleQueryResponse",value:function(e){this.cb_funcs.onCmdResponse(e),e.slides&&this.parent._querySlidesCB&&(e.slides.msgLength=e.msgLength,this.parent._querySlidesCB.pushSvrData(e.slides));var t=e.cmdResults;if(t instanceof Array)for(var r=this.parent,n=0;n<t.length;n++){var i=t[n].seq;if(i&&r._queryCallbacks[i]){var a=r._queryCallbacks[i];delete r._queryCallbacks[i],a(t[n])}}}},{key:"onQuery",value:function(e){this.cmdExecuting=!1,this.isQuerying=!1,e.simpleQuery?this._handleQueryResponse(e):(this.executingCmds=null,this.isBlocking=!1,this._handleQueryResponse(e),Re.default.cooper.onNewCooperHistory(),this.parent.hasCommands()&&this.exec())}},{key:"onExec",value:function(e){this.cmdExecuting=!1,this.executingCmds=null,this.isBlocking=!1,this.cb_funcs.onCmdResponse(e),Re.default.cooper.onNewCooperHistory(),this.parent.hasCommands()&&this.exec()}},{key:"onNotifyChange",value:function(e){e.taskVer>this.updateVersion&&(this.updateVersion=e.taskVer)}},{key:"handleDocumentAck",value:function(e,t,r){var n=e.getAckMap();if(n[r]){switch(n[r].method){case"presentation.exec":case"comment.exec":e._onDocumentExec(t)}if(e.enableUpdateAckMap&&delete n[r],e.ackHandler&&e.enableUpdateAckMap)e.ackHandler.updateExpiredKey(r)}}},{key:"needQuery",value:function(){return this.updateVersion>window.g_rpt.getCurTaskVersion()}},{key:"reset",value:function(){this.executingCmds=null,this.cmdExecuting=!1,this.isBlocking=!1,this.baseVersion=-1,this.updateVersion=-1,this.cmdSeq=1}},{key:"hasBlocking",value:function(){return this.isBlocking}},{key:"isIdle",value:function(){return!1===this.cmdExecuting&&null==this.executingCmds}},{key:"isExecuting",value:function(){return this.cmdExecuting}},{key:"_sendCmds",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.seq=t,window.g_rpt.appendVersionInfo(e),this.cmdExecuting=!0,this.executingCmds=e;try{window.collectionOnce(),this.send("presentation.exec",e,r)}catch(e){}}},{key:"_callCmds",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.seq=t,window.g_rpt.appendVersionInfo(e),this.cmdExecuting=!0,this.executingCmds=e;try{window.collectionOnce();var i=this.parent,a=i.getAckMap(),o="presentation.exec";if(window.APP.isReadOnly()&&window.APP.canComment()){o="comment.exec",e.commands||(e.commands=[]);for(var s=0;s<e.commands.length;++s){var l=e.commands[s];l.param&&(l.param.verifyType="comment")}}var u=this.callBinVar(o,e,n,(function(e,t){r.handleDocumentAck(i,e,t)}));if(u&&u.seq){var c=e;c.timestamp=(new Date).getTime();var h={cmd:o,sequence:u.seq,args:c};n&&(h.exArgs=JSON.stringify(n)),a[u.seq]={method:o,uncommit:h,expired:!1}}}catch(e){console.error(e)}}}]),e}(),Ve=r(624),He=function(){function e(){s()(this,e)}return u()(e,null,[{key:"getSlide",value:function(e){return this.getSlideByClass(e,Ne.d)}},{key:"getSlideByClass",value:function(e,t){for(var r=e.parent;r&&!(r instanceof t);)r=r.parent;return r}},{key:"getLayout",value:function(e){var t=this.getSlideByClass(e,Ne.j);return t?t.getFollowing():this.getSlideByClass(e,Ne.k)}},{key:"getMaster",value:function(e){var t=this.getLayout(e);return t?t.getFollowing():this.getSlideByClass(e,Ne.l)}},{key:"getNotesPage",value:function(e){return this.getSlideByClass(e,Ne.f)}},{key:"getNotesMaster",value:function(e){var t=this.getNotesPage(e);return t?t.getFollowing():this.getSlideByClass(e,Ne.e)}},{key:"showNotesBody",value:function(e){return!!this.getNotesPage(e)}}]),e}(),Ge=function(){function e(t,r){s()(this,e),this.parent=t,this.selectData=r,this.helper=new Ne.m(t,r)}return u()(e,[{key:"getTableRange",value:function(){return this.helper.getTableRange()}},{key:"canMergeCells",value:function(){return this.helper.canMergeCells()}},{key:"canSetRowColVal",value:function(){return this.helper.canSetRowColVal()}},{key:"mergedCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.helper.mergedCells(e)}},{key:"canUnMergeCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.helper.canUnMergeCells(e)}},{key:"getBorderType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.helper.getBorderType(e)}},{key:"innerBorderValid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.helper.innerBorderValid(e)}},{key:"shouldDelWholeTbl",value:function(e){return this.helper.shouldDelWholeTbl(e)}},{key:"_edit",value:function(e,t){if(!this.parent._fireReadOnly()){var r=this.parent,n=r.getPresentation(),i=!1;try{"edit"===r.mockCore&&r.handleMockError("mock selection edit error");var a=this.parent._getEditor("Table");if(a&&a[e]){var o=a[e].apply(a,t);return i=!0,o}}catch(e){var s={name:"edit_blocking",type:"edit",err:e.toString(),stack:e.stack};throw new Error(JSON.stringify(s))}finally{i||n.fire("error_core")}}}},{key:"modifyTableProperty",value:function(){return this._edit("modifyTableProperty",arguments)}},{key:"modifyCellsPropertyNoTransact",value:function(){return this._edit("modifyCellsPropertyNoTransact",arguments)}},{key:"modifyCellsProperty",value:function(){return this._edit("modifyCellsProperty",arguments)}},{key:"setRowHeight",value:function(){return this._edit("setRowHeight",arguments)}},{key:"setColumnWidth",value:function(){return this._edit("setColumnWidth",arguments)}},{key:"insertRow",value:function(){return this._edit("insertRow",arguments)}},{key:"tabExtend",value:function(){return this._edit("tabExtend",arguments)}},{key:"insertColumn",value:function(){return this._edit("insertColumn",arguments)}},{key:"removeRow",value:function(){return this._edit("removeRow",arguments)}},{key:"removeColumn",value:function(){return this._edit("removeColumn",arguments)}},{key:"distributeRows",value:function(){return this._edit("distributeRows",arguments)}},{key:"distributeCols",value:function(){return this._edit("distributeCols",arguments)}},{key:"mergeCells",value:function(){return this._edit("mergeCells",arguments)}},{key:"unMergeCells",value:function(){return this._edit("unMergeCells",arguments)}},{key:"setVertBorderPos",value:function(){return this._edit("setVertBorderPos",arguments)}},{key:"setHoriBorderPos",value:function(){return this._edit("setHoriBorderPos",arguments)}},{key:"backspace",value:function(){return this._edit("backspace",arguments)}},{key:"cutCellRange",value:function(){return this._edit("cutCellRange",arguments)}},{key:"readonly",get:function(){return this.parent.readonly}}]),e}(),Ue=function(){function e(t,r){s()(this,e),this.parent=t,this.selectData=r,this._helper=Ne.b,this._checker=Ne.a,this.preview=new Ne.c(t)}return u()(e,[{key:"_edit",value:function(e,t){if(!this.readonly){var r=this.parent,n=!1,i=r.getPresentation();try{"edit"===r.mockCore&&r.handleMockError("mock selection edit error");var a=this.parent._getEditor("Animation");if(a&&a[e]){var o=a[e].apply(a,t);return n=!0,o}}catch(e){var s={name:"edit_blocking",type:"edit",err:e.toString(),stack:e.stack};throw new Error(JSON.stringify(s))}finally{n||i.fire("error_core")}}}},{key:"insertAnimBatch",value:function(){return this._edit("insertAnimBatch",arguments)}},{key:"deleteAnimBatch",value:function(){return this._edit("deleteAnimBatch",arguments)}},{key:"replaceAnimBatch",value:function(){return this._edit("replaceAnimBatch",arguments)}},{key:"replaceOneAnimationNoTransact",value:function(){return this._edit("replaceOneAnimationNoTransact",arguments)}},{key:"moveAnimBatch",value:function(){return this._edit("moveAnimBatch",arguments)}},{key:"modifyAnimPropertiesBatch",value:function(){return this._edit("modifyAnimPropertiesBatch",arguments)}},{key:"previewAnimation",value:function(e,t){return this.preview.previewAnimation(e,t)}},{key:"addBehavior",value:function(){return this._edit("addBehavior",arguments)}},{key:"removeBehavior",value:function(){return this._edit("removeBehavior",arguments)}},{key:"moveBehavior",value:function(){return this._edit("moveBehavior",arguments)}},{key:"modifyBehavior",value:function(e,t){return this._edit("modifyBehavior",arguments)}},{key:"readonly",get:function(){return this.parent.readonly}},{key:"helper",get:function(){return this._helper}},{key:"checker",get:function(){return this._checker}}]),e}(),We=function(e){function t(e,r,n,i,a,o){return s()(this,t),v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n,i,a,o))}return _()(t,e),u()(t,[{key:"getTableSelection",value:function(){return this._tableSlt||(this._tableSlt=new Ge(this,this._data)),this._tableSlt}},{key:"getAnimSelection",value:function(){return this.anim_slt||(this.anim_slt=new Ue(this,this._data)),this.anim_slt}},{key:"getShapeSelection",value:function(){return this._getEditor("Shape")}},{key:"getSlideSelection",value:function(){return this._getEditor("Slide")}},{key:"getTextSelection",value:function(){return this._getEditor("Text")}},{key:"getChartSelection",value:function(){return this._getEditor("Chart")}},{key:"getPresentationSelection",value:function(){return this._getEditor("Presentation")}},{key:"getFormatBrushApplyer",value:function(){return this._getEditor("formatBrush")}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.canCopy()){var r=t&&t.clipboardId;return r||(r=this.presentation.copypasteMgr._createClipboardId()),t?t.bCopyImage=!0:t={bCopyImage:!0},this.presentation.copypasteMgr.copy({callback:e,userArgs:t,clipboardId:r})}}},{key:"cut",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.canCut()){var n=r&&r.clipboardId;return n||(n=this.presentation.copypasteMgr._createClipboardId()),r?r.bCopyImage=!0:r={bCopyImage:!0},this.presentation.copypasteMgr.cut({getWriteClipboardResult:e,callback:t,userArgs:r,clipboardId:n})}}},{key:"checkClipboardIdTag",value:function(e,t){return this.presentation.copypasteMgr.checkClipboardIdTag(e,t)}},{key:"paste",value:function(e,t){if(this.canPaste()){var r=e||{};r.localData=t,this.presentation.copypasteMgr.paste(r)}}},{key:"duplicate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._fireReadOnly()||this.presentation.copypasteMgr.duplicate(e&&e.extraDatas)}},{key:"getClipboardMimeTypes",value:function(e){var t=this.presentation.copypasteMgr;return e||(e={bCopyImage:!0}),null==e.bCopyImage&&(e.bCopyImage=!0),t&&t.getSelectRangeMimeTypes(this,e)}},{key:"saveFormat",value:function(e){this.canStashFormat()&&this.presentation.formatBrush.saveFormat(e)}},{key:"clearFormat",value:function(){this._fireReadOnly()||this.presentation.formatBrush.clearFormat()}},{key:"applyFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._fireReadOnly()){if(e&&!this.checkBrush())return!1;var r=this.getFormatBrush();r.applyFormat(t)}}}]),t}(Ne.g),ze=function(){function e(){s()(this,e)}return u()(e,null,[{key:"beginCommand",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=window.beginBatchCommand(t,r);return n.setOwner(e),n}},{key:"endCommand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;window.endBatchCommand(e)}},{key:"isCommandStarted",value:function(e){return window.isCommandStarted(e)}},{key:"setCommandAction",value:function(e){window.getTransaction().setActionName(e)}},{key:"setCommandUserData",value:function(e,t){window.getTransaction().setUserData(e,t)}},{key:"setCooperHandler",value:function(e,t){null!=e&&window.getTransaction().setCooperHandler(e)&&null!=t&&window.getTransaction().setUserData("cooperParams",t)}},{key:"setWaitCommands",value:function(e){window.getTransaction().setWaitCommands(e)}},{key:"createModifier",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return CoreUtils.createModifier(e,t)}},{key:"colorSchemeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return CoreUtils.ColorSchemeData(e,t)}},{key:"getFakeTransaction",value:function(e){return CoreUtils.getFakeTransaction(e)}}]),e}(),Ye=r(4863),qe=r.n(Ye),Ke=r(2684),Qe=r.n(Ke),Xe=function(){function e(t,r,n){s()(this,e),this.rpt=t,this.session=r,this.app=n,this.loadCore()}var t,r;return u()(e,[{key:"_initPPTcore",value:(r=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.core){e.next=6;break}if(window.WppCore){e.next=4;break}return e.next=4,this.app.asyncLoadTarget(Qe.a);case 4:this.core=new window.WppCore({app:this.app,workspace:this,container:this.app.container}),this.editShell=this.core.editShell;case 6:return e.abrupt("return",this.core);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadCore",value:function(){return this._asyncCore=this._asyncCore||this._initPPTcore(),this._asyncCore}},{key:"init",value:(t=a()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.presentation=t,e.next=3,this.loadCore();case 3:return e.sent.init(t),e.next=7,this.app.loadCustomGeometry();case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getDocument",value:function(){return this.presentation}},{key:"getSelectionsMgr",value:function(){return this.presentation&&this.presentation.getSelectionsMgr()}},{key:"getSelection",value:function(){var e=this.getSelectionsMgr();return e&&e.getLocalSelectionWrapper()}},{key:"update",value:function(e){}},{key:"onOthersSelectChange",value:function(e){if(e&&this.presentation)return this.presentation.getSelectionsMgr().applyServerSelections(e)}},{key:"onUserChange",value:function(e){this.presentation}}]),e}(),Je=r(432),Ze=function(){function e(t){s()(this,e),this.session=t}return u()(e,[{key:"setPresentation",value:function(e){this.presentation=e}},{key:"isReadOnly",value:function(){return this.session.getReadOnly()||!(!this.presentation||!this.presentation.isReadOnly())}},{key:"canEdit",value:function(){return!!this.session._permissions&&this.session._permissions.edit}},{key:"canCopy",value:function(){return!!this.session._permissions&&this.session._permissions.copy}},{key:"copyControl",value:function(){return this.session._permissions&&this.session._permissions.copyControl}},{key:"canDownload",value:function(){return!!this.session._permissions&&(this.session._permissions.download&&window.fileInfo.user_acl.download)}},{key:"canPrint",value:function(){return!!this.session._permissions&&this.session._permissions.print}},{key:"canSaveAs",value:function(){return!!this.session._permissions&&this.session._permissions.save_as}},{key:"canScreenShot",value:function(){return!!this.session._permissions&&this.session._permissions.screen_shot}},{key:"isAuth",value:function(){return!!this.session._permissions&&this.session._permissions.auth}},{key:"canOffline",value:function(){return!!this.session._permissions&&this.session._permissions.offline}},{key:"isPrivilege",value:function(){return!this.session._permissions||this.session._permissions.full}},{key:"canDelayCopy",value:function(){return this.presentation&&!this.presentation.isPreviewCache()}}]),e}(),$e=r(4864),et=r(2265),tt=r.n(et),rt=r(208),nt=r(664),it=function(){function e(){s()(this,e),this._handlePreviewLimit=function(e){e.detail},this._check()}return u()(e,[{key:"_check",value:function(){}},{key:"clearAll",value:function(){}},{key:"onPreviewLimit",value:function(e){}},{key:"setMode",value:function(e){}},{key:"getMode",value:function(){}},{key:"setPureMode",value:function(e){}},{key:"setActiveSlide",value:function(e){}},{key:"setZoom",value:function(e){}},{key:"play",value:function(){}},{key:"stepForward",value:function(){}},{key:"stepBackward",value:function(){}},{key:"getPlayInfo",value:function(){}},{key:"stepTo",value:function(e,t){}},{key:"getSlidePosition",value:function(){}},{key:"setFullScreenType",value:function(e){}},{key:"updateWatermark",value:function(){}},{key:"setShowPage",value:function(e){}},{key:"updateLaserPen",value:function(e){}},{key:"setAllInkVisible",value:function(e){}},{key:"setOpenMarkerEdit",value:function(e){}},{key:"setOpenMarkerInkEdit",value:function(e){}},{key:"getMediaPlayInfo",value:function(){}},{key:"setFullScreen",value:function(e){}},{key:"isBanSlideChange",value:function(e){}},{key:"setHideTool",value:function(e){}},{key:"setStopAutoPlay",value:function(e){}},{key:"setCoreReadonly",value:function(e){}},{key:"insertSlide",value:function(e,t){}},{key:"insertPicture",value:function(e){}},{key:"insertHyperLink",value:function(e){}},{key:"insertTextBox",value:function(e){}},{key:"getRemarkList",value:function(){}},{key:"getSlideRemark",value:function(e){}},{key:"getSlideWidth2HeightRatio",value:function(){}},{key:"getActiveSlideID",value:function(){}},{key:"getSlideBySlideID",value:function(e){e.SlideID}},{key:"setBgOpacity",value:function(e){}}]),e}(),at=window.Px2Emu,ot=function(){function e(t){s()(this,e),this.parent=t}return u()(e,[{key:"handleInsertTextBox",value:function(e){e.text?(window.APP.coreAPI.beginCommand(this),this.handleBasicTextInsert(Oe()({},e)),this.selection.clearShapeSelect(),window.APP.coreAPI.endCommand()):console.error("args.text must be inserted")}},{key:"handleInsertHyperLink",value:function(e){var t=e.x,r=e.y,n=e.width,i=e.height,a=e.isHorizontal,o=e.isScale,s=e.size,l=e.text,u=e.address,c=e.alignMode;if(l){var h=this.editor&&this.editor.link,d=this.selection;window.APP.coreAPI.beginCommand(this),this.handleBasicTextInsert({x:t,y:r,width:n,height:i,isHorizontal:a,isScale:o,size:s,text:l,alignMode:c});var p={action:7,linkTo:b.ActionLinkToType.URL,hyperlink:{address:u}};d.selectText(0,l.length),h.editor.chapter.setEnable(!0),h.modifyLink(p,l),h.editor.chapter.setEnable(!1),d.clearShapeSelect(),window.APP.coreAPI.endCommand()}else console.error("args.text must be inserted")}},{key:"handleBasicTextInsert",value:function(e){var t=e.x,r=e.y,n=e.isScale,i=e.text,a=e.isHorizontal,o=e.size,s=e.width,l=e.height,u=e.bold,c=e.color,h=e.italic,d=e.strikeThrough,p=e.alignMode,f=this.selection,v=this.getSlideLayout();n&&(t*=v.width,r*=v.height,s*=v.width,l*=v.height);var y={x:t,y:r};s&&Object.assign(y,{width:s}),l&&Object.assign(y,{height:l});var g=a||void 0===a?"horizontal":"vertical",m=f.insertTextBox(g,this.rectPx2ShapeEmu(y,this.scale));if(m){if(f.selectShape(m.shape),f.selectText(0),f.insertText(i),o||u||h||d||c){o&&(o*=20);var _={fontSize:o,bold:u,italic:h,strikeThrough:d,color:c},S=this.createModifierByName("TextFont",{});Object.keys(_).forEach((function(e){var t=_[e];void 0!==t&&S.modify(e,t)})),f.modifyShapeProperties(S)}if(void 0!==p&&f.fmtPapx({alignMode:p}),s||l){var T=void 0;T="horizontal"===g?{width:3098800,height:368300}:{width:459740,height:2184400};var b=this.rectPx2ShapeEmu(y,this.scale);s||(b.width=T.width),l||(b.height=T.height);var k=this.createModifierByName("Transform2D",{});if(k.modify("rect",b),f.modifyShapeProperties(k),!s||!l){var C=this.createModifierByName("TextFrameProps",{});C.modify("autoFit",2),f.modifyShapeProperties(C)}}}}},{key:"getSlideLayout",value:function(e){if(this.slideView){var t=this.doc.getSvgClientRect(e);return{x:t.x,y:t.y,width:t.width,height:t.height}}return{x:0,y:0,width:0,height:0}}},{key:"rectPx2ShapeEmu",value:function(e,t){t*=window.ti2pxRatio;var r=e.x,n=e.y,i=e.left,a=e.top,o=e.width,s=e.height,l=e.rotate;return void 0!==a&&(a=at(a,t)),void 0!==i&&(i=at(i,t)),{left:i,top:a,x:at(r,t)||0,y:at(n,t)||0,width:at(o,t)||0,height:at(s,t)||0,rotate:l||0}}},{key:"createModifierByName",value:function(e,t){return window.APP.utils.createModifier(e,t)}},{key:"selection",get:function(){return this.parent.selection}},{key:"editor",get:function(){return this.parent.shell&&this.parent.shell.editor}},{key:"doc",get:function(){return this.parent.doc}},{key:"slideView",get:function(){return this.doc.getActiveSlide()}},{key:"scale",get:function(){return this.doc.getZoom()}}]),e}(),st=r(4892),lt=r.n(st),ut=r(2721),ct=r(4896),ht=r(4897),dt=function(e){function t(e){s()(this,t);var r=v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._handlePreviewLimit=function(e){var t=e.detail;r.previewLimitCbs.forEach((function(e){"function"==typeof e&&e(t)}))},r.getSlideRemark=function(e){e=isNaN(e)?r.doc.getActiveSlideIdx():e-1;var t=r.doc.getSlideAt(e),n=t&&t.getNotesPage(),i=n&&n.getNotesText(),a=[];return(i=i?i.replace(/[\r\n]$/,""):i)&&a.push({slideIndex:e+1,noteText:i}),a.length>0?a:null},r.app=e,r.previewLimitCbs=[],r.selectionShell=new lt.a(e),r.apiHelper=new ot(r),r}var r;return _()(t,e),u()(t,[{key:"clearAll",value:function(){window.removeEventListener(nt.OPENAPI_EVENT.ON_PREVIEW_LIMIT,this._handlePreviewLimit),this.previewLimitCbs=[],this.hasInit=!1}},{key:"onPreviewLimit",value:function(e){this.previewLimitCbs.length||this.hasInit||(window.addEventListener(nt.OPENAPI_EVENT.ON_PREVIEW_LIMIT,this._handlePreviewLimit),this.hasInit=!0),"function"==typeof e&&this.previewLimitCbs.push(e)}},{key:"getMode",value:function(){return this.doc&&this.doc.getMode()}},{key:"setPureMode",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_MODE,{mode:e})}},{key:"setZoom",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_ZOOM,{zoom:e})}},{key:"play",value:function(){var e;this.mode===t.ViewModes.PlayView&&(this.doc&&this.doc.play&&(e=this.doc).play.apply(e,arguments))}},{key:"stepForward",value:function(){if(this.mode===t.ViewModes.PlayView)return this.doc&&this.doc.stepForward()}},{key:"stepBackward",value:function(){if(this.mode===t.ViewModes.PlayView)return this.doc&&this.doc.stepBackward()}},{key:"getPlayInfo",value:function(){if(this.mode===t.ViewModes.PlayView)return this.doc&&this.doc.getPlayInfo()}},{key:"syncByPlayInfo",value:function(){var e;return this.doc&&(e=this.doc).syncByPlayInfo.apply(e,arguments)}},{key:"stepTo",value:function(){var e;if(this.mode===t.ViewModes.PlayView)return this.doc&&(e=this.doc).stepTo.apply(e,arguments)}},{key:"dispatchEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=document.createEvent("CustomEvent");i.initCustomEvent(e,r,n,t),window.dispatchEvent(i)}},{key:"getSlidePosition",value:function(){return this.doc.getSvgClientRect()}},{key:"replaceActiveSlide",value:function(e,t){var r=this;return Object(ut.getTimeoutPromise)((function(n,i){if(e){r.selection.applyDocumentBeautify("slides",{uploadId:e,fileKey:t});r.presentation.once(r.presentation.constructor.EventTypes.MODIFY_DOCUMENT_BEAUTIFY,(function(e){-1===e.err?i({type:"error"}):n({type:"success"})}))}else i({type:"error"})}),1e4,{type:"error"})}},{key:"setFullScreenType",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_PLAY_FULLSCREEN_TYPE,e)}},{key:"updateWatermark",value:function(){this.dispatchEvent(nt.OPENAPI_EVENT.SLIDE_UPDATE_WATERMARK)}},{key:"updateLaserPen",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.UPDATE_LASERPEN,e)}},{key:"setAllInkVisible",value:function(e){this.shell.editor.ink.setAllInkHidden(!e)}},{key:"getMediaPlayInfo",value:function(){var e=this;return Object(ut.getTimeoutPromise)((function(t,r){e.dispatchEvent(nt.OPENAPI_EVENT.ON_GET_MEDIA_PLAY_MSG,(function(r){var n=e.doc.getPlayInfo();n.mediaPlayInfo=r,t(n)}))}))}},{key:"isBanSlideChange",value:function(e){window._ban_slide_change=!1!==e}},{key:"setCoreReadonly",value:function(e){this.app.setCoreReadonly(e)}},{key:"insertSlide",value:function(e,r,n,i){if(this.mode===t.ViewModes.EditView){if(n)return this.shell.editor.container.insertSlideByUrl({url:n,slideIdx:i,pos:e-1});var a=void 0;void 0===r&&(a=!0),this.dispatchEvent(nt.OPENAPI_EVENT.INSERT_SLIDE,{index:e-1,layoutType:r,noPh:a})}}},{key:"insertTextBox",value:function(e){console.log("*********openapi insertTextBox*********args: ",e),this.mode===t.ViewModes.EditView&&this.apiHelper.handleInsertTextBox(e)}},{key:"insertPicture",value:function(e){console.log("*********openapi insertPicture*********args:",e),this.mode!==t.ViewModes.EditView&&this.mode!==t.ViewModes.MasterView||this.doc.fire(nt.OPENAPI_EVENT.INSERT_IMAGE,e)}},{key:"insertHyperLink",value:function(e){console.log("*********openapi insertHyperLink*********args: ",e),this.mode===t.ViewModes.EditView&&this.apiHelper.handleInsertHyperLink(e)}},{key:"resetReaderInfo",value:function(e){this.app.resetReaderInfo(e)}},{key:"exitVideoFullscreen",value:function(){this.doc.fire(nt.OPENAPI_EVENT.EXIT_VIDEO_FULLSCREEN)}},{key:"getRemarkList",value:function(){for(var e=this.doc.getSlideCount(),t=[],r=0;r<e;r++){var n=this.doc.getSlideAt(r),i=n&&n.getNotesPage(),a=i&&i.getNotesText();(a=a?a.replace(/[\r\n]$/,""):a)&&t.push({slideIndex:r+1,noteText:a})}return t.length>0?t:null}},{key:"getSlideWidth2HeightRatio",value:function(){var e=this.doc.slidePxSize,t=e.width,r=e.height;return t&&r?Number((t/r).toFixed(2)):(console.log("*********openapi getSlideSize error*********"),-1)}},{key:"playTriggerAnim",value:function(){var e;return(e=this.doc).playTriggerAnim.apply(e,arguments)}},{key:"stepToTriggerSeq",value:function(){var e;return(e=this.doc).stepToTriggerSeq.apply(e,arguments)}},{key:"getActiveSlideID",value:function(){var e=this.selection.getActiveSlide();return e&&e.getId()}},{key:"getSlideBySlideID",value:function(e){var t=e.SlideID;return isNaN(t)?this.selection.getActiveSlide():this.doc.getSlideById(t)}},{key:"getSlideIndexBySlideId",value:function(e){var t=e.SlideID;return this.presentation.getSlideIdxById(t)}},{key:"getActiveShapeImg",value:function(e){return this.shell.editor.shape.getActiveShapeImg(e)}},{key:"setBgOpacity",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SET_BG_OPACITY,e)}},{key:"setUsersColor",value:function(e){this.doc.setUsersColor(e)}},{key:"stopAdvancePlay",value:function(){this.doc.fire(nt.OPENAPI_EVENT.SET_STOP_ADVANCE_PLAY)}},{key:"resumeAdvancePlay",value:function(){this.doc.fire(nt.OPENAPI_EVENT.SET_RESUME_ADVANCE_PLAY)}},{key:"ReplacePictureByInfos",value:(r=a()(regeneratorRuntime.mark((function e(t){var r,n,i,a,o,s,l,u,c,h,d,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n={},i=0;case 3:if(!(i<t.length)){e.next=26;break}if(a=t[i],o=a.slideId,s=a.shapeId,l=a.url,u=a.replaceType,c=i+"-"+o+"-"+s,!this.app.isReadOnly()){e.next=9;break}return n[c]={errCode:1,error:"readOnly",result:!1},e.abrupt("continue",23);case 9:if(o&&s&&l){e.next=12;break}return n[c]={errCode:1,error:"InvalidArgument",result:!1},e.abrupt("continue",23);case 12:if(h=Date.now(),d=this.presentation.getSlideById(o),p=d&&d.getShapeById(s)){e.next=18;break}return n[c]={errCode:1,error:"InvalidArgument",result:!1},e.abrupt("continue",23);case 18:if(ct.isValidReplacePic(p)){e.next=21;break}return n[c]={errCode:1,error:"Invalid Shape",result:!1},e.abrupt("continue",23);case 21:f=ct.ReplacePicture(p,l,u,n,c,h),r.push(f);case 23:i++,e.next=3;break;case 26:return e.next=28,Promise.all(r);case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setSlidesHidden",value:function(e,t){var r=this;return new Promise((function(n){r.app.isReadOnly()&&n({result:!1,errMsg:"readOnly"}),e&&0!==e.length||n({result:!1,errMsg:"InvalidArgument"});var i=e.map((function(e){return r.presentation.getSlideById(e)})).filter(Boolean);0===i.length&&n({result:!1,errMsg:"InvalidArgument"}),n(ht.setSlidesHidden(i,t)?{result:!0}:{result:!1,errMsg:"slide hidden set fail"})}))}},{key:"HideSlideBySlideIds",value:function(e){return this.setSlidesHidden(e,1)}},{key:"UnHideSlideBySlideIds",value:function(e){return this.setSlidesHidden(e,0)}},{key:"shell",get:function(){return this.app&&this.app.shell}},{key:"doc",get:function(){return this.shell&&this.shell.doc}},{key:"selection",get:function(){return this.workspace&&this.workspace.getSelection()}},{key:"workspace",get:function(){return this.shell&&this.shell.app.workspace}},{key:"mode",get:function(){return this.getMode()}},{key:"presentation",get:function(){return this.workspace&&this.workspace.presentation}}]),t}(it);dt.ViewModes={EditView:"edit",PlayView:"play",PreView:"preview",MasterView:"masterView"};var pt=r(4898),ft=r.n(pt),vt=r(4291),yt=r.n(vt),gt=function(e){function t(e){s()(this,t);var r=v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._setOpenMarker=function(){window.removeEventListener(nt.OPENAPI_EVENT.OPEN_REVIEW_END,r._setOpenMarker),r.dispatchEvent(nt.OPENAPI_EVENT.OPEN_REVIEW_INK,{value:!0})},r.ink=new ft.a(e),r.comment=new yt.a(e),r}return _()(t,e),u()(t,[{key:"setActiveSlide",value:function(e){e=Math.min(e,this.doc.getSlideCount()-1),e=Math.max(e,0);var t=this._getPageInfo().mode;window.switchPageTo(t,e,!1,!0)}},{key:"setMode",value:function(e){var t=this._getPageInfo(),r=t.mode,n=t.curSlideIndex;Object.values(b.ViewModes).includes(e)&&e!==r&&window.switchPageTo(e,n,!1,!0)}},{key:"setOpenMarkerEdit",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.OPEN_INK_EDITOR,{btnName:"laserPen",open:e})}},{key:"setOpenMarkerInkEdit",value:function(e){this.mode===dt.ViewModes.PlayView?this.dispatchEvent(nt.OPENAPI_EVENT.OPEN_INK_EDITOR,{btnName:"marker",open:e}):(this.setOpenReview(e),e&&window.addEventListener(nt.OPENAPI_EVENT.OPEN_REVIEW_END,this._setOpenMarker))}},{key:"setOpenReview",value:function(e){this.dispatchEvent(e?nt.OPENAPI_EVENT.OPEN_REVIEW:nt.OPENAPI_EVENT.CLOSE_REVIEW)}},{key:"_getPageInfo",value:function(){return window.__WPSENV__.store.getState().wpp.mobile.pageInfo}},{key:"stopVideoPlay",value:function(){this.doc.fire(nt.OPENAPI_EVENT.STOP_VIDEO_PLAY)}},{key:"switchPageTo",value:function(e,t,r){var n=r.rememberPrev,i=r.ignorePrev,a=r.pageInfo;return window.switchPageTo(e,t,n,i,a)}},{key:"openRemarkSpeaker",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.OPEN_REMARK_SPEAKER,e)}},{key:"switchPlayFullScreen",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SWITCH_PLAY_FULLSCREEN,e)}}]),t}(dt),mt=r(4899),_t=r.n(mt),St=r(4900),Tt=r.n(St),bt=function(e){function t(e){s()(this,t);var r=v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.ink=new _t.a(e),r.beautify=new Tt.a(e),r.comment=new yt.a(e),r}return _()(t,e),u()(t,[{key:"setMode",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_MODE,{mode:e})}},{key:"setActiveSlide",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_ACTIVE_SLIDE,{index:e})}},{key:"setOpenMarkerEdit",value:function(e){this.mode===dt.ViewModes.PlayView&&this.dispatchEvent(nt.OPENAPI_EVENT.OPEN_INK_EDITOR,{btnName:"laserPen",open:e})}},{key:"setOpenMarkerInkEdit",value:function(e){[dt.ViewModes.PlayView,dt.ViewModes.EditView].includes(this.mode)&&this.dispatchEvent(nt.OPENAPI_EVENT.OPEN_INK_EDITOR,{btnName:"marker",open:e})}},{key:"setFullScreen",value:function(e){e?this.dispatchEvent(nt.OPENAPI_EVENT.CLICK_LANCH_FULLSCREEN):this.dispatchEvent(nt.OPENAPI_EVENT.CLICK_EXIT_FULLSCREEN)}},{key:"setHideTool",value:function(e){var t=e.type,r=e.value;switch(t){case"pc_playing_menu":this.dispatchEvent(nt.OPENAPI_EVENT.SET_HIDE_PLAYING_MENU,r);break;case"pc_play_hover_link":this.dispatchEvent(nt.OPENAPI_EVENT.SET_HIDE_PLAY_HOVER_LINK,r);break;case"pc_image_hover_tip":this.dispatchEvent(nt.OPENAPI_EVENT.SET_HIDE_IMAGE_HOVER_TIP,r)}}},{key:"setStartAutoPlay",value:function(){this.doc.fire(nt.OPENAPI_EVENT.SET_START_AUTO_PLAY)}},{key:"setStopAutoPlay",value:function(){this.doc.fire(nt.OPENAPI_EVENT.SET_STOP_AUTO_PLAY)}},{key:"setShowPage",value:function(e){this.dispatchEvent(nt.OPENAPI_EVENT.SET_SHOW_PAGE,e)}},{key:"replacePicture",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.REPLACE_PICTURE,e)}},{key:"setMiniThumbnailVisible",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SET_MINI_THUMBNAIL_VISIBLE,{visible:e})}},{key:"setPlayToolbarPosition",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SET_PLAY_TOOLBAR_POSITION,e)}},{key:"setPlayInkPosition",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SET_PLAY_INK_POSITION,e)}},{key:"showPlayToolbar",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.SHOW_PALY_TOOLBAR,e)}},{key:"setCountDown",value:function(){this.doc.fire(nt.OPENAPI_EVENT.SET_COUNT_DOWN)}},{key:"openRemarkSpeaker",value:function(){this.doc.fire(nt.OPENAPI_EVENT.OPEN_REMARK_SPEAKER)}},{key:"getDiagramContainer",value:function(){return"wpp-diagram-container-id"}},{key:"getDiagramInfo",value:function(){var e=this;return Object(ut.getTimeoutPromise)((function(t,r){var n=e.doc.getActiveSlideIdx(),i=(e.selection.getActiveShapes()||[])[0];if(i&&i.isDiagramSubShape()){var a=i.getRootDiagramId(),o={slideIdx:n,diagramId:a};e.presentation.session.execSimpleQuery("diagramBeautifyInfo",o,(function(e){if(e.diagramInfo){var n=JSON.parse(e.diagramInfo),i=n.category,o=n.tdx,s=Object(ut.getDiagramItemsCnt)(n);t({diagramInfo:n,cnt:s,cat:i,tdx:o,diagramId:a})}else r(new Error("get diagram info error"))}))}else r(new Error("get diagram info error"))}),1e4,new Error("get diagram info error: timeout"))}},{key:"getDiagramPPTInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.beautify.getDiagramPPTInfo(e)}},{key:"beautifyDiagram",value:function(e){this.doc.fire(nt.OPENAPI_EVENT.BEAUTIFY_DIAGRAM_PPT,e)}},{key:"insertDiagram",value:function(e,t){var r=this;this.insertDiagramId=this.insertDiagramId||1;var n=this.insertDiagramId++;return Object(ut.getTimeoutPromise)((function(i,a){r.doc.on(nt.OPENAPI_EVENT.INSERT_DIAGRAM_FINISH,(function e(t){var o=t.res;t.id===n&&(r.doc.off(nt.OPENAPI_EVENT.INSERT_DIAGRAM_FINISH,e),o?i(o):a(new Error("insert diagram fail")))})),r.doc.fire(nt.OPENAPI_EVENT.INSERT_DIAGRAM,{url:e,fileKey:t,id:n})}),8e3,new Error("insert diagram fail: timeout"))}}]),t}(dt),kt=rt.userAgent.isMobile?gt:bt,Ct=r(3121),wt=r.n(Ct),Pt=r(1717),xt=r(998),Ot=r.n(xt);window.wppTools=Pe,tt()((function(e){})),window.ShapeUtil=He,window.DataFace=n,window.validateGetField=Ve.f,window.validateSetField=Ve.g,window.wppCache=window.wppCache||new Pt.a;var Et=function(){function e(t,r){var n,i=this;s()(this,e),this.onOpen=(n=a()(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("server_version",t._version),window.tester.record(window.tester.actions.init_core_start),r=i.svrDataHandler.onOpen(t),window.tester.record(window.tester.actions.init_core_end),e.next=6,i.workspace.init(r);case 6:window.tester.record("PPTCore.complete"),r.on("modify_commit",(function(){i._doc_saveing=!0,Re.default.dispatchEvent(Re.default.names.cooper.ON_DOCUMENT_SAVEING)})),Object(Ne.o)(),Object(Ne.n)(),i.loadRecoverHandler();case 11:case"end":return e.stop()}}),e,i)}))),function(e){return n.apply(this,arguments)}),this.dispatch=t,this.container=r,this.session=new Be(this),this.dbgCheck=!!Object(Je.default)("developer"),this.coreAPI=ze,window.APP=this,window.session=this.session,this.authority_mgr=new Ze(this.session),this.rpt=window.g_rpt,this.workspace=new Xe(this.rpt,this.session,this),this.openAPI=new kt(this),this.svrDataHandler=new Ne.h(this),this.shellFactory=$e.ShellFactory,this.isSSR=window.__WPSENV__.is_SSR,this.pluginMgr=new Ot.a}var t;return u()(e,[{key:"asyncLoadTarget",value:function(e){return new Promise((function(t,r){try{e((function(e){t(e)}))}catch(e){r(e)}}))}},{key:"loadCustomGeometry",value:(t=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.CustomGeometry){e.next=3;break}return e.next=3,this.asyncLoadTarget(tt.a);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"loadRecoverHandler",value:function(){var e=this;wt()((function(t){if(t.RecoverHandler){var r=e.presentation,n=new t.RecoverHandler(r.session);r.installRecoverHandler(n)}}))}},{key:"openFile",value:function(e,t,r,n){var i=this;return this.fileId=e,new Promise((function(a,o){i.session.openFile(e,(function(e){a(!0)}),t,r,n),Object(Ne.n)()}))}},{key:"util",value:function(){var e=this,t=this;return this.utils=this.presentation.utils,this._util||(this._util={clipboard:function(){},commandParser:function(){return new Promise((function(e){qe()((function(t){return e(t)}))}))},utils:function(){return t.utils},getActiveColors:function(t){return e.wppColorManager.getActiveColors(t)},getAlreadyColors:function(t){return e.wppColorManager.getAlreadyColors(t)}}),this._util}},{key:"canUndo",value:function(){return!!this.session.isWholeIdle()&&this.rpt.canUndo()}},{key:"undo",value:function(){var e=window.getTransaction();e.isInTransaction()&&e.forceCommit();var t=this.rpt;if(t.canUndoLocal()){var r=t.getCurTransactIndex();if(r<t.transacts.length&&r>=0){var n=t.transacts[r];if(n&&n._cmdSended)return void(this.session.sendUndo()&&t.undo())}var i=t.undo();null!=i&&i.isLocalTransact()&&this.session.popCommand()}else!t.canUndo()||this.session.hasCommands()||this.session.hasBlocking()||this.session.sendUndo()&&t.undo()}},{key:"canRedo",value:function(){return!!this.session.isWholeIdle()&&this.rpt.canRedo()}},{key:"redo",value:function(){var e=window.getTransaction();e.isInTransaction()&&e.forceCommit();var t=this.rpt;if(t.canRedoLocal()){var r=t.getCurTransactIndex();if(r<t.transacts.length&&r>=0){var n=t.transacts[r];if(n&&n._cmdSended)return void(this.session.sendRedo()&&t.redo())}var i=t.redo();if(null!=i&&i.isLocalTransact()){var a=i.getSrcCommand(),o=window.OpWrapperFactory.get(a);o&&o.apply()}}else!t.canRedo()||this.session.hasCommands()||this.session.hasBlocking()||this.session.sendRedo()&&t.redo()}},{key:"getAuthorityMgr",value:function(){return this.authority_mgr}},{key:"isReadOnly",value:function(){return this.authority_mgr.isReadOnly()}},{key:"canEdit",value:function(){return this.authority_mgr.canEdit()}},{key:"canCopy",value:function(){return this.authority_mgr.canCopy()}},{key:"copyControl",value:function(){return this.authority_mgr.copyControl()}},{key:"canDownload",value:function(){return this.authority_mgr.canDownload()}},{key:"canPrint",value:function(){return this.authority_mgr.canPrint()}},{key:"canSaveAs",value:function(){return this.authority_mgr.canSaveAs()}},{key:"canScreenShot",value:function(){return this.authority_mgr.canScreenShot()}},{key:"isAuth",value:function(){return this.authority_mgr.isAuth()}},{key:"canOffline",value:function(){return this.authority_mgr.canOffline()}},{key:"isPrivilege",value:function(){return this.authority_mgr.isPrivilege()}},{key:"canDelayCopy",value:function(){return this.authority_mgr.canDelayCopy()}},{key:"isSecurityDoc",value:function(){return this.session._permissions&&1===this.session._permissions.doctype}},{key:"isFileReadOnly",value:function(){return this.presentation.isReadOnly()}},{key:"canComment",value:function(){return!(this.isReadOnly()||window.fileInfo&&!window.fileInfo.user_acl.update||this.isFileReadOnly()||window.__WPSENV__.cache_preview)||this.supportReadOnlyComment()&&this.session._permissions&&this.session._permissions.comment}},{key:"isReadOnlyComment",value:function(){return!(!(this.isReadOnly()||window.fileInfo&&!window.fileInfo.user_acl.update)||!this.canComment())}},{key:"supportReadOnlyComment",value:function(){return!(!window.__CONFIG__.wpp.enableReadOnlyComment||window.__WPSENV__.cache_preview||this.isFileReadOnly())}},{key:"onCmdResponse",value:function(e){return this.svrDataHandler.onCmdResponse(e)}},{key:"addCmdResponseEndCallback",value:function(e){this._cbAfterCmdResp||(this._cbAfterCmdResp=[]),this._cbAfterCmdResp.push(e)}},{key:"onOthersSelectChange",value:function(e){this.workspace.onOthersSelectChange(e)}},{key:"onUserChange",value:function(e){this.workspace.onUserChange(e)}},{key:"setWatermark",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){if(this.watermark){var n=!0;if(Object.keys(e).forEach((function(r){t.watermark[r.toLocaleLowerCase()]!==e[r]&&(n=!1)})),n)return}this.watermark={},Object.keys(e).forEach((function(r){t.watermark[r.toLocaleLowerCase()]=e[r]}))}r&&this.openAPI.updateWatermark()}},{key:"getSecDocWatermark",value:function(){var e=this.presentation.getSecDocInfo();return e&&e.isSecDoc&&e.watermarkText?{type:1,value:e.watermarkText,fillstyle:"rgba(192, 192, 192, 0.6)",font:"bold 20px Serif",rotate:-45*Math.PI/180,horizontal:50,vertical:100}:null}},{key:"getWatermark",value:function(){return this.getSecDocWatermark()}},{key:"onUserBroadcast",value:function(e){if(!e.error){var t=JSON.parse(e.message);"drawingNotify"===t.messageName&&this.presentation&&this.presentation.drawingNotifyer.remoteDataUpdated(t)}}},{key:"onReconnect",value:function(e){var t=this,r=this;setTimeout((function(){t.syncSelections();var e=Re.default.cooper.cooperCenter.getCooperationUsers(),n=[];e.forEach((function(e){n=n.concat(e._connIds)}));var i=r.presentation;if(i){for(var a=i.getSelectionsMgr(),o=Object.keys(a.selections),s=0;s<o.length;s++){var l=o[s];n.indexOf(l)<0&&a.removeSelection(l)}r.session.queryVersion()}}),50)}},{key:"syncSelections",value:function(){var e=this.presentation.getSelectionsMgr(),t=e.getLocalSelection();t.fire(window.DataFace.Selection.EventTypes.SYNC_SELECTION),e.hasUnsentSelection()&&t.fire(window.DataFace.Selection.EventTypes.SEND_SELECTION,{bResend:!0})}},{key:"sendBroadcast",value:function(e){this.session.sendBroadcast(e)}},{key:"storeReaderInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.shell.doc.getActiveSlideIdx(),r=this.shell.doc.getMode(),n=Date.now(),i=this.shell.doc.isRemarkView,a=this.shell.doc.explainType,o=this.shell.doc.isAutoPlay,s=t,l=void 0,u=void 0;t&&t.isSlideIdxProxy&&(s=0,u=t.idx,l="slideMasters"===t.category),e=Object.assign({},{slideIndex:s,mode:r,timestamp:n,isRemarkView:i,isActiveMaster:l,masterViewActiveSlideIdx:u,explainType:a,isAutoPlay:o},e);var c="store-"+this.storeFileId;window.localStorage&&window.localStorage.setItem(c,JSON.stringify({timestamp:n,data:e})),this.setSSRCookie(e)}},{key:"restoreReaderInfo",value:function(){var e="store-"+this.storeFileId,t={};try{var r=JSON.parse(window.localStorage&&window.localStorage.getItem(e)).data,n=void 0;r.mode===rt.ViewModes.MasterView?(n=r.isActiveMaster?this.presentation.getMasters().getSlideCount():this.presentation.getLayouts().getSlideCount(),r.masterViewActiveSlideIdx>=n&&(r.masterViewActiveSlideIdx=n-1)):(n=this.shell.doc.getSlideCount(),r.slideIndex>=n&&(r.slideIndex=n-1)),t=r}catch(t){window.localStorage&&window.localStorage.setItem(e,null)}return t}},{key:"resetReaderInfo",value:function(e){try{var t=e||"store-"+this.storeFileId;window.localStorage&&window.localStorage.removeItem(t)}catch(e){}}},{key:"setSSRCookie",value:function(e){var t=e.slideIndex,r=e.mode,n=window.location.pathname;Object(Je.setCookie)("slideIndex",t,{path:n});var i=r===rt.ViewModes.EditView||r===rt.ViewModes.PreView;Object(Je.setCookie)("useSSR",i?1:0,{path:n,expires:15/86400})}},{key:"setCoreReadonly",value:function(e){this.coreReadonly=e}},{key:"handleFirRenderDone",value:function(){this.__firRenderEnd||(window.tester.record(window.tester.actions.render_end),window.__WPSENV__.reduxDispatch(Object(Ee.b)()),this.__firRenderEnd=!0,console.log("wpp __firRenderEnd onSlideChange",Date.now()))}},{key:"testIsIdle",value:function(){var e=window.backendImageManager,t=window.SlideRenderManager&&window.SlideRenderManager.getInstance();return!(!e||!t)&&(0===e.reqEnqueue.length&&e.isAllImageLoaded()&&t.isWait())}},{key:"shell",get:function(){return this.workspace.editShell}},{key:"awaitAppWorkspace",get:function(){var e=this;return this._loaderWp=this._loaderWp||this.asyncLoadTarget(Xe).then((function(t){return t.initRpt(window.g_rpt),e.rpt=window.g_rpt,e.workspace=new t.Workspace(e.rpt,e.session,e),t})),this._loaderWp}},{key:"isDoingCmdResponse",get:function(){return!!this.svrDataHandler.doingCmdResponse}},{key:"storeFileId",get:function(){return this.fileId||"fake-store-fileId"}},{key:"firRenderEnd",get:function(){return this.__firRenderEnd}}]),e}();window.tester.record(window.tester.actions.js_loaded)},470:function(e,t,r){"use strict";r.r(t),r.d(t,"SlideViewType",(function(){return o})),r.d(t,"PresetShapeType",(function(){return s})),r.d(t,"PresetShapeInfo",(function(){return l})),r.d(t,"shapeDefaultSize",(function(){return u})),r.d(t,"ShapeGroupType",(function(){return h})),r.d(t,"ShapeCreateFunctions",(function(){return d})),r.d(t,"ShapeGroupItems",(function(){return p})),r.d(t,"TextVerticalType",(function(){return m})),r.d(t,"TextAutoFitType",(function(){return _})),r.d(t,"LineType",(function(){return g})),r.d(t,"shapeTypeStr2Enum",(function(){return c}));var n,i=r(150),a=r.n(i),o={wpViewInvalid:0,wpViewSlide:1,wpViewSlideMaster:2,wpViewNotesPage:3,wpViewHandoutMaster:4,wpViewNotesMaster:5,wpViewOutline:6,wpViewSlideSorter:7,wpViewTitleMaster:8,wpViewNormal:9,wpViewPrintPreview:10,wpViewThumbnails:11,wpViewMasterThumbnails:12,wpViewNotesText:13};Object.freeze(o);var s={ShapeInvalid:-1,ShapeBegin:0,ShapeLine:0,ShapeLineInverse:1,ShapeTriangle:2,ShapeRightTriangle:3,ShapeRectangle:4,ShapeDiamond:5,ShapeParallelogram:6,ShapeTrapezoid:7,ShapeNonIsoscelesTrapezoid:8,ShapePentagon:9,ShapeHexagon:10,ShapeHeptagon:11,ShapeOctagon:12,ShapeDecagon:13,ShapeDodecagon:14,ShapeStar4:15,ShapeStar5:16,ShapeStar6:17,ShapeStar7:18,ShapeStar8:19,ShapeStar10:20,ShapeStar12:21,ShapeStar16:22,ShapeStar24:23,ShapeStar32:24,ShapeRoundRectangle:25,ShapeRound1Rectangle:26,ShapeRound2SameRectangle:27,ShapeRound2DiagonalRectangle:28,ShapeSnipRoundRectangle:29,ShapeSnip1Rectangle:30,ShapeSnip2SameRectangle:31,ShapeSnip2DiagonalRectangle:32,ShapePlaque:33,ShapeEllipse:34,ShapeTeardrop:35,ShapeHomePlate:36,ShapeChevron:37,ShapePieWedge:38,ShapePie:39,ShapeBlockArc:40,ShapeDonut:41,ShapeNoSmoking:42,ShapeRightArrow:43,ShapeLeftArrow:44,ShapeUpArrow:45,ShapeDownArrow:46,ShapeStripedRightArrow:47,ShapeNotchedRightArrow:48,ShapeBentUpArrow:49,ShapeLeftRightArrow:50,ShapeUpDownArrow:51,ShapeLeftUpArrow:52,ShapeLeftRightUpArrow:53,ShapeQuadArrow:54,ShapeLeftArrowCallout:55,ShapeRightArrowCallout:56,ShapeUpArrowCallout:57,ShapeDownArrowCallout:58,ShapeLeftRightArrowCallout:59,ShapeUpDownArrowCallout:60,ShapeQuadArrowCallout:61,ShapeBentArrow:62,ShapeUTurnArrow:63,ShapeCircularArrow:64,ShapeLeftCircularArrow:65,ShapeLeftRightCircularArrow:66,ShapeCurvedRightArrow:67,ShapeCurvedLeftArrow:68,ShapeCurvedUpArrow:69,ShapeCurvedDownArrow:70,ShapeSwooshArrow:71,ShapeCube:72,ShapeCan:73,ShapeLightningBolt:74,ShapeHeart:75,ShapeSun:76,ShapeMoon:77,ShapeSmileyFace:78,ShapeIrregularSeal1:79,ShapeIrregularSeal2:80,ShapeFoldedCorner:81,ShapeBevel:82,ShapeFrame:83,ShapeHalfFrame:84,ShapeCorner:85,ShapeDiagonalStripe:86,ShapeChord:87,ShapeArc:88,ShapeLeftBracket:89,ShapeRightBracket:90,ShapeLeftBrace:91,ShapeRightBrace:92,ShapeBracketPair:93,ShapeBracePair:94,ShapeStraightConnector1:95,ShapeBentConnector2:96,ShapeBentConnector3:97,ShapeBentConnector4:98,ShapeBentConnector5:99,ShapeCurvedConnector2:100,ShapeCurvedConnector3:101,ShapeCurvedConnector4:102,ShapeCurvedConnector5:103,ShapeCallout1:104,ShapeCallout2:105,ShapeCallout3:106,ShapeAccentCallout1:107,ShapeAccentCallout2:108,ShapeAccentCallout3:109,ShapeBorderCallout1:110,ShapeBorderCallout2:111,ShapeBorderCallout3:112,ShapeAccentBorderCallout1:113,ShapeAccentBorderCallout2:114,ShapeAccentBorderCallout3:115,ShapeWedgeRectangleCallout:116,ShapeWedgeRoundRectangleCallout:117,ShapeWedgeEllipseCallout:118,ShapeCloudCallout:119,ShapeCloud:120,ShapeRibbon:121,ShapeRibbon2:122,ShapeEllipseRibbon:123,ShapeEllipseRibbon2:124,ShapeLeftRightRibbon:125,ShapeVerticalScroll:126,ShapeHorizontalScroll:127,ShapeWave:128,ShapeDoubleWave:129,ShapePlus:130,ShapeFlowChartProcess:131,ShapeFlowChartDecision:132,ShapeFlowChartInputOutput:133,ShapeFlowChartPredefinedProcess:134,ShapeFlowChartInternalStorage:135,ShapeFlowChartDocument:136,ShapeFlowChartMultidocument:137,ShapeFlowChartTerminator:138,ShapeFlowChartPreparation:139,ShapeFlowChartManualInput:140,ShapeFlowChartManualOperation:141,ShapeFlowChartConnector:142,ShapeFlowChartPunchedCard:143,ShapeFlowChartPunchedTape:144,ShapeFlowChartSummingJunction:145,ShapeFlowChartOr:146,ShapeFlowChartCollate:147,ShapeFlowChartSort:148,ShapeFlowChartExtract:149,ShapeFlowChartMerge:150,ShapeFlowChartOfflineStorage:151,ShapeFlowChartOnlineStorage:152,ShapeFlowChartMagneticTape:153,ShapeFlowChartMagneticDisk:154,ShapeFlowChartMagneticDrum:155,ShapeFlowChartDisplay:156,ShapeFlowChartDelay:157,ShapeFlowChartAlternateProcess:158,ShapeFlowChartOffpageConnector:159,ShapeActionButtonBlank:160,ShapeActionButtonHome:161,ShapeActionButtonHelp:162,ShapeActionButtonInformation:163,ShapeActionButtonForwardNext:164,ShapeActionButtonBackPrevious:165,ShapeActionButtonEnd:166,ShapeActionButtonBeginning:167,ShapeActionButtonReturn:168,ShapeActionButtonDocument:169,ShapeActionButtonSound:170,ShapeActionButtonMovie:171,ShapeGear6:172,ShapeGear9:173,ShapeFunnel:174,ShapeMathPlus:175,ShapeMathMinus:176,ShapeMathMultiply:177,ShapeMathDivide:178,ShapeMathEqual:179,ShapeMathNotEqual:180,ShapeCornerTabs:181,ShapeSquareTabs:182,ShapePlaqueTabs:183,ShapeChartX:184,ShapeChartStar:185,ShapeChartPlus:186,ShapeTypeEnd:186,TextShapeBegin:187,TextArchDown:187,TextArchDownPour:188,TextArchUp:189,TextArchUpPour:190,TextButton:191,TextButtonPour:192,TextCanDown:193,TextCanUp:194,TextCascadeDown:195,TextCascadeUp:196,TextChevron:197,TextChevronInverted:198,TextCircle:199,TextCirclePour:200,TextCurveDown:201,TextCurveUp:202,TextDeflate:203,TextDeflateBottom:204,TextDeflateInflate:205,TextDeflateInflateDeflate:206,TextDeflateTop:207,TextDoubleWave1:208,TextFadeDown:209,TextFadeLeft:210,TextFadeRight:211,TextFadeUp:212,TextInflate:213,TextInflateBottom:214,TextInflateTop:215,TextPlain:216,TextRingInside:217,TextRingOutside:218,TextSlantDown:219,TextSlantUp:220,TextStop:221,TextTriangle:222,TextTriangleInverted:223,TextWave1:224,TextWave2:225,TextWave4:226,TextNoShape:227,TextShapeEnd:228,OutputConnection:229,OutputNone:230,ShapeCustom:231,KsoCustomBegin:232,ShapeInk:233,KsoCustomEnd:234,VmlShapeBegin:4096};Object.freeze(s);var l={0:{text:"line"},1:{text:"lineInv"},2:{text:"triangle",w:1672.65,h:1440.18},3:{text:"rtTriangle"},4:{text:"rect"},5:{text:"diamond"},6:{text:"parallelogram",w:1916.46,h:1440.18},7:{text:"trapezoid",w:1440.18,h:1916.46},8:{text:"nonIsoscelesTrapezoid"},9:{text:"pentagon",w:1513.89,h:1440.18},10:{text:"hexagon",w:1672.65,h:1440.18},11:{text:"heptagon"},12:{text:"octagon"},13:{text:"decagon"},14:{text:"dodecagon"},15:{text:"star4"},16:{text:"star5"},17:{text:"star6"},18:{text:"star7"},19:{text:"star8"},20:{text:"star10"},21:{text:"star12"},22:{text:"star16"},23:{text:"star24"},24:{text:"star32"},25:{text:"roundRect"},26:{text:"round1Rect"},27:{text:"round2SameRect"},28:{text:"round2DiagRect"},29:{text:"snipRoundRect"},30:{text:"snip1Rect"},31:{text:"snip2SameRect"},32:{text:"snip2DiagRect"},33:{text:"plaque"},34:{text:"ellipse"},35:{text:"teardrop"},36:{text:"homePlate",w:1542.24,h:765.45},37:{text:"chevron",w:765.45,h:765.45},38:{text:"pieWedge"},39:{text:"pie"},40:{text:"blockArc"},41:{text:"donut"},42:{text:"noSmoking"},43:{text:"rightArrow",w:1542.24,h:765.45},44:{text:"leftArrow",w:1542.24,h:765.45},45:{text:"upArrow",w:765.45,h:1542.24},46:{text:"downArrow",w:765.45,h:1542.24},47:{text:"stripedRightArrow",w:1542.24,h:765.45},48:{text:"notchedRightArrow",w:1542.24,h:765.45},49:{text:"bentUpArrow",w:1338.12,h:1151.01},50:{text:"leftRightArrow",w:1916.46,h:765.45},51:{text:"upDownArrow",w:765.45,h:1916.46},52:{text:"leftUpArrow",w:1338.12,h:1338.12},53:{text:"leftRightUpArrow",w:1916.46,h:1338.12},54:{text:"quadArrow",w:1916.46,h:1916.46},55:{text:"leftArrowCallout"},56:{text:"rightArrowCallout"},57:{text:"upArrowCallout"},58:{text:"downArrowCallout"},59:{text:"leftRightArrowCallout",w:1916.46,h:907.2},60:{text:"upDownArrowCallout"},61:{text:"quadArrowCallout",w:1916.46,h:1916.46},62:{text:"bentArrow",w:1281.42,h:1366.47},63:{text:"uturnArrow"},64:{text:"circularArrow",w:1542.24,h:1542.24},65:{text:"leftCircularArrow"},66:{text:"leftRightCircularArrow"},67:{text:"curvedRightArrow",w:1151.01,h:1916.46},68:{text:"curvedLeftArrow",w:1151.01,h:1916.46},69:{text:"curvedUpArrow",w:1916.46,h:1151.01},70:{text:"curvedDownArrow",w:1916.46,h:1151.01},71:{text:"swooshArrow"},72:{text:"cube",w:1916.46,h:1916.46},73:{text:"can",w:1440.18,h:1916.46},74:{text:"lightningBolt"},75:{text:"heart"},76:{text:"sun"},77:{text:"moon",w:720.09,h:1440.18},78:{text:"smileyFace"},79:{text:"irregularSeal1"},80:{text:"irregularSeal2"},81:{text:"foldedCorner"},82:{text:"bevel",w:1644.3,h:1644.3},83:{text:"frame"},84:{text:"halfFrame"},85:{text:"corner"},86:{text:"diagStripe"},87:{text:"chord"},88:{text:"arc"},89:{text:"leftBracket",w:113.4,h:1440.18},90:{text:"rightBracket",w:113.4,h:1440.18},91:{text:"leftBrace",w:243.81,h:1440.18},92:{text:"rightBrace",w:243.81,h:1440.18},93:{text:"bracketPair"},94:{text:"bracePair",w:1683.99,h:1440.18},95:{text:"straightConnector1"},96:{text:"bentConnector2"},97:{text:"bentConnector3"},98:{text:"bentConnector4"},99:{text:"bentConnector5"},100:{text:"curvedConnector2"},101:{text:"curvedConnector3"},102:{text:"curvedConnector4"},103:{text:"curvedConnector5"},104:{text:"callout1",w:1440.18,h:963.9},105:{text:"callout2",w:1440.18,h:963.9},106:{text:"callout3",w:1440.18,h:963.9},107:{text:"accentCallout1",w:1440.18,h:963.9},108:{text:"accentCallout2",w:1440.18,h:963.9},109:{text:"accentCallout3",w:1440.18,h:963.9},110:{text:"borderCallout1",w:1440.18,h:963.9},111:{text:"borderCallout2",w:1440.18,h:963.9},112:{text:"borderCallout3",w:1440.18,h:963.9},113:{text:"accentBorderCallout1",w:1440.18,h:963.9},114:{text:"accentBorderCallout2",w:1440.18,h:963.9},115:{text:"accentBorderCallout3",w:1440.18,h:963.9},116:{text:"wedgeRectCallout"},117:{text:"wedgeRoundRectCallout"},118:{text:"wedgeEllipseCallout",w:1440.18,h:963.9},119:{text:"cloudCallout",w:1440.18,h:963.9},120:{text:"cloud"},121:{text:"ribbon",w:1916.46,h:963.9},122:{text:"ribbon2",w:1916.46,h:963.9},123:{text:"ellipseRibbon",w:1916.46,h:1196.37},124:{text:"ellipseRibbon2",w:1916.46,h:1196.37},125:{text:"leftRightRibbon"},126:{text:"verticalScroll",w:1803.06,h:1627.29},127:{text:"horizontalScroll",w:1627.29,h:1803.06},128:{text:"wave"},129:{text:"doubleWave"},130:{text:"plus"},131:{text:"flowChartProcess",w:1440.18,h:963.9},132:{text:"flowChartDecision",w:1440.18,h:963.9},133:{text:"flowChartInputOutput",w:1440.18,h:963.9},134:{text:"flowChartPredefinedProcess",w:1440.18,h:963.9},135:{text:"flowChartInternalStorage",w:963.9,h:963.9},136:{text:"flowChartDocument",w:1440.18,h:963.9},137:{text:"flowChartMultidocument",w:1672.65,h:1196.37},138:{text:"flowChartTerminator",w:1440.18,h:476.28},139:{text:"flowChartPreparation",w:1672.65,h:963.9},140:{text:"flowChartManualInput",w:1440.18,h:720.09},141:{text:"flowChartManualOperation",w:1440.18,h:963.9},142:{text:"flowChartConnector",w:720.09,h:720.09},143:{text:"flowChartPunchedCard"},144:{text:"flowChartPunchedTape",w:1440.18,h:1270.08},145:{text:"flowChartSummingJunction",w:963.9,h:963.9},146:{text:"flowChartOr",w:963.9,h:963.9},147:{text:"flowChartCollate",w:720.09,h:1440.18},148:{text:"flowChartSort",w:720.09,h:1440.18},149:{text:"flowChartExtract",w:1082.97,h:1082.97},150:{text:"flowChartMerge",w:1082.97,h:1082.97},151:{text:"flowChartOfflineStorage"},152:{text:"flowChartOnlineStorage",w:1440.18,h:963.9},153:{text:"flowChartMagneticTape",w:963.9,h:963.9},154:{text:"flowChartMagneticDisk",w:1440.18,h:963.9},155:{text:"flowChartMagneticDrum",w:1440.18,h:1082.97},156:{text:"flowChartDisplay",w:1440.18,h:963.9},157:{text:"flowChartDelay",w:963.9,h:963.9},158:{text:"flowChartAlternateProcess",w:1440.18,h:963.9},159:{text:"flowChartOffpageConnector",w:963.9,h:963.9},160:{text:"actionButtonBlank",w:1644.3,h:1644.3},161:{text:"actionButtonHome",w:1644.3,h:1644.3},162:{text:"actionButtonHelp",w:1644.3,h:1644.3},163:{text:"actionButtonInformation",w:1644.3,h:1644.3},164:{text:"actionButtonForwardNext",w:1644.3,h:1644.3},165:{text:"actionButtonBackPrevious",w:1644.3,h:1644.3},166:{text:"actionButtonEnd",w:1644.3,h:1644.3},167:{text:"actionButtonBeginning",w:1644.3,h:1644.3},168:{text:"actionButtonReturn",w:1644.3,h:1644.3},169:{text:"actionButtonDocument",w:1644.3,h:1644.3},170:{text:"actionButtonSound",w:1644.3,h:1644.3},171:{text:"actionButtonMovie",w:1644.3,h:1644.3},172:{text:"gear6"},173:{text:"gear9"},174:{text:"funnel"},175:{text:"mathPlus"},176:{text:"mathMinus"},177:{text:"mathMultiply"},178:{text:"mathDivide"},179:{text:"mathEqual"},180:{text:"mathNotEqual"},181:{text:"cornerTabs"},182:{text:"squareTabs"},183:{text:"plaqueTabs"},184:{text:"chartX"},185:{text:"chartStar"},186:{text:"chartPlus"},187:{text:"textArchDown"},188:{text:"textArchDownPour"},189:{text:"textArchUp"},190:{text:"textArchUpPour"},191:{text:"textButton"},192:{text:"textButtonPour"},193:{text:"textCanDown"},194:{text:"textCanUp"},195:{text:"textCascadeDown"},196:{text:"textCascadeUp"},197:{text:"textChevron"},198:{text:"textChevronInverted"},199:{text:"textCircle"},200:{text:"textCirclePour"},201:{text:"textCurveDown"},202:{text:"textCurveUp"},203:{text:"textDeflate"},204:{text:"textDeflateBottom"},205:{text:"textDeflateInflate"},206:{text:"textDeflateInflateDeflate"},207:{text:"textDeflateTop"},208:{text:"textDoubleWave1"},209:{text:"textFadeDown"},210:{text:"textFadeLeft"},211:{text:"textFadeRight"},212:{text:"textFadeUp"},213:{text:"textInflate"},214:{text:"textInflateBottom"},215:{text:"textInflateTop"},216:{text:"textPlain"},217:{text:"textRingInside"},218:{text:"textRingOutside"},219:{text:"textSlantDown"},220:{text:"textSlantUp"},221:{text:"textStop"},222:{text:"textTriangle"},223:{text:"textTriangleInverted"},224:{text:"textWave1"},225:{text:"textWave2"},226:{text:"textWave4"},227:{text:"textNoShape"},231:{text:"shapeCustom"}};function u(e){var t={w:1440,h:1440};return l[e]&&(l[e].w&&(t.w=l[e].w),l[e].h&&(t.h=l[e].h)),t}function c(e){for(var t=Object.keys(l).length,r=0;r<t;++r){if(e===l[r].text)return r}return null}Object.freeze(l);var h={LineGroup:0,RectangleGroup:1,NormalGroup:2,ArrowGroup:3,FormulaGroup:4,ProcessGroup:5,StarAndFlagGroup:6,CalloutGroup:7,ActionGroup:8,GroupCount:9};Object.freeze(h);var d=["createLine","createConnectorArrow","createConnectorDoubleArrow","createCustomGeometryShape","createNormalShape","createTextBox","createHollowOutShape","createArcShape"];Object.freeze(d);var p=(n={},a()(n,h.LineGroup,{types:[0,95,95,97,97,97,101,101,101,231,231,231],funcIdx:[0,1,2,0,1,2,0,1,2,3,3,3],subTypes:[0,1,95,96,97,98,99,100,101,102,103,231],defaultFill:[0,1,95,96,97,98,99,100,101,102,103,231]}),a()(n,h.RectangleGroup,{types:[4,25,30,31,32,29,26,27,28],funcIdx:[4,4,4,4,4,4,4,4,4],subTypes:[4,25,26,27,28,29,30,31,32],defaultFill:[]}),a()(n,h.NormalGroup,{types:[4,4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],funcIdx:[5,5,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,6,6,4,6,4,4,4,4,4,6,6,6,4,4,4,4,4,4,4,7,7,7,7,7,7,7],subTypes:[4,34,2,3,6,7,5,9,10,11,12,13,14,39,87,35,83,84,85,86,130,33,73,72,82,41,42,40,81,78,75,74,76,77,120,88,93,94,89,90,91,92],defaultFill:[88,89,90,91,92,93,94]}),a()(n,h.ArrowGroup,{types:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],funcIdx:[4,4,4,4,4,4,4,4,6,6,4,4,6,6,6,6,4,4,4,4,4,4,4,4,4,4,6],subTypes:[43,44,45,46,50,51,54,53,62,63,52,49,67,68,69,70,47,48,36,37,56,55,57,58,59,61,64],defaultFill:[]}),a()(n,h.FormulaGroup,{types:[175,176,177,178,179,180],funcIdx:[4,4,4,4,6,6],subTypes:[175,176,177,178,179,180],defaultFill:[]}),a()(n,h.ProcessGroup,{types:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,6,4,4,4,4,4,4,4,4,4],subTypes:[131,158,132,133,134,135,136,137,138,139,140,141,142,159,143,144,145,146,147,148,149,150,152,157,153,154,155,156],defaultFill:[]}),a()(n,h.StarAndFlagGroup,{types:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[79,80,15,16,17,18,19,20,21,22,23,24,122,121,124,123,126,127,128,129],defaultFill:[]}),a()(n,h.CalloutGroup,{types:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[116,117,118,119,110,111,112,107,108,109,104,105,106,113,114,115],defaultFill:[]}),a()(n,h.ActionGroup,{types:[165,164,167,166,161,163,168,171,169,170,162,160],funcIdx:[4,4,4,4,4,4,4,4,4,4,4,4],subTypes:[165,164,167,166,161,163,168,171,169,170,162,160],defaultFill:[]}),n);Object.freeze(p);var f=[s.ShapeLine,s.ShapeLineInverse,s.ShapeStraightConnector1];Object.freeze(f);var v=[s.ShapeBentConnector2,s.ShapeBentConnector3,s.ShapeBentConnector4,s.ShapeBentConnector5];Object.freeze(v);var y=[s.ShapeCurvedConnector2,s.ShapeCurvedConnector3,s.ShapeCurvedConnector4,s.ShapeCurvedConnector5];Object.freeze(y);var g={StraightLine:f,BentLine:v,CurveLine:y};Object.freeze(g);var m={Horizontal:0,Vertical:1,Vertical270:2,WordArtVer:3,EastAsianVer:4,MongolianVer:5,VerticalWordArtRightToLeft:6,EastAsianRotation:7};Object.freeze(m);var _={NoAutoFit:0,NormalAutoFit:1,AdvancedAutoFit:2};Object.freeze(_)},4861:function(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","image");r.onload=function(){return window.__isSupportSVGImageLoad=!0},r.onerror=function(){return window.__isSupportSVGImageLoad=!1},r.setAttribute("width",1),r.setAttribute("height",1),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","data:image/png;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQwQ52sP+BiOh/AAA=")},4862:function(e,t,r){"use strict";function n(e,t,r){t in e||Object.defineProperty(e,t,{get:function(){return r},set:function(){console.warn("disallow reset propName: ",t)},enumerable:!1,configurable:!1})}function i(e){for(var t=this.indexOf(e);t>-1;)this.splice(t,1),t=this.indexOf(e)}function a(){return this[this.length-1]}function o(){return this[0]}function s(e){for(var t=0;t<this.length;t++){if(e(this[t]))return!0}return!1}function l(){for(var e=[],t=0;t<this.length;t++){var r=this[t];Array.isArray(r)?e=e.concat(r.flat()):e.push(r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.initPrototype=t.enhancePrototypeMethod=void 0,t.enhancePrototypeMethod=n;var u=!1;t.initPrototype=function(){if(!u){var e=Array.prototype;n(e,"remove",i),n(e,"last",a),n(e,"first",o),n(e,"some",s),n(e,"flat",l),u=!0}}},4863:function(e,t,r){e.exports=function(e,t){r.e(162).then(r.bind(null,6135)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},4864:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShellFactory=void 0;var n=r(4865),i=r(4866),a=r(4867),o=r(4868),s=r(4869),l=r(4870),u=r(4871),c=r(4872),h=r(4873),d=r(4874),p=r(4875),f=r(4876),v=r(4877),y=r(4881),g=r(4286),m=r(4287),_=r(4882),S=r(4885),T=r(4886),b=r(4887),k=r(4888),C=r(4889),w=r(4890),P=r(4891),x=function(){function e(e){this.shell=e}return e.prototype.create=function(e){return new this.shell(e)},e}(),O=function(){function e(){}return e.initRoot=function(){window.APP.apiShell?window.APP.apiShell.buildTree():window.APP.apiShell=new n.ApplicationShell(window.APP)},e.create=function(t,r){if(!r||!t)return null;e.bRegister||e.register();var n=e.creatorMap[r];if(n)return n.create(t);console.error("Can not create shell instance, constractName: ",r)},e.register=function(){e.bRegister||(e.creatorMap.application=new x(n.ApplicationShell),e.creatorMap.presentation=new x(i.PresentationShell),e.creatorMap.slideContainers=new x(o.SlideContainersShell),e.creatorMap.slideContainer=new x(a.SlideContainerShell),e.creatorMap.slideMasters=new x(l.SlideMastersShell),e.creatorMap.slideLayouts=new x(s.SlideLayoutsShell),e.creatorMap.notesMasters=new x(b.NotesMastersShell),e.creatorMap.handoutMasters=new x(k.HandoutMastersShell),e.creatorMap.slides=new x(u.SlidesShell),e.creatorMap.unknown=new x(C.UnknownSlidesShell),e.creatorMap.slideMaster=new x(d.MasterShell),e.creatorMap.slideLayout=new x(h.LayoutShell),e.creatorMap.slide=new x(c.SlideShell),e.creatorMap.notesPage=new x(p.NotespageShell),e.creatorMap.notesMaster=new x(f.NotesMasterShell),e.creatorMap.shapeTree=new x(v.ShapeTreeShell),e.creatorMap.shapes=new x(y.ShapesShell),e.creatorMap.groupShape=new x(g.GroupShapeShell),e.creatorMap.shape=new x(m.ShapeShell),e.creatorMap.background=new x(m.ShapeShell),e.creatorMap.textframe=new x(_.TextFrameShell),e.creatorMap.tableframe=new x(S.TableFrameShell),e.creatorMap.tableCells=new x(T.TableCellsShell),e.creatorMap.tableCell=new x(w.TableCellShell),e.creatorMap.textstream=new x(P.TextStreamShell),e.bRegister=!0)},e.creatorMap={},e.bRegister=!1,e}();t.ShellFactory=O},4865:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.buildTree(null),r}return(0,n.__extends)(t,e),t.prototype.ActivePresentation=function(){return this.private.presentation},t.prototype.buildTree=function(e){var t=this.coreData,r=t&&t.presentation;if(r){var n=window.APP.shellFactory.create(r,"presentation");if(!n)return;this.private.presentation=n,n.buildTree&&n.buildTree(this)}},t}(r(1016).IShell);t.ApplicationShell=i},4866:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PresentationShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"PageSetUp",{get:function(){return this.coreData.getPageSetup()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SlideMasters",{get:function(){var e=this.getSlideContainers();return e&&e.SlideMasters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SlideLayouts",{get:function(){var e=this.getSlideContainers();return e&&e.SlideLayouts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NotesMasters",{get:function(){var e=this.getSlideContainers();return e&&e.NotesMasters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Slides",{get:function(){var e=this.getSlideContainers();return e&&e.Slides},enumerable:!1,configurable:!0}),t.prototype.buildTree=function(e){var t=this.coreData,r=t&&t.private.childs;if(r){var n=window.APP.shellFactory.create({containers:r},"slideContainers");if(!n)return;this.private.slideContainers=n,this.parent=e,n.buildTree&&n.buildTree(this)}},t.prototype.getSlideContainers=function(){return this.private.slideContainers},t}(r(1016).IShell);t.PresentationShell=i},4867:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideContainerShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.buildTree=function(e){var t=this.coreData;if(t){var r=t.category,n=t.private.childs,i=window.APP.shellFactory.create(n,r);if(!i)return;this.private.slides=i,i.buildTree&&i.buildTree(this)}this.parent=e},t}(r(1016).IShell);t.SlideContainerShell=i},4868:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideContainersShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"SlideMasters",{get:function(){return this.private.slideMasterContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SlideLayouts",{get:function(){return this.private.slideLayoutContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NotesMasters",{get:function(){return this.private.notesMasterContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Slides",{get:function(){return this.private.slideContainer},enumerable:!1,configurable:!0}),t.prototype.buildTree=function(e){var t=this.coreData.containers;if(t){for(var r=0;r<t.length;++r){var n=t[r],i=n.category,a=window.APP.shellFactory.create(n,i);if(a){switch(i){case"slideMasters":this.private.slideMasterContainer=a;break;case"slideLayouts":this.private.slideLayoutContainer=a;break;case"notesMasters":this.private.notesMasterContainer=a;break;case"handoutMasters":this.private.handoutMasterContainer=a;break;case"slides":this.private.slideContainer=a;break;case"unknown":this.private.unknownContainer=a}a.buildTree&&a.buildTree(this)}}this.parent=e}},t}(r(1016).IShell);t.SlideContainersShell=i},4869:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideLayoutsShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="slideLayout",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.SlideLayoutsShell=i},4870:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideMastersShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="slideMaster",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.SlideMastersShell=i},4871:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlidesShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="slide",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.SlidesShell=i},4872:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"Master",{get:function(){var e=this.coreData.getMasterSlide();return e&&e.apiShell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"CustomLayout",{get:function(){var e=this.coreData.getFollowing();return e.isLayoutSlide?e.apiShell:null},enumerable:!1,configurable:!0}),t.prototype.GetFirstImgUrl=function(){return(0,n.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,n.__generator)(this,(function(t){return[2,new Promise((function(t){for(var r,n=e.Shapes,i=0;i<n.Count;++i){var a=n.Item(i);if(1===a.Type){r=a;break}if(i===n.Count-1){t({error:"there is no image in slide"});break}}r.GetShapeImage().then((function(e){t({url:e})})).catch((function(e){t({error:e,url:null})}))}))]}))}))},t.prototype.GetHiddenStatus=function(){return this.coreData.getHiddenStatus()},t}(r(2263).BaseSlideShell);t.SlideShell=i},4873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t}(r(2263).BaseSlideShell);t.LayoutShell=i},4874:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MasterShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"CustomLayouts",{get:function(){for(var e=[],t=this.parent.parent.SlideLayouts.private.childs,r=0;r<t.length;++r){var n=t[r];n.coreData.getMaster().getId()===this.SlideId&&e.push(n)}return e},enumerable:!1,configurable:!0}),t}(r(2263).BaseSlideShell);t.MasterShell=i},4875:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotespageShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t}(r(2263).BaseSlideShell);t.NotespageShell=i},4876:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotesMasterShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t}(r(2263).BaseSlideShell);t.NotesMasterShell=i},4877:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeTreeShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t}(r(4286).GroupShapeShell);t.ShapeTreeShell=i},4878:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Px2Ti=t.Ti2Px=void 0,t.Ti2Px=function(e,t){if(void 0===t&&(t=!1),isNaN(e))return null;var r=window.APP.shell.doc.getZoom();return t?Math.round(window.Ti2Px(e,window.ti2pxRatio*r)):window.Ti2Px(e,window.ti2pxRatio*r)},t.Px2Ti=function(e){return isNaN(e)?null:e/window.APP.shell.doc.getZoom()/window.ti2pxRatio}},4879:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FillFormat=t.ShapeFillType=void 0;var n=r(167),i=r(3159),a=r(4289);t.ShapeFillType={Gradient:"Gradient",NoFill:"NoFill",Pattern:"Pattern",PictureAndTexture:"PictureAndTexture",SlideBackground:"SlideBackground",Solid:"Solid"};var o=function(){function e(e){this.layer=e}return Object.defineProperty(e.prototype,"fill",{get:function(){return this.layer.getFill()||{}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"BackColor",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.layer.coreData,t=e.getSlide(),r=window.APP.utils.getColorDelegation("fill",e,t);if(!r)return console.error("Error: none colorScheme properties !!"),null;var n=window.APP.utils.interpretFill(this.fill,r);return n&&n.color?new i.ColorFormat(n.color,this,{supperProps:"BackColor"}):null},set:function(e){var t;if(this.Visible)if(e){var r=e.RGB,n=window.APP.coreAPI.createModifier("Fill");n.modify("color.rgb",r);var i=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var a=this.layer.coreData;i.applyShapeModifiers([n],[a])}console.log("Set Fill.ForegroundColor Succeeded")}else console.error("Invalid Color Value !!");else console.warn("Error: line is not visible !!")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;if(this.Type===t.ShapeFillType.Gradient)return null;var e=this.layer.coreData,r=e.getSlide(),n=window.APP.utils.getColorDelegation("fill",e,r);if(!n)return console.error("Error: none colorScheme properties !!"),null;var i=window.APP.utils.interpretFill(this.fill,n);if(!i||!i.color)return null;var a=i.color.alpha;if(null==a)return 1;var o=a,s=1-(null!=o?o:1);return Math.round(100*s)/100},set:function(e){var t;if(this.Visible)if(null==e||e<0||e>1)console.error("Invalid Opacity Value !!");else{var r=window.APP.coreAPI.createModifier("Fill");r.modify("opacity",1-e);var n=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var i=this.layer.coreData;n.applyShapeModifiers([r],[i])}console.log("Set Fill.Transparency Succeeded")}else console.warn("Error: line is not visible !!")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){switch(this.fill.type){case n.FillType.FillTypeNone:return t.ShapeFillType.NoFill;case n.FillType.FillTypeBackground:return t.ShapeFillType.SlideBackground;case n.FillType.FillTypeSolidColor:return t.ShapeFillType.Solid;case n.FillType.FillTypePattern:return t.ShapeFillType.Pattern;case n.FillType.FillTypeBlip:return t.ShapeFillType.PictureAndTexture;case n.FillType.FillTypeGradient:return t.ShapeFillType.Gradient;default:return console.error("Unsupport Fill Type !!"),null}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){if(null==this.fill)return a.WOErrorCode.WO_INVALID_COMMAND;var e=this.fill.type;return e&&0!==e},set:function(e){var t,r;if(e=!!e){var i=window.CoreTypes.Color.fromString("#E2E6ED").data;i.transOp=[{op:0,val:1}],r={color:i,type:n.FillType.FillTypeSolidColor}}else r={type:0};var a=window.APP.coreAPI.createModifier("Fill");a.modify("fill",r);var o=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var s=this.layer.coreData;o.applyShapeModifiers([a],[s])}console.log("Set Fill.Visible Succeeded")},enumerable:!1,configurable:!0}),e.prototype.Solid=function(e){return a.WOErrorCode.WO_NOTIMPL},e}();t.FillFormat=o},4880:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineFormat=void 0;var n=r(4289),i=r(167),a=r(158),o=r(3159),s="Dash",l="DashDot",u="LongDash",c="LongDashDot",h="LongDashDotDot",d="Solid",p="SystemDash",f="SystemDashDot",v="SystemDot",y="Single",g="ThickBetweenThin",m="ThickThin",_="ThinThick",S="ThinThin",T=function(){function e(e){this.layer=e}return Object.defineProperty(e.prototype,"outline",{get:function(){return this.layer.getOutline()||{}},enumerable:!1,configurable:!0}),e.prototype.getFill=function(){return this.outline.fill},Object.defineProperty(e.prototype,"BackColor",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.layer.coreData,t=e.getSlide(),r=window.APP.utils.getColorDelegation("line",e,t);if(!r)return console.error("Error: none colorScheme properties !!"),null;var n=window.APP.utils.interpretOutline(this.outline,r);if(!n||!n.fill||!n.fill.color)return null;var i=n.fill;return new o.ColorFormat(i.color,this,{supperProps:"BackColor"})},set:function(e){var t;if(e)if(this.Visible){var r=e.RGB,n=window.APP.coreAPI.createModifier("Outline");n.modify("color.rgb",r);var i=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var a=this.layer.coreData;i.applyShapeModifiers([n],[a])}console.log("Set Line.Color Succeeded")}else console.warn("Error: line is not visible !!");else console.error("Invalid Color Value !!")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"DashStyle",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.outline.dashType;if(null==e)return console.error("Error: none dashType properties !!"),null;var t=this.layer.coreData;if(t&&t.isHidden())return null;switch(e){case 0:return d;case 2:return s;case 3:return u;case 4:return l;case 5:return c;case 6:return h;case 7:return p;case 8:return v;case 9:return f;default:return console.error("Error: Unsupport Dash Style !!"),null}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Style",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.outline.compoundLine;if(null==e)return console.error("Error: none compoundLine properties !!"),null;var t=this.layer.coreData;if(t&&t.isHidden())return null;switch(e){case 0:return y;case 1:return S;case 2:return m;case 3:return _;case 4:return g;default:return console.error("Error: Unsupport Line Style !!"),null}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.layer.coreData,t=e.getSlide(),r=window.APP.utils.getColorDelegation("line",e,t);if(!r)return console.error("Error: none colorScheme properties !!"),null;var n=window.APP.utils.interpretOutline(this.outline,r);if(!n||!n.fill||!n.fill.color)return null;var i=n.fill.color.alpha;if(null==i)return console.error("Error: none transOp properties !!"),1;var a=i,o=1-(null!=a?a:1);return Math.round(100*o)/100},set:function(e){var t;if(null==e||"number"!=typeof e||e<0)console.error("Invalid Opacity Value !!");else if(this.Visible){var r=window.APP.coreAPI.createModifier("Outline");r.modify("opacity",1-e);var n=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var i=this.layer.coreData;n.applyShapeModifiers([r],[i])}console.log("Set Outline.Transparency Succeeded")}else console.warn("Error: line is not visible !!")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var e=this.outline.fill;return!!e&&e.type!==i.FillType.FillTypeNone},set:function(e){var t;if(this.Visible!==!!e){var r,n;if(e)r={lineType:a.LineType.SINGLE,width:12700},(n=window.CoreTypes.Color.fromString("#AEB5C0").data).transOp=[{op:0,val:1}],r.fill={type:i.FillType.FillTypeSolidColor,color:n};else r=Object.assign({},this.outline),(n=window.CoreTypes.Color.fromString(this.BackColor).data).transOp=[{op:0,val:1}],r.fill={type:i.FillType.FillTypeNone,color:n};var o=window.APP.coreAPI.createModifier("Outline");o.modify("outline",r);var s=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var l=this.layer.coreData;s.applyShapeModifiers([o],[l])}console.log("Set Outline.Visible Succeeded")}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Width",{get:function(){if(!this.Visible)return console.warn("Error: line is not visible !!"),null;var e=this.outline.width;return null==e?(console.error("Error: none width properties !!"),null):e/12700},set:function(e){var t;if(null==e||"number"!=typeof e||e<0)console.error("Invalid width Value !!");else if(this.Visible){var r=window.APP.coreAPI.createModifier("Outline");r.modify("width",{lineWidth:12700*e});var n=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var i=this.layer.coreData;n.applyShapeModifiers([r],[i])}console.log("Set Outline.Width Succeeded")}else console.warn("Error: line is not visible !!")},enumerable:!1,configurable:!0}),e.prototype.SetLineType=function(e){var t;if(!e||e===a.LineType.OTHER)return n.WOErrorCode.WO_INVALID_ARG;if(!this.Visible)return console.warn("Error: line is not visible !!"),n.WOErrorCode.WO_INVALID_COMMAND;var r=a.LineValueMap[e];if(!r)return n.WOErrorCode.WO_INVALID_ARG;var i=window.APP.coreAPI.createModifier("Outline");i.modify("lineType",r);var o=window.selection;if(null===(t=this.layer.coreData)||void 0===t?void 0:t.isShape){var s=this.layer.coreData;o.applyShapeModifiers([i],[s])}return console.log("Set LineType Succeeded"),n.WOErrorCode.WO_OK},e}();t.LineFormat=T},4881:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapesShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"Count",{get:function(){return this.private.childs.length},enumerable:!1,configurable:!0}),t.prototype.Item=function(e){return this.private.childs[e]},t.prototype.buildTree=function(e){var t=this.coreData.shapes;if(t){this.private.childs=[];for(var r=0;r<t.length;++r){var n=t[r],i=void 0;n.isGroupShape()?i=window.APP.shellFactory.create(n,"groupShape"):n.isShape&&(i=window.APP.shellFactory.create(n,"shape")),i&&(this.private.childs.push(i),i.buildTree&&i.buildTree(this))}this.parent=e}},t}(r(1016).IShell);t.ShapesShell=i},4882:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextFrameShell=void 0;var n=r(143),i=r(1016),a=r(4290),o=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"TextStream",{get:function(){return this.private.textStream},enumerable:!1,configurable:!0}),t.prototype.GetTextRange=function(e,t){var r={begin:e,end:t};return e===t&&(r.end=e+1),new a.TextRangeShell(this,r)},t.prototype.buildTree=function(e){var t=this.coreData,r=t&&t.private.textStream;if(r){var n=window.APP.shellFactory.create(r,"textstream");if(!n)return;this.private.textStream=n,n.buildTree&&n.buildTree(this),this.parent=e}},t}(i.IShell);t.TextFrameShell=o},4883:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeFontShell=void 0;var n=r(3159),i=r(4884),a=r(158),o=function(){function e(e){this.layer=e}return Object.defineProperty(e.prototype,"Bold",{get:function(){var e=this.getFontProps("chpProp","bold");return null!=e?1===e:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var e=this.getFontProps("chpProp","fontSize");if(null!=e)return e/20},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Italic",{get:function(){var e=this.getFontProps("chpProp","italic");return null!=e?1===e:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Underline",{get:function(){var e=this.getFontProps("chpProp","underlineType");return null!=e?1===e:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Strikeout",{get:function(){var e=this.getFontProps("chpProp","strikeThrough");return null!=e?1===e:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"FontSpacing",{get:function(){var e=this.getFontProps("chpProp","spacing");return null!=e?e/100:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){var e=this.layer,t=e&&e.GetSupLayer();if(!t)return null;for(var r=t;!r.IsShape||!r.IsShape();)r=r.parent;if(!r.IsShape||!r.IsShape())return console.error("Invalid data !"),null;var i=r.coreData,a=i.getSlide(),o=window.APP.utils.getColorDelegation("font",i,a);if(!o)return console.error("Error: none colorScheme properties !!"),null;var s=this.getFontProps("chpProp","textColor");if(null==s)return null;var l=window.APP.utils.interpretFill(s,o);return new n.ColorFormat(l.color,this,"Color").RGB},set:function(e){console.warn("Empty Implement!")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){var e=this.getFontProps("chpProp","language");if(!e)return null;var t=a.DefThemeLangInfo[e].type,r=this.getFontProps("chpProp",["fontNameAscii","fontNameComplex","fontNameAsiaEast"][t]);if(!r)return null;var n=this.getFontProps("chpProp","altLanguage"),o=this.layer.textframe.coreData.parent.getSlide();return(0,i.getFontBySymbol)(r,t,e,n,o)},enumerable:!1,configurable:!0}),e.prototype.getFontProps=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var r=this.layer,n=r&&r.GetSupLayer();if(!n)return null;var i=r.Begin,a=r.End;return n.coreData.visual.getCompleteTextPropsByRange(i,a-i,e,t)},e}();t.ShapeFontShell=o},4884:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontBySymbol=t.getTextFont=void 0;var n=r(158);function i(e){var t=e.getSize();return a(t=Math.round(t))}function a(e){return e=parseFloat(e),isNaN(e)?void 0:e}t.getTextFont=function(){var e,t=window.APP.shell.editor.chapter;return{Size:i(t),Name:t.getName(),Color:t.getColor(),Bold:t.getBold(),Italic:t.getItalic(),Underline:!!(null===(e=t.getUnderline())||void 0===e?void 0:e.underlineType),Strikeout:!!t.getStrikeThrough(),FontSpacing:a(t.getSpacing())}},t.getFontBySymbol=function(e,t,r,i,a){e||(2===t?e={themeScript:"drawing.eastAsian",themeIndex:"minor"}:0===t?e={themeScript:"drawing.latin",themeIndex:"minor"}:1===t&&(e={themeScript:"drawing.complexScript",themeIndex:"minor"}));var o=e.themeScript,s=e.name;if(!o)return e.name;o.includes("east")?t=2:o.includes("latin")?t=0:o.includes("complex")&&(t=1);var l=r,u=n.DefThemeLangInfo[l];if(!(u&&t===u.type||(l=i,(u=n.DefThemeLangInfo[l])&&t===u.type))){if(u="",s)return s;if(f=a&&a.visual.getThemeAgent()){var c=f.getFontScheme().getDefaultFont(e),h=c.latinFont,d=c.eastAsianFont,p=c.complexScriptFont;if(0===t)return h.name;if(1===t)return p.name;if(2===t)return d.name}return""}if(e&&u){var f,v=e.themeScript,y=e.name;if(e.script=u.script,v)if(-1!==v.indexOf("east")){if(0===u.type)e.themeScript="drawing.latin";else if(2!==u.type)return null}else if(-1!==v.indexOf("latin")&&0!==u.type)return null;if(y)return y;if(f=a&&a.visual.getThemeAgent())return f.getFontScheme().getFontAt(e)}return null}},4885:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableFrameShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"TableCells",{get:function(){return this.private.tableCells},enumerable:!1,configurable:!0}),t.prototype.buildTree=function(e){var t=this.coreData,r=t&&t.private.childs;if(r){var n=window.APP.shellFactory.create({tablecells:r},"tableCells");if(!n)return;this.private.tableCells=n,n.buildTree&&n.buildTree(this),this.parent=e}},t}(r(1016).IShell);t.TableFrameShell=i},4886:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellsShell=void 0;var n=r(143),i=r(2264),a=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.GetHyperlinks=function(){for(var e=new i.HyperlinksShell([]),t=this.private.childs,r=0;r<t.length;++r){var n=t[r].private.textFrame,a=null==n?void 0:n.private.textStream,o=null==a?void 0:a.GetHyperlinks();o&&e.concat(o)}return e},t.prototype.buildTree=function(e){var t=this.coreData.tablecells;if(t){this.private.childs=[];for(var r=0;r<t.length;++r){var n=t[r],i=window.APP.shellFactory.create(n,"tableCell");i&&(this.private.childs.push(i),i.buildTree&&i.buildTree(this))}this.parent=e}},t}(r(1016).IShell);t.TableCellsShell=a},4887:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotesMastersShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="notesMaster",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.NotesMastersShell=i},4888:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HandoutMastersShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="notesMaster",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.HandoutMastersShell=i},4889:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownSlidesShell=void 0;var n=r(143),i=function(e){function t(t){var r=e.call(this,t)||this;return r.tag="unknown",r}return(0,n.__extends)(t,e),t}(r(1908).CommonSlidesShell);t.UnknownSlidesShell=i},4890:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellShell=void 0;var n=r(143),i=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.buildTree=function(e){var t=this.coreData;if(t){for(var r=t.private.childs,n=0;n<r.length;++n){var i=r[n],a=void 0;i.isTextFrame&&(a=window.APP.shellFactory.create(i,"textframe"),this.private.textFrame=a),a&&(a.buildTree&&a.buildTree(this))}this.parent=e}},t}(r(1016).IShell);t.TableCellShell=i},4891:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextStreamShell=void 0;var n=r(143),i=r(4288),a=r(2264),o=function(e){function t(t){return e.call(this,t)||this}return(0,n.__extends)(t,e),t.prototype.IsTextStreamShell=function(){return!0},t.prototype.GetText=function(){return this.coreData.getAllText()},t.prototype.GetHyperlinks=function(){var e,t=this.coreData.parent;if(!t)return null;var r,n=[],o=t.visual.getCompleteTextProps();if(!o)return null;for(var s=0;s<o.length;++s)for(var l=o[s].chpProps,u=0;u<l.length;++u){var c=l[u],h=c.begin,d=c.end,p=c.props.actions;if(p){var f=null===(e=p.mouseClick)||void 0===e?void 0:e.hyperlink;null==r?r={begin:h,end:d,hyperlink:f}:r.end===h&&window.CoreUtils.deepCompare(r.hyperlink,f)?r.end=d:(n.push(new i.HyperlinkShell(r.hyperlink,this,r.begin,r.end)),r={begin:h,end:d,hyperlink:f})}}return r&&n.push(new i.HyperlinkShell(r.hyperlink,this,r.begin,r.end)),new a.HyperlinksShell(n)},t.prototype.buildTree=function(e){this.coreData&&(this.parent=e)},t}(r(1016).IShell);t.TextStreamShell=o},4892:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=r(158),a=r(4893),o=r(4290),s=(0,n.__importStar)(r(4894)),l=r(4895),u=r(2721),c=function(){function e(e){this.app=e}return Object.defineProperty(e.prototype,"presentation",{get:function(){var e;return null===(e=this.app)||void 0===e?void 0:e.presentation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){var e;return null===(e=this.presentation)||void 0===e?void 0:e.selection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shell",{get:function(){var e;return null===(e=this.app)||void 0===e?void 0:e.shell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){var e;return null===(e=this.shell)||void 0===e?void 0:e.doc},enumerable:!1,configurable:!0}),e.prototype.GetActiveSlide=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveSlide();return t&&t.apiShell},e.prototype.GetActiveShapes=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveShapes(),r=[];return t?(t.forEach((function(e){r.push(e.apiShell)})),r):r},e.prototype.GetActiveTableFrame=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveTableFrame();return t&&t.apiShell},e.prototype.GetActiveTableCells=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveTableCells(),r=[];return t?(t.forEach((function(e){r.push(e.apiShell)})),r):r},e.prototype.GetActiveTableRange=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getActiveTableRange()},e.prototype.GetActiveTextFrame=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveTextFrame();return t&&t.apiShell},e.prototype.GetActiveTextStream=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getActiveTextStream();return t&&t.apiShell},e.prototype.GetActiveAnimations=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getActiveAnimations()},e.prototype.GetTextStart=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getStart()},e.prototype.GetTextEnd=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getEnd()},e.prototype.GetTextRange=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.getRange(),r=this.GetActiveTextFrame();return t&&r?new o.TextRangeShell(r,t):null},e.prototype.GetShapeRange=function(){var e=this.GetActiveShapes();return e?new a.ShapeRangeShell(e):null},e.prototype.GetSlideRange=function(){var e=[],t=this.selection.getSlideMarker(),r=null==t?void 0:t.selected;if(r&&r.length>1)for(var n=t.selected,i=0;i<n.length;++i){var a,o=n[i],s=null==o?void 0:o.slideId;(a=this.presentation.getSlideById(s))&&e.push(a.apiShell)}else(a=this.GetActiveSlide())&&e.push(a);return new l.SlideRangeShell(e)},e.prototype.GetCategory=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.category()},e.prototype.GetLayerType=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.layerType()},e.prototype.GetText=function(){var e;return null===(e=this.selection)||void 0===e?void 0:e.getText()},e.prototype.GetSelectState=function(){var e,t=null===(e=this.selection)||void 0===e?void 0:e.state;return i.SelectType._strs[t]},e.prototype.ClearShapeSelect=function(){var e;null===(e=this.selection)||void 0===e||e.clearShapeSelect()},e.prototype.ZOrderPosition=function(e){var t;return null===(t=this.selection)||void 0===t?void 0:t.moveShape(e)},e.prototype.Rotate=function(e){return s.Rotate(this.selection,e)},e.prototype.MoveShapes=function(e,t){return s.moveShapes(this.selection,this.doc,e,t)},e.prototype.ResizeShapes=function(e,t){return s.resizeShapes(this.selection,this.doc,e,t)},e.prototype.ShapeRangeToImage=function(e,t){var r=this;return(0,u.getTimeoutPromise)((function(n,i){var a={},o=[],s=Array.from(new Set(t)),l=r.presentation.getSlideById(e);if(!l)return i(new Error("SlideId Not Exist"));for(var u=0;u<s.length;u++){var c=s[u];if(!l.findShapeById(c))return i(new Error("ShapeId Not Exist"));o.push({shapeId:c})}a.category="slides",a.shapes=o,a.slideId=e,a.type=4,r.presentation.session.execSimpleQuery("images",a,(function(e){var t=null==e?void 0:e.sha1;t?r.presentation.session.getImageUrlFromServer([t]).then((function(e){var r=e.urls[t];n(r)})).catch((function(){i(new Error("Get Shapes Image Failed"))})):i(new Error("Get Shapes Image Failed"))}))}),1e4,new Error("Get Shapes Image Timeout"))},e}();t.default=c},4893:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeRangeShell=void 0;var n=function(){function e(e){this.shapes=e}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.shapes.length},enumerable:!1,configurable:!0}),e.prototype.Item=function(e){return this.shapes?this.shapes[e]:null},e.prototype.Group=function(){},e.prototype.Ungroup=function(){},e}();t.ShapeRangeShell=n},4894:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeShapes=t.moveShapes=t.Rotate=void 0;var n=r(158);t.Rotate=function(e,t){var r;if(e&&Number.isInteger(t)&&1===(null===(r=e.getActiveShapes())||void 0===r?void 0:r.length)){(t%=360)<0&&(t+=360);var i,a={rotation:t},o=(i="Transform2D",window.APP.utils.createModifier(i));o.setFlag("rotateType",n.RotateType.Some),o.modify("transform",a),e.modifyShapeProperties(o)}else console.warn("rotate error")},t.moveShapes=function(e,t,r,n){var i=(null==t?void 0:t.getZoom())*window.ti2pxRatio,a=window.Px2Emu(r,i),o=window.Px2Emu(n,i);if(!isNaN(a)&&!isNaN(o)){var s={x:a,y:o,width:0,height:0};null==e||e.modifyShapeTransform2D({transform:s})}},t.resizeShapes=function(e,t,r,n){var i=(null==t?void 0:t.getZoom())*window.ti2pxRatio,a=window.Px2Emu(r,i),o=window.Px2Emu(n,i);if(!isNaN(a)&&!isNaN(o)){var s={x:0,y:0,width:a,height:o};null==e||e.modifyShapeTransform2D({transform:s})}}},4895:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlideRangeShell=void 0;var n=function(){function e(e){this.slides=[],this.slides=e}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.slides.length},enumerable:!1,configurable:!0}),e.prototype.Item=function(e){return this.slides[e]},e}();t.SlideRangeShell=n},4896:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplacePicture=t.isValidReplacePic=t.getUploadIdByUrl=t.Ti2Emu=t.handleUploadComplete=void 0;var n=r(143);t.handleUploadComplete=function(e,t,r,a){return(0,n.__awaiter)(void 0,void 0,Promise,(function(){return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,i(e,t,r,a)];case 1:return[2,n.sent()]}}))}))};var i=function(e,t,r,n){return new Promise((function(i){var o=new Image;o.src=e,o.onload=function(e){o.onload=null;var s=a(o,t,r,n);i(s)},o.onerror=function(){i({error:"load normal img failed",result:!1,errCode:1}),console.error("load normal img failed")}}))},a=function(e,t,r,n){void 0===n&&(n="fixed");var i,a=window.APP.coreAPI.createModifier("BlipFill"),u=[a],c=r.getRect(),h={x:c.left,y:c.top,width:c.right-c.left,height:c.bottom-c.top},d=window.APP.coreAPI.createModifier("Transform2D");if(d.modify("anchorRect",h),c={x:l(c.left),y:l(c.top),width:l(c.right-c.left),height:l(c.bottom-c.top)},"fixed"===n?c=o(e,c):"calc"===n&&(i=s(e,c)),i){u.push(d);var p=window.APP.coreAPI.createModifier("BlipFill");p.setName("Modify_Picture_Props"),p.modify("sourceRectangle",i),u.push(p)}a.setName("Modify_Picture"),a.modify("imageId",t),a.setFlag("rect",c),a.setFlag("isStretched",!1),a.setFlag("imageWidth",e.width),a.setFlag("imageHeight",e.height),a.setFlag("uploadId",t);var f=window.selection.applyShapeModifiers(u,[r]);return f&&f.err?{result:!1,error:f.err,errCode:1}:f?{result:!0}:{result:!1,errCode:1,error:"applyShapeModifiers error"}},o=function(e,t){var r,n,i=t.width,a=t.height,o=t.x,s=t.y,l=e.height/e.width;return a/i>l?(r=i,n=i*l):(n=a,r=a/l),{width:r,height:n,x:o+(i-r)/2,y:s+(a-n)/2}},s=function(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=e.width,s=e.height/o,l=a/i,u=new window.Rect(r,n,i,a),c=new window.Rect(r,n,i,a);if(l>s){var h=a,d=a/s;c.setSize({width:d,height:h}),c.translate(new window.Point(-(d-i)/2,0))}else{d=i,h=i*s;c.setSize({width:d,height:h}),c.translate(new window.Point(0,-(h-a)/2))}var p=(u.left()-c.left())/c.width(),f=(u.top()-c.top())/c.height(),v=(c.right()-u.right())/c.width();return{bottom:(c.bottom()-u.bottom())/c.height(),top:f,right:v,left:p}};function l(e){return 635*e}t.Ti2Emu=l;t.getUploadIdByUrl=function(e){var t=window.urlFileId,r=window.RPCClient.clientID,n="/api/v3/office/file/".concat(t,"/object/").concat("wpp","?connid=").concat(r),i=new FormData;return i.append("object_url",e),new Promise((function(e,t){window.__WPSENV__.request({method:"POST",url:n,body:i}).end().then((function(r){var n=JSON.parse(r.target.response);n&&"ok"===n.result?e(n.uploadid):t(r)})).catch((function(e){console.warn(e),t(e)}))}))};t.isValidReplacePic=function(e){var t=e.getShapeType();return!(1!==t&&13!==t&&!function(e){var t=e.getSlide(),r=!t.isMasterSlide&&!t.isLayoutSlide&&e.hasContent(),n=e.getPlaceHolder(),i=n&&([15,8].includes(n.type)||!n.type&&0!==n.type);return!r&&i}(e))};t.ReplacePicture=function(e,r,i,a,o,s){return new Promise((function(l){(0,t.getUploadIdByUrl)(r).then((function(u){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var c,h;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,t.handleUploadComplete)(r,u,e,i)];case 1:return c=n.sent(),h=(Date.now()-s)/1e3,c.spendTime=h,a[o]=c,l(a),[2]}}))}))})).catch((function(e){var t=e.body.result;a[o]="IllegalPicture"===a?{errCode:2,error:t,result:!1}:{errCode:1,error:t,result:!1},l(!1)}))}))}},4897:function(e,t,r){"use strict";function n(e,t){var r=window.APP.coreAPI.createModifier("Transition");r.modify("hidden",t);var n=e.map((function(e){return{slide:e,modifier:r}}));if(n&&n.length>0){var i=window.selection.transaction;i.beginBatchCommand();var a=window.selection.modifySlidePropertiesV2(n);return i.endBatchCommand(),a}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.unHideSlides=t.hideSlides=t.setSlidesHidden=void 0,t.setSlidesHidden=n,t.hideSlides=function(e){return n(e,1)},t.unHideSlides=function(e){return n(e,0)}},4898:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(664),i=function(){function e(e){this.app=e}return Object.defineProperty(e.prototype,"shell",{get:function(){var e;return null===(e=this.app)||void 0===e?void 0:e.shell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){var e;return null===(e=this.shell)||void 0===e?void 0:e.doc},enumerable:!1,configurable:!0}),e.prototype.setColor=function(e){this.doc.fire(n.OPENAPI_EVENT.SET_INK_COLOR,e)},e.prototype.setWidth=function(e){this.doc.fire(n.OPENAPI_EVENT.SET_INK_WIDTH,e)},e.prototype.changeInkType=function(e){this.doc.fire(n.OPENAPI_EVENT.CHANGE_INK_TYPE,e)},e.prototype.switchToEraser=function(){this.doc.fire(n.OPENAPI_EVENT.SWITCH_TO_ERASER)},e.prototype.deleteInk=function(e,t){var r,n,i;switch(e){case 0:null===(r=this.shell)||void 0===r||r.editor.ink.deleteInkByPosition(t);break;case 1:null===(n=this.shell)||void 0===n||n.editor.ink.deleteSlideInk();break;case 2:null===(i=this.shell)||void 0===i||i.editor.ink.deleteAllInk()}},e}();t.default=i},4899:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(664),i=function(){function e(e){this.app=e}return Object.defineProperty(e.prototype,"shell",{get:function(){var e;return null===(e=this.app)||void 0===e?void 0:e.shell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){var e;return null===(e=this.shell)||void 0===e?void 0:e.doc},enumerable:!1,configurable:!0}),e.prototype.setColor=function(e){this.doc.fire(n.OPENAPI_EVENT.SET_INK_COLOR,e)},e.prototype.setWidth=function(e){this.doc.fire(n.OPENAPI_EVENT.SET_INK_WIDTH,e)},e.prototype.changeInkType=function(e){this.doc.fire(n.OPENAPI_EVENT.CHANGE_INK_TYPE,e)},e.prototype.switchToEraser=function(){this.doc.fire(n.OPENAPI_EVENT.SWITCH_TO_ERASER)},e.prototype.deleteInk=function(e,t){var r,i,a;switch(e){case 0:null===(r=this.shell)||void 0===r||r.editor.ink.deleteInkByPosition(t);break;case 1:null===(i=this.shell)||void 0===i||i.editor.ink.deleteSlideInk();break;case 2:null===(a=this.shell)||void 0===a||a.editor.ink.deleteAllInk();break;default:return}this.doc.fire(n.OPENAPI_EVENT.UPDATE_UNDO_REDO)},e}();t.default=i},4900:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.app=e}return Object.defineProperty(e.prototype,"selection",{get:function(){return this.app.presentation.selection},enumerable:!1,configurable:!0}),e.prototype.getPPTInfo=function(){var e,t=window.urlFileId,r=window.RPCClient.clientID,n=null===(e=this.selection.getActiveSlide())||void 0===e?void 0:e.getId();return{connid:r,slide_ids:isNaN(n)?[]:[n],id:t,slideIndex:this.selection.getActiveSlideIdx()+1,slideCount:this.selection.getSlideCount(),model_type:"slides",file_type:"document"}},e.prototype.getDiagramPPTInfo=function(e){var t;void 0===e&&(e=1);var r=this.getPPTInfo(),n=r.connid,i=r.slide_ids,a=r.id,o=r.file_type,s="slides",l=[];if(2===e){s="shapes";var u=(this.selection.getActiveShapes()||[])[0];if(l=[],u&&u.isDiagramSubShape()){var c=u.getRootDiagramId(),h=null===(t=this.selection.getActiveSlide())||void 0===t?void 0:t.getDiagramGroup();h&&h[c]&&(l=h[c].map((function(e){return null==e?void 0:e.getId()})))}}return{id:a,connid:n,file_type:o,slide_ids:i,model_type:s,shape_ids:l}},e}();t.default=n},500:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={onInactive:0,onActive:1,onDepsReady:2,onPluginReady:3,onMount:4,onDestroy:0}},522:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return a}));var n={MediaDataTypeNone:-1,MediaDataTypeMovie:0,MediaDataTypeOnlineVideo:1,MediaDataTypeSound:2,MeidaDataTypeOle:3,MediaDataTypeBlip:4,MediaDataTypeGif:5,MediaDataTypeHyperlink:6},i={presMediaUnknown:0,presMediaCDAudio:1,presMediaAudio:2,presMediaWavAudio:3,presMediaVideo:4,presMediaAviVideo:5,presMediaWavAudioLink:6,presMediaEmbedded:256},a={MediaSubType_Unk:0,MediaSubType_Wave:1,MediaSubType_OtherAudio:2,MediaSubType_Avi:3,MediaSubType_OtherVideo:4}},537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base64=void 0;var n=u(r(0)),i=u(r(3)),a=u(r(753)),o=r(754),s=u(r(755)),l=r(756);function u(e){return e&&e.__esModule?e:{default:e}}var c=1,h=4,d=5,p=7168,f=8194,v=8195,y="edit",g="subscribe",m="https://"+("web.wps.cn"===location.hostname?"msgcenter.wps.cn":"msgcenter.kdocs.cn")+"/api/v1/connectors?protocol=wss";if("www.kdocs.cn"!==location.hostname&&"web.wps.cn"!==location.hostname){var _=window.__CONFIG__.pathPrefix.lastIndexOf("/"),S=window.__CONFIG__.pathPrefix.substr(0,_);m=S+"/ksopush-login-web/api/v1/connectors?protocol=wss"}function T(){}var b=t.base64=new function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(r){var n,i,a,o,s,l,u,c="",h=0;for(r=t(r);h<r.length;)o=(n=r.charCodeAt(h++))>>2,s=(3&n)<<4|(i=r.charCodeAt(h++))>>4,l=(15&i)<<2|(a=r.charCodeAt(h++))>>6,u=63&a,isNaN(i)?l=u=64:isNaN(a)&&(u=64),c=c+e.charAt(o)+e.charAt(s)+e.charAt(l)+e.charAt(u);return c},this.decode=function(t){var n,i,a,o,s,l,u="",c=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<t.length;)n=e.indexOf(t.charAt(c++))<<2|(o=e.indexOf(t.charAt(c++)))>>4,i=(15&o)<<4|(s=e.indexOf(t.charAt(c++)))>>2,a=(3&s)<<6|(l=e.indexOf(t.charAt(c++))),u+=String.fromCharCode(n),64!=s&&(u+=String.fromCharCode(i)),64!=l&&(u+=String.fromCharCode(a));return u=r(u)};var t=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},r=function(e){for(var t="",r=0,n=0,i=0,a=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(i=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&i),r+=2):(i=e.charCodeAt(r+1),a=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a),r+=3);return t}},k=function(e){var t=new DataView(e),r=t.getUint32(0,!0),n=(t.getUint16(4,!0),t.getUint16(6,!0)),i=t.getUint32(8,!0),a=t.getUint32(12,!0),o=t.getUint32(16,!0),s=[t.getUint32(20,!0),o];if(1266907392!=r)return{};for(var l=new Array(i),u=n;u<n+i;u++)l[u]=String.fromCharCode(t.getInt8(u));return{msgId:s,msgType:a,body:l.join("")}},C=function(e,t,r){var n=r.length,i=t,a=e,o=a[0],s=a[1],l=new ArrayBuffer(24+n),u=new DataView(l);u.setUint32(0,1266907392,!0),u.setUint16(4,1,!0),u.setUint16(6,24,!0),u.setUint32(8,n,!0),u.setUint32(12,i,!0),u.setUint32(16,s,!0),u.setUint32(20,o,!0);for(var c=0;c<r.length;c++)u.setInt8(24+c,r.charCodeAt(c));return u.buffer},w=0,P=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:w,i=window.fileInfo||window.__WPSENV__.file_info.file;if(i.user_acl.update){var o=window.__WPSENV__.store.getState().public.cooperation;if(!window.__WPSENV__.isOnlineMode&&o&&o.members&&o.members.length>n&&(0,l.report)(window.urlFileId,o.members.length,t),e&&window.__WPSENV__.conflictLock.getInfor().isLockMode)r();else{window.collection2("client_locked_edit_"+(e?"true":"false")),window.__WPSENV__.conflictLock=(0,a.default)(e,t,r);var s=!0;!window.__WPSENV__.isOnlineMode&&window.__CONFIG__.isEnableOnLineMode&&(s=!/(\?|\&)editlock($|\&|=1)/i.test(window.location.search)),window.__WPSENV__.conflictLock.tryLock(s)}}},x=function(){function e(t){var r=this;(0,n.default)(this,e),O.call(this),(0,l.getOnline)().then((function(e){var n=e.isOnline,i=e.threshold;n||r._init(t),w=i,window.__WPSENV__.isOnlineMode=n,window.__WPSENV__.isOnlinethreshold=i}))}return(0,i.default)(e,[{key:"_holdLock",value:function(e){var t=e.detail.holdLocked;this.holdLocked=t,this._lock()}},{key:"_triggerLock",value:function(){window.__WPSENV__.conflictLock.tryLock(!1)}},{key:"_procLogin",value:function(){var e=this;if(/(\?|\&)(version|mode=preview)/i.test(window.location.search))return!1;var t=new s.default.LoginServer(m);t.beginLogin().then((function(r){console.log("Allowed to login",r),e._open(t.getRetAddr(),t.getRetToken())})).catch((function(r){(429===r||r>500&&r<600||r===t.getUnpredictableCode())&&e._reProcLogin(r),console.log("Login not allowed",r)}))}},{key:"_reProcLogin",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;setTimeout((function(){e._stop||(console.log("try login",t),e._procLogin())}),3e3*Math.pow(2,this.failTimes++))}},{key:"_onLogined",value:function(e){var t=this,r={authToken:e,deviceid:"",appid:"web.wps.cn",clientType:"web",clientChannel:"WPS",clientVersion:"1.0"};this._call(c,r,(function(e){t._onAuthResponse(e)}))}},{key:"_open",value:function(e,t){var r=this;if(!this._stop){var n="ws://";"https:"===location.protocol&&(n="wss://");try{this._ws=new WebSocket(n+e)}catch(e){return this._reProcLogin(),void console.error(e)}this._ws.binaryType="arraybuffer",this._ws.onclose=function(){r._close(),r._reProcLogin()},this._ws.onerror=function(){r._close(),r._reProcLogin()},this._ws.onopen=function(){r._onLogined(t)},this._ws.onmessage=function(e){var t=k(e.data);switch(t.msgType){case f:break;case p:var n=t.msgId[0]+"-"+t.msgId[1],i=r._penddingCall[n];i&&(i(t.body),delete r._penddingCall[n]);break;case v:r._onDocTeamNotify(t)}}}}},{key:"_checkVersion",value:function(){var e="/api/v3/office/file/"+this._fileId+"/check_new_version";window.__WPSENV__.request({method:"POST",url:e,responseType:"json"}).end().catch((function(){console.error("check new version failed!")}))}},{key:"_lock",value:function(){var e=this;if(this._status===y)return clearTimeout(this._timeTicker),void(this._timeTicker=setTimeout((function(){e._leaveDocumentTeam()}),this._unLockTime));this._subStatusJoin(this._members)}},{key:"_updateMembers",value:function(e){var t=e.Members||e.operators||!1;if(t){var r=this._members;return this._members=t,this._subStatusJoin(t,!0),r}}},{key:"_onDocTeamNotify",value:function(e){e=JSON.parse(e.body);var t=b.decode(e.event_data),r=this._updateMembers(JSON.parse(t));switch(e.header.event_type){case"status_update":this._onUpdateStatusResp(t,r);break;case"status_leave":this._onLeaveResponse(t)}}},{key:"_onAuthResponse",value:function(e){"OK"===e?this._joinDocumentTeam(g):(this._close(),this._reProcLogin())}},{key:"_onJoinResponse",value:function(e){if(500===(e=JSON.parse(e)).code)return this._close(),void this._reProcLogin();if(this._updateMembers(e.data),this._lockStatus)if(this._status===g)this._subStatusJoin(e.data.Members);else if(409===e.code){var t=this._getOneOtherClientUser(e.data.Members);t&&P(!0,t.userid),this._joinDocumentTeam(g)}else{var r=window.__WPSENV__.file_info.user.id;""!=this._lastConflictUserid&&(r=this._lastConflictUserid,this._lastConflictUserid=""),P(!1,r)}}},{key:"_kickScheme",value:function(){var e=this;this.kickUser(),this._timeTicker=setTimeout((function(){e._leaveDocumentTeam()}),this._unLockTime)}},{key:"_subStatusJoin",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._canKick(e);if(n.result&&!r)this._joinDocumentTeam(y),this._timeTicker=setTimeout((function(){t._leaveDocumentTeam()}),this._unLockTime);else if(n.shoudldkick)P(!0,window.__WPSENV__.file_info.user.id,(function(){window.__WPSENV__.conflictLock.getInfor().isLockMode&&t._kickScheme(),console.log("window.__WPSENV__.conflictLock","fresh","lock")}));else{var i=this._getOneOtherClientUser(e);i&&P(!0,i.userid)}}},{key:"_onLeaveResponse",value:function(e){console.log(e)}},{key:"kickUser",value:function(){this._joinDocumentTeam(y)}},{key:"_onUpdateStatusResp",value:function(e,t){if(e=JSON.parse(e),this._status===g&&this._canWrite(e.Members)){this._isReadOnly()&&this._checkVersion();var r=this._getOneOtherClientUser(t);r&&P(!1,r.userid)}}},{key:"_isReadOnly",value:function(){return/(\?|\&)readonly/i.test(window.location.search)}},{key:"_leaveDocumentTeam",value:function(){var e=this;if(this.holdLocked)console.log("holding the editor lock");else{var t={fileId:this._fileId,status:y};this._lockStatus=!1,this._status=g,this._call(d,t,(function(t){t=JSON.parse(t);var r=b.decode(t.event_data);e._onLeaveResponse(r),window.collection2("web_locked_edit_false")}))}}},{key:"_joinDocumentTeam",value:function(e){var t=this,r={fileId:this._fileId,status:e};e===y&&(this._lockStatus=!0),this._status=e,this._call(h,r,(function(e){e=JSON.parse(e);var r=b.decode(e.event_data);t._onJoinResponse(r)}))}},{key:"_getOneOtherClientUser",value:function(e){if(e)for(var t=0;t<e.length;t++){var r=e[t];if("web"!==r.clientType)for(var n=0;n<r.status.length;n++)if(r.status[n]===y)return this._lastConflictUserid=r.userid,{userid:r.userid,jointime:r.jointime,clienttype:r.clientType}}}},{key:"_canKick",value:function(e){if(!e)return{result:!0};for(var t=!1,r=!0,n="",i=0;i<e.length;i++){var a=e[i];if(!window.__WPSENV__.file_info)return{result:!1,shoudldkick:!1};if("web"!==a.clientType)for(var o=0;o<a.status.length;o++)if(a.status[o]===y){r=!1,t=!0,n=a.clientType;break}}if(r)return{result:!0};if(t)for(var s=0;s<e.length;s++){var l=e[s];if(window.__WPSENV__.file_info.user.id!==l.userid&&"web"!==l.clientType)for(var u=0;u<l.status.length;u++)if(l.status[u]===y)return{result:!1,shoudldkick:!1}}return{result:!1,shoudldkick:!0,clienttype:n}}},{key:"_canWrite",value:function(e){for(var t=0;t<e.length;t++){var r=e[t];if("web"!==r.clientType)for(var n=0;n<r.status.length;n++)if(r.status[n]===y)return this._lastConflictUserid=r.userid,!1}return!0}},{key:"close",value:function(e){this._stop=!0,this._close(e)}},{key:"_close",value:function(e){if(this._ws){switch(this._lockStatus=!1,this._ws.readyState){case WebSocket.CONNECTING:case WebSocket.OPEN:e?this._ws.close(e):this._ws.close()}try{this._ws.onclose=T,this._ws.onopen=T,this._ws.onmessage=T,this._ws.onerror=T}catch(e){}this._ws=null,this._penddingCall={}}}},{key:"_send",value:function(e,t,r){if(!this._ws)return!1;if(this._ws.readyState!=WebSocket.OPEN)return!1;var n=JSON.stringify(r),i=C(e,t,n);return this._ws.send(i),!0}},{key:"_call",value:function(e,t,r){if(!this._ws)return!1;if(this._ws.readyState!=WebSocket.OPEN)return!1;try{var n=this._nextMsgId;this._nextMsgId++;var i=[0,n];if(this._send(i,e,t)){var a="0-"+n;return this._penddingCall[a]=r,!0}return!1}catch(e){return!1}}}]),e}(),O=function(){var e=this;this._init=function(t){e._unLockTime=6e5;var r=window.parseInt(localStorage.getItem("WEB_LOCK_TIMES"));!window.isNaN(r)&&r>0&&(e._unLockTime=1e3*r),e._nextMsgId=1,e._fileId=t,e._penddingCall={},e._lastConflictUserid="",e._stop=!1,e._status="",e._lockStatus=!1,e._timeTicker=null,e._members=null,e._procLogin(),e._lock=e._lock.bind(e),e._triggerLock=e._triggerLock.bind(e),e._holdLock=e._holdLock.bind(e),e.holdLocked=!1,window.addEventListener(o.EVENT.ON_DOCUMENT_SAVEING,e._lock),window.addEventListener(o.EVENT.ET_EVENT_ENTER_EDIT,e._triggerLock),window.addEventListener(o.EVENT.MO_ET_EDIT_MODE_BEGIN,e._triggerLock),window.addEventListener(o.EVENT.ON_DOCUMENT_SAVEING_HOLDING_LOCK,e._holdLock)},this.failTimes=0};t.default=x},543:function(e,t,r){"use strict";r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return o}));var n=r(263);r.d(t,"b",(function(){return n.AbsObject})),r.d(t,"a",(function(){return n.AbsCustomObject})),r.d(t,"c",(function(){return n.AbsTopCustomObject}));var i=r(624);function a(e){var t=new n.AbsObject;return t.private=e,t.__isNew=!0,t.__modify=!1,Object(i.d)(t),t}function o(e,t){if(e&&t){var r=e._onChangedCallbacks||[];r.indexOf(t)<0&&r.push(t),e._onChangedCallbacks=r,e.on((function(t){for(var r=e._onChangedCallbacks||[],n=0;n<r.length;n++)r[n](t)}))}}},563:function(e,t,r){"use strict";r.r(t),r.d(t,"VIEW_EVENT_TYPES",(function(){return n}));var n={MODIFY:"MODIFY",ERROR_READONLY:"error_readonly",THUMBNAIL_UPDATE:"thumbnail_update",DOC_INIT:"doc_init",MODE_CHANGE:"mode_change",THUMBNAIL_DOC_CHANGE:"thumbnail_doc_change",DOC_LAYOUTS_LOADED:"ALL_LOADED",PLAYER_EVENT:"player_event",ZOOM_CHANGE:"zoom_change",DOC_RESIZE:"doc_resize",DOC_CHANGE:"doc_change",ACTIVE_SLIDE_CHANGE:"active_slide_change",SET_ACTIVE_SLIDE:"set_active_slide",ON_PREVIEW_LIMIT:"preview_limit",MEDIA_PLAY_CHANGE:"media_play_change",MEDIA_VISIBLE_CHANGE:"media_visible_change",MEDIA_STYLE_CHANGE:"media_style_change",MEDIA_PLAY_END:"media_play_end",DESTROY_SLIDE_VIDEO:"destroy_slide_video",PREVIEW_ANIMATION:"preview_animation",SEARCH_AT_END:"search_at_end",SEARCH_RESULT_CHANGED:"search_result_changed",SEARCH_RESULT_ADD:"search_result_add",SEARCH_RESULT_REMOVE:"search_result_remove",SEARCH_INDEX_CHANGE:"search_index_change",WPP_LASERPEN_INK_POINTS:"wpp_laserpen_ink_points",WPP_INK_TOOLBAR:"wpp_ink_toolbar",WPP_INK_VISIBLE:"wpp_ink_visible",SLIDE_CHANGE_DONE:"slide_change_done",SELECT_SHAPE_CHANGE:"select_shape_change",SELECT_SLIDE_CHANGE:"select_slide_change",ON_FORECE_ROTATE_CHANGE:"on_forece_rotate_change",SET_AUTO_FORECE_ROTATE:"SET_AUTO_FORECE_ROTATE",COOPER_SELECTION_CHANGE:"cooper_selection_change",READONLY_SELECT_SHAPE_POSITION:"readonly_select_shape_position",SVG_ROOT_VIEW_CHANGE:"svg_root_view_change",SLIDE_CORE_DATA_COMPLETED:"slide_core_data_completed",MASTER_SLIDE_CHANGE:"master_slide_change",ERROR_CORE:"error_core",REMARK_AUDIENCE_VIEW_OPENED:"remark_audience_view_opened",MULTI_SLIDE:"multi_slide",EXPLAIN_PLAYER_INIT_DONE:"explain_player_init_done",MODIFY_PAGE_SETUP:"modify_page_setup",MODIFY_DOCUMENT_BEAUTIFY:"MODIFY_DOCUMENT_BEAUTIFY",BACKEND_CMD:"backend_cmd"}},606:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(808),l=r(360);function u(e,t,r){return(t.x-e.x)*(r.y()-e.y)-(r.x()-e.x)*(t.y-e.y)}function c(e){return e&&e.isQPoint?{x:e.x(),y:e.y()}:Object(l.f)(e)?e:void 0}var h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i()(this,e),this.setRect(t,r,n,a)}return o()(e,[{key:"clone",value:function(){return new e(this.xp,this.yp,this.w,this.h)}},{key:"setRect",value:function(e,t,r,n){this.xp=e,this.yp=t,this.w=r,this.h=n}},{key:"setCoords",value:function(e,t,r,n){this.assignCoords(e,t,r,n)}},{key:"getRect",value:function(){return{x:this.x(),y:this.y(),width:this.width(),height:this.height()}}},{key:"getRoundRect",value:function(){return{x:Math.round(this.x()),y:Math.round(this.y()),width:Math.round(this.width()),height:Math.round(this.height())}}},{key:"getAlignedRect",value:function(){return{x:Math.floor(this.x()),y:Math.floor(this.y()),width:Math.ceil(this.width()),height:Math.ceil(this.height())}}},{key:"getAlignedBounds",value:function(){return{left:Math.floor(this.left()),top:Math.floor(this.top()),right:Math.ceil(this.right()),bottom:Math.ceil(this.bottom())}}},{key:"getCoords",value:function(){return{x1:this.x(),y1:this.y(),x2:this.right(),y2:this.bottom()}}},{key:"getBounds",value:function(){return{left:this.left(),top:this.top(),right:this.right(),bottom:this.bottom()}}},{key:"topLeft",value:function(){return new s.a(this.xp,this.yp)}},{key:"bottomRight",value:function(){return new s.a(this.xp+this.w,this.yp+this.h)}},{key:"topRight",value:function(){return new s.a(this.xp+this.w,this.yp)}},{key:"bottomLeft",value:function(){return new s.a(this.xp,this.yp+this.h)}},{key:"width",value:function(){return this.w}},{key:"height",value:function(){return this.h}},{key:"left",value:function(){return this.xp}},{key:"right",value:function(){return this.xp+this.w}},{key:"x",value:function(){return this.xp}},{key:"y",value:function(){return this.yp}},{key:"top",value:function(){return this.yp}},{key:"bottom",value:function(){return this.yp+this.h}},{key:"size",value:function(){return this.width()*this.height()}},{key:"center",value:function(){return new s.a(this.xp+this.w/2,this.yp+this.h/2)}},{key:"setWidth",value:function(e){this.w=e}},{key:"setHeight",value:function(e){this.h=e}},{key:"setSize",value:function(e){this.w=e.width,this.h=e.height}},{key:"setLeft",value:function(e){var t=e-this.xp;this.xp+=t,this.w-=t}},{key:"setRight",value:function(e){this.w=e-this.xp}},{key:"setBottom",value:function(e){this.h=e-this.yp}},{key:"setTop",value:function(e){var t=e-this.yp;this.yp+=t,this.h-=t}},{key:"setTopLeft",value:function(e){this.setLeft(e.x()),this.setTop(e.y())}},{key:"setBottomRight",value:function(e){this.setRight(e.x()),this.setBottom(e.y())}},{key:"setTopRight",value:function(e){this.setRight(e.x()),this.setTop(e.y())}},{key:"setBottomLeft",value:function(e){this.setLeft(e.x()),this.setBottom(e.y())}},{key:"setOffset",value:function(e,t){this.xp+=e,this.yp+=t}},{key:"setOff",value:function(t,r){return new e(this.xp+t,this.yp+r,this.w,this.h)}},{key:"adjust",value:function(e,t,r,n){var i=this.xp+e,a=this.yp+t,o=this.xp+this.w+r,s=this.yp+this.h+n;return this.setCoords(i,a,o,s),this}},{key:"adjusted",value:function(e,t,r,n){return this.clone().adjust(e,t,r,n)}},{key:"assign",value:function(e){return e&&(e.isQRect||e.isRect)?(this.xp=e.x(),this.yp=e.y(),this.w=e.width(),this.h=e.height()):console.error(e+" is not instacneof Rect check!"),this}},{key:"assignCoords",value:function(e,t,r,n){return this.xp=e,this.yp=t,this.w=r-e,this.h=n-t,this}},{key:"rotationAtCenter",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r||this.center(),i=this.topLeft().rotationAt(n,t),a=this.topRight().rotationAt(n,t),o=this.bottomRight().rotationAt(n,t),s=this.bottomLeft().rotationAt(n,t),l=Math.min(i.x(),a.x(),o.x(),s.x()),u=Math.max(i.x(),a.x(),o.x(),s.x()),c=Math.min(i.y(),a.y(),o.y(),s.y()),h=Math.max(i.y(),a.y(),o.y(),s.y());return new e(l,c,u-l,h-c)}},{key:"isInside",value:function(e){var t=this.xp,r=this.yp,n=this.xp+this.w,i=this.yp+this.h,a={x:t,y:r},o={x:t,y:i},s={x:n,y:i},l={x:n,y:r};return u(a,o,e)*u(s,l,e)>=0&&u(o,s,e)*u(l,a,e)>=0}},{key:"isNull",value:function(){return 0===this.w&&0===this.h}},{key:"isEmpty",value:function(){return this.w<=0||this.h<=0}},{key:"isValid",value:function(){return this.w>0&&this.h>0}},{key:"moveLeft",value:function(e){this.xp=e}},{key:"moveRight",value:function(e){this.xp=e-this.w}},{key:"moveTop",value:function(e){this.yp=e}},{key:"moveBottom",value:function(e){this.yp=e-this.h}},{key:"moveTo",value:function(e){var t=c(e);t&&(this.xp=t.x,this.yp=t.y)}},{key:"moveTopLeft",value:function(e){var t=c(e);t&&(this.moveLeft(t.x),this.moveTop(t.y))}},{key:"moveBottomRight",value:function(e){var t=c(e);t&&(this.moveRight(t.x),this.moveBottom(t.y))}},{key:"moveTopRight",value:function(e){var t=c(e);t&&(this.moveRight(t.x),this.moveTop(t.y))}},{key:"moveBottomLeft",value:function(e){var t=c(e);t&&(this.moveLeft(t.x),this.moveBottom(t.y))}},{key:"moveCenter",value:function(e){var t=c(e);t&&(this.xp=t.x-this.w/2,this.yp=t.y-this.h/2)}},{key:"translate",value:function(e){var t=c(e);return t&&(this.xp+=t.x,this.yp+=t.y),this}},{key:"translated",value:function(e){return this.clone().translate(e)}},{key:"scale",value:function(e,t){return this.xp*=e,this.yp*=t,this.w*=e,this.h*=t,this}},{key:"scaled",value:function(e,t){return this.clone().scale(e,t)}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=c(e),n=this.xp,i=this.yp,a=this.w,o=this.h,s=n,l=n;if(a<0?s+=a:l+=a,t){if(r.x<=s||r.x>=l)return!1}else if(r.x<s||r.x>l)return!1;var u=i,h=i;if(o<0?u+=o:h+=o,u===h)return!1;if(t){if(r.y<=u||r.y>=h)return!1}else if(r.y<u||r.y>h)return!1;return!0}},{key:"containsRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isNull()||e.isNull())return!1;var r=this.xp,n=this.yp,i=this.w,a=this.h,o=r,s=r;i<0?o+=i:s+=i;var l=e.xp,u=e.xp;if(e.w<0?l+=e.w:u+=e.w,t){if(l<=o||u>=s)return!1}else if(l<o||u>s)return!1;var c=n,h=n;a<0?c+=a:h+=a;var d=e.yp,p=e.yp;if(e.h<0?d+=e.h:p+=e.h,t){if(d<=c||p>=h)return!1}else if(d<c||p>h)return!1;return!0}},{key:"contains",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.isQRect)return this.containsRect(t,r);if(t.isRect)return this.containsRect(new e(t.x(),t.y(),t.width(),t.height()),r);if(t.isQPoint||Object(l.f)(t))return this.containsPoint(t,r);if(t){if(t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height"))return this.containsRect(new e(t.x,t.y,t.width,t.height),r);if(t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom"))return this.containsRect(new e(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1),r);if(t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2"))return this.containsRect(new e(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),r)}return!1}},{key:"unite",value:function(e){if(this.isNull())return this.assign(e);if(e.isNull())return this;var t=this.xp,r=this.yp,n=this.w,i=this.h,a=t,o=t;n<0?a+=n:o+=n,e.w<0?(a=Math.min(a,e.xp+e.w),o=Math.max(o,e.xp)):(a=Math.min(a,e.xp),o=Math.max(o,e.xp+e.w));var s=r,l=r;return i<0?s+=i:l+=i,e.h<0?(s=Math.min(s,e.yp+e.h),l=Math.max(l,e.yp)):(s=Math.min(s,e.yp),l=Math.max(l,e.yp+e.h)),this.xp=a,this.yp=s,this.w=o-a,this.h=l-s,this}},{key:"intersect",value:function(e){var t=this.xp,r=this.yp,n=this.w,i=this.h,a=t,o=t;if(n<0?a+=n:o+=n,a===o)return this.assignCoords(0,0,0,0);var s=e.xp,l=e.xp;if(e.w<0?s+=e.w:l+=e.w,s===l)return this.assignCoords(0,0,0,0);if(a>=l||s>=o)return this.assignCoords(0,0,0,0);var u=r,c=r;if(i<0?u+=i:c+=i,u===c)return this.assignCoords(0,0,0,0);var h=e.yp,d=e.yp;return e.h<0?h+=e.h:d+=e.h,h===d||u>=d||h>=c?this.assignCoords(0,0,0,0):(this.xp=Math.max(a,s),this.yp=Math.max(u,h),this.w=Math.min(o,l),this.h=Math.min(c,d),this)}},{key:"intersects",value:function(e){var t=this.xp,r=this.yp,n=this.w,i=this.h,a=t,o=t;if(n<0?a+=n:o+=n,a===o)return!1;var s=e.xp,l=e.xp;if(e.w<0?s+=e.w:l+=e.w,s===l)return!1;if(a>=l||s>=o)return!1;var u=r,c=r;if(i<0?u+=i:c+=i,u===c)return!1;var h=e.yp,d=e.yp;return e.h<0?h+=e.h:d+=e.h,h!==d&&!(u>=d||h>=c)}},{key:"isEquals",value:function(t){return e.isEquals(this,t)}},{key:"isQRect",get:function(){return!0}}],[{key:"create",value:function(t){var r=new e;return t&&(t.isQRect?r.assign(t):t.isRect?r.setRect(t.x(),t.y(),t.width(),t.height()):t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("width")&&t.hasOwnProperty("height")?r.setRect(t.x,t.y,t.width,t.height):t.hasOwnProperty("left")&&t.hasOwnProperty("right")&&t.hasOwnProperty("top")&&t.hasOwnProperty("bottom")?r.setRect(t.left,t.top,t.right-t.left+1,t.bottom-t.top+1):t.hasOwnProperty("x1")&&t.hasOwnProperty("y1")&&t.hasOwnProperty("x2")&&t.hasOwnProperty("y2")&&r.setRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),r}},{key:"setFromPoint",value:function(t,r){var n=new e;return n.setCoords(t.x(),t.y(),r.x(),r.y()),n}},{key:"unite",value:function(e,t){return e.clone().unite(t)}},{key:"intersect",value:function(e,t){return e.clone().intersect(t)}},{key:"isEquals",value:function(e,t){return Object(l.k)(e.xp,t.xp)&&Object(l.k)(e.yp,t.yp)&&Object(l.k)(e.w,t.w)&&Object(l.k)(e.h,t.h)}}]),e}();window.Rect=h},624:function(e,t,r){"use strict";r.d(t,"b",(function(){return _})),r.d(t,"g",(function(){return T})),r.d(t,"f",(function(){return b})),r.d(t,"a",(function(){return m})),r.d(t,"c",(function(){return S})),r.d(t,"d",(function(){return k})),r.d(t,"e",(function(){return v}));var n=r(146),i=r(1131),a=r(263),o=r(304),s=r(1132);function l(){this.customFactory=null,this.defaultFactory=new S,this.workspace=null,this.transDepositedContainer=null,this.commandProc=null,this.resetRepertory(this)}l.prototype.resetRepertory=function(e){e.newObjMap=new Object,e.topObjMap=new Object,e.curTopOps=new Array,e.transacts=new Array,e.curTransact=null,e.curVersion=-1,e.baseVersion=-1,e.initVersion=-1,e.reachVersion=-1,e.taskVersion=-1,e.lockVersion=-1,e.undoSteps=0,e.undoLocalSteps=0,e.lockUndoSteps=-1,e.transLevel=0,e.needSendToSvr=!0,e.transExt=[],e.destroyedExtRanges={},e.delayLoadObj=new Set,null!=e.workspace&&(e.workspace.documents=[]),e.bornTaskVerUndo=new Set,e.curBornTaskVerUndo=new Map,e.curLastUndoTrans=null},l.prototype.beginTransact=function(){if(0==this.transLevel){if(null!=this.curTransact)return;this.curTransact=new s.a,this.curTransact.beginExtObjects(this.transDepositedContainer.transDepositedGetArray())}this.transLevel++},l.prototype.endTransact=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.ctCommit;if(!(this.transLevel<=0)&&null!=this.curTransact)if(!0===e)this.curTransact.rollback(),this.curTransact=null,this.transLevel=0;else if(0==--this.transLevel){this.curTransact.complete(),this.clearInvalidTransacts(!0,!0,!1),this.curTransact.commitExtObjects(this.transDepositedContainer.transDepositedGetArray()),this.needSendToSvr||(t===o.default.ctCommit_Merge?t=o.default.ctCommit_UnClose:t===o.default.ctCommit_MergeAndClose&&(t=o.default.ctCommit));var r=!1,i=!1;switch(t){case o.default.ctCommit_UnClose:r=!1,i=!1;break;case o.default.ctCommit_Merge:r=!0,i=!1;break;case o.default.ctCommit_MergeAndClose:r=!0,i=!0;break;case o.default.ctCommit:default:r=!1,i=!0}r&&this.isTransactCanMerge()?(this.mergeToLastTransact(this.curTransact),i&&this.closeLastTransact()):(this.closeLastTransact(),this.canMergeToLocalCommand(this.curTransact)?(this.mergeToLastTransact(this.curTransact),i&&this.closeLastTransact()):(this.curVersion++,this.curTransact.setDataVersion(this.curVersion),this.transacts.push(this.curTransact),i&&this.closeLastTransact(),n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED))),this.curTransact=null,this.transacts.length!==this.getCurTransactIndex()+1&&console.error("endTransact:version not match!")}},l.prototype.isInTransaction=function(){return this.transLevel>0},l.prototype.closeLastTransact=function(){var e=this.transacts.length;if(0==e)return!1;var t=this.transacts[e-1];return!t.closed&&(t.closed=!0,!this.needSendToSvr||this.sendCommandToSvr(t))},l.prototype.dropLastTransact=function(){this.undo(),this.clearInvalidTransacts(!0,!1,!0),n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED)},l.prototype.isTransactCanMerge=function(){var e=this.transacts.length;return 0!=e&&!this.transacts[e-1].closed},l.prototype.getLastLocalCommand=function(){var e=this.transacts.length;return 0==e?null:this.transacts[e-1].localCommand},l.prototype.undo=function(){var e=this.undoLocalVersion();return null!=e&&this.undoLocalSteps++,this.undoSteps++,n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED),e},l.prototype.undoLocalVersion=function(){if(this.curVersion>this.baseVersion){var e=f(this);if(void 0!==e)return e}return null},l.prototype.undoServerVersion=function(){if(this.curVersion==this.baseVersion){var e=f(this);if(null!=e)return this.baseVersion--,e}return null},l.prototype.redo=function(){var e=null;return this.canRedoLocal()&&null!=(e=this.redoVersion())&&this.undoLocalSteps--,this.undoSteps--,n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED),e},l.prototype.redoVersion=function(){var e=p(this);if(null!=e&&!e.isLocalTransact())return this.baseVersion++,e},l.prototype.canUndo=function(){return this.getCurTransactIndex()>=0&&this.hasSelfTransact()&&this.curVersion>this.lockVersion},l.prototype.canUndoLocal=function(){return this.curVersion>this.baseVersion},l.prototype.canRedo=function(){return this.undoSteps>0&&this.undoSteps>this.lockUndoSteps},l.prototype.canRedoLocal=function(){return this.undoSteps>0&&this.undoLocalSteps>0},l.prototype.getTransact=function(e){var t=this.getTransactIndex(e);return t>=this.transacts.length||t<0?null:this.transacts[t]},l.prototype.getNextRedoTransact=function(){var e=this.getCurTransactIndex()+1;return e<this.transacts.length&&e>=0?this.transacts[e]:null},l.prototype.getBaseVersion=function(){return this.baseVersion},l.prototype.getCurrentVersion=function(){return this.curVersion},l.prototype.getCurTaskVersion=function(){return this.taskVersion},l.prototype.getInitialVersion=function(){return this.initVersion},l.prototype.getCurrentTransact=function(){return this.curTransact},l.prototype.getTransactIndex=function(e){return g_rpt.transacts.length>0?e-g_rpt.transacts[0].dataVersion:e-this.initVersion-1},l.prototype.getCurTransactIndex=function(){return this.getTransactIndex(this.curVersion)},l.prototype.applyServerInitData=function(e){if(null==e.versions)return console.log("server data error: ",e),{};this.resetRepertory(this),this.assembleNewObjects(e,this);var t=this.playDocumentInit(e,this);return n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED),t},l.prototype.clearInvalidTransacts=function(e,t,r){var n=this.getCurTransactIndex()+1,i=this.transacts.length-n;if(i>0){if(t&&(this.transExt=this.transacts.slice(n,n+i).concat(this.transExt)),r)for(var a=this.transacts.slice(n,n+i),o=a.length-1;o>=0;--o)a[o].backwardTopObj();for(var s=n;s<this.transacts.length;++s){var l=this.transacts[s];this.destroyedExtRanges[l.bornTaskVer]=l.extRanges}this.transacts.splice(n,i)}null!=e&&1==e&&(this.undoSteps=0,this.undoLocalSteps=0,this.lockUndoSteps=-1)},l.prototype.applyServerVersions=function(e){var t=this;if(t.curBornTaskVerUndo.clear(),t.curLastUndoTrans=null,null==e.versions||this.isInitializeData(e))return console.error("server data error: ",e),null;this.canUndoLocal()&&this.transacts[this.getCurTransactIndex()].commitExtObjects(this.transDepositedContainer.transDepositedGetArray());this.delayLoadObj.clear(),this.assembleNewObjects(e,this);var r=function(e,t){var r=[],n=[];do{var i=t.undoLocalVersion();if(null!==i){i.localOnly?n.push(i):r.push(i);var a=t.transacts.length-1;a>=0&&t.transacts[a]==i?t.transacts.splice(a,1):console.log("error!")}}while(null!==i);var o=function(e){var t=[];return e.versions.forEach((function(e){null!=e.isVerOfCurExec&&1==e.isVerOfCurExec&&t.push(e)})),t}(e),s=o.length,l=r.splice(r.length-s);r=r.concat(n),l.reverse();for(var u=0;u<l.length;u++)o[u]&&l[u]&&l[u].extRanges&&(o[u].extRanges=l[u].extRanges);return{commited:l,notCommited:r.reverse()}}(e,this),i=function(e,t){if(void 0===e.baseDataVer)return;t.curVersion!=t.baseVersion&&console.error("resetBaseVersion:version not match");var r=[];for(;t.curVersion>e.baseDataVer;){var n=t.undoServerVersion();if(null==n)break;r.push(n)}return r.reverse()}(e,this),a=[],s=e.versions.length,l=function(e,t){for(var r=new Array,n=0;n<e.orgObjs.length;n++){var i=e.orgObjs[n],a=t.getServerObjectByID(i.id);if(null!=a&&null!=a){if(a.objType==o.default.OType_Data||a.objType==o.default.OType_Custom){for(var s in i.data)y(a.constructor)(s);a.isTopObject()&&console.log("playTopOperates:new"),a.private=i.data,a.newest=!0,a.onChangedCB&&a.onChangedCB(a)}r.push(a)}}return r}(e,this);s>0&&this.clearInvalidTransacts(!1,!1,!0);var f=0;if(s>0)for(var v=0;v<s&&t.transExt.length>0;++v){var g=e.versions[v];if(d(g)){f=g.dataVer-t.baseVersion-1;break}}else f=Math.max(0,e.curDataVer-t.baseVersion);if(t.transExt.length>0&&s>0)for(var m=t.transExt.length-1;m>=f;--m)t.transExt[m].backwardTopObj();for(v=0;v<f&&f<=t.transExt.length;++v){var _=t.transExt[v];t.transacts.push(_),a.push(_),t.baseVersion=t.baseVersion+1,_.setDataVersion(t.baseVersion),p(t)}t.transExt=0==s?t.transExt.splice(f):[];for(v=0;v<s;v++){g=e.versions[v];null!=(_=u(g,window.g_rpt))&&(a.push(_),h(_,g,window.g_rpt)),g.type===o.default.vtDataVersion?p(this):g.type===o.default.vtLocCommandVersion&&playLocalCommand(g)}var S=c(e,this);return l.forEach((function(e){null!=e.newest&&(e.newest=!1)})),function(e,t,r,n){if(void 0===e.curDataVer)return;if(t.curVersion>e.curDataVer)for(;t.curVersion>e.curDataVer;){var i=t.undoServerVersion(!1);if(null==i)break;r.length>0?r.splice(r.length-1,1):n.push(i)}else for(;t.curVersion<e.curDataVer;){var a=t.redoVersion(!1);if(null==a)break;r.push(a)}t.curVersion==e.curDataVer&&t.baseVersion==e.curDataVer||console.error("setCurrentVersion:version not match!")}(e,this,a,i),null!=e.undoSteps&&(this.undoSteps=e.undoSteps+this.undoLocalSteps),n.default.dispatchEvent(n.default.names.TRANSACT_CHANGED),this.delayLoadObj.clear(),this.restoreExtObjRanges(),{localVersions:r.notCommited,localCommitedVersion:r.commited,resetBaseVersions:i,applyVersions:a,shapePictureChanged:S}},l.prototype.restoreExtObjRanges=function(){var e=this,t=e.curLastUndoTrans;e.curBornTaskVerUndo.forEach((function(r,n){e.bornTaskVerUndo.add(n),(null==t||r.taskVer>t.taskVer)&&(t=r)})),null!=t&&t.swapExtObjRanges(t!=e.curLastUndoTrans),e.curBornTaskVerUndo.clear(),e.curLastUndoTrans=null},l.prototype.updateExtObjectsAfterApply=function(){var e=this.getCurTransactIndex();e+1==this.transacts.length&&0<=e&&this.transacts[e].commitExtObjects(this.transDepositedContainer.transDepositedGetArray())},l.prototype.isInitializeData=function(e){return!(!e.versions||1!=e.versions.length||e.versions[0].type!=o.default.vtInitialData)},l.prototype.setCustomFactory=function(e){this.customFactory=e},l.prototype.setTransDepositedContainer=function(e){this.transDepositedContainer=e},l.prototype.getTransDepositedContainer=function(){return this.transDepositedContainer},l.prototype.setCommandProc=function(e){this.commandProc=e},l.prototype.getCustomFactory=function(){return this.customFactory},l.prototype.setWorkspace=function(e){this.workspace=e,this.registerServerObject(1,this.workspace)},l.prototype.getWorkspace=function(){return null===this.workspace&&(this.workspace=new _,this.registerServerObject(1,this.workspace)),this.workspace},l.prototype.getServerObjectByID=function(e,t){return 1===e?this.getWorkspace():0===e?null:null!=t?t[e]:this.newObjMap[e]},l.prototype.registerServerObject=function(e,t,r){1!==e&&0!==e&&(null!=r?r[e]=t:this.newObjMap[e]=t)},l.prototype.registerNewObject=function(e){this.curTransact&&this.curTransact.registerNewObject(e)},l.prototype.registerTopObject=function(e,t){this.topObjMap[e]=t},l.prototype.addDataNotify=function(e){this.curTransact&&this.curTransact.addDataNotify(e)},l.prototype.addVectorOperate=function(e,t,r,n,i,a){this.curTransact&&this.curTransact.addVectorOp(e,t,r,n,i,a)},l.prototype.addCustomOperate=function(e,t){this.curTransact&&this.curTransact.addCustomOp(e,t)},l.prototype.createObjectForSvr=function(e,t,r){var n=null;return null!=t&&this.customFactory&&(n=this.customFactory.createObjectForSvr(e,t,r)),null==n&&(n=this.defaultFactory.createObjectForSvr(e,t,r)),n},l.prototype.createTopObjectForSvr=function(e,t,r){var n=null;return null!=t&&this.customFactory&&(n=this.customFactory.createTopObjectForSvr(e,t,r)),null==n&&(n=this.defaultFactory.createTopObjectForSvr(e,t,r)),n},l.prototype.hasSelfTransact=function(){for(var e=this.getCurTransactIndex();e>=0;e--){var t=this.transacts[e];if("over"===t.banUndoType)return!1;if("cur"!==t.banUndoType&&1==t.isSelf)return!0}return!1},l.prototype.mergeToLastTransact=function(e){var t=this.transacts.length;if(0==t)return!1;var r=this.transacts[t-1];if(e.operates.forEach((function(e){r.operates.push(e)})),null!=e.localCommand)if(null==r.localCommand)r.localCommand=e.localCommand,console.error("localCommand not diff!");else if(null!=this.commandProc){var n=this.commandProc.mergeLocalCommand(r.localCommand,e.localCommand);r.mergeExtObjects(this.transDepositedContainer.transDepositedGetArray(),e),0==n&&console.error("command type not diff!")}return!1},l.prototype.canMergeToLocalCommand=function(e){var t=this.transacts.length;if(0==t)return!1;var r=this.transacts[t-1];return!(!this.needSendToSvr||null==this.commandProc||!this.commandProc.hasCommandQueue())&&this.commandProc.canMergeLocalCommand(r.localCommand,e.localCommand)},l.prototype.sendCommandToSvr=function(e){if(e&&null!=e.localCommand&&null!=this.commandProc){var t=this.commandProc;return t.needAuxOps&&t.needAuxOps(e.localCommand)&&t.exportAuxOpsToCommand(e,e.localCommand),t.sendCommand(e.localCommand)}return!1};var u=function(e,t){var r=e.ops,n=new s.a;return e.__topOps=new Array,r.forEach((function(r){var i=t.getServerObjectByID(r.id);if(null!=i){var a=i.objType,s=void 0;switch(r.opt){case o.default.otReplaceData:s={obj:i,opType:r.opt,data:r.data};break;case o.default.otInsert:case o.default.otMove:case o.default.otRemove:case o.default.otModify:if(a==o.default.OType_Data)return void console.error("op type not math object type!");a==o.default.OType_Vector?(s={obj:i,opType:r.opt,data:r.data,pos:r.pos},void 0!==r.oldData&&(s.oldData=r.oldData),void 0!==r.offset&&(s.offset=r.offset)):(s={obj:i,opType:r.opt,data:r.data},null!=r.pos&&(s.pos=r.pos),null!=r.offset&&(s.offset=r.offset));break;default:return}i.isTopObject()?e.__topOps.push(s):n.addServerOperate(s)}})),e.mainObjOps.forEach((function(e){var r=t.getServerObjectByID(e.id);null!=r&&n.addMainObjectOperates(r,e.ops)})),e.extRanges&&(n.extRanges=e.extRanges,e.extRanges=null),null==n.extRanges&&(n.extRanges=t.destroyedExtRanges[e.bornTaskVer]),null==n.extRanges&&(n.beginExtObjects(t.transDepositedContainer.transDepositedGetArray()),n.commitExtObjects(t.transDepositedContainer.transDepositedGetArray())),t.taskVersion=e.taskVer,d(e)?(t.baseVersion=e.dataVer,t.reachVersion=e.dataVer,n.taskVer=e.taskVer,n.bornTaskVer=e.bornTaskVer,n.setDataVersion(e.dataVer),n.isSelf=null!=e.self&&e.self,n.isVerOfCurExec=null!=e.isVerOfCurExec&&e.isVerOfCurExec,n.banUndoType=e.banUndo?e.banUndo:null,n.isLocal=!1,n.closed=!0,t.transacts.push(n),t.transacts.length>100&&t.transacts.splice(0,t.transacts.length-100),n):null},c=function(e){if(null!=e.shapePics){var t=!1;return e.shapePics.forEach((function(e){var r=window.g_rpt.getServerObjectByID(e.id);null!=r&&(null!=r.setSha1?r.setSha1(e.sha1,e.dpi):r.sha1=e.sha1,null!=r.setRect?r.setRect(e.rect):r.rect=e.rect,r.updateChartMetaData&&e.chartMetaData&&(r.updateChartMetaData(e.chartMetaData),e.chartMetaData=null),t=!0)})),e.shapePics=[],t}},h=function(e,t,r){if(void 0!==t.__topOps){var n=t.__topOps.length;n>0&&console.log("playTopOperates");for(var i=0;i<n;i++){var a=t.__topOps[i];if(a.obj.isTopObject()){var o=a.obj.forward(a);null!=o&&o instanceof Array&&(e.operates=e.operates.concat(o))}}e.topOps=t.__topOps}},d=function(e){return e.type===o.default.vtDataVersion||e.type===o.default.vtLocalCmdVersion},p=function(e){var t=e.getCurTransactIndex()+1;if(t<e.transacts.length&&t>=0){var r=e.transacts[t];if(r.forward(),r.bornTaskVer>=0)!e.curBornTaskVerUndo.delete(r.bornTaskVer)&&e.bornTaskVerUndo.delete(r.bornTaskVer)&&(e.curLastUndoTrans=r);return e.curVersion++,r}return null},f=function(e){var t=e.getCurTransactIndex();if(t<e.transacts.length&&t>=0){var r=e.transacts[t];return r.backward(!0),r.bornTaskVer>=0&&e.curBornTaskVerUndo.set(r.bornTaskVer,r),e.curVersion--,r}return null},v=function(e){var t=e.substr(0,1).toUpperCase()+e.substr(1);return{get:"get"+t,set:"set"+t}},y=function(e){return function(t){var r=v(t),n=r.get;void 0===e.prototype[n]&&(e.prototype[n]=function(){return this.private[t]});var i=r.set;void 0===e.prototype[i]&&(e.prototype[i]=function(e){null!=this.writeLock&&this.writeLock(),this.private[t]=e})}};function g(e,t,r,n){var i=t.__svrObjMap[e],a=null;if(void 0===i)return void 0===(a=n.getServerObjectByID(e))?(console.error("object not find!"),null):a;if(void 0!==(a=n.getServerObjectByID(e,t.__newObjsTmp)))return a;var o=null,s=i.top,l=i.clsname,u=i.type;return(o=s?n.createTopObjectForSvr(u,l,i,t):n.createObjectForSvr(u,l,i,t))._setSelf&&o._setSelf(),n.registerServerObject(e,o),n.registerServerObject(e,o,t.__newObjsTmp),o}function m(){this.objType,this.private=null,this.initialize()}function _(){this.documents=new Array,this.initialize()}function S(){}l.prototype.assembleNewObjects=function(e,t){var r=e.versions;e.__svrObjMap=new Object,e.__newObjsTmp=new Object;for(var n=0;n<r.length;n++){r[n].newObjs.forEach((function(t){e.__svrObjMap[t.id]=t}))}null!=e.newObjs&&e.newObjs.forEach((function(t){e.__svrObjMap[t.id]=t})),null!=e.newCustomObjs&&e.newCustomObjs.forEach((function(t){e.__svrObjMap[t.id]=t}));var i=e.__objRefers,a=i.length;for(n=0;n<a;n++){var o=i[n],s=o.parent;if(o.isArr)s[o.index]=g(o.oid,e,0,t);else s[o.field]=g(o.oid,e,0,t)}if(t.customFactory)for(var l=0;l<e.__namedObjRefers.length;l++){var u=e.__namedObjRefers[l];u.parent[u.field]=t.customFactory.createBinVarNamedObj(u.parent[u.field])}for(n=0;n<r.length;n++){var c=r[n].delayNewObjs;null!=c&&c.forEach((function(r){var n=g(r,e,0,t);t.delayLoadObj.add(n)}))}delete e.__namedObjRefers,delete e.__objRefers,delete e.__svrObjMap,delete e.__newObjsTmp},l.prototype.playDocumentInit=function(e,t){if(null==e.versions||1!=e.versions.length)return console.error("initial version shuoud be 1"),null;var r=e.versions[0];if(1!=r.ops.length||1!==r.ops[0].id)return console.error("init data error!"),null;var n=r.ops[0],i=t.getServerObjectByID(n.id);t.curVersion=r.dataVer,t.baseVersion=r.dataVer,t.initVersion=r.dataVer,t.taskVersion=r.taskVer,t.reachVersion=r.dataVer,i.forward(n);var a=n.data;return i.documents.push(a),a},l.prototype.appendVersionInfo=function(e){e.dataVer=this.baseVersion,e.taskVer=this.taskVersion,e.reachVer=this.reachVersion},l.prototype.lockCurVersion=function(){this.lockVersion=this.curVersion},l.prototype.lockCurrentUndoSteps=function(){this.lockUndoSteps=this.undoSteps},window.g_rpt=new l,m.prototype.initialize=function(){this.objType=o.default.OType_Nake},_.prototype=new a.AbsTopObject,S.prototype.addAttrs=function(e,t){for(var r in t.data)y(e)(r)},S.prototype.createObjectForSvr=function(e,t,r){var n=null;switch(e){case o.default.OType_Nake:n=new m,this.addAttrs(m,r),n.private=r.data;break;case o.default.OType_Data:n=new a.AbsObject,this.addAttrs(a.AbsObject,r),n.private=r.data;break;case o.default.OType_Vector:(n=new a.AbsVectorObject).private=r.data,n.vector=r.data;break;case o.default.OType_Custom:if("AbsModel"==t){(n=new i.a).applySvrData(r),this.addAttrs(i.a,r);break}n=new a.AbsCustomObject,this.addAttrs(a.AbsCustomObject,r),n.private=r.data}return n&&(n.objID=r.id),n},S.prototype.createTopObjectForSvr=function(e,t,r){var n=null;switch(e){case o.default.OType_Vector:(n=new a.AbsTopVectorObject).vector=r.data;break;case o.default.OType_Data:n=new a.AbsTopObject,this.addAttrs(a.AbsTopObject,r),n.private=r.data;break;case o.default.OType_Custom:n=new a.AbsTopCustomObject,this.addAttrs(a.AbsTopCustomObject,r),n.private=r.data}return n&&(n.objID=r.id),n},S.prototype.createBinVarNamedObj=function(e){return e};var T=function(e,t,r){y(e.constructor)(t),e[v(t).set](r)},b=function(e,t){console.assert(0!=t.length);var r=v(t).get;return null!=e[r]?e[r]():null},k=function(e){if(e&&e.private)for(var t in e.private)y(e.constructor)(t)}},664:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPENAPI_EVENT=void 0,t.OPENAPI_EVENT={SET_MODE:"openapi.set.mode",SET_ACTIVE_SLIDE:"openapi.set.active.slide",ON_PREVIEW_LIMIT:"openapi.on.preview.limit",SET_ZOOM:"openapi.set.zoom",SET_PLAY_FULLSCREEN_TYPE:"openapi.set.play.isLanchFullscrenn.type",SLIDE_UPDATE_WATERMARK:"slide_update_watermark",SET_SHOW_PAGE:"set_show_page",UPDATE_LASERPEN:"update_laserpen",OPEN_INK_EDITOR:"open_ink_editor",ON_GET_MEDIA_PLAY_MSG:"on_get_media_play_msg",CLICK_LANCH_FULLSCREEN:"click_lunch_fullscreen",CLICK_EXIT_FULLSCREEN:"click_exit_fullscreen",SET_START_AUTO_PLAY:"set_start_auto_play",SET_STOP_AUTO_PLAY:"set_stop_auto_play",SET_RESUME_ADVANCE_PLAY:"set_resume_advance_play",SET_STOP_ADVANCE_PLAY:"set_stop_advance_play",SET_HIDE_PLAYING_MENU:"set_hide_playing_menu",SET_HIDE_PLAY_HOVER_LINK:"set_hide_play_link",SET_HIDE_IMAGE_HOVER_TIP:"set_hide_image_hover_tip",STOP_VIDEO_PLAY:"stop_video_play",ON_PLAY_MEDIA:"on_play_media",ON_LAST_PAGE:"on_last_page",INSERT_IMAGE:"insert_image",RECEIVE_MATTING_PICTURE:"receive_matting_picture",INSERT_SLIDE:"open_api_insert_slide",INSERT_TEXTBOX:"open_api_insert_textbox",INSERT_HYPERLINK:"open_api_insert_hyperlink",REPLACE_PICTURE:"replace_picture",SET_MINI_THUMBNAIL_VISIBLE:"set_mini_thumbnail_visible",MINI_THUMBNAIL_VISIBLE_INFO:"mini_thumbnail_visible_info",EXIT_VIDEO_FULLSCREEN:"exit_video_fullscreen",VIDEO_FULLSCREEN_INFO:"video_fullscreen_info",SET_PLAY_TOOLBAR_POSITION:"set_paly_toolbar_position",SET_PLAY_INK_POSITION:"set_play_ink_position",SHOW_PALY_TOOLBAR:"show_play_toolbar",SET_COUNT_DOWN:"set_count_down",OPEN_REMARK_SPEAKER:"open_remark_speaker",ON_DIAGRAM_MOUNT:"ON_DIAGRAM_MOUNT",ON_DIAGRAM_TOGGLE_BTNS:"ON_DIAGRAM_TOGGLE_BTNS",BEAUTIFY_DIAGRAM_PPT:"BEAUTIFY_DIAGRAM_PPT",INSERT_DIAGRAM:"INSERT_DIAGRAM",INSERT_DIAGRAM_FINISH:"INSERT_DIAGRAM_FINISH",SLIDE_MOVE:"slide_move",SLIDE_INSERT:"slide_insert",SLIDE_DELETE:"slide_delete",SLIDE_CHANGE_OPERATOR:"slide_change_operator",OPEN_REVIEW:"open_review",CLOSE_REVIEW:"close_review",OPEN_REVIEW_END:"open_review_END",OPEN_REVIEW_INK:"open_review_ink",SET_BG_OPACITY:"set_bg_opacity",LAST_SLIDE_END:"last_slide_end",SET_INK_COLOR:"SET_INK_COLOR",SET_INK_WIDTH:"SET_INK_WIDTH",UPDATE_UNDO_REDO:"UPDATE_UNDO_REDO",SWITCH_TO_ERASER:"SWITCH_TO_ERASER",CHANGE_INK_TYPE:"CHANGE_INK_TYPE",GO_TO_COMMENTITEM:"GO_TO_COMMENTITEM",SWITCH_PLAY_FULLSCREEN:"switch_play_fullscreen",ON_PREVIEW_SCROLL_TO_BOTTOM:"ON_PREVIEW_SCROLL_TO_BOTTOM",COMMENT_MODIFY_MESSAGE:"COMMENT_MODIFY_MESSAGE"}},696:function(e,t,r){"use strict";r.r(t);var n=["selection","modifyShapeProps","modifyTextFrameProps","txtStrmInsert","txtStrmDelete","shapeInsert","shapeDelete","shapeMove","txtStrmFmtChpxV2","txtStrmFmtPapxV2","slideDelete","slideInsert","commentAdd","commentDelete","commentModify","slideMove","modifySlideProps","paste","modifySlideLayout","effectAdd","effectRemove","effectMove","modifyEffectProps","behaviorAdd","behaviorRemove","behaviorMove","modifyBehaviorProps","batchCommands","shapeGroup","shapeUngroup","formatBrush","documentBeautify","docTemplate","woChart"],i=["txtStrmFmtChpx","txtStrmFmtPapx","modifyPresentation"],a=["selectItem"],o=["commentSlide","commentCount","queryEmbedding"],s=["addRemarks","modifyRemarks","tableHandler","insertMedia","modifyMedia","replaceText","setTransition","DeleteShapeWithEffect","batchInsertAnime","setImageClip","modifyDiagramGroup","handlerExplain","handlerQRCode","insertDiagram","handlerLatexMath","DeleteShapes","delPlayViewInk","pageSetUp","beautifyHandler","importSlide","insertDocerSlide"];var l=function(){var e={};e.UsedCommands=n,e.OldVerCommands=i,e.FakeCommands=a,e.CommandHanlders=s;for(var t=[n,i,a,s,o],r=0;r<t.length;r++)for(var l=t[r],u=0;u<l.length;u++){var c=l[u];e[c]=c}return e}();t.default=l},724:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n={MoveTo:1,LineTo:2,ArcTo:3,QuadraticBezierTo:4,CubicBezierTo:5,Close:6},i={None:0,Legacy:1,Normal:2,Lighten:3,LightenLess:4,Darken:5,DarkenLess:6},a={MultiplyDivide:0,AddSubtract:1,AddDivide:2,IfElse:3,Absolute:4,ArcTan:5,CosineArcTan:6,Cosine:7,Maximum:8,Minimum:9,Modulo:10,PinTo:11,SineArcTan:12,Sine:13,SquareRoot:14,Tangent:15,SumAngle:16,Ellipse:17,LiteralValue:18},o={gdRefXY:0,gdRefX:1,gdRefY:2,gdRefR:3,gdRefAng:4,gdRefPolar:5},s=5},753:function(e,t,r){"use strict";var n,i,a,o,s,l=r(26),u=(n=l)&&n.__esModule?n:{default:n};e.exports=(i=/(\?|\&)readonly/i.test(window.location.search),a=!1,o=/(\?|\&)lock/i.test(window.location.search),s={getInfor:function(){return{isTriggered:a,isReadMode:i,isLockMode:o}},tryLock:function(){return a&&this.lock(),!1}},window.__WPSENV__.conflictLock=s,function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.info("window.__WPSENV__.conflictLock",e,t);var n=function(){var n={eventName:"edit_lock",readOnly:e,memberId:t,onClientLogout:function(){r&&r()}},i=window.__WPSENV__.isOnlineMode;if(!i){var a=document.createEvent("CustomEvent");a.initCustomEvent("ON_FILE_INFO_CHANGE",!0,!0,(0,u.default)({},n,{isOnline:i,threshold:window.__WPSENV__.isOnlinethreshold})),window.dispatchEvent(a),window.collection2("web_locked_edit_true")}};return a?(s.lock=n,s):{getInfor:function(){return{isReadMode:i,lockReadOnly:e,memberId:t,isTriggered:a,isLockMode:o}},lock:n,unLock:function(){e&&!i&&(a=!0)},tryLock:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!(t&&!i||!i&&!e||(this.lock(),this.unLock(),0))}}})},754:function(e,t,r){"use strict";e.exports={EVENT:{ON_DOCUMENT_SAVEING:"ON_DOCUMENT_SAVEING",ET_EVENT_ENTER_EDIT:"ET_EVENT_ENTER_EDIT",MO_ET_EDIT_MODE_BEGIN:"MO_ET_EDIT_MODE_BEGIN_LOCK",ON_DOCUMENT_SAVEING_HOLDING_LOCK:"ON_DOCUMENT_SAVEING_HOLDING_LOCK"}}},755:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.WebSocket){var t=function(e,t){this.addr=e,this.protocol=n,this.debug=t,this.open()},r=function(e,t){this.url=e,this.cookie_=t,this.retCode=400,this.retAddr="",this.retToken="",this.lastCallTime=(new Date).getTime(),this.firstCall=0},n={unpack:function(e){var t=new DataView(e),r=t.getUint32(0,!0),n=(t.getUint16(4,!0),t.getUint16(6,!0)),i=t.getUint32(8,!0),a=t.getUint32(12,!0),o=t.getUint32(16,!0),s=t.getUint32(20,!0)*Math.pow(2,32)+o;if(1266907392!=r)return{};for(var l=new Array(i),u=n;u<n+i;u++)l[u]=String.fromCharCode(t.getInt8(u));return{msgId:s,msgType:a,body:l.join("")}},unmarshal:function(e){return e},marshalAndPack:function(e,t,r){var n=r.length,i=t,a=e,o=a/Math.pow(2,32)|0,s=a%Math.pow(2,32),l=new ArrayBuffer(24+n),u=new DataView(l);u.setUint32(0,1266907392,!0),u.setUint16(4,1,!0),u.setUint16(6,24,!0),u.setUint32(8,n,!0),u.setUint32(12,i,!0),u.setUint32(16,s,!0),u.setUint32(20,o,!0);for(var c=0;c<r.length;c++)u.setInt8(24+c,r.charCodeAt(c));return u.buffer}};t.prototype={constructor:t,enableBinary:function(){this.ws.binaryType="arraybuffer"},open:function(){this.ws=new WebSocket(this.addr),this.ws.binaryType="arraybuffer",this.callbacks={},this.ws.onclose=this.onClose.bind(this),this.ws.onopen=this.onOpen.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)},onClose:function(e){this.debug&&console.log("wsclientsdk: Connection closed!"),this.callbacks.close&&this.callbacks.close(e)},onMessage:function(e){var t=this.protocol.unpack(e.data);this.callbacks.receive&&this.callbacks.receive(t)},onError:function(e){this.debug&&console.log("wsclientsdk: onerror!"),this.callbacks.error&&this.callbacks.error(e)},onOpen:function(e){this.debug&&console.log("onOpen wsclientsdk: Connection established!"),this.callbacks.open&&this.callbacks.open(e)},set_receive_function:function(e){this.callbacks.receive=e},set_open_function:function(e){this.callbacks.open=e},set_close_function:function(e){this.callbacks.close=e},set_error_function:function(e){this.callbacks.error=e},sendData:function(e,t,r){try{var n=this.protocol.marshalAndPack(e,t,r);this.ws.send(n)}catch(e){console.log("sendData wsclientsdk ex: "+e)}},wsReadyState:function(){try{return this.ws.readyState}catch(e){console.log("wsReadyState wsclientsdk ex: "+e)}},closeWs:function(){console.log("client close websocket"),this.ws.close()}};return r.prototype={getUnpredictableCode:function(){return 20200424},constructor:r,beginLogin:function(e,t){var r=this;return new Promise((function(e,t){r.retCode=400,r.retAddr="",r.retToken="";var n=r;if(0==r.firstCall)r.lastCallTime=(new Date).getTime(),r.firstCall=1;else{var i=(new Date).getTime(),a=r.lastCallTime;r.lastCallTime=i,i-a<1e3&&(console.log("Do not log in frequently"),t())}var o="/ksopush-login-web",s=window.__CONFIG__.pathPrefix;s&&(o=(s=s.substr(0,s.lastIndexOf("/")))+o);var l=window.__WPSENV__.request({method:"GET",url:r.url,responseType:"json",headers:{"client-type":"web","client-ver":"web","client-chan":"web"},encrypt:!0,gateway:o});l.xhr.withCredentials=!0,l.end().then((function(r){var i=r.target,a=r.body,o=i.status;try{n.retCode=o;var s=a;if(!s||!s.Connectors)return t(20200424),void console.log("loginweb 200 result:",s);var l=s.Connectors;if(l&&Array.isArray(l)&&0!==l.length){var u=l[Math.floor(Math.random()*Math.floor(l.length-1))];n.retAddr=u.Addr,n.retToken=s.Token,e(o)}else t(o)}catch(e){t(20200424),console.log("loginweb login error",e)}})).catch((function(e){var r=e.target.status,i=e.body._cause;n.retCode=r,t("error"===i?400:r)}))}))},getRetAddr:function(){return this.retAddr},getRetToken:function(){return this.retToken},getRetCode:function(){return this.retCode}},e.golem={Connection:t,LoginServer:r},e.golem}return console.warn("wsclientsdk: WebSockets not supported!"),null}(window)},756:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.report=t.getOnline=void 0;var n,i,a,o=r(147),s=(n=o)&&n.__esModule?n:{default:n};t.getOnline=(i=(0,s.default)(regeneratorRuntime.mark((function e(){var t,r,n,i,a,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.urlFileId;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l("/api/kdocs/file/"+s+"/settings?conn_id="+window.RPCClient.clientID),r={method:"GET",url:t,responseType:"json"},e.next=4,u(r);case 4:return n=e.sent,i=n.status,a=n.result,o=void 0===a?o&&o.online_mode?o:{online_mode:{online_user_threshold:-1}}:a,e.abrupt("return",{isOnline:200===i&&1===o.mode,threshold:o.online_mode.online_user_threshold});case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),t.report=(a=(0,s.default)(regeneratorRuntime.mark((function e(t,r,n){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l("/api/kdocs/file/"+t+"/settings/report"),a={method:"POST",url:i,body:{action:"edit_lock",data:{member:r,locker:n}},responseType:"json"},e.next=4,u(a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return a.apply(this,arguments)});function l(e){if("www.kdocs.cn"!==location.hostname&&"web.wps.cn"!==location.hostname){var t=window.__CONFIG__.pathPrefix.lastIndexOf("/");return window.__CONFIG__.pathPrefix.substr(0,t)+e}return e}function u(e){return new Promise((function(t){var r=window.__WPSENV__.request(e);r.xhr.withCredentials=!0,r.end().then((function(e){var r=e.target,n=e.body,i=r.status;t({status:i,result:n})})).catch((function(e){window.isDebugger&&console.warn(e),t({status:status})}))}))}},762:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(167),l=r(158),u=function(){function e(){i()(this,e)}return o()(e,null,[{key:"isIgnoreType",value:function(t){return e.isHeaderFooter(t)}},{key:"isHeaderFooter",value:function(e){return e==s.PlaceholderType.SlideNumber||e==s.PlaceholderType.Footer||e==s.PlaceholderType.Header||e==s.PlaceholderType.DateTime}},{key:"isValidType",value:function(e,t){return t?e!==s.PlaceholderType.SlideNumber&&e!==s.PlaceholderType.DateTime&&e!==s.PlaceholderType.Footer:e===s.PlaceholderType.Title||e===s.PlaceholderType.CenterTitle||e===s.PlaceholderType.SubTitle}},{key:"isTitleType",value:function(e){return e==s.PlaceholderType.Title||e==s.PlaceholderType.CenterTitle||e==s.PlaceholderType.SubTitle}},{key:"isTextType",value:function(e){return e==s.PlaceholderType.Body||e==s.PlaceholderType.SubTitle||e==s.PlaceholderType.Object}},{key:"isBodyType",value:function(e){return e==s.PlaceholderType.Body||e==s.PlaceholderType.SubTitle||e==s.PlaceholderType.Object}},{key:"isObjectType",value:function(e){return e==s.PlaceholderType.Object||e==s.PlaceholderType.Chart||e==s.PlaceholderType.Table||e==s.PlaceholderType.Picture||e==s.PlaceholderType.Media}},{key:"isTextShape",value:function(e){return!e.hasChartTemp()&&!e.hasTable()&&!e.isImage}},{key:"isExactMatch",value:function(e,t){var r=e.getPlaceHolder(),n=t.getPlaceHolder();return!(!r||!n)&&(null!=r.type?r.type:s.PlaceholderType.Object)==(null!=n.type?n.type:s.PlaceholderType.Object)}},{key:"isMatch",value:function(t,r){var n=t.getPlaceHolder(),i=r.getPlaceHolder();if(!n||!i)return!1;var a=null!=n.type?n.type:s.PlaceholderType.Object,o=null!=i.type?i.type:s.PlaceholderType.Object;return e.isTitleType(a)&&e.isTitleType(o)||e.isTextShape(t)&&e.isTextType(o)||!e.isTextShape(t)&&e.isObjectType(o)}},{key:"isEmptyPh",value:function(e){if(!e.isBodyType())return!1;var t=e.getShapeType()==(l.ShapeType.Picture||l.ShapeType.Processon),r=e.hasContent();return!t&&!r}},{key:"phTypeFollowMaster",value:function(e){var t=s.PlaceholderType.Body;switch(void 0!==e.type&&(t=e.type),e.type){case s.PlaceholderType.CenterTitle:t=s.PlaceholderType.Title;break;case s.PlaceholderType.SubTitle:case s.PlaceholderType.Chart:case s.PlaceholderType.ClipArt:case s.PlaceholderType.Diagram:case s.PlaceholderType.Media:case s.PlaceholderType.Picture:t=s.PlaceholderType.Body}return t}},{key:"phTypeFollowCommon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return this.phTypeFollowMaster(e);var r=s.PlaceholderType.Body;switch(void 0!==e.type&&(r=e.type),e.type){case s.PlaceholderType.CenterTitle:r=s.PlaceholderType.Title;break;case s.PlaceholderType.SubTitle:r=s.PlaceholderType.Body}return r}},{key:"phEqual",value:function(e,t){return e.type===t.type&&e.direction===t.direction&&e.size===t.size&&e.index===t.index}},{key:"isPhCanInsertObj",value:function(e,t){for(var r=[],n=0;n<e.length;++n){var i=e[n];if(!i.isGroupShape()&&(i.isPlaceHolder()&&!i.hasContent())){if(i.getPlaceHolder().type==t)return i;t>=s.PlaceholderType.Object&&t<=s.PlaceholderType.Picture&&(r[r.length]=i)}}return r}},{key:"adjustShapeSize",value:function(e,t){var r={},n=t.getRect(),i=e.getRect(),a=n.right-n.left,o=n.bottom-n.top,s=i.right-i.left,l=i.bottom-i.top,u=o/a,c=l/s;return s<=a&&l<=o?(r.left=n.left+(a-s)/2,r.top=n.top+(o-l)/2,r.right=r.left+s,r.bottom=r.top+l):u>c?(r.left=n.left,r.top=n.top+(o-a*c)/2,r.right=n.right,r.bottom=r.top+a*c):(r.left=n.left+(a-o/c)/2,r.top=n.top,r.right=r.left+o/c,r.bottom=n.bottom),e.visual.setAnchorRect(r)}},{key:"adjustPictureSize",value:function(e,t){if(e.isImage){var r={},n=t.getRect(),i=e.getPicture().blip.blipAtom,a=i.dpiX,o=i.dpiY,s=i.imageWidth/a*1440,l=i.imageHeight/o*1440;if(Object.assign(r,n),n.left!=n.right&&n.top!=n.bottom){var u=n.right-n.left,c=n.bottom-n.top,h=c/u,d=l/s;s<=u&&l<=c?(u=s,c=l,r.left+=(r.right-r.left-u)/2,r.right=r.left+u,r.top+=(r.bottom-r.top-c)/2,r.bottom=r.top+c):h>d?(c=u*d,r.top+=(r.bottom-r.top-c)/2,r.bottom=r.top+c):(u=c/d,r.left+=(r.right-r.left-u)/2,r.right=r.left+u),e.visual.setAnchorRect(r)}}}},{key:"adjustTableSize",value:function(e,t){for(var r=t.visual.getAnchorRect(),n=e.getTableFrame(),i=n.getColumnCount(),a=new Array(i+1),o=r.width()/i,s=0;s<=i;++s)a[s]=window.Px2Emu(s*o,1);n.visual.setVertBorderPosV(a)}},{key:"adjustChartSize",value:function(e,t){var r=t.getRect();e.visual.setAnchorRect(r)}},{key:"syncLayoutPlaceholderProps",value:function(e,t){var r={type:t.type,index:t.index,size:t.size,direction:t.direction};e.setPlaceholder(r)}},{key:"syncPhShapeData2PicShape",value:function(t,r){e.syncLayoutPlaceholderProps(r,t.getPlaceHolder());var n=t.getTransform2D();n&&r.setTransform2D(n);var i=t.getFill();i&&r.setFill(i);var a=t.getOutline();a&&r.setOutline(a);var o=t.getEffects();o&&r.setEffects(o);var s=t.getScen3D();s&&r.setScene3D(s);var l=t.setShape3D();l&&r.setShape3D(l)}},{key:"isFakeTextFramePh",value:function(e){if(e.isGroupShape())return!1;if(e.isInk())return!1;if(!e.isPlaceHolder())return!1;var t=e.getPlaceHolder().type;return t===s.PlaceholderType.Chart&&t===s.PlaceholderType.Table&&t===s.PlaceholderType.ClipArt&&t===s.PlaceholderType.Diagram&&t===s.PlaceholderType.Media&&t===s.PlaceholderType.Picture}},{key:"getPlaceholders",value:function(t){for(var r=t.getSpTree(),n=[],i=0;i<r.childShapes.length;i++){var a=r.childShapes[i].getPlaceHolder();!Object.isEmpty(a)&&e.isValidType(a.type,t.isLayoutSlide)&&n.push(a)}return n}}]),e}();t.a=u},763:function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return v}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(2002),l=r(606),u=r(360),c=r(2247);function h(e){return(e%=360)<0&&(e+=360),e}function d(e){var t=e>=0?1:-1;return Math.floor(Math.abs(e)+.5)*t}function p(e){if(!e||0===e.length)return{left:0,right:0,top:0,bottom:0};for(var t=l.a.create(e[0]),r=1;r<e.length;r++)t.unite(l.a.create(e[r]));return t.getAlignedBounds()}var f={TRANSFORM_NONE:0,TRANSFORM_TRANSLATE:1,TRANSFORM_ROTATION:2,TRANSFORM_FLIP:4,TRANSFORM_ALL:7},v=function(){function e(t){i()(this,e),this._coredata=t}return o()(e,[{key:"getParent",value:function(){var e=this._coredata.parent;return e?e.visual:null}},{key:"isBackground",value:function(){return!1}},{key:"getSlideVisual",value:function(){for(var e=this._coredata,t=null;e;){if(e.isSlideType){t=e;break}e=e.getParent?e.getParent():e.parent}return t?t.visual:null}},{key:"getPresentaion",value:function(){return window.APP&&window.APP.presentation}},{key:"getTheme",value:function(){var e=this.getSlideVisual();return e&&e.coredata?c.a.getInstance(e.coredata):null}},{key:"isIndividual",value:function(){var e=this._coredata;if(e.isSlideType)return!0;if(e.isShape){if(e.isBackground&&e.isBackground())return!0;var t=e.getParent();return t&&t.isGroupShape&&t.isGroupShape()}return!1}},{key:"getIndividualVisual",value:function(){for(var e=this;e;){if(e.isIndividual())return e;e=e.getParent()}return e}},{key:"geometryTransform",value:function(){return{x:0,y:0,width:1,height:1,horizontalFlipped:!1,verticalFlipped:!1,rotation:0}}},{key:"_rect",value:function(){var e=this.geometryTransform();return Object.assign(e,{x:0,y:0}),0===e.width&&(e.width=1),0===e.height&&(e.height=1),e}},{key:"isLayerVisual",value:function(){return!(!this._coredata||!this._coredata.private.layer)}},{key:"_calcTransformMatrix",value:function(e,t,r,n,i,a,o){return o&f.TRANSFORM_TRANSLATE&&t&&e.translate(t.x,t.y),o&f.TRANSFORM_ROTATION&&(Object(u.l)(n)||(e.translate(r.x,r.y),e.rotate(n),e.translate(-r.x,-r.y))),o&f.TRANSFORM_FLIP&&(i||a)&&(e.translate(r.x,r.y),e.scale(i?-1:1,a?-1:1),e.translate(-r.x,-r.y)),e}},{key:"calcFlipRotatedTransform",value:function(e,t,r,n){return this._calcTransformMatrix(new window.QTransform,null,e,t,r,n,f.TRANSFORM_ROTATION|f.TRANSFORM_FLIP)}},{key:"transform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.TRANSFORM_ALL,t=this.geometryTransform();return this._calcTransformMatrix(new window.QTransform,t,{x:t.width/2,y:t.height/2},t.rotation,t.horizontalFlipped,t.verticalFlipped,e)}},{key:"currentRectToLayerRect",value:function(e){var t={x:e.x+e.width/2,y:e.y+e.height/2},r=this.calcTransFromCurrent2Layer(),n=(r=s.a.multiply(this.transform().inverted({}),r)).Map(t);return{x:n.x-e.width/2,y:n.y-e.height/2,width:e.width,height:e.height}}},{key:"layerRectToCurrentRect",value:function(e){var t={x:e.x+e.width/2,y:e.y+e.height/2},r=this.calcTransFromCurrent2Layer().inverted({}).Map(t);return{x:(r=this.transform().Map(r)).x-e.width/2,y:r.y-e.height/2,width:e.width,height:e.height}}},{key:"calcTransFromCurrent2Layer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.TRANSFORM_ALL,t=this.getParent();return this.isLayerVisual()||!t?new window.QTransform:s.a.multiply(this.transform(),t.calcTransFromCurrent2Layer(e))}},{key:"isSwapWidthAndHeight",value:function(e){return(e=h(e))>=45&&e<135||e>=225&&e<315}},{key:"calcShapePosData",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(0!=t&&0!=r){var a={x:e.x+e.width/2,y:e.y+e.height/2};a.x*=t,a.y*=r;var o=e.width,s=e.height;this.isSwapWidthAndHeight(n)?(o*=r,s*=t):(o*=t,s*=r),e={x:a.x-o/2,y:a.y-s/2,width:o,height:s}}return i&&(e={x:d(e.x),y:d(e.y),width:d(e.width),height:d(e.height)}),e}},{key:"caleMaxBound",value:function(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}}},{key:"coredata",get:function(){return this._coredata}}]),e}()},764:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(25),l=r.n(s),u=r(42),c=r.n(u),h=r(201),d=function(e){function t(e){i()(this,t);var r=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.private=e.data,r}return c()(t,e),o()(t,[{key:"buildTree",value:function(e){this.parent=e}},{key:"getType",value:function(){return this.private.type}},{key:"data",value:function(){return this.private}},{key:"getAnimTarget",value:function(){return null}},{key:"getAttrName",value:function(){return this.private.property?this.private.property:this.private.attr}},{key:"getBehaviorType",value:function(){return this.private.type}},{key:"isExplainBehavior",get:function(){var e=this.private.behaviorType||this.private.nodeType,t=this.private.command;return e===h.AnimNodeType.Command&&"webwpp_explain"===t}}]),t}(r(1260).b)},765:function(e,t,r){"use strict";r.r(t),r.d(t,"postComment",(function(){return i})),r.d(t,"postWXVoiceComment",(function(){return a})),r.d(t,"getComments",(function(){return o})),r.d(t,"getAudio",(function(){return s}));var n=r(379),i=function(e){var t=e.fileid,r=e.file,i=e.replyId,a=e.duration,o=e.timeout,s=e.text,l=e.broadcast;o=o||3e4;var u={type:"text"};return r?(o=18e4,u.type="voice"):(i&&(u.p_comment_id=i),a&&(u.duration=a),s&&(u.text=s)),{types:n.a.HTTP_TYPES,autoErrorToast:!1,callAPI:function(e){var n="/api/v3/office/file/"+t+"/comment";!1===l&&(n+="?broadcast=false");var i=e.post(n);return r&&i.attach("file",r),i.fields(u),i.timeout(o).end()}}},a=function(e){var t=e.fileid,r=e.duration,i=e.serverId,a=e.replyId,o=e.text,s={type:"voice"};return r&&(s.duration=r),i&&(s.wx_media_id=i),a&&(s.p_comment_id=a),o&&(s.text=o),{types:n.a.HTTP_TYPES,autoErrorToast:!1,callAPI:function(e){var r="/api/v3/office/file/"+t+"/comment",n=e.post(r);return n.fields(s),n.timeout(6e4),n.end()}}},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.join(",");return{types:n.a.HTTP_TYPES,callAPI:function(e){return e.get("/api/v3/office/file/"+window.urlFileId+"/comment").query({cids:r}).timeout(6e4).end()}}},s=function(e){return{types:n.a.HTTP_TYPES,callAPI:function(t){return t.get(e).responseType("arraybuffer").end()}}}},808:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(360),l=function(){function e(t,r){i()(this,e),this.setPoint(t,r)}return o()(e,[{key:"clone",value:function(){return new e(this._x,this._y)}},{key:"x",value:function(){return this._x}},{key:"y",value:function(){return this._y}},{key:"setX",value:function(e){this._x=e}},{key:"setY",value:function(e){this._y=e}},{key:"setPoint",value:function(e,t){return this._x=e||0,this._y=t||0,this}},{key:"assign",value:function(e){return this._x=e._x,this._y=e._y,this}},{key:"setFromPoint",value:function(t){t instanceof e?(this._x=t.x(),this._y=t.y()):console.error(t+" is no instanceof Point")}},{key:"toPoint",value:function(){return new e(Math.round(this._x),Math.round(this._y))}},{key:"isNull",value:function(){return Object(s.m)(this._y)&&Object(s.m)(this._y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x())+Math.abs(this.y())}},{key:"rotationAt",value:function(t,r){if(r&&0!==r&&360!==r){var n=Math.PI*r/180;return new e((this.x()-t.x())*Math.cos(n)-(this.y()-t.y())*Math.sin(n)+t.x(),(this.x()-t.x())*Math.sin(n)+(this.y()-t.y())*Math.cos(n)+t.y())}return new e(this.x(),this.y())}},{key:"isEquals",value:function(t){if(t instanceof e)return Object(s.l)(this.x()-t.x())&&Object(s.l)(this.y()-t.y());throw new Error(this+","+t+" is not Point")}},{key:"addition",value:function(t){return e["+"](this,t)}},{key:"subtracter",value:function(t){return e["-"](this,t)}},{key:"multiply",value:function(t){return e["*"](t,this)}},{key:"division",value:function(t){return e["*"](this,t)}},{key:"isQPoint",get:function(){return!0}}],[{key:"+",value:function(t,r){if(t instanceof e&&r instanceof e)return new e(t.x()+r.x(),t.y()+r.y());throw new Error(t+","+r+" is not Point")}},{key:"-",value:function(t,r){if(t instanceof e&&r instanceof e)return new e(t.x()-r.x(),t.y()-r.y());throw new Error(t+","+r+" is not Point")}},{key:"*",value:function(t,r){if(r instanceof e&&"number"==typeof t)return new e(r.x()*t,r.y()*t);if(t instanceof e&&"number"==typeof r)return new e(t.x()*r,t.y()*r);throw new Error(r+" is not Point")}},{key:"==",value:function(t,r){if(t instanceof e&&r instanceof e)return Object(s.l)(t.x()-r.x())&&Object(s.l)(t.y()-r.y());throw new Error(t+","+r+" is not Point")}},{key:"/",value:function(t,r){if(t instanceof e&&"number"==typeof r)return new e(t.x()/r,t.y()/r);throw new Error(t+" is not Point")}}]),e}();window.Point=l},809:function(e,t,r){"use strict";r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"c",(function(){return f}));var n,i=r(150),a=r.n(i),o=r(158),s=r(874),l={CS_AutoNumGrayColor:4290822336,CS_TextNoShowColor:4278190080,DEFAULTINDENT:720,DEFAULTTAB:1440,CS_TextDefaultColor:524289,TEXT_MAX_TABSTOPS:20,TextRenderingHintAntiAlias:360,MAX_WORDS:80,DEFAULT_BULLETCHAR:8226,CS_TextShadowGrayColor:13026246,FontSize:360,FONT_MIN_SCALE:.25,FONT_MAX_SCALE:1,FONT_SCALE_ONE_STEP:.05,FontFamily:"",AsciiFont:"Arial",TextColor:null},u=s.c,c=s.b,h={FontSize:280,FontFamily:"",FontColor:"#383838",LineSpacing:{rule:"auto",value:126},anchorType:o.TextAnchoringType.Top,alignMode:o.HorzAlignMode.Adjustify,autoFit:o.AutoFit.None},d={Return:"\n",EndLine:"\v",EndPara:"\r",EndCell:"",EndSection:"\f",EndPage:"",EndColumn:"",Footnote:"",Comment:"",Drawing:"\b",Embed:"",Tab:"\t",Space:" ",FieldBegin:"",FieldSep:"",FieldEnd:"",TextSymbol:"(",ContentNodeBegin:"<",ContentNodeEnd:">",ControlBegin:"",ControlEnd:"",MathFunction:"",MathArgEnd:""},p={61548:108,61550:110,61557:117,61552:112,61692:252,61656:216},f=(n={},a()(n,o.PlaceholderType.Title,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Title", "")),a()(n,o.PlaceholderType.CenterTitle,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Title", "")||_i18n("applications.presentation.constants.textDefine.PlaceholderType.CenterTitle", "")),a()(n,o.PlaceholderType.SubTitle,_i18n("applications.presentation.constants.textDefine.PlaceholderType.SubTitle", "")),a()(n,o.PlaceholderType.Body,_i18n("applications.presentation.constants.textDefine.PlaceholderType.Body", "")),a()(n,o.PlaceholderType.Footer,_i18n("applications.presentation.constants.textDefine.PlaceholderType.footer", "")),a()(n,"other",_i18n("applications.presentation.constants.textDefine.PlaceholderType.other", "")),a()(n,"noteTitle",_i18n("applications.presentation.constants.textDefine.PlaceholderType.noteTitle", "")),a()(n,"editMaster",_i18n("applications.presentation.constants.textDefine.PlaceholderType.editMaster", "")),a()(n,"style",_i18n("applications.presentation.constants.textDefine.PlaceholderType.style", "")),a()(n,"add",_i18n("applications.presentation.constants.textDefine.PlaceholderType.add", "")),n)},873:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={"zh-MO_radstr":{script:"Hant",type:2},"zh-TW_pronun":{script:"Hant",type:2},"zh-MO_stroke":{script:"Hant",type:2},"de-DE_phoneb":{script:"Latn",type:0},"tzm-Latn":{script:"Latn",type:0},"sd-Arab":{script:"Arab",type:1},"mn-Mong":{script:"Mong",type:1},"tg-Cyrl":{script:"Cyrl",type:0},"tzm-Tfng":{script:"Tfng",type:0},"az-Cyrl":{script:"Cyrl",type:0},"bs-Cyrl":{script:"Cyrl",type:0},"es-CU":{script:"Latn",type:0},"es-US":{script:"Latn",type:0},"es-NI":{script:"Latn",type:0},"sr-Latn":{script:"Latn",type:0},"es-HN":{script:"Latn",type:0},"en-SG":{script:"Latn",type:0},"es-SV":{script:"Latn",type:0},"en-MY":{script:"Latn",type:0},"es-BO":{script:"Latn",type:0},"ar-QA":{script:"Arab",type:1},"en-IN":{script:"Latn",type:0},"fr-HT":{script:"Latn",type:0},"ar-AE":{script:"Arab",type:1},"es-CL":{script:"Latn",type:0},"uz-Cyrl":{script:"Cyrl",type:0},"sr-Cyrl-ME":{script:"Cyrl",type:0},"ar-LB":{script:"Arab",type:1},"sr-Latn-ME":{script:"Latn",type:0},"en-TT":{script:"Latn",type:0},"ar-JO":{script:"Arab",type:1},"sr-Cyrl-RS":{script:"Cyrl",type:0},"fr-SN":{script:"Latn",type:0},"es-PE":{script:"Latn",type:0},"uz-Latn":{script:"Latn",type:0},"fr-CI":{script:"Latn",type:0},"smn-FI":{script:"Latn",type:0},"sr-Latn-RS":{script:"Latn",type:0},"fr-CD":{script:"Latn",type:0},"en-029":{script:"Latn",type:0},"es-EC":{script:"Latn",type:0},"ar-YE":{script:"Arab",type:1},"bs-Cyrl-BA":{script:"Cyrl",type:0},"fr-RE":{script:"Latn",type:0},"es-VE":{script:"Latn",type:0},"en-JM":{script:"Latn",type:0},"ka-GE_modern":{script:"Geor",type:0},"ar-OM":{script:"Arab",type:1},"fr-029":{script:"Latn",type:0},"es-DO":{script:"Latn",type:0},"en-ZA":{script:"Latn",type:0},"ar-TN":{script:"Arab",type:1},"fr-MC":{script:"Latn",type:0},"ar-MA":{script:"Arab",type:1},"fr-LU":{script:"Latn",type:0},"fr-ML":{script:"Latn",type:0},"uk-UA":{script:"Cyrl",type:0},"yi-001":{script:"Hebr",type:1},"de-LI":{script:"Latn",type:0},"zh-MO":{script:"Hant",type:2},"smj-NO":{script:"Latn",type:0},"en-CA":{script:"Latn",type:0},"ar-LY":{script:"Arab",type:1},"sd-Arab-PK":{script:"Arab",type:1},"quz-PE":{script:"Latn",type:0},"se-FI":{script:"Latn",type:0},"fy-NL":{script:"Latn",type:0},"fr-CA":{script:"Latn",type:0},bs:{script:"Latn",type:0},"en-AU":{script:"Latn",type:0},"rw-RW":{script:"Latn",type:0},"ar-EG":{script:"Arab",type:1},"es-PY":{script:"Latn",type:0},"ti-ER":{script:"Ethi",type:0},"ti-ET":{script:"Ethi",type:0},"quz-EC":{script:"Latn",type:0},"ff-Latn-SN":{script:"Latn",type:0},"ne-IN":{script:"Deva",type:1},"en-BZ":{script:"Latn",type:0},"es-ES":{script:"Latn",type:0},"smj-SE":{script:"Latn",type:0},"sr-Latn-BA":{script:"Latn",type:0},"es-CR":{script:"Latn",type:0},"tzm-Latn-DZ":{script:"Latn",type:0},"bn-BD":{script:"Beng",type:1},"az-Cyrl-AZ":{script:"Cyrl",type:0},"ur-IN":{script:"Arab",type:1},"ig-NG":{script:"Latn",type:0},"ru-MD":{script:"Cyrl",type:0},"ro-MD":{script:"Latn",type:0},"nn-NO":{script:"Latn",type:0},"nl-BE":{script:"Latn",type:0},"it-CH":{script:"Latn",type:0},"es-MX":{script:"Latn",type:0},"en-GB":{script:"Latn",type:0},"fr-CM":{script:"Latn",type:0},"ar-SY":{script:"Arab",type:1},"fr-BE":{script:"Latn",type:0},"ca-ES-valencia":{script:"Latn",type:0},"zh-HK":{script:"Hant",type:2},"ku-Arab-IQ":{script:"Arab",type:1},"sah-RU":{script:"Cyrl",type:0},"gsw-FR":{script:"Latn",type:0},"co-FR":{script:"Latn",type:0},"oc-FR":{script:"Latn",type:0},"br-FR":{script:"Latn",type:0},"ta-IN":{script:"Taml",type:1},"so-SO":{script:"Latn",type:0},"ar-DZ":{script:"Arab",type:1},"fr-CH":{script:"Latn",type:0},"moh-CA":{script:"Latn",type:0},"ii-CN":{script:"Yiii",type:2},"uz-Cyrl-UZ":{script:"Cyrl",type:0},"dz-BT":{script:"Tibt",type:1},"hsb-DE":{script:"Latn",type:0},"haw-US":{script:"Latn",type:0},"om-ET":{script:"Latn",type:0},"zh-CN":{script:"Hans",type:2},"pap-029":{script:"Latn",type:0},"tn-ZA":{script:"Latn",type:0},"kl-GL":{script:"Latn",type:0},"lb-LU":{script:"Latn",type:0},"sms-FI":{script:"Latn",type:0},"ba-RU":{script:"Cyrl",type:0},"az-Latn":{script:"Latn",type:0},"kr-NG":{script:"Latn",type:0},"nso-ZA":{script:"Latn",type:0},"quz-BO":{script:"Latn",type:0},"ar-BH":{script:"Arab",type:1},"mn-Mong-MN":{script:"Mong",type:1},"bin-NG":{script:"Latn",type:0},"yo-NG":{script:"Latn",type:0},"zh-CN_phoneb":{script:"Hans",type:2},"en-PH":{script:"Latn",type:0},"ha-Latn-NG":{script:"Latn",type:0},"en-ZW":{script:"Latn",type:0},"ff-NG":{script:"Latn",type:0},"ibb-NG":{script:"Latn",type:0},"dv-MV":{script:"Thaa",type:1},"en-IE":{script:"Latn",type:0},"ps-AF":{script:"Arab",type:1},"dsb-DE":{script:"Latn",type:0},"iu-Latn-CA":{script:"Latn",type:0},"ks-Arab":{script:"Arab",type:1},"as-IN":{script:"Beng",type:1},"ta-LK":{script:"Taml",type:1},"nl-NL":{script:"Latn",type:0},"si-LK":{script:"Sinh",type:1},"arn-CL":{script:"Latn",type:0},"ar-SA":{script:"Arab",type:1},"af-ZA":{script:"Latn",type:0},"sd-Deva-IN":{script:"Deva",type:1},"th-TH":{script:"Thai",type:1},"my-MM":{script:"Mymr",type:1},"es-CO":{script:"Latn",type:0},"sma-NO":{script:"Latn",type:0},"ar-IQ":{script:"Arab",type:1},"km-KH":{script:"Khmr",type:1},"sr-Cyrl":{script:"Cyrl",type:0},"bo-CN":{script:"Tibt",type:1},"ml-IN":{script:"Mlym",type:1},"quc-Latn":{script:"Latn",type:0},"rm-CH":{script:"Latn",type:0},"ur-PK":{script:"Arab",type:1},"gu-IN":{script:"Gujr",type:1},"pa-Arab-PK":{script:"Arab",type:1},"en-US":{script:"Latn",type:0},"uz-Latn-UZ":{script:"Latn",type:0},"ky-KG":{script:"Cyrl",type:0},"en-NZ":{script:"Latn",type:0},"mn-MN":{script:"Cyrl",type:0},"en-HK":{script:"Latn",type:0},"tt-RU":{script:"Cyrl",type:0},"mn-Mong-CN":{script:"Mong",type:1},"ja-JP_radstr":{script:"Jpan",type:2},"ve-ZA":{script:"Latn",type:0},"kk-KZ":{script:"Cyrl",type:0},"ms-MY":{script:"Latn",type:0},"cs-CZ":{script:"Latn",type:0},"zh-CN_stroke":{script:"Hans",type:2},"lo-LA":{script:"Laoo",type:1},"es-AR":{script:"Latn",type:0},"se-NO":{script:"Latn",type:0},"de-CH":{script:"Latn",type:0},"mn-Cyrl":{script:"Cyrl",type:0},"mk-MK":{script:"Cyrl",type:0},"mt-MT":{script:"Latn",type:0},"syr-SY":{script:"Syrc",type:1},"quc-Latn-GT":{script:"Latn",type:0},"id-ID":{script:"Latn",type:0},"ka-GE":{script:"Geor",type:0},"zh-SG":{script:"Hans",type:2},"prs-AF":{script:"Arab",type:1},"zu-ZA":{script:"Latn",type:0},"wo-SN":{script:"Latn",type:0},"hu-HU":{script:"Latn",type:0},"st-ZA":{script:"Latn",type:0},"ms-BN":{script:"Latn",type:0},"mr-IN":{script:"Deva",type:1},"se-SE":{script:"Latn",type:0},"pt-PT":{script:"Latn",type:0},"ts-ZA":{script:"Latn",type:0},"es-ES_tradnl":{script:"Latn",type:0},"or-IN":{script:"Orya",type:1},"es-GT":{script:"Latn",type:0},"ga-IE":{script:"Latn",type:0},"fi-FI":{script:"Latn",type:0},"sv-FI":{script:"Latn",type:0},"eu-ES":{script:"Latn",type:0},"te-IN":{script:"Telu",type:1},"lt-LT":{script:"Latn",type:0},"en-ID":{script:"Latn",type:0},"fr-FR":{script:"Latn",type:0},"ne-NP":{script:"Deva",type:1},"mni-IN":{script:"Beng",type:1},"el-GR":{script:"Grek",type:0},"zh-SG_stroke":{script:"Hans",type:2},"et-EE":{script:"Latn",type:0},"zh-HK_radstr":{script:"Hant",type:2},"gd-GB":{script:"Latn",type:0},"am-ET":{script:"Ethi",type:0},"xh-ZA":{script:"Latn",type:0},"bg-BG":{script:"Cyrl",type:0},"he-IL":{script:"Hebr",type:1},"lv-LV":{script:"Latn",type:0},"tk-TM":{script:"Latn",type:0},"es-PR":{script:"Latn",type:0},"zh-TW":{script:"Hant",type:2},"tr-TR":{script:"Latn",type:0},"ar-KW":{script:"Arab",type:1},"sr-Cyrl-BA":{script:"Cyrl",type:0},"ko-KR":{script:"Hang",type:2},"zh-SG_phoneb":{script:"Hans",type:2},"vi-VN":{script:"Viet",type:0},"sv-SE":{script:"Latn",type:0},"tzm-Arab-MA":{script:"Arab",type:1},"pa-IN":{script:"Guru",type:1},"kn-IN":{script:"Knda",type:1},"sq-AL":{script:"Latn",type:0},"de-AT":{script:"Latn",type:0},"fr-MA":{script:"Latn",type:0},"ks-Deva-IN":{script:"Deva",type:1},"es-UY":{script:"Latn",type:0},"es-PA":{script:"Latn",type:0},"hr-HR":{script:"Latn",type:0},"fa-IR":{script:"Arab",type:1},"be-BY":{script:"Cyrl",type:0},"tg-Cyrl-TJ":{script:"Cyrl",type:0},"sk-SK":{script:"Latn",type:0},"es-419":{script:"Latn",type:0},"sw-KE":{script:"Latn",type:0},"hr-BA":{script:"Latn",type:0},"fo-FO":{script:"Latn",type:0},"ru-RU":{script:"Cyrl",type:0},"az-Latn-AZ":{script:"Latn",type:0},"sl-SI":{script:"Latn",type:0},"is-IS":{script:"Latn",type:0},"ro-RO":{script:"Latn",type:0},"gl-ES":{script:"Latn",type:0},"tn-BW":{script:"Latn",type:0},"fil-PH":{script:"Latn",type:0},"zh-TW_radstr":{script:"Hant",type:2},"pt-BR":{script:"Latn",type:0},"bs-Latn":{script:"Latn",type:0},"kok-IN":{script:"Deva",type:1},"hy-AM":{script:"Armn",type:0},"ja-JP":{script:"Jpan",type:2},"hu-HU_technl":{script:"Latn",type:0},"nb-NO":{script:"Latn",type:0},"it-IT":{script:"Latn",type:0},"cy-GB":{script:"Latn",type:0},"iu-Cans-CA":{script:"Cans",type:0},"sma-SE":{script:"Latn",type:0},"sa-IN":{script:"Deva",type:1},"mi-NZ":{script:"Latn",type:0},"ks-Deva":{script:"Deva",type:1},"pl-PL":{script:"Latn",type:0},"bs-Latn-BA":{script:"Latn",type:0},"tzm-Tfng-MA":{script:"Tfng",type:0},"de-DE":{script:"Latn",type:0},"hi-IN":{script:"Deva",type:1},yi:{script:"Hebr",type:1},"la-001":{script:"Latn",type:0},"chr-Cher-US":{script:"Cher",type:0},"gn-PY":{script:"Latn",type:0},"ca-ES":{script:"Latn",type:0},"ku-Arab":{script:"Arab",type:1},"de-LU":{script:"Latn",type:0},"da-DK":{script:"Latn",type:0},"bn-IN":{script:"Beng",type:1}}},874:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return o}));var n={TextWrapNone:0,TextWrapSquare:1},i={NoAutoFit:0,NormalAutoFit:1,AdvancedAutoFit:2},a={LLetterWithDot:0,ULetterWithDot:1,ArabicWithRBracket:2,ArabicWithDot:3,LRomaWithLRBracket:4,LRomaWithRBracket:5,LRomaWithDot:6,URomaWithDot:7,LLetterWithLRBracket:8,LLetterWithRBracket:9,ULetterWithLRBracket:10,ULetterWithRBracket:11,ArabicWithLRBracket:12,Arabic:13,URomaWithLRBracket:14,URomaWithRBracket:15,LocalChar:16,LocalCharWithDot:17,ArabicWithRound:18,ArabicWithWhiteRound:19,ArabicWithBlackRound:20,LChineseB5:21,LChineseB5WithDot:22,ArabicChar:23,LChineseGB:24,LChineseGBWithDot:25,ArabicDbWidthDBDot:26,ArabicDb:27,HindiAlpha1WithDot:28,HindiAlphaWithDot:29,HindiNumRBracket:30,HindiNumWithDot:31,Hebrew:32,Arabic1:33,Arabic2:34,Ea1JpnKor:35,Ea1JpnKorWithDot:36,Ea1JpnChsWithDbDot:38,ThaiAlphaLRBracket:39,ThaiAlphaRBracket:40,ThaiAlphaWithDot:41,ThaiNumLRBracket:42,ThaiNumRBracket:43,ThaiNumWithDot:44},o={None:0,Bullet:1,AutoNum:2,Image:3}},875:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(315),i=r(262);function a(e){e._bubbleUpEvent||(e._bubbleUpEvent=function(t,r){i.default.isModifyEvent(t)&&(r.data===e?e.data_token=Object(n.a)():e.tree_token=Object(n.a)());var a=e.parent;r.parent=a,a&&a._bubbleUpEvent&&a._bubbleUpEvent(t,r)})}},926:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=0,l={SLOW:1e3,MEDIUM:750,FAST:500},u=function(){function e(t){i()(this,e),this.data=t}return o()(e,[{key:"getType",value:function(){return this.data.type||s}},{key:"hasAnimation",value:function(){return s!==this.getType()}},{key:"hasSound",value:function(){return!1}},{key:"isEmpty",value:function(){return!this.hasAnimation()&&!this.hasSound()}},{key:"getDuration",value:function(){return this.data.duration?this.data.duration:this.data.speed?l[this.data.speed.toUpperCase()]:void 0}},{key:"getAdvanceOnClick",value:function(){return this.data.advanceOnClick}},{key:"getAdvanceTime",value:function(){return this.data.advanceTime}}]),e}(),c=r(315),h=r(2246),d=r(446),p=r(304),f=r(25),v=r.n(f),y=r(42),g=r.n(y),m=r(763),_=r(2247),S=function(e){function t(e){return i()(this,t),v()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return g()(t,e),o()(t,[{key:"getThemeAgent",value:function(){return _.a.getInstance(this.coredata)}},{key:"getFollowing",value:function(){var e=this._coredata,t=e&&e.getFollowing();return t&&t.visual}},{key:"isLayerVisual",value:function(){return!0}},{key:"getBackgroundShape",value:function(){var e=this._coredata,t=e&&e.getBackground();if(!t){var r=this.getFollowing();t=r&&r.getBackgroundShape()}return t}},{key:"getBackgroundVisual",value:function(){var e=this.getBackgroundShape();return e&&e.visual}},{key:"geometryTransform",value:function(){var e=window.APP.presentation,t=1,r=1,n=this.coredata;return n.isNormalSlide||n.isLayoutSlide||n.isMasterSlide?(t=e.private.slideSize.width,r=e.private.slideSize.height):(n.isNotesPage||n.isNotesMaster)&&(t=e.private.notesSize.width,r=e.private.notesSize.height),{x:0,y:0,width:t,height:r,horizontalFlipped:!1,verticalFlipped:!1,rotation:0}}},{key:"getTextStyle",value:function(e){var t=this.coredata.getMasterSlide(),r=t&&t.getStyle(),n=t&&t.data_token,i=(r&&r.private||[])[e]||{};return{styleToken:n||"",style:i,styles:[i]}}},{key:"setBackgroundProperties",value:function(e){var t=this._coredata,r=null;if(e._REMOVE&&t.isMasterSlide&&(e={props:{fill:{type:0}}}),e._REMOVE)t.modifyProperties({background:null})&&(r={background:{_REMOVE:!0}});else{t.getBackground()||t.createBackground(window.APP.presentation);var n=t.modifyBackgroundProperties(e.props);n&&(r={background:{props:n.newval}})}return r}}]),t}(m.a),T=r(461),b=r(262),k=r(1013),C=r(1383),w=function(){function e(t,r){var n=this;i()(this,e),this.layerType=t,this.private=r.data,this.data_token=Object(c.a)(),this.tree_token=this.data_token,this.listener.on("onForward",(function(e){return n.__onForward(e)})),this.listener.on("onBackward",(function(e){return n.__onBackward(e)})),this.listenPropertyChanged(["background","timing"],(function(e,t,r){n._onPropertyChanged(e,t,r)})),this._visual=new S(this)}return o()(e,[{key:"_baseData",value:function(){return this.private.baseData}},{key:"getCategory",value:function(){return this.category?this.category:this.parent?(this.category=this.parent.getCategory(),this.category):void 0}},{key:"getLayerType",value:function(){return this.layerType}},{key:"getDiagramGroup",value:function(){return C.a.getDiagramGroup(this)}},{key:"_getModifyEventType",value:function(){var e=null;switch(this.getCategory()){case"slides":e=b.default.modify_slide;break;case"slideLayouts":e=b.default.modify_layout;break;case"slideMasters":e=b.default.modify_master;break;case"notes":e=b.default.modify_notespage}return e}},{key:"_bubbleUpEvent",value:function(e,t){b.default.isModifyEvent(e)&&(t.data===this?this.data_token=Object(c.a)():this.tree_token=Object(c.a)());var r=this.parent,n=this.getCategory(),i=this.getLayerType(),a=this.getId();e===b.default.collect_path?t.topSlide={category:n,layerType:i,slideId:a}:(t.slideId=a,t.category=n,t.layerType=i),r&&r._bubbleUpEvent&&r._bubbleUpEvent(e,t),e===b.default.collect_path&&(t.slideId=a,t.category=n,t.layerType=i)}},{key:"_fireChanged",value:function(e){if(e&&e.isForward&&e.data instanceof Array){for(var t=!1,r=0;r<e.data.length;r++){var n=e.data[r];if("modifySlideProps"===n.name)for(var i=n.param.records,a=i?i.length:0,o=0;o<a;o++){var s=i[o];"transitionRecord"===(s&&s.recordType)&&(t=!0)}}t&&this._fireChangedInner()}else this._fireChangedInner()}},{key:"_fireChangedInner",value:function(e){var t=e&&e.origin,r=e&&e.flags,n=this._getModifyEventType();n?this._bubbleUpEvent(n,{data:this,optype:b.default.op_modify,origin:t,flags:r}):console.error("Unsupported modify core data:",this.getCategory())}},{key:"_fireFollowedSlidesChanged",value:function(e){if(this.isLayoutSlide||this.isMasterSlide){var t=this,r=this.isMasterSlide;if(t._hasNotified)return;t._hasNotified=!0;var n=function(){for(var n=r?window.APP.presentation.getLayouts():window.APP.presentation.getSlides(),i=n.length(),a=0;a<i;a++){var o=n.getSlideAt(a);o.getFollowing()==t&&o._fireChangedInner({origin:e})}delete t._hasNotified};window.APP.isDoingCmdResponse?window.APP.addCmdResponseEndCallback(n):n()}}},{key:"getMasterSlide",value:function(){return this.getFollowing()}},{key:"getId",value:function(){return this.private.slideId}},{key:"getDataToken",value:function(){return this.data_token}},{key:"getTreeToken",value:function(){return this.tree_token}},{key:"getChildCount",value:function(){var e=this.private.childs;return e?e.length:0}},{key:"getChildAt",value:function(e){return this.private.childs[e]}},{key:"getPresentation",value:function(){if(window.APP&&window.APP.presentation&&window.APP.presentation.is_presentation)return window.APP.presentation;for(var e=this.parent;e&&!e.is_presentation;)e=e.parent;return e}},{key:"getSpTree",value:function(){return this.private.shapeTree}},{key:"getShapeTree",value:function(){return this.getSpTree()}},{key:"getShapeAt",value:function(e){var t=this.private.shapeTree;return t?t.getChildAt(e):null}},{key:"getShapeCount",value:function(){var e=this.private.shapeTree;return e?e.private.childs.length:0}},{key:"getShapeById",value:function(e){var t=this.private.shapeTree;return t?t.getChildById(e):null}},{key:"findShapeById",value:function(e){var t=this.private.shapeTree;return t?t.findShapeById(e):null}},{key:"getShapeIdxById",value:function(e){var t=this.private.shapeTree;return t?t.getChildIdxById(e):-1}},{key:"getFollowing",value:function(){return this.private.following}},{key:"_syncFollowing",value:function(){var e=this.getFollowId(),t=this.private.following;if((t?t.getId():-1)!==e){var r=this.getPresentation();if(r){var n=r.getFollowingCategory(this.category),i=r.getContainerByCategory(n);if(i){var a=i.getSlideById(e);a&&(this.private.following=a)}}}}},{key:"setFollowing",value:function(e){var t=this._baseData();t&&t.setFollowId(e)}},{key:"getMaster",value:function(){for(var e=this.getFollowing();e;){var t=e.getFollowing();if(!t)break;e=t}return e}},{key:"getBackground",value:function(){return this.private.background}},{key:"getThemeOverride",value:function(){var e=this._baseData();return e&&e.getThemeOverride()}},{key:"getColorMapping",value:function(){return this.private.colorMapping}},{key:"getTransition",value:function(){var e=this._baseData();return e?(e.private.hasOwnProperty("transition")||(e.private.transition={type:s,duration:1}),this.transition=new u(e.private.transition),this.transition):null}},{key:"getTiming",value:function(){var e=this._baseData();return e&&e.private.timing}},{key:"getName",value:function(){var e=this._baseData();return e&&e.private.name}},{key:"buildTree",value:function(e){this.parent=e;var t=this.private.shapeTree;t&&t.buildTree(this);var r=this.private.background;r&&r.setParent(this);var n=this._baseData();n&&(n.core=this,n.buildTree(this))}},{key:"matchPhShapeCommon",value:function(){return null}},{key:"matchPhShapeByFollowing",value:function(e,t){var r=this.getShapeTree();return r&&r._matchShapesFollowing(e,t,!0)}},{key:"getPhShapes",value:function(e){var t=[];if(!(e&&e.getPlaceHolder()))return t;var r=this.matchPhShapeCommon(e);r&&t.push({category:this.getCategory(),shape:r});var n=this.getFollowing();if(n){var i=n.getPhShapes(e);t=t.concat(i)}return t}},{key:"showMasterShape",value:function(){return 1==this.private.showMasterShape}},{key:"getType",value:function(){return this.private.type}},{key:"getPlaceholders",value:function(e){var t=this.private.shapeTree,r=[];if(null==e)return r;for(var n=0;n<t.childShapes.length;n++){var i=t.childShapes[n];i.private.placeholder&&i.private.placeholder.type===e&&r.push(i)}return r}},{key:"getTags",value:function(){return this.private.tags}},{key:"getHiddenStatus",value:function(){var e=this._baseData(),t=e?e.private.transition:null;return!(!t||!t.hidden)}},{key:"getFollowId",value:function(){var e=this._baseData();return e&&e.private.followId}},{key:"_onPropertyChanged",value:function(e,t,r){t&&delete t.parent,r&&("background"==e&&r.setParent(this),"timing"==e&&r.buildTree(this))}},{key:"_getOperateProperty",value:function(e){var t=e.opType;if((t==p.default.otInsert||t==p.default.otRemove)&&e.data&&e.data.isShape&&e.data.isBackground())return{background:e.data}}},{key:"__onForward",value:function(e){if(e.data instanceof Array){for(var t=!1,r=e.primary||e,n=Object.assign({},this.private),i=this.private.baseData&&Object(T.deepClone)(this.private.baseData.private.transition)||{},a=0;a<e.data.length;a++){var o=e.data[a];if("modifySlideProps"===o.name)for(var s=o.param.records,l=s?s.length:0,u=0;u<l;u++){var c=s[u];"transitionRecord"===(c&&c.recordType)&&(this.setTransition(c.transition),t=!0)}}t&&(r._backdata=n,r._transition=i)}}},{key:"__onBackward",value:function(e){if("modifySlideProps"===e.name){var t=e.primary||e;t&&t._backdata&&(this.private=Object.assign({},t._backdata),this.private.baseData&&(this.private.baseData.private.transition=t._transition))}}},{key:"setTransition",value:function(e){var t=this._baseData();if(t){var r=Object(T.deepMerge)(Object(T.deepClone)(t.transition),e);return t.modifyProperties({transition:r})}}},{key:"createBackground",value:function(e){var t=e.allocateLocalId(),r={data:{shapeId:t,shape:!0,background:!0,shadeToTitle:!1,isOle:!1,fill:{type:0},childs:[]},id:t,type:3};this.setBackground(new h.a(r))}},{key:"setBackground",value:function(e){this.private.background!=e&&this.setPropertyValue("background",e)}},{key:"modifyBackgroundProperties",value:function(e){if(e){var t=this.private.background;if(e.fill){var r=t.visual.setFill(e.fill),n=e.fill.blip;if(r&&n&&n.blipAtom){var i=n.blipAtom.imageId;"string"==typeof i&&(r.newval.newPicture=i)}return r}}}},{key:"_isBaseDataProperty",value:function(e){return["id","layoutId","followId","name","textStyle","transition","timing"].indexOf(e)>=0}},{key:"hasProperty",value:function(e){if(this._isBaseDataProperty(e)){var t=this._baseData();return t&&t.private.hasOwnProperty(e)}return this.private.hasOwnProperty(e)}},{key:"getPropertyValue",value:function(e){if(this._isBaseDataProperty(e)){var t=this._baseData();return t&&t._getPropertyValue(e)}return this._getPropertyValue(e)}},{key:"setPropertyValue",value:function(e,t){if(!this._isBaseDataProperty(e))return this._setPropertyValue(e,t);var r=this._baseData();return r?r._setPropertyValue(e,t):void 0}},{key:"getThemeData",value:function(){var e=this.getThemeOverride(),t=this.private,r=t.theme,n=t.colorMapping,i=t.following;this._themeData||((r||e)&&(this._themeData={baseStyle:Object(T.deepMergeWithConfigs)([r&&r.private.baseStyle,e],{bClone:!0,arrayMergeType:T.ArrayMergeType.DEEPMERGE})}),n&&(this._themeData||(this._themeData={}),this._themeData.colorMapping=n));var a=null;if(i&&(a=i.getThemeData()),!a&&!this._themeData)return{baseStyle:{},colorMapping:{}};var o=null;if(a&&this._themeData){var s=a.baseStyle,l=this._themeData.baseStyle;(o={}).baseStyle=s&&l?Object(T.deepMergeWithConfigs)([s,l],{bClone:!0,arrayMergeType:T.ArrayMergeType.DEEPMERGE}):s||l,o.colorMapping=this._themeData.colorMapping||a.colorMapping}else o=a||this._themeData||{};return o.baseStyle||(o.baseStyle={}),o.colorMapping||(o.colorMapping={}),o}},{key:"getTextStyles",value:function(){return this.private.baseData.getTextStyles()}},{key:"getStyle",value:function(){var e=this.getTextStyles(),t=e&&e.private;if(t){var r={};for(var n in t){var i=t[n];i&&(r[n]=i.private)}return{private:r}}}},{key:"getOutlineStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",t=arguments[1],r=this.getListStyle(e),n=r.chpStyles,i=r.paraStyles;return{chpStyle:n[t],paraStyle:i[t]}}},{key:"getListStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",t=this.getStyle();return(t=t&&t.private||[])[e]||{}}},{key:"getComments",value:function(){return null}},{key:"visual",get:function(){return this._visual}},{key:"isSlideType",get:function(){return!0}},{key:"drawingShapes",get:function(){return this._drawingShapes||(this._drawingShapes=[]),this._drawingShapes}},{key:"colorScheme",get:function(){this._colorScheme||(this._colorScheme=new k.d);var e=this.visual.getTheme(),t=e.getColorScheme(),r=this.getThemeOverride();return r&&r.colorScheme&&t.init(r.colorScheme),this._colorScheme.setColorScheme(t),this._colorScheme.setColorMapping(e.getColorMapping()),this._colorScheme.setTheme(e),this._colorScheme}},{key:"isHideAllInk",get:function(){var e=this.getPresentation();if(e){var t=this.getId(),r=e.getLocalConfigs()||{},n=r.hideAllInk,i=r.hiddenInkSlides,a=r.shownInkSlides;return n?!(a&&a.indexOf(t)>=0):!!(i&&i.indexOf(t)>=0)}return!1}}]),e}();t.a=w;Object(d.e)(w.prototype,!1)},927:function(e,t,r){"use strict";var n=r(0),i=r.n(n),a=r(3),o=r.n(a),s=r(875),l=r(167),u=r(262),c=r(624),h=r(2662),d=r(263),p=r(470),f=r(446),v=r(268),y=r(25),g=r.n(y),m=r(42),_=r.n(m),S=r(763),T=r(461),b=r(543),k=r(762),C=r(874),w=r(1714),P=function(e){function t(e){i()(this,t);var r=g()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._cache={},r}return _()(t,e),o()(t,[{key:"getTextFrameTextStyle",value:function(){var e=this.getTextFrameStyleSheets();return e&&!e.bMerged&&(e.style=Object(T.deepMergeWithConfigs)(e.styles,T.TextStyleConfig),e.bMerged=!0),e&&e.style}},{key:"getTextFrameStyleSheets",value:function(){var e=[this.coredata],t=this.getIndividualVisual();if(t){var r=t.getRootShape();if(r&&r.isPlaceHolder()&&k.a.isTextShape(r)){var n=r.getSlide(),i=n&&n.getFollowing();if(i)for(var a=i.getPhShapes(r),o=0;o<a.length;o++){var s=a[o].shape.getTextFrame();s&&e.splice(0,0,s)}}}return this._updateTextFrameStyleSheetsByTextFrames(e)}},{key:"_updateTextFrameStyleSheetsByTextFrames",value:function(e){for(var t="",r=[],n=0;n<e.length;n++){var i=e[n];t+=i.data_token;var a=i.getStyle();a&&r.push(a)}if((t=Object(T.hash)(t),this._cache.textFrameStyle)&&t===this._cache.textFrameStyle.styleToken)return this._cache.textFrameStyle;return this._cache.textFrameStyle={styleToken:t,style:null,styles:r,bMerged:!1},this._cache.textFrameStyle}},{key:"getTextStyle",value:function(){var e=this.getTextStyleSheets();if(e&&!e.bMerged&&(e.style=Object(T.deepMergeWithConfigs)(e.styles,T.TextStyleConfig),e.bMerged=!0),e&&e.style)return Object(T.deepCloneWithConfigs)(e.style,T.TextStyleConfig)}},{key:"getTextStyleSheets",value:function(){var e=this,t=this.coredata,r=t.getTextStream(),n=r&&r.getTextStyleType(),i=function(){for(var t=null,r=e.getParent();r;){if(r.getTextStyleSheets){t=r.getTextStyleSheets(n||l.TextStyleType.Other);break}r=r.getParent()}return t}();if(i&&i.styles){var a=i.matchShapes,o=[t];if(i.isRootShape&&a.shape&&a.shape.isPlaceHolder()&&k.a.isTextShape(a.shape)){o=[];for(var s=0;s<a.shapes.length;s++){var u=a.shapes[s].shape.getTextFrame();u&&o.push(u)}}var c=this._updateTextFrameStyleSheetsByTextFrames(o),h=c.styleToken,d=Object(T.hash)(i.styleToken+h);if(!this._cache.textStyle||d!==this._cache.textStyle.styleToken){var p=[],f=[];c.styles.length>0&&(f=c.bMerged?[c.style]:c.styles),p=i.bMerged?[i.style].concat(f):i.styles.concat(f),this._cache.textStyle={styleToken:d,style:null,styles:p,bMerged:!1}}return this._cache.textStyle}}},{key:"getOutlineStyle",value:function(e){var t=this.getTextStyle();if(t){var r=t.chpStyles,n=t.paraStyles;return r&&n?{chpStyles:r[e],paraStyles:n[e]}:{}}}},{key:"getCompleteTextProps",value:function(){var e=Object(v.a)(this._getCompleteTextPropsInner());if(!e)return null;var t=window.APP.presentation.selection;if(t.inComposition){var r=t.getActiveTextStream();if(!r)return e;var n=this.coredata.getTextStream();if(r.objID!==n.objID)return e;var i=t._getTextCompositor();return this._mergeTextPropsForCompositon(e,i)}return e}},{key:"_mergeTextPropsForCompositon",value:function(e,t){if(!t)return e;var r=t.getText(),n=t.getType(),i=t.getState();if(0===r.length||n===l.CompositionState.End)return e;for(var a=i.begin,o=r.length,s=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.props.underlineType_custom=1,delete r.props.language,delete r.props.altLanguage;var i=t.getCacheFontProp();r.props=Object.assign({},r.props,w.a.getLangCode(e[0]),i),n&&delete r.props.actions},u=0;u<e.length;++u){var c=e[u],h=c.chpProps,d=c.paraProps;if(d.begin<=a&&a<d.end){d.end+=o;for(var p=0;p<h.length;++p){var f=h[p];if(a===f.begin){var y=Object(v.a)(f);y.end=f.begin+r.length,s(r,y),h.splice(p,0,y),f.begin+=r.length,f.end+=r.length,p+=2;break}if(f.begin<a&&a<f.end){var g=Object(v.a)(f),m=Object(v.a)(f);f.end=a,g.begin=a,g.end=a+r.length,s(r,g),h.splice(p+1,0,g),m.begin=g.end,m.end+=r.length,h.splice(p+2,0,m),p+=3;break}if(a===f.end){var _=Object(v.a)(f);_.begin=f.end,_.end=_.begin+r.length,s(r,_,!0),h.splice(p+1,0,_),p+=2;break}}for(;p<h.length;++p)h[p].begin+=o,h[p].end+=o;c.end+=o}else if(d.begin>a){d.begin+=o,d.end+=o;for(var S=0;S<h.length;++S)h[S].begin+=o,h[S].end+=o;c.begin+=o,c.end+=o}}return e}},{key:"_handleFontName",value:function(e,t){var r=e[t];if("number"==typeof r){var n=this.getPresentaion().getFont(r);e[t]=n?Object(v.a)(n):{id:r}}}},{key:"_getCompleteTextPropsInner",value:function(){var e=this._coredata.getTextStream();if(e){var t=this.getTextStyleSheets();if(t){var r=Object(T.hash)(t.styleToken+e.data_token);if(this._cache.textProps&&this._cache.textProps.token===r)return this._cache.textProps.props;t&&!t.bMerged&&(t.style=Object(T.deepMergeWithConfigs)(t.styles,T.TextStyleConfig),t.bMerged=!0);for(var n=t.style,i=n.chpStyles,a=n.paraStyles,o=e.getChpTbl(),s=e.getParaTbl(),l=s&&s.getItemsArray(),u=[],c=function(e){var t={};if(window.fileInfo&&".ppt"===window.fileInfo.ext){var r=[{chpStyles:[i[0]],paraStyles:[a[0]]}];e>0&&r.push({chpStyles:[i[e]],paraStyles:[a[e]]});var n=Object(T.deepMergeWithConfigs)(r,T.TextStyleConfig);t.paraStyles=n.paraStyles[0],t.chpStyles=n.chpStyles[0]}else t={chpStyles:i[e],paraStyles:a[e]};return t},h=0;h<l.length;++h){var d=l[h],p=c(window.validateGetField(d.getProp(),"outline")||0),f=p.paraStyles.prop,v=d.getProp();v&&(f=Object.assign({},p.paraStyles.prop,v.private)),f.rightToLeft=!!f.rightToLeft;for(var y=d.getBegin(),g=d.getCcp(),m=y+g,_={begin:y,end:m,props:f},S=o&&o.getItems(y,g),b=[],k=0;k<S.length;++k){var C=S[k],w=C.getProp(),P=w?w.private:{},x=v.private&&v.private.defRunPr;null!=x&&(P=Object.assign({},x.private,P));var O=Object.assign({},p.chpStyles.prop,P);this._handleFontName(O,"fontNameAscii"),this._handleFontName(O,"fontNameAsiaEast"),this._handleFontName(O,"fontNameComplex"),this._handleFontName(O,"fontNameSymbol");var E=C.getBegin(),I=E+C.getCcp();I===m&&1===C.getCcp()&&delete O.fieldType,b.push({begin:E,end:I,props:O})}u.push({begin:y,end:m,chpProps:b,paraProps:_})}return this._cache.textProps={props:u,token:r},this._cache.textProps.props}}else console.warn("No textStream in getCompleteTextPropsInner !!")}},{key:"getCompleteTextFrameProps",value:function(){var e=this._coredata.getTextStream();if(e){var t=e.parent,r=t.getProperty(),n=null,i=null,a=r;if(this.isPlaceHolderTextFrame()){var o=t.getShape(),s=o.getSlideFollowing();if(s){var l=s.getPhShapes(o);if(l&&l.length>0){var u=l[0].shape,c=u.getTextFrame();c&&(i=c.getProperty());var h=u.getSlideFollowing();h&&(l=h.getPhShapes(o))&&l.length>0&&(c=(u=l[0].shape).getTextFrame())&&(n=c.getProperty()),a=Object(T.deepMergeWithConfigs)([n,i,r],{bClone:!0})}}}return a}}},{key:"hasArtText",value:function(){var e=this.getCompleteTextFrameProps();if(e.hasOwnProperty("scene3D")||e.hasOwnProperty("shape3D"))return!0;var t=e.textWarp;if(null!=t&&"number"!=typeof t)return!0;if(!this._coredata.getTextStream())return!1;for(var r=this.getCompleteTextProps(),n=0;n<r.length;++n)for(var i=r[n].chpProps,a=0;a<i.length;++a){var o=i[a].props;if(o.hasOwnProperty("artTextEffectList"))return!0;if(o.hasOwnProperty("artTextOutLineFill")){var s=o.artTextOutLineFill.fill;if(s&&s.type)return!0}}return!1}},{key:"getCompleteTextPropsByGcp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.coredata.getTextStream();if(r&&!(e<0||e>r.end))for(var n=this._getCompleteTextPropsInner(),i=0;i<n.length;++i){var a=n[i],o=a.begin,s=a.end,l=a.chpProps,u=a.paraProps;if(e>=o&&e<s){if(!u||!l)return;for(var c=0;c<l.length;++c){var h=l[c],d=h.begin,p=h.end,f=h.props;if(d<=e&&e<p){var y=Object(v.a)({paraProp:u.props,chpProp:f});return t&&t(y),y}}}}}},{key:"getCompleteTextPropsByRange",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this.coredata.getTextStream();if(i&&!(e<0||e>i.end)){for(var a=this._getCompleteTextPropsInner(),o=[],s=0;s<a.length;++s){var l=a[s],u=l.begin,c=l.end,h=l.chpProps,d=l.paraProps;if(!(c<=e||u>=e+t&&c>=e+t)){if(!d||!h)return;for(var p=0;p<h.length;++p){var f=h[p],y=f.begin,g=f.end,m=f.props;if(!(g<=e||y>=e+t&&g>=e+t)){var _=Object(v.a)({paraProp:d.props,chpProp:m});o.push(_)}}}}var S=function(e,t,r){for(var n=[],i=0;i<e.length;++i){var a=e[i][t];if(a){for(var o=!1,s=0;s<n.length;++s)if(Object(T.deepCompare)(a[r],n[s])){o=!0;break}o||n.push(a[r])}}return 1==n.length?n[0]:void 0};return null!=r&&null!=n?S(o,r,n):o}}},{key:"getSelfTextPropsByGcp",value:function(e){if(!(e<0)){var t=this.coredata.getTextStream();if(t&&!(e>t.end)){var r=t.getChpTbl(),n=r&&r.getItemByCP(e),i=n&&n.getProp(),a=t.getParaTbl(),o=a&&a.getItemByCP(e),s=o&&o.getProp(),l=null;return i&&i.private&&(l=Object(v.a)(i.private),this._handleFontName(l,"fontNameAscii"),this._handleFontName(l,"fontNameAsiaEast"),this._handleFontName(l,"fontNameComplex"),this._handleFontName(l,"fontNameSymbol")),{chpProp:l,paraProp:s&&s.private}}}}},{key:"getPapxProp",value:function(e,t){if(e&&null!=t){var r=this.coredata.getTextStream();t<0&&(t=0),t>r.end-1&&(t=r.end-1);var n=this.getSelfTextPropsByGcp(t),i=n&&n.paraProp,a=i&&i[e];if(null!=a)return{bStyle:!1,value:a};if("autoNum"==e&&null!=(a=i&&i.outline))return{bStyle:!0,value:a};var o=this.getCompleteTextPropsByGcp(t).paraProp;return null!=(a=o&&o[e])?{bStyle:!0,value:a}:{bStyle:null,value:null}}}},{key:"getChpxProp",value:function(e,t){if(e&&null!=t){var r=this.coredata.getTextStream();t<0&&(t=0),t>r.end-1&&(t=r.end-1);var n=!1,i=this.getSelfTextPropsByGcp(t),a=i&&i.chpProp,o=a&&a[e];if(null!=o)return{bStyle:n,value:o};var s=this.getCompleteTextPropsByGcp(t).chpProp;return null!=(o=s&&s[e])?{bStyle:n=!0,value:o}:{bStyle:null,value:null}}}},{key:"_createTextStyle",value:function(){for(var e={chpStyles:[],paraStyles:[]},t=0;t<9;t++)e.chpStyles.push({}),e.paraStyles.push({});var r=new b.b;return r.private=e,r}},{key:"setStyleProps",value:function(e,t,r){if("chpx"!==e&&"papx"!==e)return!1;for(var n=0;n<t.length;n++){var i=t[n];if(i<0||i>=9)return!1}for(var a=this.coredata.getStyle(),o=this._createTextStyle(),s=Object(T.deepCloneWithConfigs)(a,T.TextStyleConfig)||o.private,l="chpx"===e?s.chpStyles:s.paraStyles,u=0;u<t.length;u++){var c=t[u],h=l[c]||{prop:{}};for(var d in h.prop||(h.prop={}),r)"autoNumType"===d?(s.listNumbers=s.listNumbers||{},s.listNumbers["lvl"+c]=Object(b.e)({type:r[d],start:1})):h.prop[d]=r[d];l[c]=h}return o.private=s,this.coredata.setPropertyValue("style",o)}},{key:"isMasterPlaceHolderTextFrame",value:function(){var e=this.getParent();if(e&&e.coredata.isShape){var t=e.getRootShape();if(t&&t.isPlaceHolder()){var r=t.getSlide();return r&&("slideLayouts"===r.category||"slideMasters"===r.category)}}}},{key:"isPlaceHolderTextFrame",value:function(){var e=this.getParent();if(e&&e.coredata.isShape){var t=e.getRootShape();if(t&&t.isPlaceHolder())return null!=t.getSlide()}}},{key:"isChangeRect",value:function(e){return e==l.TextVerticalType.Vertical270||e==l.TextVerticalType.Vertical270||e==l.TextVerticalType.MongolianVer||e==l.TextVerticalType.EastAsianVer||e==l.TextVerticalType.WordArtVer||e==l.TextVerticalType.VerticalWordArtRightToLeft}},{key:"_getParaRangeInfo",value:function(e,t,r){for(var n=e.getParaTbl(),i=n.getItems(t,r),a=[],o=t,s=t+r,l=0;l<i.length;l++){var u=i[l],c=window.validateGetField(u.getProp(),"outline")||0,h=u.getBegin(),d=h+u.getCcp();h<o&&(o=h),d>s&&(s=d),a.push(c)}for(var p=[],f=n.getItemsArray(),v=0;v<f.length;v++){var y=f[v],g=window.validateGetField(y.getProp(),"outline")||0;a.indexOf(g)>=0&&p.push({gcp:y.getBegin(),ccp:y.getCcp(),para:y})}return{begin:o,end:s,outlines:a,items:i,ranges:p}}},{key:"fmtChpx",value:function(e,t,r){var n=this.coredata.getTextStream();if(this.isMasterPlaceHolderTextFrame()){for(var i=this._getParaRangeInfo(n,e,t),a=i.outlines,o=i.ranges,s=n.getChpTbl(),l=Object.keys(r),u=[],c=0;c<o.length;c++){var h=o[c],d=s.getItems(h.gcp,h.ccp);if(d&&d.length>0)for(var p=0;p<d.length;p++)s.clearProps(d[p].getBegin(),l);u.push({gcp:h.gcp,ccp:h.ccp,fmt:r})}if(this.setStyleProps("chpx",a,r))return u}else if(n.fmtChpx(e,t,r))return[{gcp:e,ccp:t,fmt:r}]}},{key:"fmtPapx",value:function(e,t,r){var n=this.coredata.getTextStream(),i=r.listType;if(null!=i){if(1===i)r.bBullet=!0;else if(2===i){r.bBullet=!1;for(var a=n.getParaTbl(),o=a.getItemsArray(),s=a.findIndex(e),l=[],u=s;u<o.length&&!(o[u].getBegin()>=e+t);++u)l.push(o[u]);for(var c=l[0],h=l[l.length-1],d=c&&(window.validateGetField(c.getProp(),"listType")||0),p=c&&(window.validateGetField(c.getProp(),"outline")||0),f=h&&(window.validateGetField(h.getProp(),"listType")||0),v=h&&(window.validateGetField(h.getProp(),"outline")||0),y=s-1;y>=0;--y){var g=o[y],m=window.validateGetField(g.getProp(),"listType")||0,_=window.validateGetField(g.getProp(),"outline")||0;if(!(m>0&&m==d&&p==_))break;l.unshift(g)}for(var S=u;S<o.length;++S){var T=o[S],b=window.validateGetField(T.getProp(),"listType")||0,k=window.validateGetField(T.getProp(),"outline")||0;if(!(b>0&&b==f&&k==v))break;l.push(o[S])}var C=l.length;if(C>0){var w=l[0].getBegin(),P=l[C-1].getBegin()+l[C-1].getCcp();t=(P=P>(e=w<e?w:e)+t?P:e+t)-e}}else r.bBullet=!1;this._modifyIndent(e,t,r)}if(this.isMasterPlaceHolderTextFrame()){for(var x=Object.assign({},r),O=["tabIndent"],E={},I=!1,A=0;A<O.length;A++){var R=O[A];x.hasOwnProperty(R)&&(I=!0,E[R]=x[R],delete x[R])}var D=[];if(I&&(D.push({gcp:e,ccp:t,fmt:E}),!n.fmtPapx(e,t,E)))return;for(var L=this._getParaRangeInfo(n,e,t),N=L.outlines,M=L.ranges,F=0;F<M.length;F++)D.push({gcp:M[F].gcp,ccp:M[F].ccp,fmt:x});var B=Object.keys(x);if(0===B.length)return D;var j=n.getParaTbl();if(M&&M.length>0)for(var V=0;V<M.length;V++)j.clearProps(M[V].gcp,B);if(this.setStyleProps("papx",N,x))return D}else if(n.fmtPapx(e,t,r))return[{gcp:e,ccp:t,fmt:r}]}},{key:"checkIsFromStyle",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getSelfTextPropsByGcp(e),i=n.chpProp,a=n.paraProp,o=a&&a.outline||0,s=this.getOutlineStyle(o),l=s.chpStyles,u=s.paraStyles;return r?null==i[t]&&null!=l.prop[t]:null==a[t]&&null!=u.prop[t]}},{key:"calTabLeftIndent",value:function(e,t){if(!this.checkIsFromStyle(e,"leftIndent",!1)){var r={},n=this.getCompleteTextPropsByGcp(e),i=n.paraProp,a=n.chpProp,o=i&&i.leftIndent;o||(o={value:0,isCh:!1});var s=o,l=s.value,u=s.isCh;return r.value=u?this._calcIndentByFont(a,l):t>0?l+720:l-720,r.isCh=u,r}}},{key:"adjustSpanBeforeTab",value:function(e,t){var r=this;if(null!=e&&null!=t){var n=this.coredata.getTextStream(),i=n.getChpTbl(),a=n.getParaTbl(),o=a&&a.getItemByCP(e);if(o)for(var s=function(e){var t=r.getOutlineStyle(e).chpStyles;return 0==t.prop.fontSize?l.DefaultTextSize:Math.max(t.prop.fontSize,1)},u=window.validateGetField(o.getProp(),"outline")||0,c=s(u),h=s(t>0?u+1>8?8:u+1:u-1<0?0:u-1),d=o.getBegin(),p=d+o.getCcp(),f=i.findIndex(d),v=i.getItemCount(),y=f;y<v;++y){var g=i.getItemAt(y),m=g.getBegin(),_=g.getCcp();if(m+_>p)break;var S=window.validateGetField(g.getProp(),"fontSize")||0,T=parseInt(S*h/c+.5);this.checkIsFromStyle(m,"fontSize",!0)||n.fmtChpx(m,_,{fontSize:T})}else console.error("Can not find paraItem !!")}}},{key:"autoFit",value:function(e){return e==l.AutoFit.Advanced?this._autoFitShape2Text():e==l.AutoFit.Normal?this._autoFitText2Shape():void 0}},{key:"_autoFitShape2Text",value:function(){var e=this.coredata.getShape();return e&&e.visual.updateShapeAnchorRect()}},{key:"_autoFitText2Shape",value:function(){}},{key:"_modifyIndent",value:function(e,t,r){var n=this.coredata.getTextStream(),i=n.getParaTbl().getItems(e,t),a=0!=r.listType;if(this.isMasterPlaceHolderTextFrame()){for(var o=[],s=0;s<i.length;s++){var l=i[s];if(this.getCompleteTextPropsByGcp(l.getBegin()).paraProp.listType!==r.listType){var u=window.validateGetField(l.getProp(),"outline")||0;o.includes(u)||o.push(u)}}for(var c=0;c<o.length;++c){var h=o[c],d=this.getOutlineStyle(h),p=d.chpStyles,f=d.paraStyles,v=void 0;v=a?this._calcSetIndent(p.prop,f.prop,h,r):this._calcUnsetIndent(p.prop,f.prop,h),this.setStyleProps("papx",[h],v)}}else for(var y=0;y<i.length;y++){var g=i[y],m=g.getBegin(),_=g.getCcp(),S=window.validateGetField(g.getProp(),"outline")||0;if(this._canClearIndent(i[y],!r.bBullet)){var T=this.getOutlineStyle(S).paraStyles,b={leftIndent:T.prop.leftIndent,firstIndent:T.prop.firstIndent};n.fmtPapx(m,_,b)}else{var k=this.getCompleteTextPropsByGcp(m),C=k.chpProp,w=k.paraProp;if(w.listType!==r.listType){var P=void 0;P=a?this._calcSetIndent(C,w,S,r):this._calcUnsetIndent(C,w,S),n.fmtPapx(m,_-1,P)}}}}},{key:"_calcSetIndent",value:function(e,t,r,n){var i=t.leftIndent||{value:0,isCh:!1},a=i.value;i.isCh&&(a=this._calcLeftIndent(a,r));var o=t.firstIndent||{value:0,isCh:!1},s=o&&o.value;o.isCh&&(s=this._calcIndentByFont(e,s));var l=e.fontSize,u=this._getFirstIndentByFontSize(l/20,!n.bBullet,!1);if(!(s<0&&-s>=u))return i.value=s<0?u+i.value+s:u+a,o.value=-u,{leftIndent:i,firstIndent:o}}},{key:"_calcUnsetIndent",value:function(e,t,r){var n=t.leftIndent||{value:0,isCh:!1},i=n.value,a=t.firstIndent||{value:0,isCh:!1},o=a&&a.value;return a.isCh&&(o=this._calcIndentByFont(e,o)),a.value=0,o<0&&(n.isCh&&(i=this._calcLeftIndent(i,r)),(i+=o)<0&&(i=0),n.value=i),{leftIndent:n,firstIndent:a}}},{key:"_calcIndentByFont",value:function(e,t){var r=e.fontSize,n=e.spacing;return this._calcIndentTwip(r,100,n,t)}},{key:"_calcLeftIndent",value:function(e,t){var r=window.APP.presentation.getDefaultTextStyle().chpStyles[t].prop,n=r&&r.fontSize/20||18,i=r&&r.prop.spacing;return this._calcIndentTwip(n,100,i,e)}},{key:"_calcIndentTwip",value:function(e,t,r,n){if(null!=e&&null!=r&&null!=t&&null!=n){var i=Math.max(0,t*e/100+20*r/100);return Math.max(-80640,Math.min(i*n/100,80640))}console.error("inparam error !!")}},{key:"_getFirstIndentByFontSize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?e<=12?r?450:360:e<=18?r?630:540:e<=25?r?810:720:e<=35?r?900:810:e<=44?r?1350:1170:e<=56?r?1620:1440:e<=72?1800:2160:e<=12?270:e<=18?450:e<=25?540:e<=35?720:e<=44?900:e<=56?1080:e<=72?1350:1800}},{key:"_canClearIndent",value:function(e,t){if(e&&!t){var r=e.getProp().private,n=r&&r.outline||0,i=r&&r.leftIndent||{value:0,isCh:!1},a=r&&r.firstIndent||{value:0,isCh:!1},o=this.getOutlineStyle(n),s=o.paraStyles,l=o.chpStyles;if((s.prop&&s.prop.listType||0)==C.d.Bullet){var u=s.prop&&s.prop.leftIndent||{value:0,isCh:!1};u.isCh&&(u.value=this._calcLeftIndent(u.value,n));var c=s.prop&&s.prop.firstIndent||{value:0,isCh:!1};if(c.isCh&&(c.value=this._calcIndentByFont(l.prop,c.value)),i.value==u.value&&c.value==c.value)return!0;if(0==a.value){if(c.value<0)return i.value==u.value+c.value;if(c.value>0)return i.value==u.value}else if(a.value<0&&c.value<0||a.value>0&&c.value>0)return i.value+a.value==u.value+c.value;return!1}}}}]),t}(S.a),x=r(315),O=function(){function e(t){i()(this,e),this.private=t.data,Object(s.a)(this),this._visual=new P(this),this.data_token=Object(x.a)()}return o()(e,[{key:"_fireChanged",value:function(){this._bubbleUpEvent(u.default.modify_text_frame,{data:this})}},{key:"buildTree",value:function(e){this.parent=e;var t=this.getTextStream();t&&t.buildTree(this);var r=this,n=this.private.style;n&&Object(b.d)(n,(function(e){e===r.private.style&&r._fireChanged()}))}},{key:"getTextStream",value:function(){return this.private.textStream}},{key:"ensureTextStream",value:function(){var t=this.getTextStream();if(!t){var r=this.getShape(),n=r&&r.getSlide(),i=n&&n.getPresentation();i||console.error("can not find presentation from textstream"),t=e.createNewTextStream(i),this.setPropertyValue("textStream",t),t.buildTree(this)}return t}},{key:"getStyle",value:function(){return this.private.style&&this.private.style.private}},{key:"getProperty",value:function(){var e=this.private,t=Object.assign({},e.prop);null==t.textWrap&&(t.textWrap=l.TextWrap.Square);var r=this.parent;if(r&&r.isTableCell){var n=r.private;Object.assign(t,{autoFit:2,shape3D:{}});var i=function(e,r){null!=n[r]&&(t[e]=n[r])};i("verticalType","textDirection"),i("textInset","margin"),i("anchorType","anchor"),i("anchorCenter","anchorCenter")}return t}},{key:"modifyProps",value:function(e){if(e){var t=Object(v.a)(this.private.prop||{});t=Object.assign({},t,e);var r=this.modifyProperties({prop:t});return null!=t.autoFit&&this.visual.autoFit(t.autoFit),this._bubbleUpEvent(u.default.modify_text_frame,{data:this}),r}}},{key:"replaceProps",value:function(e){if(e){var t=Object(v.a)(e),r=this.modifyProperties({prop:t});return this._bubbleUpEvent(u.default.modify_text_frame,{data:this}),r}}},{key:"getShape",value:function(){for(var e=this.parent;e&&!e.isShape;)e=e.parent;return e&&e.isShape?e:null}},{key:"getTextFrameType",value:function(){var e=this.getShape();return e?e.hasTable()?"tableFrame":e.isPlaceHolder()?"placeholderFrame":"normalFrame":null}},{key:"matchText",value:function(e){if(!e)return null;var t=this.getTextStream();return t&&t.matchText?t.matchText(e):null}},{key:"getAlignType",value:function(){var e=l.TextFrameAlignType.Left,t=this.getTextStream();if(!t)return e;var r=t.getParaTbl().firstItem,n=r&&r.getProp(),i=n&&n.getAlignMode&&n.getAlignMode();if(null==i)return e;switch(i){case l.HorzAlignMode.Left:return l.TextFrameAlignType.Left;case l.HorzAlignMode.Center:case l.HorzAlignMode.Adjustify:case l.HorzAlignMode.FullAdjustify:return l.TextFrameAlignType.Center;case l.HorzAlignMode.Right:return l.TextFrameAlignType.Right}return e}},{key:"visual",get:function(){return this._visual}},{key:"isTextFrame",get:function(){return!0}},{key:"isMath",get:function(){return!!this.private.isMath}}]),e}();t.a=O;O._createPropTbl=function(e){var t=new c.a;t.private=e;var r=new d.AbsVectorObject;r.private=r.vector,r.private[0]=new d.AbsObject,r.private[0].private={begin:0,ccp:1,prop:t};var n=new d.AbsObject;return n.private={data:r},n},Object(f.e)(O.prototype,!1),O.createNewTextFrame=function(e){var t=e.allocateLocalId(),r=e.allocateLocalId(),n=new d.AbsVectorObject;n.private=[];var i={id:r,type:1,data:{autonumMgr:n,chpTbl:O._createPropTbl({altLanguage:"en-US",language:"zh-CN"}),papTbl:O._createPropTbl({}),text:"\r",textHeader:"TextStyleOther"}},a=new h.a(i),o={id:t,type:3,data:{childs:[],layer:!0,prop:{columnRightToLeft:0,textShapeType:p.PresetShapeType.TextNoShape},textStream:a}};return new O(o)},O.clone=function(e,t){var r=e.allocateLocalId(),n=e.allocateLocalId(),i=t.getTextStream(),a=new d.AbsVectorObject;a.private=[];var o={id:n,type:1,data:{autonumMgr:a,textHeader:Object(v.a)(i.textHeader),chpTbl:O._createPropTbl({altLanguage:"en-US",language:"zh-CN"}),papTbl:O._createPropTbl({}),text:"\r"}},s=new h.a(o),l={id:r,type:3,data:{childs:[],layer:!0,prop:Object(v.a)(t.getProperty()),textStream:s}};return new O(l)},O.createNewTextStream=function(e){var t=e.allocateLocalId(),r=new d.AbsVectorObject;r.private=[];var n={id:t,type:1,data:{autonumMgr:r,chpTbl:O._createPropTbl({altLanguage:"en-US",language:"zh-CN"}),papTbl:O._createPropTbl({}),text:"\r",textHeader:"TextStyleOther"}};return new h.a(n)}},995:function(e,t,r){"use strict";r.d(t,"e",(function(){return v})),r.d(t,"a",(function(){return S})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return T}));var n=r(537),i=r.n(n),a=r(146),o=r(324),s=r(144),l=r(228),u=r(27),c=r(162),h=r(145),d=[c.default.spreadsheet,c.default.writer,c.default.presentation,c.default.pdf].indexOf(Object(h.getPageOfficeType)())>=0,p=!1;function f(){p=!0}window.woapi_ismodified=function(){return p};var v=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(i,a){var o=u.b();if(o.connected()){var s=o.clientID;i("/api/v3/office/file/"+e+"/"+(n?"media_object":"object")+"/"+t+"?connid="+s+"&orientation"+(r?"&get_url":""))}else a("session not connected, post object is not allowed")}))},y=null,g=!1,m=function(e){if(window.RPCClient&&"CONNECTED"===window.RPCClient.getState()&&!g){if(g=!0,a.default.dispatchEvent(a.default.names.ON_BEFORE_UNLOAD),s.isAndroid&&s.isMobileQQ)return!0;if(!window.__WPSENV__.cache_preview&&(!window.openClientTimeStamp||(new Date).getTime()-window.openClientTimeStamp>150)){var t=window.RPCClient;t.send("session.close"),t.close(!0),t.serverID=""}}};window.addEventListener("unload",m),window.addEventListener("beforeunload",m),window.addEventListener("pagehide",m);try{window.woapi_onunload=m}catch(e){}var _=function(e){var t=!1,r=e.errno,n=e.responseHeaders,i=e.reason,s=n?n.match(/x-request-id: (.*)(?:\r\n)/i):null,u=s?s[1]:null;switch(i){case"NotExists":case"lightLinkNotExist":a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.InvalidLink,errorno:r,request_id:u});break;case o.default.fileNotExists:case o.default.RetryLater:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:e.reason,result:e.reason,errorno:r,request_id:u});break;case"linkExpired":a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.Unknown,result:"linkClosed",errorno:r,request_id:u});break;case o.default.UserNotLogin:Object(l.gotoLogin)();break;case o.default.fileTooLarge:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:e.reason,limit:e.detail.limit,errorno:r,request_id:u});break;case o.default.fileSizeLimit:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:e.reason,msg:_i18n("applications.public.helpers.core.sessionhelper.fileSizeLimit", ""),errorno:r,request_id:u});break;case o.default.SessionExpired:a.default.dispatchEvent(a.default.names.network.SESSION_TIMEOUT);break;case"fileUploadNotComplete":a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.fileUploadNotComplete,errorno:r,request_id:u});break;case"lightlinkVerifying":case o.default.FileUnderReview:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.FileUnderReview,errorno:r,request_id:u});break;case o.default.Unknown:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.Unknown,result:"",msg:"",errorno:r,request_id:u});break;case o.default.NeedPassword:case o.default.NeedLevel1Password:case o.default.NeedLevel2Password:case o.default.NeedModifyPassword:case o.default.InvalidPassword:a.default.dispatchEvent(a.default.names.network.ON_FILE_PASSWORD_ERROR,{type:e.reason});break;case o.default.OpenFailed:case o.default.AppExceedsMaxEditFileCount:case o.default.AppStatusNotUsed:case o.default.GetFileInfoFailed:case o.default.PermissionRevoked:case o.default.CooperationTerminated:case o.default.fileOtherError:case o.default.FileCrash:case o.default.LightlinkForbid:case o.default.SpaceFull:case o.default.InvalidArgument:case o.default.RestrictedFile:case o.default.ServerNotAvailable:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:e.reason,errorno:r,request_id:u});break;case o.default.SecureDocumentError:if(e.detail){var c={type:e.reason,result:e.detail.code,msg:e.detail.msg};a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,c)}else window.location.reload();break;case o.default.Unavailable:case o.default.DownloadFailed:t=!0;break;case o.default.PermissionInvalid:case o.default.SessionDeleted:case o.default.PermissionExpire:case o.default.PermissionLimit:case o.default.SecDocAlgorithmNotMatch:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:e.reason,result:e.msg,msg:e.msg,errorno:r,request_id:u});break;case o.default.InvalidVersion:a.default.dispatchEvent(a.default.names.file.ON_FILE_INFO_CHANGE,{eventName:"force_refresh"});break;case o.default.AuthCodeExpired:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.AuthCodeExpired,errorno:r,request_id:u});break;case o.default.RestrictedAccess:case o.default.NewVersionFound:window.location.reload();break;case o.default.DraftClosed:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.DraftClosed,errorno:r,request_id:u});break;case o.default.DriverServerError:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.DriverServerError,msg:_i18n("applications.public.helpers.core.sessionhelper.DriverServerError", ""),errorno:r,request_id:u});break;default:a.default.dispatchEvent(a.default.names.network.ON_FILE_OPEN_ERROR,{type:o.default.Unknown,result:e.reason,msg:e.msg,errorno:r,request_id:u})}return y&&(y.close(),y=null),t},S=function(e){window.__CONFIG__.isEnableEditLock&&d&&(null===y||y.close(),y=new i.a(e))},T=function(e){var t=JSON.parse(e.message),r=Object.assign({eventName:"online_mode_change"},t);a.default.dispatchEvent(a.default.names.file.ON_FILE_INFO_CHANGE,r)}},998:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(0,r(143).__importDefault)(r(999)),i=r(434),a=r(1007),o=function(){function e(){this.controller=new n.default,(0,a.registerInstance)(this),(0,i.logger)("PluginMgr controller",this.controller)}return e.prototype.addPlugin=function(e){var t=e.id,r=e.pluginObj;this.controller.addPlugin(t,r)},e.prototype.getPlugin=function(e,t,r){return this.controller.getPlugin(e,t,r)},e}();t.default=o},999:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(143),i=r(434),a=(0,n.__importDefault)(r(1e3)),o=(0,n.__importDefault)(r(146)),s=(0,n.__importDefault)(r(500)),l=function(){function e(){this.pluginConfig=[],this.pluginList=[],this.init()}return e.prototype.init=function(){var e=this;(0,i.logger)("init!");var t=window.__PLUGINCONFIG__.plugin;if(t&&Array.isArray(t)&&t.length){for(var r=t.length,n=[],s=0;s<r;s++){var l=Object.assign({},t[s]);if("1.0"===l.pluginProtocol){try{l.pluginManifest=JSON.parse(l.pluginManifest)}catch(e){l.pluginManifest={activedEvents:{},dependencies:[]}}n.push(new a.default(l))}}this.pluginConfig=t,this.pluginList=n,this.appReadyEventPluginStartTime=0,this.appReadyEventReportFlag=!1,window.addEventListener(o.default.names.network.ON_APP_READY,(function(){e.appReadyEventPluginStartTime=performance.now(),n.forEach((function(t){t.setAppReadyTime(e.appReadyEventPluginStartTime),t.once("onPluginReady",(function(){e.checkIfAppReadyLoadFinished()}))}))}))}else(0,i.logger)("cannot find plugin config")},e.prototype.addPlugin=function(e,t){var r={id:e},n=this.search(r);return 0===n.length?(0,i.logger)("plugin id".concat(e," not found")):n.length>1?(0,i.logger)("plugin id".concat(e," not only one")):void n[0].setPluginInstance(t)},e.prototype.getPlugin=function(e,t,r){var n=this.search(e);return 0===n.length?((0,i.logger)("plugin id".concat(e.id," not found")),Promise.reject("plugin id".concat(e.id," not found"))):n.length>1?((0,i.logger)("plugin id".concat(e.id," not only one")),Promise.reject("plugin id".concat(e.id," not only one"))):n[0].getPluginInstance(t,r)},e.prototype.search=function(e){for(var t=[],r=0;r<this.pluginList.length;r++){var n=this.pluginList[r],i=!0;for(var a in e)if(e[a]!==n.config[a]){i=!1;break}i&&t.push(n)}return t},e.prototype.checkIfAppReadyLoadFinished=function(){if(this.appReadyEventReportFlag)return!0;for(var e=0;e<this.pluginList.length;e++){var t=this.pluginList[e];if(t.config.pluginManifest.activedEvents&&!0===t.config.pluginManifest.activedEvents["network.ON_APP_READY"]&&t.current<s.default.onPluginReady)return!1}var r=0!==this.appReadyEventPluginStartTime?performance.now()-this.appReadyEventPluginStartTime:0;return window.collection("experience",{event:"reading_time_plugfile2",times:Math.round(r)}),this.appReadyEventReportFlag=!0,!0},e}();t.default=l}}]);