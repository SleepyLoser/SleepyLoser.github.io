(window.webpackJsonp=window.webpackJsonp||[]).push([[205,218],{1106:function(e,t,n){e.exports=function(e,t){n.e(31).then(n.t.bind(null,793,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},1150:function(e,t,n){e.exports=n.p+"images/1.a8bd215c.png"},1151:function(e,t,n){e.exports=n.p+"images/2.ecf68379.png"},1152:function(e,t,n){e.exports=n.p+"images/3.3dea1e95.png"},1153:function(e,t,n){e.exports=n.p+"images/4.a198a616.png"},1154:function(e,t,n){e.exports=n.p+"images/5.189dc92b.png"},1155:function(e,t,n){e.exports=n.p+"images/6.e56bef1c.png"},1241:function(e,t,n){},1492:function(e,t,n){},1494:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i=function(e,t,n){var i=window.APP.shell.doc.coreView.hitTest(e,t,null,null,!1,n),o=i&&i.shape;return o&&o.shapeData},o=function(e){var t=e.selection,n=t&&t.getActiveSlide();if(!n){var i=e.getActiveSlide();n=i&&i.slideData}var o=n&&n.getId(),a=function(t){var n=t&&t.getTiming(),i=n&&n.mainSequence,a=i&&i.getEffects(),s=n&&n.getTimeLine(),r=s&&s.allInterSeq,l=e.animePlayer;return l&&(i&&a&&a.length>0||r&&r.length)?l.getInvisibleShapes(o).filter((function(e){return e.getSlide()===t})).map((function(e){return e.getId()})):null},s=n&&n.getFollowing(),r=s&&s.getFollowing();return[a(n),a(s),a(r)]}},166:function(e,t,n){"use strict";n.r(t);var i=n(26),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=(n(259),n(142)),f=n.n(h),m=n(160),v=n.n(m),y=n(144),g=n(146),w=n(191),E=n(229),T=n(182),_=n(283),b={click:"click",hover:"hover"},P=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.btnDom=null,n.delayCloseTimer=null,n.checkMouseEvent=function(){return n.props.trigger===b.hover&&!y.isTouchScreen},n.refDropDown=f.a.createRef(),n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n.handleClick=n.handleClick.bind(n),n.handleContentClose=n.handleContentClose.bind(n),n.handleContentMouseEnter=n.handleContentMouseEnter.bind(n),n.handleContentMouseLeave=n.handleContentMouseLeave.bind(n),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.initBtnDOM(),this.props.visible&&this.forceUpdate()}},{key:"componentWillUnmount",value:function(){this.clearDelayClose()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,i=n.visible,o=n.destroyOnHide;!i&&e.visible&&!o&&void 0!==o&&this.refDropDown.current&&(1===this.refDropDown.current.getLevel()&&g.default.dispatchEvent(g.default.names.CLOSE_DROPDOWN_PANEL,{isCloseSub:!0}))}},{key:"initBtnDOM",value:function(){var e=this.props.getElement;this.btnDom=e?e():null,this.btnDom=this.btnDom||v.a.findDOMNode(this)}},{key:"getRect",value:function(){if(!this.btnDom)return null;var e=this.props.offsetX,t=this.btnDom.getBoundingClientRect(),n={bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width};return e&&(n.left-=e,n.right+=e,n.width+=2*e),n}},{key:"handleTrigger",value:function(e){this.clearDelayClose(),e&&this.initBtnDOM(),this.props.onVisibleChange(e)}},{key:"handleClick",value:function(e){var t=this.props,n=t.visible,i=t.onClick,o=t.trigger;i?i(e):o===b.hover&&!y.isTouchScreen&&(e.clientX>0||e.clientY>0)||this.handleTrigger(!n)}},{key:"startDelayClose",value:function(){var e=this;this.clearDelayClose(),this.delayCloseTimer=setTimeout((function(){e.props.onVisibleChange(!1)}),200)}},{key:"clearDelayClose",value:function(){clearTimeout(this.delayCloseTimer)}},{key:"handleMouseEnter",value:function(){var e=this.props,t=e.visible,n=e.onMouseEnter;this.checkMouseEvent()&&(this.clearDelayClose(),t||this.handleTrigger(!0)),n&&n()}},{key:"handleMouseLeave",value:function(e){this.props.visible&&this.checkMouseEvent()&&this.startDelayClose(),this.props.onMouseLeaveDropBtn&&this.props.onMouseLeaveDropBtn()}},{key:"handleContentMouseEnter",value:function(){this.checkMouseEvent()&&this.clearDelayClose()}},{key:"handleContentMouseLeave",value:function(e){if(!this.props.disableContentMouseLeave&&this.checkMouseEvent()){var t=document.getElementsByClassName("wowui-tooltip-content")[0]||document.getElementsByClassName("component-tooltip-content")[0];if(t){var n=t.getBoundingClientRect(),i=n.left,o=n.right,a=n.top,s=n.bottom,r=e.pageX,l=e.pageY;if(r>=i&&r<=o&&l>=a&&l<=s)return}g.default.dispatchEvent(g.default.names.DROPDOWN_BTN_CONTENT_MOUSE_LEAVE,e),this.startDelayClose()}}},{key:"handleContentClose",value:function(){this.clearDelayClose(),this.props.onVisibleChange(!1)}},{key:"renderContent",value:function(){var e=this.getRect(),t=this.props,n=t.isSetHeight,i=t.panel,o=t.visible,a=t.placement,s=t.distance,r=t.panelClass,l=t.isAuto,u=t.offsetX;return f.a.createElement(E.default,{ref:this.refDropDown,isAuto:l,className:r,triggerElement:this.btnDom,rect:e,offsetX:u,visible:o,placement:a,distance:s,isSetHeight:n,onClose:this.handleContentClose,onMouseEnter:this.handleContentMouseEnter,onMouseLeave:this.handleContentMouseLeave},i)}},{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.children,i=e.visible,o=e.destroyOnHide;t=t||n.props.disabled;var a=this.getRect();if(!t){var s=n.props.title;s&&i&&(s=null),n=f.a.cloneElement(n,{title:s,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.handleClick})}return f.a.createElement(f.a.Fragment,null,n,!!a&&f.a.createElement(w.default,{visible:i,destroyOnHide:o},this.renderContent()))}}]),t}(h.PureComponent);P.placementTypes=E.default.placementTypes,P.DropdownPanel=T.default,P.triggerTypes=b,P.defaultProps={visible:!1,trigger:b.click,distance:4,offsetX:0},t.default=P;var k=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this.props.commandBarId;window.__WPSENV__.reduxDispatch(Object(_.altLazyLoad)({id:e}))}},{key:"render",value:function(){return f.a.createElement(T.default,o()({},this.props,{ref:this.forwardRef}),this.props.children)}}]),t}(h.PureComponent);k.Item=T.default.Item,k.Divider=T.default.Divider,P.AltDropdownPanel=k},172:function(e,t,n){"use strict";n.r(t);var i=n(44),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=n(142),f=n.n(h),m=n(145),v=n(151),y=n.n(v),g=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refDiv=f.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return p()(t,e),l()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(m.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getClassName",value:function(){var e=this.props,t=e.selected,n=e.disabled,i=e.disabledTag,a=e.children,s=e.className,r="component-menu-item",l=this.refDiv.current;l&&-1!==l.className.indexOf(" hover")&&(r+=" hover"),t&&(r+=" selected"),n&&(r+=" disabled"),i&&(r+=" disabled-tag"),s&&(r+=" "+s);var u=void 0===a?"undefined":o()(a);return"string"!==u&&"number"!==u||(r+=" only-text"),s&&(r+=" "+s),r}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.keepEdit,o=e.dataKey,a=e.title,s=e.draggable,r=e.onDragStart,l=e.onDragEnd,u=this.getClassName();return f.a.createElement(y.a,{title:a},f.a.createElement("div",{ref:this.refDiv,id:t,className:u,"data-keep-edit":i||void 0,"data-key":o||void 0,draggable:s,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:r,onDragEnd:l},n))}}]),t}(h.PureComponent);t.default=g},182:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=(n(209),n(142)),p=n.n(c),h=n(144),f=n(146),m=n(145),v=n(148),y=n(226),g=n(245),w=n(169),E="right",T="down",_="rightDown",b=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={width:null,height:null,minWidth:null,minHeight:null},n.timer=null,n.scrollSelectedChildren=function(){for(var e=n.refContent.current,t=function(t){var i=e.children[t];if(i.classList.contains("selected"))return n.timer=setTimeout((function(){i.scrollIntoViewIfNeeded(),clearTimeout(n.timer)}),500),"break"},i=0;i<e.childElementCount;i++){if("break"===t(i))break}},n.handleScroll=function(){f.default.dispatchEvent(f.default.names.DROPDOWN_PANEL_SCROLL);var e=n.props,t=e.scrollEndBottom,i=e.onScroll;if(i){var o=n.refPanel.current,a=o.scrollTop;a+o.clientHeight+t>=o.scrollHeight&&i({scrollTop:a})}},n.scrollToTop=function(){n.refPanel.current.scrollTop=0},n.scrollToView=function(e){e.scrollIntoViewIfNeeded()},n.selectFirstItem=function(){var e=n.getHoverItem();e&&e.classList.remove("hover");var t=n.refPanel.current.getElementsByClassName("panel-item");t[0].classList.add("hover"),n.scrollToTop(),n.showPreSelectItem(t[0])},n.refPanel=p.a.createRef(),n.refContent=p.a.createRef(),n.handleDragMouseDown=n.handleDragMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.officeType=Object(m.getPageOfficeType)(),n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){if(this.props.isListenEvent&&this.bindEvents(),this.props.canResize){var e=this.refPanel.current,t=e.offsetWidth,n=e.offsetHeight;this.setState({width:t,height:n,minWidth:t,minHeight:n})}this.scrollSelectedChildren()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isListenEvent,i=t.visible;n!==e.isListenEvent&&(n?this.bindEvents():this.unbindEvents()),i!==e.visible&&i&&this.scrollSelectedChildren()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"bindEvents",value:function(){window.addEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"unbindEvents",value:function(){clearTimeout(this.timer),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}},{key:"handleMouseOver",value:function(){h.isTouchScreen||this.bindEvents()}},{key:"handleMouseOut",value:function(){h.isTouchScreen||(this.props.isListenEvent||this.unbindEvents(),this.handleMouseMove(),this.props.onMouseOut&&this.props.onMouseOut())}},{key:"handleMouseMove",value:function(){if(this.props.onItemHover&&!h.isTouchScreen){var e=this.getHoverItem();this.props.onItemHover(e,!0)}}},{key:"handleDragMouseDown",value:function(e){var t=this,n=document.activeElement;Object(m.stopBubble)(e);var i=e.clientX,o=e.clientY,a=e.target,s=e.currentTarget.getAttribute("data-orien");a.setCapture&&a.setCapture();var r=this.state,l=r.width,u=r.height,d=r.minWidth,c=r.minHeight;document.onmousemove=function(e){Object(m.stopBubble)(e);var n=e.clientX,a=e.clientY,r=Math.max(d,l+n-i),p=Math.max(c,u+a-o);s===E?p=u:s===T&&(r=l),t.setState({width:r,height:p},(function(){f.default.dispatchEvent(f.default.names.FREE_SCROLL_BAR_RESIZE,{target:t.refPanel.current})}))},document.onmouseup=function(e){Object(m.stopBubble)(e),document.onmousemove=null,document.onmouseup=null,a.releaseCapture&&a.releaseCapture(),n.focus()}}},{key:"handleWindowKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if(!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad")){var i=Object(w.getKey)(e);switch(i){case w.Keys.Enter:var o=this.getHoverItem();o&&(Object(m.stopBubble)(e),o.click());break;case w.Keys.ArrowUp:case w.Keys.ArrowDown:if(window.__WPSENV__.store.getState().public.alt.isInMode)break;var a=i===w.Keys.ArrowUp;this.setPreSelectItem(a,e),this.props.isPreSelectCloseDropdown&&f.default.dispatchEvent(f.default.names.CLOSE_DROPDOWN_PANEL)}}}}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("panel-item");if(n.length){Object(m.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);o.classList.add("hover"),this.showPreSelectItem(o)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var a=i-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){i=a;break}}else for(var s=i+1;s<t.length;s++)if(-1===t[s].className.indexOf("disabled")){i=s;break}return t[Math.max(0,i)]}},{key:"showPreSelectItem",value:function(e){e.scrollIntoViewIfNeeded(),this.props.onItemHover&&this.props.onItemHover(e,!1)}},{key:"getElement",value:function(){return this.refPanel.current}},{key:"getContentElement",value:function(){return this.refContent.current}},{key:"getPanelStyle",value:function(){if(this.props.canResize){var e=this.state;return{width:e.width,height:e.height}}var t=this.props,n=t.width,i=t.minWidth,o=t.maxWidth;if(n||i||o)return{width:n,minWidth:i,maxWidth:o}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,i=e.canResize,o="dropdown-panel";e.isAuto&&(o+=" "+this.officeType),i&&(o+=" can-resize"),t&&(o+=" "+t);var a=this.getPanelStyle();return p.a.createElement("div",{ref:this.refPanel,className:o,style:a,tabIndex:0,onKeyDown:this.handleWindowKeyDown,onMouseMove:this.handleMouseMove,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onScroll:this.handleScroll,"data-keep-edit":!0},p.a.createElement("div",{ref:this.refContent,className:"dropdown-panel-content","data-keep-edit":!0},n),p.a.createElement("div",{className:"drag-hand rightBottom","data-orien":_,onMouseDown:this.handleDragMouseDown},p.a.createElement(v.default,{type:v.default.types.other.drag_right_bottom})),p.a.createElement("div",{className:"drag-hand right","data-orien":E,onMouseDown:this.handleDragMouseDown}),p.a.createElement("div",{className:"drag-hand bottom","data-orien":T,onMouseDown:this.handleDragMouseDown}))}}]),t}(c.PureComponent);b.Item=y.default,b.Divider=g.a,b.defaultProps={isAuto:!0,scrollEndBottom:10,enabledHotKey:!0},t.default=b},183:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=(n(353),n(142)),p=n.n(c),h=n(151),f=n.n(h),m=n(148),v=function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),u=0;u<s;u++)r[u]=arguments[u];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.refWrap=p.a.createRef(),a=n,l()(i,a)}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.selected,o="component-icon-text-btn";return e.isDropdown&&(o+=" dropdown"),e.isReverse&&(o+=" reverse"),n&&(o+=" disabled"),i&&(o+=" selected"),e.showBorder&&(o+=" show-border"),t&&(o+=" "+t),o}},{key:"getElement",value:function(){return this.refWrap.current}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.children,i=e.disabled,o=e.title,a=e.iconType,s=e.keepEdit,r=e.onClick,l=e.onMouseEnter,u=e.onMouseLeave;i&&(r=void 0);var d=this.getClassName();return p.a.createElement(f.a,{title:o,onMouseEnter:l,onMouseLeave:u},p.a.createElement("div",{ref:this.refWrap,id:t,onClick:r,className:d,"data-keep-edit":s||void 0},p.a.createElement(m.default,{type:a}),p.a.createElement("div",{className:"btn-text"},n)))}}]),t}(c.PureComponent);v.iconTypes=m.default.types,t.default=v},1830:function(e,t,n){},1834:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=n(142),p=n.n(c),h=n(311),f=(n(1835),function(e){function t(){var e,n,i,a;o()(this,t);for(var s=arguments.length,r=Array(s),u=0;u<s;u++)r[u]=arguments[u];return n=i=l()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.handleMouseDown=function(){if(i.playGIF(),"play"===i.coreView.getMode()){var e=i.props.shapeView.shapeData;i.doc.changeMediaPlay({slideId:e.getSlideId(),shapeId:e.getId(),type:t.GIFPlayEvent})}},i.handlePlayChange=function(e){if(e&&e.data){var n=e.data,o=n.type,a=n.slideId,s=n.shapeId,r=i.props.shapeView,l=r&&r.shapeData;o===t.GIFPlayEvent&&!i.isUnmount&&l&&l.getSlideId()===a&&l.getId()===s&&i.playGIF()}},i.handleMoveLoadRect=function(e){if(e&&!i.isUnmount&&i.gifMaskRef){var t=e.shapeData,n=e.params;t===i.props.shapeView.shapeData&&(i.gifMaskRef.style.left=i.pos.x+n.dx+"px",i.gifMaskRef.style.top=i.pos.y+n.dy+"px")}},a=n,l()(i,a)}return d()(t,e),s()(t,[{key:"playGIF",value:function(){this.props.shapeView.loadOriginGIF(),this.forceUpdate()}},{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.MOVING_SHAPE_BOX,this.handleMoveLoadRect),this.doc.on(this.viewEventTypes.MEDIA_PLAY_CHANGE,this.handlePlayChange)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.MEDIA_PLAY_CHANGE,this.handlePlayChange)}},{key:"render",value:function(){var e=this,t=this.props,n=t.shapeView,i=t.scale,o=this.props.shapeView.preloadingOriginURL,a=null;if(i){var s=n.getUilLayoutRect(i),r=s.x,l=s.y,u=s.width,d=s.height,c=s.horizontalFlipped,h=s.verticalFlipped;a={position:"absolute",left:r,top:l,width:u,height:d,transform:"rotate("+s.rotation+"deg) scale("+(c?-1:1)+", "+(h?-1:1)+")"},this.pos={x:r,y:l}}return p.a.createElement("div",{className:"gif-uil-mask",style:a,ref:function(t){return e.gifMaskRef=t}},!o&&p.a.createElement("div",{className:"gif-uil-btn",onMouseDown:this.handleMouseDown,onTouchStart:this.handleMouseDown},p.a.createElement("i",{className:"btn-icon"})),o&&p.a.createElement("div",{className:"gif-loading"}))}}]),t}(h.PubComponent));f.GIFPlayEvent="gif_play_event",t.a=f},1835:function(e,t,n){},1836:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=n(142),f=n.n(h),m=(n(1837),function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!0},n}return p()(t,e),l()(t,[{key:"onImageReloadClick",value:function(e){this.setState({show:!1}),window.collection("newui","value","pic_reload_click"),e.reloadResource()}},{key:"getAbsStyleByRect",value:function(e){var t=e.x,n=e.y,i=e.width,o=e.height,a=e.rotate;return{position:"absolute",left:t,top:n,width:i=Math.ceil(i)+1,height:o=Math.ceil(o)+1,transform:"rotate("+a+"deg)"}}},{key:"UNSAFE_componentWillReceiveProps",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this,t=!0,n=!0,i=this.props,a=i.scale,s=i.shapeView,r=s.getUilLayoutRect(a),l=r.width,u=r.height;(l<132||u<100)&&(t=!1),l<50&&u<50&&(n=!1);var d=r&&this.getAbsStyleByRect(r)||{};return d.left=d.left||0,d.top=d.top||0,this.state.show&&window.collection("newui","value","pic_reload_show"),this.state.show&&f.a.createElement("div",{className:"image_reload_box",style:o()({},d),key:s.getId(),ref:function(t){return window.domTools.addEventListener(t,"mouseup",(function(t){t.stopPropagation(),e.onImageReloadClick(s)}))}},f.a.createElement("div",{className:"image_reload_warpper"},n&&f.a.createElement("svg",{className:"image_reload_icon",width:"48px",height:"48px",viewBox:"0 0 48 48",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},f.a.createElement("g",{id:"svg_loading",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},f.a.createElement("path",{d:"M24,8 C28.018529,8 31.6910445,9.48146032 34.5011884,11.928023 L32.428,14 L32.3068736,13.9997718 C30.0542763,12.1265449 27.1586975,11 24,11 C16.8202983,11 11,16.8202983 11,24 C11,31.1797017 16.8202983,37 24,37 C31.1797017,37 37,31.1797017 37,24 C37,23.85876 36.9977476,23.718046 36.9932767,23.5778921 L37.07,23.5 L39.9923454,23.5003049 C39.9974361,23.6662463 40,23.8328237 40,24 C40,32.836556 32.836556,40 24,40 C15.163444,40 8,32.836556 8,24 C8,15.163444 15.163444,8 24,8 Z",fill:"#E2E6ED",fillRule:"nonzero"}),f.a.createElement("circle",{fill:"#E2E6ED",fillRule:"nonzero",cx:"38.5",cy:"23.5",r:"1.5"}),f.a.createElement("rect",{fill:"#E2E6ED",fillRule:"nonzero",x:"27",y:"13",width:"9",height:"3",rx:"1.5"}),f.a.createElement("rect",{fill:"#E2E6ED",fillRule:"nonzero",transform:"translate(34.500000, 11.500000) rotate(-90.000000) translate(-34.500000, -11.500000) ",x:"30",y:"10",width:"9",height:"3",rx:"1.5"}))),t&&f.a.createElement("div",{className:"image_reload_text"},_i18n("applications.presentation.common.components.imageReload.reloadText", "加载失败，点击刷新"))))}}]),t}(n(311).PubComponent));t.a=m},1837:function(e,t,n){},1863:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(154),p=n.n(c),h=n(42),f=n.n(h),m=n(168),v=n.n(m),y=n(142),g=n.n(y),w=(n(800),n(148)),E=n(616),T=n(502),_=function(e){function t(){var e,n,i,o;s()(this,t);for(var a=arguments.length,r=Array(a),l=0;l<a;l++)r[l]=arguments[l];return n=i=d()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.getClassName=function(){var e=i.props,t=e.className,n="video media_container";return t&&(n+=" "+t),e.isFullscreen&&(n+=" fullscreen"),n},i.getMaskClassName=function(){var e=i.props,t=e.showPoster,n=e.isPlay,o=e.loading,a="video_mask";return(t||n&&!o)&&(a+=" hidden"),a},o=n,d()(i,o)}return f()(t,e),l()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.style,i=t.showPoster,o=t.toolbar,a=t.muted,s=t.isFullscreen;return g.a.createElement("div",{ref:function(t){return e.rootRef=t},className:this.getClassName(),style:n},g.a.createElement("video",{ref:function(t){return e.videoRef=t},className:"video_player "+(i?"":"show")+" "+(s?"fullscreen":""),muted:a,volume:.5}),g.a.createElement("div",{className:this.getMaskClassName()}),o)}}]),t}(y.PureComponent);_.defaultProps={muted:!1};var b=_,P=n(179),k=n(208),S=w.default.types.size24,R=k.userAgent.isPad,C=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleDocChange=function(e){clearTimeout(n.getDataTimer),n.getDataTimer=setTimeout((function(){!n.props.onlyTool||n.rootRef&&n.videoRef&&n.maskRef||(n._init(),n._bindEvent(),n.srcData&&n.setSrc(n.srcData))}),150)},n.insertNodeAfterShape=function(e,t,i){n.rootRef&&(window.domTools.setStyle(n.rootRef,i),n.rootRef.childElementCount<2&&(n.rootRef.innerHTML=null,n.rootRef.appendChild(n.videoRef),n.rootRef.appendChild(n.maskRef)),n.doc.insertNodeAfterShapeById(e,t,n.rootRef),n.state.isPlay&&n.play())},n._init=function(){var e=n.props,t=e.onlyTool,i=e.id;t?(n.rootRef=document.getElementById("media_container_"+i),n.videoRef=document.getElementById("media_player_"+i),n.maskRef=document.getElementById("video_mask_"+i)):(n.rootRef=n.bodyRef&&n.bodyRef.rootRef,n.videoRef=n.bodyRef&&n.bodyRef.videoRef),n.rootRef&&n.videoRef?window.collection("newui","value",window.pcTrack.newui.video_load):window.collection("newui","value",window.pcTrack.newui.video_load_fail)},n._bindEvent=function(){window.domTools.addEventListener(n.toolbarRef,"mousedown",n.onToolBarMouseDown),n.rootRef&&(n.props.onlyTool||(n.rootRef.addEventListener("mouseenter",n.showTool),n.rootRef.addEventListener("mouseleave",n.hiddenTool)),document.addEventListener("mousemove",n.handleMouseMoveRoot),n.rootRef.addEventListener("mousedown",n.handleRootMouseDown),n.rootRef.addEventListener("click",n.handleRootClick),R&&(n.rootRef.addEventListener("touchstart",n.handleRootMouseDown),n.rootRef.addEventListener("touchend",n.toggleTool))),n.videoRef&&(n.videoRef.ondurationchange=n.handleDurationChange,n.videoRef.onprogress=n.handleProgress,n.videoRef.ontimeupdate=n.handleTimeUpdate,n.videoRef.muted=n.props.muted),n.btnRef&&!n.props.isExplainPlay&&n.btnRef.addEventListener("click",n.handleBtnClick),n.on(n.uiEventTypes.pc.ON_FULLSCREEN_CHANGE,n.handleCheckFullScreen)},n._unbindEvent=function(){window.domTools.removeEventListener(n.toolbarRef,"mousedown",n.onToolBarMouseDown),n.rootRef&&(n.props.onlyTool||(n.rootRef.removeEventListener("mouseenter",n.showTool),n.rootRef.removeEventListener("mouseleave",n.hiddenTool)),document.removeEventListener("mousemove",n.handleMouseMoveRoot),n.rootRef.removeEventListener("mousedown",n.handleRootMouseDown),n.rootRef.removeEventListener("click",n.handleRootClick),R&&(n.rootRef.removeEventListener("touchstart",n.handleRootMouseDown),n.rootRef.removeEventListener("touchend",n.toggleTool))),n.btnRef&&!n.props.isExplainPlay&&n.btnRef.removeEventListener("click",n.handleBtnClick),n.videoRef&&n.videoRef.pause()},n.onToolBarMouseDown=function(e){e&&e.stopPropagation()},n.toggleTool=function(){if(!n.props.isPlayMode){var e=!n.isToolShow;n.changeToolbarVisible(e)}},n.showTool=function(){n.needHidden=!1,clearTimeout(n.hideToolbarTimer),n.changeToolbarVisible(!0)},n.hiddenTool=function(){n.needHidden=!0,clearTimeout(n.hideToolbarTimer),n.hideToolbarTimer=setTimeout((function(){n.isHoverTool||(n.changeToolbarVisible(!1),n.needHidden=!1)}),500)},n.handleMouseMoveRoot=function(e){n.state.isFullscreen&&(e&&e.stopPropagation(),clearTimeout(n.hideToolbarTimer),!n.isToolShow&&n.changeToolbarVisible(!0),n.hideToolbarTimer=setTimeout((function(){n.changeToolbarVisible(!1)}),2e3))},n.handleRootClick=function(e){n.state.isFullscreen&&!n.toolbarRef.contains(e.target)&&(e&&e.stopPropagation(),n.handleChangePlay())},n.handleRootMouseDown=function(e){n.state.isFullscreen&&e&&e.stopPropagation()},n.handleBtnClick=function(e){(!n.props.isPlayMode||n.state.isFullscreen||R||n.isRemarksWin)&&(e&&e.stopPropagation(),n.handleChangePlay(e))},n.handleTimeChange=function(e,t){n.isOperate=!0,t?n.setState({currentTime:e}):(n.props.handlePlayStatusChange&&n.props.handlePlayStatusChange({id:n.id,currentTime:e,isMediaPlay:n.isPlay}),n.changeCurrentTime(e))},n.changeCurrentTime=function(e){if(e=Number(e),!isNaN(e)){n.videoRef&&!isNaN(n.videoRef.duration)&&(n.videoRef.currentTime=e),n.startPlayTime=e;var t=n.state,i=t.bufferTime,o=t.isPlay,a=i<e;n.setState({currentTime:e,loading:a,showPoster:!1}),n.props.onlyTool&&n.handleMaskVisible({isPlay:o,loading:a,showPoster:!1})}},n.handleMaskVisible=function(e){var t=e.isPlay,i=e.loading,o=e.showPoster;t&&!i?n.maskRef.classList.add("hidden"):n.maskRef.classList.remove("hidden"),o?n.videoRef.classList.remove("show"):n.videoRef.classList.add("show")},n.handleDurationChange=function(){n.videoRef.duration&&(n.setState({totalTime:n.videoRef.duration-n.props.trimEndTime}),n.props.handleDurationChange&&n.props.handleDurationChange(n.videoRef.duration))},n.handleTimeUpdate=function(){var e=n.state,t=e.totalTime,i=e.isPlay,o=e.showPoster,a=n.props,s=a.trimStartTime,r=a.onlyTool,l=a.checkMediaTime,u=a.slideId,d=a.shapeId;l&&l();var c=n.videoRef.currentTime<n.startPlayTime;c!==n.state.loading&&r&&n.handleMaskVisible({isPlay:i,showPoster:o,loading:c}),t>0&&(Math.abs(n.currentTime-t)<.15||n.currentTime>=t)?n.props.loop?(isNaN(n.videoRef.duration)||(n.videoRef.currentTime=s),n.setState({currentTime:s,loading:!1}),n.play()):(n.pause(),n.setState({currentTime:t,loading:!1},(function(){n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:u,shapeId:d}),clearTimeout(n.returnTimer),n.returnTimer=setTimeout((function(){isNaN(n.videoRef.duration)||(n.videoRef.currentTime=s),n.setState({currentTime:s,loading:!1})}),300)}))):n.currentTime>s?n.setState({currentTime:n.currentTime,loading:c}):n.currentTime<s&&!isNaN(n.videoRef.duration)&&((!k.userAgent.isIPad||s-n.currentTime>.3)&&(n.videoRef.currentTime=s),n.setState({currentTime:s,loading:c}))},n.handleChangePlay=function(e){e&&e.stopPropagation(),n.props.readonly||(n.isOperate=!0,n.props.handlePlayStatusChange&&n.props.handlePlayStatusChange({id:n.id,currentTime:n.currentTime,isMediaPlay:!n.isPlay,isFullScreen:!!n.isFullscreen}),n.isPlay?n.pause():n.play(!0))},n.onPlayError=function(){var e=n.props,t=e.slideId,i=e.shapeId;n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:t,shapeId:i,error:!0})},n.play=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!n.props.isEmbed)return window.Toast.error(_i18n("applications.presentation.components.public.Media.notFindVideo", "无法播放，找不到链接的视频文件")),void n.onPlayError();var t=n.state,i=t.playError,o=t.serverError,a=t.loading;if(o)window.Toast.error("close"===o?_i18n("applications.presentation.components.public.Media.serverClose", "音视频播放暂不可用"):_i18n("applications.presentation.components.public.Media.serverError", "无法连接到服务器，请检查网络后重试。"));else if(!e&&i)window.Toast.error(_i18n("applications.presentation.components.public.Media.videoPlayError", "无法播放该格式视频"));else if(!a&&e&&i)n.setState({isPlay:!0,loading:!0,showPoster:!1}),n.props.getMediaUrl&&n.props.getMediaUrl(!0),n.props.transFirst&&n.props.transFirst(),n.needPlay=!0;else if(!i){n.setState({isPlay:!0,loading:!0,showPoster:!1});var s=n.props,r=s.updateMediaSrc,l=s.onlyTool,u=s.transFirst;l&&n.handleMaskVisible({isPlay:!0,loading:!0,showPoster:!1}),n.hasSrc?r(n._play):(u&&u(),n.needPlay=!0)}(o||i)&&n.onPlayError()},n._play=function(e){e&&n.setSrc(e);var t=n.props,i=t.trimStartTime,o=t.onlyTool,a=t.onPlay;!isNaN(n.videoRef.duration)&&(n.currentTime>=n.state.totalTime||n.currentTime<i)&&(n.videoRef.currentTime=i);var s=n.videoRef.play();s&&s.then((function(){n.startPlayTime=n.videoRef.currentTime,n.needPlay=!1,a&&a()})).catch((function(e){n.onPlayError(),n.videoRef&&n.videoRef.paused&&(n.setState({isPlay:!1,loading:!1}),o&&n.handleMaskVisible({isPlay:!1,loading:!1,showPoster:n.state.showPoster}),window.collection("newui","value",window.pcTrack.newui.video_file_play_fail))}))},n.pause=function(){n.hasSrc?(n.videoRef&&n.videoRef.pause(),n.setState({isPlay:!1}),n.props.onlyTool&&n.handleMaskVisible({isPlay:!1,loading:n.state.loading,showPoster:n.state.showPoster})):n.needPlay=!1},n.setPlayStatus=function(e){var t=e.isMediaPlay,i=e.currentTime,o=e.restart,a=n.state,s=a.isPlay,r=a.currentTime,l=n.props,u=l.trimStartTime,d=l.trimEndTime;o&&n.handleStartTimeChange({trimStartTime:u,trimEndTime:d}),s===t?o||isNaN(i)||r===i||n.changeCurrentTime(i):t?(o||isNaN(i)||n.changeCurrentTime(i),n.play()):n.pause()},n.setSrc=function(e){if(e.serverError||e.err)return window.collection("newui","value",window.pcTrack.newui.video_file_url_fail),void n.setState({playError:e.err,serverError:e.serverError,isPlay:!1,loading:!1},(function(){n.needPlay&&n.play(),n.props.onlyTool&&n.handleMaskVisible({isPlay:!1,loading:!1,showPoster:n.state.showPoster})}));if(e.url){if(!n.videoRef)return void(n.srcData=e);n.videoRef.src=e.url,n.videoRef.load(),n.hasSrc=!0,n.setState({serverError:!1,playError:!1},(function(){n.needPlay&&n.play()}))}},n.setStyle=function(e){var t=n.props.onlyTool;n.state.isFullscreen&&t&&n.rootStyle?n.state.style=e:n.setState({style:e})},n.changeToolbarVisible=function(e){n.toolbarRef&&(e?(n.isToolShow=!0,n.toolbarRef.style.height="42px",n.toolbarRef.style.opacity="1",n.toolbarRef.style.visibility="visible"):(n.isToolShow=!1,n.toolbarRef.style.height="0",n.toolbarRef.style.opacity="0",n.toolbarRef.style.visibility="hidden"))},n.handleProgress=function(){var e=n.videoRef.buffered;if(e.length>=1){var t=e.end(e.length-1);n.setState({bufferTime:t})}},n.doFullScreen=function(){!n.isSupportFullScreen||k.userAgent.isAndroidPad&&k.userAgent.isWpsClient?window.Toast.warn(_i18n("applications.presentation.components.public.Media.unSupportFullScreen", "当前浏览器不支持全屏播放")):n.props.onlyTool?n.handlePlayFullscreen():(n.handleFullscreen(),n.doc.fire(n.eventTypes.OPENAPI_EVENT.VIDEO_FULLSCREEN_INFO,!n.isFullscreen))},n.handleCheckFullScreen=function(e){var t=n.props.onlyTool;clearTimeout(n.checkFSTimer),n.checkFSTimer=setTimeout((function(){!n.isPlayFullScreen&&n.videoFullScreen&&n.handlePlayExistFullscreen();var e=t?n.videoFullScreen:n.isFullscreen;n.setState({isFullscreen:e}),n.onFullscreen(e)}),50)},n.handleFullscreen=function(e){e&&e.stopPropagation(),n.state.isFullscreen?n.exitFullscreen():n.requestFullscreen()},n.handlePlayFullscreen=function(e){e&&e.stopPropagation(),n.state.isFullscreen?n.handlePlayExistFullscreen():n.handlePlayEnterFullscreen()},n.handlePlayEnterFullscreen=function(){n.isPlayFullScreen||!n.enabledFullScreen?(n.setState({isFullscreen:!0}),n.onFullscreen(!0),n.dispatchEvent(n.uiEventTypes.names.NOTIFY_FULLSCREEN_ENTER)):n.fire(n.uiEventTypes.pc.play.CLICK_LANCH_FULLSCREEN),n.toolWrapRef.classList.add("video-toolbar-fullscreen"),n.rootRef.classList.add("video-fullscreen"),n.handleSvgFullScreen(!0),n.videoFullScreen=!0,n.setState({isFullscreen:!0}),n.doc.fire(n.eventTypes.OPENAPI_EVENT.VIDEO_FULLSCREEN_INFO,!0)},n.handlePlayExistFullscreen=function(){n.isPlayFullScreen&&n.fire(n.uiEventTypes.pc.play.CLICK_EXIT_FULLSCREEN,{from:"video_play"}),!n.enabledFullScreen&&n.dispatchEvent(n.uiEventTypes.names.NOTIFY_FULLSCREEN_EXIT),n.toolWrapRef&&n.toolWrapRef.classList.remove("video-toolbar-fullscreen"),n.rootRef&&n.rootRef.classList.remove("video-fullscreen");var e=n.getToolWrapStyle();window.domTools.setStyle(n.toolWrapRef,e),window.domTools.setStyle(n.rootRef,n.rootStyle),n.handleSvgFullScreen(!1),n.videoFullScreen=!1,n.onFullscreen(!1),n.setState({isFullscreen:!1}),n.doc.fire(n.eventTypes.OPENAPI_EVENT.VIDEO_FULLSCREEN_INFO,!1)},n.handleSvgFullScreen=function(e){n.$root||(n.$root=n.app.container.querySelector(".play_root_container")),n.$root&&(e?n.$root.classList.add("svg-video-fullscreen"):n.$root.classList.remove("svg-video-fullscreen"))},n.onFullscreen=function(e){n.fire(n.uiEventTypes.names.ON_VIDEO_FULLSCREEN,e),e?n.uilHotkeys.setStopKeyEvent(!0):n.uilHotkeys.setStopKeyEvent(!1)},n.requestFullscreen=function(){if(n.isPlayFullScreen||!n.enabledFullScreen)n.setState({isFullscreen:!0}),n.onFullscreen(!0),n.$layer=n.app.container.querySelector(".uil-floating-menu-area"),n.bodyRef.rootRef.classList.add("video-toolbar-fullscreen"),n.rootRef.classList.add("video-fullscreen"),document.getElementById("shape-uil-box").classList.remove("shape-box-video-fullscreen"),document.getElementById("uil-content").classList.remove("shape-box-video-fullscreen"),document.getElementById("shape-uil-box").className+=" shape-box-video-fullscreen",document.getElementById("uil-content").className+="shape-box-video-fullscreen",n.$layer&&n.$layer.classList.add("helper-fullscreen"),n.dispatchEvent(n.uiEventTypes.names.NOTIFY_FULLSCREEN_ENTER);else{var e=n.rootRef;p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"requestFullscreen",n).call(n,e).catch((function(e){console.log("video full screen error",e)}))}},n.exitFullscreen=function(){n.enabledFullScreen?p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"exitFullscreen",n).call(n):(n.setState({isFullscreen:!1}),n.onFullscreen(!1),n.bodyRef.rootRef.classList.remove("video-toolbar-fullscreen"),document.getElementById("shape-uil-box").classList.remove("shape-box-video-fullscreen"),n.$layer&&n.$layer.classList.remove("helper-fullscreen"),document.getElementById("uil-content").classList.remove("shape-box-video-fullscreen"),n.dispatchEvent(n.uiEventTypes.names.NOTIFY_FULLSCREEN_EXIT))},n.handleChangeMuted=function(e){e&&e.stopPropagation();var t=!n.state.muted;n.setState({muted:t}),n.videoRef&&(n.videoRef.muted=t)},n.handleVolumeChange=function(e){var t=0===e;n.setState({volume:e,muted:t});var i=Number((e/100).toFixed(2));n.videoRef&&(n.videoRef.volume=i,n.videoRef.muted=t)},n.handleStartTimeChange=function(e){var t=e.trimStartTime,i=e.trimEndTime;n.state.currentTime=t,n.startPlayTime=t,n.videoRef.duration&&(n.state.totalTime=n.videoRef.duration-i),isNaN(n.videoRef.duration)||(n.videoRef.currentTime=t)},n.onMouseEnterTool=function(){n.isToolShow&&n.props.onlyTool&&(n.isHoverTool=!0,clearTimeout(n.hideToolbarTimer))},n.onMouseLeaveTool=function(){n.isHoverTool=!1,n.isToolShow&&n.props.onlyTool&&n.needHidden&&(clearTimeout(n.hideToolbarTimer),n.hideToolbarTimer=setTimeout((function(){n.changeToolbarVisible(!1),n.needHidden=!1}),500))},n.getBtnClassName=function(){var e=n.state,t=e.loading,i=e.isPlay,o=e.isFullscreen,a=n.props,s=a.onlyTool,r="video-btn";return s||(r+=" normal"),!t&&i?r+=" hidden":t&&i&&(r+=" loading"),o&&s&&(r+=" video-btn-fullscreen"),a.isExplainPlay&&(r+=" disable"),r},n.getBtnStyle=function(){var e=n.state.style;return{position:"absolute",left:e.width/2,bottom:e.height/2,transform:"translate(-50%, 50%)"}},n.getToolWrapStyle=function(){var e=n.state.style,t=o()({},e);return t.top=t.top+t.height,t.height=0,t},n.setVisible=function(e){e?(n.rootRef&&n.rootRef.classList.remove("hidden"),n.toolWrapRef&&n.toolWrapRef.classList.remove("hidden"),n.maskRef&&n.maskRef.classList.remove("hidden")):(n.rootRef&&n.rootRef.classList.add("hidden"),n.toolWrapRef&&n.toolWrapRef.classList.add("hidden"),n.maskRef&&n.maskRef.classList.add("hidden"))},n.changeMediaStyle=function(e,t){if(n.props.onlyTool&&n.rootRef&&n.toolWrapRef){for(var i in e)n.rootRef.style[i]=e[i];for(var o in t)n.toolWrapRef.style[o]=t[o]}},n.getIsOperate=function(){return n.isOperate},n.setIsOperate=function(e){n.isOperate=e},n.onToolBarClick=function(e){e&&e.stopPropagation()},n.state={showPoster:!0,loading:e.needPlay,isPlay:e.needPlay,currentTime:e.trimStartTime,bufferTime:0,style:e.style,volume:e.volume,muted:e.muted,playError:!1,serverError:!1,isFullscreen:!1},n.id=e.id,n.startPlayTime=0,n.needPlay=e.needPlay,n.hasSrc=!1,n.mediaEvent=n.uiEventTypes.pc.media,n}return f()(t,e),l()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(this.viewEventTypes.DOC_CHANGE,this.handleDocChange),this._init(),this._bindEvent(),this.doc.on(this.eventTypes.OPENAPI_EVENT.EXIT_VIDEO_FULLSCREEN,this.handlePlayExistFullscreen)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.DOC_CHANGE,this.handleDocChange),this._unbindEvent(),this.doc.off(this.eventTypes.OPENAPI_EVENT.EXIT_VIDEO_FULLSCREEN,this.handlePlayExistFullscreen),this.state.isFullscreen&&(this.props.onlyTool?this.handlePlayExistFullscreen():this.exitFullscreen())}},{key:"componentDidUpdate",value:function(e){p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),JSON.stringify(this.props.style)!==JSON.stringify(e.style)&&this.setState({style:this.props.style})}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentTime,i=t.totalTime,o=t.isPlay,a=t.bufferTime,s=t.muted,r=t.volume,l=t.isFullscreen,u=t.style,d=t.loading,c=t.showPoster,p=this.props,h=p.readonly,f=p.trimStartTime,m=p.transDegree,v=p.onlyTool,_=p.stopWPClick,P=this.getBtnClassName(),k=g.a.createElement(y.Fragment,null,g.a.createElement("div",{ref:function(t){return e.btnRef=t},className:P,style:v&&this.getBtnStyle()},g.a.createElement("i",{className:"video-icon"}),m&&d&&g.a.createElement("div",{className:"loading-text"},_i18n("applications.presentation.components.public.Media.transforming", "转码中")+" "+m)),g.a.createElement("div",{className:"media-tool player-bar-wrap "+(h?"readonly":""),onMouseEnter:this.onMouseEnterTool,onMouseLeave:this.onMouseLeaveTool,onClick:this.onToolBarClick,ref:function(t){return e.toolbarRef=t}},!h&&g.a.createElement(w.default,{className:"small-play-btn",onClick:this.handleChangePlay,type:o?S.wpp_play_stop:S.wpp_play_start}),g.a.createElement(E.default,{className:"media-tool player-time-bar",min:f,max:i,value:n,bufferValue:a,handleValueChange:this.handleTimeChange,disabled:h,places:2,onMouseUp:_,showNumTip:!1,isMediaStyle:!0}),g.a.createElement("div",{className:"play-time"},Object(T.getFormatTime)(n)),g.a.createElement(w.default,{className:"volume-btn",onClick:this.handleChangeMuted,type:s?S.media_muted:S.media_volume}),g.a.createElement(E.default,{className:"media-tool player-volume-bar",value:s?0:r,handleValueChange:this.handleVolumeChange,onMouseUp:_,showNumTip:!1,isMediaStyle:!0}),g.a.createElement(w.default,{onClick:this.doFullScreen,type:l?S.wpp_play_exit_fullscreen:S.wpp_play_fullscreen})));return v?g.a.createElement("div",{ref:function(t){return e.toolWrapRef=t},className:"media-tool-container video",style:this.getToolWrapStyle()},k):g.a.createElement(b,{ref:function(t){return e.bodyRef=t},toolbar:k,muted:s,transDegree:m,isPlay:o,loading:d,style:u,showPoster:c,isFullscreen:l})}},{key:"isFullscreen",get:function(){var e=p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"isFullscreen",this);return this.rootRef&&e===this.rootRef}},{key:"isPlayFullScreen",get:function(){return p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"isFullscreen",this)}},{key:"isPlay",get:function(){return this.videoRef&&!this.videoRef.paused}},{key:"currentTime",get:function(){return this.videoRef?this.videoRef.currentTime:0}},{key:"duration",get:function(){return this.videoRef&&this.videoRef.duration}}]),t}(P.BaseComponent);C.propTypes={className:v.a.string,style:v.a.object,id:v.a.string,handlePlayStatusChange:v.a.func,muted:v.a.bool,volume:v.a.number,readonly:v.a.bool,loop:v.a.bool,trimStartTime:v.a.number,trimEndTime:v.a.number,onMouseEnter:v.a.func,transDegree:v.a.string,onlyTool:v.a.bool},C.defaultProps={muted:!1,volume:50,trimStartTime:0,trimEndTime:0};var M=C,I=n(1494),N=n(2590),L=n.n(N),O=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.reInit=function(e,t){n.id=e,n.audioRef.currentTime=0,n.audioRef.muted=!1,n.audioRef.volume=.5,n.startPlayTime=0,n.setState({isPlay:!1,muted:!1,volume:50,bufferTime:0,currentTime:0,loading:!1,serverError:!1,playError:!1},(function(){t&&t()}))},n.handleTimeChange=function(e,t){n.props.setIsOperate&&n.props.setIsOperate(!0),t||(n.props.handlePlayStatusChange&&n.props.handlePlayStatusChange({id:n.id,currentTime:e,isMediaPlay:n.isPlay}),n.changeCurrentTime(e))},n.changeCurrentTime=function(e){e=Number(e),isNaN(e)||(n.startPlayTime=e,n.setState({currentTime:e},(function(){n.audioRef&&!isNaN(n.audioRef.duration)&&(n.audioRef.currentTime=e)})))},n.handleStartTimeChange=function(e){var t=e.trimStartTime,i=e.trimEndTime;n.state.currentTime=t,n.startPlayTime=t,n.audioRef.duration&&(n.state.totalTime=n.audioRef.duration-i),isNaN(n.audioRef.duration)||(n.audioRef.currentTime=t)},n.handleDurationChange=function(){if(n.audioRef.duration){var e=n.props,t=e.handleDurationChange,i=e.trimEndTime;n.setState({totalTime:n.audioRef.duration-i}),t&&t(n.audioRef.duration)}},n.handleTimeUpdate=function(){var e=n.state.totalTime,t=n.props,i=t.trimStartTime,o=t.checkMediaTime,a=t.slideId,s=t.shapeId;o&&o();var r=n.currentTime<n.startPlayTime;e>0&&(Math.abs(n.currentTime-e)<.15||n.currentTime>=e)?n.props.loop?(isNaN(n.audioRef.duration)||(n.audioRef.currentTime=i),n.setState({currentTime:i,loading:!1}),n.play(),n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:a,shapeId:s})):(n.pause(),n.setState({currentTime:e,loading:!1},(function(){clearTimeout(n.returnTimer),n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:a,shapeId:s}),n.returnTimer=setTimeout((function(){n.setState({currentTime:i,loading:!1}),isNaN(n.audioRef.duration)||(n.audioRef.currentTime=i)}),300)}))):n.currentTime>i?n.setState({loading:r,currentTime:n.currentTime}):n.currentTime<i&&!isNaN(n.audioRef.duration)&&((!k.userAgent.isIPad||i-n.currentTime>.3)&&(n.audioRef.currentTime=i),n.setState({currentTime:i,loading:r}))},n.handleChangePlay=function(){n.props.setIsOperate&&n.props.setIsOperate(!0),n.props.handlePlayStatusChange&&n.props.handlePlayStatusChange({id:n.id,currentTime:n.currentTime,isMediaPlay:!n.isPlay}),n.isPlay?n.pause():n.play(!0)},n.onPlayError=function(){var e=n.props,t=e.slideId,i=e.shapeId;n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:t,shapeId:i,error:!0})},n.play=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!n.props.isEmbed)return window.Toast.error(_i18n("applications.presentation.components.public.Media.notFindAudio", "无法播放，找不到链接的音频文件")),void n.onPlayError();var t=n.state,i=t.playError,o=t.serverError,a=t.loading;o?window.Toast.error("close"===o?_i18n("applications.presentation.components.public.Media.serverClose", "音视频播放暂不可用"):_i18n("applications.presentation.components.public.Media.serverError", "无法连接到服务器，请检查网络后重试。")):!e&&i?window.Toast.error(_i18n("applications.presentation.components.public.Media.audioPlayError", "无法播放该格式音频")):!a&&e&&i?(n.setState({isPlay:!0,loading:!0}),n.props.getMediaUrl&&n.props.getMediaUrl(!0),n.props.transFirst&&n.props.transFirst(),n.needPlay=!0):i||(n.setState({isPlay:!0,loading:!0}),n.hasSrc?n.props.updateMediaSrc&&n.props.updateMediaSrc(n._play):(n.props.transFirst&&n.props.transFirst(),n.needPlay=!0)),(o||i)&&n.onPlayError()},n._play=function(e){e&&(console.log("update media src audio",e),n.setSrc(e));var t=n.props.trimStartTime;!isNaN(n.audioRef.duration)&&(n.currentTime>=n.state.totalTime||n.currentTime<t)&&(n.audioRef.currentTime=t);var i=n.audioRef.play();i&&i.then((function(){n.startPlayTime=n.audioRef.currentTime,n.needPlay=!1,n.props.onPlay&&n.props.onPlay(!0)})).catch((function(e){n.onPlayError(),n.audioRef&&n.audioRef.paused&&(n.setState({isPlay:!1,loading:!1}),window.collection("newui","value",window.pcTrack.newui.audio_file_play_fail))}))},n.pause=function(){n.setState({isPlay:!1}),n.hasSrc?(n.audioRef.pause(),n.props.onPlay&&n.props.onPlay(!1)):n.needPlay=!1},n.handleProgress=function(){var e=n.audioRef.buffered;if(e.length>=1){var t=e.end(e.length-1);n.setState({bufferTime:t}),n.isPlay||n.setState({loading:t<n.startPlayTime})}},n.handleChangeMuted=function(e){n.setState({muted:!n.state.muted})},n.handleVolumeChange=function(e,t){if(!t){var i=0===e;n.setState({volume:e,muted:i});var o=Number((e/100).toFixed(2));n.audioRef.volume=o}},n.setPlayStatus=function(e){var t=e.isMediaPlay,i=e.currentTime,o=e.restart,a=n.state,s=a.isPlay,r=a.currentTime,l=n.props,u=l.trimStartTime,d=l.trimEndTime;o&&n.handleStartTimeChange({trimStartTime:u,trimEndTime:d}),s===t?o||isNaN(i)||r===i||n.changeCurrentTime(i):t?(o||isNaN(i)||n.changeCurrentTime(i),n.play()):n.pause()},n.setSrc=function(e){if(e.serverError||e.err)return window.collection("newui","value",window.pcTrack.newui.audio_file_url_fail),void n.setState({serverError:e.serverError,playError:e.err,isPlay:!1,loading:!1},(function(){n.needPlay&&n.play()}));n.audioRef.src=e.url,n.audioRef.load(),n.hasSrc=!0,n.setState({serverError:!1,playError:!1},(function(){n.needPlay&&n.play()}))},n.handleAudioBarClick=function(e){e&&e.stopPropagation(),n.props.onAudioClick&&n.props.onAudioClick()},n.state={isPlay:!1,totalTime:0,currentTime:e.trimStartTime,bufferTime:0,muted:e.muted,volume:e.volume,serverError:!1,playError:!1},n.id=e.id,n.hasSrc=!1,n.startPlayTime=0,n}return f()(t,e),l()(t,[{key:"getClassName",value:function(){var e=this.props.className,t="audio player-contianer";return e&&(t+=" "+e),t}},{key:"_checkIsVisibleShape",value:function(){if(this.doc.getMode()!==k.ViewModes.PlayView)return!0;var e=this.props.shapeId;return!Object(I.b)(this.doc).reduce((function(e,t){return t?e.concat(t):e}),[]).includes(e)}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentTime,i=t.totalTime,o=t.isPlay,a=t.bufferTime,s=t.muted,r=t.volume,l=t.loading,u=this.props,d=u.src,c=u.audioStyle,p=u.onMouseEnter,h=u.onMouseLeave,f=u.autoPlay,m=u.trimStartTime,v=u.id,y=u.stopWPClick,w=u.showToolBar,E=this._checkIsVisibleShape();return g.a.createElement("div",{className:this.getClassName(),style:c,onMouseEnter:p,onMouseLeave:h,onClick:this.handleAudioBarClick},g.a.createElement("audio",{ref:function(t){return e.audioRef=t},id:"media_player_"+v,src:d,muted:s,volume:.5,onDurationChange:this.handleDurationChange,onProgress:this.handleProgress,autoPlay:f,onTimeUpdate:this.handleTimeUpdate}),E&&g.a.createElement(L.a,{id:v,loading:l,isPlay:o,trimStartTime:m,totalTime:i,currentTime:n,bufferTime:a,muted:s,volume:r,showToolBar:w,onTimeChange:this.handleTimeChange,onPlayChange:this.handleChangePlay,onVolumeChange:this.handleVolumeChange,onTimeBarMouseUp:y,onVolumeBarMouseUp:y,onMutedChange:this.handleChangeMuted}))}},{key:"isPlay",get:function(){return this.audioRef&&!this.audioRef.paused}},{key:"currentTime",get:function(){return this.audioRef?this.audioRef.currentTime:0}},{key:"duration",get:function(){return this.audioRef&&this.audioRef.duration}}]),t}(P.BaseComponent);O.propTypes={className:v.a.string,srcArr:v.a.array,showToolBar:v.a.bool,muted:v.a.bool,volume:v.a.number,style:v.a.object,handlePlayStatusChange:v.a.func,loop:v.a.bool,autoPlay:v.a.bool,trimStartTime:v.a.number,trimEndTime:v.a.number},O.defaultProps={muted:!1,volume:50,startTime:0,trimStartTime:0,trimEndTime:0};var D=O,A=function(e){function t(){return s()(this,t),d()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f()(t,e),l()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.audioIcon,i=t.style,o=t.AudioShape,a=t.isIE,s=T.AudioAnime[n]||"";return!a&&o.isPlay&&(s+=" show"),g.a.createElement("div",{ref:function(t){return e.rootRef=t},className:"audio-shape-wrap",style:i},g.a.createElement("div",{ref:function(t){return e.iconRef=t},className:s}))}}]),t}(P.BaseComponent);A.propTypes={audioIcon:v.a.string,style:v.a.object.isRequired,AudioShape:v.a.object.isRequired,isIE:v.a.bool};var V=A,B=n(144),F=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateToolStyle=function(){n.isShapeActived&&n.props.shapeView&&(clearTimeout(n.updateTimer),n.updateTimer=setTimeout((function(){var e=n.doc.getZoom(),t=n.props.shapeView.getUilLayoutRect(e);n.setState({moveRect:t})}),150))},n.reInit=function(e,t){n.id=e,n.audioRef&&n.audioRef.reInit(e,t)},n.insertNodeAfterShape=function(e,t,i){n.rootRef&&(window.domTools.setStyle(n.rootRef,i),n.iconRef&&n.rootRef.childElementCount<1&&n.rootRef.appendChild(n.iconRef),n.doc.insertNodeAfterShapeById(e,t,n.rootRef))},n._init=function(){var e=n.props,t=e.onlyTool,i=e.id;t?(n.rootRef=document.getElementById("media_container_"+i),n.iconRef=document.getElementById("audio_icon_"+i)):(n.rootRef=n.bodyRef&&n.bodyRef.rootRef,n.iconRef=n.bodyRef&&n.bodyRef.iconRef),n.rootRef?window.collection("newui","value",window.pcTrack.newui.audio_load):window.collection("newui","value",window.pcTrack.newui.audio_load_fail)},n.showTool=function(){n.shapeHidden||(n.needHidden=!1,n._showToolbar())},n.hiddenTool=function(){n.needHidden=!0,n._hiddenToolbar()},n.getStyle=function(){var e=n.state,t=e.style,i=e.moveRect,o=n.props,a=o.shapeRect;if(o.isPlayMode)return{audioStyle:t&&n.getAudioStyleByStyle(t)};var s=a;return i&&Date.now()-i.timeStamp<100&&(s=i),{audioStyle:n.getAudioStyleByRect(s),shapeStyle:{position:"absolute",left:s.x+1,top:s.y+1,width:s.width,height:s.height}}},n.getAudioStyleByStyle=function(e){var t=e.left<0?0:e.left,n=e.right&&e.right<0?0:e.right,i=e.top-64,o=document.body.getBoundingClientRect(),a=o.width,s=o.height;return t+360>a&&(t=a-360),n&&n+360>a&&(n=a-360),i<0&&(i=e.top+e.height)+64>=s&&(i=0),n?{right:n,top:i}:{left:t,top:i}},n.getAudioStyleByRect=function(e){var t=n.props.slideUilView,i=e.x,o=e.y,a=e.height,s=i,r=o-64;if(t&&t.rootViewRef&&t.$container){var l=t.rootViewRef.getBoundingClientRect(),u=l.left,d=l.top,c=t.$container.getBoundingClientRect(),p=c.width,h=c.left,f=c.top,m=c.height,v=i+u-h;v<0&&(s=h-u),v+360>p&&(s=p-360-u+h),r+d-f<0&&(r=o+a)+d-f+64>=m&&(r=f-d)}return{left:s,top:r}},n.setSrc=function(e){return n.audioRef.setSrc(e)},n.setStyle=function(e){return n.setState({style:e})},n.setPlayStatus=function(e){n.audioRef.setPlayStatus(e)},n.play=function(){return n.audioRef.play()},n.pause=function(){return n.audioRef.pause()},n.handleStartTimeChange=function(e){n.audioRef.handleStartTimeChange(e)},n._showToolbar=function(){var e=n.props.activeShapes;e&&1===e.length&&e[0].isAudio()||(clearTimeout(n.mouseLeaveTimer),n.setState({mouseInEl:!0}))},n._hiddenToolbar=function(){clearTimeout(n.mouseLeaveTimer),n.mouseLeaveTimer=setTimeout((function(){n.isHoverTool||(n.setState({mouseInEl:!1}),n.needHidden=!1)}),500)},n.enterToolbar=function(){n.isShapeActived||(n.isHoverTool=!0,clearTimeout(n.mouseLeaveTimer),n.setState({mouseInEl:!0}))},n.leaveToolbar=function(){n.isShapeActived||(n.isHoverTool=!1,n.needHidden&&n._hiddenToolbar())},n.updateRect=function(e){var t=n.props.shapeRect,i=e.dx,a=e.dy,s=o()({},t);s.timeStamp=Date.now(),s.x=s.x+i,s.y=s.y+a,n.setState({moveRect:s})},n.setMoving=function(e){n.setState({moving:e})},n.onPlay=function(e){B.isIE||!e||n.shapeHidden?n.iconRef&&n.iconRef.classList.remove("show"):n.iconRef&&n.iconRef.classList.add("show"),e&&n.props.onAudioPlay&&n.props.onAudioPlay()},n.handleChange=function(){setTimeout((function(){n.isShapeActived||(n.audioRef&&n.audioRef.isPlay&&n.audioRef.pause(),n.setState({mouseInEl:!1}),n.isHoverTool=!1)}),100)},n.setVisible=function(e){e?(n.rootRef&&n.rootRef.classList.remove("hidden"),n.shapeHidden=!1):(n.rootRef&&n.rootRef.classList.add("hidden"),n.shapeHidden=!0,n._hiddenToolbar())},n.getIsOperate=function(){return n.isOperate},n.setIsOperate=function(e){n.isOperate=e},n.handleChangePlay=function(){return n.audioRef&&n.audioRef.handleChangePlay()},n.state={showToolBar:!0,mouseInEl:!1,style:e.style,moving:!1},n.mediaEvent=n.uiEventTypes.pc.media,n.id=e.id,n.shapeHidden=!1,n}return f()(t,e),l()(t,[{key:"onSafeBindEvent",value:function(){this._init(),!this.props.onlyTool&&this.rootRef&&(this.rootRef.addEventListener("mouseenter",this.showTool),this.rootRef.addEventListener("mouseleave",this.hiddenTool)),this.doc.on(this.viewEventTypes.ZOOM_CHANGE,this.updateToolStyle),this.on(this.uiEventTypes.pc.ON_EDITVIEW_SCROLL,this.updateToolStyle)}},{key:"onUnBindEvent",value:function(){!this.props.onlyTool&&this.rootRef&&(this.rootRef.removeEventListener("mouseenter",this.showTool),this.rootRef.removeEventListener("mouseleave",this.hiddenTool)),this.doc.off(this.viewEventTypes.ZOOM_CHANGE,this.updateToolStyle)}},{key:"componentDidUpdate",value:function(e){p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this);var n=this.props.style;JSON.stringify(n)!==JSON.stringify(e.style)&&this.setState({style:n})}},{key:"render",value:function(){var e=this,t=this.state,n=t.mouseInEl,i=t.moving,a=this.props,s=a.audioIcon,r=a.onlyTool,l=a.hiddenTool,u=n||!l&&this.isShapeActived;(l||i)&&(u=!1);var d=this.getStyle(),c=d.shapeStyle,p=d.audioStyle;return g.a.createElement(y.Fragment,null,!r&&g.a.createElement(V,{ref:function(t){return e.bodyRef=t},audioIcon:s,style:c,AudioShape:this,isIE:B.isIE}),g.a.createElement(D,o()({ref:function(t){return e.audioRef=t},onMouseEnter:this.enterToolbar,onMouseLeave:this.leaveToolbar,onPlay:this.onPlay,audioStyle:p,showToolBar:u,setIsOperate:this.setIsOperate},this.props)))}},{key:"isShapeActived",get:function(){var e=this.props,t=e.shapeData,n=e.activeShapes;return n&&1===n.length&&n.includes(t)}},{key:"isPlay",get:function(){return this.audioRef&&this.audioRef.isPlay}},{key:"currentTime",get:function(){return this.audioRef&&this.audioRef.currentTime}},{key:"duration",get:function(){return this.audioRef&&this.audioRef.duration}},{key:"media",get:function(){return this.audioRef&&this.audioRef.audioRef}},{key:"isToolShow",get:function(){var e=this.state,t=e.mouseInEl;return!e.moving&&(t||this.isShapeActived)}}]),t}(P.BaseComponent);F.propTypes={hiddenTool:v.a.bool};var x=F,H=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getMediaUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=n.props,i=t.shapeData,o=t.type,a=i.getMedia(),s=a.mediaId,r=a.sha1;window.mediaManager.getMediaData({mediaId:s,isReTransErr:e,data:{type:o,sha1:r}},(function(e){console.log(s,"web get media url",e),n.mediaRef&&n.mediaRef.setSrc(e)})),i.isVideo()&&(n.onGetDegreeName=window.mediaManager.getOnDegreeName(s),window.mediaManager.on(n.onGetDegreeName,n.handleTransDegree))},n.setPlayStatus=function(e){n.mediaRef&&n.mediaRef.setPlayStatus(e),n.mediaRef&&n.mediaRef.setIsOperate(!1)},n.setVisible=function(e){n.mediaRef&&n.mediaRef.setVisible(e)},n.setStyle=function(e){n.mediaRef&&n.mediaRef.setState({style:e})},n.changeMediaStyle=function(e,t){var i=n.props.shapeData;n.mediaRef&&i.isVideo()&&n.mediaRef.changeMediaStyle(e,t)},n.getTimeRange=function(e){var t=e.getMedia(),n=t.trimStartTime,i=t.trimEndTime;return{trimStartTime:Object(T.getTimeByTrim)(n),trimEndTime:Object(T.getTimeByTrim)(i)}},n.setDurationInPool=function(e){var t=n.props.shapeData.getMedia();window.mediaManager.setMediaDuration({mediaId:t.mediaId,duration:e})},n.handleChange=function(){var e=n.props,t=e.shapeData,i=e.endAfterSlide,o=n.state.timeRange,a=o.trimStartTime,s=o.trimEndTime,r=n.getTimeRange(t);if(a===r.trimStartTime&&s===r.trimEndTime||(n.mediaRef&&n.mediaRef.handleStartTimeChange(r),n.setState({timeRange:n.getTimeRange(t)})),"audio"===n.props.type){var l=n.selection.getActiveSlideIdx();n.props.isPlayMode?i&&l>i&&n.mediaRef&&n.mediaRef.pause():n.mediaRef&&n.mediaRef.handleChange()}},n.updateRect=function(e){n.mediaRef&&n.mediaRef.updateRect(e)},n.setMoving=function(e){n.mediaRef&&n.mediaRef.setMoving(e)},n.onAudioClick=function(){n.props.isPlayMode||n.mediaRef.isShapeActived||n.selection.selectShape(n.props.shapeData)},n.transFirst=function(){var e=n.props,t=e.shapeData,i=e.type,o=t.getMedia(),a=o.mediaId,s=o.sha1;window.mediaManager.transFirst({key:a,data:{type:i,sha1:s}}),console.log("media shape trans first",a)},n.updateMediaSrc=function(e){var t=n.props.shapeData.getMedia().mediaId;window.mediaManager.updateMediaUrl({mediaId:t,cb:e})},n.handleTransDegree=function(e){var t=void 0===e?"":e+"%";n.setState({transDegree:t})},n.onPlay=function(){var e=n.doc.getMode(),t=n.props.type+"_play_";e===P.ViewModes.PlayView?t+="'show":t+="edit",window.collection("newui","value",window.pcTrack.newui[t],n.duration)},n.insertNodeAfterShape=function(e,t,i){return n.mediaRef&&n.mediaRef.insertNodeAfterShape(e,t,i)},n.checkMediaTime=function(){if(n.isRemarksWin&&window.opener&&n.mediaRef&&!n.mediaRef.getIsOperate()){n.speakermedia||(n.speakermedia=window.opener.document.getElementById("media_player_"+n.id));var e="video"===n.props.type?n.mediaRef.videoRef:n.mediaRef.media;if(n.speakermedia&&e&&n.speakermedia.paused===e.paused){var t=n.speakermedia.currentTime-n.currentTime;Math.abs(t)>.5&&(e.currentTime=n.speakermedia.currentTime)}}},n.onHoverMedia=function(e,t){t&&Date.now()-n._lastHoverTime<50||(e!==n.id||t&&n.mediaRef.isToolShow?n.mediaRef&&n.mediaRef.hiddenTool():n.mediaRef&&n.mediaRef.showTool(),n._lastHoverTime=Date.now())},n.changePlay=function(){n.mediaRef&&n.mediaRef.handleChangePlay()},n.isVideoClickBtn=function(){var e=n.props,t=e.needPlayMsg,i=e.shapeData,o=i.getSlideId()+"_"+i.getId();return t&&t.id===o&&Date.now()-t.time<500},n.state={timeRange:n.getTimeRange(e.shapeData),transDegree:""},n.id=e.id,n}return f()(t,e),l()(t,[{key:"onSafeBindEvent",value:function(){var e=this.isVideoClickBtn();this.getMediaUrl(e),this.doc.on(this.viewEventTypes.SELECT_SHAPE_CHANGE,this.handleChange)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.SELECT_SHAPE_CHANGE,this.handleChange),this.onGetDegreeName&&window.mediaManager.off(this.onGetDegreeName,this.handleTransDegree)}},{key:"componentDidUpdate",value:function(){var e=this;p()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.id!==this.props.id&&(this.id=this.props.id,this.mediaRef&&this.mediaRef.reInit&&this.mediaRef.reInit(this.id,(function(){var t=e.isVideoClickBtn();e.getMediaUrl(t)})))}},{key:"getCommonProps",value:function(){var e=this.state.timeRange,t=this.props.shapeData,n=t.getMedia().isEmbed,i=t.getSlideId(),a=t.getId();return o()({},e,{id:i+"_"+a,isEmbed:n,slideId:i,shapeId:a,muted:this.isRemarksWin,handleDurationChange:this.setDurationInPool,transFirst:this.transFirst,updateMediaSrc:this.updateMediaSrc,checkMediaTime:this.checkMediaTime,getMediaUrl:this.getMediaUrl})}},{key:"render",value:function(){var e=this,t=this.state.transDegree,n=this.props,i=n.type,a=n.shapeData,s=this.getCommonProps();if("video"===i){var r=this.isVideoClickBtn();return g.a.createElement(M,o()({ref:function(t){return e.mediaRef=t},transDegree:t,needPlay:r,onPlay:this.onPlay},s,this.props))}if("audio"===i){var l=Object(T.getAudioIcon)(a);return g.a.createElement(x,o()({ref:function(t){return e.mediaRef=t},onAudioClick:this.onAudioClick,audioIcon:l,onAudioPlay:this.onPlay},s,this.props))}}},{key:"isPlay",get:function(){return this.mediaRef&&this.mediaRef.isPlay}},{key:"currentTime",get:function(){return this.mediaRef&&this.mediaRef.currentTime}},{key:"duration",get:function(){return this.mediaRef&&this.mediaRef.duration}}]),t}(P.BaseComponent);H.propTypes={className:v.a.string};t.a=H},1864:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=n(142),p=n.n(c),h=(n(1241),n(191)),f={top:"top",left:"left",right:"right",bottom:"bottom",bottomLeft:"bottom-left",bottomRight:"bottom-right",topLeft:"top-left",topRight:"top-right"},m=n(26),v=n.n(m),y=n(144),g=n(145),w=y.isMobile,E=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rect:null,style:{visibility:"hidden",top:0,left:0},arrowStyle:null},n.arrowSize=6,n.handleWindowClick=n.handleWindowClick.bind(n),n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.getStyle(),this.props.onVisibleChange&&this.props.onVisibleChange(!0),this.props.isClickClosed&&(!w&&window.addEventListener("click",this.handleWindowClick),w&&window.addEventListener("touchstart",this.handleWindowClick,{passive:!1}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.rect;e.rect!==n&&n&&this.getStyle()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleWindowClick),window.removeEventListener("touchstart",this.handleWindowClick,{passive:!1})}},{key:"handleWindowClick",value:function(e){var t=this.popoverContentDom,n=e.target,i=this.props,o=i.onClose,a=i.onVisibleChange;document.body.contains(n)&&!t.contains(n)&&(Object(g.stopBubble)(e),o&&o(),a&&a(!1))}},{key:"getStyle",value:function(){var e=this.props,t=e.rect,n=e.placement,i=e.offsetX,o=e.offsetY;if(!t||!this.popoverContentDom)return this.state.style;var a=document.body.clientWidth,s=this.popoverContentDom,r=s.offsetWidth,l=s.offsetHeight,u=void 0,d=void 0;switch(n){case f.left:u={top:t.top+t.height/2-l/2+o,right:a-t.left+i},d={top:l/2-this.arrowSize-o};break;case f.right:u={top:t.top+t.height/2-l/2+o,left:t.right+i},d={top:l/2-this.arrowSize-o};break;case f.bottomRight:u={top:t.bottom+o,right:a-t.right+i},d={right:this.arrowSize+10-i};break;case f.bottomLeft:u={top:t.bottom+o,left:t.left+i},d={left:this.arrowSize+10};break;case f.bottom:u={top:t.bottom+o,left:t.right-r/2-t.width/2+i},d={left:r/2-this.arrowSize};break;case f.top:u={top:t.top-l+o,left:t.right-r/2-t.width/2+i},d={left:r/2-this.arrowSize};break;case f.topRight:u={top:t.top-l+o,right:a-t.right-i},d={right:this.arrowSize+10};break;case f.topLeft:u={top:t.top-l+o,left:t.left+i},d={left:this.arrowSize+10}}if(this.props.autoAdjustOverflow){if(u.left&&(u.left=Math.max(u.left,0)),u.right&&(u.right=Math.max(u.right,0)),a-(u.left+r)<0){switch(n){case f.top:case f.topLeft:case f.bottom:case f.bottomLeft:d={left:d.left-(a-(u.left+r))+10}}u.left=void 0,u.right=10}a-(u.right+r)<0&&(u.left=0,u.right=void 0)}this.setState({style:u,arrowStyle:d})}},{key:"getPixelRatio",value:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,i=t.children,o=t.placement,a=t.autoAdjustOverflow,s=t.drawArrow,r=this.state.arrowStyle,l=v()({},this.state.style,this.props.style);a||(l=v()({},l,{whiteSpace:"nowrap"}));var u="component-popover "+o;return n&&(u+=" "+n),p.a.createElement("div",{ref:function(t){return e.popoverContentDom=t},className:u,style:l},s&&p.a.createElement("div",{className:"popover-arrow "+o,style:r}),p.a.createElement("div",{className:"popover-body"},i))}}]),t}(c.PureComponent);E.defaultProps={offsetX:0,offsetY:0,isClickClosed:!0,drawCanvas:!1,drawArrow:!0};var T=E,_=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1,wrap:null},n.saveWrap=function(e){n.wrap=e},n.handleMouseEnter=n.handleMouseEnter.bind(n),n.handleMouseLeave=n.handleMouseLeave.bind(n),n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.setState({visible:!0})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&this.setState({visible:n})}},{key:"getRect",value:function(){var e=this.wrap;return this.state.visible&&e?(e=this.props.children?e.children[0]:e.parentNode).getBoundingClientRect():null}},{key:"handleMouseEnter",value:function(){this.props.proactiveTrigger&&this.setState({visible:!0})}},{key:"handleMouseLeave",value:function(){this.props.proactiveTrigger&&this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.popoverClass,i=e.popoverStyle,o=e.content,a=e.placement,s=e.onClose,r=e.onVisibleChange,l=e.offsetX,u=e.offsetY,d=e.containerClassName,c=e.autoAdjustOverflow,f=e.drawArrow,m=e.isClickClosed,v=e.getContainer,y=this.state.visible,g=this.getRect();return p.a.createElement("popover-container",{className:d,ref:this.saveWrap,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},y&&p.a.createElement(h.default,{visible:!0,className:"wpp-popup",getContainer:v},p.a.createElement(T,{className:n,visible:y,rect:g,style:i,offsetX:l,offsetY:u,placement:a,onClose:s,onVisibleChange:r,isClickClosed:m,autoAdjustOverflow:c,drawArrow:f},o)),t)}}]),t}(c.PureComponent);_.placementTypes=f,_.defaultProps={placement:f.bottomRight,autoAdjustOverflow:!0};var b=_,P=n(148),k=(n(1830),function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.content,i=e.onClose;return p.a.createElement("div",{className:"wpp-guide-tip-panel"},p.a.createElement("div",{className:"wpp-guide-tip-header"},p.a.createElement(P.default,{className:"tip-icon",type:P.default.types.other.meeting_tips}),p.a.createElement("p",{className:"tip-title"},t),p.a.createElement(P.default,{className:"close-btn",type:P.default.types.other.close,onClick:i})),n&&p.a.createElement("p",{className:"wpp-guide-tip-detail"},n))}}]),t}(c.PureComponent)),S=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowGuideTip=function(e){var t=e.detail,i=!(!t||!t.isClosed);n.setState({visible:!i}),n.props.onShowGuideTip&&n.props.onShowGuideTip()},n.onCloseGuideTiplose=function(e){n.setState({visible:!1}),n.props.onCloseGuideTip&&n.props.onCloseGuideTip()},n.refPopover=p.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.state={visible:e.defaultVisible},n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.props.eventName&&window.addEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.addEventListener("keydown",this.handleWindowKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize),this.props.eventName&&window.removeEventListener(this.props.eventName,this.onShowGuideTip),this.props.isEscClosed&&document.removeEventListener("keydown",this.handleWindowKeyDown)}},{key:"handleWindowKeyDown",value:function(e){var t=e.code,n=e.keyCode;"Escape"!==t&&27!==n||this.state.visible&&(this.stopBubble(e),this.onCloseGuideTiplose())}},{key:"stopBubble",value:function(e){(e=e||window.event).stopPropagation?e.stopPropagation():e.cancelBubble=!0}},{key:"handleVisibleChange",value:function(e){this.setState({visible:e})}},{key:"handleWindowResize",value:function(){this.refPopover.current.forceUpdate()}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.content,o=e.popoverClass,a=e.placement,s=e.offsetX,r=e.offsetY,l=e.isClickClosed,u=e.getContainer,d=e.drawArrow;if(!n&&!i)return null;var c=this.state.visible,h=p.a.createElement(k,{onClose:this.onCloseGuideTiplose,title:n,content:i});return p.a.createElement(b,{ref:this.refPopover,placement:a,visible:c,content:h,popoverClass:o,offsetX:s,offsetY:r,autoAdjustOverflow:!0,onVisibleChange:this.handleVisibleChange,isClickClosed:l,getContainer:u,drawArrow:d},t)}}]),t}(c.PureComponent);S.defaultProps={popoverClass:"",placement:b.placementTypes.bottomLeft,offsetX:0,offsetY:0,isClickClosed:!0,isEscClosed:!0,defaultVisible:!1},S.placementTypes=b.placementTypes;t.default=S},1982:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=(n(295),n(142)),p=n.n(c),h=n(146),f=n(145),m=n(241),v=n(172),y=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollSelectedChildren=function(){var e=n.refContent.current;if(e)for(var t=0;t<e.childElementCount;t++){var i=e.children[t];if(i.classList.contains("selected")){i.scrollIntoViewIfNeeded();break}}},n.refPanel=p.a.createRef(),n.refContent=p.a.createRef(),n.handleKeyDown=n.handleKeyDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.officeType=Object(f.getPageOfficeType)(),n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){var t=e.refPanel.current;t&&(t.focus(),e.scrollSelectedChildren())}),10)}},{key:"getHoverItem",value:function(){return this.refPanel.current.getElementsByClassName("hover")[0]}},{key:"handleKeyDown",value:function(e){if(this.props.enabledHotKey){var t=document.activeElement,n=t.tagName;if(!("TEXTAREA"===n||"INPUT"===n||"true"===t.contentEditable)||t.hasAttribute("data-keep-wsad"))switch(e.keyCode){case 13:var i=this.getHoverItem();i&&(Object(f.stopBubble)(e),i.click());break;case 38:case 40:var o=38===e.keyCode;this.setPreSelectItem(o,e);break;case 9:case 39:var a=this.getHoverItem();if(a){Object(f.stopBubble)(e);var s={visible:!0,element:a,parent:this.refPanel.current};h.default.dispatchEvent(h.default.names.SUB_MENU_VISIBLE_CHANGE,s)}break;case 37:Object(f.stopBubble)(e),this.props.onLeftArrow&&this.props.onLeftArrow()}}}},{key:"handleMouseMove",value:function(e){var t=this.refPanel.current;if(!t.contains(document.activeElement)&&t.contains(e.target)&&t.focus(),this.props.onItemHover){var n=this.getHoverItem();this.props.onItemHover(n,t)}}},{key:"handleMouseOut",value:function(){if(this.props.onItemHover){var e=this.getHoverItem();this.props.onItemHover(e,this.refPanel.current)}}},{key:"setPreSelectItem",value:function(e,t){var n=this.refPanel.current.getElementsByClassName("component-menu-item");if(n.length){Object(f.stopBubble)(t);var i=this.getHoverItem();i&&i.classList.remove("hover");var o=this.getPreSelectItem(e,n,i);if(o.classList.add("hover"),o.scrollIntoViewIfNeeded(),i!==o){var a={visible:!1,element:i,parent:this.refPanel.current};h.default.dispatchEvent(h.default.names.SUB_MENU_VISIBLE_CHANGE,a)}this.props.onItemHover&&this.props.onItemHover(o,this.refPanel.current)}}},{key:"getPreSelectItem",value:function(e,t,n){for(var i=-1,o=0;o<t.length;o++)if(t[o]===n){i=o;break}if(e){for(var a=i-1;a>=0;a--)if(-1===t[a].className.indexOf("disabled")){i=a;break}}else for(var s=i+1;s<t.length;s++)if(-1===t[s].className.indexOf("disabled")){i=s;break}return t[Math.max(0,i)]}},{key:"preSelectFirst",value:function(){this.setPreSelectItem(!0,null),this.refPanel.current.focus()}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.isAuto,i=e.children,o=e.onScroll,a=e.onMouseEnter,s="component-menu";return n&&(s+=" "+this.officeType),t&&(s+=" "+t),p.a.createElement("div",{ref:this.refPanel,className:s,tabIndex:0,onKeyDown:this.handleKeyDown,onScroll:o,onMouseMove:this.handleMouseMove,onMouseEnter:a,onMouseOut:this.handleMouseOut},p.a.createElement("div",{ref:this.refContent,className:"menu-content"},i))}}]),t}(c.PureComponent);y.Divider=m.default,y.Item=v.default,y.defaultProps={isAuto:!0,enabledHotKey:!0},t.default=y},209:function(e,t,n){},213:function(e,t,n){"use strict";t.a={topCenter:"topCenter",topRight:"topRight",topLeft:"topLeft",bottomLeft:"bottomLeft",bottomRight:"bottomRight",rightBottom:"rightBottom",leftBottom:"leftBottom"}},219:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=n(142),p=n.n(c),h=n(146),f=n(145),m=n(286),v=n(166),y=n(203),g=v.default.triggerTypes,w=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.isUnmount=!1,n.preSelectFirst=!1,n.delayShowSubMenuTimer=null,n.isMouseOut=!1,n.refDiv=p.a.createRef(),n.refMenu=p.a.createRef(),n.refDropDownBtn=p.a.createRef(),n.handleVisibleChange=n.handleVisibleChange.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.onMouseLeaveDropBtn=n.onMouseLeaveDropBtn.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.handleSubMenuVisible=n.handleSubMenuVisible.bind(n),n.handleSubMenuLeftArrow=n.handleSubMenuLeftArrow.bind(n),n.startDelayVisibleChange=n.startDelayVisibleChange.bind(n),n.clearDelayShowSubMenu=n.clearDelayShowSubMenu.bind(n),n.onMouseEnterMenu=n.onMouseEnterMenu.bind(n),n}return d()(t,e),s()(t,[{key:"componentDidMount",value:function(){window.addEventListener(h.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.addEventListener(h.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.removeEventListener(h.default.names.SUB_MENU_VISIBLE_CHANGE,this.handleSubMenuVisible),window.removeEventListener(h.default.names.CLEAR_DELAY_SHOW_SUB_MENU,this.clearDelayShowSubMenu)}},{key:"handleSubMenuVisible",value:function(e){var t=e.detail,n=t.visible,i=t.element,o=t.parent;i===this.refDiv.current&&(n?(this.isMouseOut=!1,this.state.visible?this.refMenu.current.preSelectFirst():(this.preSelectFirst=!0,this.parentNode=o,this.refDiv.current.click())):this.state.visible&&(this.setState({visible:!1}),this.parentNode&&this.parentNode.focus()))}},{key:"startDelayVisibleChange",value:function(e){var t=this;e?(h.default.dispatchEvent(h.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.delayShowSubMenuTimer=setTimeout((function(){t.handleVisibleChange(!0)}),250)):this.handleVisibleChange(!1)}},{key:"clearDelayShowSubMenu",value:function(){clearTimeout(this.delayShowSubMenuTimer)}},{key:"handleVisibleChange",value:function(e){var t=this;if(!this.isUnmount){if(!e&&this.state.visible){var n=Object(m.a)(this.refDiv.current);if(Object(m.b)(n+2))return;this.props.onItemHover&&this.props.onItemHover(null,null)}this.setState({visible:e},(function(){e&&t.preSelectFirst&&(t.preSelectFirst=!1,t.refMenu.current.preSelectFirst()),e||t.isMouseOut&&t.refDiv.current.classList.remove("hover"),t.props.onVisibleChange&&t.props.onVisibleChange(e)}))}}},{key:"handleMouseMove",value:function(){this.isMouseOut=!1,this.activateSubMenuHover()}},{key:"onMouseLeaveDropBtn",value:function(){this.clearDelayShowSubMenu()}},{key:"activateSubMenuHover",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++){var i=t[n];if(i!==e){i.classList.remove("hover");break}}e.classList.add("hover")}},{key:"onMouseEnterMenu",value:function(){h.default.dispatchEvent(h.default.names.CLEAR_DELAY_SHOW_SUB_MENU),this.activateSubMenuHover()}},{key:"handleMouseOut",value:function(e){this.isMouseOut=!0,this.state.visible||Object(f.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"handleSubMenuLeftArrow",value:function(){var e=this;this.props.onItemHover&&this.props.onItemHover(null,null),this.setState({visible:!1},(function(){e.refDiv.current.focus()}))}},{key:"getClassName",value:function(){var e=this.props,t=e.visible,n=e.selected,i=e.disabled,o=e.className,a="component-menu-item sub-menu-item";o&&(a+=" "+o);var s=this.refDiv.current;return(t||s&&-1!==s.className.indexOf(" hover"))&&(a+=" hover"),n&&(a+=" selected"),this.state.visible&&(a+=" sub-visible"),i&&(a+=" disabled"),a}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.subClassName,o=e.destroyOnHide,a=e.trigger,s=e.onItemHover,r=e.showScrollBar,l=e.offsetX,u=e.disableContentMouseLeave,d=e.placement,c=e.enabledHotKey,h=this.state.visible,f=this.getClassName(),m=p.a.createElement(y.default,{ref:this.refMenu,className:i,showScrollBar:r,onItemHover:s,onMouseEnter:this.onMouseEnterMenu,onLeftArrow:this.handleSubMenuLeftArrow,enabledHotKey:c},t);return p.a.createElement(v.default,{isAuto:!0,panel:m,visible:h,distance:0,offsetX:l,trigger:a,destroyOnHide:o,onVisibleChange:this.startDelayVisibleChange,onMouseLeaveDropBtn:this.onMouseLeaveDropBtn,placement:d,disableContentMouseLeave:u,ref:this.refDropDownBtn},p.a.createElement("div",{ref:this.refDiv,className:f,tabIndex:0,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut},n))}}]),t}(c.PureComponent);w.triggerTypes=g,w.defaultProps={trigger:g.hover,offsetX:8,placement:v.default.placementTypes.rightBottom},t.default=w},226:function(e,t,n){"use strict";n.r(t);var i=n(26),o=n.n(i),a=n(44),s=n.n(a),r=n(0),l=n.n(r),u=n(3),d=n.n(u),c=n(25),p=n.n(c),h=n(42),f=n.n(h),m=n(142),v=n.n(m),y=n(145),g=n(151),w=n.n(g),E=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isHover:!1},n.refDiv=v.a.createRef(),n.handleClick=n.handleClick.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n}return f()(t,e),d()(t,[{key:"handleClick",value:function(e){this.props.onClick&&this.props.onClick(this.props.value,e)}},{key:"handleMouseMove",value:function(){for(var e=this.refDiv.current,t=e.parentNode.getElementsByClassName("hover"),n=0;n<t.length;n++)if(t[n]!==e){t[n].classList.remove("hover");break}e.classList.add("hover")}},{key:"handleMouseOut",value:function(e){Object(y.isMouseInElement)(e,this.refDiv.current)||this.refDiv.current.classList.remove("hover")}},{key:"getElement",value:function(){return this.refDiv.current}},{key:"getClassName",value:function(){var e=this.props,t=e.disabled,n=e.selected,i=e.className,o=e.children,a="panel-item",r=this.refDiv.current;r&&-1!==r.className.indexOf(" hover")&&(a+=" hover"),t&&(a+=" disabled"),n&&(a+=" selected");var l=void 0===o?"undefined":s()(o);return"string"!==l&&"number"!==l||(a+=" only-text"),i&&(a+=" "+i),a}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.title,i=e.value,a=e.children,s=e.getStyle,r=e.visible,l=e.dataKey,u=e.keepEdit,d=e.draggable,c=e.onMouseEnter,p=e.onMouseLeave,h=e.onDragEnter,f=e.onDragStart,m=e.onDragEnd;if(!r)return!1;var y=this.getClassName(),g=s?s(i):null,E={};return c&&(E.onMouseEnter=c),p&&(E.onMouseLeave=p),v.a.createElement(w.a,o()({title:n},E),v.a.createElement("div",o()({ref:this.refDiv,id:t,className:y,style:g,"data-key":l||void 0,"data-keep-edit":u||void 0,draggable:d,onClick:this.handleClick,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onDragStart:f,onDragEnter:h,onDragEnd:m},E),a))}}]),t}(m.PureComponent);E.defaultProps={visible:!0},t.default=E},229:function(e,t,n){"use strict";n.r(t);var i=n(150),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=(n(260),n(142)),f=n.n(h),m=n(144),v=n(145),y=n(169),g=n(146),w=n(213),E=n(286),T=n(26),_=n.n(T);var b=function(e,t,n,i){n=function(e){var t=_()({},e),n=window.scrollY;return e&&n&&(t.top+=n,t.bottom+=n),t}(n);var o=void 0;switch(window.rightToLeft&&(e=/(Left|left)/.test(e)?e.replace("Left","Right").replace("left","right"):e.replace("Right","Left").replace("right","left")),e){case w.a.topCenter:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body.clientHeight,s=t.left+t.width/2-i/2,r=t.top-n,l=a-t.bottom-n,u=t.top-n-o,d=t.bottom+n;return{left:s,top:r>=o?u:l>=o?d:r>=50||r>=l?u:d}}(t,n,i);break;case w.a.topRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=t.right,u=s-t.left,d=t.right-i,c=t.left,p=void 0;p=l>=i?d:u>=i?c:l>=50||l>=u?d:c;var h=r-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:p,top:f>=o?v:h>=o||h>=50||h>=f?m:v}}(t,n,i);break;case w.a.topLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=t.right,u=s-t.left,d=t.right-i,c=t.left,p=void 0;p=u>=i?c:l>=i||l>=50||l>=u?d:c;var h=r-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:p,top:f>=o?v:h>=o||h>=50||h>=f?m:v}}(t,n,i);break;case w.a.bottomLeft:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=s-t.left,u=t.right,d=t.left,c=t.right-i,p=void 0;p=l>=i?d:u>=i?c:l>=50||l>=u?d:c;var h=r-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:p,top:h>=o?m:f>=o?v:h>=50||h>=f?m:v}}(t,n,i);break;case w.a.bottomRight:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=t.right,u=s-t.left,d=t.right-i,c=t.left,p=void 0;p=l>=i?d:u>=i?c:l>=50||l>=u?d:c;var h=r-t.bottom-n,f=t.top-n,m=t.bottom+n,v=t.top-n-o;return{left:p,top:h>=o?m:f>=o?v:h>=50||h>=f?m:v}}(t,n,i);break;case w.a.rightBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=s-t.right-n,u=t.left-n,d=t.right+n,c=t.left-n-i,p=void 0;p=l>=i?d:u>=i?c:l>=50||l>=u?d:c;var h=r-t.top,f=t.bottom,m=t.top,v=t.bottom-o;return{left:p,top:h>=o?m:f>=o?v:h>=50||h>=f?m:v}}(t,n,i);break;case w.a.leftBottom:o=function(e,t,n){var i=e.offsetWidth,o=e.offsetHeight,a=document.body,s=a.clientWidth,r=a.clientHeight,l=s-t.right-n,u=t.left-n,d=t.right+n,c=t.left-n-i,p=void 0;p=u>=i?c:l>=i||l>=50||l>=u?d:c;var h=r-t.top,f=t.bottom,m=t.top,v=t.bottom-o;return{left:p,top:h>=o?m:f>=o?v:h>=50||h>=f?m:v}}(t,n,i);break;default:throw new Error("what is this？"+e)}return window.rightToLeft&&(o.right=document.body.clientWidth-o.left-t.offsetWidth,delete o.left),o},P=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n.panelW=void 0,n.panelH=void 0,n.timestamp=void 0,n.handleClose=function(e){var t=e.target,i=n.refPanel.current,o=n.props.triggerElement;!i||i.contains(t)||function(e,t){if(e){var n=e.getBoundingClientRect(),i=t.changedTouches&&t.changedTouches[0]?t.changedTouches[0]:t,o=i.pageX,a=i.pageY;return o>=n.left&&o<=n.right&&a>=n.top&&a<=n.bottom}return!1}(o,e)||E.a(e.target)<n.level&&n.props.onClose()},n.handleOrientationchange=function(){n.props.onClose()},n.handleWheel=function(e){n.handleClose(e)},n.origin=null,n.style=null,n.maxHeight=void 0,n.refPanel=f.a.createRef(),n.handleWindowKeyDown=n.handleWindowKeyDown.bind(n),n.handleWindowResize=n.handleWindowResize.bind(n),n.handleClosePanel=n.handleClosePanel.bind(n),n.handleDisconnected=n.handleDisconnected.bind(n),n.handleWindowMouseDown=n.handleWindowMouseDown.bind(n),n.timestamp=window.performance.now(),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.props.visible&&(this.bindEvents(),this.setState({visible:!0}))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.visible;e.visible!==n&&(n?(this.bindEvents(),this.origin=null,this.style=null,this.maxHeight=void 0):this.unbindEvents(),this.setState({visible:n}))}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"observerPanel",value:function(){var e=this;if(void 0===this.panelW){var t=this.refPanel.current;this.panelW=t.clientWidth,this.panelH=t.clientHeight,new MutationObserver((function(){var n=t.clientWidth,i=t.clientHeight;e.panelW===n&&e.panelH===i||(e.panelW=n,e.panelH=i,e.origin=null,e.style=null,e.forceUpdate())})).observe(t,{childList:!0,subtree:!0})}}},{key:"handleClosePanel",value:function(e){if(this.state.visible){var t=e.detail.isCloseSub;t&&this.level>1?this.props.onClose():t||1!==this.level||this.props.onClose()}}},{key:"handleDisconnected",value:function(){this.props.onClose()}},{key:"handleWindowKeyDown",value:function(e){y.getKey(e)===y.Keys.Esc&&(E.b(this.level+1)||(Object(v.stopBubble)(e),this.props.onClose()))}},{key:"handleWindowMouseDown",value:function(e){window.performance.now()-this.timestamp>300&&this.handleClose(e)}},{key:"handleWindowResize",value:function(){m.isTouchScreen?(this.style=null,this.forceUpdate()):this.props.onClose()}},{key:"bindEvents",value:function(){this.observerPanel(),g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!0}),window.addEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.addEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.addEventListener("keydown",this.handleWindowKeyDown,!0),window.addEventListener("mousedown",this.handleWindowMouseDown,!0),window.addEventListener("resize",this.handleWindowResize),window.addEventListener("touchstart",this.handleClose,!0),window.addEventListener("orientationchange",this.handleOrientationchange),window.addEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.addEventListener("resize",this.handleWindowResize)}},{key:"unbindEvents",value:function(){g.default.dispatchEvent(g.default.names.ON_DROPDOWN_PANEL_VISIBLE_CHANGE,{visible:!1}),window.removeEventListener(g.default.names.CLOSE_DROPDOWN_PANEL,this.handleClosePanel),window.removeEventListener(g.default.names.network.ON_DISCONNECTED,this.handleDisconnected),window.removeEventListener("keydown",this.handleWindowKeyDown,!0),window.removeEventListener("mousedown",this.handleWindowMouseDown,!0),window.removeEventListener("resize",this.handleWindowResize),window.removeEventListener("touchstart",this.handleClose,!0),window.removeEventListener("orientationchange",this.handleOrientationchange),window.removeEventListener("wheel",this.handleWheel,!0),window.visualViewport&&window.visualViewport.removeEventListener("resize",this.handleWindowResize)}},{key:"getAnimationOrigin",value:function(e){var t=this.refPanel.current;return t?(this.origin||(this.origin=function(e,t,n){var i=void 0;i=window.rightToLeft?document.body.clientWidth-e.right-t.offsetWidth/2:e.left+t.offsetWidth/2;var o=e.top+(e.height||t.offsetHeight)/2;return(i>=n.left+n.width/2?"right":"left")+"-"+(o>=n.top+n.height/2?"bottom":"top")}(e,t,this.props.rect)),this.origin):""}},{key:"createStyle",value:function(e){var t,n=(t={visibility:this.state.visible?"":"hidden"},o()(t,window.rightToLeft?"right":"left",0),o()(t,"top",0),t),i=this.props,a=i.placement,s=i.rect,r=i.distance,l=i.isAuto,u=i.triggerElement;if(u){var d=u.getBoundingClientRect(),c=d.top,p=d.bottom;s=Object.assign({},s,{top:c,bottom:p})}var h=b(a,e,s,r);return l&&(h=function(e,t){var n=e.left,i=e.right,o=e.top,a=t.offsetWidth,s=t.offsetHeight,r=document.body,l=r.clientWidth,u=r.clientHeight;return window.rightToLeft?(i+a+4>l&&(i=l-a-4),i=Math.max(4,i)):(n+a+4>l&&(n=l-a-4),n=Math.max(4,n)),o+s+4>u&&(o=u-s-4),o=Math.max(4,o),window.rightToLeft?{right:i,top:o}:{left:n,top:o}}(h,e)),Object.assign(n,h),n}},{key:"getPanelStyle",value:function(){var e=this.state.visible,t=this.refPanel.current;if(!t){var n,i=(n={visibility:e?"":"hidden"},o()(n,window.rightToLeft?"right":"left",0),o()(n,"top",0),n);return this.maxHeight=this.createStyle(document.body).height,i.maxHeight=this.maxHeight,i}var a=this.props,s=a.distance,r=a.isSetHeight;if(!this.style){this.style=this.createStyle(t),r&&(this.style.height=function(e,t,n){var i=document.body.clientHeight,o=i-e-n;return e<0&&(o=i-2*n),t.offsetHeight<o?void 0:o}(this.style.top,t,s));var l=t.getBoundingClientRect().height;Math.abs(l-this.maxHeight)<2&&(this.style.height=this.maxHeight)}return this.style}},{key:"calcTransparentPlaceholder",value:function(e){if(0===this.props.offsetX)return null;var t={left:/left/.test(e)?"auto":"-"+this.props.offsetX+"px",right:/right/.test(e)?"auto":"-"+this.props.offsetX+"px"};return f.a.createElement("div",{className:"transparent-placeholder",style:t})}},{key:"getLevel",value:function(){return this.level}},{key:"render",value:function(){void 0===this.level&&(this.level=E.a(this.props.triggerElement)+1,this.showAnimation=!1);var e=this.props,t=e.children,n=e.onMouseEnter,i=e.onMouseLeave,o=e.className,a=this.state.visible,s=null;"function"==typeof t.type&&(s={isListenEvent:a});var r=f.a.cloneElement(t,s),l=this.getPanelStyle(),u=this.getAnimationOrigin(l),d=this.calcTransparentPlaceholder(u),c=E.c;return a&&(this.showAnimation&&(c+=" animation-fade-scaleY-in"),c+=" origin-"+u,o&&(c+=" "+o)),f.a.createElement("div",{ref:this.refPanel,className:c,style:l,"data-level":this.level,onMouseEnter:n,onMouseLeave:i},d,r)}}]),t}(h.PureComponent);P.placementTypes=w.a,P.defaultProps={placement:w.a.bottomLeft,distance:0,offsetX:0,isSetHeight:!1};t.default=P},241:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=n(142),p=n.n(c),h=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this.props.className,t="component-menu-divider";return e&&(t+=" "+e),p.a.createElement("div",{className:t})}}]),t}(c.PureComponent);t.default=h},245:function(e,t,n){"use strict";var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=(n(209),n(142)),p=n.n(c),h=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){return p.a.createElement("div",{className:"divider-line"})}}]),t}(c.PureComponent);t.a=h},257:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=(n(352),n(142)),p=n.n(c),h=n(145),f=n(162),m=n(148),v=n(151),y=n.n(v),g=m.default.types.other,w=function(e){function t(e){o()(this,t);var n=l()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.refContainer=p.a.createRef(),n.handleClick=n.handleClick.bind(n),n.state={officeType:Object(h.getPageOfficeType)()},n}return d()(t,e),s()(t,[{key:"handleClick",value:function(e){var t=this.props,n=t.onChange,i=t.value,o=t.checked,a=t.isNeedNativeEvent;n&&(a?n(!o,i,e):n(!o,i))}},{key:"getElement",value:function(){return this.refContainer.current}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.indeterminate,i=e.disabled,o=e.checked,a=e.isAuto,s=this.state.officeType,r="component-checkbox";return i&&(r+=" disabled"),n&&(r+=" indeterminate"),a&&(r+=" "+s),t&&(r+=" "+t),o&&(r+=" checked"),r}},{key:"renderIcon",value:function(){var e=this.props,t=e.checked,n=e.isAuto;if(!t)return!1;var i=g.checked;if(n){var o=this.state.officeType;i=o===f.default.writer?g.checkbox_w:o===f.default.spreadsheet?g.checkbox_s:o===f.default.ksheet?g.checkbox_k:o===f.default.presentation?g.checkbox_p:g.checkbox_system}return p.a.createElement(m.default,{type:i})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,i=e.value,o=this.getClassName(),a=this.renderIcon();return p.a.createElement(y.a,{title:n,middleShow:!0},p.a.createElement("div",{ref:this.refContainer,className:o,onClick:this.handleClick,"data-value":i},p.a.createElement("div",{className:"checkbox-icon"},a),!!t&&p.a.createElement("div",{className:"checkbox-text"},t)))}}]),t}(c.PureComponent);w.defaultProps={checked:!1,indeterminate:!1,disabled:!1,isAuto:!0,isNeedNativeEvent:!1},t.default=w},259:function(e,t,n){},2590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(2591);var o=(0,i.__importDefault)(n(142)),a=(0,i.__importDefault)(n(160)),s=n(179),r=(0,i.__importDefault)(n(616)),l=(0,i.__importDefault)(n(2592)),u=n(502),d=(0,i.__importDefault)(n(155)),c=n(208),p=d.default.iconTypes.size24,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={container:null,VolumeBtn:null},t.onToolBarMouseDown=function(e){e&&e.stopPropagation&&e.stopPropagation()},t.onContainerChange=function(e){var n=e.container,i=e.VolumeBtn;e.id===t.props.id&&n?t.setState({container:n,VolumeBtn:i}):t.setState({container:null,VolumeBtn:null})},t.getToolClass=function(){var e=t.props.showToolBar,n=t.state.container,i="media-tool player-bar-wrap";return e||n||(i+=" hidden"),i},t.timeRef=o.default.createRef(),t.toolRef=o.default.createRef(),t.renderTool=function(){var e=t.props,n=e.loading,a=e.isPlay,s=e.trimStartTime,c=e.totalTime,h=e.currentTime,f=e.bufferTime,m=e.muted,v=e.volume,y=e.onTimeChange,g=e.onPlayChange,w=e.onVolumeChange,E=e.onTimeBarMouseUp,T=e.onVolumeBarMouseUp,_=e.onMutedChange,b=t.state.VolumeBtn||l.default;return o.default.createElement("div",{ref:t.toolRef,className:t.getToolClass()},o.default.createElement(d.default,{className:"small-play-btn ".concat(n?"loading-icon":"normal-icon"),iconType:n?p.wpp_play_loading_gray:p["wpp_play_".concat(a?"stop":"start")],onClick:g}),o.default.createElement(r.default,{className:"media-tool player-time-bar",min:s,max:c,places:2,value:h,showNumTip:!1,handleValueChange:y,onMouseUp:E,bufferValue:f,isMediaStyle:!0}),o.default.createElement("div",{className:"play-time",ref:t.timeRef},(0,u.getFormatTime)(h)),o.default.createElement(b,(0,i.__assign)({},{onVolumeBarMouseUp:T,muted:m,volume:v,onVolumeChange:w,onMutedChange:_})))},t}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.on(this.uiEventTypes.pc.SET_MEDIA_TOOL_CONTAINER,this.onContainerChange),window.domTools.addEventListener(this.toolRef.current,"mousedown",this.onToolBarMouseDown),this.fire(this.uiEventTypes.pc.MEDIA_TOOL_DID_MOUNT,{id:this.props.id})},t.prototype.onUnBindEvent=function(){this.off(this.uiEventTypes.pc.SET_MEDIA_TOOL_CONTAINER,this.onContainerChange),window.domTools.addEventListener(this.toolRef.current,"mousedown",this.onToolBarMouseDown)},t.prototype.componentDidUpdate=function(t,n){if(e.prototype.componentDidUpdate.call(this,t,n),c.userAgent.isIPad||c.userAgent.isSafari){var i=this.props.currentTime;t.currentTime!==i&&this.timeRef.current&&(this.timeRef.current.textContent=(0,u.getFormatTime)(i))}},t.prototype.render=function(){var e=this.state.container,t=this.renderTool();return e?a.default.createPortal(t,e):t},t}(s.BaseComponent);t.default=h},2591:function(e,t,n){},2592:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(1982);var o=(0,i.__importStar)(n(142)),a=n(179),s=(0,i.__importDefault)(n(616)),r=(0,i.__importDefault)(n(155)),l=r.default.iconTypes.size24,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.onVolumeBarMouseUp,n=e.muted,i=e.volume,a=e.onVolumeChange,u=e.onMutedChange;return o.default.createElement(o.Fragment,null,o.default.createElement(r.default,{className:"volume-btn",onClick:u,iconType:n?l.media_muted:l.media_volume}),o.default.createElement(s.default,{className:"media-tool player-volume-bar",value:n?0:i,handleValueChange:a,onMouseUp:t,showNumTip:!1,isMediaStyle:!0}))},t}(a.BaseComponent);t.default=u},260:function(e,t,n){},289:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(3),s=n.n(a),r=n(25),l=n.n(r),u=n(42),d=n.n(u),c=n(142),p=n.n(c),h=n(191),f=n(229),m=n(203),v=n(219),y=function(e){function t(){return o()(this,t),l()(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return d()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.position,i=e.size,o=e.visible,a=e.onClose,s=e.destroyOnHide,r=i.width,l=i.height,u={left:n.x,right:n.x+r,top:n.y,bottom:n.y+l,width:r,height:l};return p.a.createElement(h.default,{visible:o,destroyOnHide:s},p.a.createElement(f.default,{isAuto:!0,visible:o,rect:u,distance:0,onClose:a},t))}}]),t}(c.PureComponent);y.Menu=m.default,y.SubMenu=v.default,y.defaultProps={visible:!0,size:{width:0,height:0}},t.default=y},295:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},3863:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=n(142),f=n.n(h),m=(n(3864),n(311)),v=n(1836),y=n(156),g=n(158),w=n(1834),E=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));T.call(n);var i=n.coreView.doc.activeSlide;return n.state={activeSlide:null,reloadShapeViews:i&&i.getImageLoadErrorShapes(),loadGIFShapeViews:i&&i.getGIFLoadShapes()},n}return p()(t,e),l()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleDocChange),this.doc.on(this.viewEventTypes.DOC_RESIZE,this.handleResize),g.userAgent.isMobile&&(this.on(this.uiEventTypes.mobile.ON_TOUCH_SCALE,this.handleResize),window.addEventListener("orientationchange",this.handleOrientationChange))}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleDocChange),this.doc.off(this.viewEventTypes.DOC_RESIZE,this.handleResize),g.userAgent.isMobile&&window.removeEventListener("orientationchange",this.handleOrientationChange)}},{key:"render",value:function(){var e=this,t=this.state,n=t.reloadShapeViews,i=t.loadGIFShapeViews,a=this.coreView.doc.layoutResult;if(!((n&&0!==n.length||i&&0!==i.length)&&a&&this.doc.getSvgClientRect()))return null;var s=this.doc.getLayout().bestZoom,r=n.map((function(e){return f.a.createElement(v.a,{key:e.getId(),shapeView:e,scale:s})})),l=i.map((function(e){var t=e.shapeData.objID;return f.a.createElement(w.a,{shapeView:e,scale:s,key:t})})),u=this.doc.getSvgRealClientRect(),d={left:u.x,top:u.y,width:u.width,height:u.height};return f.a.createElement("div",{className:"play-image-reload-container",id:"play-image-reload-container",ref:function(t){return e.$reloadContainerRef=t},style:o()({},d)},r,l)}}]),t}(m.PubComponent),T=function(){var e=this;this.handleDocChange=function(t){var n=e.coreView.doc.activeSlide;n&&t.slideId===n.getId()&&e.setState({reloadShapeViews:n.getImageLoadErrorShapes(),loadGIFShapeViews:n.getGIFLoadShapes()})},this.handleResize=function(t){e.forceUpdate()},this.handleOrientationChange=Object(y.debounce)((function(){e.forceUpdate()}),500)};t.a=E},3864:function(e,t,n){},3865:function(e,t,n){"use strict";var i=n(26),o=n.n(i),a=n(150),s=n.n(a),r=n(0),l=n.n(r),u=n(3),d=n.n(u),c=n(25),p=n.n(c),h=n(154),f=n.n(h),m=n(42),v=n.n(m),y=(n(3866),n(142)),g=n.n(y),w=n(179),E=n(1863),T=n(502),_=n(697),b=n(156),P=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getActiveSlideId=function(){var e=n.doc.getSlideAt(n.state.activeSlideIndex);return e&&e.getId()},n.handleChange=Object(b.debounce)((function(e){var t=n.doc.getActiveSlideIdx();if(!Object.isEmpty(n.state.activeSlideIndex)){var i=n.doc.getSlideAt(t);if(i){var o=i.getId(),a=i.getFollowing(),s=a&&a.getId(),r=a&&a.getFollowing(),l=r&&r.getId();n.mediaVisible=n.mediaVisible.filter((function(e){return e.slideId===o||e.slideId===s||e.slideId===l})),n.mediaAnimation=n.mediaAnimation.filter((function(e){return e.slideId===o||e.slideId===s||e.slideId===l}))}else n.mediaVisible=[],n.mediaAnimation=[]}n.addMediaPlayer(t)}),150),n.getEndAfterSlide=function(e){var t=n.selection.getAnimSelection(),i=t&&t.helper.getMediaNode(e);return i&&i.getEndAfterSlide()},n.addMediaPlayer=function(e){var t=!Object.isEmpty(e)&&n.doc.getSlideViewByIdx(e);t&&(n.mediaData=[],n.shapeViewArr=[],t._masterSlide&&t._masterSlide.shapeTree&&n._findMediaPlay(t._masterSlide.shapeTree.shapes),t._layoutSlide&&t._layoutSlide.shapeTree&&n._findMediaPlay(t._layoutSlide.shapeTree.shapes),t._curSlide&&t._curSlide.shapeTree&&n._findMediaPlay(t._curSlide.shapeTree.shapes),n.setState({mediaData:n.mediaData,activeSlideIndex:e}))},n._findMediaPlay=function(e){e&&e.forEach((function(e){if(e.isGroupShape()){var t=e.shapes||[];n._findMediaPlay(t)}else n._addMediaData(e)}))},n._addMediaData=function(e){var t=e.getData();if(t&&!t.isHidden()&&t.isMedia()){n.shapeViewArr.push(e);var i=t.getSlideId()+"_"+t.getId(),o=document.getElementById("media_container_"+i),a=n.getStyleInSvg(e);if(o)window.domTools.setStyle(o,a);else{o=Object(T.getMediaDom)(t,a);var s=t.visual.getRootShape();n.doc.insertNodeAfterShapeById(s.getSlideId(),s.getId(),o)}var r=void 0,l=t.getMedia().loopUntilStop;if(t.isVideo())r={id:i,shapeData:t,style:n.getStyleInUil(e),type:"video",isClickWrapWork:!_.userAgent.isPad,onlyTool:!0,isPlayMode:!0,loop:!!l},n.mediaData.push(r);else if(t.isAudio()){r={id:i,shapeData:t,type:"audio",isPlayMode:!0,onlyTool:!0,loop:!!l,style:n.getStyleInUil(e)};var u=n.getEndAfterSlide(t);if(u){if(!n["mediaRef"+i]){var d=n.doc.getActiveSlideIdx();r.endAfterSlide=d+u-1,r.getActiveSlideId=n.getActiveSlideId,n.bgAudioArr.push(r)}}else n.mediaData.push(r)}}},n.updateMediaStyle=function(){n.shapeViewArr&&n.shapeViewArr.forEach((function(e){var t=n.getStyleInUil(e),i=e.getData(),o=i.getSlideId()+"_"+i.getId();n["mediaRef"+o]&&n["mediaRef"+o].setStyle(t);var a=document.getElementById("media_container_"+o),s=n.getStyleInSvg(e);a?window.domTools.setStyle(a,s):n["mediaRef"+o]&&n["mediaRef"+o].insertNodeAfterShape(i.getSlideId(),i.getId(),s)}))},n.handleResize=function(){n.shapeViewArr&&setTimeout((function(){n.updateMediaStyle()}),200)},n.getStyleInSvg=function(e){var t=e&&e.layout(),n=t&&t.getRealRectPx();return n?{position:"absolute",width:n.width,height:n.height,left:n.x,top:n.y,transform:n.rotation?"rotate("+n.rotation+"deg)":""}:{}},n.getStyleInUil=function(e){var t,i=n.doc.getLayout({}).bestZoom,o=n.doc.getSvgClientRect(),a=e&&e.layout(),r=a&&a.getUilRotatedLayoutRect(i);return o&&r?(t={position:"absolute",width:r.width,height:r.height},s()(t,window.rightToLeft?"right":"left",window.rightToLeft?o.x+o.width-r.x-r.width:r.x+o.x),s()(t,"top",r.y+o.y),t):{}},n.handlePlayStatusChange=function(e){n.isRemarksWin||n.doc.changeMediaPlay(e)},n.handleMediaPlayChange=function(e){var t=e.Data||e.data;Array.isArray(t)?t.forEach((function(e){e&&n.setPlayStatus(e)})):t&&n.setPlayStatus(t)},n.changePlay=function(e){var t=e.getSlideId()+"_"+e.getId();n["mediaRef"+t]&&n["mediaRef"+t].changePlay()},n.setPlayStatus=function(e){e.id||e.slideId||e.shapeId?n.props.isExplainPlay&&(e.isMediaPlay||e.restart)?n.doc.fire(n.viewEventTypes.MEDIA_PLAY_END,{slideId:e.slideId,shapeId:e.shapeId}):(e.id||(e.id=e.slideId+"_"+e.shapeId),n["mediaRef"+e.id]?n["mediaRef"+e.id].setPlayStatus(e):n.mediaAnimation.push(e)):console.error("media play error: id、slideId、shapeId is undefine")},n.changeMediaVisible=function(e){e.isAll?n.setState({hiddenMedia:!e.visible}):n["mediaRef"+e.id]?n["mediaRef"+e.id].setVisible(e.visible):n.mediaVisible.push(e)},n.updateMediaVisible=function(){if(n.mediaVisible&&n.mediaVisible.length>0)for(var e=0;e<n.mediaVisible.length;e++){var t=n.mediaVisible[e];n["mediaRef"+t.id]&&(n["mediaRef"+t.id].setVisible(t.visible),n.mediaVisible.splice(e,1),e-=1)}},n.doMediaAnimation=function(){if(n.mediaAnimation&&n.mediaAnimation.length>0)for(var e=0;e<n.mediaAnimation.length;e++){var t=n.mediaAnimation[e];n["mediaRef"+t.id]&&(n["mediaRef"+t.id].setPlayStatus(t),n.mediaAnimation.splice(e,1),e-=1)}},n.changeMediaStyle=function(e){n["mediaRef"+e.id]&&n["mediaRef"+e.id].changeMediaStyle(e.videoStyle,e.toolStyle)},n.showMedia=function(){n.rootRef&&(n.rootRef.style.zIndex="3")},n.hideMedia=function(){!n.props.readOnly&&n.rootRef&&(n.rootRef.style.zIndex="-1")},n.getMediaPlayMsg=function(e){var t=e.detail||e,i=n.state.mediaData,o=void 0;i.concat(n.bgAudioArr).forEach((function(e){var t=n["mediaRef"+e.id];if(t&&t.isPlay){o||(o=[]);var i={id:e.id,endAfterSlide:e.endAfterSlide,currentTime:t.currentTime,isMediaPlay:t.isPlay};o.push(i)}})),t&&t(o)},n.onVideoFullscreen=function(e){n.rootRef&&n.rootRef.style&&(n.rootRef.style.zIndex=e?"auto":"")},n.changeToolByHitInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null,o=e&&e.getData();o&&o.isMedia()&&(i=o.getSlideId()+"_"+o.getId()),(n.preHoverId!==i||t)&&(n["mediaRef"+i]&&n["mediaRef"+i].onHoverMedia(i,t),n["mediaRef"+n.preHoverId]&&n["mediaRef"+n.preHoverId].onHoverMedia(i,t)),n.preHoverId=i},n.state={activeSlideIndex:null,mediaData:[]},n.bgAudioArr=[],n.mediaAnimation=[],n.mediaVisible=[],n.preHoverId=null,n}return v()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){this.handleChange(),this.on("resize",this.handleResize),this.doc.on(this.viewEventTypes.DOC_RESIZE,this.handleResize),this.doc.on(this.viewEventTypes.MEDIA_PLAY_CHANGE,this.handleMediaPlayChange),this.doc.on(this.viewEventTypes.MEDIA_VISIBLE_CHANGE,this.changeMediaVisible),this.doc.on(this.viewEventTypes.MEDIA_STYLE_CHANGE,this.changeMediaStyle),this.doc.on(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),this.on(this.eventTypes.names.ON_CLOSE_INK_EDITOR,this.showMedia),this.on(this.eventTypes.names.ON_OPEN_INK_EDITOR,this.hideMedia),this.on(this.uiEventTypes.names.ON_GET_MEDIA_PLAY_MSG,this.getMediaPlayMsg),window.addEventListener(this.eventTypes.OPENAPI_EVENT.ON_GET_MEDIA_PLAY_MSG,this.getMediaPlayMsg),this.on(this.uiEventTypes.names.ON_VIDEO_FULLSCREEN,this.onVideoFullscreen),this.eventTypes.dispatchEvent(this.eventTypes.names.MEDIA_PLAY_UIL_LOADED)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.viewEventTypes.MEDIA_PLAY_CHANGE,this.handleMediaPlayChange),this.doc.off(this.viewEventTypes.MEDIA_VISIBLE_CHANGE,this.changeMediaVisible),this.doc.off(this.viewEventTypes.MEDIA_STYLE_CHANGE,this.changeMediaStyle),this.doc.off(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.ON_GET_MEDIA_PLAY_MSG,this.getMediaPlayMsg)}},{key:"componentDidUpdate",value:function(){f()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this);var e=this.doc.getActiveSlideIdx();this.state.activeSlideIndex===e&&(this.doMediaAnimation(),this.updateMediaVisible())}},{key:"render",value:function(){var e=this,t=this.state,n=t.mediaData,i=t.activeSlideIndex,a=t.hiddenMedia,s=this.props,r=s.stopWPClick,l=s.isExplainPlay,u=n.concat(this.bgAudioArr),d=this.doc.getActiveSlideIdx(),c=i!==d||a?"hidden":"";return!u||u.length<=0?null:g.a.createElement("div",{ref:function(t){return e.rootRef=t},className:"media-player-wrap "+c},u.map((function(t){return g.a.createElement(E.a,o()({key:t.id,ref:function(n){return e["mediaRef"+t.id]=n},activeSlideIndex:i,handlePlayStatusChange:e.handlePlayStatusChange,stopWPClick:r,isExplainPlay:l},t))})))}}]),t}(w.BaseComponent);t.a=P},3866:function(e,t,n){},3867:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(143);n(3868);var o=(0,i.__importDefault)(n(142)),a=(0,i.__importDefault)(n(160)),s=n(208),r=n(179),l=s.userAgent.isMobile,u=l?78:52,d=l?15:10,c=l?18:12,p=function(e){function t(t){var n=e.call(this,t)||this;return n.wrapRef=o.default.createRef(),n.ctnRef=o.default.createRef(),n._refMap={},n.state={index:n.doc.getActiveSlideIdx()},n.handleModify=function(e){4===e.event&&n.forceUpdate()},n.handleChange=function(e){var t=e.slideIndex;n.setState({index:t},(function(){n.handleTransForm()}))},n.handleTransForm=function(){if(n.isLayoutLoaded){var e=n.state.index,t=n.getTransIndex(e),i=t.transIdx,o=t.totalCount;n.setContainerCenterStatus(o<=5);var a=function(e){var t=l?"translateX":"translateY";n.wrapRef.current.style.transform="".concat(t,"(").concat(-e,"px)")};if(-1!==i&&0!==o&&1!==o){i=Math.min(i,o-3);var s=d*i-(u-c)/2;a(s=Math.max(0,s))}else a(0)}},n.handleLayoutsLoaded=function(){n.isLayoutLoaded||(n.isLayoutLoaded=!0,n.forceUpdate((function(){n.handleTransForm()})))},n.$ctn=document.querySelector("#workspace"),n.isLayoutLoaded=Boolean(n.doc.getLayoutsLoadedStatus()),n}return(0,i.__extends)(t,e),t.prototype.onSafeBindEvent=function(){this.doc.on(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),this.doc.on(this.viewEventTypes.DOC_LAYOUTS_LOADED,this.handleLayoutsLoaded),this.presentation.on("modify",this.handleModify),this.handleTransForm()},t.prototype.onUnBindEvent=function(){this.doc.off(this.viewEventTypes.ACTIVE_SLIDE_CHANGE,this.handleChange),this.doc.off(this.viewEventTypes.DOC_LAYOUTS_LOADED,this.handleLayoutsLoaded),this.presentation.off("modify",this.handleModify)},t.prototype.getTransIndex=function(e){var t=this._refMap["item_wrap_".concat(e)],n=this.wrapRef.current.querySelectorAll(".tip-item-wrap:not(.is-hidden)");return{totalCount:n.length,transIdx:[].indexOf.call(n,t)}},t.prototype.setContainerCenterStatus=function(e){var t=this.ctnRef.current;e?t.classList.add("is-center"):t.classList.remove("is-center")},t.prototype.getItems=function(){for(var e=this,t=this.slideCount,n=[],i=function(i){var s=a.doc.getSlideAt(i),r=(null==s?void 0:s.getHiddenStatus())&&1!==t,l=o.default.classNames({"tip-item":1,active:i===a.state.index}),u=o.default.classNames({"tip-item-wrap":1,"is-hidden":r}),d=o.default.createElement("div",{className:u,key:i,ref:function(t){return e._refMap["item_wrap_".concat(i)]=t}},o.default.createElement("div",{className:l}));n.push(d)},a=this,s=0;s<t;s++)i(s);return n},t.prototype.render=function(){if(!this.isLayoutLoaded)return null;var e=this.getItems(),t=o.default.classNames({"h5-background":1,mobile:l,pc:!l}),n=o.default.createElement("div",{className:t},o.default.createElement("div",{className:"h5-tip-container",ref:this.ctnRef},o.default.createElement("div",{className:"h5-tip-wrap",ref:this.wrapRef},e)));return a.default.createPortal(n,this.$ctn)},t}(r.BaseComponent);t.default=p},3868:function(e,t,n){},4560:function(e,t,n){},502:function(e,t,n){"use strict";n.r(t),n.d(t,"AudioNameMap",(function(){return w})),n.d(t,"AudioIconUrlMap",(function(){return E})),n.d(t,"AudioAnime",(function(){return T})),n.d(t,"getTimeByTrim",(function(){return _})),n.d(t,"getFormatTime",(function(){return b})),n.d(t,"getMediaDom",(function(){return P})),n.d(t,"getAudioIcon",(function(){return k}));var i,o,a=n(150),s=n.n(a),r=n(1150),l=n.n(r),u=n(1151),d=n.n(u),c=n(1152),p=n.n(c),h=n(1153),f=n.n(h),m=n(1154),v=n.n(m),y=n(1155),g=n.n(y),w={icon1:"webwpp_sound1.png",icon2:"webwpp_sound2.png",icon3:"webwpp_sound3.png",icon4:"webwpp_sound4.png",icon5:"webwpp_sound5.png",icon6:"webwpp_sound6.png",defalut:"sound.png"},E=(i={},s()(i,w.icon1,l.a),s()(i,w.icon2,d.a),s()(i,w.icon3,p.a),s()(i,w.icon4,f.a),s()(i,w.icon5,v.a),s()(i,w.icon6,g.a),s()(i,w.defalut,l.a),i),T=(o={},s()(o,w.defalut,"media audio-anime audio-anime-1 black"),s()(o,w.icon1,"media audio-anime audio-anime-1 black"),s()(o,w.icon2,"media audio-anime audio-anime-1 white"),s()(o,w.icon3,"media audio-anime audio-anime-2 black"),s()(o,w.icon4,"media audio-anime audio-anime-2 white"),s()(o,w.icon5,"media audio-anime audio-anime-3 black"),s()(o,w.icon6,"media audio-anime audio-anime-3 white"),o),_=function(e){var t=0;return e&&(t=e/1e3),t},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="0"+Math.floor(e%60),i="0"+Math.floor(e/60%60),o="0"+Math.floor(e/3600);return t?parseInt(1e3*e):o.slice(-2)+":"+i.slice(-2)+":"+n.slice(-2)},P=function(e,t){var n=e.getSlideId()+"_"+e.getId(),i=document.createElement("div");if(i.id="media_container_"+n,i.className="media_container",t&&window.domTools.setStyle(i,t),e.isVideo()){var o=document.createElement("video");o.controls=!1,o.id="media_player_"+n,o.className="video_player",i.appendChild(o);var a=document.createElement("div");a.id="video_mask_"+n,a.className="video_mask hidden",i.appendChild(a)}else if(e.isAudio()){var s=k(e);if(s){var r=document.createElement("div");r.id="audio_icon_"+n,r.className=T[s],i.appendChild(r)}}return i},k=function(e){var t=(e.getPicture()||{}).blip,n=t&&t.blipAtom&&t.blipAtom.imageId,i=window.APP.presentation.getPresetAudioIcons();for(var o in i)if(i[o]===n)return o}},616:function(e,t,n){"use strict";n.r(t);var i=n(150),o=n.n(i),a=n(0),s=n.n(a),r=n(3),l=n.n(r),u=n(25),d=n.n(u),c=n(42),p=n.n(c),h=(n(1492),n(142)),f=n.n(h),m=n(208),v=window.domTools,y=function(e){function t(e){s()(this,t);var n=d()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={mouseDown:!1,realValue:0,propsValue:null,leftRealValue:0,leftMouseDown:!1,propsLeftValue:null},n.handlePointerChange=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n.props.disabled&&n.barRef&&n.barRef.current){var o=n.props,a=o.places,s=o.max,r=o.min,l=o.isTwoWay,u=n.barRef.current.getBoundingClientRect(),d=u.left,c=u.width,p=u.right,h=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0]||e,f=h.clientX;if(!Object.isEmpty(f)){var m=window.rightToLeft?p-f:f-d;m>c&&(m=c),m<0&&(m=0);var v=m/c*(s-r)+r,y=Number(v.toFixed(a));if(!isNaN(y)){y>s&&(y=s),y<r&&(y=r);var g=n.state,w=g.realValue,E=g.leftRealValue;i&&y<w?(n.props.handleLeftValueChange(y,t),n.setState({leftRealValue:y})):(!l||!i&&E<y)&&(n.props.handleValueChange(y,t),n.setState({realValue:y}))}}}},n.handleLeftMouseDown=function(e){e&&e.stopPropagation(),n.setState({leftMouseDown:!0})},n.getPercentValue=function(e){var t=n.props,i=t.min,o=t.max;return e<=i?0:e>=o?100:Math.round((e-i)/(o-i)*100)},n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseMove=n.handleMouseMove.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleClick=n.handleClick.bind(n),n.handlePointerChange=n.handlePointerChange.bind(n),n.barRef=f.a.createRef(),n.pointerRef=f.a.createRef(),n.numRef=f.a.createRef(),n.leftPointerRef=f.a.createRef(),n}return p()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.bindEvent()}},{key:"componentWillUnmount",value:function(){this.destroy()}},{key:"bindEvent",value:function(){v.addEventListener(document,"mousemove",this.handleMouseMove),v.addEventListener(document,"mouseup",this.handleMouseUp),v.addEventListener(this.pointerRef.current,"mousedown",this.handleMouseDown),v.addEventListener(this.barRef.current,"mouseup",this.handleClick),this.props.isTwoWay&&v.addEventListener(this.leftPointerRef.current,"mousedown",this.handleLeftMouseDown)}},{key:"destroy",value:function(){v.removeEventListener(document,"mousemove",this.handleMouseMove),v.removeEventListener(document,"mouseup",this.handleMouseUp),v.removeEventListener(this.pointerRef.current,"mousedown",this.handleMouseDown),v.removeEventListener(this.barRef.current,"mouseup",this.handleClick),this.props.isTwoWay&&v.removeEventListener(this.leftPointerRef.current,"mousedown",this.handleLeftMouseDown)}},{key:"handleMouseDown",value:function(e){if(!(m.userAgent.isIPad&&Date.now()-this._mouseUpTime<300)){e&&e.stopPropagation(),this.setState({mouseDown:!0});var t=this.props.handlePointerDown;t&&t()}}},{key:"handleMouseMove",value:function(e){var t=this.state,n=t.mouseDown,i=t.leftMouseDown;n&&(e&&e.stopPropagation(),this.handlePointerChange(e,!0)),i&&(e&&e.stopPropagation(),this.handlePointerChange(e,!0,!0))}},{key:"handleClick",value:function(e){if(!this.props.isTwoWay){var t=this.state.mouseDown;if(!t&&e.target!==this.numRef.current){if(m.userAgent.isIPad&&Date.now()-this._mouseUpTime<300)return;e&&e.stopPropagation(),this.handlePointerChange(e,t)}}}},{key:"handleMouseUp",value:function(e){var t=this.state,n=t.mouseDown,i=t.leftMouseDown,o=this.props.onMouseUp;if(n){this._mouseUpTime=Date.now(),e&&e.stopPropagation(),o&&o(),this.setState({mouseDown:!1}),this.handlePointerChange(e,!1);var a=this.props.handlePointerUp;a&&a(e)}i&&(e&&e.stopPropagation(),this.setState({leftMouseDown:!1}),this.handlePointerChange(e,!1,!0))}},{key:"getClassName",value:function(){var e=this.props,t=e.className,n=e.isTwoWay,i=e.disabled,o=e.isMediaStyle,a="progress-bar bar-wrap";return t&&(a+=" "+t),n&&(a+=" two-way"),i&&(a+=" disabled"),o&&(a+=" media-style"),m.userAgent.isIPad&&!o&&(a+=" is-ipad"),a}},{key:"render",value:function(){var e=this.state,t=e.realValue,n=e.leftRealValue,i=this.props,a=i.min,s=i.max,r=i.showNumTip,l=i.unit,u=i.bufferValue,d=i.isTwoWay,c=i.middleMark,p=this.getPercentValue(t),h=this.getPercentValue(n),m=window.rightToLeft;return f.a.createElement("div",{className:this.getClassName(),ref:this.barRef},f.a.createElement("div",{className:"box"},c&&f.a.createElement("div",{className:"middle-mark"}),!!u&&f.a.createElement("div",{className:"buffer-bar",style:{width:this.getPercentValue(u)+"%"}}),f.a.createElement("div",{className:"color-bar",style:o()({width:p-h+"%"},m?"right":"left",h+"%")}),d&&f.a.createElement("div",{className:"pointer left color",ref:this.leftPointerRef,style:o()({},m?"right":"left",h+"%")}),f.a.createElement("div",{className:"pointer "+(0===p?"none":"color")+" "+(d?"right":""),ref:this.pointerRef,style:o()({},m?"right":"left",p+"%")}),r&&f.a.createElement("div",{className:"num",ref:this.numRef,style:o()({},m?"right":"left",p+"%")},""+Math.min(Math.max(a,t),s)+l)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.mouseDown,i=t.leftMouseDown,o=t.propsValue,a=t.propsLeftValue,s=null;return n||o===e.value||(s={realValue:e.value,propsValue:e.value}),e.isTwoWay&&!i&&a!==e.leftValue&&(s=s||{},Object.assign(s,{leftRealValue:e.leftValue,propsLeftValue:e.leftValue})),s}}]),t}(h.PureComponent);y.defaultProps={min:0,max:100,places:0,showNumTip:!0,unit:"%",isTwoWay:!1,middleMark:!1,isMediaStyle:!1},t.default=y},6874:function(e,t,n){},6875:function(e,t,n){},6876:function(e,t,n){e.exports=n.p+"images/cursor_laser.7597f82f.png"},6877:function(e,t,n){},6878:function(e,t,n){},6879:function(e,t,n){},6880:function(e,t,n){},6881:function(e,t,n){},6882:function(e,t,n){e.exports=function(e,t){n.e(207).then(n.bind(null,8131)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},6883:function(e,t,n){e.exports=function(e,t){n.e(206).then(n.t.bind(null,7678,7)).then((function(t){e&&e(t)})).catch((function(e){/loading.* chunk/i.test(e.message)&&window.badJsFunc(!0,e),console.error(e),t&&t(e)}))}},697:function(e,t,n){"use strict";n.r(t);var i=n(164);n.d(t,"Loader",(function(){return i.default}));var o=n(311);n.d(t,"PubComponent",(function(){return o.PubComponent})),n.d(t,"WPPCustomEvent",(function(){return o.WPPCustomEvent}));var a=n(208);n.d(t,"userAgent",(function(){return a.userAgent})),n.d(t,"ViewModes",(function(){return a.ViewModes})),n.d(t,"VIEW_EVENT_TYPES",(function(){return a.VIEW_EVENT_TYPES})),n.d(t,"FocusTargetsDef",(function(){return a.FocusTargetsDef}))},800:function(e,t,n){},8064:function(e,t,n){"use strict";n.r(t);var i=n(26),o=n.n(i),a=n(147),s=n.n(a),r=n(0),l=n.n(r),u=n(3),d=n.n(u),c=n(25),p=n.n(c),h=n(42),f=n.n(h),m=n(142),v=n.n(m),y=n(179),g=(n(6874),n(154)),w=n.n(g),E=n(183),T=n(1864),_=(n(4560),n(237)),b=n(158),P=n(166),k=n(145),S=n(182),R=n(1019),C=E.default.iconTypes.size24,M=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleMarkVisible=function(e){e&&e.stopPropagation(),n.setState({showMarkBtn:!n.state.showMarkBtn}),n.props.onClosepanel(e),n.props.isRemarkSpeaker&&n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.NORMAL_INFO,data:{type:"inkVisible",value:!n.inkVisible}}),n.fire(n.uiEventTypes.pc.play.CLICK_TOGGLE_INK_VISIBLE)},n.handleCountDown=function(){n.getKeyState(R.a.ON_TIME_COUNTING)?window.Toast.warn(_i18n("applications.presentation.components.PlayPanel.toolbar.isCountIng", "有一个倒计时在运行中")):n.fire(n.uiEventTypes.pc.play.CLICK_SHOW_SET_COUNTDOWN)},n.showPageClick=n.showPageClick.bind(n),n.handleAutoPlay=n.handleAutoPlay.bind(n),n.state={autoPlay:e.autoPlay,showPageBtn:e.pages,showMarkBtn:n.inkVisible},n}return f()(t,e),d()(t,[{key:"showPageClick",value:function(e){e&&e.stopPropagation();var t=this.state.showPageBtn;this.setState({showPageBtn:!t}),this.props.onClosepanel(e),this.fire(this.uiEventTypes.pc.play.CLICK_SHOW_PAGE,!t)}},{key:"handleAutoPlay",value:function(e){e&&e.stopPropagation(),this.props.onClosepanel(e),this.dispatchEvent(this.uiEventTypes.pc.ON_START_PLAY,{type:"auto",isFormExplain:!1,isFromPlay:!1}),window.collection("newui","value",window.pcTrack.newui.onplay_toolbar_autoplay)}},{key:"render",value:function(){var e=this,t=this.state,n=t.autoPlay,i=t.showMarkBtn,o=t.showPageBtn,a=this.props,s=a.isRemarkSpeaker,r=a.connected,l=v.a.classNames({"play-component-toolbar":1,"foreign-play-component-toolbar":this.isNotChinese});return v.a.createElement(S.default,{className:"anime_detail_panel show-more-func"},v.a.createElement("div",{ref:function(t){return e.rootRef=t},className:l},v.a.createElement("div",{className:"toolbar-group"},v.a.createElement(E.default,{className:"toolbar-group-item mark",iconType:C.time_countdown,onClick:this.handleCountDown,selected:this.getKeyState(R.a.ON_TIME_COUNTING),title:_i18n("applications.presentation.components.PlayPanel.toolbar.countDown", "倒计时")},_i18n("applications.presentation.components.PlayPanel.toolbar.countDown", "倒计时")),!s&&v.a.createElement(E.default,{className:"toolbar-group-item mark",iconType:C.start_autoplay,selected:!!n,onClick:this.handleAutoPlay,disabled:!r,title:_i18n("applications.presentation.components.PlayPanel.toolbar.autoPlay", "自动播放")},_i18n("applications.presentation.components.PlayPanel.toolbar.autoPlay", "自动播放")),v.a.createElement(E.default,{className:"toolbar-group-item mark",iconType:C.show_mark,onClick:this.toggleMarkVisible,selected:!!i,title:_i18n("applications.presentation.components.PlayPanel.toolbar.showMark", "显示墨迹")},_i18n("applications.presentation.components.PlayPanel.toolbar.showMark", "显示墨迹")),!s&&v.a.createElement(E.default,{className:"toolbar-group-item",iconType:C.play_page,onClick:this.showPageClick,selected:!!o,title:_i18n("applications.presentation.components.PlayPanel.toolbar.showPage", "显示页码")},_i18n("applications.presentation.components.PlayPanel.toolbar.showPage", "显示页码")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.autoPlay!==e.autoPlay?{autoPlay:e.autoPlay}:null}}]),t}(y.BaseComponent),I=n(805),N=E.default.iconTypes.size24,L=window.pcTrack,O=b.userAgent.isPad,D=window.WppCommandBarComponentFragment,A=D.cmbIds.wpp,V=window.__WPSPLUGIN__.helper,B=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,A.PlayComponentToolbar));return n.onUpdateLaserpen=function(e){n.setState({activeLaserpen:e.open},(function(){n.props.isRemarkSpeaker&&n.state.activeLaserpen&&n.rootRef&&(n.rootRef.style.visibility="hidden")}))},n.openApiSetPlayToolPosition=function(e){var t=n.props,i=t.showInkEditor,o=t.isRemarkSpeaker;if(!i&&!o){var a=n.getBoundingClientRect().width||0;if(e&&e.show){var s="",r=e.show;Object.keys(r).forEach((function(e){s+=e+":"+r[e]+";"})),n.rootRef&&(n.rootRef.style.cssText=s),n.toolRectRef&&(n.toolRectRef.style.cssText=s+";width:"+a+"px")}else n.rootRef&&(n.rootRef.style.cssText="top: 8px"),n.toolRectRef&&(n.toolRectRef.style.cssText="width:"+a+"px")}},n.openApiHandlerToolbar=function(e){n.props.isRemarkSpeaker||(e?n.show(!0,!0):n.hidden(0,!0))},n.show=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n.state,o=i.moreVisible,a=i.markDropDownVisible,s=n.props,r=s.showInkEditor,l=s.isRemarkSpeaker,u=s.playToolBarPosition;if(!r&&!l){if(n._delayHide=t,clearTimeout(n._delayTimer),u&&u.show){var d="",c=u.show;Object.keys(c).forEach((function(e){d+=e+":"+c[e]+";"})),n.rootRef&&(n.rootRef.style.cssText=d)}else n.rootRef&&(n.rootRef.style.top="8px");n.hasMouseHover||n.quitPanelVisible||o||a||e||n.hidden(),n.updateToolRectWidth()}},n.hidden=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!e&&n._delayHide&&(e=2e3),clearTimeout(n._delayTimer),t?n._hidden():n._delayTimer=setTimeout((function(){n._hidden()}),e)},n._hidden=function(){if(!n.props.isRemarkSpeaker){var e=n.props.playToolBarPosition;if(e&&e.hidden){var t="",i=e.hidden;Object.keys(i).forEach((function(e){t+=e+":"+i[e]+";"})),n.rootRef&&(n.rootRef.style.cssText=t)}else n.rootRef&&(n.rootRef.style.top="-80px")}},n.openRemarkWin=function(e){n.setState({hasRemarkWin:e})},n.closeRemarkGuideTip=function(){n.state.isShowRemarkGuideTip&&n.guideRef.current&&n.guideRef.current.onCloseGuideTiplose()},n.handleCheckFullScreen=function(e){clearTimeout(n.checkFSTimer),n.checkFSTimer=setTimeout((function(){n.setState({isFullscreen:n.isFullscreen})}),50)},n.createMeeting=function(){n.onClickPlayEnd(),V.exec(V.types.Meeting)},n.onMouseHover=function(e){var t="mouseenter"===e.type;n.hasMouseHover=t,n.props.showInkEditor||(t?n.rootRef&&(n.rootRef.style.top="8px"):n.show())},n.markDropDownVisibleChange=function(e){n.setState({markDropDownVisible:e})},n.openInkEditor=function(e){e&&e.stopPropagation();var t=n.props,i=t.isRemarkSpeaker,o=t.readOnly,a=t.isLogin;i?(!o&&a&&n.connected&&n.rootRef&&(n.rootRef.style.visibility="hidden"),n.state.isShowRemarkGuideTip&&n.guideRef.current&&n.guideRef.current.handleVisibleChange(!1),n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.NORMAL_INFO,data:{type:"inkVisible",value:!0}})):n.hidden(null,!0),n.notifyOpenInkEditor(!0),n.markDropDownVisibleChange(!1)},n.onCloseInkEditor=function(e){n.props.isRemarkSpeaker&&(n.rootRef&&(n.rootRef.style.visibility="visible"),n.state.isShowRemarkGuideTip&&n.guideRef.current&&n.guideRef.current.handleVisibleChange(!0))},n.toggleMarkVisible=function(e){e&&e.stopPropagation(),n.setState({markDropDownVisible:!1}),n.props.isRemarkSpeaker&&n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.NORMAL_INFO,data:{type:"inkVisible",value:!n.inkVisible}}),n.fire(_.default.names.ON_TOGGLE_INK_VISIBLE)},n.openApiOpenRemarkSpeaker=function(){var e=n.props.isRemarkSpeaker;!window.__CONFIG__.wpp.isShowRemarkView||e||n.isRemarksWin||O||n.handleClickRemarks()},n.handleClickRemarks=function(e){e&&e.stopPropagation();var t=!n.props.isRemarkSpeaker;n.rootRef&&(n.rootRef.style.cssText=""),n.fire(n.uiEventTypes.names.ON_TOGGLE_REMARKS_VIEW,{show:t}),window.collection("newui","value",window.pcTrack.newui.play_remarks_on)},n.onVideoFullscreen=function(e){n.rootRef&&(n.rootRef.style.visibility=e?"hidden":"visible")},n.openRemarksWin=function(){window.collection("newui","value",window.pcTrack.newui.remarks_audience),n.fire(n.uiEventTypes.pc.OPEN_REMARK_VIEW_AUDIENCE)},n.setRemarkGuideTipStatus=function(e){n.setState({isShowRemarkGuideTip:e})},n.onClickPlayEnd=function(){n.fire(n.uiEventTypes.pc.play.CLICK_END_PLAY)},n._onClickLaserpen=function(e){window.collection("newui","value",L.newui.ink_laserpen_btn),window.collectionOnce(),n.notifyOpenInkEditor(!0,"laserPen"),n.props.isRemarkSpeaker&&n.state.isShowRemarkGuideTip&&n.guideRef.current&&n.guideRef.current.handleVisibleChange(!1)},n._onClickExit=function(e){window.collection("newui","value",L.newui.meeting_close),window.collectionOnce()},n._onClickFullScreen=function(e){!n.isFullscreen?(window.collection("newui","value",n.isRemarksWin?L.newui.remarks_audience_full_screen:L.newui.play_fullscreem_on_btn),n.fire(n.uiEventTypes.pc.play.CLICK_LANCH_FULLSCREEN)):(window.collection("newui","value",L.newui.play_fullscreem_off_btn),n.fire(n.uiEventTypes.pc.play.CLICK_EXIT_FULLSCREEN,{from:"toolbar"})),window.collectionOnce()},n.onQuitPanelVisibleChange=function(e){n.quitPanelVisible=e},n.insertMark=function(){n.notifyOpenInkEditor(!0)},n.visibleTrue=n.visibleTrue.bind(n),n.onClosepanel=n.onClosepanel.bind(n),n.handleRTCStateChanged=n.handleRTCStateChanged.bind(n),n.handleOffline=n.handleOffline.bind(n),n.handleOnline=n.handleOnline.bind(n),n.state={panelVisible:!1,moreVisible:!1,markDropDownVisible:!1,rtcState:{},onLine:window.navigator.onLine},n.meetingVisible=V.has(V.types.Meeting),n.guideRef=v.a.createRef(),n}return f()(t,e),d()(t,[{key:"componentDidUpdate",value:function(e){w()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this);var n=this.props.isAppReady;e.isAppReady!==n&&n&&this.updateToolRectWidth()}},{key:"updateToolRectWidth",value:function(){if(this.toolRectRef&&!this.toolRectRef.style.width){var e=this.getBoundingClientRect().width;this.toolRectRef.style.width=e?e+"px":""}}},{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.ON_FULLSCREEN_CHANGE,this.handleCheckFullScreen),this.handleCheckFullScreen(),this.show(!!this.isRemarksWin,!0),this.on(this.uiEventTypes.pc.play.CLICK_SHOW_TOOLBAR,this.show),this.on(this.eventTypes.names.ON_CLOSE_INK_EDITOR,this.onCloseInkEditor),this.on(this.uiEventTypes.names.ON_VIDEO_FULLSCREEN,this.onVideoFullscreen),this.on(this.uiEventTypes.names.NOTIFY_LASERPEN_UPDATE,this.onUpdateLaserpen),this.on(this.uiEventTypes.pc.OPEN_REMARK_VIEW_AUDIENCE,this.closeRemarkGuideTip),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_PLAY_TOOLBAR_POSITION,this.openApiSetPlayToolPosition),this.doc.on(this.eventTypes.OPENAPI_EVENT.SHOW_PALY_TOOLBAR,this.openApiHandlerToolbar),this.doc.on(this.eventTypes.OPENAPI_EVENT.OPEN_REMARK_SPEAKER,this.openApiOpenRemarkSpeaker),this.doc.on(this.viewEventTypes.REMARK_AUDIENCE_VIEW_OPENED,this.openRemarkWin)}},{key:"onUnBindEvent",value:function(){this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_PLAY_TOOLBAR_POSITION,this.openApiSetPlayToolPosition),this.doc.off(this.eventTypes.OPENAPI_EVENT.SHOW_PALY_TOOLBAR,this.openApiHandlerToolbar),this.doc.off(this.eventTypes.OPENAPI_EVENT.OPEN_REMARK_SPEAKER,this.openApiOpenRemarkSpeaker),this.doc.off(this.viewEventTypes.REMARK_AUDIENCE_VIEW_OPENED,this.openRemarkWin)}},{key:"handleOffline",value:function(){this.setState({onLine:!1})}},{key:"handleOnline",value:function(){this.setState({onLine:!0})}},{key:"handleRTCStateChanged",value:function(e){this.setState({rtcState:e})}},{key:"getBoundingClientRect",value:function(){return this.rootRef&&this.rootRef.getBoundingClientRect()||{}}},{key:"getToolRect",value:function(){return this.toolRectRef&&this.toolRectRef.getBoundingClientRect()||{}}},{key:"render",value:function(){var e=this,t=this.state,n=t.moreVisible,i=t.hasRemarkWin,o=this.props,a=o.pages,s=o.autoPlay,r=o.isAppReady,l=o.user,u=o.isRemarkSpeaker,d=this.isRemarksWin;if(!r)return!1;var c=this.meetingVisible&&l.isLogin,p=v.a.classNames({"play-component-toolbar":1,"foreign-play-component-toolbar":this.isNotChinese});return v.a.createElement(v.a.Fragment,null,!u&&v.a.createElement("div",{ref:function(t){return e.toolRectRef=t},className:"play-component-toolbar-rect",id:"play-component-toolbar-rect"}),v.a.createElement("div",{ref:function(t){return e.rootRef=t},className:p,id:"play-component-toolbar"},!d&&v.a.createElement(v.a.Fragment,null,(u||c)&&v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:"toolbar-group"},u&&v.a.createElement(T.default,{ref:this.guideRef,placement:T.default.placementTypes.right,eventName:this.eventTypes.guideTips.RemarksViewGuideTips,title:_i18n("applications.presentation.components.PlayPanel.toolbar.audienceViewTips", "打开观众窗口，开始同步演示"),offsetX:10,isClickClosed:!1,isEscClosed:!1,onCloseGuideTip:function(){e.setRemarkGuideTipStatus(!1)},onShowGuideTip:function(){e.setRemarkGuideTipStatus(!0)}},v.a.createElement(E.default,{className:"toolbar-group-item"+(i?" selected":""),iconType:N.wpp_playbar_audience_view,onClick:this.openRemarksWin,title:_i18n("applications.presentation.components.PlayPanel.toolbar.audienceView", "观众窗口")},_i18n("applications.presentation.components.PlayPanel.toolbar.audienceView", "观众窗口"))),c&&v.a.createElement(E.default,{className:"toolbar-group-item",iconType:N.wpp_playbar_create_meeting,onClick:this.createMeeting,title:_i18n("applications.presentation.components.PlayPanel.toolbar.createmeeting", "远程会议")},_i18n("applications.presentation.components.PlayPanel.toolbar.createmeeting", "远程会议"))),v.a.createElement("div",{className:"toolbar-group-splitline"})),v.a.createElement("div",{className:"toolbar-group"},v.a.createElement(E.default,{className:"toolbar-group-item laser-pen",iconType:this.state.activeLaserpen?N.wpp_playbar_laser_active:N.wpp_playbar_laser,onClick:this._onClickLaserpen,selected:!!this.state.activeLaserpen,title:_i18n("applications.presentation.components.PlayPanel.toolbar.laserpen", "激光笔")},_i18n("applications.presentation.components.PlayPanel.toolbar.laserpen", "激光笔")),v.a.createElement(E.default,{className:"toolbar-group-item mark",iconType:N.wpp_play_mark,onClick:this.openInkEditor,title:_i18n("applications.presentation.components.PlayPanel.toolbar.mark", "画笔")},_i18n("applications.presentation.components.PlayPanel.toolbar.mark", "画笔")),window.__CONFIG__.wpp.isShowRemarkView&&!u&&!O&&v.a.createElement(E.default,{className:"toolbar-group-item remarks-view",iconType:N.remarks_view,onClick:this.handleClickRemarks,title:_i18n("applications.presentation.components.PlayPanel.toolbar.remarkView", "备注视图")},_i18n("applications.presentation.components.PlayPanel.toolbar.remarkView", "备注视图")),v.a.createElement(P.default,{panel:v.a.createElement(M,{handleShowPage:function(){return e.fire(e.uiEventTypes.pc.play.CLICK_SHOW_PAGE)},pages:a,autoPlay:s,onClosepanel:this.onClosepanel,isRemarkSpeaker:u,connected:this.connected}),visible:n,onVisibleChange:this.visibleTrue,placement:u?P.default.placementTypes.rightBottom:P.default.placementTypes.topCenter,distance:u?10:8,isAuto:!0},v.a.createElement(E.default,{className:"toolbar-group-item laser-pen",title:_i18n("applications.presentation.components.PlayPanel.toolbar.showmore", "更多"),selected:!!n,iconType:N.wpp_playbar_more},_i18n("applications.presentation.components.PlayPanel.toolbar.showmore", "更多"))),!u&&this.isSupportFullScreen&&this.enabledFullScreen&&window.__CONFIG__.product!==I.default.dingtalk&&!O&&v.a.createElement(D,{cmbId:A.ToolBarFullScreenBtn},v.a.createElement(E.default,{className:"toolbar-group-item",iconType:this.state.isFullscreen?N.wpp_playbar_fullscreen_exit:N.wpp_playbar_fullscreen,title:this.state.isFullscreen?_i18n("applications.presentation.components.PlayPanel.toolbar.exitFullscreen", "退出全屏"):_i18n("applications.presentation.components.PlayPanel.toolbar.fullscreen", "进入全屏"),onClick:this._onClickFullScreen},this.state.isFullscreen?_i18n("applications.presentation.components.PlayPanel.toolbar.exitFullscreen", "退出全屏"):_i18n("applications.presentation.components.PlayPanel.toolbar.fullscreen", "进入全屏")))),v.a.createElement("div",{className:"toolbar-group-splitline"}),v.a.createElement("div",{className:"toolbar-group"},v.a.createElement(E.default,{className:"toolbar-group-item quit-meeting-btn",iconType:N.wpp_playbar_finish,title:_i18n("applications.presentation.components.PlayPanel.toolbar.endPlay", "退出播放"),onClick:this.onClickPlayEnd},_i18n("applications.presentation.components.PlayPanel.toolbar.endPlay", "退出播放")))),d&&v.a.createElement("div",{className:"toolbar-group"},this.isSupportFullScreen&&this.enabledFullScreen&&window.__CONFIG__.product!==I.default.dingtalk&&!O&&v.a.createElement(D,{cmbId:A.ToolBarFullScreenBtn},v.a.createElement(E.default,{className:"toolbar-group-item",iconType:this.state.isFullscreen?N.wpp_playbar_fullscreen_exit:N.wpp_playbar_fullscreen,title:this.state.isFullscreen?_i18n("applications.presentation.components.PlayPanel.toolbar.exitFullscreen", "退出全屏"):_i18n("applications.presentation.components.PlayPanel.toolbar.fullscreen", "进入全屏"),onClick:this._onClickFullScreen},this.state.isFullscreen?_i18n("applications.presentation.components.PlayPanel.toolbar.exitFullscreen", "退出全屏"):_i18n("applications.presentation.components.PlayPanel.toolbar.fullscreen", "进入全屏"))))))}},{key:"visibleTrue",value:function(e){var t=this;this.setState({moreVisible:e},(function(){t.show(!0),t.fire(t.uiEventTypes.pc.play.CLICK_SHOW_MORE,e)}))}},{key:"onClosepanel",value:function(e,t){!t&&this.rootRef&&Object(k.isMouseInElement)(e,this.rootRef)||(this.hasMouseHover=!1),this.visibleTrue(!1)}},{key:"notifyOpenInkEditor",value:function(e,t){this.fire(this.uiEventTypes.names.REQ_OPEN_INK_EDITOR,{open:e,from:"play_toolbar",btnName:t})}},{key:"connected",get:function(){var e=this.props.connected,t=this.state.onLine;return e&&t}},{key:"moreVisible",get:function(){return this.state.moreVisible}}]),t}(y.BaseComponent),F=n(43),x=n.n(F),H=(n(6875),n(6876)),W=n.n(H),U=window.domTools,K=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPlayerEvent=function(e){n.curPlayInfo=e},n.openInkEditor=function(e){"laserPen"===(e&&e.detail&&e.detail.btnName)&&(e.detail.open?n.onClickPen():(n.setState({laserpen:null,pen:null}),n.pen=null)),n.openInkPanel=e.detail&&e.detail.open||e.open},n.onGetDataInRemarkView=function(e){var t=e.detail||e;switch(t.type){case"laserpen":n.updateLaserpen(t);break;case"ink":n.updateInkPath(t),n.updateLaserpen({hidden:!1,points:t.points});break;case"hiddenPen":n.setState({laserpen:null,pen:null}),n.pen=null}},n.updateInkPath=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.points,i=e.pen,o=e.uuid;if(t){n.inkLength+=t.length;var a,s,r=n.pathMap=n.pathMap||{},l=n.pathPointMap=n.pathPointMap||{};if(l[o])(a=l[o]).push.apply(a,x()(t));else l[o]=[].concat(x()(t));if(t=G(t,2*t.length),r[o])(s=r[o].points).push.apply(s,x()(t));r[o]=r[o]||{pen:i,points:t,uuid:o},n.lastPoints=r[o].points,n.nextDrawTimer||n._drawPath(),n.inkLength>0&&(n.delTime=250/n.inkLength)}},n._drawPath=function(){n.nextDrawTimer&&clearTimeout(n.nextDrawTimer);try{var e=n.pathMap||{},t=[],i=!1;for(var o in e){var a=e[o],s=a.points,r=a.pen,l=n.getPathRefByUuid(o),u=s.length,d=void 0;if(n.pathPointMap[o]&&n.pathPointMap[o].length>2)!function(){var e=[];n.pathPointMap[o].forEach((function(t){t=n.ti2SvgPx(t),!isNaN(t.x)&&e.push(t.x),!isNaN(t.y)&&e.push(t.y)}));for(var t=z(e),i=0;i<t.length;i+=2)isNaN(t[i])||isNaN(t[i+1])||(d?d+="L"+t[i]+","+t[i+1]:d="M"+t[i]+","+t[i+1])}();else for(var c=0;c<u;c++){var p=n.ti2SvgPx(s[c]);isNaN(p.x)||isNaN(p.y)||(d?d+="L"+p.x+","+p.y:d="M"+p.x+","+p.y)}if(u<=1||!d)delete e[o],l&&l.setAttribute("d","");else{var h=s[u-1];if(l){var f="red";if(r&&r.color){var m=255&r.color,v=r.color>>8&255;f="rgba("+(r.color>>16&255)+","+v+","+m+","+(r.color>>24&255)+")"}l.setAttribute("stroke",f);var y=r&&n.getPenStrokeWidth(r.width);l.setAttribute("stroke-width",y),l.setAttribute("d",d),h.type}t.push({uuid:o,path:d,pen:r}),i||(e[o].points=s.slice(2),n.pathPointMap[o].shift(),i=!0,n.inkLength-=1,0===n.inkLength&&(n.pathPointMap[o]=[]))}}n.nextDrawTimer=null,t.length>0&&(n.nextDrawTimer=setTimeout(n._drawPath,n.delTime))}catch(e){console.error(e)}},n.onClickPen=function(e,t){if(n.connected){if(e){if(e.open){if(n.pen)return}else if(!n.pen)return}else console.warn("clickLaserpen need args");n.pen||t?(n.pen=null,n.sendLaserpenPoint()):n.pen={color:4294901760,alpha:255,width:1,type:3,auto_disapper:!0},n.setState({path:"",pen:n.pen},(function(){n.drawPen=n._svg.getElementById("draw_pen")})),e&&e.stopPropagation&&e.stopPropagation(),n.fire(n.uiEventTypes.names.NOTIFY_LASERPEN_UPDATE,{open:!!n.pen})}else n.fire(n.eventTypes.names.NOTIFY_INK_BTN_PERMISION,{btnName:"laserPen"})},n.onMouseOverPen=function(e){n.setLaserpenVisible(!1)},n.onSvgClick=function(e){n.pen&&e.stopPropagation()},n.startResizeRemarksArea=function(e){n.setState({resizeRemarksArea:e})},n.onDrawBegin=function(e){var t=e.touches&&e.touches[0]||e,i=t.clientX,o=t.clientY;if(n.pen){n.prevMousePos={clientX:i,clientY:o},n.mouseAction="start";var a=n.px2SlideTi(e);a.type=0,n.points=[a],n.pointInfo={uuid:Date.now(),serial:0}}0===e.button&&n.props.onClick&&n.props.onClick(e)},n.onDrawMove=function(e){if(!n.openInkPanel)return n.pen=null,void(n.mouseAction=null);e.preventDefault();var t=e.touches&&e.touches[0]||e,i=t.clientX,o=t.clientY;if(!n.prevMousePos||Math.abs(n.prevMousePos.clientX-i)>3||Math.abs(n.prevMousePos.clientY-o)>3){n.prevMousePos={clientX:i,clientY:o};var a=n.px2SlideTi(e);a.type=2,"start"===n.mouseAction?(n.points.push(a),n.sendInkPoints({points:n.points})):n.pen&&(n.penPoints=[a],n.sendLaserpenPoint()),n.setLaserpenVisible(!0)}},n.onDrawEnd=function(e){if("start"===n.mouseAction){var t=n.px2SlideTi(e);t.type=1,n.points.push(t),n.sendInkPoints({points:n.points}),window.collection("newui","value",window.pcTrack.newui.ink_laser_insert)}n.mouseAction="end",e.preventDefault(),"mouseleave"===e.type&&n.openInkPanel&&n.laserPenRef&&n.laserPenRef.setAttribute("style","display:none")},n.onDrawLeaveIn=function(e){n.openInkPanel&&n.laserPenRef&&n.laserPenRef.setAttribute("style","display:block"),n.onDrawMove(e)},n.sendLaserpenPoint=function(){var e=n.penPoints||[],t=null==n.pen||0===e.length;n.updateLaserpen({hidden:t,points:e});var i=n.props.isRemarkSpeaker;n.sendSpan=n.sendSpan||0,n.sendSpan>1||t?(n.openInkPanel&&n.doc.fire(n.viewEventTypes.WPP_LASERPEN_INK_POINTS,{data:{type:"laserpen",hidden:t,points:[e[e.length-1]]}}),i&&n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.LASER_INFO,data:{type:"laserpen",hidden:t,points:[e[e.length-1]]}}),n.sendSpan=0):n.sendSpan++},n.sendInkPoints=function(){var e,t=n.pen,i=n.pointInfo,o=i.uuid,a=i.serial,s=n.points;n.updateInkPath({pen:t,points:s,uuid:o}),n.updateLaserpen({hidden:!1,points:s});var r=n.props.isRemarkSpeaker;n._sendPoints=n._sendPoints||[],(e=n._sendPoints).push.apply(e,x()(s));var l=n._sendPoints.length;l>0&&(l>4||1===n._sendPoints[l-1].type)&&(n.openInkPanel&&n.doc.fire(n.viewEventTypes.WPP_LASERPEN_INK_POINTS,{data:{type:"ink",scale:1,pen:t,points:n._sendPoints,uuid:o,serial:a}}),r&&n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.LASER_INFO,data:{type:"ink",scale:1,pen:t,points:n._sendPoints,uuid:o,serial:a}}),n.pointInfo.serial++,n._sendPoints=[]),n.points=[]},n.state={path:"",pen:null},n.inkLength=0,n.openInkPanel=!1,n}return f()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){var e=document.getElementById("artboard");U.addEventListener(e,"mousedown",this.onDrawBegin),U.addEventListener(e,"mousemove",this.onDrawMove),U.addEventListener(e,"mouseup",this.onDrawEnd),this.on(this.eventTypes.names.REQ_OPEN_INK_EDITOR,this.openInkEditor),e.addEventListener("mouseleave",this.onDrawEnd),e.addEventListener("mouseenter",this.onDrawLeaveIn),window.addEventListener(this.eventTypes.OPENAPI_EVENT.UPDATE_LASERPEN,this.onGetDataInRemarkView),window.addEventListener(this.eventTypes.OPENAPI_EVENT.OPEN_INK_EDITOR,this.openInkEditor),this.nextPageBtn&&this.updatePlayBtn(!0,this.props.slideCount<=1),this._svg=e,this._screen={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight},this.doc.on(b.VIEW_EVENT_TYPES.PLAYER_EVENT,this.onPlayerEvent),this.on(this.uiEventTypes.names.REQ_OPEN_LASERPEN,this.onClickPen),this.on(this.uiEventTypes.pc.play.START_RESIZE_REMARKS_AREA,this.startResizeRemarksArea),this.bindEvent(),this.isRemarksWin&&this.on(this.uiEventTypes.names.ON_GET_REMARKS_LASERPEN,this.onGetDataInRemarkView)}},{key:"onUnBindEvent",value:function(){var e=this._svg;U.removeEventListener(e,"mousedown",this.onDrawBegin),U.removeEventListener(e,"mousemove",this.onDrawMove),U.removeEventListener(e,"mouseup",this.onDrawEnd),e.removeEventListener("mouseleave",this.onDrawEnd),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.UPDATE_LASERPEN,this.onGetDataInRemarkView),e.removeEventListener("mouseenter",this.onDrawLeaveIn),this.off(this.eventTypes.names.REQ_OPEN_INK_EDITOR,this.openInkEditor),this.off(this.uiEventTypes.pc.play.START_RESIZE_REMARKS_AREA,this.startResizeRemarksArea),clearTimeout(this.timer),this.pen=null,this.mouseAction=null,this.sendLaserpenPoint(),this.doc.off(b.VIEW_EVENT_TYPES.PLAYER_EVENT,this.onPlayerEvent),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.OPEN_INK_EDITOR,this.openInkEditor)}},{key:"bindEvent",value:function(){this.lasterPen=this._svg.getElementById("laster_pen"),this.drawPen=this._svg.getElementById("draw_pen")}},{key:"UNSAFE_componentWillReceiveProps",value:function(){this.openInkPanel||this.pen&&(this.pen=null,this.setState({pen:null}))}},{key:"componentDidUpdate",value:function(){w()(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentDidUpdate",this).call(this),this.bindEvent(),this.lasterPen&&(this.lasterPen.onmousedown=function(e){e.preventDefault()})}},{key:"getPathRefByUuid",value:function(e){if(this.uuidRef=this.uuidRef||{},this.pathUuid=this.pathUuid||{},this.uuidRef[e])return this.uuidRef[e];for(var t=0;t<5;t++){var n="r_"+t;if(!this.refs[n].getAttribute("d"))return delete this.uuidRef[this.pathUuid[n]],delete this.pathUuid[n],this.uuidRef[e]=this.refs[n],this.pathUuid[n]=e,this.uuidRef[e]}}},{key:"updateLaserpen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.points,n=e.hidden;t=t||[];var i=this.ti2SvgPx(t[t.length-1]),o={x:i.x,y:i.y};if(n)this.setState({laserpen:null,pen:null}),this.pen=null;else if(this.pen||this.onClickPen({open:!0}),this.laserPenRef){var a=o.x-16,s=o.y-16;this.laserPenRef.setAttribute("x",a),this.laserPenRef.setAttribute("y",s)}else this.setState({laserpen:o})}},{key:"getPenStrokeWidth",value:function(e){var t=this.slideLayout;t&&e?e=4*e*t.scale*10:e*=4;return e>1?e:1}},{key:"setLaserpenVisible",value:function(e,t){this.laserPenRef&&(e=e?"visible":"hidden",this.lasterPenVisible!==e&&(this.laserPenRef.style.visibility=e,console.log("setLaserpenVisible",e)),this.lasterPenVisible=e)}},{key:"px2SlideTi",value:function(e){var t="touchend"===e.type?e.changedTouches[0]:e.touches&&e.touches[0]||e,n={x:t.clientX,y:t.clientY},i=this.slideLayout;if(i){var o=i.scale,a=i.bestZoom,s=this.doc.getSvgClientRect(),r=s.x,l=s.y;n.x-=r,n.y-=l;var u=20*o*a;n.x/=u,n.y/=u}return n.width=.5,n}},{key:"ti2SvgPx",value:function(e){var t=o()({},e),n=this.slideLayout;if(n){var i=n.scale,a=n.svgLayout,s=n.bestZoom,r=n.containerSize,l=(r.width-a.width)/2,u=(r.height-a.height)/2,d=20*i*s;t.x*=d,t.y*=d,t.x+=l,t.y+=u}return t}},{key:"render",value:function(){var e=this,t=this.state,n=t.pen,i=t.pathArr,o=t.laserpen,a=t.resizeRemarksArea,s=(i=[{uuid:0,path:""},{uuid:1,path:""},{uuid:2,path:""},{uuid:3,path:""},{uuid:4,path:""}])&&i.map((function(e){var t=e.uuid,n=e.path;return v.a.createElement("path",{ref:"r_"+t,key:t,strokeLinecap:"round",strokeLinejoin:"round",d:n,fill:"none"})})),r=this.props,l=r.remarkAreaWidth,u=r.isRemarkSpeaker?{width:"calc(100% - "+(l+70+60)+"px)"}:{};return v.a.createElement("div",{className:"component-drawingboard "+(this.pen?"show":""),id:"drawingboard",style:u},v.a.createElement("svg",{id:"artboard",width:"100%",height:"100%",className:"drawingboard-highlighter",style:{cursor:n?a?"":"none":"defaule"},onTouchCancel:this.onDrawEnd,onClick:this.onSvgClick},o&&!a&&v.a.createElement("image",{id:"laster_pen",ref:function(t){return e.laserPenRef=t},xlinkHref:W.a,x:o.x-16,y:o.y-16,height:32,width:32}),s))}},{key:"slideLayout",get:function(){return this.doc.getLayout()}}]),t}(y.BaseComponent);function G(e,t){for(var n=[],i=0;i<t;i++){var o=j(e,i/t);n.push(o)}return n}function j(e,t){for(var n=e.length,i=0,o=0,a=0;a<n;a++){var s=e[a];i+=s.x*Math.pow(1-t,n-1-a)*Math.pow(t,a)*Y(n-1,a),o+=s.y*Math.pow(1-t,n-1-a)*Math.pow(t,a)*Y(n-1,a)}return{x:i,y:o}}function Y(e,t){for(var n=1,i=1;t>0;)n*=e,i*=t,e--,t--;return n/i}function z(e){var t=[],n=[],i=void 0,o=void 0,a=void 0,s=void 0,r=void 0,l=void 0,u=void 0,d=void 0,c=void 0,p=void 0,h=void 0,f=void 0,m=void 0;for((t=e.slice(0)).unshift(e[1]),t.unshift(e[0]),t.push(e[e.length-2]),t.push(e[e.length-1]),m=2;m<t.length-4;m+=2)for(f=0;f<=2;f++)a=.5*(t[m+2]-t[m-2]),s=.5*(t[m+4]-t[m]),r=.5*(t[m+3]-t[m-1]),l=.5*(t[m+5]-t[m+1]),h=f/2,u=2*Math.pow(h,3)-3*Math.pow(h,2)+1,d=-2*Math.pow(h,3)+3*Math.pow(h,2),c=Math.pow(h,3)-2*Math.pow(h,2)+h,p=Math.pow(h,3)-Math.pow(h,2),i=u*t[m]+d*t[m+2]+c*a+p*s,o=u*t[m+1]+d*t[m+3]+c*r+p*l,n.push(i),n.push(o);return n}n(6877);var $=n(148),X=n(289),q=n(810),Z=n(1494),Q=$.default.types.size16,J=window.pcTrack,ee=window.Toast,te=window.CommandBarComponentFragment,ne=te.cmbIds.wpp,ie=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPlayerEvent=function(e){var t=e.slideFinished,i=e.slideIndex,o=e.canBackward,a=e.canForward;n.setState({activeSlideIndex:i,slideFinished:t,canBackward:o,canForward:a})},n.onShow=function(e,t){var i=n.doc.getPlayInfo(),o=n.state.menuPosition;o={x:e,y:t},n.setState({canBackward:i.canBackward,canForward:i.canForward,activeSlideIndex:i.slideIndex,visible:!0,menuPosition:o}),window.collection("newui","value","onplay_rightmenu")},n.onClose=function(e){n.setState({visible:!1}),n.props.stopWPClick&&n.props.stopWPClick()},n.onUpdateLaserpen=function(e){n.setState({activeLaserpen:e.open,visible:!1})},n.onSlideChangeOper=function(e){if(!window._ban_slide_change)switch(e){case"up":n.isRemarksWin?n.shell.remarkSpeakerDoc.stepBackward():n.doc.stepBackward();break;case"down":n.isRemarksWin?n.shell.remarkSpeakerDoc.stepForward():n.doc.stepForward();break;case"first":n.isRemarksWin?n.shell.remarkSpeakerDoc.stepTo(n.First):n.doc.stepTo(n.First);break;case"end":n.isRemarksWin?n.shell.remarkSpeakerDoc.stepTo(n.End):n.doc.stepTo(n.End);break;default:return}n.setState({visible:!1})},n.viewOriginalPic=function(){var e=n.props.connected;if(window.collection("newui","value",J.newui.play_showpic_rightmenu),!e||!navigator.onLine)return ee.warn(_i18n("applications.presentation.components.PlayPanel.playMenu.offline", "与服务器断开链接，正在重连")),void n.setState({visible:!1});var t=Object(Z.b)(n.doc),i=n.state.menuPosition,o=Object(Z.a)(i.x,i.y,t);_.default.dispatchEvent(_.default.names.ON_OPEN_IMAGE_VIEWER,{shape:o}),n.setState({visible:!1}),n.props.isRemarkSpeaker&&n.fire(n.uiEventTypes.names.ON_POST_REMARKS_DATA,{event:n.eventTypes.remarkEvent.NORMAL_INFO,data:{type:"originPic",value:"open",shapeId:o.getId(),slideId:o.getSlideId()}})},n.openInkEditor=function(e){n.setState({visible:!1}),e&&e.stopPropagation(),n.doc.fire(n.viewEventTypes.WPP_INK_TOOLBAR,{show:!0}),n.fire(_.default.names.REQ_OPEN_INK_EDITOR,{open:!0})},n.toggleInkVisible=function(e){n.setState({visible:!1}),e&&e.stopPropagation(),n.fire(_.default.names.ON_TOGGLE_INK_VISIBLE)},n.handleAutoPlayChange=function(e){n.dispatchEvent(n.uiEventTypes.pc.ON_START_PLAY,{type:"auto",isFormExplain:!1,isFromPlay:!1}),n.onClose(),window.collection("newui","value",window.pcTrack.newui.onplay_rightmenu_autoplay)},n.onClickLaserpen=function(e){n.fire(n.uiEventTypes.names.REQ_OPEN_INK_EDITOR,{open:!0,from:"play_menu",btnName:"laserPen"})},n.handleFullScreen=function(e){!n.isFullscreen?n.fire(n.uiEventTypes.pc.play.CLICK_LANCH_FULLSCREEN):n.fire(n.uiEventTypes.pc.play.CLICK_EXIT_FULLSCREEN,{from:"play_menu"})},n.handleCheckFullScreen=function(e){clearTimeout(n.checkFSTimer),n.checkFSTimer=setTimeout((function(){n.setState({isFullscreen:n.isFullscreen})}),50)},n.handleEndPlay=function(){if(n.isRemarksWin){var e={event:n.eventTypes.remarkEvent.AUDIENCE_END_PLAY},t=JSON.stringify(e);return window.opener&&window.opener.postMessage(t,window.location.origin)}n.fire(n.uiEventTypes.pc.play.CLICK_END_PLAY)},n.handleAudienceView=function(){n.fire(n.uiEventTypes.pc.OPEN_REMARK_VIEW_AUDIENCE),n.onClose()},n.handleShowThumbnail=function(e,t){t.stopPropagation(),n.fire(n.uiEventTypes.pc.play.CLICK_SHOW_MINI_THUMBNAIL,{visible:!0}),n.onClose()},n.state={visible:!1,menuPosition:{left:0,top:0}},n}return f()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){this.doc.on(q.a.PLAYER_EVENT,this.onPlayerEvent),this.on(this.uiEventTypes.pc.ON_FULLSCREEN_CHANGE,this.handleCheckFullScreen),this.handleCheckFullScreen(),this.on(this.uiEventTypes.names.NOTIFY_LASERPEN_UPDATE,this.onUpdateLaserpen)}},{key:"onUnBindEvent",value:function(){this.doc.off(q.a.PLAYER_EVENT,this.onPlayerEvent)}},{key:"onHidden",value:function(){this.setState({visible:!1})}},{key:"pageFirst",value:function(){for(var e=0;e>=0;){var t=this.doc.getSlideAt(e);if(!t||!t.getHiddenStatus())break;e++}return e}},{key:"pageEnd",value:function(){for(var e=this.slideCount-1;e;){var t=this.doc.getSlideAt(e);if(!t||!t.getHiddenStatus())break;e--}return e}},{key:"render",value:function(){var e=this,t=this.state,n=t.visible,i=t.menuPosition,o=t.activeSlideIndex,a=t.activeLaserpen,s=t.canBackward,r=t.canForward,l=t.isFullscreen,u=this.props,d=u.autoPlay,c=u.isRemarkSpeaker,p=u.showInkEditor,h=u.connected;return n?(this.First=this.pageFirst(),this.End=this.pageEnd(),v.a.createElement(X.default,{visible:n,ref:function(t){return e.contextMenuRef=t},onClose:this.onClose,onMouseDown:function(e){e.cancelBubble=!0,e.stopPropagation()},position:i},v.a.createElement(X.default.Menu,{className:"wpp_playing_menu",ref:function(t){return e.playingMenuRef=t}},this.showViewPicBtn&&!this.isRemarksWin&&v.a.createElement(te,{cmbId:ne.PlayContextCheckImage},v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item}",onClick:this.viewOriginalPic},v.a.createElement($.default,{type:Q.check_origin_pic}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.viewOriginalPic", "查看原图"))),v.a.createElement(X.default.Menu.Divider,null)),!c&&!this.isRemarksWin&&!p&&v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.onClickLaserpen,title:_i18n("applications.presentation.components.PlayPanel.playMenu.highlighterTips", "按键J，打开激光笔")},v.a.createElement($.default,{type:Q.laserpen}),v.a.createElement("span",null,a?_i18n("applications.presentation.components.PlayPanel.playMenu.highlighter.close", "关闭激光笔"):_i18n("applications.presentation.components.PlayPanel.playMenu.highlighter.open", "打开激光笔(J)"))),this.isRemarksWin&&v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.handleFullScreen},v.a.createElement($.default,{type:Q.stop_playmode}),v.a.createElement("span",null,l?_i18n("applications.presentation.components.PlayPanel.playMenu.exitFullscreen", "退出全屏"):_i18n("applications.presentation.components.PlayPanel.playMenu.enterFullscreen", "进入全屏"))),v.a.createElement(m.Fragment,null,v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item "+(s?"":"disabled"),onClick:function(t){return e.onSlideChangeOper("up")},title:_i18n("applications.presentation.components.PlayPanel.playMenu.pageUpTips", "按键P，切换上一页")},v.a.createElement($.default,{type:Q.arrow_up}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.pageUp", "上一页(P)"))),v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item "+(r?"":"disabled"),onClick:function(t){return e.onSlideChangeOper("down")},title:_i18n("applications.presentation.components.PlayPanel.playMenu.pageDownTips", "按键N，切换下一页")},v.a.createElement($.default,{type:Q.arrow_down}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.pageDown", "下一页(N)"))),v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item "+(o>this.First?"":"disabled"),onClick:function(t){return e.onSlideChangeOper("first")},title:_i18n("applications.presentation.components.PlayPanel.playMenu.pageFirstTips", "按键F，切换至第一页")},v.a.createElement($.default,{type:Q.arrow_first}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.pageFirst", "第一页(F)"))),v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item "+(o<this.End?"":"disabled"),onClick:function(t){return e.onSlideChangeOper("end")},title:_i18n("applications.presentation.components.PlayPanel.playMenu.pageEndTips", "按键L，切换至最后一页")},v.a.createElement($.default,{type:Q.arrow_end}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.pageEnd", "最后一页(L)")))),!c&&!this.isRemarksWin&&v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.handleShowThumbnail,title:_i18n("applications.presentation.components.PlayPanel.playMenu.specifyPageTips", "按键S，可快速跳转到指定幻灯片")},v.a.createElement($.default,{type:Q.specify_page}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.specifyPage", "指定幻灯片(S)"))),!c&&!this.isRemarksWin&&v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.handleAutoPlayChange,disabled:!h},v.a.createElement($.default,{type:Q.auto_play}),v.a.createElement("span",null,d?_i18n("applications.presentation.components.PlayPanel.playMenu.autoPlayStop", "停止自动播放"):_i18n("applications.presentation.components.PlayPanel.playMenu.autoPlay", "自动播放"))),!c&&!this.isRemarksWin&&!p&&v.a.createElement(X.default.SubMenu,{title:v.a.createElement(v.a.Fragment,null,v.a.createElement($.default,{type:Q.mark}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.mark", "画笔"))),className:"play-sub-mark"},v.a.createElement(X.default.Menu.Item,{onClick:this.openInkEditor,title:_i18n("applications.presentation.components.PlayPanel.playMenu.addMarkTips", "按键H，打开画笔")},v.a.createElement($.default,{type:Q.add_mark}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.addMark", "打开画笔(H)"))),v.a.createElement(X.default.Menu.Item,{className:"show_mark "+(this.inkVisible?"active":""),onClick:this.toggleInkVisible},v.a.createElement($.default,{type:Q.show_mark}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.showMark", "显示墨迹")))),c&&!this.isRemarksWin&&v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.handleAudienceView},v.a.createElement($.default,{type:Q.audience_view}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.audienceView", "观众窗口"))),v.a.createElement(X.default.Menu.Item,{className:"playing_menu_item",onClick:this.handleEndPlay},v.a.createElement($.default,{type:Q.stop_playmode}),v.a.createElement("span",null,_i18n("applications.presentation.components.PlayPanel.playMenu.endPlay", "退出播放")))))):null}},{key:"visible",get:function(){return this.state.visible}},{key:"showViewPicBtn",get:function(){var e=this.state.menuPosition,t=Object(Z.b)(this.doc),n=Object(Z.a)(e.x,e.y,t),i=n&&n.getShapeType();return!(n&&n.isLatexMath())&&(i===b.ShapeType.Picture||i===b.ShapeType.Processon)}},{key:"element",get:function(){return this.playingMenuRef&&this.playingMenuRef&&this.playingMenuRef.refPanel&&this.playingMenuRef.refPanel.current}}]),t}(y.BaseComponent),oe=(n(6878),function(e){function t(){var e,n,i,o;l()(this,t);for(var a=arguments.length,s=Array(a),r=0;r<a;r++)s[r]=arguments[r];return n=i=p()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.handleMouseMove=function(e,t){if(i.link.initDataByHitInfo(t),i.link.hasLink){window.domTools.setCursor("pointer");var n=i.link.getViewAddress();i.updateTip(e,n)}else i.closeTip()},i.updateTip=function(e,t){var n=e.top,o=e.left;i.$tip||(i.$tip=document.createElement("div"),i.$tip.id="play-hover-link-tip"),i.$parent||(i.$parent=document.getElementById("play-component")),i.$workspace||(i.$workspace=document.getElementById("workspace"));var a=document.createTextNode(t||_i18n("applications.presentation.components.CommandBars.RbTab.InsertTab.HyperlinkModal.slideDeleted", "链接的幻灯片已被删除"));i.$tip.innerHTML="",i.$tip.appendChild(a),document.getElementById("play-hover-link-tip")||i.$parent.appendChild(i.$tip);var s=document.body,r=s.clientWidth,l=s.clientHeight,u=i.$tip.getBoundingClientRect(),d=u.width,c=u.height,p=o+16,h=n+24;p+d>r&&(p=r-d),h+c>l&&(h=l-c),i.$tip.style.left=p+"px",i.$tip.style.top=h+"px"},i.closeTip=function(){i.link.hasLink&&i.link.clearData(),i.$tip&&i.$parent&&(window.domTools.setCursor(),i.$parent.contains(i.$tip)&&i.$parent.removeChild(i.$tip),i.$tip=null)},i.handleClick=function(e){i.link.open(),i.closeTip()},o=n,p()(i,o)}return f()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.link.ON_OPEN_LINK,this.handleClick)}},{key:"render",value:function(){return null}},{key:"link",get:function(){return this.editor&&this.editor.link}}]),t}(y.BaseComponent)),ae=n(3863),se=n(3865),re=(n(6879),function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isLatexMath=function(e){var t=e&&e.getExtData();return t&&t.isLatexMath},n.handleMouseMove=function(e,t){var i=n.coreView.doc.layoutResult,o=n.getRootRect();if(o&&o.left<e.left&&e.left<o.left+o.width&&e.top>o.top&&e.top<o.top+o.height&&t&&t.hitTestInfo&&t.shape&&t.slide&&t.slide.isTopLayer){var a=t.shape,s=a.getUilLayoutRect(i.scale/window.ti2pxRatio),r=s&&s.width<=200&&s.height<=200,l=a.shapeData.getPicture()&&!a.shapeData.isMedia()&&!n.isLatexMath(a.shapeData);r||!l||!n.state.visible&&n.state.activeShape===a?l||(clearTimeout(n.hideTimer),n.setState({visible:!0,activeShape:null})):(n.state.activeShape!==a&&(clearTimeout(n.hideTimer),n.hideTipLater()),n.state.activeShape!==a&&window.collection("newui","value","openpic_onplay_showtips"),n.setState({visible:!0,activeShape:a,mousePosition:{x:e.left,y:e.top}}))}else clearTimeout(n.hideTimer),n.setState({visible:!0,activeShape:null})},n.state={visible:!0,activeShape:null},n}return f()(t,e),d()(t,[{key:"getRootRect",value:function(){var e=document.querySelector(".play_root_container");if(e){var t={},n=e.getBoundingClientRect(),i=n.left,o=n.top,a=n.width,s=n.height;t={left:i,top:o,width:a,height:s};var r=Number(e.style.zoom);return r&&Object.keys(t).forEach((function(e){t[e]*=r})),t}return null}},{key:"hideTipLater",value:function(){var e=this;this.hideTimer=setTimeout((function(){e.setState({visible:!1})}),2e3)}},{key:"hideTip",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.mousePosition,i=e.activeShape;if(!t||!i)return null;var o={left:n.x+25,top:n.y+25};return v.a.createElement("div",{className:"image-tip-container"},v.a.createElement("div",{className:"tip-content",style:o},_i18n("applications.presentation.components.PlayPanel.imageView.hoverTip", "右键可查看原图")))}}]),t}(y.BaseComponent)),le=n(697),ue=(n(6880),n(205)),de=(n(6881),n(144)),ce=function(e,t){return t>=e.split(".")[1].length},pe=function(e,t,n,i){var o=e,a=/^(-)?(0)+$/,s=a.test(o);return s&&(o=o.replace(a,"$10")),t&&!n?function(e){e=Number(e);return{valid:/^\d+$/.test(e),newStr:e}}(o):t&&n?function(e){var t=/^(-)?\d*$/.test(e);return/(-)?\d+$/.test(e)&&(e=Number(e)),{valid:t,newStr:e}}(o):t||n?!t&&n?function(e,t,n){var i=/^(-)?\d+\.\d+$/,o=/^(-)?\d*$/.test(e)||/^(-)?\d+\.$/.test(e)||i.test(e);i.test(e)&&!ce(e,n)&&(o=!1);return/(-)?0+\d+$/.test(e)&&(e=Number(e)),{valid:o,newStr:e}}(o,0,i):void 0:function(e,t){var n=/^\d+$/,i=/^\d+\.\d+$/,o=n.test(e)||/^\d+\.$/.test(e)||i.test(e);return i.test(e)&&!ce(e,t)&&(o=!1),n.test(e)&&(e=Number(e)),{valid:o,newStr:e}}(o,i)},he=n(155),fe=he.default.iconTypes.size16,me=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));ve.call(n),n.handleAddBtnClick=n.handleAddBtnClick.bind(n),n.handleMinusBtnClick=n.handleMinusBtnClick.bind(n),n.handleInputBlur=n.handleInputBlur.bind(n),n.handleInputChange=n.handleInputChange.bind(n),n.handleInputKeyDown=n.handleInputKeyDown.bind(n),n.handleInputKeyUp=n.handleInputKeyUp.bind(n),n.handleInputWheel=n.handleInputWheel.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseUp=n.handleMouseUp.bind(n),n.handleInputFocus=n.handleInputFocus.bind(n),n.getValue=n.getValue.bind(n);var i=n.props,o=i.value,a=i.defaultValue,s=i.step;return n.step=s||1,n.defaultValue=a||o,n.state={value:o,isMouseHover:de.isPad},n._lockLazyChange=!0,n}return f()(t,e),d()(t,[{key:"componentDidUpdate",value:function(e,t){e.value!==this.props.value&&(this.setState({value:this.props.value}),this._lockLazyChange=!0)}},{key:"getValue",value:function(){var e=this.props,t=e.value,n=e.isInt,i=e.min,o=e.max,a=this.refInput.current.value,s=n?parseInt(a):parseFloat(a);return s>o||s<i?Number(t):isNaN(s)?Number(this.defaultValue):Number(s)}},{key:"select",value:function(){this.refInput.current.select()}},{key:"blur",value:function(){this.refInput.current.blur()}},{key:"getInnerValue",value:function(){return Number(this.refInput.current.value)}},{key:"getInputText",value:function(){return this.refInput.current.value}},{key:"setValue",value:function(e){var t=this.props,n=t.max,i=t.min;return e=(e=isNaN(e)||""===e?this.defaultValue:e)>n?n:e<i?i:e,this._lockLazyChange=e===this.props.value,this.setState({value:e}),e}},{key:"setInvalidValue",value:function(e){this.setState({value:e})}},{key:"inputChange",value:function(e){var t=this.props,n=t.max,i=t.min,o=t.isInt,a=t.isNegative,s=t.places,r=e.replace(/\s+/g,"");if(""!==r){if(!(r>n)){var l=pe(r,o,a,s),u=l.valid,d=l.newStr;u&&d<i?this.setInvalidValue(d):u&&isNaN(d)?this.setState({value:d}):u&&"-0"===r?this.setState({value:r}):u&&this.setValue(d)}}else this.setInvalidValue(r)}},{key:"handleInputChange",value:function(e){e.preventDefault();var t=e.target.value;this.inputChange(t)}},{key:"handleInputBlur",value:function(e){e.preventDefault();var t=this.state.value;parseInt(t)<10&&(t="0"+parseInt(t)),this.setValue(t),this.props.onBlur&&this.props.onBlur(e)}},{key:"handleInputFocus",value:function(e){this.props.onFocus&&this.props.onFocus(e)}},{key:"handleInputKeyUp",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"handleAddBtnClick",value:function(e){this.btnClick(e,!0)}},{key:"handleMinusBtnClick",value:function(e){this.btnClick(e,!1)}},{key:"btnClick",value:function(e,t){e.preventDefault();var n=this.state.value,i=this.props.step;if(-1===e.currentTarget.className.indexOf("disabled")){var o=parseFloat(n);(o+=t?i:-i)<10&&(o="0"+o),this.setValue(o)}}},{key:"handleMouseDown",value:function(e){var t=this,n=e.target===this.refAdd.current;clearTimeout(this.clickTimeout),clearInterval(this.clickInterval);var i={currentTarget:{className:e.currentTarget.className},preventDefault:e.preventDefault};this.clickTimeout=setTimeout((function(){t.clickInterval=setInterval((function(){n?t.handleAddBtnClick(i):t.handleMinusBtnClick(i)}),100)}),500)}},{key:"handleMouseUp",value:function(){clearTimeout(this.clickTimeout),clearInterval(this.clickInterval)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.max,i=e.unit,o=e.onPaste,a=e.min,s=this.state,r=s.value,l=s.isMouseHover,u=s.isUpBtnHover,d=s.isDownBtnHover,c=!!(r>=n),p=!!(r<=a);return v.a.createElement("div",{className:"component-input-box "+(t||""),ref:this.mianRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onWheel:this.handleInputWheel},l&&v.a.createElement(he.default,{className:"input-btn-up "+(u?"is-hover":""),iconType:fe.arrow_gray,ref:this.refAdd,onClick:this.handleAddBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseEnter:this.handleEnterBtn,onMouseLeave:this.handleLeaveBtn,disabled:c}),v.a.createElement("input",{ref:this.refInput,className:" input-content "+(0===parseInt(r)?"empty":""),value:r,maxLength:3,type:"text",tabIndex:-1,onFocus:this.handleInputFocus,onKeyUp:this.handleInputKeyUp,onMouseUp:this.handleInputMouseUp,onKeyDown:this.handleInputKeyDown,onChange:this.handleInputChange,onBlur:this.handleInputBlur,onPaste:o}),l&&v.a.createElement(he.default,{className:"input-btn-down "+(d?"is-hover":""),iconType:fe.arrow_gray,onClick:this.handleMinusBtnClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseEnter:this.handleEnterDownBtn,onMouseLeave:this.handleLeaveDownBtn,disabled:p}),!!i&&v.a.createElement("i",{className:"unit"},i))}}]),t}(m.PureComponent);me.defaultProps={max:9999,min:-9999,value:"00",isInt:!1,isNegative:!1,places:2,stopbubble:!0,showBtn:!0,step:1,isMouseHover:de.isPad};var ve=function(){var e=this;this.handleInputKeyDown=function(t){var n=t.key,i=t.keyCode;if("ArrowUp"!==n&&38!==i)if("ArrowDown"!==n&&40!==i){var o=e.props.onEnter;if("Enter"===n||13===i){t.preventDefault(),o&&o();var a=e.state.value;parseInt(a)<10&&(a="0"+parseInt(a)),e.setState({value:a}),e.refInput.current.blur()}}else e.handleMinusBtnClick(t);else e.handleAddBtnClick(t)},this.handleInputMouseUp=function(e){var t=e||window.event;t&&t.preventDefault&&t.preventDefault()},this.handleInputWheel=function(t){var n=e.props,i=n.max,o=n.min,a=n.step,s=parseInt(e.state.value);s=t.deltaY>0||t.deltaX<0?s<=o||s-a<=o?o:s-a:s>=i||s+a>=i?i:s+a,parseInt(s)<10&&(s="0"+parseInt(s)),e.setState({value:s})},this.clickTimeout=null,this.clickInterval=null,this.refAdd=v.a.createRef(),this.refInput=v.a.createRef(),this.mianRef=v.a.createRef(),this.handleMouseEnter=function(){de.isPad||e.setState({isMouseHover:!0})},this.handleMouseLeave=function(){de.isPad||e.setState({isMouseHover:!1})},this.handleEnterBtn=function(){e.setState({isUpBtnHover:!0})},this.handleEnterDownBtn=function(){e.setState({isDownBtnHover:!0})},this.handleLeaveBtn=function(){e.setState({isUpBtnHover:!1}),clearTimeout(e.clickTimeout),clearInterval(e.clickInterval)},this.handleLeaveDownBtn=function(){e.setState({isDownBtnHover:!1}),clearTimeout(e.clickTimeout),clearInterval(e.clickInterval)}},ye=me,ge=n(257),we=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCancel=function(){n.fire(n.uiEventTypes.pc.play.CLICK_CLOSE_SET_COUNTDOWN)},n.onCheckBoxChange=function(e){n.setState({chooseBell:e})},n.startCountTime=function(){var e=n.state.chooseBell,t=n.refHours.current.refInput.current.value,i=n.refMinutes.current.refInput.current.value,o=n.refSeconds.current.refInput.current.value;"00"!==t||"00"!==i||"00"!==o?(n.setKeyState(R.a.ON_TIME_COUNTING,!0),n.fire(n.uiEventTypes.pc.play.CLICK_SHOW_TIME_COUNT,{hours:t,minutes:i,seconds:o,chooseBell:e})):window.Toast.warn(_i18n("applications.presentation.components.CountDown.setTimeFirst", "请设置时间"))},n.handleFocus=function(e){var t=e.current;t&&t.select()},n.state={autoPlay:!1},n.refModal=v.a.createRef(),n.refHours=v.a.createRef(),n.refMinutes=v.a.createRef(),n.refSeconds=v.a.createRef(),n}return f()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=this.state.chooseBell;return v.a.createElement(ue.default,{className:"count_detail_panel",ref:this.refModal,onCancel:this.onCancel,title:_i18n("applications.presentation.components.CountDown.title", "倒计时"),showFooter:!1},v.a.createElement("div",{className:"count_down_second_title"},v.a.createElement("div",{className:"tip_image"}),v.a.createElement("span",null,_i18n("applications.presentation.components.CountDown.rest", "课间休息一会儿吧~"))),v.a.createElement("div",{className:"count_set"},v.a.createElement("div",{className:"count_time_set"},v.a.createElement(ye,{step:1,max:99,min:0,defaultValue:"00",ref:this.refHours,isInt:!0,onFocus:function(){return e.handleFocus(e.refHours)}}),v.a.createElement("div",{className:"count_colon"},":"),v.a.createElement(ye,{step:1,max:59,min:0,defaultValue:"00",ref:this.refMinutes,isInt:!0,onFocus:function(){return e.handleFocus(e.refMinutes)}}),v.a.createElement("div",{className:"count_colon"},":"),v.a.createElement(ye,{step:10,max:59,min:0,defaultValue:"00",ref:this.refSeconds,isInt:!0,onFocus:function(){return e.handleFocus(e.refSeconds)}}))),v.a.createElement("div",{className:"count_end_bell"},v.a.createElement(ge.default,{checked:t,className:"text",onChange:this.onCheckBoxChange,isAuto:!0},_i18n("applications.presentation.components.CountDown.endRing", "结束时响铃"))),v.a.createElement("div",{className:"count_confirm_btn"},v.a.createElement("button",{className:"count_confirm",onClick:this.startCountTime},_i18n("applications.presentation.components.CountDown.startCount", "开始倒计时"))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.autoPlay!==e.autoPlay?{autoPlay:e.autoPlay}:null}}]),t}(y.BaseComponent),Ee=n(156),Te=window.WppCommandBarComponentFragment,_e=Te.cmbIds.wpp,be=le.userAgent.isPad||window.domTools.isWindowsTocuhDevice,Pe=function(e){function t(e){l()(this,t);var n=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOpenImageViewer=function(){n._inImageViewer=!0},n.onExitImageViewer=function(){n._inImageViewer=!1},n.handleToggleInkModal=function(e){n.inkModalVisible=e},n.inImageViewer=function(){return n._inImageViewer},n.openAutoPlay=function(e){"auto"===e.detail.type&&(n._inAutoplayView=!0)},n.closeAutoPlay=function(){n._inAutoplayView=!1},n.handleHidePlayingMenu=function(e){n.setState({hiddenmenu:e.detail})},n.handleHideHoverLink=function(e){n.setState({hiddenlink:e.detail})},n.handleHideImageTip=function(e){n.setState({hiddentip:e.detail})},n.handleCountDown=function(){n.getKeyState(R.a.ON_TIME_COUNTING)?window.Toast.warn(_i18n("applications.presentation.components.PlayPanel.toolbar.isCountIng", "有一个倒计时在运行中")):n.showSetCountDown()},n.showSetCountDown=function(){n.setState({showSetCountDown:!0})},n.startResizeRemarksArea=function(e){n._isResizeRemarksArea=e},n.closeSetCountDown=function(){n.setState({showSetCountDown:!1})},n.onVideoFullscreen=function(e){n.videoFullscreen=e},n.stopToolbarMouseMoveEvent=function(e){n._stopToolbarMouseMoveEvent=e},n._onMouseMove=Object(Ee.throttle)((function(e){if(!(n.props.showInkEditor||n.videoFullscreen||n._isResizeRemarksArea||n._inAutoplayView||document.querySelector(".component-image-viewer"))){var t=e.clientX,i=e.clientY;if(!n.props.isRemarkSpeaker&&n.toolRef&&!n._stopToolbarMouseMoveEvent){var o=n.toolRef.getToolRect()||{},a=o.width||300,s=o.height||80,r=o.top,l=void 0===r?0:r,u=o.left,d=void 0===u?0:u;t>=d&&t<=d+a&&(i>=l&&i<=l+s)?n.toolRef.show(!0):n.isMoreShow()||n.toolRef.hidden(0)}if(n.disableHitTest(e))n.linkRef&&n.linkRef.closeTip(),n.imageHoverTip&&n.imageHoverTip.hideTip();else{var c={left:e.clientX,top:e.clientY},p=n.getHitPointInfo(c,null,null,!1),h=p.viewShape,f=p.hitTestRet;n.linkRef&&n.linkRef.handleMouseMove(c,f);var m=n.editor&&n.editor.action;m&&(m.update(f),m.hasOverActionSound&&m.over()),n.isLinkTipShow()?n.imageHoverTip&&n.imageHoverTip.hideTip():n.imageHoverTip&&n.imageHoverTip.handleMouseMove(c,f),n.mediaRef&&n.mediaRef.changeToolByHitInfo(h),n._hitViewShape=h,n._checkHitHasTrigger(f)?window.domTools.setCursor("pointer"):window.domTools.setCursor("default")}}}),60),n._onMouseUp=function(e){if(n.imageHoverTip&&n.imageHoverTip.hideTip(),2===e.button){if(n.props.isRemarkSpeaker&&!Object(k.isMouseInElement)(e,n.app.container)||n.isHitClassElement(e.target,"image-viewer-container")||n._inAutoplayView||n.state.showSetCountDown||n.inkModalVisible)return;var t=e.clientX,i=e.clientY;n.menuRef&&n.menuRef.onShow(t,i)}},n.getHitPointInfo=function(e,t,i,o){var a=Object(Z.b)(n.doc),s=n.coreView.hitTest(e.left,e.top,t,i,o,a),r=void 0,l=void 0;if(s){r=s.slide;var u=s.otherLayerHitRestRet;l=s.shape||u&&u.shape}return{viewSlide:r,viewShape:l,hitTestRet:s}},n.isVideoPlay=function(){var e=n._hitViewShape&&n._hitViewShape.shapeData;if(e&&e.isVideo())return n.mediaRef.changePlay(e),!0},n.handleTouchStart=function(e){!window.__CONFIG__.wpp.enablePlayTouchInteract||n.props.isRemarkSpeaker&&!Object(k.isMouseInElement)(e,n.app.container)||n.isHitClassElement(e.target,"image-viewer-container")||n.isHitClassElement(e.target,"showInkEditor")||document.body.querySelector(".component-image-viewer")||n._inAutoplayView||n.state.showSetCountDown||n.inkModalVisible||(n.startTouchTime=Date.now(),n.showMenuTimer=setTimeout((function(){var t=0===e.touches.length?e.changedTouches[0]:e.touches[0],i=t.clientX,o=t.clientY;n.menuRef&&n.menuRef.onShow(i,o)}),300))},n.handleTouchMove=function(){clearTimeout(n.showMenuTimer)},n.handleTouchEnd=function(e){if(window.__CONFIG__.wpp.enablePlayTouchInteract&&(Date.now()-n.startTouchTime<300&&clearTimeout(n.showMenuTimer),!n.isMenuShow())){var t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0],i=t.clientX,o=t.clientY,a=n.getHitPointInfo({left:i,top:o}).viewShape;n.mediaRef&&n.mediaRef.changeToolByHitInfo(a,!0);var s=a&&a.getData();s&&s.isMedia()&&n.props.stopWPClick()}},n.isHitClassElement=function(e,t){for(;e&&e!==document.body;){if(e.classList&&e.classList.contains(t))return!0;e=e.parentNode}return!1},n.isLinkTouchHit=function(e){var t=n.editor&&n.editor.link;return t&&t.initDataByHitInfo(e),t&&t.hasLink},n.hitTriggetShape=function(e){if(e&&e.otherLayerHitRestRet&&(e=e.otherLayerHitRestRet),e&&e.isHit){var t=e&&e.shape&&e.shape.shapeData,i=n.getShapeTreeFirstLayer(t);if(i.isTriggerShape()){var o=i&&i.getId(),a=i.getSlide(),s=a&&a.getCategory();return n.doc.playTriggerAnim(o,s),!0}}return!1},n.clickNumber=n.clickNumber.bind(n),n.state={hiddenmenu:!1,hiddenlink:!1,hiddentip:!1,showSetCountDown:!1},n._stopToolbarMouseMoveEvent=!!n.isRemarksWin,n}return f()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),window.addEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_PLAYING_MENU,this.handleHidePlayingMenu),window.addEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_PLAY_HOVER_LINK,this.handleHideHoverLink),window.addEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_IMAGE_HOVER_TIP,this.handleHideImageTip),be&&(document.addEventListener("touchstart",this.handleTouchStart,!0),document.addEventListener("touchmove",this.handleTouchMove,!0),document.addEventListener("touchend",this.handleTouchEnd,!0)),this.on(this.uiEventTypes.pc.play.CLICK_SHOW_SET_COUNTDOWN,this.showSetCountDown),this.on(this.uiEventTypes.pc.play.CLICK_CLOSE_SET_COUNTDOWN,this.closeSetCountDown),this.on(this.uiEventTypes.pc.play.START_RESIZE_REMARKS_AREA,this.startResizeRemarksArea),this.on(this.uiEventTypes.pc.play.STOP_TOOLBAR_MOUSE_MOVE_EVENT,this.stopToolbarMouseMoveEvent),this.on(this.uiEventTypes.names.ON_VIDEO_FULLSCREEN,this.onVideoFullscreen),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_COUNT_DOWN,this.handleCountDown),window.addEventListener(this.uiEventTypes.names.ON_OPEN_IMAGE_VIEWER,this.onOpenImageViewer),this.on(this.uiEventTypes.names.ON_EXIT_IMAGE_VIEWER,this.onExitImageViewer),window.addEventListener(this.uiEventTypes.pc.ON_START_PLAY,this.openAutoPlay),window.addEventListener(this.uiEventTypes.pc.START_PLAY,this.closeAutoPlay),this.on(this.uiEventTypes.names.ON_TOGGLE_INK_MODAL_VISIBLE,this.handleToggleInkModal)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.showInkEditor&&this.toolRef&&this.toolRef.hidden(0,!0)}},{key:"onUnBindEvent",value:function(){document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_PLAYING_MENU,this.handleHidePlayingMenu),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_PLAY_HOVER_LINK,this.handleHideHoverLink),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.SET_HIDE_IMAGE_HOVER_TIP,this.handleHideImageTip),this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_COUNT_DOWN,this.handleCountDown),be&&(document.removeEventListener("touchstart",this.handleTouchStart,!0),document.removeEventListener("touchmove",this.handleTouchMove,!0),document.removeEventListener("touchend",this.handleTouchEnd,!0)),window.removeEventListener(this.uiEventTypes.names.ON_OPEN_IMAGE_VIEWER,this.onOpenImageViewer),this._imageViewer=null,window.removeEventListener(this.uiEventTypes.pc.ON_START_PLAY,this.openAutoPlay),window.removeEventListener(this.uiEventTypes.pc.START_PLAY,this.closeAutoPlay)}},{key:"render",value:function(){var e=this,t=this.state,n=t.hiddenmenu,i=t.hiddenlink,a=t.hiddentip,s=t.showSetCountDown;return v.a.createElement("div",{className:"play-component",id:"play-component"},v.a.createElement(ae.a,this.props),v.a.createElement(K,o()({},this.props,{ref:function(t){return e.drawboardRef=t}})),!a&&!window.__CONFIG__.wpp.disableHoverPictureTips&&!this.isRemarksWin&&v.a.createElement(re,{ref:function(t){return e.imageHoverTip=t}}),v.a.createElement(se.a,o()({ref:function(t){return e.mediaRef=t}},this.props)),!i&&v.a.createElement(oe,o()({ref:function(t){return e.linkRef=t}},this.props)),this.props.toolbar&&v.a.createElement(Te,{cmbId:_e.PlayComponentToolbar},v.a.createElement(B,o()({},this.props,{ref:function(t){return e.toolRef=t},clickNumber:this.clickNumber}))),!n&&v.a.createElement(ie,o()({},this.props,{ref:function(t){return e.menuRef=t}})),this.props.pages&&!this.props.isRemarkSpeaker&&v.a.createElement("div",{className:"pages",onClick:this.clickNumber,ref:function(t){return e.numberRef=t}},this.props.activeSlideIndex+1+"/"+this.doc.getSlideCount()),s&&v.a.createElement(we,null))}},{key:"clickNumber",value:function(e){(e&&e.stopPropagation(),this.isRemarksWin||this.props.isRemarkSpeaker)||(this.props.showMini?this.fire(this.uiEventTypes.pc.play.CLICK_CLOSE_MINI_THUMBNAIL):this.fire(this.uiEventTypes.pc.play.CLICK_SHOW_MINI_THUMBNAIL,{visible:!0}))}},{key:"disableHitTest",value:function(e){return this.isSharePanelShow()||this.isQuitPanelShow()||this.isMouseinToolbar(e)||this.isMoreShow()||this.isLaserpenShow()||this.isTimeShow(e)||this.isMouseInMiniThumbnail(e)||this.inImageViewer()||this.isMouseInMenu(e)||this.isShowSetCountDown()||this.isRemarkDialogVisible()||this.isClearInkModalShow()}},{key:"isClearInkModalShow",value:function(){return this.props.showClearInkModal}},{key:"_checkHitHasTrigger",value:function(e){if(e&&e.otherLayerHitRestRet&&(e=e.otherLayerHitRestRet),e&&e.isHit&&e.shape&&e.slide){var t=e&&e.shape&&e.shape.shapeData,n=this.getShapeTreeFirstLayer(t);if(n&&n.isTriggerShape())return!0}return!1}},{key:"getShapeTreeFirstLayer",value:function(e){for(;e&&e.getParent()&&!e.getParent().isShapeTree;)e=e.getParent();return e}},{key:"isMenuShow",value:function(){return this.menuRef&&this.menuRef.visible}},{key:"isShowSetCountDown",value:function(){return this.state.showSetCountDown}},{key:"isMouseInMenu",value:function(e){return this.menuRef&&this.menuRef.element&&Object(k.isMouseInElement)(e,this.menuRef.element)}},{key:"isSharePanelShow",value:function(){return this.toolRef&&this.toolRef.sharePanelVisible}},{key:"isQuitPanelShow",value:function(){return this.toolRef&&this.toolRef.quitPanelVisible}},{key:"isMouseinToolbar",value:function(e){return this.toolRef&&this.toolRef.rootRef&&Object(k.isMouseInElement)(e,this.toolRef.rootRef)}},{key:"isMouseInMiniThumbnail",value:function(e){return this.props.isMouseInMiniThumbnail(e)}},{key:"isRemarkDialogVisible",value:function(){return this.props.isRemarkDialogVisible()}},{key:"isTimeShow",value:function(e){var t=document.getElementsByClassName("time_count_panel")[0];return t&&Object(k.isMouseInElement)(e,t)}},{key:"isMoreShow",value:function(){return this.toolRef&&this.toolRef.moreVisible}},{key:"isLaserpenShow",value:function(){return this.drawboardRef&&!!this.drawboardRef.pen}},{key:"isLinkTipShow",value:function(){return this.linkRef&&!!this.linkRef.$tip}},{key:"isMouseInNumberRef",value:function(e){return this.numberRef&&Object(k.isMouseInElement)(e,this.numberRef)}},{key:"iPadToggleToolBar",value:function(){this.toolRef&&this.toolRef.rootRef&&"8px"===this.toolRef.rootRef.style.top?this.toolRef.hidden(0,!0):this.toolRef.show()}},{key:"isMouseInMediaEl",value:function(e){var t=document.getElementsByClassName("media_container"),n=document.querySelector(".player-contianer");if(0!==t.length||n){var i=void 0;return t.forEach((function(t){Object(k.isMouseInElement)(e,t)&&(i=!0)})),i||n&&Object(k.isMouseInElement)(e,n)}}}]),t}(y.BaseComponent),ke=n(6882),Se=n.n(ke),Re=n(164),Ce=n(3341),Me=n.n(Ce),Ie=n(1106),Ne=n.n(Ie),Le=n(6883),Oe=n.n(Le),De=n(3867),Ae=n.n(De),Ve=window.pcTrack,Be=window.Toast,Fe=b.userAgent.isPad||window.domTools.isWindowsTocuhDevice,xe=function(e){function t(e){var n=this;l()(this,t);var i,o,a=p()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleExitFullscreen=function(){if(a.isFullscreen){try{a.exitFullscreen()}catch(e){}Fe&&a.handleDestroyHammer()}},a.handleWpHammer=function(e){var t=e.type,n=function(t){"swipeup"===t||"swipeleft"===t?a.handleEffectChange(e,!a.rightToLeft):"swipedown"!==t&&"swiperight"!==t||a.handleEffectChange(e,a.rightToLeft)};if(a.props.isFromH5)return n(t),void e.preventDefault();if(a.playPanelRef&&window.__CONFIG__.wpp.enablePlayTouchInteract){e.pageX=e.pointers[0].pageX,e.pageY=e.pointers[0].pageY;var i=document.getElementById("ink-editor");if(!(a.playPanelRef.isMouseinToolbar(e)||i||a.playPanelRef.isMouseInNumberRef(e))){if(n(t),"tap"===t){var o=a._getHitPointInfo(e),s=a.playPanelRef.hitTriggetShape(o);if(a.playPanelRef.isMouseInMediaEl(e))return;if(a.editor&&a.editor.action&&(a.editor.action.update(o),a.editor.action.hasClickActionSound&&a.editor.action.click()),a.playPanelRef.isLinkTouchHit(o))return;if(s)return void e.preventDefault();a.playPanelRef.iPadToggleToolBar()}e.preventDefault()}}},a.handleEffectChange=(i=s()(regeneratorRuntime.mark((function e(t){var i,o,s,r,l=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window._ban_slide_change){e.next=2;break}return e.abrupt("return");case 2:if(i=a.props.isFromH5,!l){e.next=9;break}return e.next=6,a.doc.stepForward();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,a.doc.stepBackward();case 11:e.t0=e.sent;case 12:return(o=e.t0)||i&&l&&(s=a.doc.getSlideAt(0).getHiddenStatus(),r=0,s&&(r=a.findNextSlideIdx(0)),a.doc.stepTo(r),a.doc.setActiveSlide(r),a.setState({activeSlideIndex:r})),e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,n)}))),function(e){return i.apply(this,arguments)}),a.handleAPIShowPage=function(e){a.setState({pages:e.detail})},a.handleShowPage=function(e){a.setState({pages:e},(function(){e?window.Toast.warn(_i18n("applications.presentation.components.UilView.play.toastShowpage", "已显示页码")):window.Toast.warn(_i18n("applications.presentation.components.UilView.play.toastHidepage", "已隐藏页码"))}))},a.onPlayerEvent=function(e){var t=e.type,n=e.slideIndex,i=e.action,o=e.isLastEffect,s=e.canGoforward,r=e.canGobackward,l=e.advanceTime,u=e.isTriggerEffect;if(void 0!==o&&(a.isLastEffect=o),"play"===t){if(!window._ban_slide_change){if("forward"===i)if(s)clearTimeout(a.advanceTimer),a.advanceTimer=null;else{var d=a.selection.getSlideCount(),c=a.slideCount;c<d&&n===c-1&&a.dispatchEvent(a.eventTypes.OPENAPI_EVENT.ON_PREVIEW_LIMIT,{slideIndex:n,limitCount:c,slideCount:d}),!a.$lpCover&&a.isFromH5&&a.doc.stepTo(0),clearTimeout(a.effectTimes),!a.isFromH5&&Be.warn(_i18n("applications.presentation.components.UilView.play.toastEnd", "已是最后一页")),!Fe&&a.fire(a.uiEventTypes.pc.play.CLICK_SHOW_TOOLBAR,!1,!0),a.doc.fire(a.eventTypes.OPENAPI_EVENT.ON_LAST_PAGE)}"backward"!==i||r||(clearTimeout(a.effectTimes),Be.warn(_i18n("applications.presentation.components.UilView.play.toastStart", "已是第一页")),!Fe&&a.fire(a.uiEventTypes.pc.play.CLICK_SHOW_TOOLBAR,!1,!0),a.doc.fire(a.eventTypes.OPENAPI_EVENT.ON_LAST_PAGE)),"backward"!==i&&"switchTo"!==i||(clearTimeout(a.advanceTimer),a.advanceTimer=null)}if("effectFinish"===i&&!window._ban_slide_change){var p=window.APP.presentation.getAdvanceMode();if(!u&&a.canAdvancePlay()&&(!p||p===b.ShowAdvanceMode.onTime)&&Number(l)>=0&&a.isLastEffect)if(clearTimeout(a.advanceTimer),a.advanceTimer=null,n<a.slideCount-1){var h=a.findNextSlideIdx(n);h!==n&&(a.advanceTimer=setTimeout((function(){a.doc.stepTo(h)}),l),a.advanceTime=l)}else Be.warn(_i18n("applications.presentation.components.UilView.play.toastEnd", "已是最后一页")),!Fe&&a.fire(a.uiEventTypes.pc.play.CLICK_SHOW_TOOLBAR,!1,!0),a.doc.fire(a.eventTypes.OPENAPI_EVENT.ON_LAST_PAGE)}a.slideCount===n+1&&o&&a.doc.fire(a.eventTypes.OPENAPI_EVENT.LAST_SLIDE_END),window.collection(Ve.view_way,0),a.doc.setActiveSlide(n)}else"error"===t&&a.handleExitFullscreen()},a.onStopAdvancePlay=function(){a._canAdvancePlay=!1,clearTimeout(a.advanceTimer),a.advanceTimer=null},a.onResumeAdvancePlay=function(){if(a._canAdvancePlay=!0,!a.advanceTimer){var e=a.doc.getActiveSlideIdx();if(e<a.slideCount-1){var t=a.findNextSlideIdx(e);a.advanceTimer=setTimeout((function(){a.doc.stepTo(t)}),a.advanceTime||0)}}},a.handleWpClick=function(e){var t=a.state.showMini;if(a.isRemarksWin){var n=document.querySelector("#play-component-toolbar");if(n&&n.contains(e.target)||!e.currentTarget.contains(e.target))return;a.shell.remarkSpeakerDoc.stepForward(!1,!1,!0)}else{if(a.props.showInkEditor||window._ban_slide_change)return;if(Date.now()-a.time1<200)return;if(a.doc.isRemarkView){var i=a.doc.getSvgClientRect();if(!(e.clientX>i.left&&e.clientX<i.right&&e.clientY>i.top&&e.clientY<i.bottom))return}var o=document.querySelector("#play-component-toolbar");if(o&&o.contains(e.target)||!e.currentTarget.contains(e.target))return;if(t)return a.setState({showMini:!1}),void a.sendMiniThumbnailVisibleInfo(!1);var s=!0;if(a.playPanelRef&&a.playPanelRef.hitTriggetShape(a._getHitPointInfo(e))&&(s=!1),a.playPanelRef&&a.playPanelRef.isVideoPlay())return;if(a.editor&&a.editor.action&&a.editor.action.hasClickActionSound&&(a.editor.action.click(),s=!1),a.editor&&a.editor.link&&a.editor.link.hasLink)return void a.fire(a.uiEventTypes.pc.link.ON_OPEN_LINK);s&&a.handleSlideChange(!0,!1,!0).then((function(e){window.collection(Ve.play_next,0)}))}a.editor&&a.editor.action&&a.editor.action.hasClickActionSound&&a.editor.action.click()},a.handleKeyDown=function(e){if(!(a.videoFullscreen||window._ban_slide_change||a.inkModalVisible)){var t=e||window.event,n=t.keyCode||t.which.keyCode||t.charCode;if([13,32,34,39,40,78,98].includes(n)){if(a.isRemarksWin)return a.shell.remarkSpeakerDoc.stepForward();window.collection(Ve.play_next,1),a.handleSlideChange()}else if([8,33,37,38,80,104].includes(n)){if(a.isRemarksWin)return a.shell.remarkSpeakerDoc.stepBackward();a.stepBackward(),window.collection(Ve.play_pre,1)}else if(36===n||70===n){if(a.isRemarksWin)return a.shell.remarkSpeakerDoc.stepTo(0);a.doc.stepTo(0)}else if(35===n||76===n){var i=a.doc.getSlideCount();if(a.isRemarksWin)return a.shell.remarkSpeakerDoc.stepTo(i-1);a.doc.stepTo(i-1)}else if(27!==n||a.isFromH5)83!==n||a.isRemarksWin?74!==n||a.isRemarksWin?72!==n||a.isRemarksWin||a.fire(a.uiEventTypes.names.REQ_OPEN_INK_EDITOR,{open:!0}):a.fire(a.uiEventTypes.names.REQ_OPEN_INK_EDITOR,{open:!0,btnName:"laserPen"}):a.props.isRemarkSpeaker||(a.setState({showMini:!0}),a.sendMiniThumbnailVisibleInfo(!0));else{if(a.isRemarksWin)return a.doc.setRemarkWinMsg(!1),window.close();a.fire(a.uiEventTypes.pc.play.CLICK_END_PLAY)}}},a.handleRemovePageToast=function(){!a.$lpCover||(a.$lpCover.removeEventListener("click",a.handleExitFullscreen),a.$lpCover.parentNode&&a.$lpCover.parentNode.removeChild(a.$lpCover),a.$lpCover=null)},a.slideChange=function(e){var t=e.isForward,n=e.isForced;if(a.isRemarksWin)return t?a.shell.remarkSpeakerDoc.stepForward(!1,!1,!1):a.shell.remarkSpeakerDoc.stepBackward();a.handleSlideChange(t,n)},a.handleSlideChange=(o=s()(regeneratorRuntime.mark((function e(){var t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementsByClassName("qrcode-panel")[0]&&!window._ban_slide_change){e.next=2;break}return e.abrupt("return");case 2:if(!o){e.next=5;break}return a.doc.stepTo(a.findNextSlideIdx(a.doc.getActiveSlideIdx(),i)),e.abrupt("return");case 5:if(!i){e.next=11;break}return e.next=8,a.doc.stepForward(!1,!1,s);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,a.doc.stepBackward();case 13:e.t0=e.sent;case 14:return t=e.t0,e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,n)}))),function(){return o.apply(this,arguments)}),a.closeMiniThumbnail=function(){a.setState({showMini:!1}),a.sendMiniThumbnailVisibleInfo(!1)},a.showMiniThumbnail=function(e){var t=e.visible;a.setState({showMini:!!t}),a.sendMiniThumbnailVisibleInfo(!!t)},a.sendMiniThumbnailVisibleInfo=function(e){a.doc.fire(a.eventTypes.OPENAPI_EVENT.MINI_THUMBNAIL_VISIBLE_INFO,{visible:e})},a.getArrowStyle=function(){return a.doc.getActiveSlideIdx()<a.slideCount-1?{}:{left:"40px",right:"initial",transform:"rotateY(0deg)"}},a.stopWPClick=function(){a.time1=Date.now()},a.stepTo=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a.doc.stepTo(e,n,i),t&&a.closeMiniThumbnail()},a.onThumbnailUpdate=function(e){var t=a.selection.getActiveSlide(),n=t?t.getId():-1,i=a.doc.getActiveSlide();if(!i||n!==i.getId()){var o=a.slideCount,s=a.selection.getActiveSlideIdx();s=o>0?Math.max(0,s):-1,s=Math.min(o-1,s),a.stepTo(s,!1,-1,!0)}},a.handleToggleInkModal=function(e){a.inkModalVisible=e},a.isMouseInMiniThumbnail=function(e){return a.miniThumbnailRef&&a.miniThumbnailRef.element&&Object(k.isMouseInElement)(e,a.miniThumbnailRef.element)},a.isRemarkDialogVisible=function(){return a.remarksViewRef&&a.remarksViewRef.remarksDialogRef&&a.remarksViewRef.remarksDialogRef.visible},a.handleClearInkModal=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a.setState({showClearInkModal:e})},a.onResize=function(){b.userAgent.isPad&&(clearTimeout(a.timer),a.timer=setTimeout((function(){var e=window.domTools.getElementInnerSize(a.$container);a.doc.resize(e)}),80))},a.state={showMini:!1,pages:null,showClearInkModal:!1},a._canAdvancePlay=!0,a}return f()(t,e),d()(t,[{key:"onSafeBindEvent",value:function(){this.on(this.uiEventTypes.pc.play.CLICK_SHOW_MINI_THUMBNAIL,this.showMiniThumbnail),this.on(this.uiEventTypes.pc.play.CLICK_CONTAINER_DIV,this.handleWpClick),this.coreView.setZoom(0),this.$container=this.app.container,this.$container.style.display="block",this.$container.style.backgroundColor="#000",this.svgViewRef&&this.doc.setSvgRootView(this.$container),this.uilHotkeys.setFocusTarget(b.FocusTargetsDef.PLAY_View),this.doc.on(b.VIEW_EVENT_TYPES.PLAYER_EVENT,this.onPlayerEvent),this.on(this.uiEventTypes.pc.play.CLICK_SHOW_PAGE,this.handleShowPage),this.on(this.uiEventTypes.pc.play.CLICK_STOP_AUTO_PLAY,this.onStopAutoPlay),this.on(this.uiEventTypes.pc.play.CLICK_CLOSE_MINI_THUMBNAIL,this.closeMiniThumbnail),this.on(this.uiEventTypes.pc.play.CLICK_SHOW_MORE,this.onShowMore),this.on(this.eventTypes.names.ON_SLIDE_CHANGE,this.slideChange),this.on(this.uiEventTypes.names.ON_TOGGLE_INK_MODAL_VISIBLE,this.handleToggleInkModal),this.uilHotkeys.on(b.FocusTargetsDef.PLAY_View,"keydown",{keyCode:[13,32,39,40,78,98,8,37,38,80,104,27,35,36,33,34,83,72,74,70,76]},this.handleKeyDown),Fe&&this.onBindIpadTouchEvent(),this.on("resize",this.onResize),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_STOP_ADVANCE_PLAY,this.onStopAdvancePlay),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_RESUME_ADVANCE_PLAY,this.onResumeAdvancePlay),this.doc.on(this.eventTypes.OPENAPI_EVENT.SET_MINI_THUMBNAIL_VISIBLE,this.showMiniThumbnail),this.doc.on(this.viewEventTypes.THUMBNAIL_UPDATE,this.onThumbnailUpdate),window.addEventListener(this.eventTypes.OPENAPI_EVENT.SET_SHOW_PAGE,this.handleAPIShowPage),this.fire(this.uiEventTypes.names.UIL_VIEW_DID_MOUNT),this.on(this.uiEventTypes.names.ON_SHOW_DEL_INK_MODAL,this.handleClearInkModal),Oe()(),this.showSlidingTips()}},{key:"onUnBindEvent",value:function(){this.app.container.style.backgroundColor="",this.doc.off(b.VIEW_EVENT_TYPES.PLAYER_EVENT,this.onPlayerEvent),this.uilHotkeys.off(b.FocusTargetsDef.PLAY_View,"keydown",{keyCode:[13,32,39,40,78,98,8,37,38,80,104,27,35,36,33,34,83,72,74,70,76]},this.handleKeyDown),this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_STOP_ADVANCE_PLAY,this.onStopAdvancePlay),this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_RESUME_ADVANCE_PLAY,this.onResumeAdvancePlay),this.doc.off(this.eventTypes.OPENAPI_EVENT.SET_MINI_THUMBNAIL_VISIBLE,this.showMiniThumbnail),this.doc.off(this.viewEventTypes.THUMBNAIL_UPDATE,this.onThumbnailUpdate),window.removeEventListener(this.eventTypes.OPENAPI_EVENT.SET_SHOW_PAGE,this.handleAPIShowPage)}},{key:"onBindIpadTouchEvent",value:function(){var e=this;this.$wp=document.getElementById("workspace"),Ne()((function(t){var n=t.default||t,i=new n(e.$wp,{domEvents:!0});e.wpEventHammer=i,i.get("swipe").set({direction:n.DIRECTION_ALL}),i.get("tap").set({taps:1}),i.on("tap swipedown swipeup swipeleft swiperight",e.handleWpHammer)}))}},{key:"handleDestroyHammer",value:function(){this.wpEventHammer.off("tap swipedown swipeup swipeleft swiperight",this.handleWpHammer),this.wpEventHammer.destroy(),this.wpEventHammer=null}},{key:"_getHitPointInfo",value:function(e){var t={left:e.left||e.clientX||e.pageX,top:e.top||e.clientY||e.pageY};return this.playPanelRef.getHitPointInfo(t,null,null,!1).hitTestRet}},{key:"canAdvancePlay",value:function(){return this._canAdvancePlay}},{key:"handleShowLastPageToast",value:function(){var e=this;this.handleRemovePageToast();var t=document.createElement("div");t.innerText=this.isFromH5?_i18n("applications.presentation.components.UilView.play.h5EndTip", "播放结束，单击鼠标回到PPT首页"):_i18n("applications.presentation.components.UilView.play.endTip", "播放结束，单击鼠标或按ESC退出。"),t.style.width="100%",t.style.height="100%",t.style.fontSize="16px",t.style.paddingTop="2vh",t.style.zIndex=this.isFromH5?"102":"10",t.style.backgroundColor="#000",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.color="#fff",t.style.textAlign="center",this.$lpCover=t,this.isFromH5?(this.$lpCover.addEventListener("click",(function(){e.doc.stepTo(0),e.handleRemovePageToast()})),this.$container.appendChild(this.$lpCover)):(this.$lpCover.addEventListener("click",this.handleExitFullscreen),this.$ctn.appendChild(this.$lpCover))}},{key:"stepBackward",value:function(){this.$lpCover?this.handleRemovePageToast(!0):this.handleSlideChange(!1)}},{key:"findNextSlideIdx",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.slideCount,i=e;i>=-1&&i<n;){t?i++:i--;var o=this.doc.getSlideAt(i);if(!o||!o.getHiddenStatus()){if(i>=0&&i<n)break;i=e;break}}return i}},{key:"showSlidingTips",value:function(){Fe&&window.__CONFIG__.wpp.enablePlayTouchInteract&&!window._ban_slide_change&&(b.userAgent.isIPad?window.Toast.warn(_i18n("applications.presentation.components.UilView.play.slidingTips", "上下/左右滑动可翻页"),null,3,52):window.Toast.warn(_i18n("applications.presentation.components.UilView.play.slidingTips", "上下/左右滑动可翻页")))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isRemarkSpeaker,i=t.activeSlideIndex,a=this.state,s=a.showMini,r=a.pages,l=a.showClearInkModal,u=this.isFromH5,d=n||this.isRemarksWin;return v.a.createElement(v.a.Fragment,null,d&&Object(Re.default)(Se.a,o()({},this.props,{setActiveSlide:this.stepTo,handleSlideChange:this.handleSlideChange,stopWPClick:this.stopWPClick,ref:function(t){return e.remarksViewRef=t}})),this.shell&&!u&&v.a.createElement(Pe,o()({},o()({},this.props,{app:this.app,pages:r,showMini:s,slideCount:this.slideCount,toolbar:!0,stopWPClick:this.stopWPClick,isMouseInMiniThumbnail:this.isMouseInMiniThumbnail,isRemarkDialogVisible:this.isRemarkDialogVisible,showClearInkModal:l}),{ref:function(t){return e.playPanelRef=t}})),u&&v.a.createElement(Ae.a,null),s&&Object(Re.default)(Me.a,{activeSlideIndex:i,setActiveSlide:this.stepTo,handleSlideChange:this.handleSlideChange,onClose:this.closeMiniThumbnail,ref:function(t){return e.miniThumbnailRef=t}}),l&&Object(Re.default)(Oe.a,{onClose:this.handleClearInkModal}))}}]),t}(y.BaseComponent);t.default=xe}}]);