!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=4)}([function(e,n,t){"use strict";Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),t=n.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<t;){var i=n[o];if(e.call(r,i,o,n))return o;o+=1}return-1}})},,,,function(e,n,t){"use strict";t.r(n);function r(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),o=0;for(n=0;n<t;n++)for(var i=arguments[n],a=0,_=i.length;a<_;a++,o++)r[o]=i[a];return r}t(0);var o=window;o.__INJECT__=o.__INJECT__||{};var i,a,_={token:""};function s(){var e=o.splash||o;["WPS_GetToken","WPS_OnError","WPS_OnEvent"].map((function(n){return function(n){var t=e[n];if(t){var i=n.replace("WPS_","");o.__INJECT__[i]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=e.map((function(e){return"object"==typeof e?JSON.stringify(e):e}));return Promise.resolve(t.call.apply(t,r([o],i))).then((function(e){return"string"==typeof e&&/^(\[|\{).*?(\}|\])$/.test(e)?JSON.parse(e):e}))}}}(n)}))}function c(){o.__INJECT__.GetTokenType=1,o.__INJECT__.GetToken=function(){return!a||!a.resolved||a&&!o.__WPSENV__.jsSDKConfig.refreshToken?(a||(a=function(e){if(e)return{promise:Promise.resolve(e),resolved:!0,resolve:function(){}};var n={resolved:!1};return n.promise=new Promise((function(e){n.resolve=function(t){n.resolved=!0,e(t)}})),n}(_.token?_:null)),a.promise):new Promise((function(e){var n=function(t){if("string"==typeof t.data&&o.parent===t.source){var r=JSON.parse(t.data);"api.getToken.reply"===r.eventName&&(_=r.data,e(r.data),o.removeEventListener("message",n))}};o.addEventListener("message",n),o.parent.postMessage(JSON.stringify({eventName:"api.getToken"}),"*")}))}}function u(e){if("string"==typeof e.data&&o.parent===e.source){var n=JSON.parse(e.data);if("setConfig"===n.eventName){o.__WPSENV__.jsSDKConfig=n.data;var t=n.data.headers;o.__WPSENV__.jsSDKHeaders=t,t&&t.shareBtn&&i&&o.__PLUGINCONFIG__.plugin.push(i),"https://wwo.wps.cn"!==location.origin||e.origin===location.origin||o.__WPSENV__.whiteListCollection||(o.__WPSENV__.whiteListCollection=e.origin.replace(/^https*:\/\//,""))}else"setToken"===n.eventName?(_=n.data,o.WPSOpenApi&&o.WPSOpenApi.updateToken(_),a&&a.resolve(_)):"api.ready"===n.eventName?o.__WPSENV__.__API_READY__=!0:"commonApi.ready"===n.eventName?o.__WPSENV__.__COMMONAPI_READY__=!0:"basic.event"===n.eventName&&(o.__WPSENV__.jsSDKbasicEvents?o.__WPSENV__.jsSDKbasicEvents.push(n.data):o.__WPSENV__.jsSDKbasicEvents=[n.data])}}!function(){s();var e=window.parent!==window;if(!o.__INJECT__.GetToken&&!o.__WPSENV__.file_info){var n=/(\?|\&)version.*?(\&|$)/.test(location.search)&&/(\?|\&)(simple|hidecmb).*?(\&|$)/.test(location.search);if(e&&n)o.__INJECT__.GetToken=o.parent.__INJECT__.GetToken;else if(e&&!n&&/_w_tokentype/.test(location.search))c();else{var t=location.search.match(/_w_appid=([a-z-A-Z0-9]+)/),r=t&&t[1]||"wwo",a=document.cookie.match(new RegExp(r+"_token=([^;]+)")),_=a&&a[1];_&&(o.__INJECT__.GetToken=function(){return Promise.resolve({token:_})})}}if(o.__PLUGINCONFIG__&&o.__PLUGINCONFIG__.plugin){var f=o.__PLUGINCONFIG__.plugin.findIndex((function(e){return"ShareFile"===e.pluginType&&"wwo-share-file"===e.id}));f>=0&&(i=o.__PLUGINCONFIG__.plugin.splice(f,1)[0])}if(e){var l=location.search.match(/[?&]sdkId=([^&]+)/);l&&!o.__WPSENV__.sdkInstanceId&&(o.__WPSENV__.sdkInstanceId=parseInt(l[1],10)),window.addEventListener("message",u),o.parent.postMessage(JSON.stringify({eventName:"ready",sdkInstanceId:o.__WPSENV__.sdkInstanceId}),"*")}}()}]);