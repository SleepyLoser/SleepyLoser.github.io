(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(54);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */function a(t){return new Promise((function(e){if(t){var i=new FileReader;i.readAsDataURL(t),i.onload=function(t){var i;e(null===(i=t.target)||void 0===i?void 0:i.result)}}else e("")}))}},118:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i(17),s=i.n(a),n=i(3),o=i(116);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function r(t){var e=Object(n.r)("");return Object(n.u)([t],(function(t,i){var a=s()(t,1)[0];s()(i,1)[0]!==a&&("string"!=typeof a?Object(o.a)(a).then((function(t){e.value=t})):e.value=a)}),{immediate:!0}),{previewUrl:e}}},1999:function(t,e,i){"use strict";i.d(e,"e",(function(){return s})),i.d(e,"l",(function(){return n})),i.d(e,"j",(function(){return o})),i.d(e,"m",(function(){return r})),i.d(e,"n",(function(){return l})),i.d(e,"c",(function(){return c})),i.d(e,"a",(function(){return d})),i.d(e,"k",(function(){return u})),i.d(e,"d",(function(){return p})),i.d(e,"g",(function(){return h})),i.d(e,"f",(function(){return m})),i.d(e,"h",(function(){return v})),i.d(e,"o",(function(){return g})),i.d(e,"i",(function(){return f})),i.d(e,"b",(function(){return _}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=t=>a.a.post("/km_bff/entry/v1/feedback_status",t),n=t=>a.a.post("/km_bff/entry/v1/related_groups",t),o=t=>a.a.post("/km_bff/entry/v1/related_articles",t),r=t=>a.a.post("/km_bff/entry/v1/related_knowledge",t),l=t=>a.a.post("/km_bff/entry/v1/related_questions",t),c=t=>a.a.post("/km_bff/entry/v1/admins",t),d=t=>a.a.post("/km_bff/entry/v1/actived_users",t),u=t=>a.a.post("/km_bff/entry/v1/related_entries",t),p=t=>a.a.post("/km_bff/entry/v1/entry_banners",t),h=t=>a.a.post("/km_bff/entry/v1/related_videos",t),m=t=>a.a.post("/km_bff/entry/v1/entry_hub",t),v=t=>a.a.post("/km_bff/entry/v1/operation_records",t),g=t=>a.a.post("/km_bff/entry/v1/operate_entity",t),f=t=>a.a.post("/km_bff/entry/v1/operation_status",t),_=t=>a.a.post("/km_bff/entry/v1/block_object_list",t)},2e3:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"empty-content",components:{},props:{height:{require:!1,default:140},initialized:{require:!0,default:!1},text:{require:!1,default:"暂无内容"}},setup:()=>({})}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"entry-empty-page",style:{height:t.height+"px"}},[t._t("default",(function(){return[t.initialized?i("div",[t._v(t._s(t.text))]):i("div",[t._v("正在加载中...")])]}))],2)}),[],!1,null,"518cbb54",null);e.a=o.exports},2001:function(t,e,i){"use strict";i.d(e,"d",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"h",(function(){return o})),i.d(e,"g",(function(){return r})),i.d(e,"v",(function(){return l})),i.d(e,"r",(function(){return c})),i.d(e,"l",(function(){return d})),i.d(e,"b",(function(){return u})),i.d(e,"s",(function(){return p})),i.d(e,"i",(function(){return h})),i.d(e,"t",(function(){return m})),i.d(e,"f",(function(){return v})),i.d(e,"k",(function(){return g})),i.d(e,"a",(function(){return f})),i.d(e,"j",(function(){return _})),i.d(e,"q",(function(){return b})),i.d(e,"e",(function(){return y})),i.d(e,"o",(function(){return w})),i.d(e,"p",(function(){return C})),i.d(e,"m",(function(){return k})),i.d(e,"u",(function(){return O})),i.d(e,"n",(function(){return x}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=function(t,e){const i=e||{type:"users",q:t,limit:10};return a.a.get("/users/ajax_get_user_selector_data",{params:i})},n=function(t,{searchType:e}){const i=new FormData;return i.append("type",e),t.forEach(t=>{i.append("q[]",t)}),i.append("frequent",""),i.append("limit",20),a.a.post("/users/ajax_get_user_selector_multi_data",i)},o=({nick:t})=>a.a.post("/km_bff/user/v1/get_user_award_list",{nick:t}),r=({nick:t,medalId:e})=>a.a.post("/km_bff/user/v1/get_user_award_detail",{nick:t,award_id:e}),l=({medalId:t,isWear:e})=>a.a.post("/km_bff/user/v1/wear_award",{award_id:t,status:e}),c=({nick:t})=>a.a.post("/km_bff/user/v1/get_current_award_status",{nick:t}),d=({nick:t})=>a.a.get("/gkm/api/follow-status/"+t),u=({nick:t})=>a.a.get("/gkm/api/follow-user/"+t),p=({nick:t})=>a.a.get("/gkm/api/unfollow-user/"+t),h=({nick:t})=>a.a.get("/gkm/api/user-center/header?nick="+t),m=({url:t})=>a.a.post("/gkm/api/user-center/banner",{url:t}),v=({nick:t})=>a.a.get("/gkm/api/user-center/creator-statistics?nick="+t),g=({nick:t,page:e,limit:i=20,year:s,lastFeedId:n,isPublishedOnly:o=!1})=>{const r={nick:t,page:e,limit:i,method:"user_timeline",publish_only:o};return s&&"最近"!==s&&(r.year=s),n&&(r.last_id=n),a.a.post("km_bff/feed/v1/get_feeds",r)},f=({feedId:t})=>a.a.post("km_bff/feed/v1/delete_feed",{feeds_id:t}),_=({nick:t})=>a.a.post("km_bff/feed/v1/get_user_time_line",{nick:t}),b=({nick:t})=>a.a.get("gkm/api/user-center/visitor?nick="+t),y=({nick:t})=>a.a.get("gkm/api/user-center/active-project?nick="+t),w=({nick:t})=>a.a.get("gkm/api/user-center/project-in-charge?nick="+t),C=({nick:t})=>a.a.post("/km_bff/user/v1/get_rewards",{nick:t}),k=({nick:t})=>a.a.get("/gkm/api/user-center/intro?nick="+t),O=({intro:t})=>a.a.post("/gkm/api/user-center/intro",{intro:t}),x=({nick:t})=>a.a.post("/km_bff/user/v1/get_user_public_basic_info",{nick:t})},2002:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(518);const s=(t,e,i)=>{const s=Object(a.b)(e,i),n=Object.keys(s),o={};return n.forEach(e=>{const i=s[e];o[e]=i.bind(t)}),o},n=(t,e,i)=>{const s=Object(a.c)(e,i),n=Object.keys(s),o={};return n.forEach(e=>{const i=s[e];o[e]=i.bind(t)}),o}},2003:function(t,e,i){"use strict";i.d(e,"L",(function(){return P})),i.d(e,"P",(function(){return F})),i.d(e,"K",(function(){return R})),i.d(e,"R",(function(){return N})),i.d(e,"S",(function(){return B})),i.d(e,"v",(function(){return U})),i.d(e,"t",(function(){return H})),i.d(e,"w",(function(){return V})),i.d(e,"A",(function(){return z})),i.d(e,"G",(function(){return G})),i.d(e,"o",(function(){return K})),i.d(e,"E",(function(){return W})),i.d(e,"Y",(function(){return Q})),i.d(e,"p",(function(){return J})),i.d(e,"y",(function(){return Y})),i.d(e,"h",(function(){return X})),i.d(e,"l",(function(){return Z})),i.d(e,"g",(function(){return tt})),i.d(e,"j",(function(){return et})),i.d(e,"C",(function(){return it})),i.d(e,"r",(function(){return at})),i.d(e,"u",(function(){return st})),i.d(e,"x",(function(){return nt})),i.d(e,"q",(function(){return ot})),i.d(e,"ab",(function(){return rt})),i.d(e,"M",(function(){return lt})),i.d(e,"B",(function(){return ct})),i.d(e,"H",(function(){return dt})),i.d(e,"c",(function(){return ut})),i.d(e,"m",(function(){return pt})),i.d(e,"n",(function(){return ht})),i.d(e,"f",(function(){return mt})),i.d(e,"d",(function(){return vt})),i.d(e,"e",(function(){return gt})),i.d(e,"J",(function(){return ft})),i.d(e,"i",(function(){return _t})),i.d(e,"k",(function(){return bt})),i.d(e,"Z",(function(){return yt})),i.d(e,"U",(function(){return wt})),i.d(e,"T",(function(){return Ct})),i.d(e,"N",(function(){return kt})),i.d(e,"Q",(function(){return Ot})),i.d(e,"b",(function(){return xt})),i.d(e,"X",(function(){return jt})),i.d(e,"V",(function(){return It})),i.d(e,"s",(function(){return Tt})),i.d(e,"D",(function(){return St})),i.d(e,"a",(function(){return Dt})),i.d(e,"I",(function(){return qt})),i.d(e,"W",(function(){return Et})),i.d(e,"F",(function(){return At})),i.d(e,"O",(function(){return Mt})),i.d(e,"z",(function(){return $t}));i(11),i(12),i(13),i(14),i(15);var a=i(7),s=i(81),n=i.n(s);const o="/km_bff/article/v1/show_preview",r="/km_bff/article/v1/show_article_for_reader",l="/km_bff/article/v1/list_articles_by_author",c="/km_bff/article/v1/get_article_group_reship",d="/km_bff/article/v1/get_article_tags",u="/km_bff/article/v1/get_article_category",p="/gkm/api/post/hot-rank",h="/km_bff/article/v1/get_article_operation_status",m="/km_bff/article/v1/get_article_read_count",v="/km_bff/article/v1/list_articles_visited",g="/km_bff/article/v1/list_article_attachments",f="/km_bff/feedback/v1/list_rewards_by_target",_="/km_bff/article/v1/get_article_knowledge_award_status",b="/km_bff/article/v1/is_article_km_headline",y="/km_bff/article/v1/list_guess_you_like_articles",w="/km_bff/article/v1/list_articles_bookmarked",C="/km_bff/article/v1/list_articles_related",k="/km_bff/article/v1/get_ai_abstract",O="/km_bff/article/v1/get_km_article_summary",x="/km_bff/article/v1/is_article_ai_abstract_enabled",j="/km_bff/feedback/v1/create_vote",I="/km_bff/feedback/v1/delete_vote",T="/km_bff/feedback/v1/create_bookmark",S="/km_bff/feedback/v1/delete_bookmark",D="/km_bff/feedback/v1/get_feedback_info",q="/km_bff/article/v1/trans_article_id",E="/articles/applyKnowledgeAwards",A="/articles/transfer",M="/km_bff/article/v1/summarize_km_article",$="/km_bff/article/v1/change_article_ai_abstract_status",L="/km_bff/codeblock/v1/read_code",P=t=>a.b.post("api/banner/create",{title:t.title,project:"5f83f61371d674cff60811fc",content:t.content,tags:t.tags,category:t.category,num:4},{cancelDuplicated:!0}),F=(t,e)=>a.b.post("api/stat/create",{id:t,select:e}),R=t=>{const e=new FormData;e.append("title",t.title),e.append("content",t.content);return a.a.post("tags/smart_tags_ajax",e,{headers:{"Content-Type":"multipart/form-data"}})},N=(t,e)=>{const i=new FormData;t.forEach(t=>i.append(t.name,t.value));return a.a.post("/articles/save_draft",i,{headers:{"Content-Type":"multipart/form-data"},...e})},B=t=>{const e={...t};return a.a.get("/common/post/search",{params:e})},U=t=>a.a.post(f,{target_type:"Post",target_id:t}),H=t=>a.a.post(o,{uuid:t}),V=t=>a.a.post(r,t),z=t=>a.a.post(l,t),G=t=>a.a.post(C,t),K=t=>a.a.post(g,{article_id:t}),W=t=>a.a.post("/km_bff/article/v1/get_preview_target_users",{uuid:t}),Q=t=>a.a.post("/km_bff/article/v1/set_preview_target_users",{uuid:t.uuid,target_users:t.targetUsers}),J=t=>a.a.post(u,{article_id:t}),Y=t=>a.a.post(d,{article_id:t}),X=t=>a.a.post(j,t),Z=t=>a.a.post(I,t),tt=t=>a.a.post(T,t),et=t=>a.a.post(S,t),it=t=>a.a.post(D,t),at=t=>a.a.get(`${p}/${t}`),st=t=>a.a.post(m,{article_id:t}),nt=(t,e)=>a.a.post(h,{article_id:t,group_id:e}),ot=t=>a.a.post(b,{article_id:t}),rt=t=>a.a.post(q,t),lt=t=>a.a.post(y,t),ct=t=>a.a.post(w,t),dt=t=>a.a.post(c,{group_article_id:t}),ut=({postId:t,newGroupId:e})=>a.a.get(`${A}?post_id=${t}&new_group_id=${e}`),pt=({postId:t,engine:e})=>a.a.post(k,{article_id:t,engine:e}),ht=({postId:t})=>a.a.post(O,{article_id:t}),mt=({postId:t})=>a.a.post(M,{article_id:t}),vt=({postId:t})=>a.a.post(x,{article_id:t}),gt=({postId:t,isEnabled:e})=>a.a.post($,{article_id:t,is_enabled:e}),ft=t=>a.a.get("/common/post_selector",{params:{...t},headers:{Accept:"application/json","x-km-api-version":"std"}}),_t=({postId:t,userToken:e})=>{const i={csrf_token:e},s="/articles/delete/"+t;return a.a.post(s,n.a.stringify(i),{headers:{"x-km-api-version":"std","X-Csrf-Token":e}})},bt=({groupId:t,groupPostId:e,userToken:i})=>{const s={csrf_token:i},o=`group/${t}/articles/delete/${e}`;return a.a.post(o,n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":i}})},yt=({userToken:t,postId:e,pushClans:i})=>{const s={csrf_token:t,post_id:e};return i&&i.length>0&&(s.push_clans=i),a.a.post("/operations/posts_addmailpool",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},wt=({userToken:t,postId:e,imgName:i})=>{const s={csrf_token:t,"data[Post][ref]":location.href,"data[Post][id]":e,"data[Post][header_img_file]":i};return a.a.post("/articles/update_header_img_file",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},Ct=({userToken:t,postId:e,summary:i})=>{const s={csrf_token:t,"data[Post][id]":e,"data[Post][summary]":i};return a.a.post("/posts/save_summary",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},kt=({userToken:t,postId:e,isHidden:i=1})=>{const s={id:e,hidden:i};return a.a.post("/admin/ajax_toggle_post_visibility",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},Ot=({targetGroupId:t,postId:e,categoryId:i})=>{const s={group_id:t,id:e};return i&&(s.category_id=i),a.a.post("/km_bff/article/v1/reship",s)},xt=({groupId:t,postId:e})=>a.a.post("/km_bff/article/v1/cancel_reship",{group_id:t,id:e}),jt=({groupId:t,groupPostId:e,userToken:i,isTop:s=1})=>a.a.get(`/group/${t}/article_top/${e}/${s}`,{headers:{"x-km-api-version":"std","X-Csrf-Token":i}}),It=({groupId:t,groupPostId:e,userToken:i,isEssential:s=1})=>a.a.get(`/group/${t}/article_essential/${e}/${s}`,{headers:{"x-km-api-version":"std","X-Csrf-Token":i}}),Tt=({currentGroupId:t,postId:e})=>{const i=`/actions?target_type=Post&target_id=${e}&group_id=${t}&url_prefix=${t?`group/${t}/`:""}`;return a.a.get(i,{headers:{"x-km-api-version":"std"}})},St=t=>a.a.post(_,{article_id:t}),Dt=t=>a.a.get(`${E}?id=${t}`,{headers:{"x-km-api-version":"std"}}),qt=t=>{const e={q:t,frequent:"",limit:50,timestamp:(new Date).getTime()};return a.a.get("/tags/normal_tag_chooser",{params:e,headers:{"x-km-api-version":"std"}})},Et=({postId:t,tags:e,userToken:i})=>{const s={target_id:t,target_type:"Post",tags:e};return a.a.get("/operations/bookmark_tags",{params:s,headers:{"x-km-api-version":"std","X-Csrf-Token":i}})},At=t=>{const e={target_id:t,target_type:"Post"};return a.a.get("/common/bookmark_box",{params:e,headers:{"x-km-api-version":"std"}})},Mt=({codeBlock:t,forceUpdate:e=!1})=>a.a.post(L,{code_block:t,force_update:e}),$t=({orderBy:t="visited_at",isDesc:e=!0,limit:i=20,offset:s=0,inTitle:n=""})=>a.a.post(v,{order_by:t,is_desc:e,limit:i,offset:s,in_title:n})},2004:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"ErrorDefaultMod",components:{},filters:{},props:{isGlobal:{type:Boolean,default:!0},showBottomBtn:{type:Boolean,default:!1},errorInfo:{type:Object,default:void 0}},setup:()=>({}),data:()=>({errType:0}),computed:{errorPageCodeInfo(){const t=this.errorInfo||this.$store.getters["global/errorPageCodeInfo"];return t.code&&this.$emit("trigger-error",t),t}},mounted(){},methods:{}}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"edm-wrapper"},[t.errorPageCodeInfo&&t.errorPageCodeInfo.code&&0!==t.errorPageCodeInfo.code?i("div",{staticClass:"error-default-mod-container",class:t.isGlobal?"global-error-default-mod-container":""},[i("div",{staticClass:"basic-page-area"},[i("div",{staticClass:"new-info"},[i("div",{staticClass:"new-info-icon",class:["new-not-found-page","new-removed-page","new-forbidden-page"][t.errorPageCodeInfo.errType||t.errType]||"new-not-found-page"}),t._v(" "),i("div",{staticClass:"new-info-big-text"},[t._v("\n          "+t._s(t.errorPageCodeInfo.mainTitle||t.errorPageCodeInfo.message||"访问出错啦，请稍后重试")+"\n        ")]),t._v(" "),t.errorPageCodeInfo.mainTitle?i("div",{staticClass:"new-info-small-text"},[t._v("\n          "+t._s(t.errorPageCodeInfo.message||"")+"\n        ")]):t._e(),t._v(" "),t.showBottomBtn?i("div",{staticClass:"new-jump-btn"},[t._m(0)]):t._e()])])]):t._t("pageContent")],2)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"jump-item",attrs:{href:"/"}},[e("span",[this._v("返回首页")])])}],!1,null,"36ad2ee8",null);e.a=o.exports},2005:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(74);const n=(t,{idKey:e="id",refKey:i="custom",refsKeyGetter:n=null})=>{const o={},r=Object(a.r)({});let l=null;return{userCardItem:r,renderUserCard:(a,c,d="")=>{var u;const p=a[e];let h=`${i}${p}`;n&&(h=n(a));const{refs:m,root:v}=t,g=m[h];if(!g||0===g.length)return;const f=Object(s.a)(g)?g[0]:g,_=(null==f||null===(u=f.getBoundingClientRect())||void 0===u?void 0:u.top)||0;if(o[p]=!0,!c)return o[p]=!1,void(o[p]||(clearTimeout(l),r.value={}));l=setTimeout(()=>{clearTimeout(l),b()},300);const b=()=>{v.$store.dispatch("question/fetchUserCard",c).then(t=>{if(o[p]){t.badgeDir=_<200?"dir-up":"dir-down";const e=`${h}${d}`;r.value={...t,refsKey:e}}else r.value={}}).catch(()=>{r.value={}})}}}}},2006:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3);const s=["primary","outline","secondary","danger","text","link","icon","icontext","jumpto"],n=["large","medium","small","mini"],o=["secondary","text","icon","icontext"],r=["primary","outline","danger"];var l=Object(a.c)({name:"km-button",components:{},props:{size:{type:String,default:"medium",validator:t=>""===t||n.includes(t)},type:{type:String,default:"primary",validator:t=>""===t||s.includes(t)},disabled:{type:Boolean,default:!1},aTagData:{type:Object,default:()=>{}},backgroudColor:{type:String,default:"inherit"},onClick:{type:Function,default:()=>{}}},setup(t,{emit:e}){const i=Object(a.r)(!1),s=Object(a.r)(),n=Object(a.a)(()=>[t.size?"km-btn--"+t.size:"",t.type?"km-btn--"+t.type:"",t.disabled?"km-btn--disabled":"",o.includes(t.type)?"km-btn__fit--grey":"",r.includes(t.type)?"km-btn__fit--fixed":""]);return Object(a.m)(()=>{"jumpto"===t.type&&Object.entries(t.aTagData).forEach(([t,e])=>{s.value.setAttribute(t,e)})}),{hovered:i,aTag:s,btnClasses:n,BTN_FIT_GREY:o,handleClick:i=>{if(t.disabled)return i.preventDefault(),void i.stopPropagation();t.onClick&&t.onClick({event:i}),e("click",{event:i})}}}}),c=i(68),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:{"background-color":t.backgroudColor}},[i("button",{class:["km-btn",t.btnClasses],attrs:{type:"button",disabled:t.disabled},on:{click:t.handleClick,mouseenter:function(){return t.hovered=!0},mouseleave:function(){return t.hovered=!1}}},["icon"===t.type||"icontext"===t.type?i("span",{class:["km-btn__icon",{"km-btn__icon--with-text":"icontext"===t.type}]},[t._t("icon")],2):t._e(),t._v(" "),"jumpto"!==t.type?t._t("default"):i("a",{ref:"aTag",staticClass:"km-btn__atag"},[t._t("default"),t._v(" "),"jumpto"===t.type?i("span",{staticClass:"km-btn__icon--right"},[i("svg-icon",{attrs:{name:t.hovered?"km-ui/arrow-right-hover":"km-ui/arrow-right",width:14,height:20}})],1):t._e()],2),t._v(" "),t.BTN_FIT_GREY.includes(t.type)?i("div",{staticClass:"km-btn__active"}):t._e()],2)])}),[],!1,null,"25e8d5f4",null);e.a=d.exports},2007:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1969),n=i(2001),o=Object(a.c)({name:"BadgeTwitter",components:{},filters:{},props:{userData:{type:Object,default:()=>({})},showAttention:{type:Boolean,default:!0},uniqueKey:{type:String,default:""},checkUniqueKey:{type:Boolean,default:!1},width:{type:Number,default:48}},setup:()=>({}),data:()=>({isFollwed:!1,buttonText:"关注",userMedal:{}}),computed:{userCardMap(){return this.$store.getters["question/getUserCardMap"]||{}},isShow(){var t;return this.checkUniqueKey?this.selfUniqueKey===this.userData.refsKey:null==this||null===(t=this.userData)||void 0===t?void 0:t.nick},selfUniqueKey(){return this.uniqueKey},curNick(){var t,e;return(null===(t=this.$store.getters["global/userInfo"])||void 0===t||null===(e=t.user_info)||void 0===e?void 0:e.nick)||""},userMedalLink(){var t,e;return`/user/${null==this||null===(t=this.userData)||void 0===t?void 0:t.nick}?award_id=${null==this||null===(e=this.userMedal)||void 0===e?void 0:e.id}`}},watch:{userData(){Object(s.a)(this.userData)||(this.isFollwed=this.getIsFollowed(),this.buttonText=this.isFollwed?"已关注":"关注",Object(n.r)({nick:this.userData.nick}).then(({data:t})=>{var e,i;0===(null==t?void 0:t.code)?(this.userMedal=(null==t||null===(e=t.data)||void 0===e?void 0:e.current_award)||{},this.userMedal.count=(null==t||null===(i=t.data)||void 0===i?void 0:i.award_count)||0):this.userMedal.count=0}))}},mounted(){},methods:{getIsFollowed(){const{userCardMap:t,userData:e}=this,i=t[e.nick];return(null==i?void 0:i.is_mine_friend)||(null==e?void 0:e.is_mine_friend)||!1},payAttention(){let t=!this.isFollwed;this.userCardMap[this.userData.nick]&&void 0!==this.userCardMap[this.userData.nick].is_mine_friend&&(t=!this.userCardMap[this.userData.nick].is_mine_friend);const{nick:e}=this.userData,i=this.$store.getters["global/userToken"]||"";this.$store.dispatch("question/payAttentionUser",{nick:e,isFollowClick:t,userToken:i}).then(()=>{this.buttonText=t?"已关注":"关注",this.isFollwed=!this.isFollwed})},handleHover(){this.isFollwed?this.buttonText="取消关注":this.buttonText="关注",console.log("hover")},handleLeave(){this.isFollwed?this.buttonText="已关注":this.buttonText="关注"}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isShow?i("div",{class:["badge-layer-container","badge-layer-container-"+(t.userData.badgeDir||"dir-up")],style:{marginLeft:"-"+(180-t.width/2)+"px"}},["dir-up"===t.userData.badgeDir?i("div",{staticClass:"blank-area"}):t._e(),t._v(" "),i("div",{class:["card-top","dir-up"===t.userData.badgeDir?"dir-up":""]},[i("div",{staticClass:"position-area"},[i("div",{staticClass:"avatar"},[i("a",{attrs:{href:t._f("personalPage")(t.userData.nick,""),target:"_blank"}},[i("img",{attrs:{src:"/asset/avatar/"+t.userData.nick}})])]),t._v(" "),i("ul",{staticClass:"user-info"},[i("li",{staticClass:"nick-line"},[i("a",{staticClass:"nick",attrs:{href:t._f("personalPage")(t.userData.nick,""),target:"_blank",title:t.userData.nick+"("+t.userData.name+")"}},[t._v("\n            "+t._s(t.userData.nick+"("+t.userData.name+")")+"\n          ")]),t._v(" "),Number(t.userMedal.id)?i("a",{attrs:{target:"_blank",href:t.userMedalLink,title:t.userMedal.name}},[i("img",{staticClass:"user-medal",attrs:{src:t.userMedal.logo}})]):t._e()]),t._v(" "),i("li",{staticClass:"position",class:t.showAttention?"":"long-position"},[i("span",{staticClass:"single_line",attrs:{title:t.userData.user_major_dept_info}},[t._v(t._s(t.userData.user_major_dept_info))])])])]),t._v(" "),t.showAttention&&t.curNick!==t.userData.nick?i("div",{staticClass:"attention-area",on:{click:t.payAttention,mouseenter:t.handleHover,mouseleave:t.handleLeave}},[t.isFollwed?t._e():i("svg-icon",{staticClass:"add-icon",attrs:{name:"question/attention",width:16,height:16}}),t._v(" "),i("span",[t._v("\n        "+t._s(t.buttonText)+"\n      ")])],1):t._e()]),t._v(" "),i("div",{class:["card-bottom","dir-down"===t.userData.badgeDir?"dir-down":""]},[i("div",{staticClass:"count-area"},[i("ul",[i("li",[i("a",{attrs:{href:"/user/"+t.userData.nick+"/articles",target:"_blank"}},[i("div",{staticClass:"value"},[t._v(t._s(t.userData.post_count||0))]),t._v(" "),i("div",{staticClass:"type-text"},[t._v("文章")])])]),t._v(" "),i("li",[i("a",{attrs:{href:"/user/"+t.userData.nick+"/q",target:"_blank"}},[i("div",{staticClass:"value"},[t._v(t._s(t.userData.agreed_count||0))]),t._v(" "),i("div",{staticClass:"type-text"},[t._v("被赞同")])])]),t._v(" "),i("li",[i("a",{attrs:{href:"/user/"+t.userData.nick+"/followed",target:"_blank"}},[i("div",{staticClass:"value"},[t._v(t._s(t.userData.followed_count||0))]),t._v(" "),i("div",{staticClass:"type-text"},[t._v("被关注")])])]),t._v(" "),i("li",[i("a",{attrs:{href:"/user/"+t.userData.nick,target:"_blank"}},[i("div",{staticClass:"value"},[t._v(t._s(t.userMedal.count||0))]),t._v(" "),i("div",{staticClass:"type-text"},[t._v("勋章")])])])])])]),t._v(" "),"dir-down"===t.userData.badgeDir?i("div",{staticClass:"blank-area"}):t._e()]):t._e()}),[],!1,null,"539ab022",null);e.a=l.exports},2008:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"DropDown",components:{},props:{itemList:{type:Array,default:()=>[]},dropdownWidth:{type:Number,default:120},containerStyle:{type:Object,default:()=>({})},showUp:{type:Boolean,default:!1},itemPosition:{type:String,default:""}},setup(t,{emit:e}){const i=Object(a.r)(!1),s=Object(a.r)();return{isDropdownUp:i,container:s,onEnterComponent:t=>{var a,n;const o=s.value.clientHeight,r=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-(null===(a=t.target)||void 0===a?void 0:a.getBoundingClientRect().bottom)-18,l=null===(n=t.target)||void 0===n?void 0:n.getBoundingClientRect().top;i.value=l>o&&r<o,e("enterComponent",{event:t})},onClickItem:t=>{e("clickItem",{item:t})}}}}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"dropdown__component",on:{mouseenter:t.onEnterComponent}},[t._t("default"),t._v(" "),i("span",{ref:"container",class:["dropdown__container",{"dropdown__container--up":t.isDropdownUp||t.showUp}],style:t.containerStyle},[i("div",{staticClass:"dropdown",style:{width:t.dropdownWidth+"px"}},t._l(t.itemList,(function(e,a){return i("div",{key:a,staticClass:"dropdown__item-container"},[e.dividerUp?i("div",{staticClass:"dropdown__divider"}):t._e(),t._v(" "),e.isATag?i("a",{class:["dropdown__item","dropdown__item_"+t.itemPosition,{"dropdown__item--divider":e.dividerUp,"dropdown__item-actived":e.actived,"dropdown__item-disable":e.disabled}],attrs:{href:e.url,target:e.target},on:{click:function(){return t.onClickItem(e)}}},[e.iconInfo?i("span",{staticClass:"dropdown__icon"},[i("svg-icon",{attrs:{name:e.iconInfo.name,width:e.iconInfo.width,height:e.iconInfo.height}})],1):t._e(),t._v(" "),i("span",{staticClass:"dropdown__text"},[t._v(t._s(e.text))])]):i("div",{class:["dropdown__item","dropdown__item_"+t.itemPosition,{"dropdown__item--divider":e.dividerUp,"dropdown__item-actived":e.actived,"dropdown__item-disable":e.disabled}],on:{click:function(){return t.onClickItem(e)}}},[e.iconInfo?i("span",{staticClass:"dropdown__icon"},[i("svg-icon",{attrs:{name:e.iconInfo.name,width:e.iconInfo.width,height:e.iconInfo.height}})],1):t._e(),t._v(" "),i("span",{staticClass:"dropdown__text"},[t._v(t._s(e.text))])])])})),0)])],2)}),[],!1,null,"4dfa7623",null);e.a=o.exports},2009:function(t,e,i){"use strict";i.d(e,"w",(function(){return b})),i.d(e,"t",(function(){return y})),i.d(e,"g",(function(){return w})),i.d(e,"b",(function(){return C})),i.d(e,"c",(function(){return k})),i.d(e,"d",(function(){return O})),i.d(e,"y",(function(){return x})),i.d(e,"x",(function(){return j})),i.d(e,"h",(function(){return I})),i.d(e,"f",(function(){return T})),i.d(e,"j",(function(){return S})),i.d(e,"v",(function(){return D})),i.d(e,"r",(function(){return q})),i.d(e,"i",(function(){return E})),i.d(e,"u",(function(){return A})),i.d(e,"m",(function(){return M})),i.d(e,"p",(function(){return $})),i.d(e,"n",(function(){return L})),i.d(e,"o",(function(){return P})),i.d(e,"s",(function(){return F})),i.d(e,"z",(function(){return R})),i.d(e,"a",(function(){return N})),i.d(e,"l",(function(){return B})),i.d(e,"k",(function(){return U})),i.d(e,"e",(function(){return H})),i.d(e,"q",(function(){return V}));i(11),i(12),i(13),i(14),i(15);var a=i(7),s=i(81),n=i.n(s);const o="/videos/view",r="/videos/view_playlist?",l="/videos/list_hottest",c="/videos/list_video",d="/videos/delete",u="/videos/add_read_count",p="/km_bff/operation/v1/get_video_banner",h="/videos/list_video",m="/videos/list_video",v="/videos/list_playlist",g="/videos/list_video",f="/videos/list_playlist",_="/km_bff/video/v1/list_videos_by_cond",b=t=>a.a.get(""+o,{params:{id:t},headers:{"x-km-api-version":"std"}}),y=({currentGroupId:t,videoId:e})=>{const i=t?`group/${t}/`:"";return a.a.get(`/actions?target_type=Video&target_id=${e}&group_id=${t}&url_prefix=${i}`,{headers:{"x-km-api-version":"std"}})},w=(t,e)=>a.a.get("/operations/recommend",{params:{...t,target_type:"Video"},headers:{"x-km-api-version":"std","X-Csrf-Token":e}}),C=(t,e)=>a.a.get("/operations/unrecommend",{params:{...t,target_type:"Video"},headers:{"x-km-api-version":"std","X-Csrf-Token":e}}),k=(t,e)=>a.a.get("/operations/do_bookmark",{params:{...t,target_type:"Video"},headers:{"x-km-api-version":"std","X-Csrf-Token":e}}),O=(t,e)=>a.a.get("/operations/unbookmark",{params:{...t,target_type:"Video"},headers:{"x-km-api-version":"std","X-Csrf-Token":e}}),x=({vodFileId:t,name:e})=>a.a.post("/videos/report_vod_upload",{vod_file_id:t,name:e}),j=t=>a.a.post("/videos/get_vod_play",n.a.stringify({video_ids:[t]}),{headers:{"x-km-api-version":"std"}}),I=t=>a.a.post("/videos/save",t,{headers:{"x-km-api-version":"std"}}),T=t=>{const e=new FormData;return e.append("video_id",t),a.a.post(""+d,e,{headers:{"x-km-api-version":"std"}})},S=t=>a.a.get("/videos/get_group_video_playlist_name",{params:{group_id:t},headers:{"x-km-api-version":"std"}}),D=t=>a.a.get("/videos/get_edit",{params:{id:t},headers:{"x-km-api-version":"std"}}),q=(t,e)=>a.a.get(""+l,{params:{group_id:e,video_id:t}}),E=t=>a.a.get(""+c,{params:{limit:10,list_type:"single_attached",attachable_type:"Post",attachable_id:t}}),A=t=>a.a.get(""+r,{params:{id:t},headers:{"x-km-api-version":"std"}}),M=()=>a.a.post(""+p),$=t=>{const{listType:e="pure",orderBy:i="latest",limit:s=10,offset:n,isFillToLimit:o,maxAge:r=365,readableOnly:l=!0}=t||{};return a.a.get(""+m,{params:{list_type:e,sort_by:i,limit:s,offset:n,is_fill_to_limit:o,max_age:"latest"===i?0:r,readable_only:l},headers:{"x-km-api-version":"std"}})},L=t=>{const{orderBy:e="latest",limit:i=10,offset:s,isFillToLimit:n,isFilterEmpty:o=1,maxAge:r=365}=t||{};return a.a.get(""+v,{params:{sort_by:e,limit:i,offset:s,is_fill_to_limit:n,is_filter_empty:o,max_age:"latest"===e?0:r},headers:{"x-km-api-version":"std"}})},P=()=>a.a.get(""+h,{params:{list_type:"recommended",limit:10,sort_by:"latest_recommended"},headers:{"x-km-api-version":"std"}}),F=t=>a.a.post("/km_bff/auth/v1/auth_entry",{access_entry:{target_id:t,target_type:"video",action:"manage"}}),R=({userToken:t,videoId:e,pushClans:i})=>{const s={csrf_token:t,video_id:e};return i&&i.length>0&&(s.push_clans=i),a.a.post("/operations/videos_addmailpool",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},N=t=>a.a.post(u,{id:t}),B=t=>{const{listType:e="pure",orderBy:i="latest",limit:s=8,offset:n,groupId:o,isFillToLimit:r=!0,readableOnly:l=0}=t||{};return a.a.get(""+g,{params:{list_type:e,sort_by:i,limit:s,group_id:o,offset:n,is_fill_to_limit:r,max_age:0,readable_only:l},headers:{"x-km-api-version":"std"}})},U=t=>{const{orderBy:e="latest",limit:i=4,offset:s,isFillToLimit:n,isFilterEmpty:o=0,groupId:r}=t||{};return a.a.get(""+f,{params:{sort_by:e,limit:i,offset:s,is_fill_to_limit:n,is_filter_empty:o,group_id:r,max_age:0},headers:{"x-km-api-version":"std"}})},H=(t,e)=>{const i=new FormData;return i.append("target_id",e),a.a.post(`group/${t}/videos/ajax_del_playlist`,i)},V=t=>a.a.post(""+_,t)},2010:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(6),n=i.n(s),o={maxItemWidth:{type:String,default:void 0},options:{type:Array},separator:{type:[String,Function]},theme:{type:String,default:"light",validator:function(t){return!t||["light"].includes(t)}}},r=i(43),l=i(1328),c=i(1891),d={content:{type:[String,Function]},default:{type:[String,Function]},disabled:Boolean,href:{type:String,default:""},icon:{type:Function},maxWidth:{type:String,default:void 0},replace:Boolean,router:{type:Object},target:{type:String,default:"_self",validator:function(t){return!t||["_blank","_self","_parent","_top"].includes(t)}},to:{type:[String,Object]}},u=i(49),p=i(18),h=i(22),m=i(10);i(53),i(16),i(114),i(38),i(17),i(23),i(58),i(56),i(32),i(25),i(24),i(27),i(26);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var f=Object(p.b)("breadcrumb"),_={separator:"",theme:"light",$slots:{separator:""},maxItemWidth:void 0},b=Object(h.a)(f,Object(p.c)()).extend({name:"TBreadcrumbItem",props:g({},d),inject:["tBreadcrumb"],data:function(){return{localTBreadcrumb:_,themeClassName:"",$router:null,isCutOff:!1}},components:{Tooltip:c.a},computed:{maxWithStyle:function(){var t=this.localTBreadcrumb.maxItemWidth,e=this.maxWidth||t||"120";return{"max-width":"".concat(e,"px")}}},watch:{tBreadcrumb:{immediate:!0,handler:function(t){this.localTBreadcrumb=t}}},created:function(){var t=this.localTBreadcrumb;this.themeClassName=t.theme},mounted:function(){this.isCutOff=Object(u.e)(this.$refs.breadcrumbText)},beforeUpdate:function(){this.isCutOff=Object(u.e)(this.$refs.breadcrumbText)},methods:{bindEvent:function(){var t=this.to,e=this.router||this.$router;t&&e&&(this.replace?e.replace(t):e.push(t))}},render:function(){var t=this,e=arguments[0],i=this.localTBreadcrumb,a=this.href,s=this.target,n=this.to,o=this.disabled,d=this.useGlobalIcon({ChevronRightIcon:l.a}),u=d.ChevronRightIcon,p=i.separator,h=i.$slots.separator,v="function"==typeof p?p():p,f=v||h||e(u),_=["".concat(this.componentName,"__item"),this.themeClassName],b=["".concat(this.componentName,"--text-overflow")];o&&b.push("".concat(this.classPrefix,"-is-disabled")),this.$listeners.click&&b.push("".concat(this.classPrefix,"-gestureClass"));var y=n&&!o?{on:{click:this.bindEvent}}:{},w=e("span",{class:"".concat(this.componentName,"__inner"),style:this.maxWithStyle},[Object(m.b)(this,"icon"),e("span",{ref:"breadcrumbText",class:"".concat(this.componentName,"__inner-text")},[this.$slots.default])]),C=e("span",Object(r.a)([{class:b,on:g({},this.$listeners)},y]),[w]);return a&&!o&&(b.push("".concat(this.classPrefix,"-link")),C=e("a",{class:b,attrs:{href:a,target:s},on:g({},this.$listeners)},[w])),e("div",{class:_},[this.isCutOff?e(c.a,{attrs:{content:function(){return t.$slots.default}}},[C]):C,e("span",{class:"".concat(this.componentName,"__separator")},[f])])}});
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}var w=Object(p.b)("breadcrumb"),C=Object(h.a)(w).extend({name:"TBreadcrumb",props:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},o),components:{BreadcrumbItem:b},provide:function(){return{tBreadcrumb:this}},render:function(){var t=arguments[0],e=this.$slots.default;return this.options&&this.options.length&&(e=this.options.map((function(e,i){return t(b,{key:i,attrs:{maxWidth:e.maxWidth,disabled:e.disabled,href:e.href,target:e.target,to:e.to,router:e.router,replace:e.replace}},[e.default||e.content])}))),t("div",{class:this.componentName},[e])}}),k=i(35),O=Object(k.a)(b),x=Object(k.a)(C),j=Object(a.c)({name:"km-breadcrumb",components:{TBreadcrumb:x,TBreadcrumbItem:O},props:{options:{type:Array,default:()=>[]},target:{type:String,default:"_self"}},setup:t=>({prevItems:Object(a.a)(()=>{const e=t.options.length;return e>1?t.options.slice(0,e-1):[]}),curItem:Object(a.a)(()=>{const e=t.options.length;return e>0?t.options[e-1]:null}),onClickCurItem:()=>{var t,e;null===(t=window)||void 0===t||null===(e=t.location)||void 0===e||e.reload()}})}),I=i(68),T=Object(I.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("t-breadcrumb",{attrs:{separator:"/"}},[t._l(t.prevItems,(function(e,a){return i("t-breadcrumb-item",{key:"km_breadcrumb_"+a,attrs:{href:e.href,target:t.target}},[t._v("\n    "+t._s(e.content)+"\n  ")])})),t._v(" "),t.curItem?i("t-breadcrumb-item",{on:{click:t.onClickCurItem}},[t._v(t._s(t.curItem.content))]):t._e()],2)}),[],!1,null,"89ae5234",null);e.a=T.exports},2011:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(2115),s=i.n(a),n=i(2025),o=(i(2116),i(1899)),r=i.n(o),l=i(7);const c=window.tinymce.util.Tools.resolve("window.tinymce.PluginManager");let d=1;c.add("tencentdoc",(function(t){function e(){d>1?r()(".previous-page").removeClass("btn-disabled"):d<=1&&r()(".previous-page").addClass("btn-disabled")}function i(e){const i=e.map(t=>`<div\n              class="tencent-doc-item"\n              data-id="${t.ID}"\n              data-url="${t.url}"\n              data-title="${t.title}"\n              data-type="${t.type}">\n              <span class="doc-${t.type}-icon"></span>\n              <span class="doc-name">${t.title}</span>\n              <span class="doc-from">${t.ownerName}</span>\n              <span class="doc-open-time">${new Date(1e3*t.lastBrowseTime).Format("yyyy-MM-dd hh:mm")}</span>\n          </div>`);r()(".tencent-doc-list-body").html(i),r()(".tencent-doc-item").click((function(){s({ID:r()(this).data("id"),title:r()(this).data("title"),url:r()(this).data("url"),type:r()(this).data("type")}),t.windowManager.close()}))}function a(t,e){const i=new FormData;i.append("ListType","create"),i.append("start",10*(d-1)),i.append("limit",10),i.append("isOwner",2),r()(".loading").show(),l.a.post("/attachments/ajax_qqdocs_list_files",i).then(({data:e})=>{if(r()(".loading").hide(),0===e.code){const i=e.data.list.filter(t=>"folder"!==t.type);d<=1?r()(".previous-page").addClass("btn-disabled"):r()(".previous-talk").removeClass("btn-disabled"),e.data.list.length<10?r()(".next-page").addClass("btn-disabled"):r()(".next-page").removeClass("btn-disabled"),"function"==typeof t&&t(i)}else n(e)}).catch(t=>{console.error(t),r()(".loading").hide(),"function"==typeof e&&e()})}function s(e){const i=`<div class="tencent-doc-placeholder ${t.tencent_doc_type||""} hide" contenteditable="false">\n            <span class="doc-icon">~</span>\n            <span class="doc-title single_line">${e.title}</span>\n            <span class="doc-edit" data-url="${e.url}">进入编辑\n              <span class="doc-id hide">${e.ID}</span>\n              <span class="doc-url hide">${e.url}</span>\n              <span class="doc-type hide">${e.type||"doc"}</span>\n            </span>\n            <span class="doc-delete">删除</span>\n        </div><br>`;t.execCommand("mceInsertContent",!1,i),t.dom.select(".doc-edit").forEach(t=>{t.addEventListener("click",(function(){window.open(r()(this).data("url"),"_blank")}),!1)}),t.dom.select(".doc-delete").forEach(e=>{e.addEventListener("click",(function(){const e=this;t.vueContext.$confirm("你确定删除吗？",{id:"default-confirm",title:"确定",cancelable:!0,needIcon:!0,noPadding:!1,closable:!0,success:()=>{r()(e).parent().remove()},abort:()=>{}})}),!1)})}function n(e){4===e.code?t.vueContext.$confirm("检测到本页面包含腾讯文档服务，请点击确定获取腾讯文档授权",{success:()=>{const t="/attachments/refresh_qqdocs_token?redirect_uri="+encodeURIComponent("/?ref=tencent_doc_auth");window.open(t,"_blank")},title:"授权确认"}):t.vueContext.$toast("出错了："+e.message),t.windowManager.close()}t.ui.registry.addMenuButton("tencentdoc",{icon:"tencent_doc",tooltip:"腾讯文档",fetch(e){e([{type:"menuitem",icon:"tencent_doc",text:"插入已有文档",value:"join_tencent_doc",onAction:()=>t.execCommand("join_tencent_doc")},{type:"menuitem",icon:"file_doc",text:"新建在线文档",value:"doc",onAction:()=>t.execCommand("create_tencent_docs","doc")},{type:"menuitem",icon:"file_excel",text:"新建在线表格",value:"sheet",onAction:()=>t.execCommand("create_tencent_docs","sheet")},{type:"menuitem",icon:"file_ppt",text:"新建在线幻灯片",value:"slide",onAction:()=>t.execCommand("create_tencent_docs","slide")}])}}),t.addCommand("join_tencent_doc",(function(){t.windowManager.open({title:"腾讯文档",body:{type:"tabpanel",tabs:[{name:"doclink",title:"腾讯文档链接",items:[{type:"input",name:"docUrl"},{type:"htmlpanel",html:"提示：仅支持腾讯企业微信下创建的腾讯文档链接"}]},{title:"我创建的文档",name:"mydoc",items:[{type:"htmlpanel",html:'<div class="tencent-doc-list-container">\n                             <div class="loading"></div>\n                             <div class="tencent-doc-list-header">\n                                <span class="doc-name">名称</span>\n                                <span class="doc-from">来自</span>\n                                <span class="doc-open-time">最近打开</span>\n                             </div>\n                             <div class="tencent-doc-list-body"></div>\n                             <div class="tencent-doc-list-footer">\n                                  <div class="page-btn-box">\n                                      <span class="previous-page page-btn">上一页</span>\n                                      <span class="next-page page-btn">下一页</span>\n                                  </div>\n                              </div>\n                         </div>'}]}]},buttons:[{text:"插入",type:"submit",primary:!0},{text:"取消",type:"cancel"}],onTabChange:(s,n)=>{"mydoc"===n.newTabName?(a((function(t){i(t),c.isBusyNow=!1,e()}),(function(){c.isBusyNow=!1,e(),d+=1,t.vueContext.$toast("网络出错，请稍后再试！")})),r()(".previous-page").click((function(){r()(".previous-page").hasClass("btn-disabled")||c.isBusyNow||(d-=1,c.isBusyNow=!0,a((function(t){i(t),c.isBusyNow=!1,e()}),(function(){c.isBusyNow=!1,d+=1,e(),t.vueContext.$toast("网络出错，请稍后再试！")})))})),r()(".next-page").click((function(){r()(".next-page").hasClass("btn-disabled")||c.isBusyNow||(d+=1,c.isBusyNow=!0,a((function(t){i(t),c.isBusyNow=!1,e()}),(function(){c.isBusyNow=!1,d-=1,e(),t.vueContext.$toast("网络出错，请稍后再试！")})))})),r()(".tox-dialog__footer").hide()):r()(".tox-dialog__footer").show()},onSubmit:e=>{const i=e.getData().docUrl;if(""!==i){const e=new FormData;e.append("link",i),l.a.post("/attachments/ajax_qqdocs_file_info",e).then(({data:e})=>{0===e.code?(s(e.data),t.windowManager.close()):n(e)})}}})})),t.addCommand("create_tencent_docs",(function(e="doc"){t.windowManager.open({title:"输入文档标题",body:{type:"panel",items:[{type:"htmlpanel",html:"创建后默认权限为企业内员工可查看，如需更改请创建后进入编辑修改"},{type:"input",name:"doctitle",inputMode:"text",placeholder:"请输入文档标题"},{type:"htmlpanel",html:'<div class="empty-title-tip hide red">文档标题不能为空</div>'}]},buttons:[{type:"submit",text:"确定",primary:!0},{type:"cancel",text:"Close"}],onChange:(t,e)=>{"doctitle"===e.name&&t.getData().doctitle?r()(".empty-title-tip").hide():"doctitle"!==e.name||t.getData().doctitle||r()(".empty-title-tip").show()},onSubmit:i=>{const a=i.getData();a.doctitle?function(e,i){const a=new FormData;a.append("title",e),a.append("type",i||"doc"),l.a.post("/attachments/ajax_qqdocs_create",a).then(({data:e})=>{0===e.code?(s(e.data),t.windowManager.close()):n(e)})}(a.doctitle,e):r()(".empty-title-tip").show()}})})),t.ui.registry.addIcon("tencent_doc",'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 32 32"><g id="文档">\n\t<g transform="translate(-140.000000, -391.000000)">\n\t\t<g id="logo-29e249" transform="translate(140.000000, 391.000000)">\n\t\t\t<path id="路径" fill="#1E6FFF" d="M5.3,1C5.1,1,4.8,1.2,4.8,1.5L0,29.3C-0.1,29.7,0.2,30,0.6,30h11.3l0.9-0.3h5.3l0.7,0.3h8.7c0.3,0,0.5-0.2,0.6-0.5L32,7l-6.1-6H5.3z"/>\n\t\t\t<path id="路径_1_" fill="#00DCFF" d="M32,7l-6.1-6L25,6.2C24.9,6.6,25.2,7,25.6,7H32z"/>\n\t\t\t<polygon id="路径_2_" fill="#FFFFFF" points="17.1,2 15.9,8.8 5,8.8 9.8,14.3 15,14.3 12.4,30 19.2,30 21.8,14.3 29.7,14.3 30,14.3"/>\n\t\t</g>\n\t</g>\n</g>\n</svg>'),t.ui.registry.addIcon("file_doc",'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 20 20" width="20px" height="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n<g id="文档">\n\t<g transform="translate(-302.000000, -1351.000000)">\n\t\t<g id="弹窗" transform="translate(194.000000, 930.000000)">\n\t\t\t<g id="_x30_6" transform="translate(108.000000, 421.000000)">\n\t\t\t\t<g id="file_doc">\n\t\t\t\t\t<g id="编组-7" transform="translate(1.500000, 1.000000)">\n\n\t\t\t\t\t\t\t<linearGradient id="file_doc_1" gradientUnits="userSpaceOnUse" x1="-2562.3193" y1="797.0652" x2="-2562.4832" y2="797.0652" gradientTransform="matrix(14.4 0 0 -13.5 36914.5 10771.6299)">\n\t\t\t\t\t\t\t<stop  offset="0" style="stop-color:#4776FA"/>\n\t\t\t\t\t\t\t<stop  offset="1" style="stop-color:#194CE9"/>\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t<path id="蒙版备份" fill="url(#file_doc_1)" d="M3.9,4.5h12.1c0.6,0,1.2,0.5,1.2,1.1v11.2c0,0.6-0.5,1.1-1.2,1.1H3.9\n\t\t\t\t\t\t\tc-0.6,0-1.2-0.5-1.2-1.1V5.6C2.7,5,3.2,4.5,3.9,4.5z"/>\n\n\t\t\t\t\t\t\t<radialGradient id="file_doc_2" cx="-2727.3647" cy="1035.4854" r="1.491" gradientTransform="matrix(-2.3715 16.0255 16.0255 2.3715 -23050.3574 41251.7266)" gradientUnits="userSpaceOnUse">\n\t\t\t\t\t\t\t<stop  offset="0" style="stop-color:#359FFF"/>\n\t\t\t\t\t\t\t<stop  offset="0.9992" style="stop-color:#0D75FF"/>\n\t\t\t\t\t\t</radialGradient>\n\t\t\t\t\t\t<path id="path-3" fill="url(#file_doc_2)" d="M13.8,0C14.5,0,15,0.5,15,1.2v15.6l0,0c0,0.7,0.5,1.2,1.2,1.2h-15C0.5,18,0,17.5,0,16.8V1.2\n\t\t\t\t\t\t\tC0,0.5,0.5,0,1.2,0H13.8z"/>\n\t\t\t\t\t\t<g id="形状结合备份" transform="translate(2.700000, 12.600000)">\n\t\t\t\t\t\t\t<g id="path-5-link">\n\t\t\t\t\t\t\t\t<polygon id="path-5" points="0.8,0.1 9.7,0.1 9.7,2 0.8,2"/>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="path-5-link_1_">\n\t\t\t\t\t\t\t\t<polygon id="path-5_1_" fill="#98D3FF" points="0.8,0.1 9.7,0.1 9.7,2 0.8,2"/>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<g id="形状结合" transform="translate(2.700000, 9.000000)">\n\t\t\t\t\t\t\t<g id="path-7-link">\n\t\t\t\t\t\t\t\t<polygon id="path-7" points="0.8,0.8 9.7,0.8 9.7,2.5 0.8,2.5"/>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="path-7-link_1_">\n\t\t\t\t\t\t\t\t<polygon id="path-7_1_" fill="#D3F3FF" points="0.8,0.8 9.7,0.8 9.7,2.5 0.8,2.5"/>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</g>\n</svg>'),t.ui.registry.addIcon("file_excel",'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 20 20" width="20px" height="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n<g id="文档">\n\t<g transform="translate(-302.000000, -1183.000000)">\n\t\t<g id="弹窗" transform="translate(194.000000, 930.000000)">\n\t\t\t<g id="_x30_2" transform="translate(103.000000, 244.000000)">\n\t\t\t\t<g id="编组-11" transform="translate(5.000000, 9.000000)">\n\t\t\t\t\t<g id="file_sheet_16">\n\t\t\t\t\t\t<g id="编组-8" transform="translate(1.500000, 1.000000)">\n\n\t\t\t\t\t\t\t\t<linearGradient id="file_excel_1" gradientUnits="userSpaceOnUse" x1="-2562.3193" y1="797.0652" x2="-2562.5557" y2="797.0652" gradientTransform="matrix(14.4 0 0 -13.5 36914.5 10771.6299)">\n\t\t\t\t\t\t\t\t<stop  offset="0" style="stop-color:#009F57"/>\n\t\t\t\t\t\t\t\t<stop  offset="1" style="stop-color:#00732E"/>\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t<path id="蒙版备份" fill="url(#file_excel_1)" d="M3.9,4.5h12.1c0.6,0,1.2,0.5,1.2,1.1v11.2c0,0.6-0.5,1.1-1.2,1.1H3.9\n\t\t\t\t\t\t\t\tc-0.6,0-1.2-0.5-1.2-1.1V5.6C2.7,5,3.2,4.5,3.9,4.5z"/>\n\t\t\t\t\t\t\t<g id="蒙版">\n\t\t\t\t\t\t\t\t<g id="path-3-link">\n\n\t\t\t\t\t\t\t\t\t\t<linearGradient id="file_excel_2" gradientUnits="userSpaceOnUse" x1="-2585.9617" y1="813.3266" x2="-2586.3711" y2="812.3436" gradientTransform="matrix(16.4129 0 0 -18 42456.4609 14636.1729)">\n\t\t\t\t\t\t\t\t\t\t<stop  offset="2.903294e-04" style="stop-color:#00CEAE"/>\n\t\t\t\t\t\t\t\t\t\t<stop  offset="1" style="stop-color:#00A558"/>\n\t\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t\t\t<path id="path-3" fill="url(#file_excel_2)" d="M14,0c0.6,0,1.2,0.5,1.2,1.2v15.6l0,0c0,0.7,0.5,1.2,1.2,1.2H1.2C0.5,18,0,17.5,0,16.8\n\t\t\t\t\t\t\t\t\t\tV1.2C0,0.5,0.5,0,1.2,0H14z"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="Rectangle-19-Copy-5备份-2" transform="translate(8.100000, 12.600000)">\n\t\t\t\t\t\t\t\t<g id="path-5-link">\n\t\t\t\t\t\t\t\t\t<rect id="path-5" x="0" y="0.1" width="4.5" height="1.9"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-5-link_1_">\n\t\t\t\t\t\t\t\t\t<rect id="path-5_1_" x="0" y="0.1" fill="#9BF7C1" width="4.5" height="1.9"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="Rectangle-19-Copy-4备份-3" transform="translate(2.700000, 12.600000)">\n\t\t\t\t\t\t\t\t<g id="path-7-link">\n\t\t\t\t\t\t\t\t\t<rect id="path-7" x="0.2" y="0.1" width="4.9" height="1.9"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-7-link_1_">\n\t\t\t\t\t\t\t\t\t<rect id="path-7_1_" x="0.2" y="0.1" fill="#B2F8EA" width="4.9" height="1.9"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="Rectangle-19-Copy-5备份" transform="translate(8.100000, 9.000000)">\n\t\t\t\t\t\t\t\t<g id="path-9-link">\n\t\t\t\t\t\t\t\t\t<rect id="path-9" x="0" y="0.8" width="4.5" height="1.7"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-9-link_1_">\n\t\t\t\t\t\t\t\t\t<rect id="path-9_1_" x="0" y="0.8" fill="#B2F8EA" width="4.5" height="1.7"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="Rectangle-19-Copy-4" transform="translate(2.700000, 9.000000)">\n\t\t\t\t\t\t\t\t<g id="path-11-link">\n\t\t\t\t\t\t\t\t\t<rect id="path-11" x="0.2" y="0.8" width="4.9" height="1.7"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-11-link_1_">\n\t\t\t\t\t\t\t\t\t<rect id="path-11_1_" x="0.2" y="0.8" fill="#E0FFF9" width="4.9" height="1.7"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</g>\n</svg>'),t.ui.registry.addIcon("file_ppt",'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 20 20" width="20px" height="20px" style="enable-background:new 0 0 20 20;" xml:space="preserve">\n<g id="文档">\n\t<g transform="translate(-302.000000, -1225.000000)">\n\t\t<g id="弹窗" transform="translate(194.000000, 930.000000)">\n\t\t\t<g id="_x30_3" transform="translate(108.000000, 295.000000)">\n\t\t\t\t<g id="file_slide_16">\n\t\t\t\t\t<g id="编组-9" transform="translate(1.500000, 1.000000)">\n\n            <linearGradient id="file_ppt_1" gradientUnits="userSpaceOnUse" x1="-2562.3193" y1="797.0652" x2="-2562.4883" y2="797.0652" gradientTransform="matrix(14.4 0 0 -13.5 36914.5 10771.6299)">\n\t\t\t\t\t\t\t<stop  offset="0" style="stop-color:#F7501C"/>\n\t\t\t\t\t\t\t<stop  offset="1" style="stop-color:#D93213"/>\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t<path id="蒙版备份" fill="url(#file_ppt_1)" d="M3.9,4.5h12.1c0.6,0,1.2,0.5,1.2,1.1v11.2c0,0.6-0.5,1.1-1.2,1.1H3.9\n\t\t\t\t\t\t\tc-0.6,0-1.2-0.5-1.2-1.1V5.6C2.7,5,3.2,4.5,3.9,4.5z"/>\n\n\t\t\t\t\t\t\t<linearGradient id="file_ppt_2" gradientUnits="userSpaceOnUse" x1="-2583.6975" y1="813.0947" x2="-2584.4312" y2="812.0947" gradientTransform="matrix(16.2 0 0 -18 41869.9023 14636.1729)">\n\t\t\t\t\t\t\t<stop  offset="0" style="stop-color:#FF8759"/>\n\t\t\t\t\t\t\t<stop  offset="1" style="stop-color:#FF5B0F"/>\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t<path id="蒙版" fill="url(#file_ppt_2)" d="M13.8,0C14.5,0,15,0.5,15,1.2v15.6c0,0.7,0.5,1.2,1.2,1.2h-15C0.5,18,0,17.5,0,16.8V1.2\n\t\t\t\t\t\t\tC0,0.5,0.5,0,1.2,0H13.8z"/>\n\t\t\t\t\t\t<g id="编组-3" transform="translate(2.700000, 5.400000)">\n\t\t\t\t\t\t\t<g id="形状结合">\n\t\t\t\t\t\t\t\t<g id="path-3-link">\n\t\t\t\t\t\t\t\t\t<path id="path-3" d="M4.1,0l0,4.7l4.7,0l0,0.2C8.6,7.1,6.7,8.8,4.4,8.8C2,8.8,0,6.8,0,4.4C0,2.1,1.8,0.2,4.1,0z"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-3-link_1_">\n\t\t\t\t\t\t\t\t\t<path id="path-3_1_" fill="#FFCFC0" d="M4.1,0l0,4.7l4.7,0l0,0.2C8.6,7.1,6.7,8.8,4.4,8.8C2,8.8,0,6.8,0,4.4\n\t\t\t\t\t\t\t\t\t\tC0,2.1,1.8,0.2,4.1,0z"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<g id="形状结合_1_" transform="translate(4.950000, 0.000000)">\n\t\t\t\t\t\t\t\t<g id="path-5-link">\n\t\t\t\t\t\t\t\t\t<path id="path-5" d="M0.2,0c2,0.1,3.7,1.8,3.7,3.8l0-0.1H0.2L0.2,0z"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g id="path-5-link_1_">\n\t\t\t\t\t\t\t\t\t<path id="path-5_1_" fill="#FFFFFF" d="M0.2,0c2,0.1,3.7,1.8,3.7,3.8l0-0.1H0.2L0.2,0z"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</g>\n</svg>')}));var u=i(1923),p=i.n(u);window.tinymce.util.Tools.resolve("window.tinymce.PluginManager").add("video",(function(t){t.ui.registry.addButton("video",{title:"插入视频/音频",tooltip:"插入视频/音频",icon:"embed",onAction:()=>{t.execCommand("video")}}),t.addCommand("video",(function(){const e={title:"插入视频/音频",body:{type:"tabpanel",tabs:[{title:"视频链接",name:"link",items:[{type:"htmlpanel",html:'<div class="mce-video-tip">提示：仅支持KM视频应用以及腾讯视频中的视频链接</div>'},{type:"input",name:"insertVideo"},{type:"htmlpanel",html:'<div class="mce-video-loading"></div>'}]},{title:"上传视频",name:"upload",items:[{type:"htmlpanel",html:'<div class="swan-video-upload-modal">\n                      <input type="file" id="swan-fileupload" class="input-fileupload js-input-fileupload" value="上传视频" />\n                      <div class="swan-loading secondary hide js-swan-loading"><img src="/img/km_pictures/loading.gif" />视频准备上传中</div>\n                      <div class="swan-upload-progress hide js-upload-progress">\n                        <div class="progress-secondary">\n                          <div class="progress-bar"></div>\n                        </div>\n                        <ul class="file-info file-type-support clearfix">\n                          <li class="file-name single-line"></li>\n                          <li class="file-operate">\n                            <a href="javascript:void(0);" class="icon-stop bg-sprites-tinymce js-upload-stop" ></a>\n                            <a href="javascript:void(0);" class="icon-done bg-sprites-tinymce hide js-upload-done"></a>\n                          </li>\n                        </ul>\n                      </div>\n                      <div class="secondary">提示: 推荐mp4/flv/mov/mp3格式，大小2G以内</div>\n                    </div>'}]}]},buttons:[{text:"Ok",type:"submit",primary:!0},{text:"取消",onclick:"close",type:"cancel"}],onTabChange:(e,i)=>{if(r()(".mce-primary button").addClass("video_upload_btn"),r()(".mce-primary").css({width:"auto",right:63,left:"auto"}),"upload"===i.newTabName){let e=null;const i=[];let a=!0;r()(".js-input-fileupload").change(s=>{const n=s.target.files[0];if(n.size/1024/1024>2e3)return alert("文件大小异常，不超过2G"),!1;const o=n.name.substr(n.name.lastIndexOf(".")+1).toUpperCase(),c="."+o.toLowerCase(),d=["MP3","WAV","OGG"];if(-1===["WMV","WM","ASF","ASX","RM","RMVB","RA","RAM","MPG","MPEG","MPE","VOB","DAT","MOV","3GP","MP4","MP4V","M4V","MKV","AVI","FLV","F4V"].indexOf(o)&&-1===d.indexOf(o))return window.alert("不支持此格式文件"),!1;d.indexOf(o)>-1&&(a=!1);const u=new p.a({getSignature:function(){const t="/videos/get_vod_upload?MediaType="+(a?"video":"audio");return l.a.post(t).then(t=>t.data.signature)}});e=u.upload({mediaFile:n}),e.videoInfo&&(r()(".js-input-fileupload").addClass("hide"),r()(".js-swan-loading").removeClass("hide"),r()(".js-upload-progress .progress-bar").width(0)),e.on("media_progress",t=>{if(t.percent<=1){r()(".js-swan-loading").addClass("hide"),r()(".js-upload-progress").removeClass("hide");const e=100*t.percent+"%";r()(".js-upload-progress .progress-bar").width(e),r()(".js-upload-progress .file-name").text(n.name)}});r()(".js-upload-stop").on("click",(function(){if(!e)return!1;if(!confirm("关闭后视频将取消上传，你确定要关闭吗？"))return!1;e.cancel(),r()(".js-input-fileupload").removeClass("hide").val(""),r()(".js-upload-progress").addClass("hide"),e=void 0})),e.done().then(s=>{r()(".js-upload-stop").addClass("hide"),r()(".js-upload-done").removeClass("hide"),-1===i.indexOf(s.fileId)&&(i.push(s.fileId),l.a.post("/videos/report_vod_upload",{vod_file_id:s.fileId,name:n.name}).then(i=>{if(!(i.data&&0===i.data.result))return;const s=i.data.id||0;if(!t.contentDocument.getElementById("video-"+s)){const e=a?`<div><img class="jwplayer_wrapper" id="jwplayer_wrapper_${s}" data-videoid="${s}" src="/img/km_pictures/video.png" data-type="${c}" /></div>`:`<div><img class="jwplayer_audio_wrapper" id="jwplayer_wrapper_${s}" data-videoid="${s}" src="/img/km_pictures/audio.png" data-type="${c}" /></div>`;t.execCommand("mceInsertContent",!1,e),t.windowManager.close()}e=void 0}).catch(t=>{console.error(t)}))}).catch(t=>{console.error(t)})})}},onSubmit:e=>{const i=e.getData().insertVideo.trim();if(""===i)return;r()(".mce-video-loading").show();const a=new FormData;a.append("video_url",i),l.a.post("/videos/parse_video_url",a).then(e=>{r()(".mce-video-loading").hide();const{data:i}=e;if("fail"===(null==i?void 0:i.result))return window.alert(i.msg),void t.windowManager.close();if("km"!==(null==i?void 0:i.type)&&(null==i||!i.url))return void alert("这个视频地址被禁止访问！");let a="";"youku"===(null==i?void 0:i.type)||"qq"===(null==i?void 0:i.type)?a=`<embed src="//v.qq.com/txp/iframe/player.html?vid=${null==i?void 0:i.video_id}&amp;disableplugin=IframeBottomOpenClientBar,IframePauseRecommend" allowFullScreen="true" wmode="transparent" quality="high" width="650" height="510" align="middle" allowScriptAccess="always" type=""></embed>`:"km"===(null==i?void 0:i.type)&&(a=`<div><img class="jwplayer_wrapper" id="jwplayer_wrapper_${null==i?void 0:i.video_id}" data-videoid="${null==i?void 0:i.video_id}" src="/img/km_pictures/video.png" /></div>`),t.execCommand("mceInsertContent",!1,a),t.windowManager.close()})}};t.windowManager.open(e)}))}));var h=i(2029),m=i(2051),v=i(542);window.tinymce.util.Tools.resolve("tinymce.PluginManager").add("lximg",(function(t){let e=!1;t.addCommand("open_img_modal",()=>{let i=4;window.tinymceImgConfig&&(i=window.tinymceImgConfig.block||4),t.windowManager.open({title:"上传图片",size:"normal",body:{type:"panel",items:[{type:"htmlpanel",html:'<div id="tinymce-image-upload-form" style="padding: 20px;">\n                                <input type="file" name="file" id="tinymce-image-upload" multiple="multiple"\n                                accept="image/png, image/jpeg, image/jpg, image/gif">\n                                <div class="secondary" style="margin-top: 10px; line-height: 20px;">\n                                    <br>\n                                    1. 仅只支持JPEG、PNG、GIF格式的图片\n                                    <br />\n                                    2. 支持多图上传，每张图片大小不能超过30M\n                                </div>\n                            </div>'}]},buttons:[{text:"关闭",type:"cancel"},{text:"立即上传",type:"submit",primary:!0}],onSubmit:()=>{const{files:a}=document.getElementById("tinymce-image-upload");if(e)return!1;if(!a.length)return void t.vueContext.$toast("请先选择图片",{status:"warning",positon:"center"});r()(".tox-button")[2].innerHTML="上传中...",e=!0;const s=[],n=[],o=[],l=[];if(a.forEach(t=>{Object(h.a)(t)?Object(h.b)(t,m.a)?s.push(t):o.push(t):n.push(t)}),o.length>0){const i="<h4>以下图片大小超过30M限制：</h4>"+o[0].name;t.vueContext.$confirm(i,{title:"提示",needIcon:!1,noPadding:!1,closable:!0,cancelable:!1}),e=!1,r()(".tox-button")[2].innerHTML="上传"}if(s.length){s.forEach(t=>{t.uuid=Math.random().toString(36).substring(3,18),t.blobUrl=window.URL.createObjectURL(t),t.localImagesHtml=`<img class="km-cos-image-${t.uuid} km-cos-image-uploading" src="${t.blobUrl}">`});const a={},c=s.length;let d=0;const u=()=>{let e="";n.length&&(e+="<h4>以下图片格式无效：</h4>"+n.join("</br>")),o.length&&(e+="<h4>以下图片大小超过30M限制：</h4>"+o.join("</br>")),l.length&&(e+="<h4>以下图片上传失败，请稍后再试!</h4>"+l.join("</br>")),e?t.vueContext.$confirm(e,{title:"提示",needIcon:!1,noPadding:!1,closable:!0,cancelable:!1}):t.vueContext.$toast("上传成功！",{status:"success",positon:"center"})},p=()=>{d>=c-1?(r()(".tox-button")[2].innerHTML="立即上传",e=!1,setTimeout(()=>{t.windowManager.close()},0),u()):d+=1},h=[];Object(v.e)(s,{cb(e){e.forEach((e,i)=>{a[e.file.uuid]=e,a[e.file.uuid].blobUrl=window.URL.createObjectURL(e.file),h.push(e.file),t.execCommand("mceInsertContent",!1,e.localImagesHtml),f(i)})},errFn(t){console.log(t),r()(".tox-button")[2].innerHTML="立即上传",e=!1},block:i});const m=e=>{const i=r()(t.getDoc()).find(".km-cos-image-"+e.key);if(i){const t=e.preview_url||"";i.attr("src",t),i.removeClass()}window.URL.revokeObjectURL(e)},g=e=>{const i=r()(t.getDoc()).find(".km-cos-image-"+e.key);i&&(i.remove(),window.URL.revokeObjectURL(e))},f=async e=>{const i=a[s[e].uuid].url,n=s[e].name;try{await Object(v.b)(s[e],{uploadPath:i,successFn:t=>{t&&(a[s[e].uuid].preview_url=t,m(a[s[e].uuid]))},errFn:()=>{g(a[s[e].uuid]),l.push(n)}}),t.execCommand("mceAutoResize"),p()}catch(t){g(a[s[e].uuid]),l.push(n),p(),console.error(t)}}}}})}),t.ui.registry.addButton("lximg",{title:"上传图片",tooltip:"上传图片",icon:"image",onAction:()=>t.execCommand("open_img_modal")})}));var g={components:{editor:s.a},props:{value:{type:String,default:""},plugins:{type:Array,default:()=>["video","lximg"]},toolbars:{type:Array,default:()=>["video","lximg"]},configs:{type:Object,default:()=>{}},isLoad:{type:Boolean,value:!1},mode:{type:String,default:"normal"}},data:()=>({}),computed:{editorConfigs(){return{...Object(n.d)(),...this.configs,paste_enable_default_filters:!1,contextmenu:""}}},watch:{isLoad(t){t&&window.tinymce.activeEditor.setContent(this.value)}},mounted(){this.value&&window.tinymce.activeEditor.setContent(this.value)}},f=i(68),_=Object(f.a)(g,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("editor",{attrs:{plugins:t.plugins,toolbars:t.toolbars,configs:t.editorConfigs,mode:t.mode},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})}),[],!1,null,null,null);e.a=_.exports},2012:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2017),n=i(2008),o=Object(a.c)({name:"KbarNavigation",components:{Dropdown:n.a},filters:{},props:{activeNav:{type:String,default:"main"},groupIdProp:{type:[String,Number],default:""},noSetTitle:{type:Boolean,default:!1}},setup:()=>({}),data:()=>({kbarBigDefaultPic:"https://assets.km.tencent.com/ImageHosting/20221222/5e2b94ec21d713c4685a08e20426f7e1.png",showQuitArea:!1,canQuitKbar:-1,canJoinKbar:-1,quitTimer:null,awardTimer:null,qrCodeUrl:"",qrCodeShow:!1,awardData:null,kbarGrowInfo:null,kbarGrowShow:!1,awardTipsShow:!1}),computed:{kbarBasicData(){const t=this.$store.getters["kbar/getKbarBasicData"]||{};return t.activeName&&!this.noSetTitle&&(document.title=t.activeName),t},nick(){return this.$store.getters["global/userInfo"]?this.$store.getters["global/userInfo"].user_info.nick:""},groupId(){return this.groupIdProp||this.$store.getters["kbar/getGroupId"]||""},groupNumId(){return this.$store.getters["kbar/getGroupNumId"]||""}},watch:{groupId(){this.initNav()}},created(){this.$store.commit("kbar/setInCommonGroupNav",!0)},mounted(){this.initNav(),this.initAward()},updated(){this.$emit("navUpdate")},methods:{clickChildItem(t){const e=t.is_blank?t.app_url:`/group/${this.kbarBasicData.group.id}/${t.app_url}`;t.is_blank?window.open(e,"_blank"):window.location.href=e},getCreateUrl(t){const e="group/"+this.kbarBasicData.group.id,i="knowledges/add"===t.action_url?`/vkm/${e}/knowledges/create`:`/${e}/${t.action_url}`;return t.is_blank?t.app_url:i},fetchDefaultImg(t){const e=t.target.src||"";if(!e||e===this.kbarBigDefaultPic)return;t.srcElement.src=this.kbarBigDefaultPic},toggleGrowStatus(t){this.kbarGrowShow=t},toggleAwardStatus(t){t?(this.awardTimer&&clearTimeout(this.awardTimer),this.awardTipsShow=!0):this.awardTimer=setTimeout(()=>{this.awardTipsShow=!1},300)},toggleQuitStatus(t){t?(this.quitTimer&&clearTimeout(this.quitTimer),this.showQuitArea=!0):this.quitTimer=setTimeout(()=>{this.showQuitArea=!1},500)},focusQuitStatus(t){t?this.quitTimer&&(clearTimeout(this.quitTimer),this.showQuitArea=!0):this.showQuitArea=!1},fetchKbarGrowInfo(){this.$store.dispatch("kbar/fetchKbarGrowInfo").then(t=>{this.kbarGrowInfo=t}).catch(()=>{})},initQuitStatus(){this.$store.dispatch("kbar/fetchKbarQuitStatus").then(t=>{const e=Number(t.can_quit),i=Number(t.can_join);this.canQuitKbar=0===e?0:1,this.canJoinKbar=0===i?0:1}).catch(()=>{this.canQuitKbar=-1,this.canJoinKbar=-1})},initAward(){this.$store.dispatch("kbar/fetchKbarAwardList").then(t=>{const e=t.value;if(!e)return;const i=JSON.parse(e);let a=null;const s=(new Date).getTime();for(let t=0;t<i.length;t++)if(i[t].groups&&i[t].groups.includes(""+String(this.groupId))&&s>=i[t].beginTime&&s<=i[t].endTime){a=i[t];break}this.awardData=a}).catch(()=>{})},initNav(){this.$store.commit("kbar/setIsFetchKbarBasicData",!1),this.$store.dispatch("kbar/fetchKbarBasicData",{id:this.groupId,activeNav:this.activeNav}).then(()=>{this.fetchKbarGrowInfo(),this.initQuitStatus(),Object(s.a)(`${this.kbarBasicData.group.pkmPath}group/${this.kbarBasicData.group.id}`,{margin:0}).then(t=>this.qrCodeUrl=t).catch(t=>console.error(t))}).catch(t=>{if(t&&t.code){let e=0;1001===t.code?e=1:1002!==t.code&&1003!==t.code||(e=2),this.$store.commit("global/SET_ERROR_PAGE_CODE_INFO",{errType:e,code:t.code,message:t.message||"访问出错啦，请稍后重试: "+t.code})}}).finally(()=>{this.$store.commit("kbar/setIsFetchKbarBasicData",!0)})},joinKbarAsync(t){this.$store.dispatch("kbar/joinKbarAsync",{id:t.group.id}).then(()=>{this.initNav()}).catch(()=>{console.log("join error")})},quitKbarAsync(t){this.$store.dispatch("kbar/quitKbarAsync",{id:t.group.id}).then(()=>{window.location.href=window.location.href}).catch(()=>{console.log("quit error")})},clickKbarBtn(t){(t.is_admin||t.is_group_admin)&&(window.location.href=`/group/${t.group.id}/admin_edit`)},quitKbarBtn(t){window.location.href=`/group/${t.group.id}/quit`}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"kbar-navigation-container"},[t.kbarBasicData&&t.kbarBasicData.list&&t.kbarBasicData.group?i("div",{staticClass:"outer-wrapper",style:{"background-image":"url("+t.kbarBasicData.group.banner_url+"&imageMogr2%2Fthumbnail%2F3840x%3E%2Fignore-error%2F1)"}},[i("div",{staticClass:"content-wrapper"},[i("div",{staticClass:"position-area"},[i("div",{staticClass:"avatar"},[i("a",{attrs:{href:"/group/"+t.kbarBasicData.group.id}},[i("img",{attrs:{src:t.kbarBasicData.group.logo||t.kbarBigDefaultPic},on:{error:t.fetchDefaultImg}})])]),t._v(" "),i("div",{staticClass:"right-info"},[i("div",{staticClass:"kbar-name"},[i("div",{staticClass:"k-title"},[i("a",{attrs:{href:"/group/"+t.kbarBasicData.group.id}},[t._v(t._s(t.kbarBasicData.group.name))])]),t._v(" "),t.awardData?i("div",{staticClass:"award-img-list",on:{mouseenter:function(e){return t.toggleAwardStatus(!0)},mouseleave:function(e){return t.toggleAwardStatus(!1)}}},[t.awardData.icon?i("img",{staticClass:"medal-icon",attrs:{src:t.awardData.icon,alt:""}}):t._e(),t._v(" "),t.awardData.textUrl?i("img",{staticClass:"medal-text",attrs:{src:t.awardData.textUrl,alt:""}}):t._e(),t._v(" "),t.awardTipsShow?i("div",{staticClass:"medal-tips-area"},[t._m(0)]):t._e()]):t._e(),t._v(" "),i("div",{staticClass:"kbar-icon-list"},[1===t.kbarBasicData.group.access_level?i("div",{staticClass:"tag-icon"},[i("svg-icon",{attrs:{name:"kbar/private_tag",width:24,height:24}}),t._v(" "),t._m(1)],1):t._e(),t._v(" "),1===t.kbarBasicData.group.is_hot?i("div",{staticClass:"tag-icon"},[i("svg-icon",{attrs:{name:"kbar/hot_tag",width:24,height:24}}),t._v(" "),t._m(2)],1):t._e()]),t._v(" "),i("div",{staticClass:"kbar-level-container"},[t.kbarBasicData.group.group_degree?i("div",{staticClass:"kbar-level-area"},[i("a",{staticClass:"new-group-level",attrs:{target:"_blank",href:t.kbarGrowInfo&&t.kbarGrowInfo.remark_url||"/"},on:{mouseenter:function(e){return t.toggleGrowStatus(!0)},mouseleave:function(e){return t.toggleGrowStatus(!1)}}},[i("span",{staticClass:"level-text"},[t._v(t._s("Lv "+t.kbarBasicData.group.group_degree))])])]):t._e(),t._v(" "),t.kbarGrowInfo&&t.kbarGrowShow?i("div",{staticClass:"new-grow-list-area"},[i("div",{staticClass:"new-grow-item"},[i("span",{staticClass:"grow-name"},[t._v("当前积分:")]),t._v(" "),i("span",{staticClass:"grow-score"},[t._v(t._s(t.kbarGrowInfo.score))])]),t._v(" "),i("div",{staticClass:"new-grow-item"},[i("span",{staticClass:"grow-name"},[t._v("升级需要分数:")]),t._v(" "),i("span",{staticClass:"grow-score"},[t._v(t._s(t.kbarGrowInfo.up_level_score))])])]):t._e()])]),t._v(" "),i("div",{staticClass:"ope-btn"},[t.kbarBasicData.is_admin||t.kbarBasicData.is_group_admin?i("div",{staticClass:"join-area",on:{click:function(e){return t.clickKbarBtn(t.kbarBasicData)}}},[i("span",{staticClass:"btn-text"},[t._v("\n                管理K吧\n              ")])]):1===t.canJoinKbar?i("div",{staticClass:"join-area",on:{click:function(e){return t.joinKbarAsync(t.kbarBasicData)}}},[i("svg-icon",{staticClass:"join-icon",attrs:{name:"kbar/attention",width:16,height:16}}),t._v(" "),i("span",{directives:[{name:"group-in",rawName:"v-group-in",value:{group_id:t.groupNumId},expression:"{ group_id: groupNumId }"}],staticClass:"btn-text"},[t._v("\n                加入K吧\n              ")])],1):t.kbarBasicData.is_member?i("div",{staticClass:"quit-btn join-area",on:{click:function(e){return t.clickKbarBtn(t.kbarBasicData)},mouseenter:function(e){return t.toggleQuitStatus(!0)},mouseleave:function(e){return t.toggleQuitStatus(!1)}}},[i("span",{staticClass:"btn-text"},[t._v("\n                已加入\n              ")]),t._v(" "),i("svg-icon",{staticClass:"quit-icon",class:t.showQuitArea?"quit-icon-up":"",attrs:{name:"kbar/quit_down",width:16,height:16}})],1):t._e(),t._v(" "),1===t.canQuitKbar&&t.showQuitArea?i("div",{staticClass:"quit-tips-area",on:{mouseenter:function(e){return t.focusQuitStatus(!0)},mouseleave:function(e){return t.focusQuitStatus(!1)}}},[i("div",{staticClass:"quit-entry",on:{click:function(e){return t.quitKbarAsync(t.kbarBasicData)}}},[i("span",{directives:[{name:"group-out",rawName:"v-group-out",value:{group_id:t.groupNumId},expression:"{ group_id: groupNumId }"}]},[t._v("退出")])])]):0===t.canQuitKbar&&t.showQuitArea?i("div",{staticClass:"no-quit-tips-area"},[i("span",[t._v("此K吧已经关联组织架构，不允许退出")])]):t._e(),t._v(" "),i("div",{staticClass:"qrcode-area",on:{mouseenter:function(e){t.qrCodeShow=!0},mouseleave:function(e){t.qrCodeShow=!1}}},[i("svg-icon",{staticClass:"qrcode-icon",attrs:{name:"kbar/qrcode",width:20,height:20}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.qrCodeShow,expression:"qrCodeShow"}],staticClass:"qr-code-container"},[i("img",{staticClass:"qr-code-img",attrs:{src:t.qrCodeUrl}}),t._v(" "),i("div",{staticClass:"qr-text"},[t._v("\n                  扫一扫，手机上K吧\n                ")])])],1)])])]),t._v(" "),i("div",{staticClass:"links-area"},[i("ul",{staticClass:"nav-list"},[i("li",{staticClass:"nav-item",class:"main"===t.activeNav?"active-tab-item":""},[i("div",{staticClass:"tab-item"},[i("a",{staticClass:"jump-url",attrs:{href:"/group/"+t.kbarBasicData.group.id}},[i("span",{staticClass:"nav-name"},[t._v("首页")])])])]),t._v(" "),t._l(t.kbarBasicData.list,(function(e){return i("li",{key:e.kid,staticClass:"nav-item",class:e.app_code===t.activeNav||e.code===t.activeNav?"active-tab-item":""},[e.action_url&&e.action_show?i("a",{staticClass:"action-add-entry",attrs:{href:t.getCreateUrl(e),title:"添加"+e.name,target:"_blank"}},[i("span",{staticClass:"action-add-icon"},[i("svg-icon",{attrs:{name:"kbar/action_add",width:12,height:12}})],1)]):t._e(),t._v(" "),e.moreTag?i("dropdown",{staticClass:"tab-item dropdown-tab-item",attrs:{"item-list":t.kbarBasicData.childList,"item-position":"center"},on:{clickItem:function(e){var i=e.item;return t.clickChildItem(i)}}},[i("a",{staticClass:"jump-url more-hover-item"},[i("span",{staticClass:"nav-name"},[t._v(t._s(e.app_name))]),t._v(" "),i("svg-icon",{staticClass:"more-icon",attrs:{name:"kbar/down_arr",width:16,height:16}})],1)]):i("div",{staticClass:"tab-item"},[i("a",{staticClass:"jump-url",attrs:{href:e.is_blank?e.app_url:"/group/"+t.kbarBasicData.group.id+"/"+e.app_url,target:e.is_blank?"_blank":""}},[i("span",{staticClass:"nav-name"},[t._v(t._s(e.app_name))])])])],1)}))],2)])])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"award-item"},[e("span",{staticClass:"award-name"},[this._v("\n                    才高八斗奖、步步高升奖、活力四射奖、匠心独具奖为优秀K吧奖项，每季度进行评选——\n                  ")]),this._v(" "),e("a",{staticClass:"awardLink",attrs:{target:"_blank",href:"https://km.tencent.com/openkm/url/zl2hkv"}},[this._v("\n                    《万元奖金+千万流量，赢取K吧专属荣耀！》\n                  ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"position-tips"},[e("span",[this._v("保密K吧")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"position-tips"},[e("span",[this._v("活跃K吧")])])}],!1,null,"744df601",null);e.a=l.exports},2013:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a={COLLECTED_ARTICLES:"?kmref=vkm_knowledges"},s=()=>a,n=(t,e,i)=>{t.$toast(e,{status:i,positon:"center"})}},2014:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=i(2006),o=Object(a.c)({name:"km-modal",components:{Dialog:s.Dialog,KmButton:n.a},props:{showModal:{require:!0,default:!1},title:{require:!1,default:"标题"},cancelText:{require:!1,default:"取消"},submitText:{require:!1,default:"提交"},width:{require:!1,default:"600px"},closeOnClickModal:{require:!1,default:!0},top:{require:!1,default:"15vh"},appendToBody:{require:!1,default:!1},modalAppendToBody:{require:!1,default:!0},headerSvg:{type:String,default:""},minBodyHeight:{type:Number,default:216},maxBodyHeight:{type:Number,default:548},autoHeight:{type:Boolean,default:!1}},setup(t,e){const i=Object(a.r)({}),{minBodyHeight:s,maxBodyHeight:n,autoHeight:o}=t;return Object(a.m)(()=>{const t=.6*window.innerHeight;if(o){const e=t>n?n:t;i.value={"max-height":e+"px","min-height":s+"px",overflow:"auto"}}}),{contentHeightStyle:i,onClose:()=>{e.emit("onCloseModal")},onSubmit:()=>{e.emit("onSubmitModal")}}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"km-modal",attrs:{"close-on-click-modal":t.closeOnClickModal,"append-to-body":t.appendToBody,"modal-append-to-body":t.modalAppendToBody,"show-close":!1,visible:t.showModal,"lock-scroll":!1,width:t.width,top:t.top},on:{close:t.onClose}},[i("template",{slot:"title"},[t._t("title",(function(){return[i("div",{staticClass:"modal-header"},[i("div",{staticClass:"modal-header__title"},[t.headerSvg?i("svg-icon",{staticClass:"title-svg",attrs:{name:t.headerSvg,width:24,height:24}}):t._e(),t._v(" "),i("span",{staticClass:"title-text"},[t._v(t._s(t.title))])],1),t._v(" "),i("span",{staticClass:"close-icon-container",on:{click:t.onClose}},[i("svg-icon",{staticClass:"close-icon",attrs:{name:"entry/close",color:"#333333",width:20,height:20,viewBox:"0 0 20 20"}})],1)])]}))],2),t._v(" "),i("div",{style:t.contentHeightStyle},[t._t("default")],2),t._v(" "),i("template",{slot:"footer"},[t._t("footer",(function(){return[i("km-button",{staticClass:"submit-button",attrs:{size:"small"},on:{click:t.onSubmit}},[t._v(t._s(t.submitText))]),t._v(" "),i("km-button",{staticClass:"cancel-button",attrs:{size:"small",type:"secondary"},on:{click:t.onClose}},[t._v(t._s(t.cancelText))])]}))],2)],2)}),[],!1,null,"57722fc6",null);e.a=l.exports},2015:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(11),i(12),i(13),i(14),i(15);const a=(t,e={toastMessage:"操作成功",noToast:!1,positon:"center"})=>(i,a=(()=>{}))=>{if(0!==i.code){var s;const a=(null==i||null===(s=i.data)||void 0===s?void 0:s.trace_error)||i.message;e.noToast?console.error("API error:",a):t.$toast(a,{status:"error",positon:e.positon||"center"})}else!e.noToast&&t.$toast(e.toastMessage,{status:"success",positon:e.positon||"center"}),a(i)}},2016:function(t,e,i){"use strict";i.d(e,"d",(function(){return v})),i.d(e,"b",(function(){return _})),i.d(e,"e",(function(){return g})),i.d(e,"c",(function(){return f})),i.d(e,"a",(function(){return h}));i(11),i(12),i(13),i(14),i(15);var a=i(1899),s=i.n(a),n=i(1923),o=i.n(n),r=i(2081),l=i.n(r),c=i(7),d=i(2009),u=i(2082);let p=[];const h=()=>p,m=t=>{p.forEach(t=>{null==t||t.dispose()}),p=[],s()("embed").each((function(){const t=this.src||"";if(t.indexOf("imgcache.qq.com/tencentvideo_v1/playerv3/")>-1){this.src=t.replace("http://","https://");const e=this.parentNode.clientWidth||788,i=Math.round(9*e/16);s()(this).width(e),s()(this).height(i)}t.includes("//v.qq.com/txp/iframe/player.html")&&(this.outerHTML=`<iframe src="${this.src}" allowFullScreen="true" width="${this.width}"  height="${this.height}"  frameBorder="0"> </iframe>`)}));const e=s()(".swan-video-container").length+s()(".jwplayer_wrapper").length+s()(".jwplayer_audio_wrapper").length;function i(t,e,i,a){return`<div class="swan-video-container error" style="width: ${t}px; height: ${e}px;">\n         <div \n            class="video-wording" \n            style="text-align:center;\n            font-size:17px;\n            color:white;\n            background-color:black;\n            width: ${t}px;\n            height: ${e}px;\n            line-height: ${e}px; \n            margin-left:${a?a.style.marginLeft:"auto"}; \n            margin-right:${a?a.style.marginRight:"auto"}; \n            float:${a?a.style.float:"unset"};"\n        >\n            ${i}\n        </div> \n     </div>`}function a(t,a,n,o){let r=788,c=60;n?(r=t.parentNode.clientWidth||788,c=60):(r=t.parentNode.clientWidth||788,c=Math.round(9*r/16));const d={video_ids:[a]};o&&(d.vtype="attachement"),s.a.post(window.KMCONFIG.kmApi+"/videos/get_vod_play",d,(function(s){if(s&&s.length){const o=s[0];if("converted"===o.status){const i=a;t.outerHTML=function(t,e,i,a){return`<video \n          class="swan-video-container" \n          id="swan-video-${t}" \n          style="width: ${e}px; height: ${i}px; margin-left:${a?a.style.marginLeft:"auto"}; margin-right:${a?a.style.marginRight:"auto"};float:${a?a.style.float:"unset"};">\n        </video>`}(i,r,c,t);const s="swan-video-"+a,d={appID:o.app_id||0,fileID:o.file_id,width:r,height:c,psign:o.psign,licenseUrl:o.license_url};n?(d.controlBar={volumePanel:!1,playbackRateMenuButton:!0,fullscreenToggle:!1,QualitySwitcherMenuButton:!1},d.inactivityTimeout=-1):d.plugins={ContinuePlay:{}};const u=l()(s,d);u.on("resolutionswitching",(function(){})),u.on("resolutionswitched",(function(){})),p.push(u),p.length===e&&window.dispatchEvent(new CustomEvent("playerAllInit",{}))}else"failed"===o.status?t.outerHTML=i(r,c,"转码失败, 需重新上传",t):t.outerHTML=i(r,c,"正在转码中，预计半小时内完成，稍后请手动刷新",t)}else t.outerHTML=i(r,c,"找不到视频, 需重新上传",t)}),"json")}s()(".swan-video-container").each((function(){const t=s()(this),e=t.attr("id"),i=t.hasClass("new_tcvod_audio");a(this,e&&e.match(/video-(\w+)/)?this.id.match(/video-(\w+)/)[1]:0,i,"attachement"===s()(this).data("vtype"))})),t&&(s()(".jwplayer_wrapper").each((function(){const t="attachement"===s()(this).data("vtype");a(this,s()(this).data("videoid"),!1,t)})),s()(".jwplayer_audio_wrapper").each((function(){const t="attachement"===s()(this).data("vtype");a(this,s()(this).data("videoid"),!0,t)})))},v=()=>{m(!0);const t=[],e=[];s()(".jwplayer_wrapper").each((function(){t.push(s()(this).data("videoid"))})),s()(".jwplayer_audio_wrapper").each((function(){e.push(s()(this).data("videoid"))}));t.length;s()(".qq_video").each((function(){const t=s()(this).attr("vid"),e=this.parentNode.clientWidth||788,i=Math.round(9*e/16);t&&(this.outerHTML=`<iframe\n       src="//v.qq.com/txp/iframe/player.html?vid=${t}&disableplugin=IframeBottomOpenClientBar,IframePauseRecommend" allowFullScreen="true"\n       width="${e}"\n       height="${i}"\n       frameBorder="0">\n      </iframe>`)}));e.length},g=()=>Object(u.a)("/vkm/flash/jwplayer.js","jsplayer").then(()=>{window.jwplayer&&(window.jwplayer.key="45FoKzf1Cs2kfDRORgBWOt2UiQfyLV5d+Un74g==")}),f=({isVideo:t,mediaFile:e,onUploading:i,onFinishedUpload:a})=>{const s=new o.a({getSignature:()=>function(t){const e="/videos/get_vod_upload?MediaType="+(t?"video":"audio");return c.a.post(e).then(t=>t.data.signature)}(t)}).upload({mediaFile:e});return s.on("media_progress",(function(t){console.log(t.percent),i(t)})),s.done().then((function(t){a(t)})).catch((function(t){console.log("err",t)})),s},_=(t,e)=>Object(d.x)(t).then(({data:i})=>{if(i&&i[0]){const a=i[0];if("converted"===a.status){const i={appID:a.app_id||0,fileID:a.file_id,psign:a.psign,licenseUrl:a.license_url};e?i.controlBar={volumePanel:!1,playbackRateMenuButton:!1,fullscreenToggle:!1,QualitySwitcherMenuButton:!1}:i.plugins={ContinuePlay:{}};return{playHandleId:"swan-video-"+t,ops:i,status:"success"}}return"failed"===a.status?{status:"error",errMsg:"转码失败, 需重新上传"}:{status:"error",errMsg:"正在转码中，预计半小时内完成，稍后请手动刷新"}}return{errMsg:"找不到视频, 需重新上传"}})},2017:function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return d})),i.d(e,"c",(function(){return u}));i(11),i(12),i(13),i(14),i(15);var a=i(1899),s=i.n(a),n=i(1934),o=i.n(n),r=i(168),l=i(2031);const c=(t={})=>{const{rangeDom:e,callback:i,viewContentWidth:a,contentSelector:n,isRemoveAlt:o=!0,isTargetBlankView:c=!0}=t,d=n||".km-view-content",u=e?e.find(d+" img"):s()(d+" img");u.each((function(){const t=this;(t=>{const e=Object(r.i)(t.getAttribute("data-src"));t.setAttribute("data-origin-width",e.width||0),t.setAttribute("data-origin-height",e.height||0),t.setAttribute("data-no-src","true");if(t.getAttribute("width"))return;const i=a||s()(""+d).width()||760;if(e.width>i&&i>0){const a=i/e.width,s=e.height*a;t.width=i,t.height=s}else e.width&&e.width>0&&(t.width=e.width),e.height&&e.height>0&&(t.height=e.height)})(t),t.onload=function(){(t=>{const e=s()(t);e.parent()[0]&&"A"!==e.parent()[0].tagName&&(e.addClass("amplify"),s()(".km-view-content").hasClass("no-compression-img")||(e[0].onclick=function(){c?window.open(t.src):l.a.show({src:t.src})})),t.removeAttribute("data-no-src"),i&&i(),t.onload=null})(t)},o&&t.getAttribute("alt")&&t.removeAttribute("alt")}))},d=(t,e=null)=>e?o.a.toDataURL(t,e):o.a.toDataURL(t),u=t=>{const e=document.querySelectorAll(t);e.forEach(t=>{t.removeAttribute("data-have-load")});const i=new IntersectionObserver((function(t){t.forEach(t=>{if(t.intersectionRatio>0){(t=>{const e=t.getAttribute("data-src"),i=t.getAttribute("data-have-load");t.removeAttribute("data-no-src"),e&&!i&&(t.src=e,t.setAttribute("data-have-load",!0))})(t.target)}})}),{rootMargin:"800px 0px"});e.forEach(t=>{i.observe(t)})}},2018:function(t,e,i){"use strict";i.d(e,"e",(function(){return o})),i.d(e,"f",(function(){return r})),i.d(e,"p",(function(){return l})),i.d(e,"j",(function(){return c})),i.d(e,"a",(function(){return d})),i.d(e,"t",(function(){return u})),i.d(e,"s",(function(){return p})),i.d(e,"m",(function(){return h})),i.d(e,"q",(function(){return m})),i.d(e,"h",(function(){return v})),i.d(e,"o",(function(){return g})),i.d(e,"c",(function(){return f})),i.d(e,"d",(function(){return _})),i.d(e,"g",(function(){return b})),i.d(e,"k",(function(){return y})),i.d(e,"v",(function(){return w})),i.d(e,"i",(function(){return C})),i.d(e,"r",(function(){return k})),i.d(e,"l",(function(){return O})),i.d(e,"n",(function(){return x})),i.d(e,"b",(function(){return j})),i.d(e,"u",(function(){return I}));i(11),i(12),i(13),i(14),i(15);var a=i(7),s=i(81),n=i.n(s);const o=t=>a.a.post("/km_bff/article/v1/create_knowledge",t),r=t=>a.a.post("/km_bff/article/v1/delete_knowledge",t),l=t=>a.a.post("/km_bff/article/v1/get_knowledge_read_count",t),c=t=>a.a.post("/km_bff/article/v1/get_knowledge_members",t),d=t=>a.a.post("/km_bff/article/v1/add_knowledge_member",t),u=t=>a.a.post("/km_bff/article/v1/remove_knowledge_member",t),p=t=>a.a.post("/km_bff/article/v1/transfer_knowledge_owner",t),h=()=>a.a.post("/km_bff/article/v1/list_manageable_knowledges"),m=t=>a.a.post("/km_bff/article/v1/list_knowledge_columns",{knowledge_id:t}),v=({entities:t})=>a.a.post("/km_bff/article/v1/get_knowledge_entity_info",{entities:t}),g=t=>a.a.post("/km_bff/article/v1/list_target_accepted_knowledges",t),f=(t,e)=>a.a.get(`knowledges/post2knowledge?column_id=${e}&post_id=${t}`,{headers:{"x-km-api-version":"std"}}),_=t=>a.a.post("/km_bff/article/v1/add_knowledge_menu_node",t),b=({groupId:t,rtx:e})=>a.a.post("/km_bff/auth/v1/auth_entry",{access_entry:{target_id:t,target_type:"knowledge",nick:e,action:"add"}}),y=({groupId:t,knwlId:e})=>{const i=t?`group/${t}/`:"";return a.a.get(`/actions?target_type=Knowledge&target_id=${e}&group_id=${t}&url_prefix=${i}`,{headers:{"x-km-api-version":"std"}})},w=({userToken:t,knowledgeId:e,pushClans:i})=>{const s={csrf_token:t,knowledge_id:e};return i&&i.length>0&&(s.push_clans=i),a.a.post("/operations/knowledges_addmailpool",n.a.stringify(s),{headers:{"x-km-api-version":"std","X-Csrf-Token":t}})},C=({limit:t=20,page:e=1,orderBy:i="created",isDesc:s=!0,categoryId:n,ownedBy:o,isRecommended:r=0,memberedBy:l,bookmarkedBy:c,groupId:d})=>a.a.post("/km_bff/article/v1/list_knowledges",{limit:t,page:e,order_by:i,is_desc:s,category_id:n,owned_by:o,group_id:d,is_recommended:r,membered_by:l,bookmarked_by:c}),k=t=>{const e=` {\n    ownedCount: knowledge_list_knowledges(owned_by:"${t}",limit:0){\n      pagination{\n        total\n      }\n    }\n    memberedCount: knowledge_list_knowledges(membered_by:"${t}",limit:0){\n      pagination{\n        total\n      }\n    }\n    bookmarkedCount: knowledge_list_knowledges(bookmarked_by:"${t}",limit:0){\n      pagination{\n        total\n      }\n    }\n  }`;return a.a.post("/km_bff/graphql/v1/get",{query:e})},O=t=>a.a.post("/km_bff/article/v1/is_knowledge_access_limited",{knowledge_ids:t}),x=t=>a.a.post("/km_bff/article/v1/recommend_knowledge_tags",{knowledge_id:t}),j=(t,e)=>a.a.post("/knowledges/apply_for_building/"+t,{reason:e}),I=(t,e)=>a.a.post("knowledges/send_add_builder_msg",{knowledge_id:t,receiver:e})},2019:function(t,e,i){"use strict";i.d(e,"e",(function(){return a})),i.d(e,"i",(function(){return s})),i.d(e,"h",(function(){return n})),i.d(e,"p",(function(){return o})),i.d(e,"g",(function(){return r})),i.d(e,"q",(function(){return l})),i.d(e,"a",(function(){return c})),i.d(e,"o",(function(){return d})),i.d(e,"b",(function(){return u})),i.d(e,"c",(function(){return p})),i.d(e,"d",(function(){return h})),i.d(e,"n",(function(){return m})),i.d(e,"f",(function(){return v})),i.d(e,"k",(function(){return g})),i.d(e,"l",(function(){return f})),i.d(e,"j",(function(){return _})),i.d(e,"m",(function(){return b}));i(11),i(12),i(13),i(14),i(15);const a=[{label:"按时间",value:"created_at desc"},{label:"近期最热",value:"hot_value desc"},{label:"按浏览",value:"read_count desc"},{label:"按收藏",value:"favorite_count desc"},{label:"按评论",value:"comment_count desc"}],s=[{label:"按时间",value:"created_at desc"},{label:"近期最热",value:"hot_value desc"},{label:"按浏览",value:"read_count desc"},{label:"按回答",value:"reply_count desc"}],n=[{label:"按时间",value:"created_at desc"},{label:"按浏览",value:"read_count desc"}],o=[{label:"按时间",value:"created_at desc"},{label:"按相关度",value:"similarity desc"}],r=[{label:"按时间",value:"created_at"},{label:"按相关度",value:"default"}],l=[{label:"按时间",value:"created_at desc"},{label:"按播放量",value:"read_count desc"}],c={pin:"置顶了",unpin:"取消置顶了",add_active_user:"添加了",add_group:"添加了",add_knowledge:"添加了",add_related_entries:"添加了",cancel_black:"恢复了",black:"移除了",add_entry:"新增了词条",update_entry:"修改了词条"},d={article:"相关文章",question:"相关乐问",group:"相关K吧",active_user:"活跃用户",knowledge:"相关文集",related_entries:"相关词条"},u=["pin","unpin","add_active_user","add_group","add_knowledge","cancel_black","black","add_related_entries"],p=["add_entry","update_entry"],h=["feedback"],m=[{key:"home",label:"首页"},{key:"related-knowledges",label:"文集"},{key:"related-articles",label:"文章"},{key:"related-questions",label:"乐问"}],v=[{key:"related-entry",label:"词条"},{key:"manager",label:"管理员"},{key:"active-users",label:"活跃用户"},{key:"related-groups",label:"K吧"}],g={key:"related-mk",label:"码客"},f={key:"related-tech-map",label:"技术图谱"},_={key:"related-iwiki",label:"iWiki"},b={key:"related-videos",label:"视频"}},2020:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({props:{errorText:{type:String,default:"暂无权限"},isFull:{type:Boolean,default:!0},height:{type:[Number,String],default:""},width:{type:[Number,String],default:""},zIndex:{type:Number,default:1024}},components:{},setup:t=>({containerStyle:Object(a.a)(()=>{const e={};return t.height&&(e.height=t.height+"px"),t.width&&(e.width=t.width+"px"),t.isFull&&(e.zIndex=t.zIndex),e})})}),n=i(68),o=Object(n.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"error-show",class:this.isFull?"error-show-full ":"error-show-inner",style:this.containerStyle},[e("div",{staticClass:"info"},[e("div",{staticClass:"background"}),this._v(" "),e("div",{staticClass:"info-text"},[this._v(this._s(this.errorText))])])])}),[],!1,null,"5aa90078",null);e.a=o.exports},2021:function(t,e,i){"use strict";i.d(e,"i",(function(){return a})),i.d(e,"g",(function(){return s})),i.d(e,"h",(function(){return n})),i.d(e,"j",(function(){return o})),i.d(e,"n",(function(){return r})),i.d(e,"k",(function(){return l})),i.d(e,"o",(function(){return c})),i.d(e,"l",(function(){return d})),i.d(e,"m",(function(){return u})),i.d(e,"d",(function(){return p})),i.d(e,"p",(function(){return h})),i.d(e,"a",(function(){return m})),i.d(e,"q",(function(){return v})),i.d(e,"b",(function(){return g})),i.d(e,"c",(function(){return f})),i.d(e,"f",(function(){return _})),i.d(e,"e",(function(){return b})),i.d(e,"r",(function(){return k})),i.d(e,"s",(function(){return j}));i(11),i(12),i(13),i(14),i(15);const a=255,s=10,n=100,o={title:"",coverUrl:"",category:"",groupId:0,authType:"",style:"menu"},r={title:[{required:!0,message:"请输入文集标题"},{validator:(t,e,i)=>e.length<=a?i():i(new Error(`文集标题限${a}字内`))}],category:[{required:!0,message:"请选择文集分类"}],authType:[{required:!0,message:"请选择文集类型"}],style:[{required:!0,message:"请选择文集风格"}]},l={title:"",introduction:"",coverUrl:"",category:"",authType:"",labels:[],applyBuilding:"open"},c={title:[{required:!0,message:"请输入文集标题"},{validator:(t,e,i)=>e.length<=a?i():i(new Error(`文集标题限${a}字内`))}],category:[{required:!0,message:"请选择文集分类"}],authType:[{required:!0,message:"请选择文集类型"}],tags:[{required:!0,message:"请选择文集标签"},{validator:(t,e,i)=>e.length>0?i():i(new Error("请选择文集标签"))}],style:[{required:!0,message:"请选择文集风格"}]},d=[{value:"public",label:"公开"},{value:"private",label:"保密"}],u={public:"所有人可以访问",private:"仅文集成员可以访问"},p=[{value:"open",label:"开启"},{value:"close",label:"关闭"}],h=[{value:1,label:"文集信息"},{value:2,label:"文集成员"}],m=[{value:1,label:"KM搜索"},{value:2,label:"个人文章"},{value:3,label:"链接添加"}],v=[{value:1,label:"默认背景"},{value:2,label:"自定义背景"}],g=[1,2],f={1:"km",2:"user"},_={Post:"article"},b=["https://assets.km.tencent.com/ImageHosting/20221201/000aaa6209a3e6c38201844e2e1dac88.png","https://assets.km.tencent.com/ImageHosting/20221201/d0feef11ee967c92e08f91783f04022c.png","https://assets.km.tencent.com/ImageHosting/20221201/a498d171af16cdde92a068fa00e0b292.png","https://assets.km.tencent.com/ImageHosting/20221201/52b2002b32173c29cdfb081237cacca2.png","https://assets.km.tencent.com/ImageHosting/20221201/dac177032ecbfaca7b7922ba2fb850b5.png","https://assets.km.tencent.com/ImageHosting/20221201/a092cc988c315d7c0a72f19325761136.png","https://assets.km.tencent.com/ImageHosting/20221201/83b6352e20d42867681baa65eb68b7e5.png","https://assets.km.tencent.com/ImageHosting/20221201/240caa6f66871e2692f171ed39a2c368.png"],y={value:"settings",text:"设置",iconInfo:{name:"knowledges/setting",width:20,height:20}},w={value:"delete",text:"删除",iconInfo:{name:"knowledges/delete-node",width:20,height:20}},C={value:"loglist",text:"操作记录",iconInfo:{name:"knowledges/loglist",width:20,height:20}},k=(t,e)=>{let i=[];var a;return t.settings&&(i=[...i,{...y}]),t.edit&&(i=[...i,{...C}]),t.edit_changing_group&&(i=[...i,{...(a=null==e?void 0:e.is_recommended,{value:"recommend",disabled:!!a,text:a?"已推荐":"推荐",iconInfo:{name:"knowledges/recommend",width:20,height:20}})}]),t.delete&&(i=[...i,{...w}]),i},O=[{value:"removeMember",text:"删除成员",iconInfo:{name:"knowledges/delete-node",width:20,height:20}}],x={value:"newOwner",text:"移交所有权",iconInfo:{name:"common/user-checkmark",width:20,height:20}},j=t=>{let e=[...O];return t.transfer&&(e[0].dividerUp=!0,e=[{...x},...e]),e}},2022:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(168),n=i(2054),o=i.n(n),r=i(2055),l=i.n(r),c=Object(a.c)({name:"VideoItem",props:{item:{type:Object,default:()=>{}},type:{type:String,default:""},suffix:{type:String,default:""}},setup(t){const e=Object(a.a)(()=>{const e=t.item.group_id&&"0"!==t.item.group_id?`group/${t.item.group_id}/`:"";return"playlist"===t.type?t.item.videoId?`/${e}videos/show/${t.item.videoId}${t.suffix}`:`/${e}playlists/view/${t.item.id}${t.suffix}`:`/${e}videos/show/${t.item.id}${t.suffix}`}),i=Object(a.a)(()=>{var e;const i=null===(e=t.item)||void 0===e?void 0:e.pic,a="playlist"===t.type?l.a:o.a;return i||a}),n=new Date,r=Object(a.a)(()=>{var e;return Object(s.h)(new Date((null===(e=t.item)||void 0===e?void 0:e.created)||n),n,!0)}),c=Object(a.a)(()=>t.item.group||{});return{coverUrl:i,duration:Object(a.a)(()=>{var e,i;if(null===(e=t.item)||void 0===e||!e.duration||"0"===(null===(i=t.item)||void 0===i?void 0:i.duration))return"";const a=+t.item.duration+0;return Object(s.e)(Math.floor(a))}),readCount:Object(a.a)(()=>{var e,i;return null!==(e=t.item)&&void 0!==e&&e.read_count?null===(i=t.item)||void 0===i?void 0:i.read_count:"0"}),videoCount:Object(a.a)(()=>{var e,i;return null!==(e=t.item)&&void 0!==e&&e.video_count?null===(i=t.item)||void 0===i?void 0:i.video_count:"0"}),groupData:c,createTime:r,videoLink:e}}}),d=i(68),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-item"},[i("a",{directives:[{name:"skeleton",rawName:"v-skeleton",value:!t.item.title,expression:"!item.title"}],staticClass:"video-cover",attrs:{href:t.videoLink,target:"_blank"}},[i("img",{attrs:{src:t._f("thumbnail")(t.coverUrl,520)}}),t._v(" "),i("div",{staticClass:"video-mask"},[i("span",{staticClass:"view-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/white-play",width:16,height:16,viewBox:"0 0 16 16",color:"blue"}}),t._v(" "),i("span",{staticClass:"count-text"},[t._v(t._s(t.readCount))])],1),t._v(" "),"playlist"===t.type?i("span",{staticClass:"video-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/playlist",width:16,height:16,viewBox:"0 0 16 16",color:"blue"}}),t._v(" "),i("span",{staticClass:"count-text"},[t._v(t._s(t.videoCount))])],1):t._e(),t._v(" "),"playlist"!==t.type?i("span",{staticClass:"video-duration"},[t._v(t._s(t.duration))]):t._e()])]),t._v(" "),i("div",{staticClass:"video-info"},[i("a",{directives:[{name:"skeleton",rawName:"v-skeleton",value:!t.item.title,expression:"!item.title"}],staticClass:"video-info-top",attrs:{href:t.videoLink,target:"_blank"}},[t._v(t._s(t.item.title))]),t._v(" "),i("div",{directives:[{name:"skeleton",rawName:"v-skeleton",value:!t.item.created_by,expression:"!item.created_by"}],staticClass:"video-info-bottom"},["article"!==t.type&&t.groupData.is_current_user_in?i("span",{staticClass:"is-join-group"},[t._v("已加入")]):t._e(),t._v(" "),i("div",{staticClass:"author-info"},["article"!==t.type&&t.groupData.id?t._e():i("a",{staticClass:"author-avatar",attrs:{href:"/user/"+t.item.created_by,target:"_blank"}},[i("img",{staticClass:"avatar-img",attrs:{src:"/asset/avatar/"+t.item.created_by}})]),t._v(" "),i("a",{staticClass:"author-text",class:{"wide-author-text":!t.groupData.is_current_user_in},attrs:{href:"article"!==t.type&&t.groupData.id?"/group/"+t.groupData.id:"/user/"+t.item.created_by,target:"_blank"}},[t._v("\n          "+t._s("article"===t.type?t.item.created_by:t.groupData.name||t.item.created_by)+"\n        ")]),t._v(" "),i("span",{staticClass:"time-text",attrs:{href:"/user/"+t.item.created_by,target:"_blank"}},[t._v("· "+t._s(t.createTime))])])])]),t._v(" "),"playlist"===t.type?i("div",{staticClass:"playlist-background-level1"}):t._e(),t._v(" "),"playlist"===t.type?i("div",{staticClass:"playlist-background-level2"}):t._e()])}),[],!1,null,"71078e1a",null);e.a=u.exports},2023:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=()=>a.a.get("/pages/personalBg"),n=()=>a.a.post("/km_bff/feed/v1/get_background_image")},2024:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o}));i(11),i(12),i(13),i(14),i(15);var a=i(1899),s=i.n(a);const n=function(t){this.init(t)};n.prototype={instance:null,imgZindex:"2",init(t){this.$watermarked=s()(t.watermarked),this.observerEl=document.querySelector(t.watermarked),this.img=t.img,this.watermarkedClass=t.watermarkClass||"watermarked",this.watermarkClass=t.watermarkClass||"watermark",this.imgZindex=t.imgZindex||"2";const e=this,i=new MutationObserver((function(t){t.forEach((function(t){const i=document.querySelector("."+e.watermarkClass);i||e.draw(),i&&t.target.className===e.watermarkClass&&"attributes"===t.type&&i.getAttribute("style")!==`background-image: url(${e.img})`&&i.setAttribute("style",`background-image: url(${e.img})`)}))}));i.observe(this.observerEl||document.body,{childList:!0,attributes:!0,subtree:!0}),this.instance=i},draw(){const t=this.imgZindex;this.$watermarked.find("img, pre, .jwplayer").each((function(){s()(this).css({position:"relative","z-index":t})})),s()("."+this.watermarkClass).remove(),this.$watermarked.addClass(this.watermarkedClass).prepend(`<div class="${this.watermarkClass}"></div>`),s()("."+this.watermarkClass).css("background-image",`url(${this.img})`)},disconnect(){var t;null===(t=this.instance)||void 0===t||t.disconnect()}};const o=function(t){this.init(t)};o.prototype={instance:null,imgZindex:"2",init(t){this.$watermarked=s()(t.watermarked),this.observerEl=document.querySelector(t.watermarked),this.img=t.img,this.watermarkClass=t.watermarkClass||"watermark",this.imgZindex=t.imgZindex||"2";const e=this,i=new MutationObserver((function(t){t.forEach((function(t){const i=document.querySelector(".custom-user-info-right-nick");i||e.draw(),i&&"custom-user-info-right-nick"===t.target.className&&"attributes"===t.type&&i.getAttribute("style")!==`background-image: url("${e.img}")`&&i.setAttribute("style",`background-image: url("${e.img}")`)}))}));i.observe(this.observerEl||document.body,{childList:!0,attributes:!0,subtree:!0}),this.instance=i},draw(){const t=this.imgZindex;this.$watermarked.find("img, pre, .jwplayer").each((function(){s()(this).css({position:"relative","z-index":t})})),s()(".custom-user-info").remove(),this.$watermarked.prepend('<div class="custom-user-info"><div class="custom-user-info-left"></div><div class="custom-user-info-right"><div class="custom-user-info-right-nick"></div></div></div>'),s()(".custom-user-info-right-nick").css("background-image",`url(${this.img})`)},changeImg(t){this.img=t,this.draw()},disconnect(){var t;null===(t=this.instance)||void 0===t||t.disconnect()}}},2025:function(t,e,i){"use strict";i.d(e,"e",(function(){return c})),i.d(e,"a",(function(){return d})),i.d(e,"b",(function(){return u})),i.d(e,"c",(function(){return p})),i.d(e,"d",(function(){return h})),i.d(e,"g",(function(){return m})),i.d(e,"h",(function(){return v})),i.d(e,"f",(function(){return g}));i(11),i(12),i(13),i(14),i(15);var a=i(1899),s=i.n(a),n=i(7),o=i(542);const r=(t,e)=>{const i=t.split(","),a=i[0].match(/:(.*?);/)[1],s=atob(i[1]);let n=s.length;const o=new Uint8Array(n);for(;n--;)o[n]=s.charCodeAt(n);return new File([o],e,{type:a})},l=(t,e,i)=>{const a=[],s=[];for(const e of t)if(e.search(/^(http(s)?:\/\/)/)>-1)s.push(e);else{const t=r(e,"temp_base_name.jpg"),i=r(e,"temp_base_name.jpg");t.prefix_type="operations_md_upload_image",t.ops={fileTemp:i},a.push(t)}s.length&&Object(o.g)(s,e,i),a.length&&((t,e,i)=>{Object(o.f)(t,{block:5}).then(t=>{Promise.all(t).then(t=>{e&&e(t),i&&i()})})})(a,e,i)},c=()=>({skin_url:"/vkm/tinymce/skins/ui/oxide",content_css:["/vkm/tinymce/skins/content/default/content.css","/vkm/tinymce/skins/custom/coding_style.css","/vkm/tinymce/skins/custom/tinyMce_content.css"]}),d=t=>{t.content=t.content.replace(/\\5FAE软雅黑/gi,"微软雅黑").replace(/\\5B8B体/gi,"宋体").replace(/<div.*?\/staff\/(watermark|hidden-watermark).*?;"><\/div>/gi,"")},u=t=>{let{content:e}=t;const i=((t,e)=>{const i=/\ssrc=[\'\"]?([^\'\"]*)[\'\"]?/i,a=t.match(/<img.*?(?:>|\/>)/gi)||[],s=[];for(let n=0;n<a.length;n++){let o=a[n].match(i)[1];if(o.indexOf(window.KMCONFIG.kmApi)>0)return;if(String.prototype.startsWith&&o.startsWith("//")){const i="http:"+o;e.content=t.replace(o,i),o=i}s.push(o)}return s})(e,t),a=window.KMCONFIG.kmApi+"/vkm/img/common/loading.svg";if(0===i.length)return;e+='<p id="tar_anchor" style="display:none;"></p>',t.content=e.replace(/(<img[^>]*\s+src=['"])([^'"]+)(['"][^>]*>)/gi,(function(t,e,i,s){return e+a+s}));l(i,t=>{let e=window.tinymce.activeEditor.getContent();t.forEach((function(t){e=e.replace(a,t)})),window.tinymce.activeEditor.setContent(e)},()=>{setTimeout((function(){const t=window.tinymce.activeEditor.getBody().querySelector("#tar_anchor");window.tinymce.activeEditor.selection.select(t),window.tinymce.activeEditor.selection.getNode().scrollIntoView(!1),window.tinymce.activeEditor.selection.collapse(!1),t&&t.remove()}),0)})},p=t=>{const e=t.node.innerHTML;t.node.innerHTML=e&&e.replace(/(?:(?<=^|>)[^<>]*?(https?:\/\/[^\s<>]+)[^<>]*?(?=<|$))(?![^<>]*<\/a>)/g,(t,e)=>t.replace(e,t=>`<a target="_blank" href="${t}"> ${t} </a>`))},h=()=>({...c(),paste_preprocess(t,e){d(e),u(e)},paste_postprocess(t,e){p(e)}}),m=()=>{function t(t,e){s()("."+t).click((function(){window.open(e,"_blank")}))}function e(t,e,i,a){const s=new FormData;s.append("fileID",t),s.append("type",e||"openReadingFile"),n.a.post("/attachments/ajax_qqdocs_temp_url",s).then(({data:t})=>{0===t.code?"function"==typeof a&&a(t.data):(i.toggleClass("unauthorized-area"),i.html(`\n              <div class="auth-token-tips">本内容由腾讯文档提供，请先获取腾讯文档授权</div>\n              <div class="authorize-btn"><a href="/attachments/refresh_qqdocs_token?redirect_uri=${encodeURIComponent(window.location.href)}">获取授权</a></div>`))})}function i(){s()(".fullscreen").toggleClass("fullscreen"),s()(".iframe-full").toggleClass("iframe-full")}s()(".km-article-content").find(".tencent-doc-placeholder").each((function(i,a){const n=s()(a),o=n.find(".doc-id").html(),r="out-open-"+i;e(o,null,n,(function(e){if(n.toggleClass("hide"),/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))return n.html(`\n                      <div class="iframe-header">\n                          <span class="tencent-doc-icon"></span>\n                          <span class="tencent-doc-title single_line">${n.find(".doc-title").text()}</span>\n                          <span class="tencent-out-open ${r}">从腾讯文档打开</>\n                      </div>\n                      <div class="auth-token-tips">您使用的浏览器无法使用腾讯文档内容，请选择从腾讯文档中打开</div>\n                      <div class="authorize-btn ${r}">从腾讯文档打开</div>\n                  `),void t(r,e.url);const a=e.type;let o=["slide","pdf"].indexOf(a)>-1?495:660;n.hasClass("km_doc")&&(o=768);const l="full-screen-btn"+i;n.css("height",o+56+"px"),n.html(`\n                  <div class="iframe-header">\n                      <span class="tencent-doc-icon"></span>\n                      <span class="tencent-doc-title single_line">${e.title}</span>\n                      <span class="tencent-out-open ${r}">从腾讯文档打开</span>\n                      <span class="full-screen-icon ${l}"></span>\n                  </div>\n                  <iframe class="doc-iframe" width="100%" height="${o}" src="${e.tempURL}" allowFullScreen="true"></iframe>\n              `),function(t,e){s()("."+t).on("click",(function(){e.toggleClass("fullscreen"),e.find(".doc-iframe").toggleClass("iframe-full")}))}(l,n),t(r,e.url)}))})),s()(".km-article-content").find(".team-tencent-doc-placeholder").each((function(i,a){const n=s()(a),o=n.find(".doc-id").html(),r="out-open-"+i;e(o,"openEditingFile",n,(function(e){if(n.toggleClass("hide"),/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))return n.html(`\n                      <div class="iframe-header">\n                          <span class="tencent-doc-icon"></span>\n                          <span class="tencent-doc-title single_line">${n.find(".doc-title").text()}</span>\n                          <span class="tencent-out-open ${r}">从腾讯文档打开</>\n                      </div>\n                      <div class="auth-token-tips">您使用的浏览器无法使用腾讯文档内容，请选择从腾讯文档中打开</div>\n                      <div class="authorize-btn ${r}">从腾讯文档打开</div>\n                  `),void t(r,e.url);n.html(`\n                  <div class="iframe-header">\n                      <div class="left-box">\n                          <div class="left-header">\n                              <span class="article-title single_line">${window.docData.docTitle}</span>\n                              <a class="kbar-title" target="_blank" href="${"/group/"+window.docData.KBarId}">\n                                  <div class="title">${window.docData.KBar}</div>\n                              </a>\n                          </div>\n                          <div class="left-content">\n                              <a class="author" target="_blank" href="${"/user/"+window.docData.author}">${window.docData.author}</a>\n                              <span class="time">${window.docData.docCreateTime}</span>\n                              <span class="count">浏览(${window.docData.docReadCount})</span>\n                          </div>\n                      </div>\n                      <div class="right-box">\n                          <div class="digg operate-btn digg_box"><span id="digg_count"></span></div>\n                          <div class="bookmark operate-btn bookmark_box" ><span id="bookmark_count"></span></div>\n                          <div class="share operate-btn js_operations_bar">\n                              <ul id="xy" class="share-dropdown" style="display: none">\n                                  <li class="js_share_to_rtx">\n                                      <a class="share_icon_small share_rtx_icon_small bg_sprites" href="javascript:void(0);">企业微信</a>\n                                  </li>\n                                  <li class="js_share_to_eamil">\n                                      <a class="share_icon_small share_email_icon_small bg_sprites" href="javascript:void(0);">邮件</a>\n                                  </li>\n                                  <li class="js_share_to_qrcode">\n                                      <a class="share_icon_small share_qrcode_icon_small bg_sprites" href="javascript:void(0);">二维码</a>\n                                  </li>\n                              </ul>\n                          </div>\n                          <div class="edit operate-btn js_operations_bar hide">\n                              <ul id="xy" class="edit-dropdown" style="display: none">\n                                  <li id="edit-btn" data-toggle="modal" data-target="#reupload-doc-modal">\n                                      <a href="javascript:void(0);">编辑</a>\n                                  </li>\n                                  <li>\n                                      <a id="bar_action_delete" href="javascript:void(0);" class="delete_entity">删除</a>\n                                  </li>\n                                  <li class="separator top top-box" style="display: none;" >\n                                      <a class="uptop_btn" href="javascript:void(0);">星标</a>\n                                  </li>\n                              </ul>\n                          </div>\n                          <div class="open">\n                              <span class="tencent-out-open ${r}">从腾讯文档打开</span>\n                          </div>\n                      </div>\n                  </div>\n                  <iframe class="doc-iframe" src="${e.tempURL}" allowFullScreen="true"></iframe>\n              `),s()(".tencent_doc_operations").show(),s()("body").css("overflow","hidden"),t(r,e.url),s()(".share, .share-dropdown").mouseover((function(){s()(".share-dropdown").show()})).mouseout((function(){s()(".share-dropdown").hide()})),s()(".edit, .edit-dropdown").mouseover((function(){s()(".edit-dropdown").show()})).mouseout((function(){s()(".edit-dropdown").hide()})),s()("#edit-btn").click((function(){s()(".reupload-box").hide(),s()(".edit-doc").show(),s()(".edit_access_authority").show(),s()(".header-text").html("编辑文档"),s()("#docName").val(window.docData.docTitle)}))}))})),-1!==navigator.userAgent.indexOf("MSIE")?document.attachEvent("onkeydown",(function(){27===event.keyCode&&i.call(this,event)})):document.addEventListener("keydown",(function(t){27===t.which&&i.call(this,t)}),!1)},v=t=>{window.performance.now();const e=t.replace(/<img([\s\S]*?)src\s*=\s*(['"])([\s\S]*?)\2([^>]*)>/gi,"<img$1data-src=$2$3$2$4>");window.performance.now();return e},g=()=>{s()((function(){s()(".km-view-content table").wrap("<div class='km-table-all-wrapper'></div>")}))}},2026:function(t,e,i){"use strict";var a=i(1924),s=i.n(a),n=(i(11),i(12),i(13),i(14),i(15),{name:"ElUploadList",data:()=>({focusing:!1}),props:{files:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},handlePreview:Function,listType:String},methods:{parsePercentage:t=>parseInt(t,10),handleClick(t){this.handlePreview&&this.handlePreview(t)}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition-group",{class:["upload-list","upload-list--"+t.listType,{"is-disabled":t.disabled}],attrs:{tag:"ul",name:"list"}},t._l(t.files,(function(e){return i("li",{key:e.uid,class:["upload-list__item","is-"+e.status,t.focusing?"focusing":""],attrs:{tabindex:"0"},on:{keydown:function(i){if(!i.type.indexOf("key")&&t._k(i.keyCode,"delete",[8,46],i.key,["Backspace","Delete","Del"]))return null;!t.disabled&&t.$emit("remove",e)},focus:function(e){t.focusing=!0},blur:function(e){t.focusing=!1},click:function(e){t.focusing=!1}}},[t._t("default",(function(){return["uploading"!==e.status&&["picture-card","picture"].indexOf(t.listType)>-1?i("img",{staticClass:"upload-list__item-thumbnail",attrs:{src:e.url,alt:""}}):t._e(),t._v(" "),i("a",{staticClass:"upload-list__item-name",on:{click:function(i){return t.handleClick(e)}}},[i("i",{staticClass:"icon-document"}),t._v("\n        "+t._s(e.name)+"\n      ")]),t._v(" "),i("label",{staticClass:"upload-list__item-status-label"},[i("i",{class:{"icon-upload-success":!0,"icon-circle-check":"text"===t.listType,"icon-check":["picture-card","picture"].indexOf(t.listType)>-1}})]),t._v(" "),t.disabled?t._e():i("i",{staticClass:"icon-close",on:{click:function(i){return t.$emit("remove",e)}}}),t._v(" "),t.disabled?t._e():i("i",{staticClass:"icon-close-tip"}),t._v(" "),"picture-card"===t.listType?i("span",{staticClass:"upload-list__item-actions"},[t.handlePreview&&"picture-card"===t.listType?i("span",{on:{click:function(i){return t.handlePreview(e)}}},[i("i",{staticClass:"icon-zoom-in"})]):t._e(),t._v(" "),t.disabled?t._e():i("span",{staticClass:"upload-list__item-delete",on:{click:function(i){return t.$emit("remove",e)}}},[i("i",{staticClass:"icon-delete"})])]):t._e()]}),{file:e})],2)})),0)}),[],!1,null,"9259276a",null).exports;var l={name:"UploadDrag",inject:{uploader:{default:""}},props:{disabled:Boolean},data:()=>({dragover:!1}),methods:{onDragover(){this.disabled||(this.dragover=!0)},onDrop(t){if(this.disabled||!this.uploader)return;const{accept:e}=this.uploader;this.dragover=!1,e?this.$emit("file",[].slice.call(t.dataTransfer.files).filter(t=>{const{type:i,name:a}=t,s=a.indexOf(".")>-1?"."+a.split(".").pop():"",n=i.replace(/\/.*$/,"");return e.split(",").map(t=>t.trim()).filter(t=>t).some(t=>/\..+$/.test(t)?s===t:/\/\*$/.test(t)?n===t.replace(/\/\*$/,""):!!/^[^/]+\/[^/]+$/.test(t)&&i===t)})):this.$emit("file",t.dataTransfer.files)}}},c=Object(o.a)(l,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"upload-dragger",class:{"is-dragover":t.dragover},on:{drop:function(e){return e.preventDefault(),t.onDrop.apply(null,arguments)},dragover:function(e){return e.preventDefault(),t.onDragover.apply(null,arguments)},dragleave:function(e){e.preventDefault(),t.dragover=!1}}},[t._t("default")],2)}),[],!1,null,null,null).exports,d=i(2051);function u(){}var p={components:{UploadDragger:c},props:{action:{type:String,default:""},name:{type:String,default:"file"},data:{type:Object,default:null},headers:Object,withCredentials:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},accept:{type:String,default:""},onStart:{type:Function,default:u},onSuccess:{type:Function,default:u},onProgress:{type:Function,default:u},onError:{type:Function,default:u},drag:{type:Boolean,default:!1},onRemove:{type:Function,default(){}},httpRequest:{type:Function,default:function(t){if("undefined"==typeof XMLHttpRequest)return;const e=new XMLHttpRequest,{action:i}=t;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});const a=new FormData;t.data&&Object.keys(t.data).forEach(e=>a.append(e,t.data[e])),a.append(t.filename,t.file,t.file.name),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,i){let a;a=i.response?""+(i.response.error||i.response):i.responseText?""+i.responseText:`fail to post ${t} ${i.status}`;const s=new Error(a);return s.status=i.status,s.method="post",s.url=t,s}(i,0,e));t.onSuccess(function(t){const e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}(e))},e.open("post",i,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);const s=t.headers||{};return Object.keys(s).forEach(t=>{s.hasOwnProperty(t)&&null!==s[t]&&e.setRequestHeader(t,s[t])}),e.send(a),e}},fileList:{type:Array,default:()=>[]},autoUpload:{type:Boolean,default:!0},listType:{type:String,default:"text"},disabled:{type:Boolean,default:!1},limit:{type:Number,default:10},onExceed:{type:Function,default:u}},data:()=>({reqs:{}}),methods:{handleClick(){this.disabled||(this.$refs.input.value=null,this.$refs.input.click())},handleKeydown(t){t.target===t.currentTarget&&(13!==t.keyCode&&32!==t.keyCode||this.handleClick())},handleChange(t){const{files:e}=t.target;e&&this.uploadFiles(e)},uploadFiles(t){if(this.limit&&this.fileList.length+t.length>this.limit)return void(this.onExceed&&this.onExceed(t,this.fileList));let e=Array.prototype.slice.call(t);this.multiple||(e=e.slice(0,1));e.some(t=>t.size>d.a)?this.$toast("图片上传失败，每张图片大小不能超过30M",{status:"error",positon:"center"}):0!==e.length&&e.forEach(t=>{this.onStart(t),this.autoUpload&&this.upload(t)})},upload(t){const{uid:e}=t,i={headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:e=>{this.onProgress(e,t)},onSuccess:i=>{this.onSuccess(i,t),delete this.reqs[e]},onError:i=>{this.onError(i,t),delete this.reqs[e]}},a=this.httpRequest(i);this.reqs[e]=a,a&&a.then&&a.then(i.onSuccess,i.onError)},abort(t){const{reqs:e}=this;if(t){let i=t;t.uid&&(i=t.uid),e[i]&&e[i].abort()}else Object.keys(e).forEach(t=>{e[t]&&e[t].abort(),delete e[t]})}},render(){const t=arguments[0],{handleClick:e,drag:i,name:a,handleChange:n,multiple:o,accept:r,listType:l,uploadFiles:c,disabled:d,handleKeydown:u}=this,p={class:{"upload-content":!0},on:{click:e,keydown:u}};return p.class["upload--"+l]=!0,t("div",s()([{},p,{attrs:{tabindex:"0"}}]),[i?t("upload-dragger",{attrs:{disabled:d},on:{file:c}},[this.$slots.default]):this.$slots.default,t("input",{class:"upload-input",attrs:{type:"file",name:a,multiple:o,accept:r},ref:"input",on:{change:n}})])}},h=Object(o.a)(p,void 0,void 0,!1,null,"7c24a202",null).exports;function m(){}var v={name:"Upload",components:{UploadList:r,UploadComponent:h},provide(){return{uploader:this}},props:{action:{type:String,default:""},headers:{type:Object,default:()=>({})},data:{type:Object,default:null},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:{type:Boolean,default:!0},showFileList:{type:Boolean,default:!1},accept:{type:String,default:""},beforeRemove:{type:Function,default:m},onRemove:{type:Function,default:m},onChange:{type:Function,default:m},onPreview:{type:Function},onSuccess:{type:Function,default:m},onProgress:{type:Function,default:m},onError:{type:Function,default:m},fileList:{type:Array,default:()=>[]},autoUpload:{type:Boolean,default:!0},listType:{type:String,default:"text"},httpRequest:Function,disabled:{type:Boolean,default:!1},limit:{type:Number,default:10},onExceed:{type:Function,default:m}},data:()=>({uploadFiles:[],tempIndex:1}),watch:{listType(t){"picture-card"!==t&&"picture"!==t||(this.uploadFiles=this.uploadFiles.map(t=>{if(!t.url&&t.raw)try{t.url=URL.createObjectURL(t.raw)}catch(t){console.error("[Element Error][Upload]",t)}return t}))},fileList:{immediate:!0,handler(t){this.uploadFiles=t.map(t=>(t.uid=t.uid||Date.now()+this.tempIndex,this.tempIndex+=1,t.status=t.status||"success",t))}}},methods:{handleStart(t){t.uid=Date.now()+this.tempIndex,this.tempIndex+=1;const e={status:"ready",name:t.name,size:t.size,percentage:0,uid:t.uid,raw:t};if("picture-card"===this.listType||"picture"===this.listType)try{e.url=URL.createObjectURL(t)}catch(t){return void console.error("[Element Error][Upload]",t)}this.uploadFiles.push(e),this.onChange(e,this.uploadFiles)},handleProgress(t,e){const i=this.getFile(e);this.onProgress(t,i,this.uploadFiles),i.status="uploading",i.percentage=t.percent||0},handleSuccess(t,e){const i=this.getFile(e);i&&(i.status="success",i.response=t,this.onSuccess(t,i,this.uploadFiles),this.onChange(i,this.uploadFiles))},handleError(t,e){const i=this.getFile(e),a=this.uploadFiles;i.status="fail",a.splice(a.indexOf(i),1),this.onError(t,i,this.uploadFiles),this.onChange(i,this.uploadFiles)},handleRemove(t,e){e&&(t=this.getFile(e));const i=()=>{this.abort(t);const e=this.uploadFiles;e.splice(e.indexOf(t),1),this.onRemove(t,e)};if(this.beforeRemove){if("function"==typeof this.beforeRemove){const e=this.beforeRemove(t,this.uploadFiles);e&&e.then?e.then(()=>{i()},m):!1!==e&&i()}}else i()},getFile(t){let e;return this.uploadFiles.every(i=>(e=t.uid===i.uid?i:null,!e)),e},abort(t){this.$refs["upload-inner"].abort(t)},clearFiles(){this.uploadFiles=[]},submit(){this.uploadFiles.filter(t=>"ready"===t.status).forEach(t=>{this.$refs["upload-inner"].upload(t.raw)})}},render(){const t=arguments[0];let e;this.showFileList&&(e=t(r,{attrs:{disabled:this.disabled,listType:this.listType,files:this.uploadFiles,handlePreview:this.onPreview},on:{remove:this.handleRemove}},[t=>{if(this.$scopedSlots.file)return this.$scopedSlots.file({file:t.file})}]));const i={props:{drag:this.drag,action:this.action,multiple:this.multiple,withCredentials:this.withCredentials,headers:this.headers,name:this.name,data:this.data,accept:this.accept,fileList:this.uploadFiles,autoUpload:this.autoUpload,listType:this.listType,disabled:this.disabled,limit:this.limit,"on-start":this.handleStart,"on-exceed":this.onExceed,"on-progress":this.handleProgress,"on-success":this.handleSuccess,"on-error":this.handleError,"on-remove":this.handleRemove,"http-request":this.httpRequest},ref:"upload-inner"},a=this.$slots.default,n=t(h,s()([{},i]),[a]);return t("div",["picture-card"===this.listType?e:"",n,"picture-card"!==this.listType?e:""])}},g=Object(o.a)(v,void 0,void 0,!1,null,null,null);e.a=g.exports},2027:function(t,e,i){"use strict";var a=i(1894),s=i.n(a),n=i(1896),o=i.n(n),r=i(1893),l=i.n(r),c=i(530),d=i.n(c),u=(i(11),i(12),i(13),i(14),i(15),i(3)),p=i(1999),h=i(2008),m=i(2014),v=Object(u.c)({name:"operate-block",components:{Dropdown:h.a,venomButton:d.a,venomTextarea:l.a,kmModal:m.a,venomForm:o.a,venomFormItem:s.a},props:{isTop:{require:!1,default:!1},hasAuth:{require:!1,default:!1},targetType:{require:!0,default:void 0},targetId:{require:!0,default:void 0}},setup(t,e){const i=Object(u.f)("$bus"),a=Object(u.a)(()=>e.root.$store.getters["entry/entryInfo"]),s=Object(u.a)(()=>e.root.$store.getters["entry/entryUserInfo"]),n=a.value.id||e.root.$route.params.id,o=Object(u.r)(!1),r=Object(u.q)({reason:void 0}),l=()=>{t.isTop?c():e.root.$newConfirm("warning","你确定要置顶吗？",{confirm:()=>{c()},confirmText:"确定"})},c=async()=>{const{data:i}=await Object(p.o)({entry_id:n,block_type:"entry_ability",target_id:t.targetId,target_type:t.targetType,action:t.isTop?"unpin":"pin"});if(0===i.code)return e.root.$toast(t.isTop?"取消置顶成功":"置顶成功",{status:"success",positon:"center",singline:!1}),e.emit("afterTop"),void g();e.root.$toast(i.message||(t.isTop?"取消置顶":"置顶")+"失败，请重试",{status:"error",positon:"center",singline:!1})},d=async()=>{e.root.$newConfirm("warning","你确定要移除吗？",{confirm:async()=>{const{data:i}=await Object(p.o)({entry_id:n,block_type:"entry_ability",target_id:t.targetId,target_type:t.targetType,action:"remove"});if(0===i.code)return e.root.$toast("移除成功",{status:"success",positon:"center",singline:!1}),e.emit("afterRemove"),void g();e.root.$toast(i.message||"移除失败，请重试",{status:"error",positon:"center",singline:!1})},confirmText:"确定"})},h=()=>{o.value=!0},m=Object(u.r)(Object.freeze({handleConfirmChangeIsTop:l,handleClickDelete:d,handleFeedBack:h})),v=Object(u.a)(()=>{const e=[];return(s.value.is_admin||s.value.is_entry_admin)&&(e.push({value:"handleConfirmChangeIsTop",text:t.isTop?"取消置顶":"置顶",actived:t.isTop,iconInfo:{name:"common/top",width:20,height:20}}),e.push({value:"handleClickDelete",text:"移除",iconInfo:{name:"common/delete",width:20,height:20}})),e.push({value:"handleFeedBack",text:"反馈",iconInfo:{name:"common/edit",width:20,height:20}}),e}),g=()=>{switch(t.targetType){case"active_user":i.emit("getActiveUsers");break;case"group":i.emit("getRelatedGroups");break;case"related_entries":i.emit("getRelatedEntry")}},f=()=>{o.value=!1,r.reason=void 0};return{entryUserInfo:s,entryId:n,showModal:o,formData:r,dropdownItemList:v,dropdownFuncs:m,handleConfirmChangeIsTop:l,handleChangeIsTop:c,handleClickDelete:d,handleFeedBack:h,onCloseModal:f,onSubmitModal:async()=>{if(!r.reason)return void e.root.$toast("反馈原因不能为空",{status:"warning",positon:"center",singline:!1});const{data:i}=await Object(p.o)({entry_id:n,block_type:"entry_ability",target_id:t.targetId,target_type:t.targetType,action:"feedback",reason:r.reason});0!==i.code?e.root.$toast(i.message||"新增反馈失败，请重试",{status:"error",positon:"center",singline:!1}):f()},preventDefault:t=>{t.preventDefault()}}}}),g=i(68),f=Object(g.a)(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operate-block-container",on:{click:t.preventDefault}},[i("dropdown",{attrs:{dropdownWidth:t.isTop?120:88,itemList:t.dropdownItemList},on:{clickItem:function(e){var i=e.item;return t.dropdownFuncs[i.value]()}}},[i("span",{staticClass:"operate-icon"},[i("svg-icon",{attrs:{width:16,height:16,name:"common/more"}})],1)]),t._v(" "),i("km-modal",{staticClass:"entry-modal",attrs:{showModal:t.showModal,closeOnClickModal:!1,appendToBody:!0,title:"反馈",submitText:"反馈"},on:{onSubmitModal:t.onSubmitModal,onCloseModal:t.onCloseModal}},[i("venom-form",{staticClass:"form-list",attrs:{model:t.formData}},[i("venom-form-item",{staticClass:"form-item",attrs:{props:"reason",label:"反馈",labelCol:{span:1},wrapperCol:{span:11},isRequired:""}},[i("venom-textarea",{staticClass:"form-area",attrs:{placeholder:"请输入"},model:{value:t.formData.reason,callback:function(e){t.$set(t.formData,"reason",e)},expression:"formData.reason"}})],1)],1),t._v(" "),i("div",{staticClass:"reason-tip"},[t._v("感谢你参与词条内容维护共建，词条管理员将会收到你的反馈")])],1)],1)}),[],!1,null,"719e5c8f",null);e.a=f.exports},2028:function(t,e,i){},2029:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a=t=>t.type.match(/^image\/(gif|jpe?g|png)$/i),s=(t,e=0)=>t.size<=e},2030:function(t,e,i){"use strict";i.d(e,"f",(function(){return s})),i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o})),i.d(e,"g",(function(){return r})),i.d(e,"c",(function(){return l})),i.d(e,"e",(function(){return c})),i.d(e,"d",(function(){return d}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=({id:t,name:e})=>{const i=new FormData;i.append("filename",e);return a.a.post("attachments/update_attach_ajax/"+t,i,{headers:{"Content-Type":"multipart/form-data"}})},n=({id:t})=>a.a.get("attachments/delete_attach_ajax/"+t),o=({id:t,checked:e=!0})=>a.a.post(`attachments/change_attach_downloadable_ajax/${t}/${e?"checked":""}`),r=({data:t})=>a.a.post("events/edit_event",t),l=({id:t})=>a.a.post("events/get_event",{event_id:t}),c=t=>a.a.post("/km_bff/apps/v1/get_events_for_public",t),d=t=>a.a.post("/km_bff/apps/v1/get_events_for_calendar",t)},2031:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a,s=i(3),n=i(144),o=i(8);function r(t){document.body.removeChild(t.$el),t.$destroy()}const l=null===(a=n.Image.components)||void 0===a?void 0:a.ImageViewer;l||console.error("ElImageViewer error"),Vue.component(l.name,l);const c=Object(s.c)({name:"ImageViewer",props:{src:{type:String,required:!0,default:""},visible:{type:Boolean,default:!1},appendTo:{type:String,default:"body"}},setup:(t,{emit:e})=>({closeViewer:()=>{e("close")}})});let d=null;c.show=function(t){d&&(r(d),d=null);const e=(t=>{if(!t.includes("imageMogr2/thumbnail")){const e="imageMogr2/thumbnail/4096x>/ignore-error/1";return t+(t.split("?")[1]?"&":"?")+e}return t.replace(/imageMogr2\/thumbnail\/(\S)*>\/ignore-error\/1/gi,"imageMogr2/thumbnail/4096x>/ignore-error/1")})(t.src),i=function(t,e){const i=new o.default({render:i=>i(t,e)}).$mount();return document.body.appendChild(i.$el),i}(c,{props:{visible:!0,src:e,appendTo:t.appendTo},on:{close:()=>{r(d),d=null}}});d=i};var u=c,p=i(68),h=Object(p.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"image-viewer-container"},[this.visible?e("el-image-viewer",{attrs:{"url-list":[this.src],"on-close":this.closeViewer,"append-to-body":"body"===this.appendTo},nativeOn:{wheel:function(t){t.preventDefault()}}}):this._e()],1)}),[],!1,null,"0c1b12f8",null);e.a=h.exports},2032:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(7),n=i(1971),o=i(1935),r=i.n(o),l=Object(a.c)({name:"TrilobiteEditorMod",components:{TDialog:n.a},props:{businessType:{type:String,default:"input-business-type-default"},defaultJsonContent:{type:String,default:""},imgBlockId:{type:Number,default:4},appearance:{type:String,default:"full-width"}},data:()=>({eType:"add",tmpImgList:[],openGif:!0,pasteDomToHtml:"",trilobiteObj:null,editorType:2,eleId:"",isContentEmpty:!0,showImgErrDialog:!1,imgErrMsg:[]}),computed:{},watch:{},created(){},mounted(){this.eleId="trilobite-id-"+Math.random().toString(36).substring(2),this.$nextTick(()=>{this.initEditor()})},methods:{closeImgErrTips(){this.showImgErrDialog=!1,this.imgErrMsg=[]},checkIsContentEmpty(){return this.isContentEmpty},provideTextContent(){const t=this.trilobiteObj.actions.editorView.state.doc;return t?t.textBetween(0,t.content.size-1):""},provideContent(){return this.trilobiteObj.getValue()},updateContent(t,e){t&&this.$nextTick(()=>{this.trilobiteObj?this.trilobiteObj.setValue(t):console.log("this.trilobiteObj未初始化")}),e&&e.isClear?this.isContentEmpty=!0:this.isContentEmpty=!1},initEditor(){const t={container:"#"+this.eleId,language:"zh",appearance:this.appearance,clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},value:this.defaultJsonContent||JSON.stringify({type:"doc",content:[],version:1}),model:"edit"};t.plugins=[new window.ImagePlugin({upload:t=>(console.log("file type = "+typeof t),new Promise((e,i)=>{this.newCOSOpe({files:[t]}).then(t=>{e({url:t[0]})}).catch(t=>{i(t)})}))})],t.updateHookSettings={onContentChange:t=>{this.isContentEmpty=t.isDocumentEmpty()}},"input-business-type-question"===this.businessType?(t.plugins.push(new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},allowFontSizes:[{value:15,title:"15px"}],fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})),t.pluginsSettings={featureFlag:{allowHeadingNumber:!1,allowTables:!1,allowEmoji:!1,allowBlockType:!1,allowTextAlignment:!1,allowTextHighlight:!1,allowFindReplace:!1,allowUndoRedo:!0}}):"input-business-type-comment"===this.businessType&&(t.plugins.push(new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},allowFontSizes:[{value:15,title:"15px"},{value:16,title:"16px"},{value:18,title:"18px"},{value:20,title:"20px"},{value:24,title:"24px"},{value:28,title:"28px"},{value:36,title:"36px"}],fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})),t.pluginsSettings={featureFlag:{allowUndoRedo:!0}}),t.mentionSettings={query:async t=>{const e=`/users/ajax_get_user_selector_data?type=usersandadgroups&q=${t}&frequent=&limit=20`;return new Promise(t=>{s.a.get(e).then(({data:e})=>{if(Array.isArray(e)&&e.length>0){const i=e.map(t=>{const e=t[0],i=t[1];return{id:e,name:i,mentionName:i,nickName:e,avatarUrl:"/asset/avatar/"+e}});t(i)}else t([])}).catch(()=>{t([])})})},highlight:t=>"sss"===t},this.trilobiteObj=new window.TrilobiteEditor(t)},initQJsonData(){const t="/gkm/api/question/show?agent=pc&limit=20&order_by=default&ts=null&&without_answers=1&id="+this.qId;s.a.get(t).then(({data:t})=>{if(0===t.code&&t.data){const e=t.data.question;this.editorType=e.editor_type||2,e.converted_content&&(this.editorType=3,this.trilobiteObj.setValue(e.converted_content))}})},updateQJsonData(){const t=this.trilobiteObj.getValue();if("string"==typeof t)return new Promise((e,i)=>{s.a.post("/km_bff/question/v1/update_converted_content",{id:Number(this.qId),converted_content:t,editor_type:3}).then(({data:t})=>{0===t.code&&t.data?e(t.data):i({message:t.message||"接口处理失败"})}).catch(t=>{i({message:t.toString()})})})},matchExt:t=>t&&{"image/jpeg":".jpg","image/jpg":".jpg","image/png":".png","image/gif":".gif","image/bmp":".bmp","image/webp":".webp","image/svg+xml":".svg","image/tiff":".tiff"}[t.toLowerCase()]||"",createFromObjectStorePacket:({object:t,callback_sign:e})=>s.a.post("/km_bff/asset/v1/create_from_object",{object:t,callback_sign:e,is_download:!1}),filterIncompatibleImages({files:t,limitSize:e,limitType:i,mimeTypeVerify:a}){const s=e||31457280,n=a||["image/jpeg","image/png","image/jpg","image/gif","image/webp"],o=i||["jpeg","png","jpg","gif","webp"],r={list:[],tips:"以下图片大小超过30M限制："},l={list:[],tips:'只允许上传"jpeg", "png", "jpg", "gif", "webp"类型的图片，以下图片不满足前述类型：'},c={list:[],tips:'只允许上传"image/jpeg", "image/png", "image/jpg", "image/gif", "image/webp" mime类型的图片，以下图片不满足前述类型：'},d=[];return Array.from(t).forEach(t=>{const{type:e,size:i,name:u}=t;let p=0;i>s&&(p=1,r.list.push(u));const h=u.split(".").pop().toLowerCase();o.includes(h)||(p=2,l.list.push(u)),a&&!n.includes(e)&&(p=3,c.list.push(u)),0!==p&&d.push({...t,imgErrType:p})}),d.length&&(r.list.length>0&&this.imgErrMsg.push(r.tips+r.list.join("、")),l.list.length>0&&this.imgErrMsg.push(l.tips+l.list.join("、")),c.list.length>0&&this.imgErrMsg.push(c.tips+c.list.join("、")),this.showImgErrDialog=!0),d},getObjectStorePacket:({block:t,files:e})=>s.a.post("/km_bff/asset/v1/get_object_store_packet",{block:t,files:e}),newCOSOpeProxy(){const{fileUploadRef:t}=this.$refs;t.click()},async newCOSOpe(t){const{files:e}=t;if(!e.length)return Promise.reject("no file selected");if(this.filterIncompatibleImages({files:e}).length>0)return Promise.reject("不支持的文件类型");const i=Array.from(e).map(t=>({map_id:Math.random().toString(36).substring(2),filename:t.name,file:t})),a=(await this.getObjectStorePacket({block:this.imgBlockId,files:i})).data;if(!a||0!==a.code)return Promise.reject("获取存储路径失败");const s=JSON.parse(a.data.store_conf);if(!s)return Promise.reject("catch tmp key error");const n=new r.a({getAuthorization:(t,e)=>{e({TmpSecretId:s.credential.secret_id,TmpSecretKey:s.credential.secret_key,StartTime:s.credential.start_time,ExpiredTime:s.credential.expired_time,SecurityToken:s.credential.security_token})},ChunkSize:2097152,SliceSize:6291456}),o=i.map(t=>{const e=a.data.objects.find(e=>e.map_id===t.map_id);return{...t,...e}}),l=[];return o.forEach(t=>{const e=this.getImagesCDNUrl(t,n,s);l.push(e)}),Promise.all(l)},getImagesCDNUrl(t,e,i){return new Promise((a,s)=>{e.uploadFile({Bucket:i.bucket,Region:i.region,Key:t.key,Body:t.file},e=>{e?s(e):this.createFromObjectStorePacket({object:{filename:t.filename,key:t.key,mime_type:t.mime_type},callback_sign:t.callback_sign}).then(({data:t})=>{0===t.code&&a(t.data.url)})})})}}}),c=i(68),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"trilobite-editor-edit-container km-trilobite-editor",class:["input-business-type-question"===t.businessType?"question-km-trilobite-editor":"input-business-type-comment"===t.businessType?"common-km-trilobite-editor":""]},[i("div",{staticClass:"editor-hook",attrs:{id:t.eleId}}),t._v(" "),i("t-dialog",{attrs:{theme:"info",header:"温馨提示",visible:t.showImgErrDialog,"cancel-btn":null,"on-close":t.closeImgErrTips},on:{"update:visible":function(e){t.showImgErrDialog=e},confirm:t.closeImgErrTips}},[i("div",{attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"km-trilobite-tips"},t._l(t.imgErrMsg,(function(e,a){return i("p",{key:a,staticClass:"tips-item"},[t._v("\n          "+t._s(e)+"\n        ")])})),0)])])],1)}),[],!1,null,"ad96e6e2",null);e.a=d.exports},2033:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(2005),s={name:"BadgeAvatar",components:{badgeTwitter:i(2007).a},props:{nick:{required:!0,default:"",type:String},refKey:{required:!0,default:"",type:String},width:{required:!1,default:48,type:Number},showAttention:{required:!1,default:!1,type:Boolean},urlSuffix:{required:!1,default:"",type:String}},setup(t,e){const{userCardItem:i,renderUserCard:s}=Object(a.a)(e,{idKey:"nick",refKey:""+t.refKey});return{userCardItem:i,createrInfo:{nick:t.nick},renderUserCard:s}}},n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:""+t.refKey+t.nick,staticClass:"avatar-container",on:{mouseenter:function(e){return t.renderUserCard(t.createrInfo,t.nick)},mouseleave:function(e){return t.renderUserCard(t.createrInfo)}}},[i("badge-twitter",{attrs:{width:t.width,"user-data":t.userCardItem,"show-attention":t.showAttention}}),t._v(" "),i("a",{staticClass:"avatar-img-container",attrs:{href:"/user/"+t.nick+t.urlSuffix,target:"_blank"}},[i("img",{staticClass:"avatar-img",attrs:{src:"/asset/avatar/"+t.nick}})])],1)}),[],!1,null,"7ce1c7c7",null);e.a=o.exports},2035:function(t,e,i){"use strict";i.d(e,"n",(function(){return C})),i.d(e,"B",(function(){return k})),i.d(e,"C",(function(){return O})),i.d(e,"a",(function(){return x})),i.d(e,"q",(function(){return j})),i.d(e,"z",(function(){return I})),i.d(e,"h",(function(){return T})),i.d(e,"g",(function(){return S})),i.d(e,"m",(function(){return D})),i.d(e,"p",(function(){return q})),i.d(e,"o",(function(){return E})),i.d(e,"r",(function(){return A})),i.d(e,"i",(function(){return M})),i.d(e,"v",(function(){return $})),i.d(e,"x",(function(){return L})),i.d(e,"e",(function(){return P})),i.d(e,"k",(function(){return F})),i.d(e,"j",(function(){return R})),i.d(e,"D",(function(){return N})),i.d(e,"b",(function(){return B})),i.d(e,"l",(function(){return U})),i.d(e,"d",(function(){return H})),i.d(e,"s",(function(){return V})),i.d(e,"y",(function(){return z})),i.d(e,"w",(function(){return G})),i.d(e,"c",(function(){return K})),i.d(e,"f",(function(){return W})),i.d(e,"A",(function(){return Q})),i.d(e,"u",(function(){return J})),i.d(e,"t",(function(){return Y}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(127),n=i.n(s),o=i(1970),r=i(1320),l=i(2023),c=i(2052),d=i(2003),u=i(2018),p=i(2053),h=i(2001),m=i(2009),v=i(2024),g=i(2017),f=i(2015),_=i(2016),b=i(57),y=i(2050),w=i(2036);const C=()=>{const t=Object(a.r)(!1),e=Object(a.r)("");return{isShowConfirmModal:t,reshipTargetId:e,onOpenConfirmModal:i=>{t.value=!0,e.value=i},onCloseConfirmModal:()=>{t.value=!1,e.value=""}}},k=(t,e)=>{const i=Object(a.r)(!1),s=Object(a.r)({}),n=Object(a.r)(!1),o=Object(a.r)([]);return Object(a.m)(()=>{const a=document.querySelector(e);i.value=!0,s.value={dom:{contentEleSelector:()=>{var e;return a||(null===(e=t.refs)||void 0===e?void 0:e.content)}}}}),{isInit:i,isShow:n,tocList:o,tocOptions:s,onTocDataChange:()=>{var i;const a=document.querySelector(e),s=Object(y.b)(a||(null===(i=t.refs)||void 0===i?void 0:i.content));o.value=s.tocData,n.value=s.isShow}}},O=(t,e)=>{const i=Object(a.r)(t),s=Object(a.r)(e),n=Object(a.r)(e);return{currentGroupId:i,realPostId:s,groupPostId:n,transArticleId:t=>Object(d.ab)(t).then(({data:t})=>{var e,a,o;0===(null==t?void 0:t.code)&&(i.value=null==t||null===(e=t.data)||void 0===e?void 0:e.group_id,s.value=null==t||null===(a=t.data)||void 0===a?void 0:a.article_id,n.value=null==t||null===(o=t.data)||void 0===o?void 0:o.group_article_id)})}},x=()=>{const t=Object(a.r)(!1),e=Object(a.r)(!1),i=Object(a.r)({}),s=Object(a.r)(!1),n=Object(a.r)(!1),o=Object(a.r)(!1),r=Object(a.r)(!1),l=Object(a.r)([]);return{isAdmin:t,isKbarAdmin:e,isTop:s,isRecommend:n,isEssential:o,isHidden:r,actionData:i,diggUserList:l,fetchAcions:(a,c)=>{Object(d.s)({currentGroupId:a,postId:c}).then(({data:a})=>{var c,d,u,p,h;const m=(null==a||null===(c=a.data)||void 0===c?void 0:c.actions)||{};i.value=m,s.value=null==m||null===(d=m.top)||void 0===d?void 0:d.is_top,o.value=null==m||null===(u=m.essential)||void 0===u?void 0:u.is_essential,n.value=null==m||null===(p=m.km_recommend)||void 0===p?void 0:p.is_recommended,r.value="1"===(null==m?void 0:m.is_hidden),t.value=null==m?void 0:m.is_admin,e.value=!(null==m||!m.top)||!(null==m||!m.essential),l.value=(null==m||null===(h=m.digg)||void 0===h?void 0:h.latest_digged_user_list)||[]})}}},j=()=>{const t=Object(a.r)(!1);return{isHeadline:t,getHeadlineInfo:e=>{Object(d.q)(e).then(({data:e})=>{var i;t.value=null==e||null===(i=e.data)||void 0===i?void 0:i.is_headline})}}},I=()=>{const t=Object(a.r)([]),e=Object(a.r)("");return{rewardQrcodeUrl:e,articleRewards:t,buildQrCode:t=>{const i=`${window.location.protocol}//${window.location.host}/articles/show/${t}?reward=1`;Object(g.a)(i,{margin:0}).then(t=>e.value=t).catch(t=>console.error(t))},getArticleReward:e=>{Object(d.v)(e).then(({data:e})=>{var i;const a=(null==e||null===(i=e.data)||void 0===i?void 0:i.rewards)||[],s=a.length>30?a.slice(0,30):a,n={},o=[];s.forEach(t=>{const e=t.from_user;n[e]||(n[e]=!0,o.push(t))}),t.value=o})}}},T=()=>{const t=Object(a.r)([]);return{attachments:t,getAttachments:e=>{Object(d.o)(e).then(({data:e})=>{var i,a;const s=null==e||null===(i=e.data)||void 0===i||null===(a=i.attachments)||void 0===a?void 0:a.map(t=>{if("ppt"===t.type||"pptx"===t.type){const e=["Print","DownloadImg","PlayContextCheckImage","FloatMenuCheckImage","WPPMobileCommentButton"].map(t=>({cmbId:t,attributes:{enable:!1,visible:!1}})),i={isSlidesStatusPlay:!0},a=JSON.stringify({commandBars:e,pptOptions:i});return{...t,preview_url:t.preview_url&&"function"==typeof window.btoa?`${t.preview_url}&htmlParams=${window.btoa(a)}`:t.preview_url}}return t});t.value=s||[]})}}},S=({isTop:t,isRecommend:e,isEssential:i,isHidden:s,article:n,userToken:o,currentGroupId:r,groupPostId:l,context:c})=>{const u=Object(a.r)(!1),p=Object(a.r)(!1),h=Object(a.r)(!1);return{isShowEditModal:u,isShowEditConfirmModal:p,isShowBottomEditModal:h,actionDeal:(a,m)=>{const v={edit:()=>{var t,e,i,a;if(w.a.includes(null==n||null===(t=n.value)||void 0===t?void 0:t.source_id))return void(p.value=!0);const s=r.value?`${location.origin}/group/${null==n||null===(e=n.value)||void 0===e?void 0:e.group_id}/articles/edit/${null==l?void 0:l.value}`:`/user/${null==n||null===(i=n.value)||void 0===i?void 0:i.created_by}/articles/edit/${null==n||null===(a=n.value)||void 0===a?void 0:a.id}`;window.open(s)},delete:()=>{c.root.$newConfirm("warning","你确定要删除吗？",{confirm:()=>{var t;(r.value?d.k:d.i)(r.value?{groupId:r.value,groupPostId:l.value,userToken:o.value}:{postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id,userToken:o.value}).then(()=>{var t;location.href=r.value?`/group/${r.value}/articles`:`/user/${null==n||null===(t=n.value)||void 0===t?void 0:t.created_by}/articles`})},confirmText:"删除"})},setTop:()=>{Object(d.X)({groupId:r.value,groupPostId:null==l?void 0:l.value,userToken:o.value,isTop:t.value?"0":"1"}).then(({data:e})=>{0===(null==e?void 0:e.code)&&(t.value=!t.value),Object(f.a)(c.root)(e)})},setEssential:()=>{Object(d.V)({groupId:r.value,groupPostId:null==l?void 0:l.value,userToken:o.value,isEssential:i.value?"0":"1"}).then(({data:t})=>{0===(null==t?void 0:t.code)&&(i.value=!i.value),Object(f.a)(c.root)(t)})},recommend:()=>{var t;!e.value&&Object(d.Z)({userToken:o.value,postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id,pushClans:m}).then(({data:t})=>{0===(null==t?void 0:t.code)&&(e.value=!e.value),Object(f.a)(c.root)(t)})},articleCover:()=>{var t;Object(d.U)({userToken:o.value,postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id,imgName:m}).then(({data:t})=>{Object(f.a)(c.root)(t)})},setAbstract:()=>{var t,e;n.value.abstract=m,Object(d.T)({userToken:o.value,postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id,summary:null==n||null===(e=n.value)||void 0===e?void 0:e.abstract}).then(({data:t})=>{Object(f.a)(c.root)(t)})},exportComment:()=>{var t,e;window.location.href=`/articles/export_comments/${null==n||null===(t=n.value)||void 0===t?void 0:t.id}?code=article_${null==n||null===(e=n.value)||void 0===e?void 0:e.id}_${parseInt((new Date).getTime()/1e3,10)}`},exportVisit:()=>{var t,e;window.location.href=`/articles/export_access_state/${null==n||null===(t=n.value)||void 0===t?void 0:t.id}?code=article_${null==n||null===(e=n.value)||void 0===e?void 0:e.id}_${parseInt((new Date).getTime()/1e3,10)}&export=1`},hideGlobal:()=>{var t;Object(d.N)({userToken:o.value,postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id,isHidden:!s.value}).then(({data:t})=>{0===(null==t?void 0:t.code)&&(s.value=!s.value),Object(f.a)(c.root)(t)})},changeGroup:()=>{var t;Object(d.c)({newGroupId:m,postId:null==n||null===(t=n.value)||void 0===t?void 0:t.id}).then(({data:t})=>{Object(f.a)(c.root)(t)})}}[a];v&&v(),u.value=!1,h.value=!1}}},D=()=>{const t=Object(a.r)(!1);return{isShowCollectModal:t,openCollectModal:()=>{t.value=!0},onCollectSubmit:()=>{t.value=!1}}},q=({postId:t,context:e})=>{const i=Object(a.r)(!1);return{isShowFeedbackModal:i,openFeedbackModal:()=>{i.value=!0},onFeedbackModaSubmit:a=>{var s;const n=a;n.target_type="Post",n.target_id=t,n.url="",n.feedback_type="content",n.reserve_options=JSON.stringify({origin_url:location.href}),n.content_type=null==a||null===(s=a.content_type)||void 0===s?void 0:s.join("|"),Object(p.b)(n).then(({data:t})=>{Object(f.a)(e.root)(t)}),i.value=!1}}},E=({article:t,diggUserList:e,userInfo:i,currentGroupId:s,props:n})=>{const o={key:"view",value:0,iconName:"operation/view",noHover:!0},r={key:"comment",value:0,iconName:"operation/comment-gray",onClick:()=>{T("top")}},l={key:"favorite",value:0,iconName:"operation/favorite",onClick:()=>{I("top")}},c={key:"share",value:"分享",iconName:"operation/share",onClick:()=>{D("top")}},u=Object(a.r)([o,r,l,c]),p=Object(a.r)(!1),h=Object(a.r)(!1),m=Object(a.r)(0),v=Object(a.r)(0),g=Object(a.r)(0),f=Object(a.r)(!1),_=Object(a.r)(!1),y=Object(a.r)(!1);let w=0,C=!1;const k=Object(a.r)(!1),O=Object(a.r)(""),x=Object(a.r)(!1),j=Object(a.r)(""),I=e=>{if(x.value)return;h.value||(x.value=!0,j.value="https://assets.km.tencent.com/ImageHosting/20230815/201f200de6029ff08332a0bed8f41ded.gif",setTimeout(()=>{x.value=!1,j.value=""},700));const i={target_id:t.value.id,target_type:"Post"},a=h.value?d.j:d.g;s.value&&"0"!==s.value&&(i.group_id=s.value),a(i).then(({data:e})=>{var i;0===(null==e?void 0:e.code)&&(l.value=null==e?void 0:e.data.bookmark_count,v.value=null==e?void 0:e.data.bookmark_count,l.iconName=h.value?"operation/favorite":"operation/favorite-active",u.value=[...u.value],h.value=!h.value,Object(b.b)("postBookmark",{post_id:t.value.id,author_nick:t.value.created_by,show_groups:n.isKnwl?n.knwlGroupId:s.value,group_id:null===(i=t.value)||void 0===i?void 0:i.group_id,operation_type:h.value?"bookmark":"cancelBookark"}))}),Object(b.b)("articleActionClick",{action:"bookmark",place:e||""})},T=t=>{if(C)window.scrollTo({top:w});else{w=window.scrollY;document.querySelector(".comment-header").scrollIntoView()}C=!C,Object(b.b)("articleActionClick",{action:"comment",place:t||""})},S=()=>{document.documentElement.scrollTop>0?f.value=!0:f.value=!1},D=t=>{_.value=!0,Object(b.b)("articleActionClick",{action:"share",place:t||""})};return Object(a.m)(()=>{window.addEventListener("scroll",S)}),Object(a.n)(()=>{window.removeEventListener("scroll",S)}),{viewItem:o,commentItem:r,barOptions:u,isDigged:p,isFavored:h,isShowShareModal:_,isShowFavorModal:y,isShowBackTop:f,diggCount:m,favorCount:v,commentCount:g,isDigging:k,digGifUrl:O,isFavoring:x,favorGifUrl:j,onDigg:a=>{var o,r;if(k.value)return;p.value||(k.value=!0,O.value="https://assets.km.tencent.com/ImageHosting/20230815/0c7ddd98b314bd787ded6411aa8d76f7.gif",setTimeout(()=>{k.value=!1,O.value=""},700));const l=p.value?d.l:d.h,c={target_id:t.value.id,target_type:"Post"};s.value&&"0"!==s.value&&(c.group_id=s.value),l(c).then(({data:e})=>{var i,a;0===(null==e?void 0:e.code)&&(m.value=null==e||null===(i=e.data)||void 0===i?void 0:i.vote_count,p.value=!p.value,Object(b.b)("postDigg",{post_id:t.value.id,author_nick:t.value.created_by,show_groups:n.isKnwl?n.knwlGroupId:s.value,group_id:null===(a=t.value)||void 0===a?void 0:a.group_id,operation_type:p.value?"dig":"cancelDig"}))});const u=null==i||null===(o=i.value)||void 0===o?void 0:o.nick,h=0!==(null==i||null===(r=i.value)||void 0===r?void 0:r.is_expert)?1:0;p.value?e.value=e.value.filter(t=>t.created_by!==u):e.value.unshift({created_by:u,is_expert:h}),Object(b.b)("articleActionClick",{action:"digg",place:a||""})},onFavor:I,onModalFavor:t=>{h.value||(y.value=!0),I(t)},onShare:D,onTotop:()=>{window.scrollTo(0,0)},onToComment:T,getReadCount:t=>{Object(d.u)(t).then(({data:t})=>{var e;o.value=(null==t||null===(e=t.data)||void 0===e?void 0:e.read_count)||0,u.value=[...u.value]})},getFeedBackInfo:t=>{Object(d.C)({target_id:t,target_type:"Post",need_comment_info:1,need_vote_info:1,need_bookmark_info:1}).then(({data:t})=>{var e;((null==t||null===(e=t.data)||void 0===e?void 0:e.info)||[]).forEach(t=>{"comment"===t.feedback_type&&(r.value=t.feedback_count,g.value=t.feedback_count),"bookmark"===t.feedback_type&&(l.value=t.feedback_count,l.iconName=t.is_interacted?"operation/favorite-active":"operation/favorite",v.value=t.feedback_count,h.value=!!t.is_interacted),"vote"===t.feedback_type&&(m.value=t.feedback_count,p.value=!!t.is_interacted)}),u.value=[...u.value]})}}},A=()=>{const t=Object(a.r)(0);return{hotRank:t,getHotRank:e=>{Object(d.r)(e).then(({data:e})=>{var i;t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.rank)||0})}}},M=t=>{const e=Object(a.r)([]);return{authorArticles:e,getArticleList:i=>{Object(d.A)({created_by:i,limit:4}).then(({data:i})=>{var a;const s=(null==i||null===(a=i.data)||void 0===a?void 0:a.articles)||[],n=s.filter(e=>{var i;return e.title!==(null==t||null===(i=t.value)||void 0===i?void 0:i.title)});e.value=n.length>=1?n.slice(0,3):s})}}},$=()=>{const t=Object(a.r)([]);return{youLikeArticles:t,getYouLike:e=>{Object(d.M)({nick:e,limit:5,is_shuffle:!0}).then(({data:e})=>{var i;t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.articles)||[]})}}},L=()=>{const t=Object(a.r)([]);return{relativeArticles:t,getRelativeArticles:e=>{Object(d.G)({article_id:e}).then(({data:e})=>{var i;t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.articles)||[]})}}},P=()=>{const t=Object(a.r)([]);return{articleTags:t,getTags:e=>Object(d.y)(e).then(({data:e})=>{var i;return t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.tags)||[],t.value})}},F=()=>{const t=Object(a.r)({});return{articleCategory:t,getCategory:e=>{Object(d.p)(e).then(({data:e})=>{var i;t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.category)||{}})}}},R=({context:t,article:e})=>{const i=Object(a.r)({}),s=Object(a.a)(()=>t.root.$store.getters["global/userPublicInfo"]),n=Object(a.a)(()=>{var t,i;return(null===(t=s.value)||void 0===t?void 0:t[null===(i=e.value)||void 0===i?void 0:i.created_by])||{}}),o=Object(a.a)(()=>{var t;return`/user/${null===(t=e.value)||void 0===t?void 0:t.created_by}?award_id=${i.value.id}`});return{userMedal:i,createrInfo:n,userMedalLink:o,getAuthorInfo:e=>t.root.$store.dispatch("global/getUserPublicInfo",e),getAuthorMedal:t=>{Object(h.r)({nick:t}).then(({data:t})=>{var e;0===(null==t?void 0:t.code)&&(i.value=(null==t||null===(e=t.data)||void 0===e?void 0:e.current_award)||{})})},jumpToPersonPage:()=>{var t;window.open("/user/"+(null===(t=e.value)||void 0===t?void 0:t.created_by))}}},N=()=>{let t=null,e=null;return Object(a.j)(()=>{var i,a;null===(i=t)||void 0===i||i.disconnect(),null===(a=e)||void 0===a||a.disconnect()}),{instanceWater:t,instanceHWater:e,initWater:e=>{t?t.draw():Object(l.b)().then(({data:i})=>{t=new v.b({watermarked:".article-content",img:null==i?void 0:i.url,...e}),t.draw()})},initHWater:t=>{e?e.draw():Object(l.a)().then(({data:i})=>{var a;e=new v.a({watermarked:".article-content",img:null==i||null===(a=i.data)||void 0===a?void 0:a.url,...t}),e.draw()})}}},B=()=>{const t=Object(a.r)(!1);return{hasArticleEditPermission:t,getArticleEditPermisson:e=>{const i=n.a.get("km_uid")||n.a.get("storm_km_id");return Object(c.a)({access_entry:{target_id:e,target_type:"post",nick:i,action:"update"}}).then(({data:e})=>{var i;0===(null==e?void 0:e.code)&&(t.value=!(null!=e&&null!==(i=e.data)&&void 0!==i&&i.limit))})}}},U=()=>{const t=Object(a.r)([]);return{collectedKnowledgeList:t,getCollectedKnowledges:e=>Object(u.o)({target_id:e,target_type:"article"}).then(({data:e})=>{if(0===(null==e?void 0:e.code)){var i;const a=(null==e||null===(i=e.data)||void 0===i?void 0:i.knowledges)||[];t.value=a.splice(0,3)}}),handleKnowledeCoverError:t=>{const e=i(2114),a=t.srcElement;a.src=e,a.onerror=null}}},H=()=>{const t=Object(a.r)({});return{articleStatus:t,getArticleSettingStatus:(e,i)=>{Object(d.x)(e,i).then(({data:e})=>{var i;0===(null==e?void 0:e.code)&&(t.value=null==e||null===(i=e.data)||void 0===i?void 0:i.statuses)})}}},V=()=>{const t=Object(a.r)(!1),e=Object(a.r)(!1),i=Object(a.r)(!1),s=Object(a.r)("");return{haveApplyKnowledge:t,isShowApplyKnowledge:e,isShowKnowledgeCard:i,knowledgeCardDesc:s,getKnowledgeAward:a=>{Object(d.D)(a).then(({data:a})=>{var n,o,r,l;t.value=null==a||null===(n=a.data)||void 0===n?void 0:n.is_applied,e.value=null==a||null===(o=a.data)||void 0===o?void 0:o.is_show,i.value=null==a||null===(r=a.data)||void 0===r?void 0:r.is_certified,s.value=null==a||null===(l=a.data)||void 0===l?void 0:l.certified_desc})},clickKnowledgeAward:e=>{Object(d.a)(e).then(()=>{t.value=!0})}}},z=()=>{const t=Object(a.r)({});return{reshipInfo:t,getReshipData:e=>Object(d.H)(e).then(({data:e})=>{var i;t.value=(null==e||null===(i=e.data)||void 0===i?void 0:i.reship)||{}})}},G=({context:t})=>{const e=Object(a.r)(!0);return{isHaveEntry:e,fetchRelateEntry:i=>{if(0===(null==i?void 0:i.length))return void(e.value=!1);const a=i.map(t=>t.name);t.root.$store.dispatch("q/fetchRecommendTags",{kstrs:a.join(" ")}).then(()=>{e.value=!0}).catch(()=>{e.value=!1})}}},K=({postId:t,showGroups:e,groupId:i,author:a,windowWidth:s,viewMode:n})=>{Object(b.b)("postDetailView",{post_id:t,show_groups:e,group_id:i,author_nick:a,window_width:s,view_mode:n}),Object(b.c)("postDetailLeave",{post_id:t,show_groups:e,group_id:i,author_nick:a}),Object(b.b)("groupPageView",{group_id:e,group_page_type:"articles"})},W=({article:t})=>{window.addEventListener("playerAllInit",(function(){const e=Object(_.a)();e.forEach(e=>{const i=null==e?void 0:e.getAttribute("id");null==e||e.one("play",()=>{var a,s,n,o,r,l,c,d;const u=(t=>{const e=t.match(/\d+/g);return""+(null==e?void 0:e[0])})(i);Object(m.a)(u),Object(b.b)("videoDetailPlay",{video_id:u,video_name:`文章-${null===(a=t.value)||void 0===a?void 0:a.title}-的视频`,post_id:null===(s=t.value)||void 0===s?void 0:s.id,post_name:null===(n=t.value)||void 0===n?void 0:n.title,group_id:null===(o=t.value)||void 0===o?void 0:o.group_id}),Object(b.c)("videoDetailPlayTime",{video_id:u,video_name:`文章-${null===(r=t.value)||void 0===r?void 0:r.title}-的视频`,post_id:null===(l=t.value)||void 0===l?void 0:l.id,post_name:null===(c=t.value)||void 0===c?void 0:c.title,group_id:null===(d=t.value)||void 0===d?void 0:d.group_id},()=>({content_play_duration:null==e?void 0:e.currentTime()}))})})}))},Q=t=>{let e=0;const i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a=()=>{const{stickyRef:a,rightSideRef:s}=t.refs;if(!a||!s)return;const n=null==a?void 0:a.getBoundingClientRect(),o=null==s?void 0:s.getBoundingClientRect(),r=a.clientHeight-window.innerHeight+120,l=window.innerHeight+window.scrollY>=document.body.offsetHeight,c=i&&l;if(r<=0)return a.style.position="sticky",void(a.style.top="20px");e<window.pageYOffset?"relative"===a.style.position?Math.abs(n.top)>=Math.abs(r)&&n.top<0&&(a.style.position="sticky",a.style.top=-r+"px"):"sticky"===a.style.position&&20===n.top?(a.style.position="relative",a.style.top=Math.abs(o.top)+"px"):(a.style.position="sticky",a.style.top=-r+"px"):(()=>{if(n.top<0){if(c)return;if(a.style.top.replace("px","")-0===-r){const t=Math.abs(r+o.top);a.style.position="relative",a.style.top=t+"px"}}else a.style.position="sticky",a.style.top="20px"})(),e=window.pageYOffset};window.addEventListener("scroll",Object(o.a)(a,15)),window.addEventListener("resize",Object(r.a)(a,500))},J=()=>{let t="true"===n.a.get("readMode");const e=Object(a.r)(t),i=Object(a.r)(!0),s=()=>{window.innerWidth>=1780?(i.value=!0,e.value=t):(i.value=!1,e.value=!1)};return Object(a.m)(()=>{s(),window.addEventListener("resize",Object(r.a)(s,1e3))}),{readMode:e,showReadModeSwitch:i,handleChangeReadMode:i=>{e.value=!e.value,t=e.value,n.a.set("readMode",t,{expires:90}),Object(b.b)("switch_view_mode",{post_id:i,target_mode:e.value?"wide":"narrow"})}}},Y=()=>{const t=window.location.hash.substring(1);if(t){const e="#"+CSS.escape(t),i=document.querySelector(e);i&&i.scrollIntoView()}}},2036:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return o}));i(11),i(12),i(13),i(14),i(15);const a=["52663"],s=({groupId:t,postId:e})=>{const i=window.isProd,a=encodeURIComponent(`${window.location.origin}/articles/show/${e}`);return"52663"===t?i?"https://portal.learn.woa.com/knowledge/km-article/graphic-update?transfer=1&kmUrl="+a:"https://test-portal-learn.woa.com/knowledge/km-article/graphic-update?transfer=1&kmUrl="+a:""},n=["dec411d8c1974774a38789f610795fca","e67139a545594136a6ae175737587a2a"],o=({sourceId:t,articleId:e})=>{if(!t||!n.includes(t))return"";const i=window.isProd;return"dec411d8c1974774a38789f610795fca"===t||"e67139a545594136a6ae175737587a2a"===t?i?"https://portal.learn.woa.com/knowledge/api/v1/user/content-info/edit/"+e:"https://test-portal-learn.woa.com/knowledge/api/v1/user/content-info/edit/"+e:""}},2037:function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);const a={141246:"技术·运维",141247:"产品·市场",141248:"设计·用研",141249:"项目·质量",141250:"企管·文化",141251:"行政·福利",141252:"其他"},s=[{label:"技术·运维",value:"141246"},{label:"产品·市场",value:"141247"},{label:"设计·用研",value:"141248"},{label:"项目·质量",value:"141249"},{label:"企管·文化",value:"141250"},{label:"行政·福利",value:"141251"},{label:"其他",value:"141252"}],n={141246:"技术·运维",141247:"产品·市场",141248:"设计·用研",141249:"项目·质量",141250:"企管·文化",141251:"行政·福利",141252:"其他"}},2038:function(t,e,i){"use strict";i.d(e,"d",(function(){return p})),i.d(e,"e",(function(){return m})),i.d(e,"c",(function(){return h})),i.d(e,"a",(function(){return v})),i.d(e,"f",(function(){return g})),i.d(e,"g",(function(){return f})),i.d(e,"b",(function(){return _}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1320),n=i(123),o=i(1899),r=i.n(o),l=i(2001),c=i(2003),d=(i(2050),i(2002)),u=i(2025);const p=t=>{const e=Object(a.r)(""),i=Object(a.r)(""),s=Object(a.a)(()=>t.$store.getters["global/kbarList"]),n=Object(a.a)(()=>t.$store.getters["global/kbarCategoryInfo"][e.value]||[]),o=e=>t.$store.dispatch("global/getKbarCategoryInfo",e);return Object(a.m)(()=>{t.$store.dispatch("global/getKbarList")}),Object(a.u)(()=>e.value,t=>{o(t).then(()=>{n.value.length>0&&(i.value=n.value[0].value)})}),{kbar:e,kbarCategoryType:i,kbarOptions:s,kbarCategoryOptions:n,getKbarCategoryInfo:o}},h=()=>{const t=Object(a.r)(""),e=Object(a.r)("");return{imageName:e,imageUrl:t,handleDelete:()=>{t.value="",e.value=""},handleUploadFinished:i=>{t.value=i.preview_url,e.value=i.name,console.log("imgData",i)}}},m=()=>{const t=Object(a.r)([]),e=Object(a.r)([]),i=Object(a.r)([]),o=Object(s.a)(t=>{Object(l.d)(t).then(({data:t})=>{const i=t.map(t=>{const e=t[0];return{label:t[1],value:e}});e.value=i})},200);return{tags:i,handleGetTags:t=>{Object(c.K)(t).then(({data:t})=>{const e=Object(n.a)(t,"tags",[]);i.value=e.map(t=>({name:t}))})},manager:t,managerOptions:e,handleSearch:o,onTagSuccess:t=>{i.value=t}}},v=()=>{var t;const e=Object(a.r)(""),i=Object(u.e)(),s=((null===(t=document.querySelector(".bulletin"))||void 0===t?void 0:t.clientHeight)||0)+200+40,n=Object(a.q)({min_height:650,max_height:650,...i,custom_plugin_config:{lxtoc:{dom:{parentEleSelector:".post-container",contentEleSelector:()=>window.tinymce.activeEditor.getBody(),referenceSelector:".post-inputs"},position:{contentOffsetTop:s},eventBindDom:{contentScrollEle:window}}},paste_preprocess(t,e){Object(u.a)(e),Object(u.b)(e)},paste_postprocess(t,e){Object(u.c)(e)},setup:t=>{t.on("change",()=>{e.value=window.tinymce.activeEditor.getContent()})}});return{content:e,editorConfigs:n}},g=()=>{const t=Object(a.r)(""),e=Object(u.e)(),i=Object(a.q)({min_height:650,max_height:650,...e,paste_preprocess(t,e){Object(u.a)(e),Object(u.b)(e)},paste_postprocess(t,e){Object(u.c)(e)},setup:e=>{e.on("change",()=>{t.value=window.tinymce.activeEditor.getContent()})}});return{content:t,editorConfigs:i}},f=()=>{const t=Object(a.r)(!1),e=Object(a.r)([]);return{showRelativeModal:t,relativeArticleList:e,openRelativeModal:()=>{t.value=!0},closeRelativeModal:()=>{t.value=!1},handleRelativeSubmit:t=>{e.value=t.slice(),console.log("submitData",t)},handleRemoveArticle:t=>{e.value.splice(t,1)}}},_=t=>{const{root:e,kbar:i,kbarCategoryType:s,content:o,manager:l,managerOptions:u,tags:p,refs:h,imageName:m,imageUrl:v,relativeArticleList:g}=t,{params:f,meta:_}=e.$route,b=Object(d.a)(e,"article",["getArticleDetail"]),y=Object(d.b)(e,"article",["articleDetail"]),w=Object(a.r)(!1),C=Object(a.r)("edit"===_.type),k=Object(a.r)("groupArticle"===_.target),O=Object(n.a)(f,"articleId",""),x=k.value?Object(n.a)(f,"id",0):0,j=Object(a.r)({articleId:O,groupId:x,draftId:"",draftParentId:"",title:"",introduction:"",content:o,source:"",articleFrom:"",category:"",kbar:i,kbarCategoryType:s,tags:p,imageName:m,imageUrl:v,enableWaterMark:!1,manager:l,relativeArticleList:g}),I=Object(a.q)({title:[{required:!0,message:"请输入文章标题"}],articleFrom:[{required:!0,message:"请选择文章来源"}],category:[{required:!0,message:"请选择文章分类"}],manager:[{required:!0,message:"请输入管理员"}],tags:[{required:!0,message:"请输入文章标签"}]});Object(a.m)(()=>{C.value&&b.getArticleDetail({article_id:parseInt(f.articleId,10),group_id:parseInt(x,10)}).then(()=>{w.value=!0})}),Object(a.u)(()=>y.articleDetail(),t=>{var e;j.value.articleId=Object(n.a)(t,"article_id",""),j.value.title=Object(n.a)(t,"title",""),j.value.introduction=Object(n.a)(t,"leadwords",""),j.value.articleFrom=Object(n.a)(t,"source.src",""),j.value.source=Object(n.a)(t,"source.link",""),j.value.category=Object(n.a)(t,"category.category_id","").toString(),j.value.enableWaterMark="on"===Object(n.a)(t,"watermark"),i.value="KBAR:"+Object(n.a)(t,"group.group_id","").toString(),s.value=Object(n.a)(t,"group.category_id","").toString(),o.value=Object(n.a)(t,"content",""),m.value=Object(n.a)(t,"image.name",""),v.value=Object(n.a)(t,"image.link","");const a=Object(n.a)(t,"manager"),r=a?a.split(","):[];l.value=r,u.value=r.map(t=>({label:t,value:t})),p.value=null===(e=t.tags)||void 0===e?void 0:e.map(t=>({name:t})),g.value=Object(n.a)(t,"related_article_list",[])});const T=t=>{const e=location.href.replace("/vkm","");return"new"===t?e+"?editor=md&type=new":e+"?editor=md&type=old"};return{form:j,rules:I,isEdit:C,isGroupArticle:k,contentLoad:w,handleSaveDraft:()=>{const t=r()("#editor-form").serializeArray();Object(c.R)(t).then(t=>{j.value.draftId=Object(n.a)(t,"data.draft_id")||"",j.value.draftParentId=Object(n.a)(t,"data.draft_parent_id")||"",console.log("save-draft",t)})},handlePreview:()=>{r()("#editor-form").attr("action","/user/shengyi/articles/preview"),r()("#editor-form").attr("target","_blank"),r()("#editor-form").submit(),r()("#editor-form").removeAttr("action"),r()("#editor-form").removeAttr("target")},handleSubmit:()=>{h.myForm.validate(t=>{if(t){const t=r()("#editor-form").serializeArray();Object(c.R)(t).then(t=>{j.value.draftId=Object(n.a)(t,"data.draft_id")||"",j.value.draftParentId=Object(n.a)(t,"data.parent_id")||"";const i=(t=>{const{params:e,meta:i}=t,a=`/user/${e.id}/articles/add`,s=`/user/${e.id}/articles/edit/${e.articleId}`,n=`/group/${e.id}/articles/add`,o=`/group/${e.id}/articles/edit/${e.articleId}`,r=`/user/${e.id}/articles/restore_draft/${e.articleId}`;return"draft"===i.target?r:"add"===i.type?"userArticle"===i.target?a:n:"edit"===i.type?"groupArticle"===i.target?o:s:void 0})(e.$route);r()("#editor-form").attr("action",i),r()("#editor-form").submit(),r()("#editor-form").removeAttr("action")})}})},handleCancel:()=>{history.go(-1)},changeURLArg:T,handleSwitchEditorMode:t=>{window.location.href=T("new"===t?"new":"old")}}}},2039:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(11),i(12),i(13),i(14),i(15);const a=()=>({privates:[{label:"公开",value:0},{label:"仅限邀请名单",value:1},{label:"仅K吧成员与邀请成员",value:2}],forms:[{label:"线下",value:"1"},{label:"线上",value:"2"}],categories:[{label:"分享讲座",value:1581,color:"#EBF6FF",borderColor:"#5CAFF5"},{label:"专业培训",value:1582,color:"#ECF9EB",borderColor:"#37EC27"},{label:"协会活动",value:1583,color:"#FFF7F0",borderColor:"#FF9F4C"},{label:"部门团建",value:1589,color:"#EBEEFF",borderColor:"#7387FF"},{label:"行政福利",value:1588,color:"#FFF7DD",borderColor:"#FFC400"},{label:"比赛项目",value:1584,color:"#FAF0FF",borderColor:"#D181F9"},{label:"公益活动",value:1590,color:"#FAE8E8",borderColor:"#FF8C8C"},{label:"其他活动",value:1592,color:"#E9FCFA",borderColor:"#1BE8D2"}],cities:["深圳","北京","上海","广州","成都","武汉","香港","重庆","西安","其他"].map(t=>({label:t,value:t}))})},2040:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
var a={align:{type:String,validator:function(t){return!t||["start","end","center","baseline"].includes(t)}},breakLine:Boolean,direction:{type:String,default:"horizontal",validator:function(t){return!t||["vertical","horizontal"].includes(t)}},separator:{type:[String,Function]},size:{type:[String,Number,Array],default:"medium"}}},2041:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return n}));i(11),i(12),i(13),i(14),i(15);const a={id:"",logo:"",count:"1",name:"",description:"",records:[],is_wear:"0"},s=["13"],n={13:{intro:"/articles/show/606246",expiryDate:"/articles/show/606481"}}},2042:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2026),n=i(2006);const o={display:"block",maxWidth:"100%",maxHeight:"100%"},r=["png","jpeg"];var l=i(2085),c=i(2048),d=i(2051),u=i(1942),p=i.n(u),h=(i(1943),Object(a.c)({name:"UploadCropper",components:{Upload:s.a,KmButton:n.a},model:{prop:"value",event:"syncValue"},props:{value:{type:String,default:""},packetBlock:{type:Number,required:!0},acceptExt:{type:String,default:".jpg,.png,.jpeg"},containerWidth:{type:Number,default:718},containerHeight:{type:Number,default:305},uploadStyle:{type:Object,default:()=>({})},cropperConfig:{type:Object,default:()=>({})},cropperContainerStyle:{type:Object,default:()=>({})},cropperImgStyle:{type:Object,default:()=>({...o})},submitText:{type:String,default:"保存"}},setup(t,{emit:e,root:i}){const{containerWidth:s,containerHeight:n,uploadStyle:u,cropperConfig:h,cropperContainerStyle:m,cropperImgStyle:v,value:g,packetBlock:f}=Object(a.t)(t),_=Object(a.r)(),b=Object(a.r)(!1);let y=null;const{DEFAULT_UPLOAD_STYLE:w,DEFAULT_CROPPER_CONFIG:C,CROPPER_CONTAINER_STYLE:k}=((t,e)=>{const i=t+"px",a=e+"px";return{DEFAULT_UPLOAD_STYLE:{height:a,width:i},DEFAULT_CROPPER_CONFIG:{viewMode:2,dragMode:"move",aspectRatio:5.7,highlight:!1,guides:!1,background:!1,autoCropArea:1,minContainerWidth:t,minContainerHeight:e},CROPPER_CONTAINER_STYLE:{borderRadius:"4px",width:i,height:a}}})(s.value,n.value),O=Object.freeze({...C,ready:()=>b.value=!0,...h.value}),x=Object.freeze({...w,...u.value}),j=Object.freeze({...k,...m.value}),I=Object.freeze({...o,...v.value}),T=()=>{const t=g.value;t?_.value&&i.$nextTick(()=>{y?y.replace(t):y=new p.a(_.value,O)}):b.value=!1};Object(a.u)(g,()=>T());return Object(a.m)(()=>{T()}),{cropperImg:_,isShowCropper:b,mixedUploadStyle:x,mixedCropperContainerStyle:j,mixedCropperImgStyle:I,handleUpload:t=>{const{file:i}=t,a=window.URL.createObjectURL(i);e("syncValue",a),e("upload",{file:i,url:a})},handleSubmit:()=>{let t=Object(l.b)(g.value);"jpg"===t&&(t="jpeg"),r.includes(t)||(t="png"),y.getCroppedCanvas({imageSmoothingQuality:"medium"}).toBlob(async a=>{try{a.size>d.a&&console.log("> FILE_SIZE_30M"),Object(l.a)(a,t),Object(c.a)({block:f.value,filename:window.temporaryFile.name,cb:({url:t})=>e("submit",{url:t}),onErr:()=>i.$toast("图片上传失败，请重试",{status:"error",positon:"center"})})}catch(t){console.error(t),i.$toast("图片上传失败，请重试",{status:"error",positon:"center"})}},"image/"+t)}}}})),m=i(68),v=Object(m.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-cropper__container"},[i("upload",{directives:[{name:"show",rawName:"v-show",value:!t.value,expression:"!value"}],style:t.mixedUploadStyle,attrs:{"http-request":t.handleUpload,drag:"",accept:t.acceptExt}},[i("div",{staticClass:"upload__container",style:t.mixedUploadStyle},[i("div",{staticClass:"upload__center"},[i("svg-icon",{attrs:{name:"common/upload",width:86,height:63}}),t._v(" "),i("p",{staticClass:"upload__tip"},[t._v("\n          将文件拖到此处，或\n          "),i("span",[t._v("点击上传")])])],1)])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowCropper,expression:"isShowCropper"}],style:t.mixedCropperContainerStyle},[i("img",{ref:"cropperImg",style:t.mixedCropperImgStyle,attrs:{src:t.value,crossOrigin:""}})]),t._v(" "),i("span",{class:["buttons",{"buttons--flex-end":!t.value}]},[i("upload",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],attrs:{"http-request":t.handleUpload,accept:t.acceptExt}},[i("div",{staticClass:"upload__button--reupload"},[i("svg-icon",{attrs:{name:"common/reupload",width:20,height:20}}),t._v(" "),i("span",{staticStyle:{"margin-left":"6px"}},[t._v("重新上传")])],1)]),t._v(" "),i("km-button",{staticClass:"upload__button--save",attrs:{disabled:!t.value},on:{click:t.handleSubmit}},[t._v("\n      "+t._s(t.submitText)+"\n    ")])],1)],1)}),[],!1,null,"00b71fe2",null);e.a=v.exports},2043:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(168);const n={1:i(2077),2:i(2078),3:i(2079)};var o=Object(a.c)({name:"HotList",components:{},props:{width:{type:String,default:"300"},inited:{type:Boolean,default:!1},showDesc:{type:Boolean,default:!0},title:{type:String,default:"文章热榜"},data:{type:Array,default:()=>[]},moreUrl:{type:String,default:""},border:{type:Boolean,default:!1},suffix:{type:String,default:""}},setup:t=>({listStyle:Object(a.a)(()=>({width:t.width+"px",border:t.border?"1px solid #eaecf0":"none"})),getOrderNumberStyle:t=>void 0===n[t+1]?{}:{backgroundImage:`url(${n[t+1]})`},addSuffixToUrl:s.c,handleOpenMore:()=>{window.open(t.moreUrl)}})}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("t-list",{staticClass:"hot-list",style:t.listStyle,attrs:{split:!1}},[i("div",{staticClass:"hot-list-header",attrs:{slot:"header"},slot:"header"},[t._v("\n    "+t._s(t.title)+"\n    "),t.moreUrl?i("a",{staticClass:"hot-list-header-more",attrs:{href:t.moreUrl,target:"_blank"}},[i("svg-icon",{attrs:{name:"common/new-arrow",width:20,height:20,viewBox:"0 0 20 20",color:"#666"}})],1):t._e()]),t._v(" "),t.data.length?i("div",t._l(t.data,(function(e,a){return i("t-list-item",{key:e.id,staticClass:"hot-list-item"},[i("div",{staticClass:"hot-list-item-content",attrs:{slot:"content"},slot:"content"},[i("span",{class:["order-number",a<3&&"order-number-special"],style:t.getOrderNumberStyle(a)},[t._v("\n          "+t._s(a<3?void 0:a+1)+"\n        ")]),t._v(" "),i("div",{staticClass:"hot-list-item-content-text"},[i("a",{class:["hot-list-item-content-title",a<3&&"hot-list-item-content-title-top-three"],attrs:{target:"_blank",href:t.addSuffixToUrl(e.url,t.suffix)}},[t._v("\n            "+t._s(e.title)+"\n          ")]),t._v(" "),t.showDesc&&e.desc&&a<3?i("a",{staticClass:"hot-list-item-content-desc",attrs:{target:"_blank",href:e.url}},[t._v("\n            "+t._s(e.desc)+"\n          ")]):t._e()])])])})),1):t.inited?i("div",{staticClass:"empty-list"},[t._v("\n    暂无内容\n  ")]):i("div",{staticClass:"empty-list"},[t._v("\n    加载中\n  ")])])}),[],!1,null,"786de33f",null);e.a=l.exports},2044:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2016),n=i(2017),o=i(2025),r=Object(a.c)({props:{content:{type:String,defalut:""},isOnlyRichtext:{type:Boolean,default:!1}},setup(t,e){const i=Object(a.a)(()=>({"cherry-markdown":!t.isOnlyRichtext,"stackedit-markdown":!t.isOnlyRichtext})),r=()=>{Object(n.b)({isTargetBlankView:!1}),Object(o.g)(),Object(n.c)(".km-view-content img"),Object(o.f)(),e.emit("contentLoad"),Object(s.e)().then(()=>{Object(s.d)()})};return Object(a.m)(()=>{t.content&&r()}),Object(a.o)(()=>{r()}),{wrapperClass:i}}}),l=i(68),c=Object(l.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"reader-container-wrapper"},[e("div",{staticClass:"reader-container"},[e("div",{ref:"content",staticClass:"km-view-content km-article-content  default",class:this.wrapperClass,domProps:{innerHTML:this._s(this.content)}})])])}),[],!1,null,"6ebdecf7",null);e.a=c.exports},2045:function(t,e,i){"use strict";var a=i(1892),s=i.n(a),n=(i(11),i(12),i(13),i(14),i(15),i(3)),o=Object(n.c)({name:"input-neg-wordcount",components:{venomInput:s.a},props:{placeholder:{type:String,default:"请输入"},value:{type:String,default:"",required:!0},exceedColor:{type:String,default:"#f25555"},maxLen:{type:Number,default:255},showWordCount:{type:Boolean,default:!0}},model:{prop:"value",event:"input"},setup(t,{emit:e}){const{value:i,maxLen:a,exceedColor:s,showWordCount:o}=Object(n.t)(t),r=Object(n.r)(),l=Object(n.r)(a.value-i.value.length),c=Object(n.r)(i.value);let d=!1;const u=Object(n.a)(()=>l.value<0);Object(n.u)(i,t=>{c.value=t}),Object(n.u)(u,(t,e)=>{if(!o.value)return;const i=r.value.$el.querySelector("input").style;t&&!e?(i.border="1px solid "+s.value,i.boxShadow="0 0"):!t&&e&&(i.border="",i.boxShadow="")});const p=()=>{l.value=a.value-c.value.length,e("input",c.value)},h=()=>{d=!0},m=()=>{d=!1,p(),e("compositionEnd")};return Object(n.m)(()=>{const t=r.value.$el.querySelector("input");t.addEventListener("compositionstart",h),t.addEventListener("compositionend",m)}),Object(n.j)(()=>{const t=r.value.$el.querySelector("input");t.removeEventListener("compositionstart",h),t.removeEventListener("compositionend",m)}),{input:r,wordCount:l,isInputExceeds:u,inputVal:c,onInput:()=>{d||p()}}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("venom-input",{ref:"input",attrs:{placeholder:t.placeholder},on:{input:t.onInput},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}},[t.showWordCount?i("div",{staticClass:"tips",style:{color:t.isInputExceeds?t.exceedColor:""},attrs:{slot:"suffix"},slot:"suffix"},[t._v("\n    "+t._s(t.wordCount)+"\n  ")]):t._e()])}),[],!1,null,"10290232",null);e.a=l.exports},2046:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"chcck-mark-radio",props:{radioList:{type:Array,default:()=>[{value:"public",label:"公开",iconWidth:24,icionHeight:24}],required:!0},checkedValue:{type:[String,Number],default:"",required:!0},tips:{type:Object,default:()=>({})},labelFontSize:{type:String,default:"16px"}},setup:(t,{emit:e})=>({onClick:t=>{t.disabled||e("clickRadio",{clickedValue:t.value,checkedItem:t})}})}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{style:{"font-size":t.labelFontSize,display:"flex"}},t._l(t.radioList,(function(e,a){return i("span",{key:e.value,class:["vertical-center",{"radio--disabled":e.disabled}]},[i("span",{staticClass:"radio-icon",style:{"margin-left":a?"24px":""},on:{click:function(i){return t.onClick(e)}}},[i("svg-icon",{attrs:{name:t.checkedValue===e.value?"common/radio-active":"common/radio",width:e.iconWidth||24,height:e.icionHeight||24}})],1),t._v(" "),i("span",{class:{"label--disabled":e.disabled}},[t._v(t._s(e.label))])])})),0),t._v(" "),t.checkedValue&&t.checkedValue in t.tips?i("span",{staticClass:"tips"},[t._v("\n    "+t._s(t.tips[t.checkedValue])+"\n  ")]):t._e()])}),[],!1,null,"11886025",null);e.a=o.exports},2047:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"loading-page",props:{},components:{},setup:()=>({}),data:()=>({}),computed:{},mounted(){},methods:{},filters:{}}),n=i(68),o=Object(n.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"common-load-page-loading"},[e("div",{staticClass:"load-wrapper"},[e("div",{staticClass:"load-icon"},[e("svg-icon",{attrs:{name:"common/load_circle",width:22,height:22}})],1),this._v(" "),e("span",{staticClass:"text"},[this._v("内容加载中")])])])}),[],!1,null,"21d5453f",null);e.a=o.exports},2048:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=async({block:t,filename:e,cb:i,onErr:s,fileEntity:n})=>{var o,r;const l=await(({block:t,files:e})=>a.a.post("/km_bff/asset/v1/get_object_store_packet",{block:t,files:e}))({block:t,files:[{map_id:"1",filename:e}]});if(0!==(null==l||null===(o=l.data)||void 0===o?void 0:o.code))return console.error(l),void(s&&s());const c=null==l||null===(r=l.data)||void 0===r?void 0:r.data,d=null==c?void 0:c.objects[0],u=JSON.parse(null==c?void 0:c.store_conf);try{var p;const t=null==u||null===(p=u.credential)||void 0===p?void 0:p.security_token,e=await(({url:t,file:e,securityToken:i,mimeType:s})=>a.a.put(t,e,{headers:{"x-cos-security-token":i,"Content-Type":s}}))({url:d.url,file:n||window.temporaryFile,securityToken:t,mimeType:d.mime_type});if(200!==(null==e?void 0:e.status))return console.error(e),void(s&&s())}catch(t){return console.error(t),void(s&&s())}const{data:h}=await(({object:t,isDownload:e})=>a.a.post("/km_bff/asset/v1/create_from_object",{object:t,is_download:e||!1}))({object:d});if(0===(null==h?void 0:h.code)){var m;const t=(null==h||null===(m=h.data)||void 0===m?void 0:m.url)||"";return i&&i({url:t}),t}console.error(h),s&&s()},n=async({block:t,url:e,cb:i,onErr:s})=>{const n={block:t,url:e};try{const{data:t}=await(t=>a.a.post("/km_bff/asset/v1/create_from_url",t))(n);var o;if(0===t.code)i&&i(null===(o=t.data)||void 0===o?void 0:o.url);else s&&s(t.message)}catch(t){console.error(t),s&&s()}}},2049:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return c}));i(11),i(12),i(13),i(14),i(15);var a=i(7),s=i(81),n=i.n(s);const o=t=>{const e={tag_name:t};return a.a.post("/base/discard_tag",n.a.stringify(e),{headers:{"x-km-api-version":"std"}})},r=t=>{const e={tag_name:t};return a.a.post("/base/subscribe_tag",n.a.stringify(e),{headers:{"x-km-api-version":"std"}})},l=t=>{const e={q:t,frequent:"",limit:50,timestamp:new Date-0};return a.a.get("tags/tag_chooser",{params:e,headers:{"x-km-api-version":"std"}})},c=t=>{const e={entry_name:t,limit:3};return a.a.post("km_bff/entry/v1/top_entries",e)}},2050:function(t,e,i){"use strict";i.d(e,"b",(function(){return h}));i(11),i(12),i(13),i(14),i(15);var a=i(1899),s=i.n(a);const n={position:{scrollTopOffset:0,contentOffsetTop:0,horizontalOffset:40,horizontalDirection:"left",isSticky:!0,scrollOption:{behavior:"smooth"}},eventBindDom:{contentScrollEle:window},renderOptions:{type:"view"},attrConfig:{htmlTagKey:"id",htmlTagSelectorGetter:function(t){return"#"+t}},dealFunc:{}};function o(t){return t?"string"==typeof t?document.querySelector(t):"function"==typeof t?t():void 0:{}}function r(t=window){if(t!==window)return{top:t.scrollTop,left:t.scrollLeft};const e=void 0!==t.pageXOffset,i="CSS1Compat"===(t.document.compatMode||""),a=i?t.document.documentElement.scrollLeft:t.document.body.scrollLeft,s=i?t.document.documentElement.scrollTop:t.document.body.scrollTop,n=e?t.pageXOffset:a;return{top:e?t.pageYOffset:s,left:n}}function l(t,e=window){const i=t.getBoundingClientRect(),a=r(e);return{top:i.top+a.top,left:i.left+a.left,right:document.body.clientWidth-i.right}}function c(t,e,i){const{contentScrollEle:a,contentScrollType:s}=e;if("iframe"===s){const e=function(t,e,i=0){const a=l(t,e).top,s=r(e).top,n=getComputedStyle(t).marginTop,o=n.substr(0,n.length-2);return a+i-o-s}(t,a);return void(a.scrollTop=a.scrollTop+e)}if(a===window)return void(t&&t.scrollIntoView(i.scrollOption));const n=u(t,a);a.scrollTop=a.scrollTop+n}const d=function(){let t="";return function(e,i,a,s){const n=e.getAttribute(s.htmlTagKey);t===n||(c(e,i,a),setTimeout(()=>{a.scrollTopOffset&&function(t,e){var i=e.scrollX||e.scrollLeft||0,a=(e.scrollY||e.scrollTop)-t.scrollTopOffset;e.scrollTo(i,a),lastScrollY=a}(a,i.contentScrollEle)},0),t=n)}}();function u(t,e){var i=t.getBoundingClientRect(),a=e.getBoundingClientRect?e.getBoundingClientRect():{top:0};return i.top-a.top}function p(t){const e=function(t){const e=new Array(6).fill(0),i={H1:0,H2:1,H3:2,H4:3,H5:4,H6:5},a={H1:0};return t.forEach((function(t){const a=i[t.tagName];e[a]=1})),e.reduce((function(t,i,s){if(s<e.length){a["H"+(s+1)]=0===i?0:t}return t+i})),a}(t);return t.forEach((function(t){t.levelDis=e[t.tagName]})),t}function h(t){const e=t.querySelectorAll("h1,h2,h3,h4,h5,h6"),i=t.querySelector("dir.toc"),a=s()(e).hasClass("toc-enable")||i;let n=[];if(a){n=p(function(t){const e=[];for(let i=0;i<t.length;i++){const a=t[i],s=a.innerText;s&&s.trim()&&e.push({id:a.getAttribute("id"),tagName:a.tagName,name:s})}return e}(e))}return{isShow:a,tocData:n}}e.a={getOptions:function(t,e){const{dom:i,eventBindDom:a={},position:s}=t,{contentScrollEleSelector:r}=a,{parentEleSelector:l,contentEleSelector:c}=i,d=o(l),u=o(c),p=r&&o(r),h={...n.eventBindDom,...a};h.contentScrollEle=p||h.contentScrollEle;const m={...n.position,...s};return{...n,...t,dom:{parentEle:d,tocEle:e,contentEle:u},position:m,eventBindDom:h}},getOffset:l,getWindowOffset:r,debounceWrapper:function(t,e){let i=null;return function(){const a=this;null!==i&&clearTimeout(i);const s=arguments;i=setTimeout((function(){t.apply(a,s)}),e)}},checkScrollTouch:function(t,e){const{dom:i,eventBindDom:a,position:s}=e,{contentScrollEle:n}=a,{contentScrollType:o}=a;if(n===window){return function(t,e){const i=t.getBoundingClientRect().top,a=getComputedStyle(t).marginTop;return i+e-a.substr(0,a.length-2)}(t,s.contentOffsetTop)<=0}if("iframe"===o){return function(t,e,i=0){const a=e.getBoundingClientRect(),s=t.getBoundingClientRect().top,n=getComputedStyle(t).marginTop,o=n.substr(0,n.length-2);return s+i+a.top-o}(t,i.parentEle,s.contentOffsetTop)<=0}return u(t,n)<=0},throttleWrapper:function(t,e){let i;return function(){const a=this,s=arguments;i||(i=setTimeout((function(){t.apply(a,s),i=null}),e))}},scrollTocFocus:function(t,e,i=".label-list"){const a=t.offsetTop,s=e.querySelector(i),n=e.offsetHeight,o=t.offsetHeight;s.scrollTop=a-n/2+o},scrollIntoTagWithOffset:d,getHtmlElementByTocId:function(t,e,i){var a,s=(a=t,CSS.escape(a)),n=i.htmlTagSelectorGetter(s);return e.querySelector(n)}}},2051:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(11),i(12),i(13),i(14),i(15);const a=31457280},2052:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=t=>a.a.post("/km_bff/auth/v1/auth_entry",t),n=({list:t})=>a.a.post("/km_bff/auth/v1/auth_batch_entry",{list:t})},2053:function(t,e,i){"use strict";i.d(e,"e",(function(){return s})),i.d(e,"d",(function(){return n})),i.d(e,"a",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"b",(function(){return l}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=t=>a.a.post("/km_bff/feedback/v1/create_vote",t),n=t=>a.a.post("/km_bff/feedback/v1/delete_vote",t),o=t=>a.a.post("/km_bff/feedback/v1/create_bookmark",t),r=t=>a.a.post("/km_bff/feedback/v1/delete_bookmark",t),l=t=>{const e=new FormData;return e.append("target_type",t.target_type),e.append("target_id",t.target_id),e.append("content_type",t.content_type),e.append("desc",t.desc),e.append("url",t.url),e.append("feedback_type",t.feedback_type),e.append("reserve_options",t.reserve_options),a.a.post("/pages/ajax_new_feedback",e)}},2054:function(t,e){t.exports="/vkm/img/video-cover.7b9c1b53ee5bccbfb8ebac4d9d83548d.jpg"},2055:function(t,e){t.exports="/vkm/img/playlist-cover.b371a12b5f5546011c6ff7cc0ce3ad65.jpg"},2056:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1320);const n=(t,{manual:e=!1,refreshDeps:i,onSuccess:n,onFailed:o,pollingInterval:r=0,pollingWhenHidden:l=!1,debounceWait:c=0}={})=>{const d=Object(a.r)(!1),u=Object(a.q)({id:null,callback:null}),p=Object(a.r)(),h=()=>{u.id&&clearTimeout(u.id),u.id=null,u.callback=null},m=async(...e)=>{d.value=!0;try{const{data:i}=await t(...e);0===i.code?(p.value=i.data,d.value=!1,h(),"function"==typeof n&&n(p.value)):"function"==typeof o&&o(i),r>0&&(u.id&&clearTimeout(u.id),u.callback=()=>m(...e),u.id=setTimeout(u.callback,1e4))}catch(t){"function"==typeof o&&o(t)}finally{d.value=!1}},v=c?Object(s.a)(m,c):m;if(Array.isArray(i)?null==i?void 0:i.length:i){const t=Object(a.a)(()=>Array.isArray(i)?i:[i]);Object(a.u)(t,()=>!e&&v(),{deep:!0})}const g=()=>{document.hidden?u.id&&clearTimeout(u.id):d.value&&u.callback&&(u.id=setTimeout(u.callback,r))};return Object(a.m)(()=>{r>0&&!l&&document.addEventListener("visibilitychange",g)}),Object(a.n)(()=>{r>0&&!l&&document.removeEventListener("visibilitychange",g)}),!e&&v(),{loading:d,data:p,run:v,cancel:h}}},2057:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var a=i(17),s=i.n(a),n=i(6),o=i.n(n),r=i(3),l=i(2040),c=i(64),d=i(10),u=i(60);i(27),i(24),i(16),i(26),i(23),i(25),i(48),i(38),i(32),i(67),i(51),i(46),i(42);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var m=Object(u.a)(),v={small:"8px",medium:"16px",large:"24px"},g=Object(r.c)({name:"TSpace",props:h(h({},l.a),{},{forceFlexGapPolyfill:Boolean}),setup:function(t){var e=Object(c.b)("space"),i=Object(r.a)((function(){return t.forceFlexGapPolyfill||m})),a=Object(r.a)((function(){var e="";Array.isArray(t.size)?e=t.size.map((function(t){return"number"==typeof t?"".concat(t,"px"):"string"==typeof t&&v[t]||t})).join(" "):"string"==typeof t.size?e=v[t.size]||t.size:"number"==typeof t.size&&(e="".concat(t.size,"px"));var a={};if(i.value){var n=e.split(" "),o=s()(n,2),r=o[0],l=o[1];a["--td-space-column-gap"]=r,a["--td-space-row-gap"]=l||r}else a.gap=e;return a})),n=Object(r.a)((function(){return["".concat(e.value),o()(o()(o()(o()({},"".concat(e.value,"-align-").concat(t.align),t.align),"".concat(e.value,"-").concat(t.direction),t.direction),"".concat(e.value,"--break-line"),t.breakLine),"".concat(e.value,"--polyfill"),i.value)]}));return{COMPONENT_NAME:e,spaceClassNames:n,renderStyle:a}},render:function(){var t,e=this,i=arguments[0],a=this.COMPONENT_NAME,s=this.spaceClassNames,n=this.renderStyle,o=(null===(t=this.$slots.default)||void 0===t?void 0:t.filter((function(t){return void 0!==t.tag||t.text})))||[],r=null==o?void 0:o.length,l=function(){return o.map((function(t,s){var n=Object(d.b)(e,"separator"),o=s+1!==r&&n;return[i("div",{class:"".concat(a,"-item")},[t]),o?i("div",{class:"".concat(a,"-item-separator")},[n]):null]}))};return i("div",{class:s,style:n},[l()])}})},2058:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(9),s=i.n(a);const n=()=>({getTimeText:({time:t}={})=>{if(!t)return"暂无时间";try{const e=new Date(t),i=s()(e),a=e.getFullYear()===(new Date).getFullYear()?"":i.format("YYYY")+"年",n=i.format("MM"),o=i.format("DD"),r=i.locale("zh-cn").format("ddd");return`${a}${n}月${o}日 ${r} ${i.format("HH:mm")}`}catch(e){return t}},getLocationText:({form:t,city:e,location:i}={})=>{const a=(null==t?void 0:t.split(","))||[],s=a.includes("1")&&(null==e?void 0:e.split(","))||[];return(a.includes("2")?["线上"]:[]).concat(s).concat(i).filter(t=>t).join("/")},getSignStatusText:({sign_status:t,queue_num:e}={})=>{const i=["未开始报名","正在报名中","已截止报名"];return"1"===t&&+e>0?e+"人排队中":i[t]}})},2059:function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o}));i(11),i(12),i(13),i(14),i(15);var a=i(7);const s=t=>a.a.post("/km_bff/apps/v1/list_hot_surveys",t),n=t=>a.a.post("/km_bff/apps/v1/list_public_surveys",t),o=t=>a.a.post("/km_bff/apps/v1/list_my_surveys",t)},2061:function(t,e,i){"use strict";i.d(e,"i",(function(){return Dt.a})),i.d(e,"e",(function(){return a.a})),i.d(e,"h",(function(){return r})),i.d(e,"b",(function(){return u})),i.d(e,"o",(function(){return h})),i.d(e,"c",(function(){return v})),i.d(e,"q",(function(){return f})),i.d(e,"t",(function(){return b})),i.d(e,"a",(function(){return w})),i.d(e,"r",(function(){return k})),i.d(e,"n",(function(){return x})),i.d(e,"m",(function(){return I})),i.d(e,"g",(function(){return et})),i.d(e,"p",(function(){return nt})),i.d(e,"k",(function(){return ct})),i.d(e,"j",(function(){return ut})),i.d(e,"f",(function(){return wt})),i.d(e,"s",(function(){return St})),i.d(e,"l",(function(){return jt})),i.d(e,"d",(function(){return At}));i(11),i(12),i(13),i(14),i(15);var a=i(2064),s=i(3),n=Object(s.c)({name:"introduction-mod",props:{},components:{},setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},summaryData(){return this.$store.getters["kbar/getSummaryData"]||{}}},mounted(){this.$store.dispatch("kbar/fetchSummaryData").then(()=>{}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.summaryData&&t.summaryData.id?i("div",{staticClass:"introduction-mod-container commom-kbar-mod-item"},[t._m(0),t._v(" "),i("div",{staticClass:"des-content",class:t.summaryData.description?"":"no-des-content"},[i("p",[t._v(t._s(t.summaryData.description||"暂无简介"))])]),t._v(" "),i("div",{staticClass:"count-area"},[i("ul",[i("li",[i("a",{staticClass:"info-item"},[i("span",{staticClass:"value",attrs:{target:"_blank"}},[t._v("\n            "+t._s(t.summaryData.member_cnt)+"\n          ")]),t._v(" "),i("span",{staticClass:"type-text"},[t._v("成员")])])]),t._v(" "),i("li",[i("a",{staticClass:"info-item"},[i("span",{staticClass:"value",attrs:{target:"_blank"}},[t._v("\n            "+t._s(t.summaryData.article_cnt)+"\n          ")]),t._v(" "),i("span",{staticClass:"type-text"},[t._v("文章")])])]),t._v(" "),i("li",[i("a",{staticClass:"info-item"},[i("span",{staticClass:"value",attrs:{target:"_blank"}},[t._v("\n            "+t._s(t.summaryData.score)+"\n          ")]),t._v(" "),i("span",{staticClass:"type-text"},[t._v("积分")])])])])])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-area"},[e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("K吧简介")])])])}],!1,null,"f866a3e8",null).exports,l=i(2005),c=i(2007),d=Object(s.c)({name:"administrator-mod",props:{modType:{type:Number,default:1}},components:{badgeTwitter:c.a},data:()=>({showList:!1}),setup(t,e){const{userCardItem:i,renderUserCard:a}=Object(l.a)(e,{idKey:"nick",refKey:1===t.modType?"kbar_admin":"kbar_member"});return{userCardItem:i,renderUserCard:a}},computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},personList(){return 1===this.modType?this.$store.getters["kbar/getAdminsList"]||[]:2===this.modType?(this.$store.getters["kbar/getLatestMembers"]||[]).slice(0,9):void 0}},mounted(){1===this.modType?this.$store.dispatch("kbar/fetchAdminsList").then(()=>{}).catch(()=>{}):2===this.modType&&this.$store.dispatch("kbar/fetchLatestMembers").then(()=>{}).catch(()=>{})},methods:{toggleList(){this.showList=!this.showList}},filters:{}}),u=Object(o.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"administrator-mod-container is-eidt-page commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[i("span",{staticClass:"line-part"}),t._v(" "),i("span",{staticClass:"text-part"},[t._v(t._s(1===t.modType?"管理员":"k吧成员"))])]),t._v(" "),1===t.modType&&t.personList.length>6?i("a",{staticClass:"spread-btn",class:t.showList?"packup-list":"spread-list",on:{click:function(e){return t.toggleList()}}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1):2===t.modType?i("a",{staticClass:"spread-btn show-more",attrs:{target:"_blank",href:"/group/"+t.groupId+"/members"}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1):t._e()]),t._v(" "),i("div",{staticClass:"list-area"},[i("ul",t._l(t.personList,(function(e,a){return i("li",{directives:[{name:"show",rawName:"v-show",value:!(1===t.modType&&!t.showList&&a>5),expression:"!(modType === 1 && !showList && index > 5)"}],key:e.id},[i("div",{ref:1===t.modType?"kbar_admin"+e.nick:"kbar_member"+e.nick,refInFor:!0,staticClass:"avatar badge-avatar",on:{mouseenter:function(i){return t.renderUserCard(e,e.nick,a)},mouseleave:function(i){return t.renderUserCard(e)}}},[i("badge-twitter",{attrs:{checkUniqueKey:"",width:38,uniqueKey:1===t.modType?"kbar_admin"+e.nick+a:"kbar_member"+e.nick+a,userData:t.userCardItem,showAttention:!1}}),t._v(" "),i("a",{attrs:{href:"/user/"+e.nick,target:"_blank"}},[i("img",{attrs:{src:"/asset/avatar/"+e.nick}})])],1),t._v(" "),i("a",{staticClass:"nick",attrs:{href:"/user/"+e.nick,target:"_blank"}},[t._v(t._s(e.nick))])])})),0)])])}),[],!1,null,"ee42527a",null).exports,p=Object(s.c)({name:"RelationalKbarMod",components:{},filters:{},props:{isEdit:{type:Boolean,default:!1}},setup:()=>({}),data:()=>({showList:!1,kbarDefaultUrl:"https://assets.km.tencent.com/asset/common/2406/4c267bd5aeea49ed.png"}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},relatedGroups(){return this.$store.getters["kbar/getRelatedGroups"]||[]}},mounted(){this.$store.dispatch("kbar/fetchRelatedGroups").then(()=>{}).catch(()=>{})},methods:{toggleList(){this.showList=!this.showList}}}),h=Object(o.a)(p,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return!t.isEdit&&t.relatedGroups&&t.relatedGroups.length||t.isEdit?i("div",{staticClass:"relational-kbar-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[t._m(0),t._v(" "),t.relatedGroups.length>6?i("a",{staticClass:"spread-btn",class:t.showList?"packup-list":"spread-list",on:{click:function(e){return t.toggleList()}}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1):t._e()]),t._v(" "),i("div",{staticClass:"list-area"},[t.relatedGroups&&t.relatedGroups.length?i("ul",t._l(t.relatedGroups,(function(e,a){return i("li",{directives:[{name:"show",rawName:"v-show",value:!(!t.showList&&a>5),expression:"!(!showList && index > 5)"}],key:e.id},[i("div",{staticClass:"avatar"},[i("a",{attrs:{href:"/group/"+e.id,target:"_blank"}},[i("img",{attrs:{src:"/asset/kbar/"+e.id}})])]),t._v(" "),i("a",{staticClass:"nick",attrs:{href:"/group/"+e.id,target:"_blank"}},[t._v(t._s(e.name))])])})),0):t.isEdit?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无内容\n      ")])]):t._e()])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("相关K吧")])])}],!1,null,"2eba1314",null).exports,m=Object(s.c)({name:"anthology-mod",props:{},components:{},setup:()=>({}),data:()=>({anthologyDefaultUrl:"https://assets.km.tencent.com/ImageHosting/20221215/088e7512224edd1c99523e9c74b5c428.png"}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},relatedKnowledgeData(){return this.$store.getters["kbar/getRelatedKnowledgeData"]}},mounted(){this.$store.dispatch("kbar/fetchRelatedKnowledgeData").then(()=>{}).catch(()=>{})},methods:{fetchDefaultImg(t){const e=t.target.src||"";if(!e||e===this.anthologyDefaultUrl)return;t.srcElement.src=this.anthologyDefaultUrl}},filters:{}}),v=Object(o.a)(m,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"anthology-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[t._m(0),t._v(" "),i("a",{staticClass:"spread-btn show-more",attrs:{target:"_blank",href:"/group/"+t.groupId+"/knowledges/g_index"}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1)]),t._v(" "),t.relatedKnowledgeData&&t.relatedKnowledgeData.length?i("div",{staticClass:"list-area"},[i("ul",t._l(t.relatedKnowledgeData,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"avatar"},[i("a",{attrs:{href:e.url,target:"_blank"}},[i("img",{staticClass:"common-anthology-icon",attrs:{src:e.logo_preview_url||t.anthologyDefaultUrl},on:{error:t.fetchDefaultImg}})])]),t._v(" "),i("div",{staticClass:"anthology-info"},[i("a",{staticClass:"anthology-title",attrs:{href:e.url,target:"_blank"}},[t._v("\n            "+t._s(e.title)+"\n          ")]),t._v(" "),i("p",{staticClass:"anthology-des"},[t._v("\n            "+t._s(e.introduction)+"\n          ")])])])})),0)]):i("div",{staticClass:"list-area"},[t.relatedKnowledgeData?i("div",{staticClass:"no-anthology-area"},[i("p",[t._v("\n        暂无文集，\n        "),i("a",{attrs:{target:"_blank",href:"/vkm/group/"+t.groupId+"/knowledges/create"}},[t._v("点击创建")])])]):t._e()])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("文集")])])}],!1,null,"e280d474",null).exports,g=Object(s.c)({name:"schedule-mod",props:{isEdit:{type:Boolean,default:!1}},components:{},setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},miniCalendarData(){return this.$store.getters["kbar/getMiniCalendarData"]||[]}},mounted(){this.$store.dispatch("kbar/fetchMiniCalendarData").then(()=>{}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),f=Object(o.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return!t.isEdit&&t.miniCalendarData&&t.miniCalendarData.length||t.isEdit?i("div",{staticClass:"schedule-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[t._m(0),t._v(" "),i("a",{staticClass:"spread-btn show-more",attrs:{target:"_blank",href:"/group/"+t.groupId+"/calendars"}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1)]),t._v(" "),i("div",{staticClass:"list-area"},[t.miniCalendarData&&t.miniCalendarData.length?i("ul",t._l(t.miniCalendarData,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"active-info"},[i("a",{staticClass:"active-name",attrs:{target:"_blank",href:e.url}},[t._v(t._s(e.title))]),t._v(" "),i("p",{staticClass:"active-time"},[t._v("\n            "+t._s(e.start_time)+"\n          ")])])])})),0):t.isEdit?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无内容\n      ")])]):t._e()])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("K吧日历")])])}],!1,null,"0aa26b0c",null).exports,_=Object(s.c)({name:"tag-mod",props:{isEdit:{type:Boolean,default:!1}},components:{},data:()=>({hoverSearch:!1,skey:""}),setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},rightTagsList(){return this.$store.getters["kbar/getRightTagsList"]||[]}},mounted(){this.$store.dispatch("kbar/fetchRightTagsList").then(()=>{}).catch(()=>{})},methods:{reloadToSearch(){if(0===this.skey.trim().length)return;const t=window.encodeURIComponent(this.skey);window.location.href=`/group/${this.groupId}/tag_search?tag_name=${t}&search_type=post`}},filters:{}}),b=Object(o.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return!t.isEdit&&t.rightTagsList&&t.rightTagsList.length||t.isEdit?i("div",{staticClass:"tag-mod-container commom-kbar-mod-item"},[t._m(0),t._v(" "),i("div",{staticClass:"search-input-area"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.skey,expression:"skey"}],staticClass:"kbar-input",attrs:{type:"text",placeholder:"输入多个标签进行搜索"},domProps:{value:t.skey},on:{input:function(e){e.target.composing||(t.skey=e.target.value)}}}),t._v(" "),i("span",{staticClass:"search-btn",on:{click:t.reloadToSearch,mouseenter:function(e){t.hoverSearch=!0},mouseleave:function(e){t.hoverSearch=!1}}},[t.hoverSearch?i("svg-icon",{attrs:{name:"kbar/tag_search_active",width:16,height:16}}):i("svg-icon",{attrs:{name:"kbar/tag_search",width:16,height:16}})],1)]),t._v(" "),i("div",{staticClass:"list-area"},[t.rightTagsList&&t.rightTagsList.length?i("ul",t._l(t.rightTagsList,(function(e){return i("li",{key:e.id},[i("a",{staticClass:"tag-item",attrs:{target:"_blank",href:"/group/"+t.groupId+"/tag_search?tag_id="+e.id}},[i("span",[t._v(t._s(e.name))])])])})),0):t.isEdit?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无内容\n      ")])]):t._e()])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-area"},[e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("标签")])])])}],!1,null,"3809c531",null).exports,y=Object(s.c)({name:"activity-mod",props:{isEdit:{type:Boolean,default:!1}},components:{},data:()=>({monthMap:["","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},latestEvents(){return this.$store.getters["kbar/getLatestEvents"]||[]}},mounted(){this.$store.dispatch("kbar/fetchLatestEvents").then(()=>{}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),w=Object(o.a)(y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return!t.isEdit&&t.latestEvents&&t.latestEvents.length||t.isEdit?i("div",{staticClass:"activity-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[t._m(0),t._v(" "),i("a",{staticClass:"spread-btn show-more",attrs:{target:"_blank",href:"/group/"+t.groupId+"/events"}},[i("svg-icon",{attrs:{name:"kbar/right_arr",width:16,height:16}})],1)]),t._v(" "),i("div",{staticClass:"list-area"},[t.latestEvents&&t.latestEvents.length?i("ul",t._l(t.latestEvents,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"activity-time"},[i("p",{staticClass:"time-month"},[t._v(t._s(t.monthMap[e.month]))]),t._v(" "),i("p",{staticClass:"time-day"},[t._v(t._s(e.day))])]),t._v(" "),i("div",{staticClass:"activity-info"},[i("a",{staticClass:"activity-title",attrs:{target:"_blank",href:"/event/"+e.id}},[t._v(t._s(e.title))]),t._v(" "),i("p",{staticClass:"activity-position"},[t._v("\n            "+t._s(e.location)+"\n          ")])])])})),0):t.isEdit?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无内容\n      ")])]):t._e()])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("最新活动")])])}],!1,null,"8f2f2b4c",null).exports,C=Object(s.c)({name:"search-mod",props:{},components:{},data:()=>({skey:"",hoverSearch:!1}),setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""}},mounted(){},methods:{reloadToSearch(){if(0===this.skey.trim().length)return;const t=window.encodeURIComponent(this.skey);window.location.href=`/group/${this.groupId}/searchingroup?q=${t}`}},filters:{}}),k=Object(o.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"search-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"input-wrapper"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.skey,expression:"skey"}],staticClass:"kbar-input",attrs:{type:"text",placeholder:"输入内容进行吧内搜索"},domProps:{value:t.skey},on:{input:function(e){e.target.composing||(t.skey=e.target.value)}}}),t._v(" "),i("span",{staticClass:"manage-btn",on:{click:t.reloadToSearch,mouseenter:function(e){t.hoverSearch=!0},mouseleave:function(e){t.hoverSearch=!1}}},[t.hoverSearch?i("svg-icon",{attrs:{name:"kbar/kbar_search_active",width:24,height:24}}):i("svg-icon",{attrs:{name:"kbar/kbar_search_default",width:24,height:24}})],1)])])}),[],!1,null,"01b6469a",null).exports,O=Object(s.c)({name:"recent-update-mod",props:{},components:{},setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},latestItems(){return this.$store.getters["kbar/getLatestItems"]||{}}},mounted(){this.$store.dispatch("kbar/fetchLatestItems").then(()=>{}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{recentItemUrl(t,e){let i="";return"topic"===t.item_type?i=`/group/${e}/topics/view/${t.id}`:"article"===t.item_type?(i=`/group/${e}/articles/show/${t.gp_id}`,i=`/group/${e}/articles/show/${t.gp_id}`):"doc"===t.item_type?i=`/group/${e}/docs/show/${t.id}`:"question"===t.item_type&&(i=`/group/${e}/questions/show/${t.id}`),i},lineTag(t){let e="";return"top_list"===t.module_type?e="[置顶]":"latest_item"===t.module_type&&("topic"===t.item_type?e="[讨论]":"article"===t.item_type?e="[文章]":"doc"===t.item_type?e="[文档]":"question"===t.item_type&&(e="[问答]")),e}}}),x=Object(o.a)(O,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"recent-update-mod-container commom-kbar-mod-item"},[t._m(0),t._v(" "),t.latestItems.list&&t.latestItems.list.length?i("div",{staticClass:"list-area"},[i("ul",t._l(t.latestItems.list,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"content-info"},[i("a",{staticClass:"content-name",attrs:{href:t._f("recentItemUrl")(e,t.groupId),target:"_blank",title:1===e.access_level&&"article"===e.item_type?"该文章的内容保密":e.title}},[i("span",{staticClass:"title-tag"},[t._v(t._s(t._f("lineTag")(e)))]),t._v("\n            "+t._s(e.title)+"\n          ")]),t._v(" "),i("div",{staticClass:"content-detail"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"update-time"},[t._v(t._s(e.last_updated_time))])])])])})),0)]):i("div",{staticClass:"list-area"},[t.latestItems.list?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无最近更新的内容\n      ")])]):t._e()])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-area"},[e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("最近更新")])])])}],!1,null,"03755dea",null).exports,j=Object(s.c)({name:"NewestDynamicMod",components:{badgeTwitter:c.a},filters:{urlJoin(t,e="",i="",a=""){let s=e||t.object_type,n=i||t.object_id,o=a||t.group_id;["/q/add","/q/thank","/q/super_push","/q/reply","/q/agree","/q/agree/question","/q/reply/comment","/q/invite","/group/add","/group/join","/user/follow","/user/add_opinion","/fund/add","/fund/donate"].includes(t.action)&&(o=""),"/q/reply"===t.action&&(s=t.action_type,n=t.action_id,o=""),"/q/reply/comment"===t.action&&(s=t.entity_type,n=t.entity_id,o="");let r="",l="",c="";switch(s){case"Post":r="articles/show/";break;case"Doc":r="docs/show/";break;case"Event":r="event/";break;case"Survey":r="surveys/view/";break;case"Knowledge":r="knowledge/";break;case"Q":r="q/view/";break;case"Cheese":r="cheeses/view/";break;case"Answer":r="q/answer/";break;case"Topic":r="topics/view/";break;case"Group":r="group/";break;case"Album":r="photos/album/";break;case"Photo":r="photos/show/";break;case"Assignment":r="assignments/show/";break;case"User":r="user/";break;case"Twitter":r="twitter/";break;case"Video":r="videos/show/";break;case"Fund":r="funds/view/";break;case"CalendarEvent":r="calendars/view_cal_event/";break;case"CalendarSeries":r="calendars/view_cal_events_series/";break;case"Meeting":r="meetings/show/";break;case"Attachment":r="attachments/attachment_view/";break;case"Liveroom":r="liveroom/"}return l=o&&0!==o&&"Post"!==s?`group/${o}/`:"",c=`/${l}${r}${n}`,c}},props:{},setup(t,e){const{userCardItem:i,renderUserCard:a}=Object(l.a)(e,{idKey:"created_by",refKey:"kbar_dynamic"});return{userCardItem:i,renderUserCard:a}},data:()=>({}),computed:{nick(){return this.$store.getters["global/userInfo"]?this.$store.getters["global/userInfo"].user_info.nick:""},groupId(){return this.$store.getters["kbar/getGroupId"]||""},dynamicData(){return this.$store.getters["kbar/getDynamicData"]||{}},kbarBasicData(){return this.$store.getters["kbar/getKbarBasicData"]||{}}},mounted(){this.loadPageList()},methods:{loadPageList(){this.$store.dispatch("kbar/fetchDynamicData",{nick:this.nick}).then(()=>{}).catch(()=>{})},deleteItem(t){this.$store.dispatch("kbar/deleteFeedItem",t).then(()=>{this.$toast("删除动态成功",{status:"success",positon:"center"})}).catch(()=>{this.$toast("删除动态失败，请重试",{status:"error",positon:"center"})})},onClickDeleteItem(t){this.$newConfirm("warning","是否删除该条动态？",{confirm:()=>this.deleteItem(t)})}}}),I=Object(o.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"newest-dynamic-mod-container commom-kbar-mod-item"},[t._m(0),t._v(" "),i("div",{staticClass:"list-area"},[i("ul",t._l(t.dynamicData.dynamicList,(function(e,a){return i("li",{key:e.id,class:e.action&&"/twitter/add"!==e.action&&"/twitter/add/pic"!==e.action?"":"hideItem"},[e.action&&"/twitter/add"!==e.action&&"/twitter/add/pic"!==e.action?[i("div",{ref:"kbar_dynamic"+e.created_by,refInFor:!0,staticClass:"avatar badge-avatar",on:{mouseenter:function(i){return t.renderUserCard(e,e.created_by,a)},mouseleave:function(i){return t.renderUserCard(e)}}},[i("badge-twitter",{attrs:{"check-unique-key":"","unique-key":"kbar_dynamic"+e.created_by+a,"user-data":t.userCardItem,"show-attention":!1,width:40}}),t._v(" "),i("a",{attrs:{href:"/user/"+e.created_by,target:"_blank"}},[i("img",{attrs:{src:"/asset/avatar/"+e.created_by}})])],1),t._v(" "),i("div",{staticClass:"dynamic-info"},["/group/article/original/public/add"===e.action||"/group/article/reship/public/add"==e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发表了文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/article/reship"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("将文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("转载到")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/group/"+e.group_id,target:"_blank"}},[t._v("\n                "+t._s(e.group_name)+"\n              ")])]):"/article/original/add"===e.action||"/article/reship/add"==e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发表了文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/article/add2knowledge"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("添加文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("到文集")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/knowledge/"+e.action_id,target:"_blank"}},[t._v("\n                "+t._s(e.action_memo)+"\n              ")])]):"/group/article/vote"===e.action||"/article/vote"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("顶了文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/article/bookmark"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("收藏了文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/doc/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("写了文档")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/group/doc/vote"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("顶了文档")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/group/"+e.group_id+"/docs/show/"+e.object_id,target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/group/doc/bookmark"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("收藏了文档")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/group/"+e.group_id+"/docs/show/"+e.object_id,target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/event/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发起了活动")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/event/attachment/upload"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("为活动")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("上传了附件")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e,"Attachment",e.action_id,e.group_id),target:"_blank"}},[t._v("\n                "+t._s(e.attach_filename)+"\n              ")])]):"/event/memo"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("对活动")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发布了总结")])]):"/event/join"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("报名了活动")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/event/reship"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("转载了活动")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("到")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/group/"+e.group_id,target:"_blank"}},[t._v("\n                "+t._s(e.group_name)+"\n              ")])]):"/survey/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发起了投票")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/survey/join"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("参加了投票")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/knowledge/publish"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发布了文集")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/knowledge/bookmark"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("收藏了文集")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/knowledge/vote"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("顶了文集")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/knowledge/reship"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("将文集")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("转载到")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/group/"+e.group_id,target:"_blank"}},[t._v("\n                "+t._s(e.group_name)+"\n              ")])]):"/q/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("在乐问提了问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/thank"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("给提问人")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/user/"+e.entity_title,target:"_blank"}},[t._v("\n                "+t._s(e.entity_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("送出比心")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/super_push"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("推动了乐问问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/reply"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("在乐问回答了问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e,e.action_type,e.action_id,""),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/agree"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("赞同了乐问问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.entity_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("的回答：")])]):"/q/agree/question"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("点赞了问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/invite"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("邀请")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:"/user/"+e.invitee,target:"_blank"}},[t._v("\n                "+t._s(e.invitee)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("回答乐问问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/q/reply/comment"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("评论了乐问问题")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.entity_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("的回答：")])]):"/group/thread/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发起讨论")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/group/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("创建了K吧")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/group/join"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("加入了K吧")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/album/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("创建了相册")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/photo/upload"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("在相册")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("中上传了新的照片")])]):"/photo/vote"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("顶了照片")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/assignment/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("创建了任务")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/assignment/update"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("更新了任务进展")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/assignment/complete"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("完成了任务")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/assignment/reopen"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("重新打开了任务")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/user/follow"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("关注了同事")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/user/add_opinion"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("评价了")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("说：")])]):"/video/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发布了视频")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/video/bookmark"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("收藏了视频")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/video/vote"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("顶了视频")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/fund/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发起了微爱项目")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/fund/donate"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("捐赠了微爱项目")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/calendar_event/create"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("新建了事件")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/meeting/add"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("创建了会议")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/meeting/minutes"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("写了会议记录")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):"/operations/comment"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("对")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("发表了评论：")])]):"/operations/comment/reply"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("对")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("的评论回复说：")])]):"/article/reward"===e.action?i("div",{staticClass:"dynamic-title"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"dynamic-type"},[t._v("赞赏了文章")]),t._v(" "),i("a",{staticClass:"target-url",attrs:{href:t._f("urlJoin")(e),target:"_blank"}},[t._v("\n                "+t._s(e.object_title)+"\n              ")])]):t._e(),t._v(" "),e.action_memo?i("div",{staticClass:"feed-detail",domProps:{innerHTML:t._s(e.action_memo)}}):t._e(),t._v(" "),i("p",{staticClass:"update-time"},[t._v("\n              "+t._s(e.created)+"\n              "),t.nick===e.created_by||t.kbarBasicData.is_admin||t.kbarBasicData.is_group_admin?i("span",{staticClass:"delete-item",on:{click:function(){return t.onClickDeleteItem(e)}}},[i("svg-icon",{attrs:{name:"kbar/delete_comment",width:16,height:16}})],1):t._e()])])]:t._e()],2)})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.dynamicData.dynamicList.length>0&&!t.dynamicData.isEnd,expression:"dynamicData.dynamicList.length > 0 && !dynamicData.isEnd"}],staticClass:"load-more-list",on:{click:t.loadPageList}},[i("span",{staticClass:"btn-text"},[t._v("加载更多")]),t._v(" "),i("svg-icon",{staticClass:"btn-icon",attrs:{name:"kbar/load_btn",width:16,height:16}})],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-area"},[e("span",{staticClass:"title"},[e("span",{staticClass:"line-part"}),this._v(" "),e("span",{staticClass:"text-part"},[this._v("最新动态")])])])}],!1,null,"383ccb6a",null).exports,T=i(1921),S=i.n(T),D=i(1895),q=i.n(D),E=i(531),A=i.n(E),M=i(1927),$=i.n(M),L=i(1928),P=i.n(L),F=i(530),R=i.n(F),N=i(1901),B=i.n(N),U=i(1902),H=i.n(U),V=i(1892),z=i.n(V),G=i(1946),K=i.n(G),W=i(1916),Q=i.n(W),J=i(2003),Y=i(2038),X={name:"ralative-article-modal",components:{draggable:Q.a,venomDatePicker:K.a,venomInput:z.a,venomSelector:H.a,venomOptions:B.a,venomButton:R.a,venomList:P.a,venomListItem:$.a,venomCheckbox:A.a,venomPagination:q.a,venomCascader:S.a},props:{visible:{type:Boolean,default:!1}},setup(t,{root:e}){const{kbar:i,kbarCategoryType:a,kbarOptions:s,kbarCategoryOptions:n}=Object(Y.d)(e);return{kbar:i,kbarCategoryType:a,kbarOptions:s,kbarCategoryOptions:n}},data(){return{visibleModal:this.visible,searchValue:"",startDate:"",endDate:"",searchArticles:[],currentPage:1,pageSize:5,total:200,sortArticles:[]}},watch:{visible(t){this.visibleModal=t}},mounted(){},beforeDestroy(){},methods:{clearData(){this.searchArticles=[],this.startDate="",this.endDate="",this.kbar="",this.kbarCategoryType="",this.searchValue=""},handleStartClear(){},handleEndClear(){},handelSearch(){const t={ps_search_input:this.searchValue,start_on:this.startDate?new Date(this.startDate).Format("yyyy-MM-dd"):"",end_on:this.endDate?new Date(this.endDate).Format("yyyy-MM-dd"):"",page:this.currentPage,main_cat:this.kbar?this.kbar.substr(5):"",sub_cat1:this.kbarCategoryType};Object(J.S)(t).then(t=>{var e,i;const a=null==t||null===(e=t.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.data;this.searchArticles=a.map(t=>({author:t.created_by,createtime:t.date,id:t.id,name:t.title})),console.log("data",t)})},handleSubmit(){this.visibleModal=!1,this.clearData(),this.$emit("submit",this.sortArticles),this.$emit("close")},handleClose(){this.clearData(),this.$emit("close")},handleListChange(){},handleCheckboxChange(t,e){console.log(t,e),e.isChecked?this.sortArticles.push(e):this.sortArticles=this.sortArticles.filter(t=>t.id!==e.id)},handleRemoveSelect(t,e){console.log("sortArticles",this.sortArticles),this.searchArticles=this.searchArticles.map(t=>(t.id===e.id&&(t.isChecked=!1),t)),this.sortArticles.splice(t,1)},handlePageChange(t){this.currentPage=t}}},Z=Object(o.a)(X,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-dialog",{attrs:{header:"设置相关文章",visible:t.visibleModal,mode:"modal",onClose:t.handleClose,onConfirm:t.handleSubmit,closeOnOverlayClick:!1,width:"900px"},on:{"update:visible":function(e){t.visibleModal=e}}},[i("div",{attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"article-select-container"},[i("div",{staticClass:"left-content"},[i("div",{staticClass:"search-condition"},[i("div",{staticClass:"condition-title"},[t._v("选择条件")]),t._v(" "),i("div",{staticClass:"condition-block flex-colum"},[i("venom-input",{staticClass:"title-search-input",attrs:{placeholder:"请输入内容"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),t._v(" "),i("div",{staticClass:"date-choose"},[i("div",{staticClass:"start-date"},[i("span",[t._v("日期:")]),t._v(" "),i("venom-date-picker",{ref:"startDatePicker",staticClass:"date-picker",on:{clear:t.handleStartClear},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),t._v(" "),i("div",{staticClass:"end-date"},[i("span",[t._v("至")]),t._v(" "),i("venom-date-picker",{ref:"endDatePicker",staticClass:"date-picker",on:{clear:t.handleEndClear},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)])],1),t._v(" "),i("div",{staticClass:"condition-block"},[i("venom-selector",{attrs:{clearable:"",placeholder:"-请选择-",width:200,optionArray:t.kbarOptions},model:{value:t.kbar,callback:function(e){t.kbar=e},expression:"kbar"}},t._l(t.kbarOptions,(function(e,a){return i("venom-options",{key:a,attrs:{value:e.value,label:e.label}},[t._v("\n                  "+t._s(e.label)+"\n                ")])})),1),t._v(" "),t.kbarCategoryOptions.length>0?i("venom-cascader",{attrs:{placeholder:"请选择K吧文章分类",options:t.kbarCategoryOptions,width:210},model:{value:t.kbarCategoryType,callback:function(e){t.kbarCategoryType=e},expression:"kbarCategoryType"}}):t._e(),t._v(" "),i("venom-button",{attrs:{size:"small"},on:{click:t.handelSearch}},[t._v("搜索")])],1)]),t._v(" "),i("div",{staticClass:"article-search-result"},[i("div",{staticClass:"search-list-container"},[i("venom-list",{attrs:{items:t.searchArticles}},[i("venom-list-item",{attrs:{utype:"checkbox"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[i("venom-checkbox",{on:{change:function(e){return t.handleCheckboxChange(e,a)}},model:{value:a.isChecked,callback:function(e){t.$set(a,"isChecked",e)},expression:"item.isChecked"}})]}}])}),t._v(" "),i("venom-list-item",{staticClass:"title-item",attrs:{field:"name",label:"文章标题"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[i("span",{staticClass:"title-item"},[t._v(t._s(a.name))])]}}])}),t._v(" "),i("venom-list-item",{attrs:{field:"createtime",label:"发布时间"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[i("span",{staticClass:"time-item"},[t._v(t._s(a.createtime))])]}}])}),t._v(" "),i("venom-list-item",{attrs:{field:"author",label:"作者"}})],1)],1),t._v(" "),i("venom-pagination",{attrs:{"current-page":t.currentPage,pageSize:t.pageSize,total:t.total,size:"small"},on:{"page-change":t.handlePageChange}})],1)]),t._v(" "),i("div",{staticClass:"right-content"},[t._v("\n          已选文章\n          "),i("div",{staticClass:"selected-article-container"},[i("draggable",{staticClass:"selected-article-list",attrs:{"ghost-class":"ghost"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.sortArticles,callback:function(e){t.sortArticles=e},expression:"sortArticles"}},t._l(t.sortArticles,(function(e,a){return i("div",{key:e.id,staticClass:"selected-article-item"},[i("div",{staticClass:"artilce-name"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"delete-article",on:{click:function(i){return t.handleRemoveSelect(a,e)}}},[t._v("删除")])])})),0)],1)])])])])],1)}),[],!1,null,"3799dda2",null).exports,tt=Object(s.c)({name:"content-classify-mod",props:{modType:{type:Number,default:1}},components:{RelativeArticleModal:Z},setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},classList(){return 1===this.modType?this.$store.getters["kbar/getArticleClassList"]:2===this.modType?this.$store.getters["kbar/getDocClassList"]:void 0}},mounted(){1===this.modType?this.$store.dispatch("kbar/fetchArticleClassList").then(()=>{}).catch(()=>{}):2===this.modType&&this.$store.dispatch("kbar/fetchDocClassList").then(()=>{}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),et=Object(o.a)(tt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-classify-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[i("span",{staticClass:"line-part"}),t._v(" "),i("span",{staticClass:"text-part"},[t._v(t._s(1===t.modType?"文章分类":"文档分类"))])])]),t._v(" "),!t.classList||t.classList&&0===t.classList.length?i("div",{staticClass:"list-area"},[t.classList?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n        暂无分类\n      ")])]):t._e()]):i("div",{staticClass:"list-area"},[1===t.modType?i("ul",t._l(t.classList,(function(e,a){return i("li",{key:a},[i("a",{staticClass:"tag-item",attrs:{href:"/group/"+t.groupId+"/articles?cat_id="+e.category_id,target:"_blank"}},[i("span",[t._v(t._s(e.name)+" "+t._s("("+e.cnt+")"))])])])})),0):i("ul",t._l(t.classList,(function(e,a){return i("li",{key:a},[i("a",{staticClass:"tag-item",attrs:{href:"/group/"+t.groupId+"/docs?category_id="+e.category.id,target:"_blank"}},[i("span",[t._v(t._s(e.category.name))])])])})),0)])])}),[],!1,null,"59fa8fe5",null).exports,it=i(2082),at=i(2016),st=(i(2028),Object(s.c)({name:"right-column-customization-mod",props:{itemObj:{type:Object,default:()=>({})}},data:()=>({customDataList:[]}),components:{groupId(){return this.$store.getters["kbar/getGroupId"]||""}},setup:()=>({}),computed:{},mounted(){Object(it.a)("/vkm/flash/jwplayer.js","jsplayer").then(()=>{window.jwplayer&&(window.jwplayer.key="45FoKzf1Cs2kfDRORgBWOt2UiQfyLV5d+Un74g==")}).then(()=>{Object(at.d)()}),"POST"===this.itemObj.summary?this.$store.dispatch("kbar/fetchCustomPostList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{}):"DOC"===this.itemObj.summary&&this.$store.dispatch("kbar/fetchCustomDocList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}})),nt=Object(o.a)(st,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1===t.itemObj.show_title&&t.itemObj.title||1===t.itemObj.show_content&&t.itemObj.content||t.customDataList&&t.customDataList.length?i("div",{staticClass:"right-column-customization-mod-container commom-kbar-mod-item"},[1===t.itemObj.show_title&&t.itemObj.title?i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[i("span",{staticClass:"line-part"}),t._v(" "),i("span",{staticClass:"text-part"},[t._v(t._s(t.itemObj.title))])])]):t._e(),t._v(" "),1===t.itemObj.show_content&&t.itemObj.content?i("div",{staticClass:"rich-content-area custom-block custom-right-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content",domProps:{innerHTML:t._s(t.itemObj.content)}})]):t._e(),t._v(" "),t.customDataList&&t.customDataList.length?i("div",{staticClass:"list-area"},[i("ul",t._l(t.customDataList,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"list-category-info"},[i("a",{staticClass:"category-title",attrs:{href:e.url,target:"_blank"}},[t._v("\n            "+t._s(e.title)+"\n          ")])])])})),0)]):t._e()]):t._e()}),[],!1,null,"1111d5c7",null).exports,ot=Object(s.c)({name:"left-column-customization-mod",props:{itemObj:{type:Object,default:()=>({})}},data:()=>({customDataList:[]}),components:{groupId(){return this.$store.getters["kbar/getGroupId"]||""}},setup:()=>({}),computed:{},mounted(){Object(at.e)().then(()=>{Object(at.d)()}),"POST"===this.itemObj.summary?this.$store.dispatch("kbar/fetchCustomPostList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{}):"DOC"===this.itemObj.summary&&this.$store.dispatch("kbar/fetchCustomDocList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),rt=Object(o.a)(ot,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1===t.itemObj.show_title&&t.itemObj.title||1===t.itemObj.show_content&&t.itemObj.content||t.customDataList&&t.customDataList.length?i("div",{staticClass:"left-column-customization-mod-container"},[1===t.itemObj.show_title&&t.itemObj.title?i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[i("span",{staticClass:"line-part"}),t._v(" "),i("span",{staticClass:"text-part"},[t._v(t._s(t.itemObj.title))])])]):t._e(),t._v(" "),1===t.itemObj.show_content&&t.itemObj.content?i("div",{staticClass:"rich-content-area custom-block custom-right-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content",domProps:{innerHTML:t._s(t.itemObj.content)}})]):t._e(),t._v(" "),t.customDataList&&t.customDataList.length?i("div",{staticClass:"list-area"},[i("ul",t._l(t.customDataList,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"list-category-info"},[i("a",{staticClass:"category-title",attrs:{href:e.url,target:"_blank"}},[t._v("\n            "+t._s(e.title)+"\n          ")])])])})),0)]):t._e()]):t._e()}),[],!1,null,"b8116f90",null).exports,lt=Object(s.c)({name:"left-double-customization-mod",props:{itemArr:{type:Array,default:()=>[]}},data:()=>({}),components:{leftColumnCustomizationMod:rt},setup:()=>({}),computed:{},mounted(){},methods:{},filters:{}}),ct=Object(o.a)(lt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left-double-customization-mod-container commom-kbar-mod-item"},this._l(this.itemArr,(function(t,i){return e("div",{key:i},[e("left-column-customization-mod",{attrs:{"item-obj":t}})],1)})),0)}),[],!1,null,"ba929550",null).exports,dt=Object(s.c)({name:"left-article-customization-mod",props:{itemObj:{type:Object,default:()=>({})}},data:()=>({customDataList:[]}),components:{groupId(){return this.$store.getters["kbar/getGroupId"]||""}},computed:{},mounted(){Object(at.e)().then(()=>{Object(at.d)()}),"POST"===this.itemObj.summary?this.$store.dispatch("kbar/fetchCustomPostList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{}):"DOC"===this.itemObj.summary&&this.$store.dispatch("kbar/fetchCustomDocList",this.itemObj).then(t=>{this.customDataList=t}).catch(()=>{})},methods:{fetchBannerList(){}},filters:{}}),ut=Object(o.a)(dt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1===t.itemObj.show_title&&t.itemObj.title||1===t.itemObj.show_content&&t.itemObj.content||t.customDataList&&t.customDataList.length?i("div",{staticClass:"left-article-customization-mod-container commom-kbar-mod-item"},[1===t.itemObj.show_title&&t.itemObj.title?i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[i("span",{staticClass:"line-part"}),t._v(" "),i("span",{staticClass:"text-part"},[t._v(t._s(t.itemObj.title))])])]):t._e(),t._v(" "),1===t.itemObj.show_content&&t.itemObj.content?i("div",{staticClass:"rich-content-area custom-block custom-right-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content",domProps:{innerHTML:t._s(t.itemObj.content)}})]):t._e(),t._v(" "),t.customDataList&&t.customDataList.length?i("div",{staticClass:"list-area"},[i("ul",t._l(t.customDataList,(function(e){return i("li",{key:e.id},[i("div",{staticClass:"content-info"},[i("a",{staticClass:"content-name",attrs:{href:e.url,target:"_blank"}},[t._v("\n            "+t._s(e.title)+"\n          ")]),t._v(" "),i("div",{staticClass:"content-detail"},[i("a",{staticClass:"nick",attrs:{href:"/user/"+e.created_by,target:"_blank"}},[t._v(t._s(e.created_by))]),t._v(" "),i("span",{staticClass:"update-time"},[t._v(t._s(e.created))])])])])})),0)]):t._e()]):t._e()}),[],!1,null,"2021a5f9",null).exports,pt=i(1931),ht=i(1932),mt=i(1929),vt=i(1930),gt=i.n(vt),ft=i(7),_t=Object(s.c)({name:"calendar-mod",props:{calendarId:{type:[Number,String],default:0},groupId:{type:[Number,String],default:0}},components:{FullCalendar:pt.a},data(){return{typesName:{event:"活动",cal_event:"事件",meeting:"会议",assignment:"任务"},showTips:!1,currentEventInfo:{type:"",xCoordinate:0,yYoordinate:0,id:0,eName:"",eLocation:"",eTime:"",time_type:"",timeLineText:""},calendarOptions:{plugins:[ht.a,mt.a],locale:gt.a,headerToolbar:{left:"dayGridMonth,dayGridWeek",center:"title",right:"prev,next,today"},buttonText:{today:"本月",dayGridMonth:"月",basicWeek:"周"},height:600,initialView:"dayGridMonth",events:this.loadCalendarEvents,eventClick(t){t.jsEvent.preventDefault(),t.event.url&&window.open(t.event.url)},eventMouseEnter:this.eventMouseEnterFn,eventMouseLeave:this.eventMouseLeaveFn}}},setup:()=>({}),computed:{},created(){Date.prototype.format=function(t){const e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(""+this.getFullYear()).substr(4-RegExp.$1.length)));for(const i in e)new RegExp(`(${i})`).test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t}},mounted(){},methods:{loadCalendarEvents(t,e,i){const{start:a,end:s}=t,n=Math.round(a.getTime()/1e3),o=Math.round(s.getTime()/1e3),r=Date.now(),l=`/group/${this.groupId}/calendars/get_cal_events/${this.calendarId}?start=${n}&end=${o}&_=${r}`;ft.a.get(l).then(({data:t})=>{e&&e(t)}).catch(t=>{i&&i(t)})},eventMouseLeaveFn(){this.showTips=!1},eventMouseEnterFn(t){const{event:e,jsEvent:i}=t,a=i.pageX-180,s=i.pageY+5,{extendedProps:n}=e;this.currentEventInfo.xCoordinate=a,this.currentEventInfo.yYoordinate=s,this.currentEventInfo.id=e.id,this.currentEventInfo.eName=n.full_title||e.title,this.currentEventInfo.eLocation=n.location,this.currentEventInfo.type=n.type,this.currentEventInfo.eTime=e.start.format("yyyy-MM-dd"),this.showTips=!0,this.currentEventInfo.time_type=n.time_type||"",null!==e.end&&e.start.format("yyyy-MM-dd")===e.end.format("yyyy-MM-dd")&&"00:00"===e.start.format("hh:mm")&&"23:30"===e.end.format("hh:mm")?this.currentEventInfo.timeLineText=e.start.format("yyyy-MM-dd")+" 全天":e.time_type&&"deadline"===e.time_type?this.currentEventInfo.timeLineText=e.start.format("yyyy-MM-dd"):this.currentEventInfo.timeLineText=e.start.format("yyyy-MM-dd hh:mm")}},filters:{}}),bt=Object(o.a)(_t,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"calendar-item"},[i("FullCalendar",{attrs:{options:t.calendarOptions}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showTips,expression:"showTips"}],staticClass:"event-tips",style:{left:t.currentEventInfo.xCoordinate+"px",top:t.currentEventInfo.yYoordinate+"px"}},[i("ul",[i("li",[i("span",{staticClass:"km-event-name"},[t._v(t._s(t.typesName[t.currentEventInfo.type]||"")+"名称：")]),t._v(" "),i("span",{staticClass:"km-event-value"},[t._v(t._s(t.currentEventInfo.eName))])]),t._v(" "),"deadline"!==t.currentEventInfo.time_type?i("li",[i("span",{staticClass:"km-event-name"},[t._v("地点：")]),t._v(" "),i("span",{staticClass:"km-event-value"},[t._v(t._s(t.currentEventInfo.eLocation))])]):t._e(),t._v(" "),i("li",[i("span",{staticClass:"km-event-name"},[t._v("\n          "+t._s("deadline"===t.currentEventInfo.time_type?"截止日期：":"开始时间：")+"\n        ")]),t._v(" "),i("span",{staticClass:"km-event-value"},[t._v(t._s(t.currentEventInfo.timeLineText))])])])])],1)}),[],!1,null,"e94324ec",null).exports,yt=Object(s.c)({name:"calendar-mod",props:{},components:{calendarItem:bt},data:()=>({}),setup:()=>({}),computed:{groupId(){return this.$store.getters["kbar/getGroupId"]||""},fullCalendarInfo(){return this.$store.getters["kbar/getFullCalendarInfo"]||{}}},created(){this.$store.dispatch("kbar/fetchFullCalendarInfo").then(()=>{}).catch(()=>{})},mounted(){},methods:{},filters:{}}),wt=Object(o.a)(yt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"calendar-mod-container commom-kbar-mod-item"},[""!==this.fullCalendarInfo.calendar_id&&"0"!==this.fullCalendarInfo.calendar_id?e("calendar-item",{attrs:{"calendar-id":this.fullCalendarInfo.calendar_id,"group-id":this.groupId}}):this._e()],1)}),[],!1,null,"fd58bbc6",null).exports,Ct=i(217),kt=i(2041),Ot=i(528),xt=Object(s.c)({name:"MedalMod",components:{TPopup:Ct.a},props:{isEdit:{type:Boolean,default:!1},listType:{type:String,default:"group_awards"}},setup(t,{root:e}){var i;const a=Object(s.r)({name:"K吧达人",id:13}),n=Object(s.r)([]),o=Object(s.r)((null===(i=kt.c[a.value.id])||void 0===i?void 0:i.intro)||""),r=Object(s.a)(()=>e.$store.getters["kbar/getGroupId"]||"");return Object(Ot.j)({groupId:r.value,groupMedalId:a.value.id}).then(({data:t})=>{var e;0===(null==t?void 0:t.code)&&(n.value=(null==t||null===(e=t.data)||void 0===e?void 0:e.award_infos)||[])}),{medalDetail:a,medalWinners:n,articleLink:o}}}),jt=Object(o.a)(xt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return!t.isEdit&&t.medalWinners&&t.medalWinners.length||t.isEdit?i("div",{staticClass:"medal-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"mm__title-area"},[i("span",{staticClass:"mm__title"},[i("span",{staticClass:"mm__title-bar"}),t._v(" "),i("span",{staticClass:"mm__title-text"},[t._v(t._s(t.medalDetail.name))]),t._v(" "),i("span",{staticClass:"mm__title-num"},[t._v(t._s("("+t.medalWinners.length+")"))]),t._v(" "),i("t-popup",{staticClass:"mm__title-tooltip",scopedSlots:t._u([{key:"content",fn:function(){return[i("a",{staticStyle:{color:"#008dfc"},attrs:{href:t.articleLink,target:"_blank"}},[t._v(t._s("什么是"+t.medalDetail.name))])]},proxy:!0}],null,!1,4193494610)},[i("svg-icon",{attrs:{name:"common/info",width:16,height:16,viewBox:"0 0 16 16"}})],1)],1)]),t._v(" "),i("div",{staticClass:"mm__list-area"},[t.medalWinners&&t.medalWinners.length?i("ul",t._l(t.medalWinners,(function(e){return i("li",{key:e.nick+"_"+e.award_name,staticClass:"mm__list-item"},[i("a",{attrs:{href:"/user/"+e.nick,target:"_blank"}},[i("img",{staticClass:"mm__list-item-avatar",attrs:{src:"/asset/avatar/"+e.nick,width:"48",height:"48"}})]),t._v(" "),i("div",{staticClass:"mm__list-item-right"},[i("a",{staticClass:"mm__list-nick",attrs:{href:"/user/"+e.nick,target:"_blank"}},[t._v("\n            "+t._s(e.nick)+"\n          ")]),t._v(" "),i("p",{staticClass:"mm__list-reason"},[t._v("\n            "+t._s("[本期"+e.award_name+"] "+(e.reason||""))+"\n          ")])])])})),0):t.isEdit?i("div",{staticClass:"mm__no-content"},[i("p",[t._v("\n        暂无内容\n      ")])]):t._e()])]):t._e()}),[],!1,null,"40c28f87",null).exports,It=i(144),Tt=Object(s.c)({name:"SquareMod",components:{draggable:Q.a,elDialog:It.Dialog,elButton:It.Button},filters:{},props:{},setup:()=>({}),data:()=>({testTag:!1,showLeft:!0,showRight:!0,deleteItem:{showDeleteDialog:!1,item:null}}),computed:{leftCustomSquareList:{get(){return this.$store.getters["kbar/getLeftCustomSquareList"]||[]},set(t){this.$store.commit("kbar/setLeftCustomSquareList",{list:t,type:"all"})}},rightCustomSquareList:{get(){return this.$store.getters["kbar/getRightCustomSquareList"]||[]},set(t){this.$store.commit("kbar/setRightCustomSquareList",{list:t,type:"all"})}}},mounted(){this.fetchEditComponentsList();const{scrollArea:t}=this.$refs;t.style.height=window.innerHeight+"px"},methods:{clearDeleteItem(){this.deleteItem={showDeleteDialog:!1,item:null}},deleteItemFn(t){this.deleteItem={showDeleteDialog:!0,item:t}},deleteRichItem(t){this.$store.dispatch("kbar/deleteBlockItem",{blockId:t.id,type:t.type||""}).then(t=>{this.clearDeleteItem(),0===t.code?(It.Message.success({message:"删除成功，即将刷新页面"}),setTimeout(()=>{window.location.href=window.location.href},500)):It.Message.error({message:t.message||"删除失败，请稍后重试"})}).catch(t=>{this.clearDeleteItem(),It.Message.error({message:t.message||"删除失败，请稍后重试"})})},deleteBlockItem(t){this.$newConfirm("warning","确定要删除吗？",{confirm:()=>{this.$store.dispatch("kbar/deleteBlockItem",{blockId:t.id,type:t.type||""}).then(t=>{0===t.code?(It.Message.success({message:"删除成功，即将刷新页面"}),setTimeout(()=>{window.location.href=window.location.href},500)):It.Message.error({message:t.message||"删除失败，请稍后重试"})}).catch(t=>{It.Message.error({message:t.message||"删除失败，请稍后重试"})})}})},addBlock(t){this.$store.getters["kbar/getIsPageChange"]?this.$emit("onShowChangeDialog"):this.$emit("onAddBlock",t)},addBanner(){this.$store.getters["kbar/getIsPageChange"]?this.$emit("onShowChangeDialog"):this.$emit("onAddBanner")},fetchEditComponentsList(){const t=t=>{if(t&&t.code){let e=0;403!==t.code&&1003!==t.code&&1403!==t.code||(e=2),this.$store.commit("global/SET_ERROR_PAGE_CODE_INFO",{errType:e,code:t.code||-1e4,message:t.message||"访问出错啦，请稍后重试: "+t.code,mainTitle:""})}};this.$store.dispatch("kbar/fetchEditComponentsList").then(()=>{}).catch(e=>{t(e)})}}}),St=Object(o.a)(Tt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"scrollArea",staticClass:"square-mod-container"},[i("div",{staticClass:"title-area"},[i("span",{staticClass:"title"},[t._v("组件库")]),t._v(" "),i("a",{staticClass:"guide-entry",attrs:{title:"操作指南",href:"/articles/show/575820?kmref=author_recommend",target:"_blank"}},[i("svg-icon",{staticClass:"guide-default",attrs:{name:"kbar/edit/guide",width:16,height:16}}),t._v(" "),i("svg-icon",{staticClass:"guide-hover",attrs:{name:"kbar/edit/guide_active",width:16,height:16}})],1)]),t._v(" "),i("div",{staticClass:"left-components-list-area"},[i("div",{staticClass:"common-title-area"},[t._m(0),t._v(" "),i("span",{staticClass:"spread-btn",class:t.showLeft?"":"show-more",on:{click:function(e){t.showLeft=!t.showLeft}}},[i("svg-icon",{attrs:{name:"kbar/down_arr",width:16,height:16}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showLeft,expression:"showLeft"}],staticClass:"list-area"},[t.leftCustomSquareList&&0===t.leftCustomSquareList.length?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n          暂无内容\n        ")])]):t._e(),t._v(" "),i("draggable",{staticClass:"left-cp-drag-container cp-drag-container",attrs:{"chosen-class":"chosen-item",group:"site1",tag:"ul","ghost-class":"ghost",filter:".delete-mod"},model:{value:t.leftCustomSquareList,callback:function(e){t.leftCustomSquareList=e},expression:"leftCustomSquareList"}},t._l(t.leftCustomSquareList,(function(e){return i("li",{key:e.bid,staticClass:"cp-item"},["custom"===e.type||"double_column"===e.type?i("div",{staticClass:"delete-mod",on:{click:function(i){return t.deleteBlockItem(e)}}},[i("svg-icon",{attrs:{name:"kbar/edit/delete_mod",width:14,height:14}})],1):t._e(),t._v(" "),i("div",{staticClass:"outer-wrapper"},[i("span",{staticClass:"spread-btn show-more cp-icon"},["common"===e.type?["search"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_search",width:36,height:36}}):"latest_items"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_recent",width:36,height:36}}):"latest_feeds"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_dynamic",width:36,height:36}}):"article_class"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_article",width:36,height:36}}):"doc_class"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_doc",width:36,height:36}}):"group_full_calendar"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_calendar",width:36,height:36}}):t._e()]:"custom"===e.type&&"banner"===e.summary?[i("svg-icon",{attrs:{name:"kbar/edit/mod_left_banner",width:36,height:36}})]:"custom"===e.type||"double_column"===e.type?[i("svg-icon",{attrs:{name:"kbar/edit/mod_left_custom",width:36,height:36}})]:t._e()],2)]),t._v(" "),i("p",{staticClass:"cp-name",attrs:{title:e.name}},[t._v("\n            "+t._s(e.name)+"\n          ")])])})),0)],1)]),t._v(" "),i("div",{staticClass:"right-components-list-area"},[i("div",{staticClass:"common-title-area"},[t._m(1),t._v(" "),i("span",{staticClass:"spread-btn",class:t.showRight?"":"show-more",on:{click:function(e){t.showRight=!t.showRight}}},[i("svg-icon",{attrs:{name:"kbar/down_arr",width:16,height:16}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showRight,expression:"showRight"}],staticClass:"list-area"},[t.rightCustomSquareList&&0===t.rightCustomSquareList.length?i("div",{staticClass:"no-content-area"},[i("p",[t._v("\n          暂无内容\n        ")])]):t._e(),t._v(" "),i("draggable",{staticClass:"right-cp-drag-container cp-drag-container",attrs:{group:"site2","chosen-class":"chosen-item",tag:"ul","ghost-class":"ghost",filter:".delete-mod"},model:{value:t.rightCustomSquareList,callback:function(e){t.rightCustomSquareList=e},expression:"rightCustomSquareList"}},t._l(t.rightCustomSquareList,(function(e){return i("li",{key:e.bid,staticClass:"cp-item"},["custom"===e.type||"double_column"===e.type?i("div",{staticClass:"delete-mod",on:{click:function(i){return t.deleteBlockItem(e)}}},[i("svg-icon",{attrs:{name:"kbar/edit/delete_mod",width:14,height:14}})],1):t._e(),t._v(" "),i("div",{staticClass:"outer-wrapper"},[i("span",{staticClass:"spread-btn show-more cp-icon"},["common"===e.type?["group_mini_calendar"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_schedule",width:36,height:36}}):"group_introduction"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_introduction",width:36,height:36}}):"group_admins"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_administrator",width:36,height:36}}):"members"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_member",width:36,height:36}}):"related_groups"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_relational",width:36,height:36}}):"related_knowledges"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_anthology",width:36,height:36}}):"group_tags"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_tag",width:36,height:36}}):"latest_events"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_activity",width:36,height:36}}):"group_awards"===e.summary?i("svg-icon",{attrs:{name:"kbar/edit/mod_medal",width:36,height:36}}):t._e()]:"custom"===e.type?[i("svg-icon",{attrs:{name:"kbar/edit/mod_right_custom",width:36,height:36}})]:t._e()],2)]),t._v(" "),i("p",{staticClass:"cp-name",attrs:{title:e.name}},[t._v("\n            "+t._s(e.name)+"\n          ")])])})),0)],1)]),t._v(" "),i("div",{staticClass:"line-spe"}),t._v(" "),i("div",{staticClass:"customize-components-list-area"},[t._m(2),t._v(" "),i("div",{staticClass:"list-area"},[i("ul",[i("li",{staticClass:"cp-item",on:{click:function(e){return t.addBlock("left")}}},[i("div",{staticClass:"outer-wrapper"},[i("span",{staticClass:"spread-btn show-more cp-icon"},[i("svg-icon",{attrs:{name:"kbar/edit/mod_left_add",width:36,height:36}})],1)]),t._v(" "),i("p",{staticClass:"cp-name"},[t._v("\n            新增左侧\n          ")])]),t._v(" "),i("li",{staticClass:"cp-item",on:{click:function(e){return t.addBlock("right")}}},[i("div",{staticClass:"outer-wrapper"},[i("span",{staticClass:"spread-btn show-more cp-icon"},[i("svg-icon",{attrs:{name:"kbar/edit/mod_right_add",width:36,height:36}})],1)]),t._v(" "),i("p",{staticClass:"cp-name"},[t._v("\n            新增右侧\n          ")])]),t._v(" "),i("li",{staticClass:"cp-item",on:{click:function(e){return t.addBanner()}}},[i("div",{staticClass:"outer-wrapper"},[i("span",{staticClass:"spread-btn show-more cp-icon"},[i("svg-icon",{attrs:{name:"kbar/edit/mod_banner",width:36,height:36}})],1)]),t._v(" "),i("p",{staticClass:"cp-name"},[t._v("\n            新增轮播图\n          ")])])])])]),t._v(" "),t.deleteItem.item?i("el-dialog",{attrs:{title:"提示",width:"20%",visible:t.deleteItem.showDeleteDialog,"lock-scroll":!1},on:{"update:visible":function(e){return t.$set(t.deleteItem,"showDeleteDialog",e)},close:function(e){return t.clearDeleteItem()}}},[i("span",[t._v("确定要删除吗")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.deleteRichItem(t.deleteItem.item)}}},[t._v("确定")]),t._v(" "),i("el-button",{on:{click:function(e){return t.clearDeleteItem()}}},[t._v("\n        取消\n      ")])],1)]):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[this._v("\n        左侧区域\n        "),e("span",{staticClass:"c-title"},[this._v("(点击拖拽)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"title"},[this._v("\n        右侧区域\n        "),e("span",{staticClass:"c-title"},[this._v("(点击拖拽)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"common-title-area"},[e("span",{staticClass:"title"},[this._v("\n        自定义区块\n        "),e("span",{staticClass:"c-title"},[this._v("(点击新增)")])])])}],!1,null,"99375266",null).exports,Dt=i(2012),qt=i(2042),Et=Object(s.c)({name:"SquareMod",components:{UploadCropper:qt.a},filters:{},props:{currentBanner:{type:Object,default:()=>({})}},setup:()=>({}),data:()=>({cropperConfig:{aspectRatio:2.333},showList:!0,showImg:!1,currentUploadItem:{},testList:[{href:""},{href:""},{href:""}],list:[],bannerTitle:"",maxCount:5}),computed:{},mounted(){this.initList()},methods:{initList(){this.bannerTitle=this.currentBanner.title||"",this.currentBanner.content?this.list=JSON.parse(this.currentBanner.content||"[]"):(this.list=[],this.addOneItem())},deleteOneItem(t){this.list.splice(t,1)},addOneItem(t){this.list.length>=this.maxCount?It.Message.error({message:`最多只能添加${this.maxCount}个图`}):this.list.splice(t+1,0,{img:"",target_url:"",title:""})},addFirstItem(){this.list.length>=this.maxCount?It.Message.error({message:`最多只能添加${this.maxCount}个图`}):this.list.unshift({img:"",target_url:"",title:""})},setBanner({url:t}){this.showImg=!1,this.currentUploadItem.img=t+"&imageMogr2/thumbnail/1540x",this.currentUploadItem.originImg=t+"&imageMogr2/thumbnail/1540x"},closeAddBanner(){this.showList=!1,this.$emit("onCloseAdd")},saveAddBanner(){if(!this.bannerTitle.trim())return void It.Message.error({message:"组件标题必须填写"});this.list.some((t,e)=>{const i=e+1;if(!t.img)return It.Message.error({message:`图${i} 没有上传图片，请传图！`}),!0;if(t.target_url){if(null===t.target_url.match(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi))return It.Message.error({message:`图${i}填写了跳转链接，但是链接格式不对，请检查格式或者检查是否有多余空格！`}),!0}return!1})||this.$store.dispatch("kbar/portalsEditBannerBlock",{title:this.bannerTitle,id:this.currentBanner.id||0,type:"custom",region:"center",content:JSON.stringify(this.list),show_title:0,list_type:"banner"}).then(t=>{0===t.code?(this.showList=!1,this.$emit("onSaveAdd"),It.Message.success({message:"保存成功，即将刷新页面"}),setTimeout(()=>{window.location.href=window.location.href},500)):It.Message.error({message:t.message||"保存失败，请稍后重试"})}).catch(t=>{It.Message.error({message:t.message||"保存失败，请稍后重试"})})},closeImageUpload(){this.showImg=!1,this.currentUploadItem.img=this.currentUploadItem.originImg||""},saveImageUpload(){this.showImg=!1},showImageUpload(t){this.showImg=!0,t.originImg=t.img||"",this.currentUploadItem=t}}}),At=Object(o.a)(Et,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-dialog",{attrs:{header:"轮播图",visible:t.showList,mode:"modal","on-confirm":t.saveAddBanner,"on-close":t.closeAddBanner,width:"600px"},on:{"update:visible":function(e){t.showList=e}}},[i("div",{staticClass:"banner-content",attrs:{slot:"body"},slot:"body"},[i("t-form",{staticClass:"banner-content-form"},[i("t-form-item",{attrs:{label:"组件标题","required-mark":""}},[i("t-input",{attrs:{placeholder:"请输入组件名"},model:{value:t.bannerTitle,callback:function(e){t.bannerTitle=e},expression:"bannerTitle"}})],1),t._v(" "),i("t-form-item",{attrs:{label:"选择图片","required-mark":""}},[i("div",{staticClass:"f-title"},[i("span",{staticClass:"s-text"},[t._v("(图片比例21:9,建议尺寸1540*660px)")]),t._v(" "),i("span",{staticClass:"add-first-banner",on:{click:t.addFirstItem}},[t._v("+新增")])])])],1),t._v(" "),i("div",{staticClass:"f-list"},t._l(t.list,(function(e,a){return i("div",{key:a,staticClass:"bannner-item"},[i("div",{staticClass:"pic-href-area"},[i("div",{staticClass:"pic-area",on:{click:function(i){return t.showImageUpload(e)}}},[e.img?i("div",{staticClass:"pic-preview"},[i("img",{attrs:{src:e.img}})]):i("div",{staticClass:"upload-btn"},[i("span",[i("svg-icon",{attrs:{name:"kbar/edit/upload_btn",width:20,height:20}})],1),t._v(" "),i("span",{staticClass:"upload-text"},[t._v("添加")])])]),t._v(" "),i("div",{staticClass:"href-area"},[i("span",{staticClass:"form-title"},[t._v("链接")]),t._v(" "),i("div",{staticClass:"form-text"},[i("t-input",{attrs:{placeholder:"填写跳转链接（可不填）"},model:{value:e.target_url,callback:function(i){t.$set(e,"target_url",i)},expression:"item.target_url"}})],1)]),t._v(" "),i("div",{staticClass:"crud-area"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.list.length>1,expression:"list.length > 1"}],staticClass:"delete-item c-item",on:{click:function(e){return t.deleteOneItem(a)}}},[i("svg-icon",{attrs:{name:"kbar/edit/banner_delete",width:24,height:24}})],1),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:a<t.maxCount-1&&t.list.length<t.maxCount,expression:"index < maxCount - 1 && list.length < maxCount"}],staticClass:"add-item c-item",on:{click:function(e){return t.addOneItem(a)}}},[i("svg-icon",{attrs:{name:"kbar/edit/banner_add",width:24,height:24}})],1)])])])})),0)],1)]),t._v(" "),i("t-dialog",{attrs:{header:"添加图片",visible:t.showImg,mode:"modal","on-close":t.closeImageUpload,footer:!1,width:"790px"},on:{"update:visible":function(e){t.showImg=e}}},[i("div",{staticClass:"img-upload-content",attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"size-tips"},[t._v("\n        图片比例21:9，建议尺寸1540*660px，大小不超过5M\n      ")]),t._v(" "),i("div",{staticClass:"cos-upload-area"},[i("upload-cropper",{attrs:{"packet-block":11,"cropper-config":t.cropperConfig},on:{submit:t.setBanner},model:{value:t.currentUploadItem.img,callback:function(e){t.$set(t.currentUploadItem,"img",e)},expression:"currentUploadItem.img"}})],1)])])],1)}),[],!1,null,"38c3c2b4",null).exports},2062:function(t,e,i){"use strict";i.d(e,"a",(function(){return d})),i.d(e,"b",(function(){return N})),i.d(e,"d",(function(){return U})),i.d(e,"c",(function(){return F}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2412),n=i(1891),o=i(121);let r=70;var l={name:"AiDrawer",components:{TDivider:s.a,TTooltip:n.a,TButton:o.a},model:{prop:"visible"},props:{visible:{type:Boolean,default:!1},defaultWidth:{type:Number,default:440},model:{type:String,default:""},drawTitle:{type:String,default:"AI助手"},showTitleIcon:{type:Boolean,default:!0}},setup(t,e){const i=Object(a.r)(),s=Object(a.r)(),n=Object(a.r)(r);(({domRef:t})=>{Object(a.m)(()=>{try{t.value&&document.body.appendChild(t.value)}catch(t){console.error(t)}}),Object(a.n)(()=>{try{t.value&&document.body.removeChild(t.value)}catch(t){console.error(t)}})})({domRef:i}),(({domRef:t,offsetY:e=50})=>{const i=()=>{const i=e-Math.min(window.scrollY,e);null!=t&&t.value&&(t.value.style.top=i+"px")};Object(a.m)(()=>{i(),window.addEventListener("scroll",i)}),Object(a.n)(()=>{window.removeEventListener("scroll",i)})})({domRef:i,offsetY:70});const{width:o,resizing:l}=(({resizableDomRef:t,defaultWidth:e,minWidth:i=0,minWidthRatio:s=.2,maxWidthRatio:n=.8})=>{const o=localStorage.getItem("AI_DRAWER_WIDTH"),r=Object(a.r)(o||("function"==typeof e?e()||0:e));Object(a.u)(e,t=>{o||p(t)});const l=Object(a.r)(!1),c=t=>l.value=t,d=()=>c(!0),u=()=>c(!1),p=t=>{let e=Math.max(t,i,window.innerWidth*s);e=Math.min(e,window.innerWidth*n),r.value=e,localStorage.setItem("AI_DRAWER_WIDTH",e)},h=t=>{if(l.value){t.preventDefault();const e=window.innerWidth-t.x;p(e)}};return Object(a.m)(()=>{window.addEventListener("mousemove",h),null!=t&&t.value&&(t.value.addEventListener("mousedown",d),window.addEventListener("mouseup",u))}),Object(a.n)(()=>{window.removeEventListener("mousemove",h),null!=t&&t.value&&(t.value.removeEventListener("mousedown",d),window.removeEventListener("mouseup",u))}),{width:r,setWidth:p,resizing:l}})({resizableDomRef:s,minWidth:440,defaultWidth:()=>t.defaultWidth}),c=Object(a.a)({get:()=>t.visible,set:t=>e.emit("input",t)});return Object(a.u)(c,t=>{t&&(r+=1,n.value=r)}),{mainDomRef:i,resizableDomRef:s,zIndex:n,width:o,resizing:l,drawerVisible:c}}},c=i(68),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"mainDomRef",staticClass:"ai-drawer",style:{width:t.width+"px",transform:"translateX("+(t.drawerVisible?0:"100%")+")",zIndex:t.zIndex}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.drawerVisible,expression:"drawerVisible"}],ref:"resizableDomRef",staticClass:"ai-drawer-controller"}),t._v(" "),i("div",{staticClass:"ai-drawer-inner",style:t.resizing?{userSelect:"none"}:{}},[i("div",{staticClass:"header"},[i("div",{staticClass:"header-title"},[t.model?i("t-tooltip",{directives:[{name:"show",rawName:"v-show",value:t.showTitleIcon,expression:"showTitleIcon"}],attrs:{content:t.model,"show-arrow":!1}},[i("svg-icon",{attrs:{name:"common/hunyuan",width:92,height:24}})],1):i("svg-icon",{directives:[{name:"show",rawName:"v-show",value:t.showTitleIcon,expression:"showTitleIcon"}],attrs:{name:"common/hunyuan",width:92,height:24}}),t._v(" "),i("t-divider",{directives:[{name:"show",rawName:"v-show",value:t.showTitleIcon,expression:"showTitleIcon"}],staticStyle:{"border-width":"2px","border-color":"#999999",margin:"0 6px"},attrs:{layout:"vertical"}}),t._v(" "),i("span",[t._v(t._s(t.drawTitle))])],1),t._v(" "),i("t-button",{staticClass:"header-action",attrs:{theme:"default",variant:"text"},on:{click:function(e){t.drawerVisible=!1}}},[i("span",{staticStyle:{display:"flex","align-items":"center"}},[i("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{name:"common/arrow-double-right",width:20,height:20}}),t._v("\n          收起\n        ")],1)])],1),t._v(" "),i("div",{staticClass:"body"},[t._t("default",null,{resizeDom:t.resizableDomRef})],2)])])}),[],!1,null,"f143d806",null).exports,u=i(48),p=i.n(u),h=i(17),m=i.n(h),v=i(6),g=i.n(v),f=i(1975),_=i(72),b={allowHalf:Boolean,color:{type:[String,Array],default:"#ED7B2F"},count:{type:Number,default:5},disabled:Boolean,gap:{type:Number,default:4},icon:{type:Function},showText:Boolean,size:{type:String,default:"24px"},texts:{type:Array,default:function(){return[]}},value:{type:Number,default:void 0},defaultValue:{type:Number,default:0},onChange:Function},y=i(10),w=i(50);i(25),i(53),i(16),i(114),i(58),i(32),i(38),i(23),i(24),i(27),i(26),i(56);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach((function(e){g()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var O=Object(a.c)({name:"TRate",props:k({},b),setup:function(t){var e=Array.isArray(t.color)?t.color[0]:t.color,i=Array.isArray(t.color)?t.color[1]:"var(--td-bg-color-component)",s=Object(a.t)(t).value,n=Object(_.a)(s,t.defaultValue,t.onChange,"change"),o=m()(n,2),r=o[0],l=o[1],c=Object(a.r)(void 0),d=Object(a.r)(),u=Object(w.a)("classPrefix").classPrefix,p=Object(a.a)((function(){return Number(c.value||r.value)})),h=Object(a.a)((function(){return 0===t.texts.length?["极差","失望","一般","满意","惊喜"]:t.texts})),v=function(e,i){if(t.allowHalf){var a,s,n,o=(null===(a=d.value)||void 0===a||null===(s=a.getBoundingClientRect)||void 0===s?void 0:s.call(a)).left,r=d.value.firstChild.nextSibling,l=(null==r||null===(n=r.getBoundingClientRect)||void 0===n?void 0:n.call(r)).width,c=e.clientX,u=l*(i-.5)+t.gap*(i-1);if(c-o>=u)return i;if(c-o<u)return i-.5}return i},g=Object(a.a)((function(){return{fontSize:t.size,color:e}})),f=Object(a.a)((function(){return{fontSize:t.size,color:i}}));return{classPrefix:u,mouseLeaveHandler:function(){t.disabled||(c.value=void 0)},getStarCls:function(e){return t.allowHalf&&e+.5===p.value?"".concat(u.value,"-rate__item--half"):e>=p.value?"":e<p.value?"".concat(u.value,"-rate__item--full"):void 0},clickHandler:function(e,i){t.disabled||l(v(e,i))},mouseEnterHandler:function(e,i){t.disabled||(c.value=v(e,i))},activeColor:e,defaultColor:i,displayText:h,displayValue:p,rootRef:d,activeIconStyle:g,inactiveIconStyle:f}},methods:{renderRateIcon:function(){var t=this.$createElement;return Object(y.c)(this,"icon",t(f.a))}},render:function(){var t=this,e=arguments[0],i=this.classPrefix,a=this.mouseLeaveHandler,s=this.getStarCls,o=this.clickHandler,r=this.mouseEnterHandler,l=this.displayText,c=this.displayValue;return e("div",{class:"".concat(i,"-rate"),on:{mouseleave:a}},[e("ul",{class:"".concat(i,"-rate__list"),style:{gap:"".concat(this.gap,"px")},ref:"rootRef"},[p()(Array(Number(this.count))).map((function(a,d){return e("li",{key:d,class:["".concat(i,"-rate__item"),s(d)],on:{click:function(t){return o(t,d+1)},mousemove:function(t){return r(t,d+1)}}},[t.showText?e(n.a,{key:d,attrs:{content:l[c-1]}},[e("div",{class:"".concat(i,"-rate__star-top"),style:k({},t.activeIconStyle)},[t.renderRateIcon()]),e("div",{class:"".concat(i,"-rate__star-bottom"),style:k({},t.inactiveIconStyle)},[t.renderRateIcon()])]):e("div",[e("div",{class:"".concat(i,"-rate__star-top"),style:k({},t.activeIconStyle)},[t.renderRateIcon()]),e("div",{class:"".concat(i,"-rate__star-bottom"),style:k({},t.inactiveIconStyle)},[t.renderRateIcon()])])])}))]),this.showText&&e("div",{class:"".concat(i,"-rate__text")},[l[c-1]])])}}),x=i(35),j=Object(x.a)(O,a.b),I=i(1936),T=i.n(I),S=i(2117),D=i.n(S),q={name:"KmVueMarkdown",components:{VueMarkdown:T.a},directives:{highlight:{bind:t=>{t.querySelectorAll("pre code").forEach(t=>{D.a.highlightBlock(t)})}}},inheritAttrs:!1},E=Object(c.a)(q,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"km-vue-markdown"},[e("vue-markdown",this._b({directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"markdown-body"},"vue-markdown",this.$attrs,!1))],1)}),[],!1,null,"636f93af",null).exports,A=i(144);const M={components:{Modal:i(2014).a,ElForm:A.Form,ElFormItem:A.FormItem,ElInput:A.Input},model:{prop:"visible"},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"填写反馈"},onConfirm:{type:Function,default:()=>{}}},setup(t,e){const i=Object(a.a)({get:()=>t.visible,set:t=>e.emit("input",t)}),s=Object(a.q)({content:""}),n=Object(a.q)({content:[{required:!0,message:"请输入反馈内容",transform:t=>t.trim()}]});return Object(a.u)(i,t=>{t||e.refs.form.resetFields()}),{modalVisible:i,formValues:s,formRules:n,handleSubmit:()=>{e.refs.form.validate(async a=>{if(!a)return!1;e.emit("confirm",s.content),"function"==typeof t.onConfirm&&await t.onConfirm(s.content),i.value=!1})}}}};let $=null;function L(t){t.$destroy(),document.body.contains(t.$el)&&document.body.removeChild(t.$el),$===t&&($=null)}M.show=function(t){$&&L($);const e=new(Vue.extend(M))({propsData:t}).$mount();return e.$on("input",t=>{t||(e.visible=!1,setTimeout(()=>{L(e)},500))}),Vue.nextTick(()=>e.visible=!0),document.body.appendChild(e.$el),$=e,new Promise(t=>{e.$once("confirm",e=>{t(e)})})};var P=M,F=Object(c.a)(P,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{"show-modal":t.modalVisible,title:t.title,"append-to-body":"",top:"30vh"},on:{onCloseModal:function(){return t.modalVisible=!1},onSubmitModal:t.handleSubmit}},[i("el-form",{ref:"form",attrs:{model:t.formValues,rules:t.formRules,"label-width":"0","label-suffix":":"}},[i("el-form-item",{attrs:{prop:"content",required:""}},[i("el-input",{attrs:{autocomplete:"off",type:"textarea",rows:8,resize:"none",maxlength:500,placeholder:"例如：体验优化、内容准确度、功能建议或bug"},model:{value:t.formValues.content,callback:function(e){t.$set(t.formValues,"content",e)},expression:"formValues.content"}})],1)],1)],1)}),[],!1,null,null,null).exports,R={name:"AiDrawerItem",components:{TRate:j,TButton:o.a,Markdown:E},props:{loading:{type:Boolean,default:!1},title:{type:String,default:()=>""},content:{type:String,default:()=>""},editable:{type:Boolean,default:!1},onEvaluate:{type:Function,default:()=>{}},onRebuild:{type:Function,default:()=>{}},onFeedback:{type:Function,default:()=>{}}},setup(t,e){const i=Object(a.r)(0),s=Object(a.a)(()=>({content:t.content}));Object(a.u)(s,()=>{var t;(null==e||null===(t=e.parent)||void 0===t?void 0:t.drawerVisible)&&(i.value=0)});return{handleRebuild:()=>{F.show({title:"重新生成原因",onConfirm:t.onRebuild})},handleFeedback:()=>{F.show({title:"填写反馈",onConfirm:t.onFeedback})},evaluateValue:i,handlEvaluate:async e=>{console.log("evaluate: ",e),e>0&&e!==i.value&&(i.value=e,"function"==typeof t.onEvaluate&&await t.onEvaluate(e))}}}},N=Object(c.a)(R,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"container"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-title"},[t.$slots.title?t._t("title"):i("span",[t._v(t._s(t.title))])],2),t._v(" "),i("div",{staticClass:"card-content"},[t.loading?i("div",{staticClass:"card-content-loading"},[i("svg-icon",{staticStyle:{"margin-right":"4px"},attrs:{name:"common/loading2",width:20,height:20}}),t._v("\n          内容生成中\n        ")],1):i("Markdown",{staticClass:"markdown",attrs:{source:t.content}})],1)]),t._v(" "),!t.loading&&t.content?i("div",{staticClass:"container-footer"},[i("div",{staticStyle:{display:"flex"}},[i("span",[t._v("质量评价：")]),t._v(" "),i("t-rate",{attrs:{size:"16px",color:"#FFA333",value:t.evaluateValue},on:{change:function(e){return t.handlEvaluate(e)}},scopedSlots:t._u([{key:"icon",fn:function(){return[i("svg-icon",{attrs:{name:"common/rate",width:16,height:16}})]},proxy:!0}],null,!1,2434409813)})],1),t._v(" "),i("div",{staticStyle:{display:"flex"}},[t._t("actions"),t._v(" "),t.editable?i("t-button",{staticClass:"button",attrs:{theme:"default",variant:"text"},on:{click:t.handleRebuild}},[i("span",{staticStyle:{display:"flex","align-items":"center"}},[i("svg-icon",{attrs:{name:"common/refresh",width:20,height:20}}),t._v(" "),i("span",{staticStyle:{"margin-left":"5px"}},[t._v("重新生成")])],1)]):t._e(),t._v(" "),i("t-button",{staticClass:"button",attrs:{theme:"default",variant:"text"},on:{click:t.handleFeedback}},[i("span",{staticStyle:{display:"flex","align-items":"center"}},[i("svg-icon",{attrs:{name:"common/feedback",width:20,height:20}}),t._v(" "),i("span",{staticStyle:{"margin-left":"5px"}},[t._v("填写反馈")])],1)])],2)]):t._e()])])}),[],!1,null,"41caea3d",null).exports,B={name:"ChatDrawerItem",components:{TButton:o.a},props:{title:{type:String,default:()=>""},onEvaluate:{type:Function,default:()=>{}},onFeedback:{type:Function,default:()=>{}}},setup(t,e){const i=Object(a.r)(!0),s=Object(a.r)(null);let n=null;const o=()=>{i.value=!0};return Object(a.m)(()=>{n=e.parent.resizableDomRef,n&&n.addEventListener("mousedown",o)}),Object(a.n)(()=>{n&&n.removeEventListener("mousemove",o)}),{innerRef:s,chatContainerFloat:i,handleFeedback:()=>{F.show({title:"填写反馈",onConfirm:t.onFeedback})},handleClickFloatDiv:t=>{t.target!==t.currentTarget?i.value=!1:i.value=!0}}}},U=Object(c.a)(B,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"flota-chat-container",class:{"flota-chat-container-hidden":!t.chatContainerFloat},on:{click:t.handleClickFloatDiv}},[i("div",{staticClass:"flota-chat-container-inner"})]),t._v(" "),i("iframe",{staticClass:"chat-iframe",attrs:{src:"https://yst.woa.com/chat/chatComp?web_key=1729045890_5337_lawrencegao"}}),t._v(" "),i("div",{staticClass:"container-footer"},[i("div",{staticStyle:{display:"flex"}},[t._t("actions"),t._v(" "),i("t-button",{staticClass:"button",attrs:{theme:"default",variant:"text"},on:{click:t.handleFeedback}},[i("span",{staticStyle:{display:"flex","align-items":"center"}},[i("svg-icon",{attrs:{name:"common/feedback",width:20,height:20}}),t._v(" "),i("span",{staticStyle:{"margin-left":"5px"}},[t._v("填写反馈")])],1)])],2)])])])}),[],!1,null,"ec691682",null).exports},2063:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1893),n=i.n(s),o=i(127),r=i.n(o),l=i(2025),c=i(2017),d=i(1320),u=i(7);const p=t=>u.a.post("/km_bff/feedback/v1/create_comment",t);var h=i(57),m=i(2005),v=i(2007),g=i(2003),f=i(168);const _=[{key:"score",label:"智能排序"},{key:"asc",label:"时间升序"},{key:"desc",label:"时间降序"}];var b=i(2008),y=i(2031),w={name:"CommentReferred",components:{},props:{referredText:{type:String,required:!0,default:""},type:{type:String,required:!0,default:"editor"}},setup(t){const e=Object(a.f)("$bus"),i=Object(a.r)(),s=Object(a.r)(!1),n=Object(a.r)(!1);Object(a.u)(()=>t.referredText,()=>{s.value=!!i.value&&o()}),Object(a.u)(()=>i.value,()=>{s.value=o()});const o=()=>i.value.scrollHeight>i.value.clientHeight;return{referredTextDOM:i,showExpandBtn:s,expandedReferredText:n,handleCloseReferred:()=>{e.emit("clearReferredText")},handleChangeExpandStatus:()=>{s.value&&(n.value=!n.value)}}}},C=i(68),k=Object(C.a)(w,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.referredText?i("div",{class:["comment-referred-container","edit"===t.type?"comment-referred-container-edit":"comment-referred-container-show"]},[i("div",{ref:"referredTextDOM",class:["referred-text",t.expandedReferredText&&"expanded-referred-text",t.showExpandBtn&&"pointer-referred-text"],on:{click:t.handleChangeExpandStatus}},[i("span",{staticClass:"comment-referred-border"}),t._v("\n    "+t._s(t.referredText)+"\n    "),"show"===t.type&&t.showExpandBtn&&!t.expandedReferredText?i("span",{staticClass:"expand-btn"},[t._v("\n      展开全部\n    ")]):t._e(),t._v(" "),"show"===t.type&&t.showExpandBtn&&t.expandedReferredText?i("div",{staticClass:"pack-up-btn"},[t._v("\n      收起\n    ")]):t._e()]),t._v(" "),"edit"===t.type?i("div",{staticClass:"close-referred-container",on:{click:t.handleCloseReferred}},[i("svg-icon",{attrs:{color:"#666666",name:"entry/close",width:16,height:16,viewBox:"0 0 16 16"}})],1):t._e()]):t._e()}),[],!1,null,"1624e392",null).exports,O={name:"CommentItem",components:{venomTextarea:n.a,badgeTwitter:v.a,Dropdown:b.a,CommentReferred:k},props:{trilobiteEditOpen:{type:Boolean,default:!0},trilobitePreviewOpen:{type:Boolean,default:!0},info:{type:Object,required:!0,default:()=>{}},hasAuth:{type:Boolean,required:!0,default:!1},entityInfo:{type:Object,required:!1,default:()=>{}},entityType:{type:String,required:!0,default:""},entityId:{required:!0,default:""},groupId:{required:!0,default:void 0},reprintGroupId:{required:!0,default:void 0},isLevel1:{type:Boolean,required:!1,default:!0},parentId:{required:!1,default:void 0}},setup(t,e){const i=r.a.get("km_uid")||r.a.get("storm_km_id"),s=Object(a.d)(),n=Object(a.r)(""),o=Object(a.r)(),v=Object(a.r)(),_=Object(a.r)(),b=Object(a.r)(),w=Object(a.a)(()=>e.root.$store.getters["global/userRole"]),C=Object(a.r)(),k=Object(a.r)(!1),O=Object(a.r)(t.info.is_voted),x=Object(a.r)(t.info.is_downvoted),j=Object(a.r)(t.info.is_pinned),I=Object(a.r)(!1),T=Object(a.r)(""),S=Object(a.r)(null),D=Object(a.r)("comment-item-id-"),q=t=>{k.value&&!o.value.contains(t.target)&&(k.value=!1)};Object(a.m)(()=>{if(window.addEventListener("click",q),Object(c.b)({contentSelector:".comment-item-content-"+t.info.id,isTargetBlankView:!1}),Object(c.c)(`.comment-item-content-${t.info.id} img`),"iWiki"===t.info.editor_type&&t.trilobitePreviewOpen){const e=t.info.json_content||"",{id:i}=t.info;if(!e||!i)return null;const a={container:"#"+(D.value+i),appearance:"comment",language:"zh",value:e,model:"preview",clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},plugins:[new window.ImagePlugin,new window.FontSizePlugin({defaultFontSize:{value:14,title:"14px"},fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})]};return new window.TrilobiteEditor(a)}});const E=Object(a.a)(()=>{const e=[];return t.hasAuth&&t.isLevel1&&e.push({value:"handleChangeIsTop",text:j.value?"取消置顶":"置顶",iconInfo:{name:"common/top",width:20,height:20}}),t.isLevel1&&!t.info.is_creator&&e.push({value:"handleChangeIsNoHelp",text:"没有帮助",actived:x.value,iconInfo:{name:"common/disagree",width:20,height:20}}),(w.value.isAdmin||t.info.is_creator)&&e.push({value:"handleClickDelete",text:"删除",iconInfo:{name:"common/delete",width:20,height:20}}),e}),A=Object(d.a)(async()=>{var i;if(n.value&&null!==(i=n.value)&&void 0!==i&&i.trim()){try{const i=await p({group_id:t.groupId,target_id:t.parentId,target_type:"Comment",content:n.value,src:"pc"});0===i.data.code&&(e.emit("afterReply",{parentId:t.parentId,replyId:t.info.id,...i.data.data}),n.value="",P())}catch{}U()}},2e3,{leading:!0,trailing:!1}),M=Object(a.r)(t.info.vote_count||0),$=()=>{var e;x.value?(e={target_id:+t.info.id,target_type:"Comment",group_id:t.groupId},u.a.post("/km_bff/feedback/v1/delete_downvote",e)).then(()=>{x.value=!x.value}):(t=>u.a.post("/km_bff/feedback/v1/create_downvote",t))({target_id:+t.info.id,target_type:"Comment",group_id:t.groupId}).then(()=>{x.value=!x.value}),B(x.value?"CancelNoHelp":"NoHelp")},L=async()=>{var e;(e={entity_id:+t.entityId,entity_type:t.entityType,comment_id:+t.info.id,status:j.value?0:1},u.a.post("/km_bff/feedback/v1/pin_comment",e)).then(()=>{j.value=!j.value}),B(j.value?"CancelTop":"Top")},P=()=>{const e=v.value.classList.contains("hide-reply-content"),i=document.querySelectorAll(".reply-content");i&&i.forEach(t=>{!t.classList.contains("hide-reply-content")&&t.classList.add("hide-reply-content")}),e?(v.value.classList.remove("hide-reply-content"),n.value="",t.isLevel1||(n.value=`@${t.info.created_by} `)):v.value.classList.add("hide-reply-content")},F=()=>{const i=t.isLevel1?"删除评论后，评论下的回复也将删除":"你确定删除该回复吗？";s.proxy.$newConfirm("warning",i,{confirm:()=>{var i;B("Delete"),(i={comment_id:+t.info.id},u.a.post("/km_bff/feedback/v1/delete_comment",i)).then(()=>{e.emit("afterDelete")})}})},{userCardItem:R,renderUserCard:N}=Object(m.a)(e,{idKey:"nick",refKey:"comment_creator"}),B=e=>{Object(h.b)("commentOperate",{target_type:t.entityType,target_id:t.entityId,comment_id:t.info.id,parent_id:t.parentId,user_nick:i,show_groups:t.reprintGroupId,group_id:t.groupId,operation_type:e})},U=()=>{Object(h.b)("commentSend",{target_type:t.entityType,target_id:t.entityId,parent_id:t.parentId,user_nick:i,show_groups:t.reprintGroupId,group_id:t.groupId,quote_status:0})},H={nick:t.info.created_by},V=Object(a.r)(Object.freeze({handleChangeIsTop:L,handleChangeIsNoHelp:$,handleClickDelete:F}));return{createrInfo:H,nickName:i,replyContent:n,agreeCount:M,userRole:w,commentItemBottomDOM:C,adminActionActived:k,isAgree:O,isNoHelp:x,isTop:j,isAgreeing:I,agreeGifUrl:T,userCardItem:R,renderUserCard:N,adminActionDOM:o,replyContentDOM:v,replyActionDOM:_,expresstionBtnDOM:S,commentEditorId:D,replyTextareaDOM:b,getElementTop:f.g,dropdownItemList:E,closeAdminActionList:q,jumpTo:t=>{window.location.href=t},handleChangeIsNoHelp:$,handleChangeIsTop:L,handleChangeIsAgree:async()=>{I.value||(O.value||(I.value=!0,T.value="https://assets.km.tencent.com/ImageHosting/20230815/0c7ddd98b314bd787ded6411aa8d76f7.gif",setTimeout(()=>{I.value=!1,T.value=""},700)),O.value?Object(g.l)({target_id:+t.info.id,target_type:"Comment",group_id:t.groupId}).then(()=>{O.value=!O.value,M.value=M.value-1}):Object(g.h)({target_id:+t.info.id,target_type:"Comment",group_id:t.groupId}).then(()=>{O.value=!O.value,M.value=M.value+1}),B(O.value?"CancelAgree":"Agree"))},handleClickReply:P,handleOpenAdminActionList:()=>{k.value=!k.value},handleClickDelete:F,handleCommentConfirm:A,openExpressionModal:t=>{var i;t.stopPropagation(),t.preventDefault();const s=null===(i=S.value)||void 0===i?void 0:i.getBoundingClientRect();e.root.$expression({top:Object(f.g)(S.value)+40,left:s.left+(document.documentElement||document.body.parentNode||document.body).scrollLeft,confirm:t=>{var e;const i=null===(e=b.value.$el.getElementsByTagName("textarea"))||void 0===e?void 0:e[0],s=i.selectionStart,o=n.value.substr(0,s)+t+n.value.substr(s);n.value=o,Object(a.g)(()=>{const e=s+t.length;i.setSelectionRange(e,e)})}})},commentOperationReport:B,createCommentReport:U,dropdownFuncs:V,handleClickCommentContent:t=>{var e;if(!t||!t.target)return;const{target:i}=t;"IMG"===i.tagName&&"A"!==(null===(e=i.parentNode)||void 0===e?void 0:e.tagName)&&y.a.show({src:i.src})},transformContentImg:()=>Object(l.h)(t.info.content)}}},x=Object(C.a)(O,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-item-container"},[i("div",{ref:"comment_creator"+t.info.created_by,class:["avatar-container",!t.isLevel1&&"small-avatar"],on:{mouseenter:function(e){return t.renderUserCard(t.createrInfo,t.info.created_by,t.info.id)},mouseleave:function(e){return t.renderUserCard(t.createrInfo,null,null,!1)}}},[i("badge-twitter",{attrs:{width:t.isLevel1?48:32,"check-unique-key":!0,"user-data":t.userCardItem,"show-attention":!1,"unique-key":"comment_creator"+t.info.created_by+t.info.id}}),t._v(" "),i("a",{attrs:{target:"_blank",href:"/user/"+t.info.created_by}},[i("img",{staticClass:"avatar-img",attrs:{src:"/asset/avatar/"+t.info.created_by}})])],1),t._v(" "),i("div",{staticClass:"comment-item-info"},[i("div",{staticClass:"comment-item-header"},[i("div",{staticClass:"user-info"},[i("a",{staticClass:"user-name",attrs:{target:"_blank",href:"/user/"+t.info.created_by}},[t._v(t._s(t.info.created_by))]),t._v(" "),t.info.created_by===t.entityInfo.created_by?i("span",{staticClass:"creator-icon"},[t._v("作者")]):t._e()]),t._v(" "),t.isLevel1&&t.isTop?i("span",{staticClass:"is-top"},[t._v("置顶")]):t._e()]),t._v(" "),i("comment-referred",{staticClass:"comment-referred-container",attrs:{type:"show","referred-text":t.info.referred_text}}),t._v(" "),"iWiki"===t.info.editor_type&&t.trilobitePreviewOpen?i("div",{staticClass:"km-trilobite-editor",class:"comment-item-content comment-item-content-"+t.info.id},[i("div",{staticClass:"editor-hook",attrs:{id:t.commentEditorId+t.info.id},on:{click:t.handleClickCommentContent}})]):i("div",{class:"comment-item-content comment-item-content-"+t.info.id,domProps:{innerHTML:t._s(t.transformContentImg())},on:{click:t.handleClickCommentContent}}),t._v(" "),i("div",{ref:"commentItemBottomDOM",staticClass:"comment-item-bottom"},[i("div",{staticClass:"comment-item-bottom-left"},[i("t-popup",{attrs:{content:t.info.modified}},[i("span",{staticClass:"comment-item-time"},[t._v(t._s(t.info.created))])]),t._v(" "),i("span",[t._v(" · ")]),t._v(" "),i("span",{staticClass:"reply-button",on:{click:t.handleClickReply}},[t._v("回复")])],1),t._v(" "),i("div",{staticClass:"comment-item-action"},[t.isLevel1?i("span",{class:["agree-action",t.isAgree?"agree-action-actived":""],on:{click:t.handleChangeIsAgree}},[i("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isAgreeing,expression:"!isAgreeing"}],attrs:{width:20,height:20,name:"common/agree"}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isAgreeing,expression:"isAgreeing"}],staticClass:"agree-gif",attrs:{src:t.agreeGifUrl,alt:""}}),t._v("\n          "+t._s(t.agreeCount||"")+"\n        ")],1):t._e(),t._v(" "),i("dropdown",{attrs:{"item-list":t.dropdownItemList},on:{clickItem:function(e){var i=e.item;return t.dropdownFuncs[i.value]()}}},[t.info.is_creator||t.userRole.isAdmin||t.isLevel1&&(t.hasAuth||!t.info.is_creator)?i("span",{ref:"adminActionDOM",class:["admin-action",!t.isLevel1&&"admin-action-level-2"],on:{click:t.handleOpenAdminActionList}},[i("svg-icon",{attrs:{width:20,height:20,name:"common/more"}})],1):t._e()])],1)]),t._v(" "),i("div",{ref:"replyContentDOM",class:["reply-content","hide-reply-content"]},[i("venom-textarea",{ref:"replyTextareaDOM",staticClass:"reply-textarea",attrs:{placeholder:t.isLevel1?"回复"+t.info.created_by:"",rows:1,autoszie:!0},model:{value:t.replyContent,callback:function(e){t.replyContent=e},expression:"replyContent"}}),t._v(" "),i("div",{staticClass:"reply-operation"},[i("div",{ref:"expresstionBtnDOM",staticClass:"expresstion-btn",on:{click:t.openExpressionModal}},[i("svg-icon",{staticClass:"comment-sort-icon",attrs:{name:"common/face",width:20,height:20,viewBox:"0 0 16 16"}}),t._v("\n          表情\n        ")],1),t._v(" "),i("div",{staticClass:"btn-container"},[i("div",{staticClass:"cancel-btn",on:{click:t.handleClickReply}},[t._v("\n            取消\n          ")]),t._v(" "),i("div",{staticClass:"reply-btn",on:{click:t.handleCommentConfirm}},[t._v("\n            回复\n          ")])])])],1)],1)])}),[],!1,null,"0364ede1",null).exports,j=i(2011),I=i(2032),T={name:"CommentEditor",components:{richEditor:j.a,venomTextarea:n.a,badgeTwitter:v.a,trilobiteEditorMod:I.a},props:{trilobiteEditOpen:{type:Boolean,default:!0},trilobitePreviewOpen:{type:Boolean,default:!0},entityType:{type:String,required:!0,default:""},entityId:{type:[String,Number],required:!0,default:""},groupId:{type:[String,Number],required:!0,default:void 0},reprintGroupId:{type:[String,Number],required:!0,default:void 0},referredText:{type:String,required:!1,default:""}},setup(t,e){const i=r.a.get("km_uid")||r.a.get("storm_km_id"),s=Object(a.r)(""),n=Object(a.r)(!1),o=Object(l.e)(),c=Object(a.r)(),d=Object(a.r)(),u=Object(a.r)(),v=Object(a.r)(),g={content_css:[...o.content_css,"/vkm/tinymce/skins/custom/comment.css"],max_height:300,min_height:200,invalid_styles:"font-family",setup:t=>{window.tinymceImgConfig={...window.tinymceImgConfig,block:5},u.value=t,t.on("change",()=>{s.value=window.tinymce.activeEditor.getContent()})}},_=Object(a.r)(!1);_.value=!t.trilobiteEditOpen;const b=t=>{const e=t.trim().replace(/\n/g,"");if(e){var i;const t=`{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"${e}"}]}],"version":1}`;null===(i=v.value)||void 0===i||i.updateContent(t)}},{userCardItem:y,renderUserCard:w}=Object(m.a)(e,{idKey:"nick",refKey:"comment_creator"}),C={nick:i},k=Object(a.f)("$bus");return k.on("focusArticleEditor",()=>{var t,e,i;n.value?u.value.focus():null===(t=d.value)||void 0===t||null===(e=t.$el)||void 0===e||null===(i=e.querySelector(".venom-textarea"))||void 0===i||i.focus()}),{nickName:i,useRichEditorOld:_,trilobiteRef:v,useRichEditor:n,extraContent:s,editorConfigs:g,expressionBtnDOM:c,commentEditorTextareaDOM:d,userCardItem:y,createrInfo:C,$bus:k,jumpTo:t=>{window.location.href=t},openRichEditor:()=>{if(n.value=!0,_.value)return void setTimeout(()=>{window.tinymce.activeEditor.setContent(s.value)},1e3);const t=s.value||"";b(t)},openImageModal:()=>{if(n.value=!0,_.value)setTimeout(()=>{window.tinymce.activeEditor.execCommand("open_img_modal")});else{const t=s.value||"";b(t)}},handleCommentConfirm:async()=>{const a=s.value;if(Object(h.b)("commentSend",{target_type:t.entityType,target_id:t.entityId,parent_id:"",user_nick:i,show_groups:t.reprintGroupId,group_id:t.groupId,quote_status:t.referredText?1:0}),!_.value&&n.value){var o,r;if(null!==(o=v.value)&&void 0!==o&&o.checkIsContentEmpty())return;const i=null===(r=v.value)||void 0===r?void 0:r.provideContent(),a=await p({group_id:t.groupId,target_id:+t.entityId,target_type:t.entityType,content:i||"",editor_type:"iWiki",src:"pc",is_richtext:!1});var l;if(0===a.data.code)e.emit("afterComment",{...a.data.data,replies:[]}),k.emit("clearReferredText"),s.value="",null===(l=v.value)||void 0===l||l.updateContent(JSON.stringify({type:"doc",content:[],version:1}),{isClear:!0});return}const c=await p({group_id:t.groupId,target_id:+t.entityId,target_type:t.entityType,content:a,src:"pc",referred_text:t.referredText,is_richtext:n.value});0===c.data.code&&(e.emit("afterComment",{...c.data.data,replies:[]}),k.emit("clearReferredText"),s.value="",_.value&&window.tinymce.activeEditor.setContent(""))},openExpression:t=>{var i;t.stopPropagation(),t.preventDefault();const n=null===(i=c.value)||void 0===i?void 0:i.getBoundingClientRect();e.root.$expression({top:Object(f.g)(c.value)+40,left:n.left+(document.documentElement||document.body.parentNode||document.body).scrollLeft,confirm:t=>{var e;const i=null===(e=d.value.$el.getElementsByTagName("textarea"))||void 0===e?void 0:e[0],n=i.selectionStart,o=s.value.substr(0,n)+t+s.value.substr(n);s.value=o,Object(a.g)(()=>{const e=n+t.length;i.setSelectionRange(e,e)})}})},renderUserCard:w}}},S=Object(C.a)(T,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-container"},[i("div",{ref:"comment_creator"+t.nickName,staticClass:"avatar-container",on:{mouseenter:function(e){return t.renderUserCard(t.createrInfo,t.nickName)},mouseleave:function(e){return t.renderUserCard(t.createrInfo)}}},[i("badge-twitter",{attrs:{"user-data":t.userCardItem,"show-attention":!1}}),t._v(" "),i("a",{attrs:{target:"_blank",href:"/user/"+t.nickName}},[i("img",{staticClass:"avatar-img",attrs:{src:"/asset/avatar/"+t.nickName}})])],1),t._v(" "),i("div",{staticClass:"comment-editor-content"},[t.trilobiteEditOpen?[i("div",{directives:[{name:"show",rawName:"v-show",value:t.useRichEditor,expression:"useRichEditor"}],staticClass:"comment-trilobite-wrapper"},[i("trilobiteEditorMod",{ref:"trilobiteRef",attrs:{"editor-type":"add",appearance:"comment","img-block-id":5,"business-type":"input-business-type-comment"}},[i("p",[t._v("no comment editor")])])],1)]:t._e(),t._v(" "),t.useRichEditorOld&&t.useRichEditor?i("rich-editor",{attrs:{configs:t.editorConfigs,value:t.extraContent,mode:"simple",plugins:["lximg","link"]}}):t._e(),t._v(" "),t.useRichEditor?t._e():i("venom-textarea",{ref:"commentEditorTextareaDOM",staticClass:"comment-editor-textarea",attrs:{placeholder:"分享你的想法...",rows:5,autoszie:!0},model:{value:t.extraContent,callback:function(e){t.extraContent=e},expression:"extraContent"}}),t._v(" "),i("div",{staticClass:"comment-editor-operation"},[i("div",{staticClass:"right-operation"},[i("div",{staticClass:"comment-btn",on:{click:t.handleCommentConfirm}},[t._v("\n          评论\n        ")])]),t._v(" "),t.useRichEditor?t._e():i("div",{staticClass:"left-operation"},[i("div",{ref:"expressionBtnDOM",staticClass:"expression-btn",on:{click:t.openExpression}},[i("svg-icon",{staticClass:"comment-editor-icon",attrs:{name:"common/face",width:20,height:20,viewBox:"0 0 16 16"}}),t._v("\n          表情\n        ")],1),t._v(" "),i("div",{staticClass:"upload-image-btn",on:{click:t.openImageModal}},[i("svg-icon",{staticClass:"comment-editor-icon",attrs:{name:"common/picture",width:20,height:20,viewBox:"0 0 16 16"}}),t._v("\n          图片\n        ")],1),t._v(" "),i("div",{staticClass:"more-operation",on:{click:t.openRichEditor}},[i("svg-icon",{staticClass:"comment-editor-icon",attrs:{name:"common/expand",width:20,height:20,viewBox:"0 0 16 16"}}),t._v("\n          更多功能\n        ")],1)])])],2)])}),[],!1,null,"790ab820",null).exports,D=i(644),q={name:"Comment",components:{CommentItem:x,CommentEditor:S,Dropdown:b.a,CommentReferred:k},props:{hasAuth:{type:Boolean,required:!0,default:!1},targetId:{required:!0,default:void 0},entityInfo:{type:Object,required:!1,default:()=>{}},groupId:{required:!0,default:void 0},reprintGroupId:{required:!0,default:void 0},limit:{type:Number,required:!1,default:20},targetType:{type:String,required:!0,default:""},commentCount:{type:Number,required:!0,default:0},referredText:{type:String,required:!1,default:""}},setup(t,e){const i=Object(a.r)(!1),s=Object(a.r)("score"),n=Object(a.r)(1),o=Object(a.r)([]),r=Object(a.r)(!0),l=Object(a.r)(),c=Object(a.r)(!1),d=Object(a.a)(()=>{var t;return null===(t=_.find(t=>t.key===s.value))||void 0===t?void 0:t.label}),p=Object(a.a)(()=>t.commentCount),h=Object(a.r)(),m=Object(a.r)(),v=Object(a.r)(),g=Object(a.r)(!1),f=Object(a.r)(!1),b=Object(a.r)(!1),y=Object(a.r)(!0),w=Object(a.r)(!0),C=Object(a.a)(()=>t.hasAuth);Object(a.u)(()=>t.targetId,()=>{o.value=[],n.value=1,k(!0)}),Object(a.m)(()=>{void 0!==window.TrilobiteEditor?b.value=!0:setTimeout(()=>{y.value=!1,w.value=!1,b.value=!0},4e3),Object(D.a)().then(t=>{const e=t&&t.commentMod;e&&(y.value=e.edit,w.value=e.preview),f.value=!0}).catch(()=>{console.log("switch_mod_open fetch error"),f.value=!0}),t.targetId&&k(!0)});const k=async e=>{i.value=!0;try{const l=await(a={target_id:+t.targetId,target_type:t.targetType,page:n.value,limit:t.limit,order_by:s.value},u.a.post("/km_bff/feedback/v1/show_comment",a));0===l.data.code?(o.value=e?[...l.data.data.comments]:[...o.value,...l.data.data.comments],n.value=l.data.data.current_page,r.value=l.data.data.is_end):r.value=!0,i.value=!1}catch{i.value=!1}var a},O=Object(a.r)([{value:"score",text:"智能排序",actived:!0},{value:"asc",text:"时间升序"},{value:"desc",text:"时间降序"}]);Object(a.u)(()=>s.value,t=>{O.value.forEach(e=>{e.value===t?e.actived=!0:e.actived=!1})});return{toggleReplies:t=>{const e=o.value.map(e=>(e.id===t&&(e.isExpanded=!e.isExpanded),e));o.value=[...e]},total:p,hasCurrentAuth:C,page:n,isEnd:r,sortLabel:_,isLoading:i,currentSort:s,commentInfo:o,commentSortOperateDOM:l,commentSortActived:c,currentSortLabel:d,commentContainerDOM:h,commentBottomDOM:m,expressionDOM:v,showExpression:g,dropdownItemList:O,trilobiteEditOpen:y,trilobitePreviewOpen:w,hasFetchRainbow:f,iWikiLoaded:b,chooseSortItem:t=>{s.value=t,c.value=!1,n.value=1,k(!0)},afterDeleteCommentItem:(t,i)=>{if(null===i){var a;const e=Array.prototype.filter.call(document.querySelectorAll(".comment-item"),e=>e.dataset.id===t.id)[0];e&&requestAnimationFrame(()=>{e.classList.add("hidden-comment-item")});const i=null===(a=o.value)||void 0===a?void 0:a.filter(e=>e.id!==t.id);o.value=[...i]}else{var s;const e=Array.prototype.filter.call(document.querySelectorAll(".comment-reply-item"),t=>t.dataset.id===i.id)[0];e&&requestAnimationFrame(()=>{e.classList.add("hidden-comment-item")});const a=null===(s=o.value)||void 0===s?void 0:s.map(e=>{if(e.id===t.id){const t=e.replies.filter(t=>t.id!==i.id);e.replies=[...t]}return e});o.value=[...a]}e.emit("afterDeleteComment")},addCommentToCommentInfo:(t,i)=>{if("level1"===t)o.value=[i,...o.value];else if("level2"===t){var a;null===(a=o.value)||void 0===a||a.forEach(t=>{t.id===i.parentId&&t.replies.unshift(i)}),o.value=[...o.value]}else{var s;null===(s=o.value)||void 0===s||s.forEach(t=>{if(t.id===i.parentId){const e=t.replies.findIndex(t=>t.id===i.replyId);-1!==e&&t.replies.splice(e+1,0,i)}})}e.emit("afterAddComment")},openExpressionModal:t=>{g.value?g.value=!1:(v.value.$el.style.top=t.top+"px",v.value.$el.style.left=t.left+"px",g.value=!0)},loadmoreComment:()=>{i.value||(n.value=n.value+1,k())}}}},E=Object(C.a)(q,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"commentContainerDOM",staticClass:"comment-container"},[i("div",{staticClass:"comment-header"},[i("span",{staticClass:"comment-count"},[t._v("评论 "+t._s(t.total))]),t._v(" "),i("dropdown",{attrs:{"dropdown-width":90,"item-list":t.dropdownItemList},on:{clickItem:function(e){var i=e.item;return t.chooseSortItem(i.value)}}},[i("span",[t._v("\n        "+t._s(t.currentSortLabel)+"\n        "),i("svg-icon",{attrs:{color:t.commentSortActived?"#008DFC":"#666666",name:"kbar/load_btn",width:16,height:16,viewBox:"0 0 16 16"}})],1)])],1),t._v(" "),i("comment-referred",{staticClass:"comment-referred-container",attrs:{type:"edit","referred-text":t.referredText}}),t._v(" "),t.hasFetchRainbow&&t.iWikiLoaded?i("comment-editor",{attrs:{"trilobite-edit-open":t.trilobiteEditOpen,"trilobite-preview-open":t.trilobitePreviewOpen,"referred-text":t.referredText,"entity-id":t.targetId,"group-id":t.groupId,"reprint-group-id":t.reprintGroupId,"entity-type":t.targetType},on:{afterComment:function(e){return t.addCommentToCommentInfo("level1",e)}}}):t._e(),t._v(" "),t.hasFetchRainbow&&t.iWikiLoaded?t._l(t.commentInfo,(function(e){return i("div",{key:e.id,staticClass:"comment-item",attrs:{"data-id":e.id}},[i("comment-item",{key:e.id,attrs:{"trilobite-edit-open":t.trilobiteEditOpen,"trilobite-preview-open":t.trilobitePreviewOpen,info:e,"entity-id":t.targetId,"entity-type":t.targetType,"entity-info":t.entityInfo,"group-id":t.groupId,"reprint-group-id":t.reprintGroupId,"has-auth":t.hasCurrentAuth,"is-level1":!0,"parent-id":e.id},on:{afterDelete:function(i){return t.afterDeleteCommentItem(e,null)},afterReply:function(e){return t.addCommentToCommentInfo("level2",e)},openExpressionModal:t.openExpressionModal}}),t._v(" "),e.replies&&e.replies.length>0?i("div",{staticClass:"comment-reply-list"},[t._l(e.isExpanded?e.replies:e.replies.slice(0,2),(function(a,s){return i("comment-item",{key:a.id,class:["comment-reply-item",e.replies.length-1===s&&e.replies.length<3&&"last-ele-without-margin"],attrs:{"trilobite-edit-open":t.trilobiteEditOpen,"trilobite-preview-open":t.trilobitePreviewOpen,"data-id":a.id,info:a,"entity-id":t.targetId,"entity-type":t.targetType,"entity-info":t.entityInfo,"group-id":t.groupId,"reprint-group-id":t.reprintGroupId,"has-auth":t.hasCurrentAuth,"is-level1":!1,"parent-id":e.id},on:{afterReply:function(e){return t.addCommentToCommentInfo("level3",e)},afterDelete:function(i){return t.afterDeleteCommentItem(e,a)},openExpressionModal:t.openExpressionModal}})})),t._v(" "),e.replies.length>2?i("div",{staticClass:"expand-operation-container",on:{click:function(i){return t.toggleReplies(e.id)}}},[e.isExpanded?i("span",{staticClass:"collapse-button"},[t._v("收起")]):i("span",{staticClass:"expand-button"},[t._v("展开"+t._s(e.replies.length)+"条回复")])]):t._e()],2):t._e()],1)})):t._e(),t._v(" "),i("div",{ref:"commentBottomDOM",staticClass:"comment-bottom"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading&&!t.isEnd,expression:"!isLoading && !isEnd"}],staticClass:"comment-loading-bottom",on:{click:t.loadmoreComment}},[i("span",{staticClass:"bottom-text"},[t._v("点击加载更多")]),t._v(" "),i("svg-icon",{attrs:{name:"kbar/load_btn",width:16,height:16,viewBox:"0 0 16 16"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"comment-wait-bottom"},[t._v("\n      评论加载中...\n    ")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isEnd,expression:"isEnd"}],staticClass:"comment-end-bottom"},[t._v("\n      已到底部\n    ")])])],2)}),[],!1,null,"37b217c4",null);e.a=E.exports},2064:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1987),n=i(1973),o=i(1974),r=i(1980),l=(i(1919),i(1920),Object(a.c)({name:"banner-mod",props:{itemObj:{type:Object,default:()=>({})}},data:()=>({fixedList:[],swiper:null,ranId:0,curIndex:1,isLoading:!0,showDialog:!1,canShowHover:!0,swiperOption:{slidesPerView:"auto",autoplay:5e3,loop:!0,centeredSlides:!0,spaceBetween:16,initialSlide:0}}),setup:()=>({}),computed:{list(){return this.$store.getters["question/getJournalList"]||[]}},mounted(){this.initList()},methods:{initList(){this.ranId=Math.floor(1e4*Math.random());const t=JSON.parse(this.itemObj.content||"[]");this.fixedList=t;const e=this;setTimeout(()=>{let t={};this.fixedList.length>1?(s.a.use([n.a,o.a,r.a]),t={loop:!0,autoplay:{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}):s.a.use([r.a]),e.swiper=new s.a("#swiper-id-"+this.ranId,t)},1e3)},updateIndex(){const t=this.swiper.activeIndex;this.curIndex=t},slideActiveItem(t){this.canShowHover=!1,this.swiper.slideTo(t),setTimeout(()=>{this.canShowHover=!0},400)},handleClickImg(t){this.$emit("onAfterClick",t)}},watch:{itemObj(){this.initList()}},filters:{}})),c=i(68),d=Object(c.a)(l,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"banner-mod-container commom-kbar-mod-item"},[i("div",{staticClass:"kbar-banner"},[i("div",{staticClass:"swiper-container",attrs:{id:"swiper-id-"+t.ranId}},[i("div",{staticClass:"swiper-wrapper"},t._l(t.fixedList,(function(e,a){return i("div",{key:a,staticClass:"swiper-slide"},[e.target_url?i("a",{staticClass:"slide-content",attrs:{href:e.target_url,target:"_blank"},on:{click:function(){return t.handleClickImg(e)}}},[i("img",{attrs:{src:e.img}})]):i("img",{staticClass:"slide-content",attrs:{src:e.img}})])})),0),t._v(" "),t.fixedList.length>1?[i("div",{staticClass:"swiper-pagination"}),t._v(" "),t._m(0),t._v(" "),t._m(1)]:t._e()],2)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"swiper-button-prev"},[e("div",{staticClass:"control left-control"},[e("img",{staticClass:"icon-ope",attrs:{src:"https://assets.km.tencent.com/ImageHosting/20230404/26ceeb3c6d33e33f2e847a1fd9b7f891.png"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"swiper-button-next"},[e("div",{staticClass:"control right-control"},[e("img",{staticClass:"icon-ope",attrs:{src:"https://assets.km.tencent.com/ImageHosting/20230404/13ad62c8f73e9946f4cba59173a65192.png"}})])])}],!1,null,"3568c696",null);e.a=d.exports},2065:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return s.Option}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=Object(a.c)({name:"basic-select",components:{ElSelect:s.Select},inheritAttrs:!1,props:{formType:{type:String,default:"default"}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this.$createElement;return(this._self._c||t)("el-select",this._g(this._b({class:"basic-select is-"+this.formType},"el-select",this.$attrs,!1),this.$listeners),[this._t("default")],2)}),[],!1,null,"037c866a",null).exports},2066:function(t,e,i){"use strict";var a=i(531),s=i.n(a),n=i(1914),o=i.n(n),r=i(1892),l=i.n(r),c=i(1893),d=i.n(c),u=i(1915),p=i.n(u),h=i(1894),m=i.n(h),v=i(1896),g=i.n(v),f=i(532),_=i.n(f),b=(i(11),i(12),i(13),i(14),i(15),i(1925)),y=i.n(b),w=i(2017),C=i(3),k=i(7),O=i(81),x=i.n(O);const j=t=>k.a.post("/operations/notice",x.a.stringify(t.param),{headers:{"x-km-api-version":"std","X-Csrf-Token":t.userToken}}),I=t=>k.a.post("/km_bff/message/v1/share",t);var T=i(2001),S=i(1320),D=i(2015),q=i(2083),E={name:"ShareModal",components:{venomModal:_.a,venomForm:g.a,venomFormItem:m.a,venomNewSelector:p.a,venomTextarea:d.a,venomInput:l.a,venomCheckboxGroup:o.a,venomCheckbox:s.a},props:{isNewShare:{type:Boolean,default:!1},isShowModal:{type:Boolean,default:!1},copyPrefixText:{type:String,default:""},shareData:{type:Object,default:()=>{}},targetId:{type:String,default:""},targetType:{type:String,default:"Post"},woaLinkUrl:{type:String,default:""},hasTencentUrl:{type:Boolean,default:!0},tencentLinkUrl:{type:String,default:""},isShowReason:{type:Boolean,default:!1}},setup(t,e){const i=Object(C.r)(""),a=Object(C.r)(t.isShowModal),s=Object(C.r)(!1),n=Object(C.r)(!1),o=Object(C.a)(()=>e.root.$store.getters["global/userToken"]),r=Object(C.r)({}),l=Object(C.r)({}),c=Object(C.a)(()=>{const i=e.root.$store.getters["knowledges/knwlAuth"];return"Knowledge"===t.targetType&&i.edit}),d=Object(C.q)({subject:"",subjectPrefix:"",subjectContent:"",reason:"",selectPeoples:[],selectValue:[],isSecret:!1,receiverSpecials:0}),u=Object(C.q)({selectPeoples:[{validator:(t,e,i)=>{e.length>0||d.selectValue.length>0?i():h.value?i(new Error("推送人员和同时发送选项,至少选择一个")):i(new Error("请选择推送人员"))}}]}),p=Object(C.r)([]),h=Object(C.r)(!1),m=Object(C.a)(()=>!s.value&&!n.value),v=Object(C.r)(!1),g=t=>{t.on("success",(function(){e.root.$toast("复制成功，现在你可以粘贴（ctrl+v）到其他地方。",{status:"success",positon:"center"})})),t.on("error",(function(){e.root.$toast("复制链接出错，请稍后再试或反馈KM热线",{status:"error",positon:"center"})}))},f=Object(C.a)(()=>`${t.copyPrefixText?t.copyPrefixText+"：":""}${t.woaLinkUrl}`),_=()=>{var t,e,i,a;null===(t=l.value)||void 0===t||t.clearInput(),null===(e=l.value)||void 0===e||null===(i=e.$refs)||void 0===i||null===(a=i.selectorSearch)||void 0===a||a.syncSpanContent()};Object(C.m)(()=>{const t=new y.a(".copy-button"),e=new y.a(".copy-link");g(t),g(e)}),Object(C.u)(t,e=>{if(e.woaLinkUrl&&Object(w.a)(t.woaLinkUrl,{height:140,width:140}).then(t=>i.value=t).catch(t=>console.error(t)),e.isShowModal){a.value=e.isShowModal;const t=new Date;v.value=16===t.getHours()||17===t.getHours()&&t.getMinutes()<=30}if(e.shareData){var s,n,o,r;const t=(null==e||null===(s=e.shareData)||void 0===s||null===(n=s.rtx)||void 0===n?void 0:n.subgroup)||[];p.value=[{id:"sendall",name:"本吧成员"},{id:"admin",name:"管理员"},...t],h.value=(null==e||null===(o=e.shareData)||void 0===o||null===(r=o.rtx)||void 0===r?void 0:r.is_show_subgroup)||!1}}),Object(C.u)(n,e=>{var i,a;e&&(d.subject=null===(i=t.shareData)||void 0===i||null===(a=i.rtx)||void 0===a?void 0:a.topic_info)}),Object(C.u)(s,e=>{var i,a,s,n,o,r;e&&(d.subject=null===(i=t.shareData)||void 0===i||null===(a=i.email)||void 0===a?void 0:a.topic_info,d.subjectPrefix=null===(s=t.shareData)||void 0===s||null===(n=s.rtx)||void 0===n?void 0:n.topic_info,d.subjectContent=`《${null===(o=t.shareData)||void 0===o||null===(r=o.email)||void 0===r?void 0:r.target_title}》`)});const{tags:b,peopleOptions:k,handleGetTags:O,handleSearch:x,onTagSuccess:E}=(()=>{const t=Object(C.r)([]),i=Object(S.a)(i=>{const a=Object(q.a)(i);if(a.length>1e3)return e.root.$toast("超出添加人数上限",{status:"error",positon:"center"}),void _();a.length>1?(e=>{t.value=[];Object(T.c)(e,{searchType:"usersandadgroupslimit"}).then(({data:e})=>{(e||[]).forEach(e=>{const i=e[0],a={label:e[1],value:i};var s;d.selectPeoples.includes(i)||(null===(s=l.value)||void 0===s||s.addMultipleOption(a));t.value.push(a)}),_()})})(a):(e=>{Object(T.d)(e,{type:"usersandadgroupslimit",q:e,frequent:"",limit:20}).then(({data:e})=>{const i=e.map(t=>{const e=t[0];return{label:t[1],value:e}});t.value=i})})(i)},200);return{peopleOptions:t,handleSearch:i,onTagSuccess:t=>{b.value=t}}})(),A=()=>{a.value=!1,n.value=!1,s.value=!1,d.subject="",d.subjectPrefix="",d.subjectContent="",d.reason="",d.selectPeoples=[],d.selectValue=[],d.isSecret=!1,d.receiverSpecials=0,k.value=[]};return{isShow:a,isShowSubgroup:h,isShareQYWX:n,isShareEmail:s,isHideForm:m,isBusyTime:v,showKnowledgeReceiver:c,form:d,mySelector:l,myForm:r,rules:u,copyContent:f,qrImgData:i,onClose:()=>{A(),e.emit("onClose")},onSubmit:()=>{r.value.validate(i=>{var a,r,l,c;if(!i)return;const u={target_id:t.targetId,target_type:t.targetType,mail_to:d.selectPeoples.join(";"),mail_title:d.subject,recommend_words:d.reason,rtx:n.value?"send_by_rtx":"",mail:s.value?"send_by_mail":"",users_categories:d.selectValue.join(","),bcc:d.isSecret?"bcc":"",group_id:(null===(a=t.shareData)||void 0===a||null===(r=a.rtx)||void 0===r?void 0:r.group_id)||-1,valid:n.value?null===(l=t.shareData)||void 0===l||null===(c=l.rtx)||void 0===c?void 0:c.valid:""},p={target_type:u.target_type,target_id:u.target_id,receiver:u.mail_to,title:s.value?d.subjectPrefix+d.subjectContent:u.mail_title,content:u.recommend_words,group_id:u.group_id,receiver_group_lists:u.users_categories,receiver_specials:d.receiverSpecials?1:0,media:n.value?2:1,option:{}};d.isSecret&&(p.option.is_bcc=!0);(t.isNewShare?I:j)(t.isNewShare?p:{param:u,userToken:o.value}).then(({data:t})=>{Object(D.a)(e.root)(t)}),A(),e.emit("onSubmit")})},tags:b,peopleOptions:k,handleGetTags:O,handleSearch:x,handleChange:()=>{r.value.validate(()=>{})},onTagSuccess:E,subGroups:p}}},A=i(68),M=Object(A.a)(E,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("img",{staticClass:"qr-code-img",staticStyle:{display:"none"},attrs:{src:t.qrImgData}}),t._v(" "),t.isShow?i("venom-modal",{staticClass:"share-modal",attrs:{width:540,"disabled-body-scroll":""},on:{close:t.onClose,submit:t.onSubmit}},[i("template",{slot:"title"},[i("div",{staticClass:"share-title"},[t._v("\n        "+t._s(t.isHideForm?"分享":t.isShareEmail?"分享到邮件":"分享到企业微信")+"\n      ")])]),t._v(" "),i("template",{slot:"body"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isHideForm,expression:"isHideForm"}],staticClass:"share-body"},[i("div",{staticClass:"qr-code-container"},[i("div",{staticClass:"wx-share-img"},[i("img",{staticClass:"qr-code-img",attrs:{src:t.qrImgData}}),t._v(" "),i("a",{staticClass:"download-qr-code",attrs:{download:"qr-code.png",href:t.qrImgData}},[t._v("下载二维码")])]),t._v(" "),i("div",{staticClass:"wx-share-right"},[i("div",{staticClass:"wx-share-text"},[t._v("\n              手机扫一扫，分享给同事\n            ")]),t._v(" "),i("div",{staticClass:"wx-share-subtext"},[t._v("\n              KM现已全部支持woa域名，链接可在全平台访问\n            ")])])]),t._v(" "),i("div",{staticClass:"share-container"},[i("div",{staticClass:"share-title"},[i("span",{staticClass:"share-to-text"},[t._v("分享至")])]),t._v(" "),i("div",{staticClass:"share-type-list"},[i("div",{staticClass:"share-type-item share-to-email"},[i("div",{staticClass:"icon-wrapper",on:{click:function(){t.isShareEmail=!0,t.isShareQYWX=!1}}},[i("div",{staticClass:"icon-img icon-email"})]),t._v(" "),i("div",{staticClass:"icon-text"},[t._v("\n                邮件\n              ")])]),t._v(" "),i("div",{staticClass:"share-type-item share-to-qywx"},[i("div",{staticClass:"icon-wrapper",on:{click:function(){t.isShareQYWX=!0,t.isShareEmail=!1}}},[i("div",{staticClass:"icon-img icon-qywx"})]),t._v(" "),i("div",{staticClass:"icon-text"},[t._v("\n                企业微信\n              ")])]),t._v(" "),i("div",{staticClass:"share-type-item share-to-link"},[i("div",{staticClass:"icon-wrapper copy-link",attrs:{"data-clipboard-text":t.copyContent}},[i("div",{staticClass:"icon-img icon-link"})]),t._v(" "),i("div",{staticClass:"icon-text"},[t._v("\n                复制链接\n              ")])])])])]),t._v(" "),i("venom-form",{directives:[{name:"show",rawName:"v-show",value:!t.isHideForm,expression:"!isHideForm"}],ref:"myForm",staticClass:"share-submit-form",attrs:{model:t.form,rules:t.rules}},[i("venom-form-item",{staticClass:"sendTo",attrs:{label:"发送给",prop:"selectPeoples","label-col":{span:2},"is-required":""}},[i("venom-new-selector",{ref:"mySelector",attrs:{placeholder:"输入姓名或邮件组(邮件组不能超过1000人)",mode:"multiple",width:290,filter:!1,"option-array":t.peopleOptions},on:{input:t.handleChange,search:t.handleSearch},model:{value:t.form.selectPeoples,callback:function(e){t.$set(t.form,"selectPeoples",e)},expression:"form.selectPeoples"}},t._l(t.peopleOptions,(function(t){return i("venom-options",{key:t.value,attrs:{label:t.label,value:t.id}})})),1)],1),t._v(" "),t.showKnowledgeReceiver||t.isShowSubgroup?i("div",{staticClass:"send-condition"},[i("div",{staticClass:"condition-label"},[t._v("\n            同时发送：\n          ")]),t._v(" "),i("div",{staticClass:"group-select-wrapper"},[t.showKnowledgeReceiver?i("venom-checkbox",{key:"receiverSpecials",attrs:{label:"receiverSpecials"},model:{value:t.form.receiverSpecials,callback:function(e){t.$set(t.form,"receiverSpecials",e)},expression:"form.receiverSpecials"}},[t._v("\n              收藏文集的同事\n            ")]):t._e(),t._v(" "),t.isShowSubgroup?i("venom-checkbox-group",{attrs:{"is-required":""},model:{value:t.form.selectValue,callback:function(e){t.$set(t.form,"selectValue",e)},expression:"form.selectValue"}},t._l(t.subGroups,(function(e){return i("venom-checkbox",{key:e.id,attrs:{label:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])})),1):t._e()],1)]):t._e(),t._v(" "),t.isShareEmail?i("div",{staticClass:"send-type"},[i("div",{staticClass:"secret-label"},[t._v("\n            发送方式\n          ")]),t._v(" "),i("div",{staticClass:"secret-checck"},[i("venom-checkbox",{model:{value:t.form.isSecret,callback:function(e){t.$set(t.form,"isSecret",e)},expression:"form.isSecret"}},[t._v("\n              密送\n            ")])],1)]):t._e(),t._v(" "),t.isNewShare&&t.isShareEmail?i("venom-form-item",{staticClass:"subject",attrs:{label:"主题","label-col":{span:2}}},[i("div",{staticClass:"subject-line"},[i("span",{staticClass:"subject-prefix"},[t._v(t._s(t.form.subjectPrefix))]),t._v(" "),i("venom-input",{attrs:{disabled:t.isShareQYWX},model:{value:t.form.subjectContent,callback:function(e){t.$set(t.form,"subjectContent",e)},expression:"form.subjectContent"}})],1)]):i("venom-form-item",{staticClass:"subject",attrs:{label:"主题","label-col":{span:2}}},[i("venom-input",{attrs:{disabled:t.isShareQYWX},model:{value:t.form.subject,callback:function(e){t.$set(t.form,"subject",e)},expression:"form.subject"}})],1),t._v(" "),i("venom-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.isShareEmail||t.isShowReason,expression:"!isShareEmail || isShowReason"}],staticClass:"share-reason",attrs:{label:"分享理由","label-col":{span:2}}},[i("venom-textarea",{attrs:{placeholder:"请输入分享理由"},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1),t._v(" "),t.isShareEmail&&t.isBusyTime||t.isNewShare&&t.isShareEmail?i("div",{staticClass:"tips"},[t._v("\n          温馨提示：\n          "+t._s(t.isNewShare?"分享邮件将由km@tencent.com发送，已屏蔽KM邮箱用户将无法收到分享。":"")+"\n          "+t._s(t.isBusyTime?"下午16:00-17:30为公司邮件系统繁忙时段，推送可能会有延迟，请耐心等待。":"")+"\n        ")]):t._e()],1)],1),t._v(" "),i("template",{slot:"footer"},[t.isHideForm?i("div"):t._e()])],2):t._e()],1)}),[],!1,null,"3e0dfc42",null);e.a=M.exports},2067:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(2050),s={name:"article-toc",components:{},props:{options:{type:Object,default:()=>({})},canExpand:{type:Boolean,default:!1},isInit:{type:Boolean,default:!1},isShow:{type:Boolean,default:!1},tocList:{type:Array,default:()=>[]}},data:()=>({activeId:"",isExpand:!0,styleObject:{display:"block"}}),watch:{isInit(t,e){t&&!e&&this.initEvent()}},mounted(){},beforeDestroy(){const{eventBindDom:t}=this.treeOptions,{contentScrollEle:e}=t;e.removeEventListener("scroll",this.handleScroll)},methods:{initEvent(){const t=a.a.getOptions(this.options,this.$el);this.treeOptions=t,this.watchContentScrollChange(t)},setAnchorPointScroll(t){this.isAnchorPointScroll=t},getAnchorPointScroll(){return this.isAnchorPointScroll},activeTocIndexItem(t){this.activeId=t&&t.getAttribute("data-id")},handleTocRemarkAndScroll(t){const{dom:e}=t,{tocEle:i}=e,{attrConfig:s}=t,n=e.contentEle.querySelectorAll("h1,h2,h3,h4,h5,h6");let o=null,r="";for(let e=0;e<n.length;e++){const i=n[e];if(!a.a.checkScrollTouch(i,t))break;r=i.getAttribute(s.htmlTagKey)}if(r&&this.activeId!==r&&(o=i.querySelector(`div[data-id="${r}"]`),o&&this.activeTocIndexItem(o),o&&a.a.scrollTocFocus(o,i,".label-list")),!r){this.activeId="";i.querySelector(".label-list").scrollTop=0}},handleTocIndexClick(t){const{dom:e,position:i,eventBindDom:s,attrConfig:n}=this.treeOptions,{contentEle:o}=e,r=t.currentTarget,l=r.getAttribute("data-id"),c=a.a.getHtmlElementByTocId(l,o,n);this.setAnchorPointScroll(!0),this.activeTocIndexItem(r),c&&a.a.scrollIntoTagWithOffset(c,s,i,n)},handleTooltipClick(t){t&&t.fireEvent({visible:!1})},watchContentScrollChange(t){const{eventBindDom:e}=t,{contentScrollEle:i}=e,s=()=>{!this.getAnchorPointScroll()&&this.handleTocRemarkAndScroll(t)};let n;const o=()=>{clearTimeout(n),n=setTimeout(()=>{this.setAnchorPointScroll(!1)},200)};this.handleScroll=a.a.throttleWrapper(()=>{s(),o()},50),i.addEventListener("scroll",this.handleScroll)},handleCollapse(){this.isExpand=!1,this.styleObject.display="none",this.$emit("collapseToc")},handleExpand(){this.isExpand=!0,this.styleObject.display="block",this.$emit("expandToc")}}},n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"toc-tree"},[i("div",{staticClass:"toc-wrapper",style:t.styleObject},[0!==t.tocList.length?i("div",{staticClass:"toc-title"},[i("div",{staticClass:"title-text"},[t._v("大纲")]),t._v(" "),t.canExpand?i("div",{staticClass:"toggle-toc",on:{click:t.handleCollapse}},[i("svg-icon",{staticClass:"item-icon",attrs:{width:20,height:20,name:"article/toc-collapse"}})],1):t._e()]):t._e(),t._v(" "),0!==t.tocList.length?i("div",{staticClass:"split-line"}):t._e(),t._v(" "),i("div",{staticClass:"label-list"},[t._l(t.tocList,(function(e){return i("div",{key:e.id,class:"toc_dis_level"+e.levelDis+"  "+("H1"===e.tagName?"big-tag":"common-tag")+" "+(e.id===t.activeId?"active-toc-index":"")+" toc-index",attrs:{"data-id":e.id,tagname:e.tagName},on:{click:t.handleTocIndexClick}},[i("span",{staticClass:"tag-text",attrs:{slot:"trigger",title:e.name},slot:"trigger"},[t._v(t._s(e.name))])])})),t._v(" "),0===t.tocList.length?i("div",{staticClass:"empty-content"},[i("p",[t._v("请在文章中应用“标题”样式")]),t._v(" "),i("p",[t._v("即可生成“目录”")])]):t._e()],2)]),t._v(" "),t.isExpand?t._e():i("div",{staticClass:"expland-button",on:{click:t.handleExpand}},[i("p",[t._v("大")]),t._v(" "),i("p",[t._v("纲")])])])}),[],!1,null,"3f78e437",null);e.a=o.exports},2068:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(168),s={name:"GroupItem",components:{},props:{data:{type:Object,default:()=>{}},showDescription:{type:Boolean,default:!0},showJoinTip:{type:Boolean,default:!0},urlSuffix:{type:String,default:""}},data:()=>({isOperated:!1,isLongTitle:!1,joinLoading:!1}),watch:{data(){this.setIsLongTitle()}},mounted(){this.setIsLongTitle()},methods:{setIsLongTitle(){this.$nextTick(()=>{this.$refs.groupNameContent.offsetHeight>22&&(this.isLongTitle=!0)})},addSuffixToUrl:a.c}},n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{class:["page-container-item",t.showDescription?"":"mini-content"],attrs:{target:"_blank",href:t.addSuffixToUrl(t.data.url,t.urlSuffix)}},[i("img",{staticClass:"group-img",attrs:{src:t.data.logo}}),t._v(" "),i("div",{staticClass:"group-info-content"},[i("div",{staticClass:"group-name-content"},[t._v("\n      "+t._s(t.data.name)+"\n      "),i("svg-icon",{staticClass:"level-icon",attrs:{name:"group/level-"+t.data.level,width:30,height:13}}),t._v(" "),"1"===t.data.is_secret?i("svg-icon",{attrs:{name:"knowledges/secret-tag",width:20,height:20}}):t._e()],1),t._v(" "),i("div",{ref:"groupNameContent",staticClass:"group-name-content hide"},[t._v("\n      "+t._s(t.data.name)+"\n      "),i("svg-icon",{staticClass:"level-icon",attrs:{name:"group/level-"+t.data.level,width:30,height:13}}),t._v(" "),"1"===t.data.is_secret?i("svg-icon",{attrs:{name:"group/secret",width:14,height:14}}):t._e()],1),t._v(" "),i("div",{staticClass:"group-member-content"},[i("span",[t._v("成员 ("+t._s(t.data.member_count)+")")]),t._v(" "),i("span",{staticClass:"divide"},[t._v("|")]),t._v(" "),i("span",[t._v("文章 ("+t._s(t.data.article_count)+")")])]),t._v(" "),t.showDescription?i("div",{class:["group-introduction",t.isLongTitle?"mini-introduction":""]},[t._v("\n      "+t._s(t.data.description||"这个K吧很神秘～")+"\n    ")]):t._e()]),t._v(" "),"1"===t.data.is_join&&t.showJoinTip?i("div",{staticClass:"join-tip"},[t._v("\n    已加入\n  ")]):t._e()])}),[],!1,null,"a1d240e6",null);e.a=o.exports},2069:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2026),n=i(2029),o=i(2048),r=i(1926),l=i.n(r);window.zhihuiEditor=l.a;var c=Object(a.c)({name:"KnowledgesImage",components:{Upload:s.a},props:{value:{type:String,default:""},imgPosition:{type:String,default:"bottom"},imgSize:{type:Number,default:96},uploadSizeText:{type:String,default:"请上传200*200的图片"},imgWidth:{type:Number,default:96},imgHeight:{type:Number,default:96},blockId:{type:Number,required:!0}},setup(t,e){const i=Object(a.r)(!1),s=Object(a.a)(()=>e.root.$store.getters["global/zhihuiToken"]);return{handleUpload:async i=>{const{file:a}=i;Object(n.a)(a)?(window.temporaryFile=a,Object(o.a)({block:t.blockId,filename:a.name,cb:({url:t})=>e.emit("onFinished",{url:t}),onErr:()=>{e.root.$toast("上传图片失败，请重新上传",{status:"error",positon:"center"})}})):e.root.$toast("图片格式有误，请选择png/jpg/jpeg格式的图片",{status:"warning",positon:"center"})},handleDeleteImg:()=>{e.emit("onDelete")},handleOpenZhihuiEditor:()=>{if(i.value)window.zhihuiEditor.openIframe();else if(""===s.value)e.root.$toast("token尚未获取，请稍等再试",{status:"error",positon:"center"}),e.root.$store.dispatch("global/getZhiHuiToken");else{const a={appid:"KMIframe",env:"formal",channel:"KMIframe",from:"template",scope:"all",stamp:"zhihui",timestamp:(new Date).valueOf(),templateId:"644258eaa8603769458d3c48",token:s.value,headConfig:{downloadName:"完成",isDownloadImg:!1,onClickDownload:i=>{i.url?Object(o.b)({block:t.blockId,url:i.url,cb:t=>e.emit("onFinished",{url:t}),onErr:()=>{e.root.$toast("智能生成图片失败，请重试",{status:"error",positon:"center"})}}):e.root.$toast("智能生成图片失败，请重试",{status:"error",positon:"center"}),window.zhihuiEditor.closeIframe()}}};console.log("option",a),i.value=!0,window.zhihuiEditor=new l.a(a),window.zhihuiEditor.openIframe()}}}}}),d=i(68),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["container",{right:"right"===t.imgPosition}]},[i("div",{staticClass:"upload-wapper"},[i("div",{staticClass:"upload-btn-container"},[i("Upload",{attrs:{multiple:!1,"http-request":t.handleUpload,accept:".jpg,.png"}},[i("span",{staticClass:"upload"},[t._v(t._s(t.value?"重新上传":"上传"))])]),t._v(" "),i("div",{staticClass:"zhihui-btn",on:{click:t.handleOpenZhihuiEditor}},[t._v("\n        智能生成\n      ")])],1),t._v(" "),i("p",{staticClass:"upload-text"},[i("span",{staticClass:"upload-text-left"},[t._v(" "+t._s(t.uploadSizeText)+"，“智能生成”由腾讯云智绘提供支持， 你也可以前往")]),t._v(" "),i("a",{attrs:{target:"_blank",href:"https://zhihui.woa.com/platform"}},[t._v("腾讯云智绘")]),t._v(" "),i("span",{staticClass:"upload-text-right"},[t._v("制作个性化配图")])])]),t._v(" "),i("span",{class:["image",{right:"right"===t.imgPosition}]},[t.value?i("div",{staticClass:"preview-image",style:{width:(t.imgWidth||t.imgSize)+"px",height:(t.imgHeight||t.imgSize)+"px"}},[i("img",{attrs:{src:t.value,alt:""}}),t._v(" "),i("span",{staticClass:"delete-button",on:{click:t.handleDeleteImg}},[i("svg-icon",{attrs:{name:"knowledges/delete-banner",width:20,height:20}})],1)]):i("svg-icon",{attrs:{name:"knowledges/cover-upload",width:t.imgSize,height:t.imgSize}})],1)])}),[],!1,null,"1821d988",null);e.a=u.exports},2070:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"card",props:{size:{type:String,default:"default",required:!1},header:{type:String,required:!1},border:{type:Boolean,default:!1,required:!1}}}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:"card card-"+t.size,style:{border:t.border?"1px solid #E6E6E6":""}},[t.header?i("div",{staticClass:"header"},[t._v(t._s(t.header))]):t._e(),t._v(" "),t._t("default")],2)}),[],!1,null,"14b96ea2",null);e.a=o.exports},2071:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2058),n=Object(a.c)({name:"SurveysListItem",components:{},props:{info:{type:Object,default:()=>{}},type:{type:String,default:"public"},showAttendTag:{type:Boolean,default:!0}},setup(t){const{getTimeText:e}=Object(s.a)();return{formatTime:Object(a.a)(()=>t.info.end_time?e({time:t.info.end_time})+" 截止":"无截止时间"),showUserCount:t=>{if("number"!=typeof+t||isNaN(t)||t<0)return 0;if(t<1e3)return t;let e=Math.floor(t/100)/10;return e%1==0&&(e=e.toFixed(0)),e+"K"}}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"survey-list-item-container"},[i("div",{staticClass:"survey-list-item-left"},[i("div",{staticClass:"title-info"},[i("t-popup",{attrs:{content:t.info.title,"overlay-style":{maxWidth:"350px"}}},[i("a",{class:["title-text",t.info.is_ended&&"title-text-attended"],attrs:{href:"/surveys/show/"+t.info.id,target:"_blank"}},[t._v(t._s(t.info.title))])]),t._v(" "),t.info.is_attended&&t.showAttendTag?i("span",{staticClass:"title-tag attend-tag"},[t._v("已参加")]):t._e(),t._v(" "),t.info.is_ended?i("span",{staticClass:"title-tag end-tag"},[t._v("已过期")]):t._e(),t._v(" "),t.info.is_public?t._e():i("svg-icon",{staticClass:"lock-icon",attrs:{name:"article/lock",width:20,height:20,viewBox:"0 0 20 20"}})],1),t._v(" "),i("div",{staticClass:"time-info"},[i("svg-icon",{staticClass:"time-icon",attrs:{name:"events/time",width:16,height:16,viewBox:"0 0 16 16"}}),t._v("\n      "+t._s(t.formatTime)+"\n    ")],1),t._v(" "),i("div",{staticClass:"user-info"},[i("a",{staticClass:"creator-info",attrs:{target:"_blank",href:"/user/"+t.info.creator}},[i("svg-icon",{attrs:{name:"surveys/user-icon",width:16,height:16,viewBox:"0 0 16 16"}}),t._v("\n        "+t._s(t.info.creator)+"\n      ")],1),t._v(" "),t.info.group_name&&t.info.group_id?i("a",{staticClass:"group-info",attrs:{target:"_blank",href:"/group/"+t.info.group_id}},[i("svg-icon",{attrs:{name:"surveys/kbar-icon",width:16,height:16,viewBox:"0 0 16 16"}}),t._v("\n        "+t._s(t.info.group_name)+"\n      ")],1):t._e()])]),t._v(" "),i("div",{class:["survey-list-item-right",t.info.user_count>=100&&"survey-list-item-right-hot"]},[i("p",{staticClass:"user-count"},[t._v("\n      "+t._s(t.showUserCount(t.info.user_count))+"\n    ")]),t._v(" "),i("p",{staticClass:"user-count-text"},[t._v("\n      人投票\n    ")])])])}),[],!1,null,"09b17236",null);e.a=r.exports},2072:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=Object(a.c)({name:"AutoHeightModal",components:{elDialog:s.Dialog},props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},top:{type:String,default:"0px"},width:{type:String,default:"580px"},modalAppendTobody:{type:Boolean,default:!0},appendTobody:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!1},beforeClose:{type:Function,default:t=>{t()}},maxBodyHeight:{type:Number,default:572},noCaculate:{type:Boolean,default:!1},heightPercent:{type:Number,default:.5}},setup(t){const e=Object(a.r)({}),{maxBodyHeight:i,noCaculate:s,heightPercent:n}=t;return Object(a.m)(()=>{const t=window.innerHeight*n;if(!s){const a=t>i?i:t;e.value={"max-height":a+"px"}}}),{contentHeightStyle:e}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{ref:"autoDialog",staticClass:"auto-height-modal",attrs:{title:t.title,visible:t.visible,top:t.top,width:t.width,"modal-append-to-body":t.modalAppendTobody,"append-to-body":t.appendTobody,"show-close":t.showClose,"before-close":t.beforeClose,"close-on-click-modal":t.closeOnClickModal,"lock-scroll":t.lockScroll}},[t._t("title",null,{slot:"title"}),t._v(" "),i("div",{staticClass:"body-wrapper",style:t.contentHeightStyle},[t._t("default")],2),t._v(" "),t._t("footer",null,{slot:"footer"})],2)}),[],!1,null,"58cb3920",null);e.a=r.exports},2073:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({name:"SmallOperationBar",props:{size:{type:String,default:"small"},optionList:{type:Array,default:()=>[{key:"view",value:10,iconName:"operation/view",viewBox:"0 0 16 16",noHover:!0,hoverFill:"",iconWidth:16,icionHeight:16,onClick:()=>{}}],required:!0}},setup:t=>({operationList:Object(a.a)(()=>t.optionList),onClick:t=>{t&&t()}})}),n=i(68),o=Object(n.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operation-list"},[t._l(t.operationList,(function(e){return i("div",{key:e.key,staticClass:"operation-item",class:(e.noHover?"":"item-hover")+" operation-item-"+t.size,on:{click:function(){return t.onClick(e.onClick)}}},[i("svg-icon",{staticClass:"item-icon",attrs:{name:e.iconName,width:e.iconWidth||16,height:e.height||16,"hover-fill":e.hoverFill,viewBox:e.viewBox||"0 0 16 16"}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.hiddenValue,expression:"!item.hiddenValue"}],staticClass:"item-value"},[t._v(t._s(e.value))])],1)})),t._v(" "),t._t("default")],2)}),[],!1,null,"a4ddf378",null);e.a=o.exports},2074:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(57),n=Object(a.c)({name:"RelationEntryMod",components:{},filters:{qTitleUrl:t=>"question"===t.target_type?`/q/view/${t.target_id}?kmref=entry_card`:"article"===t.target_type?`/articles/show/${t.target_id}?kmref=entry_card`:["video","iwiki","techmap","knowledge","mk"].includes(t.target_type)?t.target_url.indexOf("?")>0?t.target_url+"&kmref=entry_card":t.target_url+"?kmref=entry_card":""},props:{qIdProp:{type:[String,Number],default:""},targetType:{type:String,default:"question"}},setup:()=>({}),data:()=>({hasInit:!1,relationQListRight:[],entryMapContentList:{},currentRecList:[],lockChange:!1,currentEntry:null,currentEntryIndex:0,listTypeMap:{question:"乐问",knowledge:"文集",article:"文章",mk:"码客",iwiki:"iwiki",video:"视频",techmap:"技术图谱"},tagsArr:[{key:"article_count",name:"文章",path:"related-articles"},{key:"question_count",name:"乐问",path:"related-questions"},{key:"knowledge_count",name:"文集",path:"related-knowledges"},{key:"active_user_count",name:"用户",path:"active-users"}]}),computed:{kstrs(){return this.$store.getters["q/getKstrs"]||""},recommendTagsRight(){return this.$store.getters["q/getRecommendTagsRight"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}}},watch:{recommendTagsRight(t){null!==t&&(t.length>0?this.initNewList([]):this.initOldList(t))}},mounted(){},methods:{getBasicField(){const t=this.recommendTagsRight[this.currentEntryIndex].name;return{shown_place:this.targetType,keywords:this.qIdProp,matched_entrie_names:t}},reportShow(){Object(s.b)("entryCardShow",this.getBasicField())},reportClick(t,e,i,a,n){const o=this.getBasicField();o.clicked_entry_name=t||"",o.clicked_entry_id=e||"",o.clicked_entry_block=i||"","list_item"===i&&(o.clicked_list_item_type=n,o.clicked_list_item_url=a),Object(s.b)("entryCardClick",o)},reportMiddleClick(t,e,i,a,n,o){if(1===t.button){const r=this.getBasicField();r.clicked_entry_name=e||"",r.clicked_entry_id=i||"",r.clicked_entry_block=a||"","list_item"===a&&(r.clicked_list_item_type=o,r.clicked_list_item_url=n),console.log("e",t.button),Object(s.b)("entryCardMiddleClick",r)}},changeEntryWrap(){this.reportClick(this.recommendTagsRight[this.currentEntryIndex].name,this.recommendTagsRight[this.currentEntryIndex].target_id,"refresh"),this.changeEntry()},changeEntryWrapWithMiddle(t){this.reportMiddleClick(t,this.recommendTagsRight[this.currentEntryIndex].name,this.recommendTagsRight[this.currentEntryIndex].target_id,"refresh")},changeEntry(t){if(this.lockChange)return;if(this.lockChange=!0,void 0!==t)this.currentEntryIndex=t;else{const t=this.recommendTagsRight.length;this.currentEntryIndex<t-1?this.currentEntryIndex+=1:this.currentEntryIndex=0}this.currentRecList=[];const e=this.recommendTagsRight[this.currentEntryIndex].target_id;this.$store.dispatch("q/fetchRightEntryPartData",{entryId:e,targetType:this.targetType,targetId:this.qIdProp}).then(({list:t})=>{this.lockChange=!1,this.entryMapContentList[e]=t.slice(0,5),this.currentRecList=this.entryMapContentList[e]}).catch(()=>{this.lockChange=!1}),this.$nextTick(()=>{this.reportShow()})},initNewList(t){if(this.hasInit)return;this.hasInit=!0;t[0]&&(this.currentEntryIndex=0),this.changeEntry(this.currentEntryIndex)},initOldList(t){this.hasInit||(this.hasInit=!0,0===t.length&&this.fetchQRightPartData())},fetchQRightPartData(){this.$store.dispatch("q/fetchQRightPartData",{id:this.qIdProp}).then(({relevant_q_list:t})=>{this.relationQListRight=t||[]}).catch(()=>{})}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return null!==t.recommendTagsRight&&(t.recommendTagsRight.length>0||t.relationQListRight.length>0)?i("div",{staticClass:"relation-entry-container q-right-common-item"},[i("div",{staticClass:"content-wrapper"},[t.recommendTagsRight.length>0&&t.recommendTagsRight[t.currentEntryIndex]?i("div",{staticClass:"new-entry-relation common-item"},[i("div",{staticClass:"title-area"},[i("span",{staticClass:"left-title"},[i("a",{staticClass:"big-title",attrs:{href:"/entry/"+t.recommendTagsRight[t.currentEntryIndex].target_id+"/home?kmref=entry_card",target:"_blank"},on:{mousedown:function(e){return t.reportMiddleClick(e,t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,"home")},click:function(e){return t.reportClick(t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,"home")}}},[t._v("\n            "+t._s(t.recommendTagsRight[t.currentEntryIndex].name)+"\n          ")]),t._v(" "),i("span",{staticClass:"small-title"},[t._v("相关阅读")])]),t._v(" "),i("span",{staticClass:"right-title",on:{click:t.changeEntryWrap,mousedown:t.changeEntryWrapWithMiddle}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_change",width:16,height:16}}),t._v(" "),i("span",{staticClass:"entry-change"},[t._v("换一换")])],1)]),t._v(" "),i("div",{staticClass:"type-area"},t._l(t.tagsArr,(function(e){return i("a",{key:e.key,staticClass:"type-item",attrs:{href:"/entry/"+t.recommendTagsRight[t.currentEntryIndex].target_id+"/"+e.path+"?kmref=entry_card",target:"_blank"},on:{mousedown:function(i){return t.reportMiddleClick(i,t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,e.path)},click:function(i){return t.reportClick(t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,e.path)}}},["article_count"===e.key?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_article",width:16,height:16}}):t._e(),t._v(" "),"question_count"===e.key?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_lewen",width:16,height:16}}):t._e(),t._v(" "),"knowledge_count"===e.key?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_knowledge",width:16,height:16}}):t._e(),t._v(" "),"active_user_count"===e.key?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_user",width:16,height:16}}):t._e(),t._v(" "),i("span",{staticClass:"type-name"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"type-count"},[t._v("("+t._s(t.recommendTagsRight[t.currentEntryIndex][e.key])+")")])],1)})),0),t._v(" "),t.currentRecList.length>0?i("div",{staticClass:"list-area"},[i("ul",t._l(t.currentRecList,(function(e,a){return i("li",{key:a,staticClass:"item"},[i("a",{staticClass:"item-title",attrs:{href:t._f("qTitleUrl")(e),target:"_blank"},on:{mousedown:function(i){return t.reportMiddleClick(i,t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,"list_item",e.target_url,e.target_type)},click:function(i){return t.reportClick(t.recommendTagsRight[t.currentEntryIndex].name,t.recommendTagsRight[t.currentEntryIndex].target_id,"list_item",e.target_url,e.target_type)}}},[t._v("\n              "+t._s(e.title)+"\n            ")]),t._v(" "),i("div",{staticClass:"item-info"},[i("span",[t._v(t._s(e.target_type_name||"")+" "+t._s(" "+e.read_count)+"阅读")]),t._v(" "),i("span",[t._v(t._s(e.show_time))])])])})),0)]):t._e()]):t.relationQListRight.length>0?i("div",{staticClass:"old-q-relation common-item"},[t._m(0),t._v(" "),i("div",{staticClass:"list-area"},[i("ul",t._l(t.relationQListRight,(function(e,a){return i("li",{key:a,staticClass:"item"},[i("a",{staticClass:"item-title",attrs:{href:"problem"===e.type?(e.href.indexOf("?")>0?e.href+"&":e.href+"?")+"kmref=relevant_q":"/q/view/"+e.id+"?kmref=relevant_q",target:"_blank"}},[t._v("\n              "+t._s(e.title)+"\n            ")]),t._v(" "),i("div",{staticClass:"item-info"},[i("span",[t._v(t._s(e.reply_count)+"个回答")]),t._v(" "),i("span",[t._v(t._s(e.show_time))])])])})),0)])]):t._e()])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-area"},[e("span",{staticClass:"left-title"},[this._v("相关问题")])])}],!1,null,"f9fa3d6c",null);e.a=r.exports},2077:function(t,e){t.exports="/vkm/img/order-number-1.509e67f6c8277c800458fc08adb7b4df.png"},2078:function(t,e){t.exports="/vkm/img/order-number-2.da397b46660542b0c59e184b871ca66b.png"},2079:function(t,e){t.exports="/vkm/img/order-number-3.ed9d5ac1b75f4cca5839fcb5d81fcb9e.png"},2080:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a=t=>{window.scrollTo(t)},s=({context:t,contentDomList:e,useCapture:i=!0,callback:a})=>{const s=i=>{const s=i.target,n=e.some(t=>{const e="function"==typeof t?t():t;return!(null==e||!e.contains(s))});t.root.$nextTick(()=>a(n))};document.addEventListener("click",s,i);return()=>document.removeEventListener("click",s,i)}},2082:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(11),i(12),i(13),i(14),i(15);const a=(t,e,i=3e4)=>new Promise((a,s)=>{let n=!1,o=!1;if(e){const t=document.getElementsByTagName("head")[0].querySelector(`script[name=${e}]`);n=!!t,o=null==t?void 0:t.getAttribute("sc-load")}if(n)o&&a("load");else{const n=setTimeout(()=>{clearTimeout(n),s("overtime")},i);((t,e)=>{const i=document.createElement("script");i.src=t,e&&i.setAttribute("name",e);return document.getElementsByTagName("head")[0].appendChild(i),i})(t,e).onload=function(t){var e;clearTimeout(n),null===(e=t.target)||void 0===e||e.setAttribute("sc-load","true"),a("load")}}})},2083:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));i(11),i(12),i(13),i(14),i(15);const a=t=>{const e=(t=>{const e=t.trim().replaceAll("\t"," ").replaceAll(",",";");return e.includes(";")?e.split(";"):e.split(" ")})(t);let i=[];const a={};return e.forEach(t=>{const{nickName:e,resultArray:s}=(t=>{let e=t;const i=t.indexOf("("),a=t.indexOf("(");i>-1&&a>-1&&(e=t.substring(0,i));const s=e.trim().split("@").shift()||"";return{nickName:s,resultArray:s?[s]:[]}})(t);a[e]||(i=[...i,...s],a[e]=!0)}),i}},2084:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a=[{path:"theme",name:"按主题分类"},{path:"team",name:"按部门分类"},{path:"mine",name:"我的K吧"}],s=[{name:"技术·运维",icon:"group/technology"},{name:"产品·市场",icon:"group/product"},{name:"设计·用研",icon:"group/design"},{name:"项目·质量",icon:"group/project"},{name:"企管·文化",icon:"group/manage",id:""},{name:"行政·福利",icon:"group/administrative"},{name:"其他",icon:"group/others"}]},2085:function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);const a=(t,e)=>{window.temporaryFile=null;const i=new Image;i.src=t,i.setAttribute("crossOrigin","Anonymous"),i.onload=function(){const a=function(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height),e}(i),s=t.substring(t.lastIndexOf(".")+1).toLowerCase();a.toBlob(t=>{window.temporaryFile=new File([t],`图片-${Date.now()}.${s}`,{type:"image/"+s,lastModified:Date.now()}),e()},"image/"+s,1)}},s=t=>t.substring(t.lastIndexOf(".")+1).split("&")[0].split("?")[0].toLowerCase(),n=(t,e)=>{window.temporaryFile=null,window.temporaryFile=new File([t],`image-${Date.now()}.${e}`,{type:"image/"+e,lastModified:Date.now()})}},2086:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a=/(http|https):\/\/([\w.]+\/?)\S*/,s=/^(http|https):\/\/(km.woa.com|km.tencent.com)($|\/)/},2087:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));i(11),i(12),i(13),i(14),i(15);const a=[{label:"讲座课程",value:"1"},{label:"团队建设",value:"2"},{label:"活动记录",value:"3"},{label:"技术分享",value:"4"},{label:"产品演示",value:"5"},{label:"文化宣传",value:"6"},{label:"案例分享",value:"7"},{label:"其他",value:"8"}],s="\n __  ___  __       __   __  ___  __       __\n|  |/  / |  |     |  | |  |/  / |  |     |  |\n|  '  /  |  |     |  | |  '  /  |  |     |  |\n|    <   |  |     |  | |    <   |  |     |  |\n|  .  \\  |  `----.|  | |  .  \\  |  `----.|  |\n|__|\\__\\ |_______||__| |__|\\__\\ |_______||__|\n"},2088:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2052);const n=({actions:t,targetId:e,targetType:i,onSuccess:n})=>{const o=Object(a.r)(!1),r=Object(a.r)(),l=async()=>{o.value=!0;try{const c=t.map(t=>({action:t,target_id:e,target_type:i})),{data:d}=await Object(s.b)({list:c});if(0===d.code){var a,l;const t=null===(a=d.data)||void 0===a||null===(l=a.access_list)||void 0===l?void 0:l.reduce((t,e)=>{var i;return null!==(i=e.access_entry)&&void 0!==i&&i.action?{...t,[e.access_entry.action]:{limit:e.limit,reason:e.reason}}:t},{});r.value=t,"function"==typeof n&&n(r.value)}}finally{o.value=!1}};return null!=t&&t.length&&e&&l(),{loading:o,auth:r,run:l}}},2089:function(t,e){t.exports="/vkm/img/cover-default.ca823d4c9b7f1be515c568927fb77076.png"},2091:function(t,e,i){"use strict";i.d(e,"a",(function(){return vt})),i.d(e,"b",(function(){return ft})),i.d(e,"c",(function(){return _t}));i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2016),n=(i(2028),i(144)),o=i(1915),r=i.n(o),l=i(529),c=i.n(l),d=i(2083),u=i(2001),p=i(1320),h=Object(a.c)({name:"invite-people-mod",data:()=>({showInvite:!0,inviteeName:[],inviteReason:"",showErrTips:!1}),props:{qIdProp:{type:[String,Number],default:""},inviterName:{type:String,default:""}},components:{venomPopup:c.a,elInput:n.Input,venomNewSelector:r.a},setup(t,e){const i=Object(a.r)({}),s=Object(a.q)({selectPeoples:[],selectValue:[],isSecret:!1}),n=()=>{var t,e,a,s;null===(t=i.value)||void 0===t||t.clearInput(),null===(e=i.value)||void 0===e||null===(a=e.$refs)||void 0===a||null===(s=a.selectorSearch)||void 0===s||s.syncSpanContent()},{peopleOptions:o,handleSearch:r}=(()=>{const t=Object(a.r)([]),o=Object(p.a)(a=>{const o=Object(d.a)(a);if(o.length>10)return e.root.$toast("超出添加人数上限",{status:"error",positon:"center"}),void n();o.length>1?(e=>{t.value=[];Object(u.c)(e,{searchType:"users"}).then(({data:e})=>{(e||[]).forEach(e=>{const a=e[0],o={label:e[1],value:a};var r;s.selectPeoples.includes(a)||(null===(r=i.value)||void 0===r||r.addMultipleOption(o));return t.value.push(o),n(),o})})})(o):(e=>{Object(u.d)(e,{type:"users",q:e,frequent:"",limit:20}).then(({data:e})=>{const i=e.map(t=>{const e=t[0];return{label:t[1],value:e}});t.value=i})})(a)},200);return{peopleOptions:t,handleSearch:o}})();return{resetModal:()=>{s.selectPeoples=[],s.selectValue=[],s.isSecret=!1,o.value=[]},form:s,mySelector:i,peopleOptions:o,handleSearch:r,handleChange:()=>{}}},computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){},methods:{sendInvite(){0!==this.mySelector.value.length?(this.showInvite=!1,this.$emit("onSaveMod",{inviteReason:this.inviteReason,mySelector:this.mySelector.value})):n.Message.error({message:"被邀请人不能为空"})},closeInviteDialog(){this.showInvite=!1,this.resetModal(),this.$emit("onCloseMod")}},filters:{}}),m=i(68),v=Object(m.a)(h,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("邀请同事")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("span",{staticClass:"highly-tag"},[t._v("*")]),t._v(" "),i("span",{staticClass:"text"},[t._v(t._s(t.userInfo&&t.userInfo.user_info&&t.userInfo.user_info.nick||"")+"邀请")]),t._v(" "),i("div",{staticClass:"form-text"},[i("venom-new-selector",{ref:"mySelector",attrs:{placeholder:"",mode:"multiple",width:270,filter:!1,optionArray:t.peopleOptions},on:{input:t.handleChange,search:t.handleSearch},model:{value:t.form.selectPeoples,callback:function(e){t.$set(t.form,"selectPeoples",e)},expression:"form.selectPeoples"}},t._l(t.peopleOptions,(function(t){return i("venom-options",{key:t.value,attrs:{label:t.label,value:t.id}})})),1)],1),t._v(" "),i("span",{staticClass:"text"},[t._v("来回答问题")])]),t._v(" "),t.showErrTips?i("div",{staticClass:"limit-tips"},[t._v("\n            每次只能邀请一名同事\n          ")]):t._e(),t._v(" "),i("div",{staticClass:"reason-input"},[i("el-input",{attrs:{placeholder:"邀请理由(选填)",type:"textarea",rows:3},model:{value:t.inviteReason,callback:function(e){t.inviteReason=e},expression:"inviteReason"}})],1),t._v(" "),i("div",{staticClass:"btn-line"},[i("span",{staticClass:"text"},[t._v("邀请记录会实名显示在问题下方，被邀请人将会收到企业微信通知")]),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("邀请")])])])])])])]):t._e()],1)}),[],!1,null,"3efca4d6",null).exports,g=Object(a.c)({name:"invite-supplement-mod",data:()=>({showInvite:!0,inviteeName:[],inviteReason:"",showErrTips:!1}),props:{qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a,elInput:n.Input},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){},methods:{sendInvite(){this.showInvite=!1,this.$emit("onSaveMod",{inviteReason:this.inviteReason})},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),f=Object(m.a)(g,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("邀请同事")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("span",{staticClass:"highly-tag"},[t._v("*")]),t._v(" "),i("span",{staticClass:"text"},[t._v("\n              "+t._s(t.userInfo&&t.userInfo.user_info&&t.userInfo.user_info.nick||"")+"邀请提问人来补充问题\n            ")])]),t._v(" "),i("div",{staticClass:"reason-input"},[i("el-input",{attrs:{placeholder:"邀请理由(选填)",type:"textarea",rows:3},model:{value:t.inviteReason,callback:function(e){t.inviteReason=e},expression:"inviteReason"}})],1),t._v(" "),i("div",{staticClass:"btn-line"},[i("span",{staticClass:"text"},[t._v("邀请记录会实名显示在问题下方，被邀请人将会收到企业微信通知")]),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("邀请")])])])])])])]):t._e()],1)}),[],!1,null,"7d61f612",null).exports,_=Object(a.c)({name:"q-complaint-mod",data:()=>({showInvite:!0,inviteeName:[],inviteReason:"",isAnonymous:!1,checkList:[{id:1,name:"违反国家法规",select:!1},{id:2,name:"广告灌水内容",select:!1},{id:3,name:"粗口、不友善",select:!1},{id:4,name:"负能量抖机灵",select:!1}]}),props:{qIdProp:{type:[String,Number],default:""},complaintType:{type:String,default:"question"}},components:{venomPopup:c.a,elInput:n.Input},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){},methods:{selectItem(t){t.select=!t.select},sendInvite(){const t=[];this.checkList.forEach(e=>{e.select&&t.push(e.name)}),t.length<1?n.Message.warning({message:"请至少选择一项理由！"}):(this.showInvite=!1,"question"===this.complaintType?this.$emit("onSaveMod",{note:t}):"answer"===this.complaintType&&this.$emit("onSaveMod",{note:t,isAnonymous:this.isAnonymous}))},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),b=Object(m.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v(t._s("answer"===t.complaintType?"投诉回答":"投诉问题"))]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("span",{staticClass:"highly-tag"},[t._v("*")]),t._v(" "),i("span",{staticClass:"text"},[t._v("\n              "+t._s("answer"===t.complaintType?"你投诉该回答的理由是?（可多选）":"你投诉该问题的理由是？（可多选）")+"\n            ")])]),t._v(" "),i("div",{staticClass:"reason-input"},[i("ul",t._l(t.checkList,(function(e,a){return i("li",{key:a,staticClass:"item",class:[e.select?"select-sub-item":""],on:{click:function(i){return t.selectItem(e,t.checkList)}}},[i("div",{staticClass:"box-area"},[e.select?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/y_check",width:16,height:16}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/n_check",width:16,height:16}})],1),t._v(" "),i("div",{staticClass:"choice-text"},[t._v(t._s(e.name))])])})),0)]),t._v(" "),i("div",{staticClass:"btn-line"},["answer"===t.complaintType?i("div",{staticClass:"anonymous-select",on:{click:function(e){t.isAnonymous=!t.isAnonymous}}},[i("div",{staticClass:"box-area"},[t.isAnonymous?t.isAnonymous?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/n_check",width:16,height:16}}):t._e():i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/y_check",width:16,height:16}})],1),t._v(" "),i("div",{staticClass:"choice-text"},[t._v("实名投诉")])]):t._e(),t._v(" "),i("span",{staticClass:"text"}),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("确定")])])])])])])]):t._e()],1)}),[],!1,null,"187a9216",null).exports,y=i(1925),w=i.n(y),C=Object(a.c)({name:"q-share-mod",data:()=>({showInvite:!0,qUrlWoa:"",qUrlPkm:"",qrcodeUrl:"",copyContent:""}),props:{qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}}},mounted(){this.qUrlWoa=`${window.location.origin}/q/view/${this.qIdProp}`,this.qrcodeUrl=`${window.location.origin}/operations/get_wechat_image?target_url=${this.qUrlWoa}`,window.location.origin.indexOf("km.woa.com")<0?this.qUrlPkm="https://km-develop.tencent.com/pkm/questions/"+this.qIdProp:this.qUrlPkm="https://km.tencent.com/pkm/questions/"+this.qIdProp,this.copyContent=`${this.qDetailData.question.title}: ${this.qUrlWoa}`;const t=new w.a(".q-copy-share");this.initCopy(t)},methods:{initCopy(t){const e=this;t.on("success",(function(){e.$toast("复制成功，现在你可以粘贴（ctrl+v）到其他地方。",{status:"success",positon:"center"})})),t.on("error",(function(){e.$toast("复制链接出错，请稍后再试或反馈KM热线",{status:"error",positon:"center"})}))},sendInvite(){this.showInvite=!1,this.$emit("onSaveMod")},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),k=Object(m.a)(C,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("分享")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"left-area"},[i("div",{staticClass:"qr-code-container"},[i("img",{staticClass:"qr-code-img",attrs:{src:t.qrcodeUrl}})])]),t._v(" "),i("div",{staticClass:"right-area"},[i("div",{staticClass:"title"},[t._v("\n              "+t._s(t.qDetailData.question.title)+"\n            ")]),t._v(" "),i("span",{staticClass:"link"},[t._v("\n              "+t._s(t.qUrlWoa)+"\n            ")]),t._v(" "),i("div",{staticClass:"copy-share q-copy-share",attrs:{"data-clipboard-text":t.copyContent},on:{click:t.sendInvite}},[t._v("\n              复制标题+链接\n            ")])])])])])]):t._e()],1)}),[],!1,null,"972aab9e",null).exports,O=Object(a.c)({name:"heart-tips-mod",data:()=>({showInvite:!0}),props:{qIdProp:{type:[String,Number],default:""},thankIntro:{type:String,default:"我要比心"}},components:{venomPopup:c.a},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){},methods:{sendInvite(){this.showInvite=!1,this.$store.commit("q/updateThanksInfo",{can_thank:!1,thank_intro:""}),this.$emit("onSaveMod")},closeInviteDialog(){this.showInvite=!1,this.$store.commit("q/updateThanksInfo",{can_thank:!1,thank_intro:""}),this.$emit("onCloseMod")}},filters:{}}),x=Object(m.a)(O,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("比心")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("span",{staticClass:"text"},[t._v("\n              "+t._s(t.thankIntro)+"\n            ")])]),t._v(" "),i("div",{staticClass:"btn-line"},[i("span",{staticClass:"text"}),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("去比心")])])])])])])]):t._e()],1)}),[],!1,null,"430a1203",null).exports,j=Object(a.c)({name:"hand-heart-mod",data:()=>({showInvite:!0,giftSelect:!1,giftName:"",receiveWay:""}),props:{qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a,elInput:n.Input},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null},thankData(){return this.$store.getters["q/getThankData"]||{}}},mounted(){},methods:{sendInvite(){this.giftSelect&&0===this.giftName.trim().length?n.Message.warning({message:"请填写自定义礼品名称"}):!this.thankData.has_sent_gift||this.giftSelect?this.$store.dispatch("q/sendHeart",{gift_name:this.giftName.trim(),gift_note:this.receiveWay.trim()}).then(()=>{n.Message.success({message:"比心已成功送出!"}),this.showInvite=!1,setTimeout(()=>{window.location.href=window.location.href},200),this.$emit("onSaveMod")}).catch(t=>{n.Message.error({message:"比心送出失败  "+t}),this.showInvite=!1}):n.Message.warning({message:"已经送过感谢卡了"})},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),I=Object(m.a)(j,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("乐问比心")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("div",{staticClass:"select-item default-item"},[i("div",{staticClass:"box-area"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/giftd_check",width:16,height:16}})],1),t._v(" "),i("div",{staticClass:"img-box"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/big_heart",width:36,height:36}})],1),t._v(" "),i("div",{staticClass:"info-line"},[i("p",{staticClass:"title"},[t._v("\n                  乐问比心卡\n                ")]),t._v(" "),i("p",{staticClass:"des"},[t._v("比心卡由乐问平台提供，获得一定数量比心 卡可以兑换礼物")])])]),t._v(" "),i("div",{staticClass:"select-item user-item",on:{click:function(e){t.giftSelect=!t.giftSelect}}},[i("div",{staticClass:"box-area"},[t.giftSelect?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/gifty_check",width:16,height:16}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/giftn_check",width:16,height:16}})],1),t._v(" "),i("div",{staticClass:"img-box"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/big_gift",width:36,height:36}})],1),t._v(" "),i("div",{staticClass:"info-line"},[i("p",{staticClass:"title"},[t._v("\n                  自定义礼品\n                ")]),t._v(" "),i("p",{staticClass:"des"},[t._v("如果你愿意代表产品/业务送出礼物，请输入相关信息")])])]),t._v(" "),t.giftSelect?i("div",{staticClass:"gift-info"},[i("p",{staticClass:"name-item"},[t._v("礼品名称")]),t._v(" "),i("div",{staticClass:"gift-item"},[i("el-input",{attrs:{placeholder:"如：KM文化衫"},model:{value:t.giftName,callback:function(e){t.giftName=e},expression:"giftName"}})],1),t._v(" "),i("p",{staticClass:"name-item"},[t._v("领取方式")]),t._v(" "),i("div",{staticClass:"gift-item"},[i("el-input",{attrs:{placeholder:"如：联系KM热线领取",type:"textarea",rows:2},model:{value:t.receiveWay,callback:function(e){t.receiveWay=e},expression:"receiveWay"}})],1)]):t._e()]),t._v(" "),i("div",{staticClass:"btn-line"},[i("span",{staticClass:"text"}),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("送出比心")])])])])])])]):t._e()],1)}),[],!1,null,"94ed5260",null).exports,T=Object(a.c)({name:"q-promote-mode",data:()=>({showInvite:!0,checkedArray:null,searchCandidates:[],nameList:[],sname:"",handleSearch(){}}),props:{qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a,elInput:n.Input},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){this.$store.dispatch("q/fetchCandidates").then(t=>{const e=t.candidates.map(e=>(e.checked=t.checked,e));this.checkedArray=e,this.nameList=e}).catch(()=>{this.checkedArray=[]}),this.handleSearch=Object(p.a)(()=>{this.fetchSearchCandidates(this.sname)},200)},methods:{chooseItem(t){t.checked=!t.checked},selectSearchName(t){if(this.nameList.some(e=>e.nick===t[0]))return this.searchCandidates=[],void(this.sname="");this.nameList.push({nick:t[0],avatar:"/asset/avatar/"+t[0],tag:"",cnt:"",short_name:"",checked:!0}),this.searchCandidates=[],this.sname=""},fetchSearchCandidates(t){t?this.$store.dispatch("q/fetchSearchCandidates",{name:t}).then(t=>{this.searchCandidates=t}).catch(()=>{this.searchCandidates=[]}):this.searchCandidates=[]},sendInvite(){const t=[];this.nameList.forEach(e=>{e.checked&&t.push(e.nick)}),0!==t.length?this.$store.dispatch("q/sendPush",{nameList:t}).then(()=>{n.Message.success({message:"感谢你的推动"}),this.showInvite=!1,this.$emit("onSaveMod"),setTimeout(()=>{window.location.href=window.location.href},80)}).catch(t=>{n.Message.error({message:"推动失败 "+(t||"")})}):n.Message.warning({message:"请选择同事"})},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),S=Object(m.a)(T,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("邀请同事")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"push-container"},[t.checkedArray&&t.checkedArray.length>0?i("div",{staticClass:"candidate-banner"},[t._v("\n              已为你精选可能负责此问题的同事，提醒他们关注和解决问题吧\n            ")]):t._e(),t._v(" "),i("div",{staticClass:"search-container"},[i("div",{staticClass:"searcher"},[i("div",{staticClass:"input-wrapper"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/name_search",width:20,height:20}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.sname,expression:"sname"}],staticClass:"input-box",attrs:{type:"text",placeholder:"添加其他同事"},domProps:{value:t.sname},on:{input:[function(e){e.target.composing||(t.sname=e.target.value)},t.handleSearch]}})],1),t._v(" "),t.searchCandidates.length>0?i("div",{staticClass:"search-candidates"},t._l(t.searchCandidates,(function(e,a){return i("div",{key:a,staticClass:"search-candidate",on:{click:function(i){return t.selectSearchName(e)}}},[i("img",{attrs:{width:"24",height:"24",src:"/asset/avatar/"+e[0]}}),t._v(" "),i("span",{staticClass:"search-name"},[t._v(t._s(e[1]))])])})),0):t._e()])]),t._v(" "),i("div",{staticClass:"push-candidates"},[t.checkedArray&&0===t.checkedArray.length&&0===t.nameList.length?i("div",{staticClass:"no-candidates"},[t._v("\n                乐问小丁还未找到此问题的负责人\n              ")]):t._e(),t._v(" "),t.nameList.length>0?i("div",{staticClass:"name-list"},t._l(t.nameList,(function(e){return i("div",{key:e.nick,staticClass:"select-item",on:{click:function(i){return t.chooseItem(e)}}},[i("div",{staticClass:"box-area"},[e.checked?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/y_check",width:16,height:16}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/n_check",width:16,height:16}})],1),t._v(" "),i("div",{staticClass:"img-box"},[i("img",{staticClass:"avatar-img",attrs:{src:e.avatar||""}})]),t._v(" "),i("div",{staticClass:"info-line",class:[e.cnt>0||e.short_name?"":"no-des"]},[i("p",{staticClass:"title"},[t._v("\n                      "+t._s(e.nick)+"\n                    ")]),t._v(" "),e.cnt>0||e.short_name?i("p",{staticClass:"des"},[t._v("\n                      "+t._s(e.cnt>0?"回答过"+e.cnt+"个#"+e.tag+"#的问题":e.short_name)+"\n                    ")]):t._e()])])})),0):t._e()])]),t._v(" "),i("div",{staticClass:"btn-line"},[i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("推动问题")])])])])])])]):t._e()],1)}),[],!1,null,"05e41402",null).exports,D=i(2011),q=i(2032),E=Object(a.c)({name:"QuestionSupplementMod",components:{venomPopup:c.a,richEditor:D.a,trilobiteEditorMod:q.a},filters:{},props:{qIdProp:{type:[String,Number],default:""}},setup:()=>({}),data(){return{newEditor:!0,showInvite:!0,contentModel:"",currentTiny:null,jsonContent:"",richContentStr:"",richContentText:"",editorConfigs:{min_height:280,max_height:340,setup:this.richSetup,customToolbars:"removeformat | styleselect fontsizeselect bold italic underline forecolor | link lximg  |  table lxcodesample emoticons | lxalign bullist numlist |  code  fullscreen ",invalid_styles:"font-family"}}},computed:{qId(){return this.qIdProp||this.$store.getters["q/getQId"]||""},userInfo(){return this.$store.getters["global/userInfo"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}},trilobiteEditOpen(){return this.$store.getters["q/getTrilobiteEditOpen"]},trilobitePreviewOpen(){return this.$store.getters["q/getTrilobitePreviewOpen"]}},created(){this.newEditor="iWiki"===this.qDetailData.question.editor_type&&1===this.trilobiteEditOpen},mounted(){setTimeout(()=>{window.tinymceImgConfig=window.tinymceImgConfig||{},window.tinymceImgConfig.block=10},80)},methods:{getEditorContent(){const t=this.$refs.trilobiteRef;if(t.checkIsContentEmpty())return null;const e=t.provideContent();return this.jsonContent=e,this.jsonContent},richSetup(t){this.currentTiny=t,t.on("change",t=>{this.richContentStr=t.target.getContent(),this.richContentText=t.target.getContent({format:"text"})})},preSendInvite(){this.newEditor?this.$store.dispatch("q/handleContentVerify",{content:this.$refs.trilobiteRef.provideTextContent()}).then(()=>{this.sendInvite()}).catch(t=>{n.Message.error({message:t.msg||"敏感词校验失败"})}):this.sendInvite()},sendInvite(){let t="q/addQuestionSupplementary",e=this.richContentStr;if(this.newEditor){if(t="q/addQuestionSupplementaryNew",e=this.getEditorContent(),null===e)return void n.Message.error({message:"补充问题提交失败，内容不能为空！"})}else{const t=/<img[^>]*>/gi,e=this.richContentText.trim(),i=this.richContentStr.trim().replace(/<\s*br\s*\/?>/gi,"");if(!e&&!t.exec(i)||!i||/^<div>(&nbsp;(\s)*)*<\/div>$/i.test(i)||/^(&nbsp;(\s)*)+$/.test(i))return void n.Message.error({message:"补充问题提交失败，内容不能为空！"})}const i=this.$store.getters["global/userToken"]||"";this.$store.dispatch(t,{content:e,userToken:i,id:this.qId}).then(({questionSupplementary:t})=>{n.Message.success({message:"补充问题提交成功"}),this.showInvite=!1,this.$emit("onSaveMod",t),setTimeout(()=>{window.location.href=window.location.href},300)}).catch(()=>{n.Message.error({message:"补充问题提交失败，请重试!"})})},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}}}),A=Object(m.a)(E,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container question-supplement-mod-container"},[t.showInvite?i("venom-popup",[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("补充问题")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"q-title"},[t._v("\n            已有回答的问题不允许编辑，请填写补充内容，将即时知会关注者和回答者。\n          ")]),t._v(" "),-1!==t.trilobiteEditOpen?[t.newEditor?i("div",{staticClass:"supplement-trilobite-wrapper"},[i("trilobiteEditorMod",{ref:"trilobiteRef",attrs:{"editor-type":"add","img-block-id":10,"business-type":"input-business-type-question"}},[i("p",[t._v("no editor")])])],1):i("div",{staticClass:"edit-wrapper"},[i("rich-editor",{attrs:{"is-load":t.loadIntroEditor,configs:t.editorConfigs},model:{value:t.contentModel,callback:function(e){t.contentModel=e},expression:"contentModel"}})],1)]:t._e(),t._v(" "),i("div",{staticClass:"btn-line"},[i("div"),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("\n                取消\n              ")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.preSendInvite}},[t._v("\n                确定\n              ")])])])],2)])])]):t._e()],1)}),[],!1,null,"2c0c7179",null).exports,M=Object(a.c)({name:"revision-history-mod",data:()=>({showInvite:!0,historyItem:null}),props:{qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a},setup:()=>({}),computed:{qId(){return this.qIdProp||this.$store.getters["q/getQId"]||""},userInfo(){return this.$store.getters["global/userInfo"]||null},operationsData(){return this.$store.getters["q/getOperationsData"]||null}},mounted(){},methods:{showHistoryItem(t){this.historyItem=t,this.sendInvite()},sendInvite(){this.showInvite=!1,this.$emit("onSaveMod",this.historyItem)},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),$=Object(m.a)(M,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("历史版本")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),t.operationsData&&t.operationsData.revision?i("div",{staticClass:"select-content"},[t.operationsData.revision.current_version?i("div",{staticClass:"q-title"},[i("span",{staticClass:"star"},[t._v("*")]),t._v("\n            当前版本编辑于"+t._s(t.operationsData.revision.current_version.modified)+" by\n            "+t._s(t.operationsData.revision.current_version.modified_by)+"\n          ")]):t._e(),t._v(" "),i("div",{staticClass:"edit-wrapper"},[t.operationsData.revision.history?i("ul",t._l(t.operationsData.revision.history,(function(e){return i("li",{key:e.id,staticClass:"item"},[i("span",{staticClass:"text"},[t._v(t._s(e.revision_created)+" by "+t._s(e.revision_created_by))]),t._v(" "),i("span",{staticClass:"look-item",on:{click:function(i){return t.showHistoryItem(e)}}},[t._v("查看")])])})),0):t._e()])]):t._e()])])]):t._e()],1)}),[],!1,null,"7d8acaaa",null).exports,L=Object(a.c)({name:"RevisionItemMod",components:{venomPopup:c.a},props:{qIdProp:{type:[String,Number],default:""},historyItem:{type:Object,default:()=>({})}},data:()=>({showInvite:!0}),computed:{trilobiteEditOpen(){return this.$store.getters["q/getTrilobiteEditOpen"]},trilobitePreviewOpen(){return this.$store.getters["q/getTrilobitePreviewOpen"]}},mounted(){"iWiki"===this.historyItem.editor_type&&1===this.trilobiteEditOpen&&this.$nextTick(()=>{const t={container:"#q-history-json-content-id-"+this.historyItem.id,appearance:"full-width",language:"zh",value:this.historyItem.json_content,model:"preview",clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},plugins:[new window.ImagePlugin,new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})],pluginsSettings:{featureFlag:{allowTables:!1,allowEmoji:!1,allowBlockType:!1,allowFontSize:!1,allowTextAlignment:!1,allowTextHighlight:!1,allowFindReplace:!1}}};new window.TrilobiteEditor(t)})},methods:{closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}}}),P=Object(m.a)(L,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container revision-history-rich-area"},[t.showInvite?i("venom-popup",[i("div",{staticClass:"invite-dialog-wrapper"},[t.historyItem&&t.historyItem.id?i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("\n            问题历史版本："+t._s(t.historyItem.revision_created)+" by "+t._s(t.historyItem.revision_created_by)+"\n          ")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"q-title"},[t._v("\n            "+t._s(t.historyItem.title)+"\n          ")]),t._v(" "),i("div",{staticClass:"edit-wrapper"},[-1!==t.trilobiteEditOpen?["iWiki"===t.historyItem.editor_type&&1===t.trilobiteEditOpen?i("div",{staticClass:"km-editor-json-content"},[i("div",{staticClass:"trilobite-container km-trilobite-editor"},[i("div",{staticClass:"km-editor-hook",attrs:{id:"q-history-json-content-id-"+t.historyItem.id}})])]):i("div",{staticClass:"rich-content-area custom-block"},[i("div",{staticClass:"text-content km-view-content km-view-content-simple custom-block-content",domProps:{innerHTML:t._s(t.historyItem.content)}})])]:t._e()],2)])]):t._e()])]):t._e()],1)}),[],!1,null,"cf6ae2c4",null).exports,F=i(57),R=Object(a.c)({name:"OperationMod",components:{elDialog:n.Dialog,elButton:n.Button,invitePeopleMod:v,inviteSupplementMod:f,qComplaintMod:b,qShareMod:k,heartTipsMod:x,handHeartMod:I,qPromoteMode:S,questionSupplementMod:A,revisionHistoryMod:$,revisionItemMod:P},filters:{qTitleStr(t){const{inviter_info:e}=t,i=[];return e.level_name&&i.push(e.level_name),e.dept_name&&i.push(e.dept_name),e.post_name&&i.push(e.post_name),e.vip_intro&&i.push(e.vip_intro),i.join("，")},qTitleStrInvitee(t){const{invitee_info:e}=t,i=[];return e.level_name&&i.push(e.level_name),e.dept_name&&i.push(e.dept_name),e.post_name&&i.push(e.post_name),e.vip_intro&&i.push(e.vip_intro),i.join("，")}},props:{qIdProp:{type:[String,Number],default:""},pageType:{type:String,default:"detail"},fixedBottomLine:{type:Boolean,default:!1}},setup:()=>({}),data:()=>({noFixedBottomLineheight:48,showHistoryDialog:!1,showHistoryItemDialog:!1,currentHistoryItem:null,inviteUsersList:[],inviteNote:"",inviteSupplementNote:"",showTopTips:!1,pageWidth:1100,bodyWidth:1500,testShow1:!0,testShow3:!1,testShow4:!1,afterAnswerShow:!1,showContent:!0,canShowAttitude:!1,currentUsableAttitudesModalType:0,showUsableAttitudesModal:!1,showDeleteFailDialog:!1,deleteFailTips:"",showInviteDialog:!1,showSupplementDialog:!1,showComplaintDialog:!1,showShareDialog:!1,showSendHeartDialog:!1,showPromoteDialog:!1,showEditListDialog:!1,showMoreDialog:!1,showAttitudeTimer:null,showEditTimer:null,showMoreTimer:null,showUpdateQDialog:!1,attitudeDir:"up"}),computed:{reportNick(){return this.qDetailData.question.is_anonymous?"匿名用户":this.qDetailData.question.author_info.nick},fixedStyleObj(){if(this.fixedBottomLine){return{marginLeft:(this.bodyWidth-this.pageWidth)/2+"px"}}return{}},fixedNewInvitations(){return this.$store.getters["q/getFixedNewInvitations"]||null},usableAttitudes(){return this.$store.getters["q/getUsableAttitudes"]||[]},currentQAttitudes(){return this.$store.getters["q/getCurrentQAttitudes"]||{}},operationsData(){return this.$store.getters["q/getOperationsData"]||null},thankData(){return this.$store.getters["q/getThankData"]||{}},thanksInfo(){return this.$store.getters["q/getThanksInfo"]||{}},qId(){return this.qIdProp||this.$store.getters["q/getQId"]||""},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}}},mounted(){this.bodyWidth=document.body.clientWidth,this.qDetailData.question.redirect_q_id||this.qDetailData.question.is_disabled||1===this.qDetailData.question.is_appealed||this.qDetailData.question.is_content_hidden||(this.canShowAttitude=!0),this.freshAttitude(),this.updateOperationsData(),this.$store.dispatch("q/getQThanksData",{id:this.qId}).then(()=>{}).catch(()=>{}),window.addEventListener("resize",this.dealWinResize)},methods:{showHistoryDetail(t){this.showHistoryDialog=!1,t&&t.id&&(this.currentHistoryItem=t,this.showHistoryItemDialog=!0)},checkEditQ(){!this.qDetailData.question.is_disabled||this.qDetailData.question.is_disabled&&1===this.qDetailData.question.disable_type?this.qDetailData.question.can_edit_directly||this.qDetailData.question.is_disabled&&1===this.qDetailData.question.disable_type?"iWiki"===this.qDetailData.question.editor_type?window.location.href="/q/edit/"+this.qId:window.location.href="/q/edit_old/"+this.qId:this.showUpdateQDialog=!0:n.Message.warning({message:"无效问题不能编辑"})},openHeart(){this.showSendHeartDialog=!0},jumpToLook(){const t=document.getElementsByClassName("answer-list-content");t&&t[0]&&t[0].scrollIntoView({behavior:"smooth"})},jumpToAnswerEditor(){const t=document.getElementsByClassName("user-answer-wrapper");t&&t[0]&&t[0].scrollIntoView({behavior:"smooth"})},openMoreListArea(){this.showMoreDialog=!0,this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseenter(){this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseleave(){this.showMoreTimer&&clearTimeout(this.showMoreTimer),this.showMoreDialog&&(this.showMoreTimer=setTimeout(()=>{this.showMoreDialog=!1},200))},openEditListArea(){this.showEditListDialog=!this.showEditListDialog,this.showEditTimer&&clearTimeout(this.showEditTimer)},handelEditMouseenter(){this.showEditTimer&&clearTimeout(this.showEditTimer)},handelEditMouseleave(){this.showEditTimer&&clearTimeout(this.showEditTimer),this.showEditListDialog&&(this.showEditTimer=setTimeout(()=>{this.showEditListDialog=!1},600))},closeShareDialog(){this.showShareDialog=!1},saveShareDialog(){this.showShareDialog=!1},hasComplaint(){n.Message.warning({message:"你已投诉过该问题"})},closeComplaintDialog(){this.showComplaintDialog=!1},saveComplaintDialog({note:t}){t.length<1||(this.showComplaintDialog=!1,this.$store.dispatch("q/complainQ",{id:this.qId,note:t}).then(()=>{n.Message.success({message:"投诉成功!"}),this.updateOperationsData()}).catch(()=>{n.Message.error({message:"投诉失败，请稍后再试!"})}))},closeSupplementDialog(){this.showSupplementDialog=!1},saveSupplementDialog(t){this.inviteSupplementNote=t.inviteReason||"",this.submitInviteSupplement()},closeInviteDialog(){this.showInviteDialog=!1},cancelSubmitInviteUsers(){this.showTopTips=!1,this.showInviteDialog=!1},sureSubmitInviteUsers(){this.showTopTips=!1,this.submitInviteUsers()},submitInviteUsers(){this.$store.dispatch("q/inviteUsers",{inviteUsers:this.inviteUsersList,inviteNote:this.inviteNote}).then(()=>{n.Message.success({message:"提交邀请成功！"}),this.showInviteDialog=!1,setTimeout(()=>{window.location.href=window.location.href},300)}).catch(()=>{n.Message.error({message:"提交邀请失败,请稍后重试"}),this.showInviteDialog=!1})},submitInviteSupplement(){this.$store.dispatch("q/inviteSupplement",{inviteNote:this.inviteSupplementNote}).then(()=>{n.Message.success({message:"提交邀请补充成功！"}),this.showSupplementDialog=!1,setTimeout(()=>{window.location.href=window.location.href},300)}).catch(()=>{n.Message.error({message:"提交邀请补充失败,请稍后重试"}),this.showSupplementDialog=!1})},saveInviteDialog(t){this.inviteUsersList=t.mySelector,this.inviteNote=t.inviteReason,this.$store.dispatch("q/fetchTopList").then(({list:e})=>{e.indexOf(t.mySelector[0])>-1?this.showTopTips=!0:this.submitInviteUsers()}).catch(()=>{this.submitInviteUsers()})},canNotDeleteQ(){this.showDeleteFailDialog=!0,this.qDetailData.question.is_hot_question&&this.qDetailData.answers.length>0?this.deleteFailTips="被设为热问的问题不能自己删除，请联系KM热线":this.deleteFailTips="该问题已有回答，不能删除"},canDeleteQ(){this.$newConfirm("warning","确认要删除？",{confirm:()=>{this.$store.dispatch("q/removeQAsync",{id:this.qId}).then(()=>{n.Message.success({message:"删除成功!"}),setTimeout(()=>{window.location.href="/q?kmref=q_deleted"},500)}).catch(()=>{n.Message.error({message:"删除失败!"})})}})},updateOperationsData(){this.$store.dispatch("q/getOperationsData",{id:this.qId}).then(()=>{}).catch(()=>{})},handHeartSaveMod(){this.showSendHeartDialog=!this.showSendHeartDialog,Object(F.b)("questionOperator",{question_id:this.qId,author_nick:this.reportNick,operation_type:"ThankHeart"})},attentionFn(t){t.is_owner||(t.can_follow?this.$store.dispatch("q/followQ",{id:this.qId}).then(()=>{this.updateOperationsData(),Object(F.b)("questionOperator",{question_id:this.qId,author_nick:this.reportNick,operation_type:"follow"})}).catch(()=>{}):this.$store.dispatch("q/unFollowQ",{id:this.qId}).then(()=>{this.updateOperationsData(),Object(F.b)("questionOperator",{question_id:this.qId,author_nick:this.reportNick,operation_type:"cancelFollow"})}).catch(()=>{}))},freshAttitude(){this.$store.dispatch("q/fetchQuestionUsableAttitudes",{id:this.qId}).then(()=>{}).catch(()=>{}),this.$store.dispatch("q/fetchQuestionHadAttitudes",{id:this.qId}).then(()=>{}).catch(()=>{})},reportAttitudeOpe(t,e){Object(F.b)("questionShowAttitude",{question_id:this.qId,author_nick:this.reportNick,attitdue_id:t.id,attitdue_tittle:t.title,operation_type:e})},handleDeleteAttitude(t){this.$store.dispatch("q/unuseAttitude",{id:this.qId}).then(()=>{this.currentUsableAttitudesModalType=0,this.freshAttitude(),this.reportAttitudeOpe(t,"cancelAttitude")}).catch(()=>{n.Message.error({message:"取消表态失败，请稍后再试！"})})},handelChangeShowUsableAttitudesModal(t){var e;const i=1===t?this.$refs.attitudeEntry1:this.$refs.attitudeEntry2,a=(null==i||null===(e=i.getBoundingClientRect())||void 0===e?void 0:e.top)||0;this.attitudeDir=a<110?"down":"up",this.currentUsableAttitudesModalType===t?(this.currentUsableAttitudesModalType=0,this.rmWinHandle()):this.currentUsableAttitudesModalType=t,this.addWinHandle()},dealWinResize(){this.bodyWidth=document.body.clientWidth},dealWinClick(t){const e=t.target;let i=!1;const a=document.querySelectorAll(".handle-ele-for-question"),s=document.querySelectorAll(".attitude-list-for-question");for(let t=0;t<a.length;t++){const s=a[t];(s===e||s&&s.contains(e))&&(i=!0)}for(let t=0;t<s.length;t++){const a=s[t];(a===e||a&&a.contains(e))&&(i=!0)}i||(this.currentUsableAttitudesModalType=0,setTimeout(()=>{this.rmWinHandle()},40))},addWinHandle(){window.addEventListener("click",this.dealWinClick)},rmWinHandle(){window.removeEventListener("click",this.dealWinClick)},handleClickAttitude(t){this.showAttitudeTimer&&clearTimeout(this.showAttitudeTimer);const e=this.currentQAttitudes.myAttitude&&this.currentQAttitudes.myAttitude.id||"";e!==t.id?this.$store.dispatch("q/useAttitude",{attitudeId:t.id}).then(()=>{this.currentUsableAttitudesModalType=0,this.freshAttitude(),e?this.reportAttitudeOpe(t,"editAttitude"):this.reportAttitudeOpe(t,"addAttitude")}).catch(()=>{n.Message.error({message:"表态失败，请稍后再试！"})}):this.handleDeleteAttitude(t)}}}),N=Object(m.a)(R,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operation-container"},[i("div",{staticClass:"operation-section"},[t.canShowAttitude&&t.currentQAttitudes.hadAttitudes&&t.currentQAttitudes.hadAttitudes.length>0?i("div",{staticClass:"clarify-position-area"},[i("div",{ref:"attitudeEntry1",staticClass:"question-attitude-item attitude-add-btn handle-ele-for-question",on:{click:function(e){return t.handelChangeShowUsableAttitudesModal(1,e)}}},[i("svg-icon",{attrs:{name:"q/clarify_ope",width:20,height:20}}),t._v(" "),t.usableAttitudes.length>0&&1===t.currentUsableAttitudesModalType?i("div",{staticClass:"attitude-list attitude-list-for-question",class:["up"===t.attitudeDir?"attitude-list-up":"attitude-list-down"]},[t._l(t.usableAttitudes,(function(e){return i("div",{key:e.id,staticClass:"attitude-list-item",class:t.currentQAttitudes.myAttitude&&t.currentQAttitudes.myAttitude.id===e.id?"attitude-list-item-active":"attitude-list-item-default",on:{click:function(i){return t.handleClickAttitude(e)}}},[i("img",{attrs:{src:e.icon}}),t._v(" "),i("span",[t._v(t._s(e.title))])])})),t._v(" "),i("span",{staticClass:"attitude-list-arrow"})],2):t._e()],1),t._v(" "),t._l(t.currentQAttitudes.hadAttitudes,(function(e,a){return i("div",{key:a,staticClass:"question-attitude-item",class:t.currentQAttitudes.myAttitude&&t.currentQAttitudes.myAttitude.id===e.attitude.id?"clarify-success-item":"",on:{click:function(i){return t.handleClickAttitude(e.attitude)}}},[i("img",{staticClass:"attitude-icon",attrs:{src:e.attitude.icon}}),t._v(" "),i("span",{staticClass:"attitude-title attitude-text"},[t._v(t._s(e.attitude.title))]),t._v(" "),i("span",{staticClass:"attitude-count attitude-text"},[t._v(" "+t._s(e.used_count))])])}))],2):t._e()]),t._v(" "),t.fixedBottomLine?i("div",{staticClass:"replace-q-operation-area",style:{height:t.noFixedBottomLineheight+"px"}}):t._e(),t._v(" "),i("div",{staticClass:"operation-section",class:[t.fixedBottomLine?"fixed-bottom-line":"no-fixed-bottom-line"],style:t.fixedStyleObj},[t.operationsData&&t.operationsData.answer&&t.fixedBottomLine?[i("div",{staticClass:"other-ope"},[i("div",{staticClass:"ope-look-answer-type common-ope",on:{click:t.jumpToLook}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/look_answer",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("查看回答")])],1)])]:t._e(),t._v(" "),i("div",{staticClass:"wrapper-box"},[i("div",{staticClass:"operation-list-area"},[i("div",{staticClass:"left-ope side-ope"},[t.operationsData&&t.operationsData.invite_answer?[t.operationsData.super_push.can_super_push?t._e():i("div",{staticClass:"ope-invite-type common-ope",on:{click:function(e){t.showInviteDialog=!t.showInviteDialog}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/q_invite",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("邀请回答")])],1),t._v(" "),1===t.operationsData.can_invite_supplement?i("div",{staticClass:"ope-invite-supplement-type common-ope",on:{click:function(e){t.showSupplementDialog=!t.showSupplementDialog}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/q_invite",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("邀请补充")])],1):t._e()]:t._e(),t._v(" "),t.operationsData&&t.operationsData.super_push.can_super_push?i("div",{staticClass:"ope-promote-type common-ope",on:{click:function(e){t.showPromoteDialog=!t.showPromoteDialog}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/q_promote",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("我来推动")])],1):t._e(),t._v(" "),t.canShowAttitude?i("div",{ref:"attitudeEntry2",staticClass:"ope-clarify-type common-ope handle-ele-for-question",on:{click:function(e){return t.handelChangeShowUsableAttitudesModal(2,e)}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/clarify_ope",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("表个态")]),t._v(" "),t.usableAttitudes.length>0&&2===t.currentUsableAttitudesModalType?i("div",{staticClass:"attitude-list attitude-list-for-question",class:["up"===t.attitudeDir?"attitude-list-up":"attitude-list-down"]},[t._l(t.usableAttitudes,(function(e){return i("div",{key:e.id,staticClass:"attitude-list-item",class:t.currentQAttitudes.myAttitude&&t.currentQAttitudes.myAttitude.id===e.id?"attitude-list-item-active":"attitude-list-item-default",on:{click:function(i){return t.handleClickAttitude(e)}}},[i("img",{attrs:{src:e.icon}}),t._v(" "),i("span",[t._v(t._s(e.title))])])})),t._v(" "),i("span",{staticClass:"attitude-list-arrow"})],2):t._e()],1):t._e(),t._v(" "),t.operationsData&&t.operationsData.edit&&t.operationsData.edit.edit_url&&"show"!==t.operationsData.operationStatus?i("div",{staticClass:"ope-edit-type common-ope",on:{click:t.openEditListArea,mouseleave:t.handelEditMouseleave}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/q_edit",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("编辑")]),t._v(" "),t.showEditListDialog?i("div",{staticClass:"edit-list common-child-ope-list",on:{mouseenter:t.handelEditMouseenter,mouseleave:t.handelEditMouseleave}},[i("ul",[t.operationsData.showEditByContentHidden?i("li",{staticClass:"item",on:{click:t.checkEditQ}},[i("span",{staticClass:"text"},[t._v("编辑")])]):t._e(),t._v(" "),t.operationsData.q_realname&&t.operationsData.q_realname.url?i("li",{staticClass:"item"},[i("a",{staticClass:"text",attrs:{href:t.operationsData.q_realname.url}},[t._v("取消匿名")])]):t._e(),t._v(" "),t.operationsData.q_anonymous&&t.operationsData.q_anonymous.url?i("li",{staticClass:"item"},[i("a",{staticClass:"text",attrs:{href:t.operationsData.q_anonymous.url}},[t._v("设为匿名")])]):t._e(),t._v(" "),t.operationsData.remove&&t.operationsData.remove.can_delete?i("li",{staticClass:"item can_delete",on:{click:t.canDeleteQ}},[i("span",{staticClass:"text"},[t._v("删除")])]):t._e(),t._v(" "),t.operationsData.remove&&!t.operationsData.remove.can_delete?i("li",{staticClass:"item can_not_delete",on:{click:t.canNotDeleteQ}},[i("span",{staticClass:"text"},[t._v("删除")])]):t._e()])]):t._e()],1):t._e(),t._v(" "),i("div",{staticClass:"ope-more-type common-ope",on:{mouseenter:t.openMoreListArea,mouseleave:t.handelMoreMouseleave}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/more_ope",width:20,height:20}}),t._v(" "),t.operationsData&&t.showMoreDialog?i("div",{staticClass:"more-ope-list common-child-ope-list",on:{mouseenter:t.handelMoreMouseenter,mouseleave:t.handelMoreMouseleave}},[i("ul",[!1===t.operationsData.is_complain?i("li",{staticClass:"item",on:{click:function(e){t.showComplaintDialog=!t.showComplaintDialog}}},[i("span",{staticClass:"text"},[t._v("投诉")])]):i("li",{staticClass:"item",on:{click:t.hasComplaint}},[i("span",{staticClass:"text"},[t._v("已投诉")])]),t._v(" "),i("li",{staticClass:"item",on:{click:function(e){t.showShareDialog=!t.showShareDialog}}},[i("span",{staticClass:"text"},[t._v("分享")])]),t._v(" "),t.operationsData.super_admin?i("li",{staticClass:"item"},[i("a",{staticClass:"text",attrs:{href:t.operationsData.newQuestionAdminPageUrl,target:"_blank"}},[t._v("管理")])]):t._e(),t._v(" "),t.operationsData.revision&&t.operationsData.revision.history&&t.operationsData.revision.history.length>0&&!t.operationsData.is_content_hidden?i("li",{staticClass:"item",on:{click:function(e){t.showHistoryDialog=!t.showHistoryDialog}}},[i("span",{staticClass:"text"},[t._v("历史")])]):t._e()])]):t._e()],1)],2),t._v(" "),i("div",{staticClass:"right-ope side-ope"},[t.thankData.is_display_thanks_btn&&t.thankData.is_display_thanks_block?i("div",{staticClass:"ope-hand-heart-type common-ope",on:{click:function(e){t.showSendHeartDialog=!t.showSendHeartDialog}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/hand_heart",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v(t._s(t.thankData.has_sent_gift?"已比心":"比心"))])],1):t._e(),t._v(" "),t.operationsData?i("div",{staticClass:"common-ope",class:[t.operationsData.follow.is_owner?"ope-disabled-attention-type":t.operationsData.follow.can_follow?"ope-attention-type":"ope-has-attention-type"],on:{click:function(e){return t.attentionFn(t.operationsData.follow)}}},[t.operationsData.follow.is_owner?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/disabled_attention",width:20,height:20}}):t.operationsData.follow.can_follow?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/can_attention",width:20,height:20}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/has_attention",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("\n              "+t._s(t.operationsData.follow.is_owner||t.operationsData.follow.can_follow?"关注":"已关注")+"\n              "+t._s(t.operationsData.follow.follow_count)+"\n            ")])],1):t._e(),t._v(" "),t.operationsData&&t.operationsData.answer?[!t.operationsData.follow.is_answered&&t.operationsData.can_answer?i("div",{staticClass:"ope-answer-type common-ope",on:{click:t.jumpToAnswerEditor}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/can_answer",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("回答")])],1):t.operationsData.follow.is_answered||t.operationsData.can_answer?i("div",{staticClass:"ope-has-answer-type common-ope",attrs:{title:"查看我的回答"}},[i("a",{attrs:{href:"/q/answer/"+t.operationsData.follow.is_answered,target:"_blank"}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/has_answer",width:20,height:20}})],1),t._v(" "),i("a",{staticClass:"ope-btn-text",attrs:{href:"/q/answer/"+t.operationsData.follow.is_answered,target:"_blank"}},[t._v("\n                已回答\n              ")])]):i("div",{staticClass:"ope-diasbled-answer-type common-ope"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/disabled_answer",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("回答")])],1)]:t._e()],2)])])],2),t._v(" "),i("div",{staticClass:"operation-section"},[t.fixedNewInvitations&&void 0!==t.fixedNewInvitations.invite_answer&&t.fixedNewInvitations.invite_answer.invited_list.length>0?i("div",{staticClass:"operation-record-list"},[i("div",{staticClass:"area-wrapper"},[i("ul",{staticClass:"items"},t._l(t.fixedNewInvitations.invite_answer.invited_list,(function(e,a){return i("li",{key:a,staticClass:"item"},["super_push"===e.target_type?[i("a",{attrs:{href:"/user/"+e.inviter,target:"_blank"}},[t._v(t._s(e.inviter))]),t._v(" "),i("span",[t._v("已推动相关负责人关注")])]:"thanks"===e.target_type?[i("a",{attrs:{href:"/user/"+e.inviter,target:"_blank"}},[t._v(t._s(e.inviter))]),t._v(" "),e.inviter_info&&"1"===e.inviter_info.is_expert?i("svg-icon",{staticClass:"user-icon",attrs:{title:t._f("qTitleStr")(e),name:"q/vip_info",width:13,height:13}}):t._e(),t._v(" "),i("span",[t._v(" 送出了 ")]),t._v(" "),i("svg-icon",{staticClass:"item-icon",attrs:{name:"q/small_heart",width:12,height:14}}),t._v(" "),i("span",[t._v("乐问比心卡")])]:[1===e.is_invited_by_admin?i("span",[t._v("腾讯乐问")]):[i("a",{attrs:{href:"/user/"+e.inviter,target:"_blank"}},[t._v(t._s(e.inviter))]),t._v(" "),e.inviter_info&&"1"===e.inviter_info.is_expert?i("svg-icon",{staticClass:"user-icon",attrs:{title:t._f("qTitleStr")(e),name:"q/vip_info",width:13,height:13}}):t._e()],t._v(" "),i("span",[t._v(" 邀请了 ")]),t._v(" "),"匿名提问人"===e.invitee?i("span",[t._v(t._s(e.invitee)+"  ")]):[i("a",{attrs:{href:"/user/"+e.invitee,target:"_blank"}},[t._v(t._s(e.invitee)+"  ")]),t._v(" "),e.invitee_info&&"1"===e.invitee_info.is_expert?[i("svg-icon",{staticClass:"user-icon",attrs:{title:t._f("qTitleStrInvitee")(e),name:"q/vip_info",width:13,height:13}}),t._v(" "),i("span",[t._v(" ")])]:t._e()],t._v(" "),i("span",[t._v(t._s(e.is_invite_supplement?"来补充":"来回答"))]),t._v(" "),i("span",[t._v(t._s(e.note?"，邀请理由："+e.note:""))])]],2)})),0)])]):t._e(),t._v(" "),i("el-dialog",{attrs:{title:"温馨提示",width:"20%","lock-scroll":!1,visible:t.showDeleteFailDialog},on:{"update:visible":function(e){t.showDeleteFailDialog=e},close:function(e){t.showDeleteFailDialog=!1}}},[i("span",[t._v(t._s(t.deleteFailTips))]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.showDeleteFailDialog=!1}}},[t._v("\n          确定\n        ")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"温馨提示",width:"20%","lock-scroll":!1,visible:t.showTopTips},on:{"update:visible":function(e){t.showTopTips=e},close:function(e){t.showTopTips=!1}}},[i("span",[t._v("\n        你的邀请名单中有总办，如果不是非常必要，建议给问题打上“总办交流”的标签，会有HR相关同事整理并告知总办，以免过于频繁的邀请干扰总办。你确定依然要以你的个人名义邀请总办吗？\n      ")]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.sureSubmitInviteUsers}},[t._v("\n          确定\n        ")])],1)]),t._v(" "),t.showInviteDialog?i("invite-people-mod",{on:{onCloseMod:t.closeInviteDialog,onSaveMod:t.saveInviteDialog}}):t._e(),t._v(" "),t.showSupplementDialog?i("invite-supplement-mod",{on:{onCloseMod:t.closeSupplementDialog,onSaveMod:t.saveSupplementDialog}}):t._e(),t._v(" "),t.showComplaintDialog?i("q-complaint-mod",{attrs:{"complaint-type":"question"},on:{onCloseMod:t.closeComplaintDialog,onSaveMod:t.saveComplaintDialog}}):t._e(),t._v(" "),t.showShareDialog?i("q-share-mod",{attrs:{"q-id-prop":t.qId},on:{onCloseMod:t.closeShareDialog,onSaveMod:t.saveShareDialog}}):t._e(),t._v(" "),t.thanksInfo&&t.thanksInfo.canThank?i("heart-tips-mod",{attrs:{"thank-intro":t.thanksInfo.thankIntro},on:{onSaveMod:t.openHeart}}):t._e(),t._v(" "),t.showSendHeartDialog?i("hand-heart-mod",{on:{onCloseMod:function(e){t.showSendHeartDialog=!t.showSendHeartDialog},onSaveMod:t.handHeartSaveMod}}):t._e(),t._v(" "),t.showPromoteDialog?i("q-promote-mode",{on:{onCloseMod:function(e){t.showPromoteDialog=!t.showPromoteDialog},onSaveMod:function(e){t.showPromoteDialog=!t.showPromoteDialog}}}):t._e(),t._v(" "),t.showUpdateQDialog?i("question-supplement-mod",{on:{onCloseMod:function(e){t.showUpdateQDialog=!1},onSaveMod:function(e){t.showUpdateQDialog=!1}}}):t._e(),t._v(" "),t.showHistoryDialog?i("revision-history-mod",{on:{onSaveMod:t.showHistoryDetail,onCloseMod:function(e){t.showHistoryDialog=!1}}}):t._e(),t._v(" "),t.showHistoryItemDialog&&t.currentHistoryItem?i("revision-item-mod",{attrs:{"history-item":t.currentHistoryItem},on:{onCloseMod:function(e){t.showHistoryItemDialog=!1}}}):t._e()],1)])}),[],!1,null,"228a9e35",null).exports,B=Object(a.c)({name:"CommentMod",components:{},filters:{},props:{isFocusProp:{type:Boolean,default:!1},isFixedLine:{type:Boolean,default:!1},qIdProp:{type:[String,Number],default:""},replyContent:{type:String,default:""},answer:{type:Object,default:()=>({})}},setup:()=>({}),data:()=>({submitCommentFlag:!1,placeholderValue:"发表评论",isFocus:!1,commentContent:"",showBottomLine:!1}),computed:{qDetailData(){return this.$store.getters["q/getQDetailData"]||{}},isPassedExam(){return this.$store.getters["q/getIsPassedExam"]}},watch:{replyContent(t){t&&(this.commentContent=t,this.isFocus=!0,this.eleFocus())},isFocusProp(t){this.isFocus=t,this.eleFocus()}},mounted(){this.isFocusProp&&(this.isFocus=!0,this.eleFocus()),this.replyContent&&(this.commentContent=this.replyContent,this.isFocus=!0)},methods:{eleFocus(){const{textInputref:t}=this.$refs;t&&this.isFocus&&this.$nextTick(()=>{t.focus()})},cancelSubmit(){this.freshComment("cancel")},submitComment(){if(this.submitCommentFlag)return;if(!this.commentContent.trim())return void n.Message.error({message:"评论内容不能为空！"});this.submitCommentFlag=!0;const t=this.$store.getters["global/userToken"]||"";this.$store.dispatch("q/handleContentVerify",{content:this.commentContent}).then(()=>{this.$store.dispatch("q/submitComment",{content:this.commentContent,answerId:this.answer.id,userToken:t}).then(({comment:t})=>{n.Message.success({message:"评论成功"}),this.$store.commit("q/updateAnswerComments",{answerId:this.answer.id,comment:t,type:"add"}),this.submitCommentFlag=!1,this.freshComment("add")}).catch(()=>{this.submitCommentFlag=!1,n.Message.error({message:"提交失败，请重试!"})})}).catch(t=>{this.submitCommentFlag=!1,n.Message.error({message:t.msg||"敏感词校验失败"})})},freshComment(t){this.commentContent="",this.isFocus=!1,this.showBottomLine=!1,this.$emit("onFreshComment",t)},focusInput(){this.isFocus=!0,this.showBottomLine=!0},blusInput(){}}}),U=Object(m.a)(B,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.answer.id?i("div",{staticClass:"comment-input-container",class:[t.isFocus&&t.isFixedLine?"need-shadow":""]},[!1===t.isPassedExam?i("div",{staticClass:"need-exam-area"},[t._m(0)]):!0===t.qDetailData.is_muted_user?i("div",{staticClass:"need-exam-area"},[i("span",[t._v("\n      禁言期无法发言\n    ")])]):!0===t.isPassedExam?[i("div",{staticClass:"input-wrapper"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],ref:"textInputref",staticClass:"input-box-default",class:[t.isFocus?"input-box-active":"input-box-blus"],attrs:{placeholder:t.isFocus?"":"发表评论"},domProps:{value:t.commentContent},on:{focus:t.focusInput,blur:t.blusInput,input:function(e){e.target.composing||(t.commentContent=e.target.value)}}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.commentContent.length>0||t.showBottomLine,expression:"commentContent.length > 0 || showBottomLine"}],staticClass:"ope-line"},[t._m(1),t._v(" "),i("div",{staticClass:"btn-list"},[i("div",{staticClass:"btn-item btn-cancel",on:{click:t.cancelSubmit}},[t._v("\n          取消\n        ")]),t._v(" "),i("div",{staticClass:"btn-item btn-submit",on:{click:t.submitComment}},[t._v("\n          评论\n        ")])])])]:t._e()],2):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v("\n      你需要通过考试才能发言，请\n      "),e("a",{attrs:{href:"/q/convention",target:"_blank"}},[this._v("进入考试")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"gongyue"},[e("span",[this._v("请遵守")]),this._v(" "),e("a",{attrs:{href:"https://km.woa.com/themes/10000",target:"_blank"}},[this._v("《乐问公约》")])])}],!1,null,"f895af44",null).exports,H=i(2005),V=i(2007),z=i(168),G=Object(a.c)({name:"SingleComment",components:{badgeTwitter:V.a},filters:{},props:{commentType:{type:[String],default:"default"},listNumber:{type:Number,default:1},currentComment:{type:Object,default:()=>({})},answer:{type:Object,default:()=>({})},isAdmin:{type:Boolean,default:!1},isSelf:{type:Boolean,default:!1},closeComment:{type:Boolean,default:!1}},setup(t,e){const{userCardItem:i,renderUserCard:a}=Object(H.a)(e,{idKey:"created_by",refKey:"comment_item"});return{userCardItem:i,renderUserCard:a}},data:()=>({showMoreDialog:!1,showMoreTimer:null,comment:null,agreeHover:!1,commentExpanded:!1}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null},qId(){return this.$store.getters["q/getQId"]||""},convertContent:()=>t=>Object(z.d)(Object(z.f)(t))},mounted(){this.comment=this.currentComment},methods:{mouseEnterFn(){this.agreeHover=!0},mouseLeaveFn(){this.agreeHover=!1},voteComment(t){this.comment.has_agreed?this.$store.dispatch("q/unvoteComment",{commentId:this.comment.id}).then(({agree_count:e})=>{this.comment.agree_count=e,n.Message.success({message:"取消点赞成功!"}),this.comment.has_agreed=!1,"hot"!==t&&this.$store.commit("q/updateAnswerHotComment",{answerId:this.answer.id,commentId:this.comment.id,hasAgreed:this.comment.has_agreed,agreeCount:this.comment.agree_count}),Object(F.b)("answerComentAgree",{question_id:this.qId,answer_id:this.answer.id,comment_id:this.comment.id,author_nick:this.comment.created_by,operation_type:"disAgree"})}).catch(()=>{n.Message.error({message:"取消点赞失败,请稍后重试"})}):this.$store.dispatch("q/voteComment",{commentId:this.comment.id}).then(({agree_count:e})=>{this.comment.agree_count=e,n.Message.success({message:"点赞成功!"}),this.comment.has_agreed=!0,"hot"!==t&&this.$store.commit("q/updateAnswerHotComment",{answerId:this.answer.id,commentId:this.comment.id,hasAgreed:this.comment.has_agreed,agreeCount:this.comment.agree_count}),Object(F.b)("answerComentAgree",{question_id:this.qId,answer_id:this.answer.id,comment_id:this.comment.id,author_nick:this.comment.created_by,operation_type:"agree"})}).catch(()=>{n.Message.error({message:"点赞失败,请稍后重试"})})},replyComment(){if(this.$emit("onReplyComment",this.comment),0!==this.listNumber)return;const t=window.innerHeight,{replyBtnRef:e}=this.$refs,i=null==e?void 0:e.getBoundingClientRect();if(i.top>300){t-i.top-40<150&&window.scrollTo(0,window.scrollY+180)}},deleteComment(){this.$newConfirm("warning","确认删除该评论？",{confirm:()=>{const t=Number(this.comment.id),e=this.$store.getters["global/userToken"]||"";this.$store.dispatch("q/deleteComment",{commentId:t,userToken:e}).then(()=>{n.Message.success({message:"删除评论成功"}),this.$store.commit("q/updateAnswerComments",{answerId:this.answer.id,comment:this.comment,type:"delete"}),Object(F.b)("answerComent",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"deleteComment"})}).catch(()=>{n.Message.error({message:"删除评论失败"})})}})},openMoreListArea(){this.showMoreDialog=!0,this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseenter(){this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseleave(){this.showMoreTimer&&clearTimeout(this.showMoreTimer),this.showMoreDialog&&(this.showMoreTimer=setTimeout(()=>{this.showMoreDialog=!1},200))}}}),K=Object(m.a)(G,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.comment?i("div",{staticClass:"item comment-rich-ref",class:["hot"===t.commentType?"hot-item-type":"default-item-type"]},["hot"===t.commentType?[i("div",{staticClass:"hot-left"},[i("div",{class:["comment-info",t.commentExpanded&&"comment-info-expanded"],on:{click:function(){return t.commentExpanded=!t.commentExpanded}}},[i("a",{staticClass:"user-nick",attrs:{target:"_blank",href:"/user/"+t.comment.created_by}},[t._v("\n          "+t._s(t.comment.created_by)+"\n          "),t.comment.is_expert?i("span",{staticClass:"info-icon"},[i("svg-icon",{attrs:{name:"q/expert_user",width:16,height:16}})],1):t._e(),t._v("\n          "+t._s(": ")+"\n        ")]),t._v(" "),i("span",{staticClass:"content",domProps:{innerHTML:t._s(t.convertContent(t.comment.content))}})])]),t._v(" "),i("div",{staticClass:"hot-right",class:[t.comment.has_agreed?"hot-right-active":""],on:{click:function(e){return t.voteComment("hot")},mouseenter:function(e){return t.mouseEnterFn()},mouseleave:function(e){return t.mouseLeaveFn()}}},[i("svg-icon",{staticClass:"info-icon",class:[t.comment.has_agreed||t.agreeHover?"show-hover":"hide-hover"],attrs:{name:"q/hot_active",width:20,height:20}}),t._v(" "),i("svg-icon",{staticClass:"info-icon",class:[t.comment.has_agreed||t.agreeHover?"hide-hover":"show-hover"],attrs:{name:"q/hot_default",width:20,height:20}}),t._v(" "),i("span",{staticClass:"count"},[t._v(t._s(t.comment.agree_count||0))])],1)]:"default"===t.commentType?[i("div",{ref:"comment_item"+t.comment.created_by,staticClass:"user-img",on:{mouseenter:function(e){return t.renderUserCard(t.comment,t.comment.created_by,t.comment.id)},mouseleave:function(e){return t.renderUserCard(t.comment)}}},[i("badge-twitter",{attrs:{"check-unique-key":"",width:38,"unique-key":"comment_item"+t.comment.created_by+t.comment.id,"user-data":t.userCardItem,"show-attention":!0}}),t._v(" "),i("img",{attrs:{src:t._f("assetAvatar")(t.comment.created_by)}})],1),t._v(" "),i("div",{staticClass:"right-part"},[i("div",{staticClass:"comment-info"},[i("a",{staticClass:"user-nick",attrs:{target:"_blank",href:"/user/"+t.comment.created_by}},[t._v("\n          "+t._s(t.comment.created_by)+"\n          "),t.comment.is_expert?i("span",{staticClass:"info-icon"},[i("svg-icon",{attrs:{name:"q/expert_user",width:16,height:16}})],1):t._e()]),t._v(" "),i("span",{staticClass:"content",domProps:{innerHTML:t._s(t.convertContent(t.comment.content))}}),t._v(" "),i("div",{staticClass:"ope-line"},[i("t-popup",{attrs:{content:t.comment.modified}},[i("span",{staticClass:"time"},[t._v(t._s(t.comment.display_created_at))])]),t._v(" "),i("div",{staticClass:"ope-right"},[i("div",{staticClass:"agree-btn  common-ope",class:[t.comment.has_agreed?"agree-btn-active":""],on:{click:function(e){return t.voteComment("default")},mouseenter:function(e){return t.mouseEnterFn()},mouseleave:function(e){return t.mouseLeaveFn()}}},[i("svg-icon",{staticClass:"info-icon",class:[t.comment.has_agreed||t.agreeHover?"show-hover":"hide-hover"],attrs:{name:"q/hot_active",width:20,height:20}}),t._v(" "),i("svg-icon",{staticClass:"info-icon",class:[t.comment.has_agreed||t.agreeHover?"hide-hover":"show-hover"],attrs:{name:"q/hot_default",width:20,height:20}}),t._v(" "),i("span",{staticClass:"count"},[t._v(t._s(t.comment.agree_count||0))])],1),t._v(" "),t.isSelf||t.closeComment?t._e():i("div",{ref:"replyBtnRef",staticClass:"comment-btn common-ope",on:{click:t.replyComment}},[i("svg-icon",{staticClass:"info-icon info-icon-default",attrs:{name:"q/apply_answer",width:20,height:20}}),t._v(" "),i("svg-icon",{staticClass:"info-icon info-icon-hover",attrs:{name:"q/apply_answer_hover",width:20,height:20}})],1),t._v(" "),t.isSelf||t.isAdmin?i("div",{staticClass:"ope-more-type common-ope",on:{mouseenter:t.openMoreListArea,mouseleave:t.handelMoreMouseleave}},[i("svg-icon",{staticClass:"info-icon info-icon-default",attrs:{name:"q/more_ope",width:20,height:20}}),t._v(" "),i("svg-icon",{staticClass:"info-icon info-icon-hover",attrs:{name:"q/more_ope_hover",width:20,height:20}}),t._v(" "),t.showMoreDialog?i("div",{staticClass:"more-ope-list common-child-ope-list",on:{mouseenter:t.handelMoreMouseenter,mouseleave:t.handelMoreMouseleave}},[i("ul",[t.isSelf?i("li",{staticClass:"item",on:{click:t.deleteComment}},[i("span",{staticClass:"text"},[t._v("删除")])]):t._e(),t._v(" "),t.isAdmin?i("li",{staticClass:"item"},[i("a",{staticClass:"text",attrs:{href:"/comment_admin/manage/"+t.comment.id,target:"_blank"}},[t._v("管理")])]):t._e()])]):t._e()],1):t._e()])],1)])])]:t._e()],2):t._e()}),[],!1,null,"4fdd5961",null).exports,W=Object(a.c)({name:"AnswerEditorMod",components:{richEditor:D.a,elSelect:n.Select,elOption:n.Option,trilobiteEditorMod:q.a},filters:{},props:{qIdProp:{type:[String,Number],default:""},answer:{type:Object,default:()=>({})},editorType:{type:String,default:"addType"}},setup:()=>({}),data(){return{submitUserAnswerFlag:!1,isFocus:!1,closeComment:!1,contentModel:"",signLen:30,loadIntroEditor:!1,editorConfigs:{min_height:280,max_height:300,setup:this.richSetup,invalid_styles:"font-family",customToolbars:"removeformat | bold italic underline forecolor | link lximg lxcodesample | lxalign bullist numlist |  code  fullscreen "},richContentStr:"",richContentText:"",deptValue:"",identityTips:!1,currentTiny:null,isNotice:!1,noticeIntro:"",isNewEditor:!0}},computed:{trilobiteEditOpen(){return this.$store.getters["q/getTrilobiteEditOpen"]},trilobitePreviewOpen(){return this.$store.getters["q/getTrilobitePreviewOpen"]},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}},isPassedExam(){return this.$store.getters["q/getIsPassedExam"]},userTitle(){return this.$store.getters["q/getUserTitle"]||[]},qId(){return this.qIdProp||this.$store.getters["q/getQId"]||""},restCount(){return this.currentQUserInfo.q_signature.length>this.signLen?0:this.signLen-this.currentQUserInfo.q_signature.length},currentQUserInfo(){return this.$store.getters["q/getCurrentQUserInfo"]||null}},watch:{userTitle(t){t&&t.length>0&&this.renderPositionList(t)}},created(){1!==this.trilobiteEditOpen?this.isNewEditor=!1:"updateType"===this.editorType&&"iWiki"===this.answer.editor_type||"addType"===this.editorType?this.isNewEditor=!0:this.isNewEditor=!1},mounted(){this.userTitle.length>0&&this.renderPositionList(this.userTitle),this.loadIntroEditor=!0,"updateType"===this.editorType&&(this.contentModel=this.answer.contentOrigin||"",this.richContentStr=this.contentModel,this.richContentText=this.contentModel,this.$nextTick(()=>{"iWiki"===this.answer.editor_type&&this.isNewEditor&&this.updateEditorContent(this.answer.json_content)})),this.$store.dispatch("q/fetchAnswerIntro",{qId:this.qId}).then(t=>{this.isNotice=t.is_notice,this.noticeIntro=t.notice_intro}).catch(()=>{}),setTimeout(()=>{window.tinymceImgConfig=window.tinymceImgConfig||{},window.tinymceImgConfig.block=7},80),this.closeComment=1===this.answer.is_close_comment},methods:{updateEditorContent(t){this.$refs.trilobiteRef.updateContent(t)},renderPositionList(t){if(!(this.deptValue.length>0))if("updateType"===this.editorType){if(!this.answer.is_author)return void(this.deptValue=t[0].name);let e=this.answer.position_title||"";"不显示"!==e&&""!==e||(e="不带身份回答");const i=t.every(t=>t.name!==e);this.identityTips=i,this.identityTips?this.deptValue=t[0].name:this.deptValue=e}else"addType"===this.editorType&&(t[1]?this.deptValue=t[1].name:this.deptValue=t[0].name)},freshAnswer(){this.contentModel="",this.richContentStr="",this.richContentText="",this.currentTiny&&this.currentTiny.setContent&&this.currentTiny.setContent("")},getEditorContent(){return this.$refs.trilobiteRef.provideContent()},submitUserAnswer(){if(this.submitUserAnswerFlag)return;if(this.isNewEditor){if(this.$refs.trilobiteRef.checkIsContentEmpty())return void n.Message.error({message:"回答内容不能为空！"})}else{if(!this.richContentStr.trim())return void n.Message.error({message:"回答内容不能为空！"});const t=/<img[^>]*>/gi,e=this.richContentText.trim(),i=this.richContentStr.trim().replace(/<\s*br\s*\/?>/gi,"");if(!e&&!t.exec(i)||!i||/^<div>(&nbsp;(\s)*)*<\/div>$/i.test(i)||/^(&nbsp;(\s)*)+$/.test(i))return void n.Message.error({message:"回答内容不能为空！"})}if(!this.deptValue)return void n.Message.error({message:"请选择身份回答"});this.submitUserAnswerFlag=!0;const t=this.$store.getters["global/userToken"]||"",e=this.isNewEditor?"q/submitAnswerNew":"q/submitAnswer",i=this.isNewEditor?"q/editAnswerNew":"q/editAnswer",a=this.isNewEditor?this.getEditorContent():this.richContentStr,s=this.isNewEditor?this.$refs.trilobiteRef.provideTextContent():"";this.$store.dispatch("q/handleContentVerify",{content:this.isNewEditor?s:a}).then(()=>{"addType"===this.editorType?this.$store.dispatch(e,{content:a,userToken:t,id:this.qId,closeComment:this.closeComment,positionTitle:this.deptValue}).then(({answer:t})=>{n.Message.success({message:"回答成功"}),this.$store.commit("q/updateQuestionIsAnswered",{isAnswered:!0,answerId:t.id}),this.$store.commit("q/updateOneAnswerItem",{answer:t,type:"add"}),this.freshAnswer(),this.checkIsShowHeart(),this.submitUserAnswerFlag=!1,Object(F.b)("questionAnswer",{question_id:this.qId,answer_id:t.id}),setTimeout(()=>{window.location.href=window.location.href},500)}).catch(()=>{this.submitUserAnswerFlag=!1,n.Message.error({message:"提交失败，请重试!"})}):"updateType"===this.editorType&&this.$store.dispatch(i,{content:a,userToken:t,answerId:this.answer.id,closeComment:this.closeComment,positionTitle:this.deptValue}).then(({})=>{n.Message.success({message:"更新回答成功"}),this.freshAnswer(),this.submitUserAnswerFlag=!1,setTimeout(()=>{window.location.href=window.location.href},200),Object(F.b)("answerEdit",{question_id:this.qId,answer_id:this.answer.id})}).catch(()=>{this.submitUserAnswerFlag=!1,n.Message.error({message:"更新回答失败，请重试!"})})}).catch(t=>{this.submitUserAnswerFlag=!1,n.Message.error({message:t.msg||"敏感词校验失败"})})},checkIsShowHeart(){this.$store.dispatch("q/fetchThanksIntro",{}).then(()=>{}).catch(()=>{})},focusInput(){this.isFocus=!0},blusInput(){this.isFocus=!1;const t=this.$store.getters["global/userToken"]||"";this.$store.dispatch("q/saveQSignature",{signValue:this.currentQUserInfo.q_signature.substr(0,this.signLen),userToken:t}).then(({state:t})=>{1===t&&n.Message.success({message:"修改签名成功"})}).catch(()=>{n.Message.error({message:"修改签名失败，请稍后再试"})})},showEditSign(){this.isFocus=!0,this.$nextTick(()=>{const{signEle:t}=this.$refs;t&&t.focus()})},richSetup(t){this.currentTiny=t,t.on("change",t=>{this.richContentStr=t.target.getContent(),this.richContentText=t.target.getContent({format:"text"})})}}}),Q=Object(m.a)(W,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"answer-editor-container",class:["addType"===t.editorType?"answer-editor-container-add":"answer-editor-container-edit"]},[t.currentQUserInfo&&t.currentQUserInfo.nick?i("div",{staticClass:"top-area"},[i("div",{staticClass:"identity-info"},[i("a",{staticClass:"user-img",attrs:{href:"/user/"+t.currentQUserInfo.nick,target:"_blank"}},[i("img",{attrs:{src:t._f("assetAvatar")(t.currentQUserInfo.nick)}})]),t._v(" "),i("a",{staticClass:"user-name",attrs:{href:"/user/"+t.currentQUserInfo.nick,target:"_blank"}},[t._v("\n        "+t._s(t.currentQUserInfo.nick)+"\n      ")]),t._v(" "),t.currentQUserInfo.is_expert?i("span",{staticClass:"info-icon",attrs:{title:"专家"}},[i("svg-icon",{attrs:{name:"q/expert_user",width:16,height:16}})],1):t._e(),t._v(" "),t.currentQUserInfo.is_best_user?i("span",{staticClass:"info-icon",attrs:{title:"优秀答主"}},[i("svg-icon",{attrs:{name:"q/best_user",width:16,height:16}})],1):t.currentQUserInfo.is_ten_thousand_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"万赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2401/5c41b70f25044edb.png"}})]):t.currentQUserInfo.is_thousand_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"千赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2312/db28244eea6d40a7.png"}})]):t.currentQUserInfo.is_hundred_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"百赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2312/7b51ad931db44494.png"}})]):t._e()]),t._v(" "),i("div",{staticClass:"dept-list",attrs:{title:t.deptValue||""}},[i("el-select",{attrs:{placeholder:"请选择身份",size:"mini"},model:{value:t.deptValue,callback:function(e){t.deptValue=e},expression:"deptValue"}},t._l(t.userTitle,(function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t.name}})})),1)],1),t._v(" "),t.currentQUserInfo&&t.currentQUserInfo.nick&&"addType"===t.editorType?i("div",{staticClass:"sign-area"},[t.currentQUserInfo.is_best_user?[i("div",{staticClass:"sign-show"},[i("div",{staticClass:"sign-text",attrs:{title:t.currentQUserInfo.best_user_title||""}},[t._v("\n            "+t._s(t.currentQUserInfo.best_user_title||"")+"\n          ")])])]:t.currentQUserInfo.is_thousand_agreed_user||t.currentQUserInfo.is_hundred_agreed_user||t.currentQUserInfo.is_headline_user?[t.isFocus?i("div",{staticClass:"sign-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.currentQUserInfo.q_signature,expression:"currentQUserInfo.q_signature"}],ref:"signEle",staticClass:"input-item",class:[t.isFocus?"input-box-active":"input-box-blus"],attrs:{type:"text",name:"username",maxlength:"30"},domProps:{value:t.currentQUserInfo.q_signature},on:{focus:t.focusInput,blur:t.blusInput,input:function(e){e.target.composing||t.$set(t.currentQUserInfo,"q_signature",e.target.value)}}}),t._v(" "),i("span",[t._v("余"+t._s(t.restCount)+"字")])]):i("div",{staticClass:"sign-show sign-show-hover",on:{click:t.showEditSign}},[i("div",{staticClass:"sign-text",attrs:{title:t.currentQUserInfo.q_signature||"写一句话来描述自己：身份title、擅长领域等。"}},[t._v("\n            "+t._s(t.currentQUserInfo.q_signature||"写一句话来描述自己：身份title、擅长领域等。")+"\n          ")]),t._v(" "),i("svg-icon",{staticClass:"sign-edit-btn",attrs:{name:"q/sign_edit",width:16,height:16}})],1)]:t._e()],2):t._e()]):t._e(),t._v(" "),"updateType"===t.editorType&&t.identityTips?i("div",{staticClass:"no-match-old"},[t._v("\n    原回答身份已不存在，已更改为不带身份回答\n  ")]):t._e(),t._v(" "),t.isNotice?i("div",{staticClass:"tag-owner-tip"},[t._v("\n    "+t._s(t.noticeIntro)+"\n  ")]):t._e(),t._v(" "),!0===t.isPassedExam&&!1===t.qDetailData.is_muted_user?[i("div",{staticClass:"editor-area"},[t.isNewEditor?i("div",{staticClass:"answer-trilobite-wrapper"},[i("trilobiteEditorMod",{ref:"trilobiteRef",attrs:{"editor-type":"add",appearance:"comment","business-type":"input-business-type-question","img-block-id":7}},[i("p",[t._v("no comment editor")])])],1):i("rich-editor",{attrs:{"is-load":t.loadIntroEditor,configs:t.editorConfigs},model:{value:t.contentModel,callback:function(e){t.contentModel=e},expression:"contentModel"}})],1),t._v(" "),i("div",{staticClass:"submit-area"},[i("div",{staticClass:"select-is-close",on:{click:function(e){t.closeComment=!t.closeComment}}},[t.closeComment?i("svg-icon",{staticClass:"close-comment",attrs:{name:"q/radio_y",width:20,height:20}}):i("svg-icon",{staticClass:"open-comment",attrs:{name:"q/radio_n",width:20,height:20}}),t._v(" "),i("span",{staticClass:"text"},[t._v("关闭评论")])],1),t._v(" "),i("div",{staticClass:"right-part"},[t._m(0),t._v(" "),i("div",{staticClass:"submit-btn",on:{click:t.submitUserAnswer}},[t._v("\n          "+t._s("addType"===t.editorType?"回答":"updateType"===t.editorType?"更新回答":"")+"\n        ")])])])]:t._e(),t._v(" "),!0===t.qDetailData.is_muted_user?i("div",{staticClass:"need-exam-area"},[i("span",[t._v(" 禁言期无法发言 ")])]):!1===t.isPassedExam?i("div",{staticClass:"need-exam-area"},[t._m(1)]):t._e()],2)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"agreement-line"},[this._v("\n          请遵守\n          "),e("a",{attrs:{href:"/themes/10000",target:"_blank"}},[this._v("《 乐问公约 》")]),this._v("\n          约定，真诚友善回答\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v("\n      你需要通过考试才能发言，请\n      "),e("a",{attrs:{href:"/q/convention",target:"_blank"}},[this._v("进入考试")])])}],!1,null,"5b667b42",null).exports,J=Object(a.c)({name:"edit-answer-mod",data:()=>({showInvite:!0}),props:{answer:{type:Object,default:()=>({})},qIdProp:{type:[String,Number],default:""}},components:{venomPopup:c.a,answerEditorMod:Q},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}}},mounted(){},methods:{sendInvite(){this.showInvite=!1},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),Y=Object(m.a)(J,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container edit-answer-mod-container"},[t.showInvite?i("venom-popup",[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("编辑回答")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),t.answer.id&&t.qDetailData&&t.qDetailData.question?i("div",{staticClass:"select-content"},[i("div",{staticClass:"q-title"},[t._v(t._s(t.qDetailData.question.title))]),t._v(" "),i("div",{staticClass:"small-line"}),t._v(" "),i("div",{staticClass:"edit-wrapper"},[i("answer-editor-mod",{attrs:{"editor-type":"updateType",answer:t.answer}})],1)]):t._e()])])]):t._e()],1)}),[],!1,null,"40993071",null).exports,X=Object(a.c)({name:"useless-answer-mod",data:()=>({showInvite:!0,inviteeName:[],inviteReason:"",showErrTips:!1}),props:{qIdProp:{type:[String,Number],default:""},answer:{type:Object,default:()=>({})}},components:{venomPopup:c.a,elInput:n.Input},setup:()=>({}),computed:{userInfo(){return this.$store.getters["global/userInfo"]||null}},mounted(){},methods:{sendInvite(){if(!this.inviteReason.trim())return void n.Message.error({message:"请填写原因"});const t=this.$store.getters["global/userToken"]||"";this.$store.dispatch("q/downvoteAnswer",{answerId:this.answer.id,userToken:t,note:this.inviteReason}).then(t=>{n.Message.success({message:"操作没有帮助成功！"}),this.showInvite=!1,this.$emit("onSaveMod",t)}).catch(()=>{n.Message.error({message:"操作没有帮助失败,请稍后重试"})})},closeInviteDialog(){this.showInvite=!1,this.$emit("onCloseMod")}},filters:{}}),Z=Object(m.a)(X,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common-invite-container"},[t.showInvite?i("venom-popup",{on:{close:t.closeInviteDialog}},[i("div",{staticClass:"invite-dialog-wrapper"},[i("div",{staticClass:"invite-content"},[i("div",{staticClass:"select-tips"},[i("span",{staticClass:"tips-text"},[t._v("没有帮助")]),t._v(" "),i("span",{staticClass:"select-close-icon",on:{click:t.closeInviteDialog}},[i("svg-icon",{attrs:{name:"kbar/edit/select_close",width:21,height:21}})],1)]),t._v(" "),i("div",{staticClass:"select-content"},[i("div",{staticClass:"invite-name-area"},[i("span",{staticClass:"highly-tag"},[t._v("*")]),t._v(" "),i("span",{staticClass:"text"},[t._v('\n              你认为该回答"没有帮助"的原因是？\n            ')])]),t._v(" "),i("div",{staticClass:"reason-input"},[i("el-input",{attrs:{placeholder:"请写明原因，如：答非所问/不友善/乱抖机灵等",type:"textarea",rows:3},model:{value:t.inviteReason,callback:function(e){t.inviteReason=e},expression:"inviteReason"}})],1),t._v(" "),i("div",{staticClass:"btn-line"},[i("span",{staticClass:"text"}),t._v(" "),i("div",{staticClass:"save-select"},[i("div",{staticClass:"cancel-select-btn btn",on:{click:t.closeInviteDialog}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"save-select-btn btn",on:{click:t.sendInvite}},[t._v("确定")])])])])])])]):t._e()],1)}),[],!1,null,"fce17732",null).exports;const tt=(t,e)=>{let i;return function(){const a=this,s=arguments;i||(i=setTimeout((function(){t.apply(a,s),i=null}),e))}};let et=null;const it=(t,e)=>{const i=document.querySelectorAll(t);et||(et=new IntersectionObserver((function(t){t.forEach(t=>{if(t.intersectionRatio>0){(t=>{const e=t.getAttribute("data-src"),i=t.getAttribute("data-have-load");t.removeAttribute("data-no-src"),e&&!i&&(t.classList.remove("lazy-img-temp"),t.src=e,t.setAttribute("data-have-load",!0))})(t.target)}})}),{rootMargin:"800px 0px"})),i.forEach(t=>{t.alt="",t.src||t.getAttribute("data-no-src")||(t.classList.add("lazy-img-temp"),((t,e)=>{const i=e&&e.viewContentWidth;let a=t.getAttribute("data-src");const s=Object(z.i)(a);t.setAttribute("data-origin-width",s.width||0),t.setAttribute("data-origin-height",s.height||0),t.setAttribute("data-no-src","true");if(t.getAttribute("width"))return;let n=0,o=0;if(s.width&&s.height){if(s.width>i&&i>0){const e=i/s.width,a=s.height*e;t.width=i,t.height=a,n=i,o=a}else s.width&&s.width>0&&(t.width=s.width,n=s.width),s.height&&s.height>0&&(t.height=s.height,o=s.height);if(n&&o){const e=window.devicePixelRatio&&window.devicePixelRatio>1?2:1,i=parseInt(n,10)*e,s=parseInt(o,10)*e;a=a.indexOf("?")>0?`${a}&imageMogr2/thumbnail/${i}x${s}>/ignore-error/1`:`${a}?imageMogr2/thumbnail/${i}x${s}>/ignore-error/1`,t.setAttribute("data-src",a)}}})(t,{viewContentWidth:e&&e.viewContentWidth}))}),i.forEach(t=>{t.alt="",t.src||et.observe(t)})},at=(t,e)=>{let i=t;if("string"==typeof t&&(i=document.getElementsByClassName(""+t)[0]),!i)return;const a=i.getBoundingClientRect(),s=window.innerHeight;let n=50,o=90;e&&(n=e.deltaTop||n,o=e.deltaBottom||o);let r=!1,l=!1,c=!1;if(a.bottom<0)l=!1,c=!1,r=!1;else{l=!(a.top<0)&&a.top-s<0;if(a.bottom-s<=0)c=!0,r=!1;else if(c=!1,a.top<0)r=!0;else if(a.top-s<0)if(e)if(e.deltaTopElement){const t=e.deltaTopElement.getBoundingClientRect();r=t.bottom>0&&s-t.bottom>o}else r=!(a.top>n);else r=!(a.top>n);else r=!1}return Object.assign({},{eleBottomInViewport:c,eleTopInViewport:l,needSticky:r,windowHeight:s,offsetTop:i.offsetTop,height:a.height,top:a.top,bottom:a.bottom})};var st=i(2031),nt=Object(a.c)({name:"AnswerListMod",components:{commentMod:U,singleComment:K,qComplaintMod:b,editAnswerMod:Y,uselessAnswerMod:Z,badgeTwitter:V.a},filters:{},props:{isAnswerPage:{type:Boolean,default:!1},answer:{type:Object,default:()=>({})},qId:{type:[String,Number],default:""}},setup(t,e){const{userCardItem:i,renderUserCard:a}=Object(H.a)(e,{idKey:"created_by",refKey:"answer_item"});return{userCardItem:i,renderUserCard:a}},data:()=>({noFixedBottomLineheight:48,pageWidth:1100,bodyWidth:1500,answerModel:null,showUselessMod:!1,showAttitudeTimer:null,currentUsableAttitudesModalType:0,showUsableAttitudesModal:!1,showMoreDialog:!1,showMoreTimer:null,showAllAgreeUsers:!1,lockAgreeClick:!1,initAgreeUsersCount:5,updateAgreedTag:!1,currentCommentSort:"created",lastCommentSort:"created",isShowHotType:!0,commentsLimit:50,showEditAnswerDialog:!1,replyContent:"",showComplaintDialog:!1,hasTitleIcon:!0,canShowAttitude:!0,answerDomKey:"answer-scroll-id-",bottomLineTag:!1,lastBottomAnswer:null,nextBottomAnswer:null,richImgMaxWidth:710,fixedCommentBottomLine:!1,isShowLoadTips:!1,attitudeDir:"up",openCommentFocus:!1,answerComplained:!1}),computed:{trilobiteEditOpen(){return this.$store.getters["q/getTrilobiteEditOpen"]},trilobitePreviewOpen(){return this.$store.getters["q/getTrilobitePreviewOpen"]},reportNick(){return this.qDetailData.question.is_anonymous?"匿名用户":this.qDetailData.question.author_info.nick},fixedStyleObj(){if(this.bottomLineTag){return{marginLeft:(this.bodyWidth-this.pageWidth)/2+"px"}}return{}},answersList(){return this.$store.getters["q/getAnswers"]||[]},answerAttitudesMap(){return this.$store.getters["q/getAnswerAttitudesMap"]||{}},commentsMap(){return this.$store.getters["q/getCommentsMap"]||{}},signatureInfo(){return this.answer.author_info.is_best_user&&"不显示"!==this.answer.position_title?"|  "+this.answer.author_info.best_user_info.title:this.answer.author_info.q_signature?"// "+this.answer.author_info.q_signature:""},hotTypeList(){let t=[];return t=(this.answer.hot_comments||[]).slice(0,2),t},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}},usableAnswerAttitudes(){return this.$store.getters["q/getUsableAnswerAttitudes"]||[]},userInfo(){return this.$store.getters["global/userInfo"]||{}},currentQUserInfo(){return this.$store.getters["q/getCurrentQUserInfo"]||null},convertContent:()=>t=>Object(z.d)(Object(z.f)(t))},watch:{answer:{deep:!0,handler(t){this.answerComplained=t.is_complained}}},mounted(){this.bodyWidth=document.body.clientWidth,this.answerModel=this.answer,this.isAnswerPage&&this.answer.comment_count>0&&(this.isShowHotType=!1,this.showAllCommentsFromCache()),this.currentCommentSort="created",this.$nextTick(()=>{this.initTrilobiteEditor(),this.initImagePreview()}),this.hookPageScroll(),it(`.km-view-content-simple-${this.answer.id} img`,{viewContentWidth:710}),window.addEventListener("resize",this.dealWinResize)},methods:{initTrilobiteEditor(){const t=this.answer.json_content;if("iWiki"!==this.answer.editor_type||!t||1!==this.trilobiteEditOpen)return;const e={container:"#answer-json-content-id-"+this.answer.id,appearance:"comment",language:"zh",value:t,model:"preview",clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},plugins:[new window.ImagePlugin,new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})],pluginsSettings:{featureFlag:{allowTables:!1,allowEmoji:!1,allowBlockType:!1,allowFontSize:!1,allowTextAlignment:!1,allowTextHighlight:!1,allowFindReplace:!1}}};this.trilobiteObjForContent=new window.TrilobiteEditor(e)},dealWinResize(){this.bodyWidth=document.body.clientWidth},loadNextComments(){if(!this.commentsMap||!this.commentsMap[this.answer.id])return;const t=this.commentsMap[this.answer.id];t.isEnd||this.$store.dispatch("q/fetchAllCommentsNew",{type:this.currentCommentSort,answerId:this.answer.id,isFresh:!1,page:t.page+1}).then(()=>{}).catch(()=>{n.Message.error({message:"加载评论失败，请稍后重试！"})})},initImagePreview(){const{contentTextArea:t}=this.$refs;if(!t)return;const e=t.querySelectorAll("img");for(const t of e){var i;"IMG"===t.tagName&&"A"!==(null===(i=t.parentNode)||void 0===i?void 0:i.tagName)&&t.classList.add("amplify")}},handleClickRichImg(t){var e;if(!t||!t.target)return;const{target:i}=t;if("IMG"===i.tagName&&"A"!==(null===(e=i.parentNode)||void 0===e?void 0:e.tagName)){const t=window.decodeURIComponent(i.src).replace(/imageMogr2\/thumbnail\/(\S)*>\/ignore-error\/1/gi,"imageMogr2/thumbnail/4096x>/ignore-error/1");st.a.show({src:t})}},jumpAnswerItem(t){if(!t)return;const e=document.getElementsByClassName(`${this.answerDomKey}${t.id}`);e&&e[0]&&e[0].scrollIntoView({behavior:"smooth"})},jumpToCommentArea(){const{commentListWrapper:t}=this.$refs;t&&t.scrollIntoView()},operateCollect(){this.answerModel.has_bookmarked?this.$store.dispatch("q/unbookMarkAnswer",{answerId:this.answer.id}).then(t=>{1===t.affected&&(n.Message.success({message:"取消收藏成功！"}),this.$nextTick(()=>{this.answerModel.has_bookmarked=!1,this.answerModel.bookmark_count=this.answerModel.bookmark_count-1}),Object(F.b)("answerBookmark",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"cancelBookmark"}))}).catch(()=>{n.Message.error({message:"取消收藏失败,请稍后重试"})}):this.$store.dispatch("q/bookMarkAnswer",{answerId:this.answer.id}).then(t=>{1===t.affected&&(n.Message.success({message:"收藏成功！"}),this.$nextTick(()=>{this.answerModel.has_bookmarked=!0,this.answerModel.bookmark_count=(this.answerModel.bookmark_count||0)+1}),Object(F.b)("answerBookmark",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"bookmark"}))}).catch(()=>{n.Message.error({message:"收藏失败,请稍后重试"})})},hookPageScroll(){this.throttleFn&&window.removeEventListener("scroll",this.throttleFn),this.throttleFn=tt(this.handleScrollFn,100),window.addEventListener("scroll",this.throttleFn),this.$nextTick(()=>{this.handleScrollFn()})},handleScrollFn(){const{contentTextArea:t}=this.$refs;if(!t)return;const e=at(t);if(e&&e.needSticky){let t=-1;for(const e in this.answersList)if(Number(this.answersList[e].id)===Number(this.answer.id)){t=Number(e);break}t>-1&&(this.nextBottomAnswer=this.answersList[t+1]||null,t>0&&(this.lastBottomAnswer=this.answersList[t-1]||null)),this.bottomLineTag=!0}else this.bottomLineTag=!1;this.checkoutCommentSticky()},checkoutCommentSticky(){if(!this.isShowHotType){const{commentBottomArea:t}=this.$refs;if(!t)return;const e=t.querySelectorAll(".default-item-type");let i=null;e&&e.length>0&&(i=e[0]);const a=at(t,{deltaTopElement:i,deltaBottom:90});a&&a.needSticky?this.fixedCommentBottomLine=!0:this.fixedCommentBottomLine=!1}},saveUselessOpe(){this.showUselessMod=!1,this.answerModel.is_downvoted=!0},operateUseless(){if(!this.answerModel.is_downvoted)return void(this.showUselessMod=!0);const t=this.$store.getters["global/userToken"]||"";this.$store.dispatch("q/cancelDownvoteAnswer",{answerId:this.answer.id,userToken:t}).then(()=>{n.Message.success({message:"撤销没有帮助成功！"}),this.answerModel.is_downvoted=!1}).catch(()=>{n.Message.error({message:"撤销没有帮助失败,请稍后重试"})})},reportAttitudeOpe(t,e){Object(F.b)("answerShowAttitude",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,attitdue_id:t.id,attitdue_tittle:t.title||"",operation_type:e})},handleClickAttitude(t){this.showAttitudeTimer&&clearTimeout(this.showAttitudeTimer);const e=this.answerAttitudesMap[String(this.answer.id)],i=e&&e.myAttitude||"";i!==t.id?this.$store.dispatch("q/useAttitude",{attitudeId:t.id,id:this.answer.id,targetType:"answer"}).then(()=>{this.currentUsableAttitudesModalType=0,this.freshAttitude(),n.Message.success({message:"表态成功!"}),i?this.reportAttitudeOpe(t,"editAttitude"):this.reportAttitudeOpe(t,"addAttitude")}).catch(()=>{n.Message.error({message:"表态失败,请稍后重试"})}):this.handleDeleteAttitude(t)},handleDeleteAttitude(t){this.$store.dispatch("q/unuseAttitude",{id:this.answer.id,targetType:"answer"}).then(()=>{this.currentUsableAttitudesModalType=0,this.freshAttitude(),n.Message.success({message:"取消表态成功!"}),this.reportAttitudeOpe(t,"cancelAttitude")}).catch(()=>{n.Message.error({message:"取消表态失败,请稍后重试"})})},freshAttitude(){this.$store.dispatch("q/fetchBatchAttitudeSum",{list:[{targetId:this.answer.id,targetType:"answer"}]}).then(()=>{}).catch(()=>{})},editOwnAnswer(){this.showEditAnswerDialog=!this.showEditAnswerDialog},freshComment(t){if(this.replyContent="","cancel"!==t&&(Object(F.b)("answerComent",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"comment"}),this.fixedCommentBottomLine)){const{commentBottomArea:t}=this.$refs;if(!t)return;this.$nextTick(()=>{const e=t.querySelectorAll(".default-item-type");if(e&&e.length>0){e[e.length-1].scrollIntoView({behavior:"smooth",block:"center"})}})}},replyComment(t){t&&(this.replyContent=`回复@${t.created_by} : `)},openAnswerComment(){this.bottomLineTag&&this.jumpToCommentArea(),this.isShowHotType=!this.isShowHotType,this.isShowHotType||this.showAllCommentsFromCache(),this.loadHotComments()},packUpComment(t){if(this.loadHotComments(),this.isShowHotType=!0,"bottom"===t){const{noFixedBottomLine:t,topLineRef:e}=this.$refs;if(!t||!e)return;const i=at(e);i.eleBottomInViewport||i.eleTopInViewport||t.scrollIntoView({behavior:"smooth",block:"center"})}},loadHotComments(){this.$store.dispatch("q/fetchHotComments",{answerId:this.answer.id}).then(()=>{}).catch(()=>{})},showAllCommentsFromCache(){this.currentCommentSort="created",this.showAllComments()},showAllComments(){this.fixedCommentBottomLine=!1,this.isShowLoadTips=!0,this.$store.dispatch("q/fetchAllCommentsNew",{type:this.currentCommentSort,answerId:this.answer.id,isFresh:!0}).then(()=>{this.isShowHotType=!1,this.isShowLoadTips=!1,this.$nextTick(()=>{this.checkoutCommentSticky(),this.commentsMap&&this.commentsMap[this.answer.id]&&this.commentsMap[this.answer.id].comments&&0===this.commentsMap[this.answer.id].comments.length?this.openCommentFocus=!0:this.openCommentFocus=!1})}).catch(()=>{this.isShowLoadTips=!1,n.Message.error({message:"加载评论失败，请稍后重试！"}),this.currentCommentSort=this.lastCommentSort})},deleteAnswer(){const t=this.$store.getters["global/userToken"]||"";this.$newConfirm("warning","确认要删除？",{confirm:()=>{this.$store.dispatch("q/deleteAnswer",{answerId:this.answer.id,userToken:t}).then(()=>{this.$store.commit("q/updateQuestionIsAnswered",{isAnswered:!1,answerId:0}),n.Message.success({message:"删除回答成功！"}),this.$store.commit("q/updateOneAnswerItem",{answer:this.answer,type:"delete"}),setTimeout(()=>{window.location.href=window.location.href},500)}).catch(()=>{n.Message.error({message:"删除回答失败，请稍后重试!"})})}})},clickComplainBtn(){this.answerComplained?n.Message.warning({message:"你已经投诉过该回答！"}):this.showComplaintDialog=!this.showComplaintDialog},closeComplaintDialog(){this.showComplaintDialog=!1},saveComplaintDialog({note:t,isAnonymous:e}){if(t.length<1)return;this.showComplaintDialog=!1;const i=e?1:0;this.$store.dispatch("q/complainAnswer",{answerId:this.answer.id,note:t,isAnonymous:i}).then(()=>{n.Message.success({message:"投诉成功!"}),this.answerComplained=!0}).catch(()=>{n.Message.error({message:"投诉失败，请稍后再试!"})})},updateAgree(t){if(this.updateAgreedTag||t.is_author)return;this.updateAgreedTag=!0;const e=this.$store.getters["global/userToken"]||"",i={answerId:t.id,isAgreed:t.is_agreed},a=t.is_agreed;i.userToken=e,this.$store.dispatch("q/handleAgreeAction",i).then(()=>{this.updateAgreedTag=!1,this.fetchAgreeUsers(),a?Object(F.b)("answerAgree",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"disAgree"}):Object(F.b)("answerAgree",{question_id:this.qId,answer_id:this.answer.id,author_nick:this.answer.author_info.created_by,operation_type:"agree"})}).catch(t=>{this.updateAgreedTag=!1;let e="点赞操作失败，请稍后再试";-1!==t.code&&(e=t.message||e),this.$toast(e,{status:"error",positon:"center"})})},showMoreAgree(){this.lockAgreeClick||(this.showAllAgreeUsers?this.showAllAgreeUsers=!this.showAllAgreeUsers:(this.lockAgreeClick=!0,this.fetchAgreeUsers(()=>{this.lockAgreeClick=!1,this.showAllAgreeUsers=!this.showAllAgreeUsers},()=>{this.lockAgreeClick=!1})))},fetchAgreeUsers(t,e){this.$store.dispatch("q/fetchAgreeUsers",{id:this.qId,answerId:this.answer.id}).then(()=>{t&&t()}).catch(()=>{e&&e()})},chooseAnswerSort(t){this.lastCommentSort=this.currentCommentSort,this.currentCommentSort=t,this.showAllComments()},openMoreListArea(){this.showMoreDialog=!0,this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseenter(){this.showMoreTimer&&clearTimeout(this.showMoreTimer)},handelMoreMouseleave(){this.showMoreTimer&&clearTimeout(this.showMoreTimer),this.showMoreDialog&&(this.showMoreTimer=setTimeout(()=>{this.showMoreDialog=!1},200))},handelChangeShowUsableAttitudesModal(t){var e;const i=1===t?this.$refs.attitudeEntry1:this.$refs.attitudeEntry2,a=(null==i||null===(e=i.getBoundingClientRect())||void 0===e?void 0:e.top)||0;this.attitudeDir=a<160?"down":"up",this.currentUsableAttitudesModalType===t?(this.currentUsableAttitudesModalType=0,this.rmWinHandle()):this.currentUsableAttitudesModalType=t,this.addWinHandle()},dealWinClick(t){const e=t.target;let i=!1;const a=document.querySelectorAll(".handle-ele-for-answer-"+this.answer.id),s=document.querySelectorAll(".attitude-list-for-answer-"+this.answer.id);for(let t=0;t<a.length;t++){const s=a[t];(s===e||s&&s.contains(e))&&(i=!0)}for(let t=0;t<s.length;t++){const a=s[t];(a===e||a&&a.contains(e))&&(i=!0)}i||(this.currentUsableAttitudesModalType=0,setTimeout(()=>{this.rmWinHandle()},40))},addWinHandle(){window.addEventListener("click",this.dealWinClick)},rmWinHandle(){window.removeEventListener("click",this.dealWinClick)}}}),ot=Object(m.a)(nt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.answer.id?i("div",{staticClass:"answer-item",class:[t.answer.is_author?"question-my-answer":"",t.answerDomKey+t.answer.id]},[i("div",{ref:"answer_item"+t.answer.author_info.created_by,staticClass:"answer-left",on:{mouseenter:function(e){return t.renderUserCard(t.answer.author_info,t.answer.author_info.created_by,t.answer.id)},mouseleave:function(e){return t.renderUserCard(t.answer.author_info)}}},[i("badge-twitter",{attrs:{"check-unique-key":"",width:38,"unique-key":"answer_item"+t.answer.author_info.created_by+t.answer.id,"user-data":t.userCardItem,"show-attention":!0}}),t._v(" "),i("a",{attrs:{href:"/user/"+t.answer.author_info.created_by,target:"_blank"}},[i("img",{attrs:{src:t._f("assetAvatar")(t.answer.author_info.created_by)}})])],1),t._v(" "),i("div",{staticClass:"answer-right"},[i("div",{staticClass:"info-wrapper"},[i("div",{staticClass:"left-wrap"},[i("div",{staticClass:"user-info",class:[t.hasTitleIcon?"user-info-has-icon":"",t.answer.agree_users&&t.answer.agree_users.length>0?"contain-agree":""]},[i("a",{staticClass:"user-name",attrs:{href:"/user/"+t.answer.author_info.created_by,target:"_blank"}},[t._v("\n            "+t._s(t.answer.author_info.created_by)+"\n          ")]),t._v(" "),t.answer.author_info.is_expert?i("span",{staticClass:"info-icon",attrs:{title:"专家"}},[i("svg-icon",{attrs:{name:"q/expert_user",width:16,height:16}})],1):t._e(),t._v(" "),t.answer.author_info.is_best_user&&"不显示"!==t.answer.position_title?i("span",{staticClass:"info-icon",attrs:{title:"优秀答主"}},[i("svg-icon",{attrs:{name:"q/best_user",width:16,height:16}})],1):t.answer.author_info.is_ten_thousand_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"万赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2401/5c41b70f25044edb.png"}})]):t.answer.author_info.is_thousand_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"千赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2312/db28244eea6d40a7.png"}})]):t.answer.author_info.is_hundred_agreed_user?i("a",{staticClass:"info-icon",attrs:{href:"/q/hundred_agree",target:"_blank",title:"百赞达人"}},[i("img",{attrs:{src:"https://assets.km.tencent.com/asset/common/2312/7b51ad931db44494.png"}})]):t._e(),t._v(" "),i("span",{staticClass:"part-info info-text"},[t._v("\n            "+t._s("不显示"===t.answer.position_title?"--":t.answer.position_title||t.answer.creator_dept_name||"")+"\n          ")]),t._v(" "),i("span",{staticClass:"signature-info info-text",attrs:{title:t.signatureInfo}},[t._v("\n            "+t._s(t.signatureInfo)+"\n          ")])]),t._v(" "),t.answer.agree_users&&t.answer.agree_users.length>0?i("div",{staticClass:"agree-users",class:[t.hasTitleIcon?"user-info-has-icon":""]},[i("span",[t._v(t._s(t.answer.agree_count)+"人赞同，来自")]),t._v(" "),i("span",{staticClass:"abstract-agree-users"},t._l(t.answer.agree_users,(function(e,a){return i("span",{key:a,staticClass:"agree-item"},[a<t.initAgreeUsersCount||t.showAllAgreeUsers?i("span",{staticClass:"user-name"},[i("a",{attrs:{href:"/user/"+e.nick,target:"_blank"}},[t._v("\n                  "+t._s(e.nick)+"\n                  "),e.is_expert?i("span",{staticClass:"user-vip-icon"},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/expert_user",width:16,height:16}})],1):t._e(),t._v("\n                  "+t._s(t.showAllAgreeUsers?t.answer.agree_count-1===a?"":"、":t.answer.agree_count-1===a?"":t.answer.agree_count-1>a?a===t.initAgreeUsersCount-1?"...":"、":"")+"\n                ")])]):t._e()])})),0),t._v(" "),t.answer.agree_count>t.initAgreeUsersCount?i("span",{staticClass:"agreed-ope-btn",on:{click:t.showMoreAgree}},[t._v("\n            "+t._s(t.showAllAgreeUsers?"收起":"更多")+"\n          ")]):t._e()]):t._e()]),t._v(" "),t.answer.is_right_answer?i("div",{staticClass:"right-wrap"},[i("svg-icon",{attrs:{name:"q/top_answer",width:52,height:52}})],1):t.answer.is_q_headline?i("div",{staticClass:"right-wrap"},[i("a",{attrs:{href:"/q/headlines",title:"查看更多乐问头条",target:"_blank"}},[i("svg-icon",{attrs:{name:"q/head_answer",width:52,height:52}})],1)]):t._e()]),t._v(" "),t.isAnswerPage&&1===t.answer.is_folded?i("div",{staticClass:"answer-page-fold-tips"},[t._m(0)]):t._e(),t._v(" "),!t.isAnswerPage||t.isAnswerPage&&(0===t.answer.is_folded||t.answer.content)?[i("div",{ref:"contentTextArea",staticClass:"content-text"},[-1!==t.trilobiteEditOpen?["iWiki"===t.answer.editor_type&&1===t.trilobiteEditOpen?i("div",{class:["km-editor-json-content","km-editor-json-content-"+t.answer.id]},[i("div",{staticClass:"trilobite-container km-trilobite-editor"},[i("div",{staticClass:"km-editor-hook",attrs:{id:"answer-json-content-id-"+t.answer.id},on:{click:t.handleClickRichImg}})])]):i("div",{staticClass:"rich-content-area custom-block"},[i("div",{staticClass:"text-content km-view-content km-view-content-simple custom-block-content",class:["km-view-content-simple-"+t.answer.id],domProps:{innerHTML:t._s(t.convertContent(t.answer.content))},on:{click:t.handleClickRichImg}})])]:t._e()],2),t._v(" "),t.answerAttitudesMap[String(t.answer.id)]&&t.answerAttitudesMap[String(t.answer.id)].hadAttitudes&&t.answerAttitudesMap[String(t.answer.id)].hadAttitudes.length>0?i("div",{staticClass:"clarify-list"},[[i("div",{ref:"attitudeEntry1",staticClass:"answer-attitude-item attitude-add-btn",class:["handle-ele-for-answer-"+t.answer.id],on:{click:function(e){return t.handelChangeShowUsableAttitudesModal(1,e)}}},[i("svg-icon",{attrs:{name:"q/clarify_ope",width:20,height:20}}),t._v(" "),1===t.currentUsableAttitudesModalType?i("div",{staticClass:"attitude-list",class:["attitude-list-for-answer-"+t.answer.id,"up"===t.attitudeDir?"attitude-list-add-up":"attitude-list-add-down"]},t._l(t.usableAnswerAttitudes,(function(e,a){return i("div",{key:a,staticClass:"attitude-list-item",class:t.answerAttitudesMap[String(t.answer.id)]&&t.answerAttitudesMap[String(t.answer.id)].myAttitude===e.id?"attitude-list-item-active":"attitude-list-item-default",on:{click:function(i){return t.handleClickAttitude(e)}}},[i("img",{attrs:{src:e.icon}})])})),0):t._e()],1),t._v(" "),t._l(t.answerAttitudesMap[String(t.answer.id)].hadAttitudes,(function(e,a){return i("div",{key:a,staticClass:"answer-attitude-item",class:[e.id===t.answerAttitudesMap[String(t.answer.id)].myAttitude?"active-item":""],on:{click:function(i){return t.handleClickAttitude(e)}}},[i("img",{staticClass:"attitude-icon",attrs:{src:e.icon}}),t._v(" "),i("span",{staticClass:"attitude-count"},[t._v(t._s(e.used_count))])])}))]],2):t.answer.has_attituded?i("div",{staticClass:"clarify-list temp-height"}):t._e(),t._v(" "),t.bottomLineTag?i("div",{staticClass:"replace-a-operation-area",style:{height:t.noFixedBottomLineheight+"px"}}):t._e(),t._v(" "),i("div",{ref:"noFixedBottomLine",staticClass:"operation-line",class:[t.bottomLineTag?"fixed-bottom-line":"no-fixed-bottom-line"],style:t.fixedStyleObj},[i("div",{staticClass:"ope-left"},[i("div",{staticClass:"agree-btn",class:[t.answer.is_author?"unable-agreed":t.answer.is_agreed?"has-agreed":"can-agreed"],on:{click:function(e){return t.updateAgree(t.answer)}}},[t._v("\n            "+t._s(t.answer.is_agreed?"已赞同":"赞同")+" "+t._s(" "+(t.answer.agree_count||0))+"\n          ")]),t._v(" "),i("div",{staticClass:"ope-comment-type common-ope",on:{click:t.openAnswerComment}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/apply_answer",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v(t._s(t.isShowHotType?t.answer.comment_count+"个评论":"收起评论"))])],1),t._v(" "),i("div",{ref:"attitudeEntry2",staticClass:"ope-clarify-type common-ope",class:["handle-ele-for-answer-"+t.answer.id],on:{click:function(e){return t.handelChangeShowUsableAttitudesModal(2,e)}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/clarify_ope",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text"},[t._v("表个态")]),t._v(" "),2===t.currentUsableAttitudesModalType?i("div",{staticClass:"attitude-list",class:["attitude-list-for-answer-"+t.answer.id,"up"===t.attitudeDir?"attitude-list-up":"attitude-list-down"]},t._l(t.usableAnswerAttitudes,(function(e,a){return i("div",{key:a,staticClass:"attitude-list-item",class:t.answerAttitudesMap[String(t.answer.id)]&&t.answerAttitudesMap[String(t.answer.id)].myAttitude===e.id?"attitude-list-item-active":"attitude-list-item-default",on:{click:function(i){return t.handleClickAttitude(e)}}},[i("img",{attrs:{src:e.icon}})])})),0):t._e()],1),t._v(" "),t.answerModel?i("div",{staticClass:"ope-collect-type common-ope",on:{click:t.operateCollect}},[t.answerModel.has_bookmarked?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/has_collect",width:20,height:20}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/collect_answer",width:20,height:20}}),t._v(" "),i("span",{staticClass:"ope-btn-text",class:[t.answerModel.has_bookmarked?"has-collect-answer":""]},[t._v("\n              "+t._s(t.answerModel.has_bookmarked?"已收藏"+(t.answerModel.bookmark_count||""):(t.answerModel.bookmark_count||0)+"人收藏")+"\n            ")])],1):t._e(),t._v(" "),i("div",{staticClass:"ope-more-type common-ope",on:{mouseenter:t.openMoreListArea,mouseleave:t.handelMoreMouseleave}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/more_ope",width:20,height:20}}),t._v(" "),t.showMoreDialog?i("div",{staticClass:"more-ope-list common-child-ope-list",on:{mouseenter:t.handelMoreMouseenter,mouseleave:t.handelMoreMouseleave}},[i("ul",[t.answer.is_author?t._e():[i("li",{staticClass:"item",on:{click:t.clickComplainBtn}},[i("span",{staticClass:"text"},[t._v(t._s(t.answerComplained?"已投诉":"投诉"))])])],t._v(" "),t.answerModel&&!t.answerModel.is_author?i("li",{staticClass:"item",on:{click:t.operateUseless}},[i("span",{staticClass:"text"},[t._v(t._s(t.answerModel.is_downvoted?"撤销没有帮助":"没有帮助"))])]):t._e(),t._v(" "),t.answer.is_author?[i("li",{staticClass:"item",on:{click:function(e){return t.editOwnAnswer(t.answer)}}},[i("span",{staticClass:"text"},[t._v("编辑回答")])]),t._v(" "),i("li",{staticClass:"item",on:{click:t.deleteAnswer}},[i("span",{staticClass:"text"},[t._v("删除")])])]:t._e(),t._v(" "),t.qDetailData&&t.qDetailData.question&&(t.qDetailData.question.is_admin||t.qDetailData.question.is_hr_admin)?i("li",{staticClass:"item"},[i("a",{staticClass:"text",attrs:{href:"/answer_admin/manage/"+t.answer.id,target:"_blank"}},[t._v("管理")])]):t._e()],2)]):t._e()],1)]),t._v(" "),t.bottomLineTag?i("div",{staticClass:"ope-right"},[t.lastBottomAnswer?i("div",{staticClass:"btn-item",on:{click:function(e){return t.jumpAnswerItem(t.lastBottomAnswer)}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/last_item",width:16,height:16}})],1):t._e(),t._v(" "),t.nextBottomAnswer?i("div",{staticClass:"btn-item",on:{click:function(e){return t.jumpAnswerItem(t.nextBottomAnswer)}}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/next_item",width:16,height:16}})],1):t._e()]):t._e(),t._v(" "),t.bottomLineTag?t._e():i("div",{staticClass:"ope-right"},[t.answer.is_from_mobile?i("t-popup",{attrs:{"destroy-on-close":"",trigger:"click"}},[i("span",{staticClass:"answer-src"},[t._v("\n              来自"+t._s("iPhone"===t.answer.answer_src?"iOS":"Android")+"客户端\n            ")]),t._v(" "),i("div",{staticClass:"mobile-info",attrs:{slot:"content"},slot:"content"},[i("img",{staticClass:"mobile-qcode",attrs:{src:"https://km.woa.com/img/download_openkm.png",alt:""}}),t._v("\n              扫一扫安装手机KM\n            ")])]):t._e(),t._v(" "),i("t-popup",[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("发布于："+t._s(t.answer.created))]),t._v(" "),t.answer.updated_at?i("p",[t._v("\n                更新于："+t._s(t.answer.updated_at)+"\n              ")]):t._e()]),t._v(" "),i("a",{staticClass:"time-jump",attrs:{href:"/q/answer/"+t.answer.id+"?f=index",title:t.answer.display_updated_at?"发布于 "+t.answer.display_created_at:"",target:"_blank"}},[t._v("\n              "+t._s(t.answer.display_updated_at?t.answer.display_updated_at+"更新":t.answer.display_created_at)+"\n            ")])])],1)]),t._v(" "),t.isShowHotType&&t.hotTypeList.length>0||!t.isShowHotType?i("div",{ref:"commentListWrapper",staticClass:"comment-list-wrapper"},[i("div",{staticClass:"content-area",class:[t.isShowHotType?"hot-content-area":"all-ontent-area"]},[t.isShowHotType?t._e():i("div",{ref:"topLineRef",staticClass:"top-line",class:[t.isShowHotType?"hot-top-line":"all-top-line"]},[i("div",{staticClass:"title"},[t._v("\n              评论 "+t._s(t.answer.comment_count)+"\n            ")]),t._v(" "),t.isShowHotType?i("span",{staticClass:"spread-all",on:{click:function(e){return t.showAllCommentsFromCache()}}},[t._v("\n              展开全部\n              "),i("svg-icon",{staticClass:"info-icon info-icon-item",attrs:{name:"q/comment_hide",width:16,height:16}}),t._v(" "),i("svg-icon",{staticClass:"info-icon-hover info-icon-item",attrs:{name:"q/hide_hover",width:16,height:16}})],1):i("div",{staticClass:"right-sort-area"},[i("div",{staticClass:"right-sort"},[i("span",{staticClass:"sort-item",class:["created"===t.currentCommentSort?"active-item":""],on:{click:function(e){return t.chooseAnswerSort("created")}}},[t._v("\n                  最早\n                ")]),t._v(" "),i("span",{staticClass:"sort-item",class:["default"===t.currentCommentSort?"active-item":""],on:{click:function(e){return t.chooseAnswerSort("default")}}},[t._v("\n                  热门\n                ")]),t._v(" "),i("span",{staticClass:"sort-item",class:["latest"===t.currentCommentSort?"active-item":""],on:{click:function(e){return t.chooseAnswerSort("latest")}}},[t._v("\n                  最晚\n                ")])])])]),t._v(" "),t.isShowHotType?i("div",{staticClass:"hot-type"},t._l(t.hotTypeList,(function(e,a){return i("single-comment",{key:e.id,attrs:{"comment-type":"hot","list-number":a,"current-comment":e,answer:t.answer}})})),1):i("div",{ref:"commentBottomArea",staticClass:"all-type"},[t.isShowLoadTips||t.commentsMap&&t.commentsMap[t.answer.id]&&t.commentsMap[t.answer.id].comments&&0===t.commentsMap[t.answer.id].comments.length?i("div",{staticClass:"load-content-tips"},[t.isShowLoadTips?i("span",[t._v("加载中...")]):i("span",[t._v(" 暂无评论 ")])]):t._e(),t._v(" "),t.commentsMap&&t.commentsMap[t.answer.id]&&t.commentsMap[t.answer.id].comments&&!t.isShowLoadTips?t._l(t.commentsMap[t.answer.id].comments,(function(e,a){return i("single-comment",{key:e.id,attrs:{"comment-type":"default","current-comment":e,"list-number":a,"is-admin":t.qDetailData.question.is_admin||t.qDetailData.question.is_hr_admin,"is-self":e.created_by===t.userInfo.user_info.nick,"close-comment":t.commentsMap[t.answer.id].closeComment,answer:t.answer},on:{onReplyComment:t.replyComment}})})):t._e()],2),t._v(" "),t.isShowHotType&&t.answer.comment_count>2?i("div",{staticClass:"spread-bottom-btn"},[i("div",{staticClass:"spread-container",on:{click:function(e){return t.showAllCommentsFromCache()}}},[i("span",{staticClass:"text"},[t._v("展开剩余"+t._s(t.answer.comment_count-2)+"个评论")]),t._v(" "),i("svg-icon",{staticClass:"info-icon icon-hide",attrs:{name:"q/comment_hide",width:16,height:16}}),t._v(" "),i("svg-icon",{staticClass:"info-icon icon-hover",attrs:{name:"q/hide_hover",width:16,height:16}})],1)]):t._e(),t._v(" "),!t.isAnswerPage&&!t.isShowHotType&&t.answer.comment_count>t.commentsLimit?i("div",{staticClass:"jump-all-comments"},[i("a",{staticClass:"a-link",attrs:{target:"_blank",href:"/q/answer/"+t.answer.id+"?jump_to_reply=1"}},[i("span",{staticClass:"text"},[t._v("查看全部"+t._s(t.answer.comment_count)+"个评论")]),t._v(" "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/answer_jump",width:16,height:16}})],1)]):t._e(),t._v(" "),t.isAnswerPage&&!t.isShowHotType&&t.answer.comment_count>t.commentsLimit&&t.commentsMap&&t.commentsMap[t.answer.id]&&!t.commentsMap[t.answer.id].isEnd?i("div",{staticClass:"jump-all-comments",on:{click:t.loadNextComments}},[i("span",{staticClass:"a-link"},[i("span",{staticClass:"text"},[t._v("查看更多评论")]),t._v(" "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/answer_paging",width:16,height:16}})],1)]):t._e(),t._v(" "),i("div",{staticClass:"comment-bottom-area",class:[t.fixedCommentBottomLine&&!t.isShowHotType?"comment-bottom-area-fixed":""]},[!t.isShowHotType&&t.commentsMap&&t.commentsMap[t.answer.id]&&t.commentsMap[t.answer.id].comments&&t.commentsMap[t.answer.id].comments.length>3?i("div",{staticClass:"pack-up-area"},[i("div",{staticClass:"pack-up-btn",on:{click:function(e){return t.packUpComment("bottom")}}},[t._v("\n                收起评论\n              ")])]):t._e(),t._v(" "),t.isShowHotType?t._e():i("div",{staticClass:"comment-mod-wrapper"},[0===t.answer.is_close_comment?i("comment-mod",{attrs:{answer:t.answer,"is-focus-prop":t.openCommentFocus,"is-fixed-line":t.fixedCommentBottomLine&&!t.isShowHotType,"reply-content":t.replyContent},on:{onFreshComment:t.freshComment}}):i("div",{staticClass:"close-comment"},[t._v("\n                回答者已关闭评论\n              ")])],1)])])]):t._e()]:t._e()],2),t._v(" "),t.showComplaintDialog?i("q-complaint-mod",{attrs:{"complaint-type":"answer"},on:{onCloseMod:t.closeComplaintDialog,onSaveMod:t.saveComplaintDialog}}):t._e(),t._v(" "),t.showEditAnswerDialog?i("edit-answer-mod",{attrs:{answer:t.answer},on:{onCloseMod:function(e){t.showEditAnswerDialog=!1}}}):t._e(),t._v(" "),t.showUselessMod?i("useless-answer-mod",{attrs:{answer:t.answer},on:{onCloseMod:function(e){t.showUselessMod=!1},onSaveMod:t.saveUselessOpe}}):t._e()],1):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"s-tips"},[this._v("\n        回答因违反\n        "),e("a",{attrs:{href:"https://km.woa.com/themes/10000",target:"_blank"}},[this._v("《乐问公约》")]),this._v("\n        被折叠。如有疑问，请联系内部社区安全助手\n      ")])}],!1,null,"2d697726",null).exports,rt=i(2023),lt=i(2024),ct=i(2010),dt=i(2008),ut=i(7);const pt=({id:t})=>ut.a.post("/km_bff/question/v1/summarize_question",{id:t});var ht=i(2062),mt=Object(a.c)({name:"QDetailMod",components:{operationMod:N,answerListMod:ot,answerEditorMod:Q,kmBreadcrumb:ct.a,Dropdown:dt.a,AiDrawer:ht.a,AiDrawerItem:ht.b},filters:{},props:{qIdProp:{type:[String,Number],default:""},pageType:{type:String,default:"detail"},isAnswerPage:{type:Boolean,default:!1},isFetchAnswer:{type:Boolean,default:!1}},setup:()=>({}),data:()=>({overHeight:!0,fullDesTag:0,hasInit:!1,showFoldListTag:!1,fixedBottomLine:!1,showContent:!0,answerPageLock:!1,lockOrderTab:!1,renderAnswerWaterFlag:!1,titleMap:{detail:"问题详情",answer:"回答详情"},currentAnswerSort:"default",dropdownItemList:[{value:"default",text:"默认",actived:!0},{value:"created",text:"最早"},{value:"-created",text:"最晚"}],currentSortLabel:"默认",aiSummary:{visible:!1,id:"",content:"",taskStatus:"",timer:null},trilobiteObjForContent:null,supplementDomId:"supplement-item-id-"}),computed:{trilobiteEditOpen(){return this.$store.getters["q/getTrilobiteEditOpen"]},trilobitePreviewOpen(){return this.$store.getters["q/getTrilobitePreviewOpen"]},foldedAnswers(){return this.$store.getters["q/getFoldedAnswers"]||[]},answerPaging(){return this.$store.getters["q/getAnswerPaging"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}},answersList(){return this.$store.getters["q/getAnswers"]||[]},qId(){return this.qIdProp||this.$store.getters["q/getQId"]||""},aId(){return this.$store.getters["q/getAId"]||""},convertContent:()=>t=>Object(z.d)(Object(z.f)(t)),aiSummaryDisabledText(){var t,e,i;const a=(null===(t=this.qDetailData)||void 0===t?void 0:t.folded_count)||0;if(((null===(e=this.qDetailData)||void 0===e||null===(i=e.question)||void 0===i?void 0:i.reply_count)||0)-a<5){var s;const t=(null===(s=this.answersList)||void 0===s?void 0:s.reduce((t,e)=>{var i;const a=(null===(i=e.comments)||void 0===i?void 0:i.map(t=>t.created_by))||[],s=e.created_by?a.concat(e.created_by):a;return t.concat(s)},[]))||[],e=[...new Set(t)];if(((null==e?void 0:e.length)||0)<5)return"参与讨论人数超过5人将触发AI总结"}return this.aiSummary.content||0!==this.aiSummary.taskStatus&&1!==this.aiSummary.taskStatus?"":"AI总结生成中"},redirectTopAnswer(){var t,e;return(null===(t=this.qDetailData)||void 0===t||null===(e=t.question)||void 0===e?void 0:e.redirect_top_answer)||null},showTopAnswerContent(){var t;const e=(null===(t=this.redirectTopAnswer)||void 0===t?void 0:t.content_text)||"";return e.length>120?e.substr(0,120)+"...":e}},watch:{isFetchAnswer(t){t&&this.isAnswerPage&&this.initAnswerPage()},qDetailData(t){null!==t&&t.question&&t.question.id&&this.initDetailMod()},currentAnswerSort(t){this.dropdownItemList.forEach(e=>{e.value===t?e.actived=!0:e.actived=!1})}},mounted(){Object(s.e)().then(()=>{Object(s.d)()}),this.isAnswerPage||(this.currentAnswerSort=this.$route.query.order_by||"","answer_created"===this.currentAnswerSort?(this.currentAnswerSort="-created",this.chooseAnswerSort(this.currentAnswerSort)):this.chooseAnswerSort("default")),this.$store.dispatch("q/fetchFoldedAnswers",{id:this.qId}).then(()=>{}).catch(()=>{}),this.hookPageScroll(),this.renderWater(".content-detail-section"),this.qDetailData&&this.qDetailData.question&&this.initDetailMod(),this.isAnswerPage&&this.$nextTick(()=>{const{qContentBlockRef:t}=this.$refs;t&&(this.overHeight=t.scrollHeight>500,this.overHeight?this.fullDesTag=2:this.fullDesTag=0)}),this.initAISummary()},destroyed(){this.aiSummary.timer&&clearTimeout(this.aiSummary.timer)},methods:{initTrilobiteEditor(){if("iWiki"!==this.qDetailData.question.editor_type||1!==this.trilobiteEditOpen)return;const t={container:"#q-json-content-id",appearance:"full-width",language:"zh",value:this.qDetailData.question.json_content,model:"preview",clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},plugins:[new window.ImagePlugin,new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})],pluginsSettings:{featureFlag:{allowTables:!1,allowEmoji:!1,allowBlockType:!1,allowTextAlignment:!1,allowTextHighlight:!1,allowFindReplace:!1}}};this.trilobiteObjForContent=new window.TrilobiteEditor(t)},renderSupplementList(){const{supplements:t}=this.qDetailData.question;t.forEach(t=>{const{id:e,editor_type:i,json_content:a}=t;"iWiki"===i&&a&&1===this.trilobiteEditOpen&&this.createViewTrilobite({id:""+(this.supplementDomId+e),jsonContent:a})})},createViewTrilobite(t){const{jsonContent:e,id:i}=t;if(!e||!i)return null;const a={container:"#"+i,appearance:"full-width",language:"zh",value:e,model:"preview",clientSettings:{emojiPicUrl:"https://assets.km.tencent.com/asset/common/2409/b4cc6508f74d4250.png"},plugins:[new window.ImagePlugin,new window.FontSizePlugin({defaultFontSize:{value:15,title:"15px"},fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, segoe ui, "Helvetica Neue", "Helvetica", "Arial","PingFang SC", "Microsoft Yahei", sans-serif, apple color emoji, segoe ui emoji, segoe ui symbol'})]};return new window.TrilobiteEditor(a)},initAnswerPage(){this.loadAttitudeAsync([{id:this.aId}])},packUpDes(){this.fullDesTag=2;const{qContentBlockRef:t}=this.$refs;t&&t.scrollIntoView({behavior:"smooth"})},entryDetailPageReport(){const t=this.qDetailData.question.is_anonymous?"匿名用户":this.qDetailData.question.author_info.nick;this.isAnswerPage?(Object(F.b)("answerDetailView",{question_id:this.qId,author_nick:t,answer_id:this.aId}),Object(F.c)("answerDetailLeave",{question_id:this.qId,author_nick:t,answer_id:this.aId})):(Object(F.b)("questionDetailView",{question_id:this.qId,author_nick:t}),Object(F.c)("questionDetaiLeave",{question_id:this.qId,author_nick:t}))},initDetailMod(){this.hasInit||(this.entryDetailPageReport(),this.hasInit=!0,setTimeout(()=>{this.initImagePreview()},400),this.$nextTick(()=>{"iWiki"===this.qDetailData.question.editor_type&&1===this.trilobiteEditOpen&&this.createViewTrilobite({id:"q-json-content-id",jsonContent:this.qDetailData.question.json_content}),this.renderSupplementList(),it(".km-view-content-simple-detail img",{viewContentWidth:710})}))},loadAttitudeAsync(t){const e=t.map(t=>({targetId:t.id,targetType:"answer"}));this.$store.dispatch("q/fetchBatchAttitudeSum",{list:e}).then(({})=>{}).catch(()=>{})},initImagePreview(){const t=[...document.querySelectorAll(".q-content-block .km-view-content img"),...document.querySelectorAll(".q-content-block .km-editor-json-content img")];for(const i of t){var e;"IMG"===i.tagName&&"A"!==(null===(e=i.parentNode)||void 0===e?void 0:e.tagName)&&i.classList.add("amplify")}},handleClickRichImg(t){var e;if(!t||!t.target)return;const{target:i}=t;if("IMG"===i.tagName&&"A"!==(null===(e=i.parentNode)||void 0===e?void 0:e.tagName)){const t=window.decodeURIComponent(i.src).replace(/imageMogr2\/thumbnail\/(\S)*>\/ignore-error\/1/gi,"imageMogr2/thumbnail/4096x>/ignore-error/1");st.a.show({src:t})}},openFoldArea(){0!==this.foldedAnswers.length&&(this.showFoldListTag=!this.showFoldListTag)},deleteQuestionSupplementary(t){const e=this.$store.getters["global/userToken"]||"";this.$newConfirm("warning","确认要删除？",{confirm:()=>{this.$store.dispatch("q/deleteQuestionSupplementary",{supplementaryId:t.id,userToken:e}).then(()=>{n.Message.success({message:"删除成功！"}),setTimeout(()=>{window.location.href=window.location.href},300)}).catch(()=>{n.Message.success({message:"删除失败！请稍后再试"})})}})},hookPageScroll(){this.throttleFn&&window.removeEventListener("scroll",this.throttleFn),this.throttleFn=tt(this.handleScrollFn,100),window.addEventListener("scroll",this.throttleFn),this.$nextTick(()=>{this.handleScrollFn()})},handleScrollFn(){const t=document.querySelectorAll(".q-right-common-item"),e=t.length;if(e>0){const i=t[e-1];i.classList.contains("jump-q-container")||i.classList.add("sticky-right-item");for(let i=0;i<e-1;i++)t[i].classList.remove("sticky-right-item")}const{contentDetailArea:i}=this.$refs;if(!i)return;const a=at(i);a&&a.needSticky?this.fixedBottomLine=!0:this.fixedBottomLine=!1},renderWater(t){setTimeout(()=>{Object(rt.b)().then(({data:e})=>{new lt.b({watermarked:t,img:null==e?void 0:e.url}).draw()}),Object(rt.a)().then(({data:e})=>{var i;new lt.a({watermarked:t,img:null==e||null===(i=e.data)||void 0===i?void 0:i.url}).draw()})},200)},loadMorePage(){this.answerPageLock||(this.answerPageLock=!0,this.$store.dispatch("q/loadNextPageAnswers",{id:this.qId,orderBy:this.currentAnswerSort}).then(({answers:t})=>{this.answerPageLock=!1,this.loadAttitudeAsync(t)}).catch(()=>{this.answerPageLock=!1}))},chooseAnswerSort(t){this.currentAnswerSort=t,this.lockOrderTab||(this.lockOrderTab=!0,this.$store.dispatch("q/loadNextPageAnswers",{id:this.qId,page:1,orderBy:this.currentAnswerSort}).then(({answers:e})=>{var i;this.lockOrderTab=!1,this.loadAttitudeAsync(e),this.currentSortLabel=null===(i=this.dropdownItemList.find(e=>e.value===t))||void 0===i?void 0:i.text}).catch(()=>{this.lockOrderTab=!1}))},async toggleAISummaryVisible(){if(this.aiSummaryDisabledText)return;const t=!this.aiSummary.visible;t&&(-1!==this.aiSummary.taskStatus&&3!==this.aiSummary.taskStatus||(await pt({id:this.qId}),this.getAISummaryTask()),Object(F.b)("qAbstractView",{quetsion_id:this.qId,abstract_id:this.aiSummary.id})),this.aiSummary.visible=t},async getAISummaryTask(){const{data:t}=await(({id:t})=>ut.a.post("/km_bff/question/v1/get_question_summarization",{id:t}))({id:this.qId});if(0===(null==t?void 0:t.code)){var e,i;const a=null==t||null===(e=t.data)||void 0===e||null===(i=e.task)||void 0===i?void 0:i.status;this.aiSummary.taskStatus=void 0!==a?a:-1}else this.aiSummary.taskStatus=-1;var a;[0,1].includes(this.aiSummary.taskStatus)?(this.aiSummary.timer&&clearTimeout(this.aiSummary.timer),this.aiSummary.timer=setTimeout(this.getAISummaryTask,15e3)):(this.aiSummary.id=this.qId,this.aiSummary.content=(null==t||null===(a=t.data)||void 0===a?void 0:a.result)||"")},async initAISummary(){try{const{data:i}=await(({id:t})=>ut.a.post("/km_bff/question/v1/get_question_summary",{id:t}))({id:this.qId});var t,e;if(0===(null==i?void 0:i.code))this.aiSummary.id=(null==i||null===(t=i.data)||void 0===t?void 0:t.id)||"",this.aiSummary.content=(null==i||null===(e=i.data)||void 0===e?void 0:e.summary)||"",this.aiSummary.content||this.getAISummaryTask();else this.getAISummaryTask()}catch(t){this.aiSummary.content=""}},async onAISummaryRebuild(){const{data:t}=await pt({id:this.qId});0===(null==t?void 0:t.code)&&(this.aiSummary.content="",this.aiSummary.taskStatus=0,this.aiSummary.visible=!1,n.Message.success({message:"提交成功"}))},onAISummaryEvaluate(t){Object(F.b)("qAbstractScore",{quetsion_id:this.qId,abstract_id:this.aiSummary.id,score:t}),n.Message.success({message:"评价成功"})},onAISummaryFeedback(t){Object(F.b)("qAbstractFeedback",{quetsion_id:this.qId,abstract_id:this.aiSummary.id,content:t}),n.Message.success({message:"提交成功"})}}}),vt=Object(m.a)(mt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.qDetailData&&t.qDetailData.question?i("div",{staticClass:"content-detail-section"},[i("km-breadcrumb",{staticClass:"q-title-block",attrs:{options:[{content:"乐问",href:"/q"},{content:t.isAnswerPage?"回答详情":"问题详情"}]}}),t._v(" "),i("div",{staticClass:"q-content-tips-block"},[t.qDetailData.question.redirect_q_id?[i("div",{staticClass:"common-type similar-type",class:{"has-top-content":1==t.qDetailData.question.redirect_with_top_answer&&t.redirectTopAnswer}},[i("div",{staticClass:"title-line"},[i("p",[t._v("\n            问题已重定向至：\n            "),i("a",{staticClass:"similar-url",attrs:{href:"/q/view/"+t.qDetailData.question.redirect_q_id,target:"_blank"}},[t._v("\n              "+t._s(t.qDetailData.question.redirect_q_title)+"\n            ")])])]),t._v(" "),i("div",{staticClass:"tips-content"},[i("p",{staticClass:"content"},[t._v("\n            "+t._s(t.qDetailData.question.redirect_reason||"此问题已有相似问题")+"\n          ")])]),t._v(" "),1==t.qDetailData.question.redirect_with_top_answer&&t.redirectTopAnswer?i("div",{staticClass:"top-answer-show"},[i("div",{staticClass:"top-answer-split"}),t._v(" "),i("div",{staticClass:"answerer-info-area"},[i("div",{staticClass:"info-custom"},[i("a",{staticClass:"avatar",attrs:{href:"/user/"+t.redirectTopAnswer.created_by,target:"_blank"}},[i("img",{attrs:{src:"/asset/avatar/"+t.redirectTopAnswer.created_by}})]),t._v(" "),i("a",{staticClass:"nickname",attrs:{href:"/user/"+t.redirectTopAnswer.created_by,target:"_blank"}},[t._v("\n                "+t._s(t.redirectTopAnswer.created_by)+"\n              ")]),i("span",{staticClass:"position"},[t._v(t._s(t.redirectTopAnswer.position_title))])]),t._v(" "),i("svg-icon",{staticClass:"top-answer-icon",attrs:{name:"q/answer_top",width:40,height:40}})],1),t._v(" "),i("div",{staticClass:"text-content hover-content"},[t._v("\n            "+t._s(t.showTopAnswerContent)+"\n            "),t.redirectTopAnswer.content_text.length>120?i("a",{staticClass:"view-more",attrs:{href:"/q/answer/"+t.redirectTopAnswer.id,target:"_blank"}},[t._v("\n              查看原文\n            ")]):t._e()])]):t._e()])]:t.qDetailData.question.is_appealed?[i("div",{staticClass:"invalid-type common-type"},[t._m(0),t._v(" "),i("div",{staticClass:"tips-content"},[t._v("\n          说明："+t._s(t.qDetailData.question.appeal_reason)+"\n          "),t.qDetailData.question.appeal_url?i("a",{attrs:{href:t.qDetailData.question.appeal_url,target:"_blank"}},[t._v("\n            "+t._s(t.qDetailData.question.appeal_url)+"\n          ")]):t._e()])])]:t.qDetailData.question.is_disabled?[i("div",{staticClass:"invalid-type common-type"},[i("div",{staticClass:"title-line"},[i("p",{staticClass:"title"},[t._v("\n            "+t._s(0===t.qDetailData.question.disable_type?"此问题已无效":1===t.qDetailData.question.disable_type?"此问题待修改":"")+"\n          ")]),t._v(" "),i("a",{staticClass:"why-tips",attrs:{href:"/q/gongyue",target:"_blank"}},[t._v("\n            "+t._s(0===t.qDetailData.question.disable_type?"（为什么被无效?）":1===t.qDetailData.question.disable_type?"（什么是待修改？）":"")+"\n          ")])]),t._v(" "),i("div",{staticClass:"tips-content"},[t._v("\n          说明："+t._s(t.qDetailData.question.disabled_reason)+"\n        ")])])]:t.qDetailData.question.sticker&&t.qDetailData.question.sticker.trim().length>0?[i("div",{staticClass:"warning-type common-type"},[i("div",{staticClass:"tips-content"},[t._v("\n          温馨提示："+t._s(t.qDetailData.question.sticker)+"\n        ")])])]:t._e()],2),t._v(" "),t.qDetailData.question.tags_list&&t.qDetailData.question.tags_list.length>0||t.qDetailData.talks.length>0?i("div",{staticClass:"q-tag-block"},[i("ul",[t.qDetailData.talks.length>0?i("li",{staticClass:"basic-item listen-item"},[i("a",{attrs:{href:"/q/talk/"+t.qDetailData.talks[0].id,target:"_blank"}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/topic_tag",width:16,height:16}}),t._v(" "),i("span",{staticClass:"label-text"},[t._v(t._s(t.qDetailData.talks[0].title))])],1)]):t._e(),t._v(" "),t._l(t.qDetailData.question.tags_list,(function(e){return i("li",{key:e.id,staticClass:"basic-item"},[i("a",{attrs:{href:"/q/tag/"+e.id,target:"_blank"}},[i("span",{staticClass:"label-text"},[t._v(t._s(e.name))])])])}))],2)]):t._e(),t._v(" "),i("div",{ref:"qContentBlockRef",staticClass:"q-content-block",class:[t.isAnswerPage&&t.overHeight&&(0===t.fullDesTag||2===t.fullDesTag)?"description-content-hide":""]},[t.isAnswerPage?i("a",{staticClass:"q-title q-title-link",attrs:{href:"/q/view/"+t.qId}},[t._v(t._s(t.qDetailData.question.title))]):i("p",{staticClass:"q-title"},[t._v("\n      "+t._s(t.qDetailData.question.title)+"\n    ")]),t._v(" "),i("div",{staticClass:"q-info-line"},[i("div",{staticClass:"left-line"},[t.qDetailData.question.is_anonymous?i("span",{staticClass:"info-item"},[i("span",{staticStyle:{color:"#666"}},[t._v("匿名用户")])]):t.qDetailData.question.author_info?i("a",{staticClass:"info-item info-item-nick",attrs:{href:"/user/"+t.qDetailData.question.author_info.nick,target:"_blank"}},[i("span",{staticStyle:{color:"#666"}},[t._v(t._s(t.qDetailData.question.author_info.nick))])]):t._e(),t._v(" "),i("span",{staticClass:"info-item"},[i("span",[t._v(t._s(t.qDetailData.question.display_created_at))])]),t._v(" "),i("span",{staticClass:"info-item"},[i("span",[t._v(t._s(t.qDetailData.question.read_count)+"浏览")])])]),t._v(" "),i("div",{staticClass:"right-line"},[i("span",{class:"info-item info-item-btn info-item-btn-primary "+(t.aiSummaryDisabledText?"info-item-btn-disabled":""),attrs:{title:t.aiSummaryDisabledText},on:{click:t.toggleAISummaryVisible}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"common/ai",width:16,height:16}}),t._v("\n          AI总结\n        ")],1)])]),t._v(" "),t.qDetailData.question.is_content_hidden?i("div",{staticClass:"hide-content-tips"},[i("div",{staticClass:"tips-content"},[t._v("\n        温馨提示："+t._s(t.qDetailData.question.content_hidden_tips)+"\n      ")])]):t._e(),t._v(" "),0===t.qDetailData.question.is_content_hidden||t.qDetailData.question.is_admin||t.qDetailData.question.is_hr_admin?i("div",{ref:"contentDetailArea",staticClass:"content-detail-area"},[-1!==t.trilobiteEditOpen?["iWiki"===t.qDetailData.question.editor_type&&1===t.trilobiteEditOpen?i("div",{staticClass:"km-editor-json-content"},[i("div",{staticClass:"trilobite-container km-trilobite-editor"},[i("div",{staticClass:"km-editor-hook",attrs:{id:"q-json-content-id"},on:{click:t.handleClickRichImg}})])]):i("div",{staticClass:"q-basic-content"},[i("div",{staticClass:"rich-content-area custom-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content km-view-content-simple-detail",domProps:{innerHTML:t._s(t.convertContent(t.qDetailData.question.content))},on:{click:t.handleClickRichImg}})])])]:t._e(),t._v(" "),t.qDetailData.question.supplements&&t.qDetailData.question.supplements.length>0?i("div",{staticClass:"q-supplementary-content"},[i("ul",t._l(t.qDetailData.question.supplements,(function(e){return i("li",{key:e.id,staticClass:"sub-q-item"},[i("div",[i("div",{staticClass:"time-item"},[i("p",[t._v(t._s(e.created)+" 提问者补充")]),t._v(" "),t.qDetailData.question.is_creator?i("span",{staticClass:"delete-sub",on:{click:function(i){return t.deleteQuestionSupplementary(e)}}},[t._v("\n                  删除\n                ")]):t._e()]),t._v(" "),-1!==t.trilobiteEditOpen?["iWiki"===e.editor_type&&1===t.trilobiteEditOpen?i("div",{staticClass:"km-editor-json-content"},[i("div",{staticClass:"trilobite-container km-trilobite-editor"},[i("div",{staticClass:"km-editor-hook",attrs:{id:t.supplementDomId+e.id},on:{click:t.handleClickRichImg}})])]):i("div",{staticClass:"rich-content-area custom-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content km-view-content-simple-detail",domProps:{innerHTML:t._s(t.convertContent(e.content))},on:{click:t.handleClickRichImg}})])]:t._e()],2)])})),0)]):t._e()],2):t._e()]),t._v(" "),t.isAnswerPage&&t.overHeight?[1===t.fullDesTag?i("div",{staticClass:"hide-full-description"},[i("div",{staticClass:"full-btn",on:{click:t.packUpDes}},[i("span",[t._v("收起")]),t._v(" "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/hide_hover",width:20,height:20}})],1)]):2===t.fullDesTag?i("div",{staticClass:"open-full-description"},[i("div",{staticClass:"cover-bottom-modal"}),t._v(" "),i("div",{staticClass:"full-btn",on:{click:function(e){t.fullDesTag=1}}},[i("span",[t._v("展开阅读全文")]),t._v(" "),i("svg-icon",{staticClass:"info-icon rotate-icon",attrs:{name:"q/hide_hover",width:20,height:20}})],1)]):t._e()]:t._e(),t._v(" "),t.isAnswerPage?t._e():i("operation-mod",{attrs:{"fixed-bottom-line":t.fixedBottomLine}}),t._v(" "),t.qDetailData.question.extra_content?i("div",{staticClass:"operational-content"},[i("div",{staticClass:"content-text"},[i("div",{staticClass:"rich-content-area custom-block"},[i("div",{staticClass:"text-content  km-view-content km-view-content-simple custom-block-content km-view-content-simple-detail",domProps:{innerHTML:t._s(t.convertContent(t.qDetailData.question.extra_content))},on:{click:t.handleClickRichImg}})])]),t._v(" "),i("div",{staticClass:"send-info"},[i("div",{staticClass:"right-side"},[i("span",{staticClass:"org-info"},[t._v(t._s(t.qDetailData.question.extra_content_by))]),t._v(" "),i("span",{staticClass:"time-info"},[t._v(t._s(t.qDetailData.question.extra_content_at))])])])]):t._e(),t._v(" "),t._m(1),t._v(" "),t.qDetailData&&t.qDetailData.question&&t.isAnswerPage?i("div",{staticClass:"answer-list-content"},[i("div",{staticClass:"block-top"},[i("div",{staticClass:"left-total"},[t._v("\n        回答详情\n      ")]),t._v(" "),i("a",{staticClass:"right-total",attrs:{href:"/q/view/"+t.qDetailData.question.id,target:"_blank"}},[t._v("\n        查看全部"+t._s(t.qDetailData.question.reply_count)+"个回答\n        "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/answer_jump",width:16,height:16}})],1)]),t._v(" "),t.answersList.length>0?i("div",{staticClass:"answer-list-container answer-page-list"},[t._l(t.answersList,(function(e){return i("answerListMod",{key:e.id,attrs:{answer:e,"q-id":t.qId,"is-answer-page":t.isAnswerPage}})})),t._v(" "),i("div",{staticClass:"jump-q-page"},[i("a",{staticClass:"text",attrs:{href:"/q/view/"+t.qDetailData.question.id,target:"_blank"}},[i("span",[t._v("查看全部"+t._s(t.qDetailData.question.reply_count)+"个回答")]),t._v(" "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/answer_jump",width:16,height:16}})],1)])],2):t._e()]):t._e(),t._v(" "),t.qDetailData&&t.qDetailData.question&&!t.isAnswerPage?i("div",{staticClass:"answer-list-content"},[i("div",{staticClass:"block-top"},[i("div",{staticClass:"left-total"},[t._v("\n        "+t._s(t.qDetailData.question.reply_count)+"个回答\n      ")]),t._v(" "),i("dropdown",{staticClass:"answer-sort-dropdown",attrs:{"dropdown-width":90,"item-list":t.dropdownItemList},on:{clickItem:function(e){var i=e.item;return t.chooseAnswerSort(i.value)}}},[i("span",[t._v("\n          "+t._s(t.currentSortLabel)+"\n          "),i("svg-icon",{attrs:{color:"#666666",name:"kbar/load_btn",width:16,height:16,viewBox:"0 0 16 16"}})],1)])],1),t._v(" "),t.answersList.length>0?i("div",{staticClass:"answer-list-container"},[t._l(t.answersList,(function(e){return i("answerListMod",{key:e.id,attrs:{answer:e,"q-id":t.qId,"is-answer-page":t.isAnswerPage}})})),t._v(" "),t.answerPaging&&!1===t.answerPaging.answerEnd?i("div",{staticClass:"more-answer-page",on:{click:t.loadMorePage}},[i("span",{staticClass:"text"},[t._v("查看更多回答")]),t._v(" "),i("svg-icon",{attrs:{name:"q/answer_paging",width:16,height:16}})],1):t._e()],2):t._e(),t._v(" "),[t.qDetailData.question.redirect_q_id?i("div",{staticClass:"q-tap-bottom-text"},[t._v("\n        被重定向的问题不能添加新的回答\n      ")]):t.qDetailData.question.is_appealed?i("div",{staticClass:"q-tap-bottom-text"},[t._v("\n        转申诉问题不能添加回答（\n        "),i("a",{attrs:{target:"_blank",href:"/q/gongyue"}},[t._v("为什么会转申诉?")]),t._v("\n        ）\n      ")]):t.qDetailData.question.is_disabled?i("div",{staticClass:"q-tap-bottom-text"},[t._v("\n        "+t._s(0===t.qDetailData.question.disable_type?"无效问题不能添加回答":"待修改问题不能添加回答")+"（\n        "),i("a",{attrs:{target:"_blank",href:"/q/gongyue"}},[t._v("\n          "+t._s(0===t.qDetailData.question.disable_type?"为什么被无效?":"什么是待修改？")+"\n        ")]),t._v("\n        ）\n      ")]):t._e()],t._v(" "),t.qDetailData&&t.qDetailData.folded_count>0?i("div",{staticClass:"fold-answer-area answer-list-container can-show-list"},[i("div",{staticClass:"fold-title",attrs:{title:"回答因违反《乐问公约》被折叠"},on:{click:t.openFoldArea}},[t._v("\n        "+t._s(t.qDetailData.folded_count)+"个回答被折叠\n        "),i("a",{attrs:{target:"_blank",title:"为什么部分回答会被折叠？",href:"/q/gongyue"}},[i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/fold_tips",width:16,height:16}})],1)]),t._v(" "),t.showFoldListTag?i("div",{staticClass:"spread-area"},t._l(t.foldedAnswers,(function(e){return i("answerListMod",{key:e.id,attrs:{answer:e,"q-id":t.qId}})})),1):t._e()]):t._e(),t._v(" "),t.qDetailData&&t.qDetailData.question?i("div",{staticClass:"user-answer-wrapper"},[t.qDetailData.question.redirect_q_id||t.qDetailData.question.is_disabled||!t.qDetailData.question.is_answered?t._e():i("div",{staticClass:"has-answer-q"},[i("span",[t._v("\n          一个问题你只能回答一次，但可以修改\n          "),i("a",{attrs:{href:"/q/answer/"+t.qDetailData.question.current_user_answer_id}},[t._v("你的回答")])])]),t._v(" "),t.qDetailData.question.is_answered||t.qDetailData.question.is_disabled||1===t.qDetailData.question.is_appealed||t.qDetailData.question.redirect_q_id?t._e():i("answer-editor-mod")],1):t._e()],2):t._e(),t._v(" "),i("ai-drawer",{model:{value:t.aiSummary.visible,callback:function(e){t.$set(t.aiSummary,"visible",e)},expression:"aiSummary.visible"}},[i("ai-drawer-item",{attrs:{title:"乐问总结",loading:0===t.aiSummary.taskStatus||1===t.aiSummary.taskStatus,content:t.aiSummary.content,editable:t.qDetailData.question.is_admin,"on-rebuild":t.onAISummaryRebuild,"on-evaluate":t.onAISummaryEvaluate,"on-feedback":t.onAISummaryFeedback}})],1)],2):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-line"},[e("p",{staticClass:"title"},[this._v("\n            此问题已转申诉\n          ")]),this._v(" "),e("a",{staticClass:"why-tips",attrs:{href:"/q/gongyue",target:"_blank"}},[this._v(" （为什么会转申诉?） ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"prohibit-tips-line"},[e("span",{staticClass:"line-bottom"}),this._v(" "),e("p",{staticClass:"line-text"},[this._v("\n      仅供内部学习与交流，未经公司授权切勿外传\n    ")])])}],!1,null,"39f7fa72",null).exports,gt=Object(a.c)({name:"recommend-tag-mod",data:()=>({hasInit:!1,list:[]}),props:{qIdProp:{type:[String,Number],default:""}},components:{},setup:()=>({}),computed:{recommendTagsRight(){return this.$store.getters["q/getRecommendTagsRight"]||null},qDetailData(){return this.$store.getters["q/getQDetailData"]||{}}},watch:{qDetailData(t){t&&t.question&&t.question.tags_list&&t.question.tags_list.length>0&&this.initPage(t.question.tags_list)},recommendTagsRight(t){t&&t.length>0&&(this.list=t.slice(0,3))}},mounted(){this.qDetailData&&this.qDetailData.question&&this.initPage(this.qDetailData.question.tags_list)},methods:{operateEntity(t){let e="favorite";t.has_favorited&&(e="cancel_favorite"),this.$store.dispatch("q/operateEntity",{entryId:t.target_id,action:e}).then(()=>{n.Message.success({message:t.has_favorited?"取消订阅成功":"订阅成功"}),t.has_favorited=!t.has_favorited,t.has_favorited?t.favorite_count=Number(t.favorite_count)+1:t.favorite_count>0&&(t.favorite_count=Number(t.favorite_count)-1)}).catch(()=>{n.Message.error({message:t.has_favorited?"取消订阅失败，请稍后再试":"订阅失败，请稍后再试"})})},initPage(t){if(this.hasInit)return;this.hasInit=!0;const e=t.map((function(t){return t.name}));this.$store.dispatch("q/fetchRecommendTags",{kstrs:e.join(" ")}).then(({})=>{}).catch(()=>{})},fetchEntryStatus(t){this.$store.dispatch("q/fetchFeedbackStatus",{entryId:t}).then(({})=>{}).catch(()=>{console.log("获取词条订阅状态失败！")})}},filters:{}}),ft=Object(m.a)(gt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return null!==t.recommendTagsRight&&t.recommendTagsRight.length>0?i("div",{staticClass:"recommend-tags-container q-right-common-item"},[i("div",{staticClass:"content-wrapper"},[i("div",{staticClass:"title-area"},[i("span",{staticClass:"left-title"},[t._v("推荐词条")]),t._v(" "),i("a",{staticClass:"more-entry",attrs:{href:"/entry/hub?kmref=entry_card",target:"_blank"}},[i("span",{staticClass:"entry-text"},[t._v("词条广场")]),t._v(" "),i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/entry_right",width:16,height:16}})],1)]),t._v(" "),i("div",{staticClass:"tags-area"},[i("ul",t._l(t.list,(function(e){return i("li",{key:e.id,staticClass:"tag-item"},[i("div",{staticClass:"top-line"},[i("a",{staticClass:"tag-name",attrs:{href:"/entry/"+e.target_id+"/home?kmref=entry_card",target:"_blank"}},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),i("div",{staticClass:"subscribe-btn",class:[e.has_favorited?"has-subscribe-btn":"can-subscribe-btn"],on:{click:function(i){return t.operateEntity(e)}}},[e.has_favorited?i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/has_sub",width:14,height:14}}):i("svg-icon",{staticClass:"info-icon",attrs:{name:"q/add_sub",width:14,height:14}}),t._v(" "),i("span",[t._v(t._s(e.has_favorited?"已订阅":"订阅"))])],1)]),t._v(" "),i("div",{staticClass:"bottom-line"},[i("span",[t._v(t._s(e.question_count)+"问题，"+t._s(e.article_count)+"文章")]),t._v(" "),i("span",[t._v(t._s(e.favorite_count)+"人订阅")])])])})),0)])])]):t._e()}),[],!1,null,"5328c3cb",null).exports,_t=i(2074).a},2092:function(t,e,i){"use strict";var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"left-content"},[e("a",{staticClass:"knowledge-link",attrs:{href:"/group/knowledge1?kmref=knowledge_apply",target:"_blank"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"award-card-pic"},[e("img",{attrs:{src:i(2112),width:"100%",height:"100%"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"award-card-link",attrs:{target:"_blank",href:"/articles/show_certificated_articles?kmref=article_kmreward"}},[this._v("\n              查看详细榜单\n              "),e("span",{staticClass:"arrow-icon"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"award-card-pic"},[e("img",{attrs:{src:i(2113),width:"100%",height:"100%"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"award-card-content"},[e("div",{staticClass:"award-card-text"},[this._v("\n              入选KM“头条文章”\n            ")]),this._v(" "),e("a",{staticClass:"award-card-link",attrs:{target:"_blank",href:"/base/headlines?kmref=article_headline"}},[this._v("\n              查看历史头条\n              "),e("span",{staticClass:"arrow-icon"})])])}],s=(i(11),i(12),i(13),i(14),i(15),i(3)),n=i(127),o=i.n(n),r=i(121),l=i(43),c=i(6),d=i.n(c),u=i(1873),p=i(1875),h=i(22),m=i(18),v=i(217),g={cancelBtn:{type:[String,Object,Function],default:""},confirmBtn:{type:[String,Object,Function],default:""},content:{type:[String,Function]},default:{type:[String,Function]},destroyOnClose:{type:Boolean,default:!0},icon:{type:Function},placement:{type:String,default:"top",validator:function(t){return["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right","left-top","left-bottom","right-top","right-bottom"].includes(t)}},popupProps:{type:Object},showArrow:{type:Boolean,default:!0},theme:{type:String,default:"default",validator:function(t){return["default","warning","danger"].includes(t)}},triggerElement:{type:[String,Function]},visible:Boolean,defaultVisible:Boolean,onCancel:Function,onConfirm:Function,onVisibleChange:Function},f=i(10),_=i(20),b=i(424),y=(i(24),i(27),i(16)),w=i.n(y),C=(i(26),i(114),i(58),i(32)),k=i.n(C),O=(i(38),i(17)),x=i.n(O),j=i(23),I=i.n(j),T=i(53),S=i.n(T),D=(i(56),i(25),i(41),i(98),i(97)),q=i.n(D),E=i(48),A=i.n(E),M=i(67),$=i.n(M),L=i(51),P=i.n(L),F=i(46),R=i.n(F),N=i(42),B=i.n(N);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function U(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function H(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var V=Object(h.a)(b.a,Object(m.a)("popconfirm"),Object(m.c)()).extend({name:"TPopconfirm",props:H({},g),model:{prop:"visible",event:"visible-change"},computed:{themeIcon:function(){var t=this.useGlobalIcon({InfoCircleFilledIcon:u.a,ErrorCircleFilledIcon:p.a}),e=t.InfoCircleFilledIcon,i=t.ErrorCircleFilledIcon;return{default:e,warning:i,danger:i}[this.theme]},iconCls:function(){var t=this.theme||"default";return"".concat(this.componentName,"__icon--").concat(t)},innerPopupProps:function(){return H({showArrow:this.showArrow,overlayClassName:[this.componentName,"".concat(this.componentName,"__popup--").concat(this.theme||"default")],trigger:"click",destroyOnClose:this.destroyOnClose,placement:this.placement},this.popupProps)}},methods:{cancelBtnAction:function(t){Object(_.a)(this,"cancel",{e:t});var e={e:t,trigger:"cancel"};Object(_.a)(this,"visible-change",!1,e)},confirmBtnAction:function(t){Object(_.a)(this,"confirm",{e:t});var e={e:t,trigger:"confirm"};Object(_.a)(this,"visible-change",!1,e)},renderIcon:function(){var t=this.$createElement,e=this.themeIcon;return Object(f.c)(this,"icon",t(e,{class:this.iconCls}))},onPopupVisibleChange:function(t,e){this.$emit("visible-change",t,e),this.onVisibleChange&&this.onVisibleChange(t,e)}},render:function(){var t=arguments[0],e=Object(f.a)(this,"default","triggerElement"),i=this.getCancelBtn({cancelBtn:this.cancelBtn,globalCancel:this.global.cancel,size:"small",className:"".concat(this.componentName,"__cancel")}),a=this.getConfirmBtn({theme:this.theme,confirmBtn:this.confirmBtn,globalConfirm:this.global.confirm,size:"small",globalConfirmBtnTheme:this.global.confirmBtnTheme,className:"".concat(this.componentName,"__confirm")});return t(v.a,Object(l.a)([{ref:"popup",attrs:{visible:this.visible}},{props:this.innerPopupProps},{},{on:{"visible-change":this.onPopupVisibleChange}}]),[t("template",{slot:"content",attrs:{role:"popconfirm"}},[t("div",{class:"".concat(this.componentName,"__content")},[t("div",{class:"".concat(this.componentName,"__body")},[this.renderIcon(),t("div",{class:"".concat(this.componentName,"__inner")},[Object(f.b)(this,"content")])]),Boolean(i||a)&&t("div",{class:"".concat(this.componentName,"__buttons")},[i,a])])]),e])}}),z=i(82),G=i(35),K=Object(G.a)(Object(z.a)(["visible"],{model:{prop:"visible",event:"visible-change"}})(V)),W=i(2003),Q=i(2025),J=i(538),Y=i(2044),X=i(2020),Z=i(2073),tt=i(2101),et=i(2067),it=i(531),at=i.n(it),st=i(1914),nt=i.n(st),ot=i(396),rt=i.n(ot),lt=i(397),ct=i.n(lt),dt=i(530),ut=i.n(dt),pt=i(1893),ht=i.n(pt),mt=i(532),vt=i.n(mt),gt=i(144),ft=i(2029),_t=i(542),bt=i(2026),yt={name:"ActionPanel",components:{venomModal:vt.a,venomTextarea:ht.a,venomButton:ut.a,Upload:bt.a,venomDropdown:ct.a,venomDropdownItem:rt.a,venomCheckboxGroup:nt.a,venomCheckbox:at.a,elDialog:gt.Dialog,elInput:gt.Input,elButton:gt.Button},props:{isInGroup:{type:Boolean,default:!1},isOriginGroup:{type:Boolean,default:!0},isAdmin:{type:Boolean,default:!1},isKbarAdmin:{type:Boolean,default:!1},isReshipPeople:{type:Boolean,default:!1},hasEditPermission:{type:Boolean,default:!1},isTop:{type:Boolean,default:!1},isRecommend:{type:Boolean,default:!1},isEssential:{type:Boolean,default:!1},isHidden:{type:Boolean,default:!1},abstractValue:{type:String,default:""},showEditText:{type:Boolean,default:!0}},setup(t,e){Object(s.m)(()=>{});const i=Object(s.r)(!1),a=Object(s.r)(t.abstractValue),n=Object(s.r)(!1),o=Object(s.r)(""),r=Object(s.r)(""),l=Object(s.r)(!1),c=Object(s.r)(!1),d=Object(s.r)([{label:"技术族(T)",value:"T"},{label:"项目族(P) ",value:"P"},{label:"市场族(M)",value:"M"},{label:"专业族(SC)",value:"SC"},{label:"设计族(DG)",value:"DG"}]),u=Object(s.r)([]),p=Object(s.r)(!1),h=Object(s.r)("");return{previewImgUrl:r,isShowAbstractModal:i,onAbstractChange:t=>{a.value=t},onSubmitAbstract:()=>{e.emit("actionDeal","setAbstract",a.value),i.value=!1},onCloseAbstract:()=>{i.value=!1},isShowCoverModal:n,handleUpload:t=>{const{file:i}=t;var a;Object(ft.a)(i)?(!async function(t,i){t.prefix_type="articles_post_header_img";const a=await Object(_t.c)([t]);a?await Object(_t.a)(t,a[0].url,()=>{i&&i(a[0])},()=>{e.root.$toast("上传图片失败，请重新上传",{status:"error",positon:"center"})}):e.root.$toast("上传图片失败，请重新上传",{status:"error",positon:"center"})}(i,t=>{o.value=null==t?void 0:t.name,r.value=null==t?void 0:t.preview_url}),console.log("uploadImg")):null===(a=e.root)||void 0===a||a.$toast("图片格式有误，请选择png或jpg格式的图片",{status:"warning",positon:"center"})},onCloseCover:()=>{n.value=!1,o.value="",r.value=""},onSubmitCover:()=>{e.emit("actionDeal","articleCover",o.value),n.value=!1,o.value="",r.value=""},isCheckAll:l,isShowRecommendModal:c,recommendRanges:d,selectReconmendValue:u,onSelectAllRange:t=>{u.value=t?["T","P","M","SC","DG"]:[]},onGroupChange:t=>{console.log("value",t),6!==t.length&&(l.value=!1)},onSubmitReconmend:()=>{l.value&&(u.value=["ALL",...u.value]),e.emit("actionDeal","recommend",u.value),l.value=!1,u.value=[],c.value=!1},onCloseRecommend:()=>{l.value=!1,u.value=[],c.value=!1},isShowChangeGroupModal:p,groupIdValue:h,onChangeGroupClose:()=>{p.value=!1},onSubmitChangeGroup:()=>{e.emit("actionDeal","changeGroup",h.value),p.value=!1},actionHandle:a=>{e.emit("actionDeal",a),"openAbstract"===a&&(i.value=!0),"openCover"===a&&(n.value=!0),"openRecommend"!==a||t.isRecommend||(c.value=!0),"changeArticleGroup"===a&&(p.value=!0)}}}},wt=i(68),Ct=Object(wt.a)(yt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"action-panel"},[i("venom-dropdown",[i("div",{staticClass:"operation-item item-hover"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/edit",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showEditText,expression:"showEditText"}],staticClass:"item-value"},[t._v("编辑")])],1),t._v(" "),i("template",{slot:"overlay"},[i("div",{staticClass:"action-list"},[!t.isInGroup||t.isOriginGroup?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("edit")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            编辑\n          ")])]):t._e(),t._v(" "),!t.isInGroup||t.isOriginGroup||t.isInGroup&&(t.isKbarAdmin||t.isReshipPeople)?i("venom-dropdown-item",{on:{click:function(){return t.actionHandle("delete")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            删除\n          ")])]):t._e(),t._v(" "),t.isInGroup&&t.isKbarAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("setTop")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            "+t._s(t.isTop?"取消置顶":"置顶")+"\n          ")])]):t._e(),t._v(" "),t.isInGroup&&t.isKbarAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("setEssential")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            "+t._s(t.isEssential?"取消精华":"精华")+"\n          ")])]):t._e(),t._v(" "),t.isAdmin?i("venom-dropdown-item",{class:{"disable-item":t.isRecommend},attrs:{divider:!1},on:{click:function(){return t.actionHandle("openRecommend")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            "+t._s(t.isRecommend?"已推荐":"KM推荐")+"\n          ")])]):t._e(),t._v(" "),t.isAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("openCover")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            文章配图\n          ")])]):t._e(),t._v(" "),t.isAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("openAbstract")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            更改摘要\n          ")])]):t._e(),t._v(" "),t.hasEditPermission?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("exportComment")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            导出评论\n          ")])]):t._e(),t._v(" "),t.hasEditPermission?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("exportVisit")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            导出访问记录\n          ")])]):t._e(),t._v(" "),t.isAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("hideGlobal")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            "+t._s(t.isHidden?"解除全局搜索隐藏":"从全局搜索中隐藏")+"\n          ")])]):t._e(),t._v(" "),t.isAdmin?i("venom-dropdown-item",{attrs:{divider:!1},on:{click:function(){return t.actionHandle("changeArticleGroup")}}},[i("div",{staticClass:"edit-item"},[t._v("\n            更改文章位置\n          ")])]):t._e()],1)])],2),t._v(" "),t.isShowAbstractModal?i("venom-modal",{staticClass:"edit-abstract-modal",attrs:{"disabled-body-scroll":"",width:600},on:{close:t.onCloseAbstract,submit:t.onSubmitAbstract}},[i("template",{slot:"title"},[i("div",{staticClass:"edit-header"},[i("div",[t._v("更改摘要")])])]),t._v(" "),i("template",{slot:"body"},[i("venom-textarea",{attrs:{value:t.abstractValue},on:{change:t.onAbstractChange}})],1)],2):t._e(),t._v(" "),t.isShowCoverModal?i("venom-modal",{staticClass:"edit-cover-modal",attrs:{"disabled-body-scroll":"",width:600},on:{close:t.onCloseCover,submit:t.onSubmitCover}},[i("template",{slot:"title"},[i("div",{staticClass:"edit-header"},[i("div",[t._v("文章配图")])])]),t._v(" "),i("template",{slot:"body"},[i("Upload",{attrs:{multiple:!0,"http-request":t.handleUpload,accept:".jpg,.png"}},[i("venom-button",{staticClass:"input-upload-button"},[t._v("\n          上传图片\n        ")]),t._v(" "),i("span",{staticClass:"subtext"},[t._v("（为保证显示效果，请上传360 X 200的png或jpg格式的图片）")])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.previewImgUrl,expression:"previewImgUrl"}]},[i("img",{staticClass:"cover-preview",attrs:{src:t.previewImgUrl}})])],1)],2):t._e(),t._v(" "),t.isShowRecommendModal?i("venom-modal",{staticClass:"recommend-modal",attrs:{width:720,"disabled-body-scroll":""},on:{close:t.onCloseRecommend,submit:t.onSubmitReconmend}},[i("template",{slot:"title"},[t._v("\n      KM推荐\n    ")]),t._v(" "),i("template",{slot:"body"},[i("div",{staticClass:"recommend-container"},[i("div",{staticClass:"tips-one"},[t._v("\n          推荐后会显示在KM首页和加入KM邮件池，确定推荐吗？\n        ")]),t._v(" "),i("div",{staticClass:"tips-two"},[t._v("\n          选择推送范围 (不勾选则不会推荐到首页信息流中)\n        ")]),t._v(" "),i("div",{staticClass:"select-range"},[i("venom-checkbox",{staticClass:"select-all",on:{change:t.onSelectAllRange},model:{value:t.isCheckAll,callback:function(e){t.isCheckAll=e},expression:"isCheckAll"}},[t._v("\n            全部职位\n          ")]),t._v(" "),i("venom-checkbox-group",{on:{change:t.onGroupChange},model:{value:t.selectReconmendValue,callback:function(e){t.selectReconmendValue=e},expression:"selectReconmendValue"}},t._l(t.recommendRanges,(function(e){return i("venom-checkbox",{key:e.value,attrs:{label:e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})),1)],1)])]),t._v(" "),i("template",{slot:"footer"})],2):t._e(),t._v(" "),i("el-dialog",{staticClass:"change-group-modal",attrs:{visible:t.isShowChangeGroupModal,"before-close":t.onChangeGroupClose,top:"0",width:"580px","modal-append-to-body":!1,"append-to-body":!0,"lock-scroll":!1},on:{"update:visible":function(e){t.isShowChangeGroupModal=e}}},[i("div",{staticClass:"dialog-title",staticStyle:{"font-size":"16px"},attrs:{slot:"title"},slot:"title"},[t._v("\n      更改文章位置\n    ")]),t._v(" "),i("el-input",{attrs:{placeholder:"请输入K吧ID，输入0则移动到知识库"},model:{value:t.groupIdValue,callback:function(e){t.groupIdValue=e},expression:"groupIdValue"}}),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.isShowChangeGroupModal=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitChangeGroup}},[t._v("确 定")])],1)],1)],1)}),[],!1,null,"78ae6646",null).exports,kt=i(1897),Ot=i.n(kt),xt=i(1328),jt=i(77),It=i.n(jt);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Tt(t){var e=t.value,i=t.multiple,a=t.treeStore,s=t.showAllLevels;if(i||"number"!=typeof e&&!e)return"";if(Array.isArray(e))return"";var n=a&&a.getNodes(e);if(!n||!n.length)return e;var o=n&&n[0].getPath();return o&&o.length?s?o.map((function(t){return t.label})).join(" / "):o[o.length-1].label:e}function St(t){var e=[];return t.forEach((function(t){e[t.level]?e[t.level].push(t):e[t.level]=[t]})),e}function Dt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return null==t?void 0:t.getPath().map((function(t){return t.label})).join(e)}var qt=function(t){var e=[];return Array.isArray(t)?t.length>0&&"object"===w()(t[0])?e=t.map((function(t){return t.value})):t.length&&(e=t):t&&(e="object"===w()(t)?[t.value]:[t]),e};
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Et(t,e,i){var a=i.disabled;return["".concat(t,"-cascader__icon"),d()({},e.disabled,a)]}function At(t,e,i){var a=i.checkStrictly,s=i.multiple,n=i.value,o=i.max,r=!a&&t.expanded&&(!s||!t.isLeaf())||a&&t.expanded,l=t.isLeaf(),c=t.disabled||s&&n.length>=o&&0!==o,u=t.checked||s&&!a&&t.expanded&&!l;return[d()(d()(d()({},e.selected,!c&&u),e.expanded,!c&&r),e.disabled,c)]}var Mt=i(237),$t=i(87),Lt=i(64),Pt=i(83),Ft=i(99),Rt=(i(178),i(164)),Nt=i.n(Rt),Bt=i(165),Ut=i.n(Bt);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Ht(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}var Vt=Object(m.d)(),zt={node:{type:Object,default:function(){return{}}},optionChild:{type:[Object,Array]},cascaderContext:{type:Object},onChange:Function,onClick:Function,onMouseenter:Function},Gt=Object(s.c)({mixins:[Vt],directives:{Ripple:Ft.a},props:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ht(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ht(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},zt),setup:function(t){var e=Object(Lt.b)("cascader__item"),i=Object(Lt.b)(),a=Object(Lt.a)(),n=a.STATUS,o=a.SIZE,r=Object(Pt.a)({ChevronRightIcon:xt.a}).ChevronRightIcon,l=Object(s.a)((function(){return function(t,e,i,a,s){var n=s.size;return["".concat(t,"-cascader__item")].concat(A()(At(e,a,s)),[i[n],d()(d()({},"".concat(t,"-cascader__item--with-icon"),!!e.children),"".concat(t,"-cascader__item--leaf"),e.isLeaf())])}(i.value,t.node,o.value,n.value,t.cascaderContext)}));return{COMPONENT_NAME:e,ChevronRightIcon:r,iconClass:Object(s.a)((function(){return function(t,e,i,a){return["".concat(t,"-cascader__item-icon"),"".concat(t,"-icon")].concat(A()(At(e,i,a)))}(i.value,t.node,n.value,t.cascaderContext)})),itemClass:l}},render:function(){var t=this,e=arguments[0],i=this.iconClass,a=this.cascaderContext,s=this.itemClass,n=this.node,o=this.optionChild,r=this.COMPONENT_NAME,c=this.onChange,d=this.ChevronRightIcon;function u(t,i){var a=i.inputVal,s=a?Dt(t):t.label;if(a){for(var n=s.split(a),o=[],l=0;l<n.length&&(o.push(e("span",{key:l},[n[l]])),l!==n.length-1);l++)o.push(e("span",{key:"".concat(l,"filter"),class:"".concat(r,"-label--filter")},[a]));return o}return s}function p(t,i){var a=u(t,i);return e("span",{attrs:{title:i.inputVal?Dt(t):t.label,role:"label"},class:["".concat(r,"-label"),"".concat(r,"-label--ellipsis")]},[a])}function h(t,i){var a=i.checkProps,s=i.value,n=i.max,o=i.inputVal,r=u(t,i);return e(Mt.a,Object(l.a)([{attrs:{checked:t.checked,indeterminate:t.indeterminate,disabled:t.isDisabled()||s.length>=n&&0!==n,name:String(t.value),title:o?Dt(t):t.label,stopLabelTrigger:!!t.children},on:{change:function(t,e){e.e.stopPropagation(),c()}}},a]),[r])}return e("li",{class:s,on:{click:function(e){e.stopPropagation(),t.onClick()},mouseenter:function(e){e.stopPropagation(),t.onMouseenter()}}},[o||(a.multiple?h(n,a):p(n,a)),n.children&&(n.loading?e($t.a,{class:i,attrs:{size:"small"}}):e(d,{class:i}))])}}),Kt={autofocus:Boolean,borderless:Boolean,checkProps:{type:Object},checkStrictly:Boolean,clearable:Boolean,collapsedItems:{type:Function},disabled:Boolean,empty:{type:[String,Function]},filter:{type:Function},filterable:Boolean,inputProps:{type:Object},keys:{type:Object},label:{type:[String,Function]},lazy:{type:Boolean,default:!0},load:{type:Function},loading:Boolean,loadingText:{type:[String,Function]},max:{type:Number,default:0},minCollapsedNum:{type:Number,default:0},multiple:Boolean,option:{type:Function},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:void 0},popupProps:{type:Object},popupVisible:Boolean,readonly:Boolean,reserveKeyword:Boolean,selectInputProps:{type:Object},showAllLevels:{type:Boolean,default:!0},size:{type:String,default:"medium",validator:function(t){return!t||["large","medium","small"].includes(t)}},status:{type:String,default:"default",validator:function(t){return!t||["default","success","warning","error"].includes(t)}},suffix:{type:[String,Function]},suffixIcon:{type:Function},tagInputProps:{type:Object},tagProps:{type:Object},tips:{type:[String,Function]},trigger:{type:String,default:"click",validator:function(t){return!t||["click","hover"].includes(t)}},value:{type:[String,Number,Array],default:function(){return[]}},defaultValue:{type:[String,Number,Array],default:function(){return[]}},valueDisplay:{type:[String,Function]},valueMode:{type:String,default:"onlyLeaf",validator:function(t){return!t||["onlyLeaf","parentFirst","all"].includes(t)}},valueType:{type:String,default:"single",validator:function(t){return!t||["single","full"].includes(t)}},onBlur:Function,onChange:Function,onFocus:Function,onPopupVisibleChange:Function,onRemove:Function},Wt=i(109),Qt=i(106),Jt=i(146),Yt=i.n(Jt);function Xt(t,e){var i=e.disabled,a=e.max,s=e.inputVal,n=e.multiple,o=e.setVisible,r=e.setValue,l=e.treeNodes,c=e.treeStore,d=e.valueType;if(t&&!i&&!t.disabled){var u=t.setChecked(!t.isChecked());if(R()(a)&&a<0&&console.warn("TDesign Warn:","max should > 0"),!(u.length>a&&R()(a)&&a>0)){if(0===u.length){var p=c.getExpanded();setTimeout((function(){c.replaceExpanded(p),c.refreshNodes()}),0)}n||o(!1,{});var h=l.every((function(t){return u.indexOf(t.value)>-1}));s&&h&&o(!1,{}),r("single"===d?u:u.map((function(t){return c.getNode(t).getPath().map((function(t){return t.value}))})),t.checked?"uncheck":"check",t.getModel())}}}function Zt(t){var e=t.setVisible,i=t.multiple,a=t.setExpend,s=t.setValue;e(!1,{}),i&&a([]),s(i?[]:"","clear")}function te(t,e,i){var a=t.disabled,s=t.setValue,n=t.value,o=t.valueType,r=t.treeStore;if(!a){var l=Yt()(n),c=l.splice(e,1),d=r.getNodes(c[0])[0];s(l,"uncheck",d.getModel());var u=d.setChecked(!d.isChecked());s("single"===o?u:u.map((function(t){return r.getNode(t).getPath().map((function(t){return t.value}))})),"uncheck",d.getModel()),S()(i)&&i({value:u,node:d})}}var ee=i(50);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function ie(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function ae(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ie(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var se=Object(s.c)({name:"TCascaderSubPanel",props:{option:Kt.option,empty:Kt.empty,trigger:Kt.trigger,onChange:Kt.onChange,loading:Kt.loading,loadingText:Kt.loadingText,cascaderContext:{type:Object}},setup:function(t,e){var i,a=e.emit,n=Object(Wt.a)(),o=Object(Lt.b)("cascader"),r=Object(ee.a)("cascader").global,l=t.cascaderContext,c=l.valueType,d=l.cascaderValue,u=l.treeStore,p=l.multiple,h=Object(s.a)((function(){return St(t.cascaderContext.treeNodes)})),m=function(e,i){!
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function(t,e,i,a){var s=a.checkStrictly,n=a.multiple,o=a.treeStore,r=a.setVisible,l=a.setValue,c=a.setTreeNodes,d=a.setExpend,u=a.value,p=a.max,h=a.valueType;if(!(i.disabled||n&&u.length>=p&&0!==p)){if(t===e){var m=i.setExpanded(!0);o.refreshNodes(),o.replaceExpanded(m),c(o.getNodes().filter((function(t){return t.visible}))),n&&d(m)}if(!n&&(i.isLeaf()||s)&&"click"===e){o.resetChecked();var v=i.setChecked(!i.checked),g=x()(v,1)[0];l("single"===h?g:i.getPath().map((function(t){return t.value})),"check",i.getModel()),s||r(!1,{})}}}(t.trigger,i,e,t.cascaderContext)};if(null!=u&&null!==(i=u.config)&&void 0!==i&&i.load&&"full"===c&&d.length>0){var v=p?d[0][0]:d[0];m(u.nodes.find((function(t){return t.value===v})),"click")}return{global:r,panels:h,handleExpand:m,renderTNodeJSXDefault:n,COMPONENT_NAME:o,emit:a}},render:function(){var t,e=this,i=arguments[0],a=this.global,s=this.COMPONENT_NAME,n=this.handleExpand,o=this.renderTNodeJSXDefault,r=this.cascaderContext,l=this.panels,c=this.emit,u=function(t,a){var s=t.data.content?Object(Qt.a)(t.data.content(e.$createElement)):o("option",{params:{item:t.data,index:a}});return i(Gt,{key:t.value,attrs:{node:t,cascaderContext:r},props:ae({},{node:t,optionChild:s,cascaderContext:r,onClick:function(){c("click",t.value,t),n(t,"click")},onMouseenter:function(){n(t,"hover")},onChange:function(){Xt(t,r)}})})},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return i("ul",{class:["".concat(s,"__menu"),"narrow-scrollbar",d()(d()({},"".concat(s,"__menu--segment"),a),"".concat(s,"__menu--filter"),e)],key:"".concat(s,"__menu").concat(n)},[t.map((function(t){return u(t,n)}))])},h=function(){return e.empty&&"string"==typeof e.empty?i("div",{class:"".concat(s,"__panel--empty")},[e.empty]):o("empty",i("div",{class:"".concat(s,"__panel--empty")},[a.empty]))},m=function(){var t=r.inputVal,e=r.treeNodes;return t?p(e,!0):l.map((function(t,e){return p(t,!1,e!==l.length-1,e)}))};return t=this.loading?o("loadingText",i("div",{class:"".concat(s,"__panel--empty")},[a.loadingText])):l.length?m():h(),i("div",{class:["".concat(s,"__panel"),d()({},"".concat(s,"--normal"),l.length&&!this.loading)]},[t])}}),ne=i(304),oe=i(303),re=i(1909),le=i.n(re),ce=i(425),de=i.n(ce),ue=i(1910),pe=i(170),he=i.n(pe),me=i(112),ve=i.n(me),ge=i(1904),fe=i.n(ge),_e=i(1900),be=i.n(_e),ye=i(224),we=i.n(ye),Ce=i(115),ke=i.n(Ce),Oe=i(54),xe="__tdesign_tree-node__",je=function(){return Ut()((function t(e){Nt()(this,t),d()(this,xe,void 0),this[xe]=e}),[{key:"value",get:function(){return this[xe].value}},{key:"label",get:function(){return this[xe].label}},{key:"data",get:function(){return this[xe].data}},{key:"actived",get:function(){return this[xe].actived}},{key:"expanded",get:function(){return this[xe].expanded}},{key:"checked",get:function(){return this[xe].checked}},{key:"indeterminate",get:function(){return this[xe].indeterminate}},{key:"loading",get:function(){return this[xe].loading}},{key:"disabled",get:function(){return this[xe].isDisabled()}},{key:"getLevel",value:function(){return this[xe].getLevel()}},{key:"getIndex",value:function(){return this[xe].getIndex()}},{key:"isFirst",value:function(){return this[xe].isFirst()}},{key:"isLast",value:function(){return this[xe].isLast()}},{key:"isLeaf",value:function(){return this[xe].isLeaf()}},{key:"insertBefore",value:function(t){return this[xe].insertBefore(t)}},{key:"insertAfter",value:function(t){return this[xe].insertAfter(t)}},{key:"appendData",value:function(t){return this[xe].append(t)}},{key:"getPath",value:function(){return this[xe].getPath().map((function(t){return t.getModel()}))}},{key:"getParent",value:function(){var t;return null===(t=this[xe].parent)||void 0===t?void 0:t.getModel()}},{key:"getParents",value:function(){return this[xe].getParents().map((function(t){return t.getModel()}))}},{key:"getRoot",value:function(){var t=this[xe].getRoot();return null==t?void 0:t.getModel()}},{key:"getSiblings",value:function(){return this[xe].getSiblings().map((function(t){return t.getModel()}))}},{key:"getChildren",value:function(t){var e=this[xe],i=!1,a=e.children;if(Array.isArray(a))if(a.length>0)if(t){var s=e.walk();s.shift(),i=s.map((function(t){return t.getModel()}))}else i=a.map((function(t){return t.getModel()}));else i=!1;else be()(a)&&(i=a);return i}},{key:"remove",value:function(t){var e=this[xe];if(t){var i=e.tree.getNode(t);if(i)i.getParents().map((function(t){return t.value})).indexOf(e.value)<0?Oe.a.warnOnce("Tree","`".concat(t,"` is not a childNode of current node")):i.remove();else Oe.a.warnOnce("Tree","`".concat(t,"` is not exist"))}else e.remove()}},{key:"setData",value:function(t){var e=this[xe],i=["value","label","disabled"],a=Ot()(t,["children"].concat(i)),s=e.tree.config.keys;i.forEach((function(e){var i=ke()(t,(null==s?void 0:s[e])||e);P()(i)||(a[e]=i)})),Object.assign(e.data,a),Object.assign(e,a),e.update()}}])}();
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Ie(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function Te(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ie(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ie(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Se=Object.prototype.hasOwnProperty,De={expandMutex:null,activable:null,checkable:null,draggable:null,loading:!1},qe=Object.keys(De),Ee=[].concat(qe,["actived","expanded","checked"]),Ae="__tdesign_id__",Me=function(){function t(e,i,a){var s=this;Nt()(this,t),d()(this,"tree",void 0),d()(this,Ae,void 0),d()(this,"value",void 0),d()(this,"label",void 0),d()(this,"data",void 0),d()(this,"parent",void 0),d()(this,"children",void 0),d()(this,"model",void 0),d()(this,"vmIsLeaf",void 0),d()(this,"vmIsFirst",void 0),d()(this,"vmIsLast",void 0),d()(this,"vmIsRest",void 0),d()(this,"vmIsLocked",void 0),d()(this,"expanded",void 0),d()(this,"expandMutex",void 0),d()(this,"actived",void 0),d()(this,"activable",void 0),d()(this,"checkable",void 0),d()(this,"vmCheckable",void 0),d()(this,"checked",void 0),d()(this,"indeterminate",void 0),d()(this,"disabled",void 0),d()(this,"draggable",void 0),d()(this,"visible",void 0),d()(this,"level",void 0),d()(this,"loading",void 0),this.data=i,this.tree=e;var n=e.config||{},o=n.prefix||"t",r=n.keys||{},l=r.children||"children",c=r.label||"label",u=r.value||"value",p=r.disabled||"disabled";this.model=null,this.children=null,this.level=0,this.vmCheckable=!1,this.vmIsLeaf=!1,this.vmIsFirst=!1,this.vmIsLast=!1,this.vmIsRest=!1,this.vmIsLocked=!1,this.visible=!1,this.actived=!1,this.checked=!1,this.indeterminate=!1,this.loading=!1,this.expanded=n.expandAll,this.activable=null,this.checkable=null,this.expandMutex=null,this.draggable=null,this[Ae]=fe()(o),this.value=we()(ke()(i,u))?this[Ae]:ke()(i,u);var h=e.nodeMap,m=e.privateMap;h.get(this.value)&&Oe.a.warn("Tree","Dulplicate value: ".concat(this.value)),h.set(this.value,this),m.set(this[Ae],this),this.label=ke()(i,c)||"",this.disabled=ke()(i,p)||!1;var v=i[l];!0===v&&(this.children=v),this.parent=a&&a instanceof t?a:null,Ee.forEach((function(t){void 0!==i[t]&&(s[t]=i[t])})),this.initActived(),this.initExpanded(),Array.isArray(v)?this.append(v):!0!==v||n.lazy||this.loadChildren(),this.initChecked(),this.updateChecked(),this.update(),e.reflow(this)}return Ut()(t,[{key:"initChecked",value:function(){var t=this.tree,e=this.value,i=this.parent,a=t.checkedMap,s=t.config.checkStrictly;this.checked&&a.set(e,!0),!s&&null!=i&&i.checked&&a.set(e,!0)}},{key:"initExpanded",value:function(){var t=this.tree,e=this.expanded,i=t.config;R()(i.expandLevel)&&this.getLevel()<i.expandLevel&&(t.expandedMap.set(this.value,!0),e=!0),!0===this.children&&i.lazy&&(e=!1),e?t.expandedMap.set(this.value,!0):t.expandedMap.delete(this.value),this.expanded=e}},{key:"initActived",value:function(){var t=this.tree;this.actived&&this.isActivable()&&t.activedMap.set(this.value,!0)}},{key:"append",value:function(e){var i=this,a=[];if(Array.isArray(e)?a.push.apply(a,A()(e)):a.push(e),!(a.length<=0)){Array.isArray(this.children)||(this.children=[]);var s=this.children,n=this.tree;a.forEach((function(e){var a=null;e instanceof t?(a=e).appendTo(i.tree,i):(a=new t(i.tree,e,i),s.push(a))})),n.reflow(this),this.updateRelated()}}},{key:"appendTo",value:function(e,i,a){var s=this,n=i,o=-1;if(R()(a)&&(o=a),((null==n?void 0:n.getParents())||[]).some((function(t){return t===s})))throw new Error("无法将父节点插入到子节点");if(n===this)throw new Error("无法将节点插入到本节点");if(Array.isArray(null==n?void 0:n.children)){var r=null==n?void 0:n.children[o];if(r&&r===this)return}var l=null;if(n instanceof t?(Array.isArray(null==n?void 0:n.children)||(n.children=[]),l=i.children):l=e.children,!Array.isArray(l))throw new Error("无法插入到目标位置，可插入的节点列表不存在");var c=l.length,d=this.getIndex();if(this.remove(),R()(a)){var u=a;if(n===this.parent)l.length<c&&d<=u&&(u-=1);l.splice(u,0,this)}else l.push(this);this.parent=n,this.walk().forEach((function(t){var i=t;i.tree=e,e.nodeMap.set(i.value,i),e.privateMap.set(i[Ae],i),i.expanded&&e.expandedMap.set(i.value,!0)})),((null==n?void 0:n.walk())||e.children.map((function(t){return t.walk()})).flat()).forEach((function(t){t.update(),t.updateChecked()})),e.reflow()}},{key:"insert",value:function(e,i){var a=this.tree,s=this.parent,n=this.getSiblings(),o=null;e instanceof t?(o=e).appendTo(a,s,i):e&&(o=new t(a,e,s),R()(i)&&n.splice(i,0,o),n.forEach((function(t){t.update()}))),a.reflow()}},{key:"insertBefore",value:function(t){var e=this.getIndex();this.insert(t,e)}},{key:"insertAfter",value:function(t){var e=this.getIndex();this.insert(t,e+1)}},{key:"remove",value:function(){var t=this.tree,e=this.walk(),i=this.getSiblings(),a=this.getIndex();Array.isArray(i)&&i.splice(a,1),e.forEach((function(t){t.clean()})),i.forEach((function(t){t.update()})),this.updateParents(),t.reflow()}},{key:"clean",value:function(){var t=this.tree,e=this.value;t.activedMap.delete(e),t.checkedMap.delete(e),t.expandedMap.delete(e),t.nodeMap.delete(e),t.filterMap.delete(e),t.privateMap.delete(this[Ae])}},{key:"loadChildren",value:(e=he()(ve.a.mark((function t(){var e,i;return ve.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=ke()(this,"tree.config")||{},!0!==this.children||this.loading){t.next=13;break}if(!S()(e.load)){t.next=13;break}return this.loading=!0,this.update(),i=[],t.next=8,e.load(this);case 8:i=t.sent,this.tree.emit("load",{node:this,data:i}),this.loading=!1,Array.isArray(i)&&i.length>0?this.append(i):this.children=!1,this.update();case 13:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"set",value:function(t){var e=this,i=this.tree;Object.keys(t).forEach((function(i){(Se.call(De,i)||"label"===i)&&(e[i]=t[i]),"disabled"===i&&e.setDisabled(t[i])})),i.updated(this)}},{key:"getParent",value:function(){return this.parent}},{key:"getParents",value:function(){for(var t=[],e=this.parent;e;)t.push(e),e=e.parent;return t}},{key:"getSiblings",value:function(){var t=this.parent,e=this.tree,i=[];return t?Array.isArray(t.children)&&(i=t.children):e&&(i=e.children),i}},{key:"getChildren",value:function(t){var e=!1,i=this.children;if(Array.isArray(i))if(i.length>0)if(t){var a=this.walk();a.shift(),e=a.map((function(t){return t.getModel()}))}else e=i.map((function(t){return t.getModel()}));else e=!1;else be()(i)&&(e=i);return e}},{key:"getRoot",value:function(){var t=this.getParents();return t[t.length-1]||null}},{key:"getIndex",value:function(){return this.getSiblings().indexOf(this)}},{key:"getPath",value:function(){var t=this.getParents();return t.unshift(this),t.reverse()}},{key:"getLevel",value:function(){return this.getParents().length}},{key:"isRest",value:function(){var t=this.tree,e=t.config,i=t.filterMap,a=!1;if(t.hasFilter){var s=this.getModel();a=e.filter(s)}return a?i.set(this.value,!0):i.get(this.value)&&i.delete(this.value),a}},{key:"isVisible",value:function(){var t=this.tree,e=t.nodeMap,i=t.hasFilter,a=t.config.allowFoldNodeOnFilter;if(!e.get(this.value))return!1;if(i&&!a)return this.vmIsLocked||this.vmIsRest;var s=!0,n=this.getParents();return n.length>0&&(s=n.every((function(t){return t.expanded}))),i?s&&(this.vmIsRest||this.vmIsLocked):s}},{key:"isDisabledState",value:function(){var t=this.tree,e=this.parent,i=t.config,a=i.disabled,s=i.disableCheck,n=i.checkStrictly,o=a||!1;return this.disabled&&(o=!0),!n&&null!=e&&e.isDisabledState()&&(o=!0),"boolean"==typeof s?s&&(o=!0):"function"==typeof s&&s(this.getModel())&&(o=!0),o}},{key:"isDisabled",value:function(){var t=this.tree,e=t.hasFilter,i=t.config.allowFoldNodeOnFilter;return!(!e||i||!this.vmIsLocked||this.vmIsRest)||this.isDisabledState()}},{key:"isDraggable",value:function(){var t=!!ke()(this,"tree.config.draggable");return"boolean"==typeof this.draggable&&(t=this.draggable),t}},{key:"isExpandMutex",value:function(){var t=!!ke()(this,"tree.config.expandMutex");return"boolean"==typeof this.expandMutex&&(t=this.expandMutex),t}},{key:"isActivable",value:function(){var t=!!ke()(this,"tree.config.activable");return"boolean"==typeof this.activable&&(t=this.activable),t}},{key:"isCheckable",value:function(){var t=!!ke()(this,"tree.config.checkable");return"boolean"==typeof this.checkable&&(t=this.checkable),t}},{key:"isActived",value:function(t){var e=this.tree,i=this.value,a=t||e.activedMap;return!(!e.nodeMap.get(i)||!a.get(i))}},{key:"isExpanded",value:function(t){var e=this.tree,i=this.value,a=this.vmIsLocked,s=e.hasFilter,n=e.config.allowFoldNodeOnFilter;if(s&&!n&&a)return!0;var o=t||e.expandedMap;return!(!e.nodeMap.get(i)||!o.get(i))}},{key:"isChecked",value:function(t){var e=this.children,i=this.tree,a=this.value,s=i.config.checkStrictly;if(!i.nodeMap.get(a))return!1;if(!this.isCheckable())return!1;var n=t||i.checkedMap,o=!1;if(n.get(a))return!0;if(s)return!!n.get(a);Array.isArray(e)&&e.length>0?o=e.every((function(t){return t.isChecked(n)})):o=this.getParents().some((function(t){return n.get(t.value)}));return o}},{key:"isIndeterminate",value:function(){var t=this.children,e=this.tree,i=this.value,a=e.config.checkStrictly;if(!e.nodeMap.get(i))return!1;if(!this.isCheckable())return!1;if(a)return!1;if(!Array.isArray(t))return!1;var s=null;return t.some((function(t){return!!t.isIndeterminate()||($()(s)&&(s=t.isChecked()),s!==t.isChecked())}))}},{key:"isFirst",value:function(){return this.getSiblings()[0]===this}},{key:"isLast",value:function(){var t=this.getSiblings();return t[t.length-1]===this}},{key:"isLeaf",value:function(){var t=!1;return t=Array.isArray(this.children)?this.children.length<=0:!this.children,t}},{key:"lock",value:function(t){this.vmIsLocked=t,this.expanded=this.isExpanded(),this.visible=this.isVisible()}},{key:"afterExpanded",value:function(){this.update(),this.expanded&&!0===this.children&&this.loadChildren(),this.updateChildren()}},{key:"toggleExpanded",value:function(t){return this.setExpanded(!this.isExpanded(),t)}},{key:"setExpanded",value:function(t,e){var i=this.tree,a=i.config,s=Te({directly:!1},e),n=i.expandedMap;if(s.directly||(n=new Map(i.expandedMap)),t){var o=[];o.push(this),a.expandParent&&this.getParents().forEach((function(t){o.push(t)})),o.forEach((function(t){var e,a=!1;t.parent?a=t.parent.isExpandMutex():a=null==i||null===(e=i.config)||void 0===e?void 0:e.expandMutex;a&&t.getSiblings().forEach((function(t){n.delete(t.value),t.update(),t.updateChildren()}));n.set(t.value,!0),t.update(),t.updateChildren()}))}else n.delete(this.value);return s.directly&&this.afterExpanded(),i.getExpanded(n)}},{key:"toggleActived",value:function(t){return this.setActived(!this.isActived(),t)}},{key:"setActived",value:function(t,e){var i=this.tree,a=Te({isAction:!0,directly:!1},e),s=i.config||{},n=i.activedMap;if(a.directly||(n=new Map(i.activedMap)),a.isAction&&this.isDisabledState())return i.getActived(n);if(this.isActivable())if(t){var o=Array.from(n.keys());s.activeMultiple||n.clear(),o.forEach((function(t){var e=i.getNode(t);null==e||e.update()})),n.set(this.value,!0)}else n.delete(this.value);return this.update(),i.getActived(n)}},{key:"hasEnableUnCheckedChild",value:function(){var t=this.children;if(!Array.isArray(t)||t.length<=0)return!1;var e=!1;return t.some((function(t){return!t.isDisabledState()&&(!t.isChecked()&&(t.isIndeterminate()?!!t.hasEnableUnCheckedChild()&&(e=!0,!0):(e=!0,!0)))})),e}},{key:"toggleChecked",value:function(t){if(this.isIndeterminate()){var e=this.hasEnableUnCheckedChild();return this.setChecked(e,t)}return this.setChecked(!this.isChecked(),t)}},{key:"setChecked",value:function(t,e){var i=this.tree,a=i.config||{},s=Te({isAction:!0,directly:!1},e),n=i.checkedMap;if(s.directly||(n=new Map(i.checkedMap)),!this.isCheckable())return i.getChecked(n);if(s.isAction&&this.isDisabledState())return i.getChecked(n);if(t===this.isChecked()&&!(this.isIndeterminate()&&!this.hasEnableUnCheckedChild()))return i.getChecked(n);(t?n.set(this.value,!0):n.delete(this.value),a.checkStrictly)?s.directly&&this.updateChecked():(this.spreadChildrenChecked(t,n,s),this.spreadParentChecked(t,n,s),s.directly&&i.getRelatedNodes([this.value],{reverse:!0}).forEach((function(t){t.updateChecked()})));return i.getChecked(n)}},{key:"spreadParentChecked",value:function(t,e,i){var a=Te({isAction:!0,directly:!1},i);if(this.isCheckable()){var s=this.children;Array.isArray(s)&&s.length>0&&e.delete(this.value);var n=this.parent;n&&n.spreadParentChecked(t,e,a)}}},{key:"spreadChildrenChecked",value:function(t,e,i){var a=Te({isAction:!0,directly:!1},i);if(this.isCheckable()&&(!a.isAction||!this.isDisabledState())){var s=this.children;Array.isArray(s)&&(s.length<=0||(e.delete(this.value),s.forEach((function(i){a.isAction&&i.isDisabledState()||(t?e.set(i.value,!0):e.delete(i.value),i.spreadChildrenChecked(t,e,a))}))))}}},{key:"setDisabled",value:function(t){this.disabled=t,this.update(),this.updateChildren()}},{key:"update",value:function(){this.level=this.getLevel(),this.vmIsFirst=this.isFirst(),this.vmIsLast=this.isLast(),this.vmIsLeaf=this.isLeaf(),this.vmCheckable=this.isCheckable(),this.vmIsRest=this.isRest(),this.actived=this.isActived(),this.expanded=this.isExpanded(),this.visible=this.isVisible(),this.tree.updated(this)}},{key:"updateChecked",value:function(){var t=this.tree,e=this.value,i=t.checkedMap;this.checked=this.isChecked(),this.indeterminate=this.isIndeterminate(),this.checked&&i.set(e,!0),t.updated(this)}},{key:"updateChildren",value:function(){var t=this;this.spreadChildren((function(e){e!==t&&(e.update(),e.updateChecked())}))}},{key:"updateParents",value:function(){var t=this;this.spreadParents((function(e){e!==t&&(e.update(),e.updateChecked())}))}},{key:"updateRelated",value:function(){this.tree.getRelatedNodes([this.value]).forEach((function(t){t.update(),t.updateChecked()}))}},{key:"walk",value:function(){var t=[];return this.spreadChildren((function(e){t.push(e)})),t}},{key:"spreadChildren",value:function(t){t(this);var e=this.children;Array.isArray(e)&&e.length>0&&e.forEach((function(e){null==e||e.spreadChildren(t)}))}},{key:"spreadParents",value:function(t){t(this);var e=this.parent;e&&(null==e||e.spreadParents(t))}},{key:"getModel",value:function(){var t=this.model;return t||(t=new je(this),this.model=t),t}}]);var e}();
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function $e(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function Le(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$e(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Pe=function(){return Ut()((function t(e){Nt()(this,t),d()(this,"children",void 0),d()(this,"nodes",void 0),d()(this,"nodeMap",void 0),d()(this,"privateMap",void 0),d()(this,"config",void 0),d()(this,"activedMap",void 0),d()(this,"updatedMap",void 0),d()(this,"checkedMap",void 0),d()(this,"expandedMap",void 0),d()(this,"filterMap",void 0),d()(this,"hasFilter",void 0),d()(this,"emitter",void 0),d()(this,"updateTick",void 0),d()(this,"shouldReflow",void 0),d()(this,"prevFilter",void 0);var i=Le({prefix:"t",keys:{},expandAll:!1,expandLevel:0,expandMutex:!1,expandParent:!1,activable:!1,activeMultiple:!1,checkable:!1,checkStrictly:!1,disabled:!1,disableCheck:!1,draggable:!1,load:null,lazy:!1,valueMode:"onlyLeaf",filter:null,allowFoldNodeOnFilter:!1,onLoad:null,onReflow:null,onUpdate:null},e);this.config=i,this.nodes=[],this.children=[],this.nodeMap=new Map,this.privateMap=new Map,this.activedMap=new Map,this.expandedMap=new Map,this.checkedMap=new Map,this.updatedMap=new Map,this.filterMap=new Map,this.prevFilter=null,this.updateTick=null,this.shouldReflow=!1,this.hasFilter=S()(i.filter),this.emitter=Object(ue.a)()}),[{key:"setConfig",value:function(t){var e=this.config,i=!1;Object.keys(t).forEach((function(a){var s=t[a];s!==e[a]&&(i=!0,e[a]=s)})),this.hasFilter=S()(e.filter),i&&this.refreshState()}},{key:"getChildren",value:function(){return this.children}},{key:"getNode",value:function(t){var e=null;return k()(t)||R()(t)?e=this.nodeMap.get(t):t instanceof Me&&(e=this.nodeMap.get(t.value)),e||(e=null),e}},{key:"getIndex",value:function(t){return this.nodes.indexOf(t)}},{key:"getParent",value:function(t){var e=null,i=this.getNode(t);return i&&(e=i.getParent()),e}},{key:"getParents",value:function(t){var e=this.getNode(t),i=[];return e&&(i=e.getParents()),i}},{key:"getNodeIndex",value:function(t){var e=this.getNode(t),i=-1;return e&&(i=e.getIndex()),i}},{key:"getNodes",value:function(t,e){var i=[],a="";if(k()(t)||R()(t)?a=t:t instanceof Me&&(a=t.value),a){var s=this.getNode(a);s&&(i=s.walk())}else i=this.nodes.slice(0);if(e){var n=Le({filter:null,level:1/0},e);R()(n.level)&&n.level!==1/0&&(i=i.filter((function(t){return t.level<=n.level}))),S()(n.filter)&&(i=i.filter((function(t){var e=t.getModel();return n.filter(e)}))),de()(n.props)&&(i=i.filter((function(t){return Object.keys(n.props).every((function(e){return t[e]===n.props[e]}))})))}return i}},{key:"append",value:function(t){var e=this;t.forEach((function(t){var i=new Me(e,t);e.children.push(i)})),this.reflow()}},{key:"reload",value:function(t){this.removeAll(),this.append(t)}},{key:"parseNodeData",value:function(t,e){var i="",a=null,s=null;return k()(t)||R()(t)?(i=t,a=this.getNode(i),s=e):t instanceof Me&&e?(a=t,s=e):s=t,{node:a,data:s}}},{key:"appendNodes",value:function(t,e){var i=this.parseNodeData(t,e);i.data&&(i.node?(i.data instanceof Me?i.data.appendTo(this,i.node):B()(i.data)?i.node.append(i.data):i.node.append([i.data]),i.node.updateRelated()):i.data instanceof Me?i.data.appendTo(this):Array.isArray(i.data)?this.append(i.data):this.append([i.data]))}},{key:"insertBefore",value:function(t,e){var i=this.getNode(t);i&&i.insertBefore(e)}},{key:"insertAfter",value:function(t,e){var i=this.getNode(t);i&&i.insertAfter(e)}},{key:"refreshNodes",value:function(){var t=this.children,e=this.nodes;e.length=0,t.forEach((function(t){var i=t.walk();Array.prototype.push.apply(e,i)}))}},{key:"reflow",value:function(t){this.shouldReflow=!0,this.updated(t)}},{key:"updated",value:function(t){var e,i,a=this,s=this.updatedMap;(t?s.set(t[Ae],"changed"):this.getNodes().forEach((function(t){s.set(t[Ae],"changed")})),this.updateTick)||(this.updateTick=(e=function(){a.updateTick=null,a.shouldReflow&&(a.refreshNodes(),a.emit("reflow")),a.lockFilterPathNodes();var t="t".concat((new Date).getTime()),e=Array.from(s.keys()).map((function(e){return s.set(e,t),a.privateMap.get(e)}));a.emit("update",{nodes:e,map:s}),a.shouldReflow=!1,s.clear()},(i=Promise.resolve()).then(e),i))}},{key:"getActived",value:function(t){var e=t||this.activedMap;return Array.from(e.keys())}},{key:"getActivedNodes",value:function(t){var e=this.getNodes(t);return e=e.filter((function(t){return t.isActived()}))}},{key:"replaceActived",value:function(t){this.resetActived(),this.setActived(t)}},{key:"setActived",value:function(t){var e=this,i=this.config.activeMultiple,a=t.slice(0);i||(a.length=1),a.forEach((function(t){e.activedMap.set(t,!0);var i=e.getNode(t);i&&i.update()}))}},{key:"resetActived",value:function(){var t=this.getActived();this.activedMap.clear(),this.getRelatedNodes(t).forEach((function(t){t.update()}))}},{key:"getExpanded",value:function(t){var e=t||this.expandedMap;return Array.from(e.keys())}},{key:"replaceExpanded",value:function(t){var e=this.getExpanded(),i=le()(t,e),a=le()(e,t);this.setExpandedDirectly(a,!1),this.updateExpanded(a),this.setExpanded(i)}},{key:"setExpanded",value:function(t){this.setExpandedDirectly(t),this.updateExpanded(t)}},{key:"setExpandedDirectly",value:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.forEach((function(t){i?e.expandedMap.set(t,!0):e.expandedMap.delete(t);var a=e.getNode(t);a&&a.afterExpanded()}))}},{key:"resetExpanded",value:function(){var t=this.getExpanded();this.expandedMap.clear(),this.updateExpanded(t)}},{key:"updateExpanded",value:function(t){this.getRelatedNodes(t,{withParents:!1}).forEach((function(t){t.update()}))}},{key:"getChecked",value:function(t){var e=this.nodeMap,i=this.config,a=i.valueMode,s=i.checkStrictly,n=[],o=t||this.checkedMap;return e.forEach((function(t){t.isChecked(o)&&("parentFirst"!==a||s?("onlyLeaf"!==a||s||t.isLeaf())&&n.push(t.value):t.parent&&t.parent.isChecked(o)||n.push(t.value))})),n}},{key:"getCheckedNodes",value:function(t){var e=this.getNodes(t);return e=e.filter((function(t){return t.isChecked()}))}},{key:"replaceChecked",value:function(t){this.resetChecked(),this.setChecked(t)}},{key:"setChecked",value:function(t){var e=this,i=this.config,a=i.checkStrictly;if(i.checkable&&(t.forEach((function(t){var i=e.getNode(t);i&&(a?(e.checkedMap.set(t,!0),i.updateChecked()):i.walk().forEach((function(t){e.checkedMap.set(t.value,!0)})))})),!a)){var s=this.getChecked();this.getRelatedNodes(s).forEach((function(t){t.updateChecked()}))}}},{key:"resetChecked",value:function(){var t=this.getChecked(),e=this.getRelatedNodes(t);this.checkedMap.clear(),e.forEach((function(t){t.updateChecked()}))}},{key:"refreshState",value:function(){this.nodeMap.forEach((function(t){t.update()}))}},{key:"updateAll",value:function(){this.nodeMap.forEach((function(t){t.update(),t.updateChecked()}))}},{key:"remove",value:function(t){var e=this.getNode(t);e&&e.remove()}},{key:"removeAll",value:function(){this.expandedMap.clear(),this.checkedMap.clear(),this.activedMap.clear(),this.filterMap.clear(),this.nodeMap.clear(),this.privateMap.clear(),this.updatedMap.clear(),this.nodes=[],this.children=[],this.reflow()}},{key:"getRelatedNodes",value:function(t,e){var i=this,a=Le({reverse:!1,withParents:!0},e),s=new Map;t.forEach((function(t){if(!s.get(t)){var e=i.getNode(t);if(e){var n=e.getParents().reverse(),o=e.walk();(a.withParents?n.concat(o):o).forEach((function(t){s.set(t.value,t)}))}}}));var n=Array.from(s.values());return a.reverse&&(n=n.reverse()),n}},{key:"emit",value:function(t,e){var i=this.config,a=this.emitter,s=i[I()("on-".concat(t))];S()(s)&&s(e),a.emit(t,e)}},{key:"lockFilterPathNodes",value:function(){var t=this.config,e=this.getNodes();this.prevFilter&&e.forEach((function(t){t.vmIsLocked&&t.lock(!1)}));var i=t.filter;i&&S()(i)&&(this.prevFilter=t.filter,e.reverse().forEach((function(t){var e=t.getParent();e&&(t.vmIsRest||t.vmIsLocked)&&(e.vmIsLocked||e.lock(!0))})))}}])}(),Fe=i(72),Re=i(86);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Ne(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function Be(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ne(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ue=function(t){var e=t.disabled,i=Object(s.t)(t),a=i.value,n=i.popupVisible,o=Object(Fe.a)(a,t.defaultValue,t.onChange,"change"),r=x()(o,2),l=r[0],c=r[1],d=Object(Re.a)(n,!1,t.onPopupVisibleChange,"popupVisible","popup-visible-change"),u=x()(d,2),p=u[0],h=u[1],m=function(t,e,i,a){var n=Object(s.q)({treeStore:null,inputVal:null,scopeVal:void 0,treeNodes:[],expend:[]});return{statusContext:n,cascaderContext:Object(s.a)((function(){var s=t.size,o=t.checkStrictly,r=t.lazy,l=t.multiple,c=t.filterable,d=t.clearable,u=t.checkProps,p=t.max,h=t.disabled,m=t.showAllLevels,v=t.minCollapsedNum,g=t.valueType,f=t.value;return Be(Be({value:n.scopeVal,size:s,checkStrictly:o,lazy:r,multiple:l,filterable:c,clearable:d,checkProps:u,max:p,disabled:h,showAllLevels:m,minCollapsedNum:v,valueType:g,visible:i.value,cascaderValue:f},n),{},{setTreeNodes:function(t){n.treeNodes=t},setValue:function(t,i,a){q()(t,n.scopeVal)||e(t,{source:i,node:a})},setVisible:a,setInputVal:function(t){n.inputVal=t},setExpend:function(t){n.expend=t}})}))}}(t,c,p,h),v=m.cascaderContext,g=m.statusContext,f=Object(s.a)((function(){return Boolean(t.filterable||S()(t.filter))})),_=function(){var e=v.value;!function(t,e,i,a){if(e){var s=[];if(t){s=e.nodes.filter((function(e){if(e.isLeaf())return S()(a)?a("".concat(t),e):Dt(e,"").indexOf("".concat(t))>-1}))}else s=e.getNodes().filter((function(t){return t.visible}));i(s)}}(e.inputVal,e.treeStore,e.setTreeNodes,t.filter)},b=function(){var t=v.value,e=t.value,i=t.treeStore;!function(t,e,i){var a=qt(e);if(t){if(Array.isArray(a)&&0===i.length){var s=new Map,n=x()(a,1)[0];if(n){s.set(n,!0);var o=t.getNode(n);if(!o)return void t.refreshNodes();o.getParents().forEach((function(t){s.set(t.value,!0)}));var r=Array.from(s.keys());t.replaceExpanded(r)}else t.resetExpanded()}t.getExpanded()&&i.length&&t.replaceExpanded(i),t.refreshNodes()}}(i,e,g.expend),i.replaceChecked(qt(e))};Object(s.u)((function(){return t.options}),(function(){var e=t.options,i=t.keys,a=void 0===i?{}:i,n=t.checkStrictly,o=t.lazy,r=t.load,l=t.valueMode,c=g.treeStore;if(e.length||c){if(c)c.reload(e),c.refreshNodes();else{var d=new Pe({keys:Be(Be({},a),{},{children:"string"==typeof a.children?a.children:"children"}),checkable:!0,expandMutex:!0,expandParent:!0,checkStrictly:n,lazy:o,load:r,valueMode:l,onLoad:function(){Object(s.g)((function(){d.refreshNodes(),_(),function(){var e=t.value,i=t.multiple,a=g.treeStore;if(e instanceof Array){if(!i&&e.length>a.expandedMap.size){var s=e.slice(0,a.expandedMap.size+1);a.setExpanded(s)}if(i){if(e.length>0){var n=e[0];n.length>a.expandedMap.size&&a.setExpanded(n.slice(0,a.expandedMap.size+1))}var o=e.map((function(t){return t[t.length-1]}));a.setChecked(o)}}}()}))}});d.append(e),g.treeStore=d}b(),_()}}),{immediate:!0,deep:!0}),Object(s.u)((function(){var e=t.checkStrictly,i=t.lazy,a=t.load,s=t.valueMode;return JSON.stringify({valueMode:s,checkStrictly:e,lazy:i,load:a})}),(function(){var i=g.treeStore;if(i){var a=t.checkStrictly,s=t.lazy,n=t.load,o=t.valueMode,r={checkStrictly:a,disabled:e,load:n,lazy:s,valueMode:o};i.setConfig(r)}}),{immediate:!0}),Object(s.u)(l,(function(){var t=v.value,e=t.setValue,i=t.multiple,a=t.valueType;(function(t,e){var i=e.multiple,a=e.showAllLevels;return i&&!Array.isArray(t)||!i&&Array.isArray(t)&&!a})(l.value,v.value)&&e(i?[]:"","invalid-value"),!function(t){return!("number"==typeof t&&!isNaN(t))&&It()(t)}(l)?g.scopeVal=function(t,e,i){return"single"===e?t:i?t.map((function(t){return t[t.length-1]})):t[t.length-1]}(l.value,a,i):g.scopeVal=i?[]:"",g.treeStore&&(b(),_())}),{immediate:!0}),Object(s.u)((function(){return p.value&&f.value}),(function(t){var e=v.value.setInputVal;t&&e("")})),Object(s.u)((function(){return g.inputVal}),(function(){_()}));return{innerValue:l,cascaderContext:v,isFilterable:f,getCascaderItems:function(t){var e=[];return t.forEach((function(t){var i,a=null===(i=g.treeStore)||void 0===i?void 0:i.getNodes(t);a&&a[0]&&e.push(a[0].data)})),e}}},He=i(80);i(214),i(124);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function Ve(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function ze(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ve(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ve(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ge=Object(s.c)({name:"TCascader",props:ze({},Kt),setup:function(t,e){var i=e.emit,a=Object(Lt.b)("cascader"),n=Object(Lt.b)(),o=Object(Lt.a)().STATUS,r=Object(Lt.b)("cascader__popup"),l=Object(ee.a)("cascader").global,c=Ue(t),d=c.innerValue,u=c.cascaderContext,p=c.isFilterable,h=c.getCascaderItems,m=Object(s.a)((function(){return t.multiple?function(t){var e=t.value,i=t.multiple,a=t.treeStore,s=t.showAllLevels;return i?i&&!Array.isArray(e)?[]:a&&a.getNodes(e)?e.map((function(t){var e=a.getNodes(t);return s?Dt(e[0]):e[0].label})).filter((function(t){return!!t})):[]:[]}(u.value):Tt(u.value)})),v=Object(s.a)((function(){return St(u.value.treeNodes)})),g=Object(s.a)((function(){var e;if(u.value.visible&&!t.multiple){var i=Tt(u.value);return"number"==typeof i&&(i=String(i)),i}return null!==(e=t.placeholder)&&void 0!==e?e:l.value.placeholder})),f=Object(He.a)().formDisabled,_=Object(s.a)((function(){return f.value||u.value.disabled})),b=Object(s.a)((function(){var e=d.value instanceof Array?d.value:[d.value],i=t.multiple&&t.minCollapsedNum?e.slice(0,t.minCollapsedNum):d.value,a=h(e);return{value:d.value,selectedOptions:a,onClose:function(e){te(u.value,e,t.onRemove)},displayValue:i}}));return{COMPONENT_NAME:a,overlayClassName:r,panels:v,innerValue:d,displayValue:m,inputPlaceholder:g,isFilterable:p,isDisabled:_,STATUS:o,classPrefix:n,cascaderContext:u,emit:i,valueDisplayParams:b}},render:function(){var t,e=this,i=arguments[0],a=this.valueDisplayParams,s=this.COMPONENT_NAME,n=this.overlayClassName,o=this.panels,r=this.displayValue,l=this.inputPlaceholder,c=this.isFilterable,d=this.isDisabled,u=this.STATUS,p=this.classPrefix,h=this.cascaderContext,m=this.emit,v=function(){return Object(f.b)(e,"valueDisplay",{params:a})},g=function(){var t=Object(f.b)(e,"suffixIcon");if(t)return t;var a=h.visible;return i(oe.a,{attrs:{overlayClassName:Et(p,u,h),isActive:a,disabled:d}})},_=h.setVisible,b=h.visible,y=h.inputVal,w=h.setInputVal,C=this.$scopedSlots;return i(ne.a,{class:s,props:ze({},ze({value:r,inputValue:b?y:"",popupVisible:b,keys:this.keys,allowInput:c,minCollapsedNum:this.minCollapsedNum,collapsedItems:this.collapsedItems,label:this.label,valueDisplay:v,suffix:this.suffix,tag:this.tag,readonly:this.readonly,disabled:d,clearable:this.clearable,placeholder:l,multiple:this.multiple,loading:this.loading,status:this.status,tips:this.tips,suffixIcon:function(){return g()},popupProps:ze(ze({},this.popupProps),{},{overlayInnerStyle:o.length&&!this.loading?{width:"auto"}:"",overlayClassName:[n,null===(t=this.popupProps)||void 0===t?void 0:t.overlayClassName]}),inputProps:ze({size:this.size},this.inputProps),tagInputProps:ze({size:this.size},this.tagInputProps),tagProps:ze({},this.tagProps),onInputChange:function(t,i){var a,s;e.isFilterable&&(w("".concat(t)),null==e||null===(a=e.selectInputProps)||void 0===a||null===(s=a.onInputChange)||void 0===s||s.call(a,t,i))},onTagChange:function(t,i){var a,s;"enter"!==i.trigger&&(te(h,i.index,e.onRemove),null===(a=e.selectInputProps)||void 0===a||null===(s=a.onTagChange)||void 0===s||s.call(a,t,i))},onPopupVisibleChange:function(t,i){var a,s;e.disabled||(_(t,i),null===(a=e.selectInputProps)||void 0===a||null===(s=a.onPopupVisibleChange)||void 0===s||s.call(a,t,i))},onBlur:function(t,i){var a,s,n,o={value:h.value,inputValue:i.inputValue||"",e:i.e};null===(a=e.onBlur)||void 0===a||a.call(e,o),m("blur",o),null===(s=e.selectInputProps)||void 0===s||null===(n=s.onBlur)||void 0===n||n.call(s,t,i)},onFocus:function(t,i){var a,s,n,o={value:h.value,e:i.e};null===(a=e.onFocus)||void 0===a||a.call(e,o),m("focus",o),null===(s=e.selectInputProps)||void 0===s||null===(n=s.onFocus)||void 0===n||n.call(s,t,i)},onClear:function(t){var i,a;Zt(h),null===(i=e.selectInputProps)||void 0===i||null===(a=i.onClear)||void 0===a||a.call(i,t)}},Ot()(this.selectInputProps,["onTagChange","onInputChange","onPopupVisibleChange","onBlur","onFocus","onClear"]))),scopedSlots:{panel:function(){return i(se,{attrs:{option:e.option,empty:e.empty,trigger:e.trigger,loading:e.loading,loadingText:e.loadingText,cascaderContext:h},scopedSlots:{option:C.option,empty:C.empty,loadingText:C.loadingText}})},tips:C.tips,tag:C.tag,suffix:C.suffix,label:C.label,collapsedItems:C.collapsedItems}})}});
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */function Ke(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}var We=Object(s.c)({name:"TCascaderPanel",props:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ke(Object(i),!0).forEach((function(e){d()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ke(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},Kt),setup:function(t,e){var i=e.slots,a=e.emit;return{cascaderContext:Ue(t).cascaderContext,slots:i,onClick:function(t,e){a("click",t,e)}}},render:function(){var t=arguments[0];return t(se,{attrs:{empty:this.empty,trigger:this.trigger,cascaderContext:this.cascaderContext},scopedSlots:{empty:this.slots.empty},on:{click:this.onClick}})}}),Qe=Object(G.a)(Ge,s.b),Je=(Object(G.a)(We,s.b),i(528)),Ye=i(2015),Xe={name:"ElPopconfirm",props:{title:{type:String},confirmButtonText:{type:String},cancelButtonText:{type:String},confirmButtonType:{type:String,default:"primary"},cancelButtonType:{type:String,default:"text"},icon:{type:String,default:"el-icon-question"},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1}},components:{ElPopover:gt.Popover,ElButton:gt.Button},data:()=>({visible:!1}),computed:{displayConfirmButtonText(){return this.confirmButtonText||"确定"},displayCancelButtonText(){return this.cancelButtonText||"取消"}},methods:{confirm(){this.visible=!1,this.$emit("confirm")},cancel(){this.visible=!1,this.$emit("cancel")}}},Ze=Object(wt.a)(Xe,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",t._g(t._b({attrs:{trigger:"click"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},"el-popover",t.$attrs,!1),t.$listeners),[i("div",{staticClass:"el-popconfirm"},[i("p",{staticClass:"el-popconfirm__main"},[t.hideIcon?t._e():i("i",{staticClass:"el-popconfirm__icon",class:t.icon,style:{color:t.iconColor}}),t._v("\n      "+t._s(t.title)+"\n    ")]),t._v(" "),t._t("content"),t._v(" "),i("div",{staticClass:"el-popconfirm__action"},[i("el-button",{attrs:{size:"mini",type:t.cancelButtonType},on:{click:t.cancel}},[t._v("\n        "+t._s(t.displayCancelButtonText)+"\n      ")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:t.confirmButtonType},on:{click:t.confirm}},[t._v("\n        "+t._s(t.displayConfirmButtonText)+"\n      ")])],1)],2),t._v(" "),t._t("reference",null,{slot:"reference"})],2)}),[],!1,null,"0719e145",null).exports,ti=i(2014),ei=i(2006),ii=i(2035),ai=i(2036),si={name:"ReshipModal",components:{elTag:gt.Tag,elPopover:gt.Popover,TCascader:Qe,ElPopconfirm:Ze,kmModal:ti.a,kmButton:ei.a},props:{groupId:{type:String},postId:{type:String}},setup(t,e){const i=Object(s.r)([]),a=Object(s.r)(""),n=Object(s.a)(()=>{var t;return null===(t=e.root.$store.getters["global/userInfo"])||void 0===t?void 0:t.user_info}),{isAdmin:o,isKbarAdmin:r,actionData:l,fetchAcions:c}=Object(ii.a)(),{isShowConfirmModal:d,reshipTargetId:u,onOpenConfirmModal:p,onCloseConfirmModal:h}=Object(ii.n)(),m=Object(s.a)(()=>{var t,e,i;return(null==l||null===(t=l.value)||void 0===t||null===(e=t.reship)||void 0===e||null===(i=e.reship_records)||void 0===i?void 0:i.map(t=>{var e;return{...t,canRevoke:o.value||r.value||t.created_by===(null==n||null===(e=n.value)||void 0===e?void 0:e.nick)}}))||[]}),v=Object(s.a)(()=>{const t=new Set(m.value.map(t=>t.group_id.toString()));return i.value.filter(e=>!t.has(e.id.toString()))}),g=i=>{Object(W.Q)({targetGroupId:i,postId:t.postId,categoryId:a.value}).then(({data:i})=>{c(t.groupId,t.postId);i.message={reshiped:"此文章已转载，无需重复转载",private:"保密k吧无法转载"}[i.message]||i.message,Object(Ye.a)(e.root)(i)})},f=Object(s.r)(),_=Object(s.r)(),b=Object(s.r)();Object(s.u)(m,t=>{e.emit("reshipRecordsChange",t)});const y=Object(s.r)([]);return{kbarList:i,reshipRecords:m,unreshipRecords:v,isShowConfirmModal:d,reshipTargetId:u,handleReship:t=>{ai.b.includes(t)?p(t):g(t)},handleConfirmReship:()=>{g(u.value),h()},handleRevokeReship:async(i,a)=>{const{data:s}=await Object(W.b)({groupId:i,postId:a});0!==s.code?e.root.$toast(s.message||"取消转载失败，请刷新页面重试",{status:"error",positon:"center"}):c(t.groupId,t.postId)},onShow:()=>{c(t.groupId,t.postId),Object(Je.p)().then(({data:t})=>{var e;0===(null==t?void 0:t.code)&&(i.value=(null==t||null===(e=t.data)||void 0===e?void 0:e.kbars)||[])})},hackPopoverVisible:(t,e)=>{if(b.value){const[i,a]=b.value,s=null==i?void 0:i[a];s&&s!==(null==t?void 0:t[e])&&"function"==typeof s.cancel&&s.cancel()}b.value=[t,e]},onCloseConfirmModal:h,refReship:f,refUnreship:_,getReshipLink:ai.d,getGroupArtCats:t=>{y.value=[],a.value="",Object(Je.g)({group_id:t}).then(({data:t})=>{if(0===(null==t?void 0:t.code)){var e,i;const a=null==t||null===(e=t.data)||void 0===e||null===(i=e.list)||void 0===i?void 0:i.map(t=>{const e=t.children.map(t=>({value:t.category.id,label:t.category.name,children:[]}));return{value:t.category.id,label:t.category.name,children:e}});y.value=a||[]}})},groupCats:y,selectedCat:a}}},ni=Object(wt.a)(si,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{trigger:"click",width:600,"popper-class":"article-reship-popover",placement:"bottom-start","visible-arrow":!1},on:{show:t.onShow}},[i("div",{staticClass:"article-reship-popoverctx",on:{click:t.hackPopoverVisible}},[i("div",{staticClass:"block"},[i("div",{staticClass:"block-title"},[t._v("\n        已转载\n      ")]),t._v(" "),i("div",{staticClass:"block-content"},t._l(t.reshipRecords,(function(e,a){return i("el-tag",{key:e.group_id,staticClass:"tag"},[t._v("\n          "+t._s(e.group_name)+"\n\n          "),e.canRevoke?i("el-popconfirm",{ref:"refReship",refInFor:!0,attrs:{"popper-class":"article-reship-popconfirm",placement:"top",title:"取消转载","icon-color":"#F25555","cancel-button-type":"default"},on:{confirm:function(i){return t.handleRevokeReship(e.group_id,e.post_id)}}},[i("i",{staticClass:"action-icon el-icon-close",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),function(){return t.hackPopoverVisible(t.refReship,a)}.apply(null,arguments)}},slot:"reference"})]):t._e()],1)})),1),t._v(" "),t.reshipRecords.length?t._e():i("div",{staticClass:"empty"},[t._v("\n        暂未转载\n      ")])]),t._v(" "),i("div",{staticClass:"block"},[i("div",{staticClass:"block-title"},[t._v("\n        转载到\n      ")]),t._v(" "),i("div",{staticClass:"block-content"},t._l(t.unreshipRecords,(function(e,a){return i("el-tag",{key:e.id,staticClass:"tag"},[t._v("\n          "+t._s(e.title)+"\n          "),i("el-popconfirm",{ref:"refUnreship",refInFor:!0,attrs:{"popper-class":"article-reship-popconfirm",placement:"top",title:"将文章转载至“"+e.title+"”K吧","icon-color":"#008DFC","cancel-button-type":"default"},on:{confirm:function(i){return t.handleReship(e.id)},show:function(i){return t.getGroupArtCats(e.id)}}},[i("i",{staticClass:"action-icon el-icon-plus",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),function(){return t.hackPopoverVisible(t.refUnreship,a)}.apply(null,arguments)}},slot:"reference"}),t._v(" "),i("t-cascader",{staticStyle:{"margin-bottom":"20px",width:"100%"},attrs:{slot:"content","check-strictly":"",options:t.groupCats,"show-all-levels":!1,"popup-props":{destroyOnClose:!0,attach:function(t){return t.parentNode||t}},placeholder:"请选择文章分类",empty:"暂无分类"},slot:"content",model:{value:t.selectedCat,callback:function(e){t.selectedCat=e},expression:"selectedCat"}})],1)],1)})),1),t._v(" "),t.kbarList.length?t.unreshipRecords.length?t._e():i("div",{staticClass:"empty"},[t._v("\n        暂无可转载K吧\n      ")]):i("div",{staticClass:"empty"},[t._v("\n        未加入K吧\n      ")])])]),t._v(" "),i("km-modal",{attrs:{"show-modal":t.isShowConfirmModal,title:"转载","modal-append-to-body":!1},on:{onCloseModal:t.onCloseConfirmModal}},[t._v("\n    如您计划将转载的内容作为晋级所需专业经验分享，请选择【晋级专业经验分享】，否则转载内容无法被识别为晋级分享。如有疑问请联系：v_xpeili(李星沛)\n    "),i("template",{slot:"footer"},[i("a",{attrs:{href:t.getReshipLink({groupId:t.reshipTargetId,postId:t.postId}),target:"_blank"}},[i("km-button",{staticClass:"submit-button",attrs:{size:"small"}},[t._v("\n          晋级专业经验分享\n        ")])],1),t._v(" "),i("km-button",{staticClass:"cancel-button",attrs:{size:"small",type:"secondary"},on:{click:t.handleConfirmReship}},[t._v("\n        继续转载\n      ")])],1)],2),t._v(" "),i("template",{slot:"reference"},[t._t("default")],2)],2)}),[],!1,null,"85be9362",null).exports,oi=i(1901),ri=i.n(oi),li=i(1902),ci=i.n(li),di=i(345),ui=i(2018),pi=i(2080),hi=i(57),mi={name:"CollectModal",components:{venomModal:vt.a,venomSelector:ci.a,venomOptions:ri.a,TSelect:di.b,TOption:di.a,kmButton:ei.a},props:{isShowModal:{type:Boolean,default:!1},postId:{type:String,default:""}},setup(t,e){let i={};const a=Object(s.r)([]),n=Object(s.r)(""),o=Object(s.r)([]),r=Object(s.r)(""),l=Object(s.r)(!1),c=Object(s.r)(!1),d=Object(s.r)(!1),u=Object(s.r)(!1),p=Object(s.a)(()=>0===a.value.length&&c.value),h=Object(s.a)(()=>!l.value&&!!n.value&&0===o.value.length&&d.value),m=Object(s.a)(()=>!(!p.value&&!h.value));let v=null;Object(s.m)(()=>{v=Object(pi.a)({context:e,contentDomList:[()=>document.querySelector(".collect-modal-card"),()=>document.querySelector(".t-select__dropdown")],callback:t=>!t&&e.emit("onClose")})}),Object(s.n)(()=>{v()});Object(s.u)(t,t=>{t.isShowModal&&Object(ui.m)().then(({data:t})=>{if(0===(null==t?void 0:t.code)){var e;(t=>{t.forEach(t=>{const e=t.title,s=t.id;i[s]||(i[s]=t,a.value.push({label:e,value:s}))})})((null==t||null===(e=t.data)||void 0===e?void 0:e.knowledges)||[])}}).finally(()=>{c.value=!0})}),Object(s.u)(n,t=>{const e=i[t];console.log("newSelectItem",e),u.value=!1,"menu"!==(null==e?void 0:e.style)?(l.value=!1,Object(ui.q)(t).then(({data:t})=>{if(0===(null==t?void 0:t.code)){var e,i;const a=(null==t||null===(e=t.data)||void 0===e?void 0:e.columns)||[];o.value=a,r.value=null===(i=a[0])||void 0===i?void 0:i.id}}).finally(()=>{d.value=!0})):(r.value="",l.value=!0)});const g=()=>{i={},l.value=!1,c.value=!1,d.value=!1,u.value=!1,n.value="",r.value="",o.value=[],a.value=[]};return{isKnowledgeEmpty:p,isColumnEmpty:h,isSubmitDisabled:m,isCollectToNew:l,isDataFetched:c,isKnowledgeInvalid:u,selectValue:n,knowledges:a,selectColumnValue:r,knowledgeColumns:o,onSubmit:()=>{if(!n.value)return void(u.value=!0);if(!l.value&&!r.value)return;const i={reshiped:"此文章已收录，无需重复收录",private:"保密k吧无法收录"};if(l.value){const a=n.value;Object(ui.d)({knowledge_id:parseInt(a,10),method:"list",new_nodes:[{id:parseInt(t.postId,10),type:"article"}],parent_node_id:0}).then(({data:t})=>{0===t.code&&Object(hi.b)("collectToKnowledge",{knowledge_id:a}),t.message=i[t.message]||t.message,Object(Ye.a)(e.root)(t)})}else{const a=r.value;Object(ui.c)(t.postId,a).then(({data:t})=>{0===t.code&&Object(hi.b)("collectToKnowledge",{knowledge_id:a}),t.message=i[t.message]||t.message,Object(Ye.a)(e.root)(t)})}e.emit("onSubmit",n.value),g()},onClose:()=>{e.emit("onClose"),g()}}}},vi=Object(wt.a)(mi,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"collect-modal-card"},[t.isShowModal?i("venom-modal",{staticClass:"collect-modal",attrs:{"confirm-disabled":t.isSubmitDisabled,width:308,closable:!1},on:{close:t.onClose,submit:t.onSubmit}},[i("template",{slot:"title"},[t._v("\n      "+t._s("")+"\n    ")]),t._v(" "),i("template",{slot:"body"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.knowledges.length>0,expression:"knowledges.length > 0"}],staticClass:"knowledeges-select-container",class:{"container-have-column":t.selectColumnValue}},[i("t-select",{staticClass:"knowledge-selecter",attrs:{option:t.knowledges,placeholder:"请选择文集"},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}},t._l(t.knowledges,(function(t){return i("t-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.selectColumnValue,expression:"selectColumnValue"}],staticClass:"column-text"},[t._v("分组")]),t._v(" "),i("venom-selector",{directives:[{name:"show",rawName:"v-show",value:t.selectColumnValue,expression:"selectColumnValue"}],staticClass:"column-selecter",attrs:{width:290,"option-array":t.knowledgeColumns,placeholder:"请选择分栏"},model:{value:t.selectColumnValue,callback:function(e){t.selectColumnValue=e},expression:"selectColumnValue"}},t._l(t.knowledgeColumns,(function(t){return i("venom-options",{key:t.id,attrs:{label:t.title,value:t.id}})})),1)],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isKnowledgeInvalid,expression:"isKnowledgeInvalid"}],staticClass:"err-text"},[t._v("\n        请选择文集\n      ")]),t._v(" "),t.isKnowledgeEmpty?i("div",{staticClass:"err-tips"},[t._v("\n        无可选文集\n      ")]):t._e(),t._v(" "),t.isColumnEmpty?i("div",{staticClass:"err-tips old-knowledge-tips"},[t._v("\n        文集没有分组，无法收录\n      ")]):t._e()]),t._v(" "),i("template",{slot:"footer"},[i("div",{staticClass:"modal-operations"},[i("span",[i("a",{attrs:{href:"/vkm/knowledges/create",target:"_blank"}},[i("km-button",{attrs:{size:"mini",type:"secondary"},on:{click:t.onClose}},[t._v("新建文集")])],1)]),t._v(" "),i("span",{staticClass:"modal-op-right"},[i("km-button",{attrs:{size:"mini",type:"secondary"},on:{click:t.onClose}},[t._v("取消")]),t._v(" "),i("km-button",{attrs:{size:"mini",disabled:t.isSubmitDisabled},on:{click:t.onSubmit}},[t._v("收录")])],1)])])],2):t._e()],1)}),[],!1,null,"34bc8de3",null).exports,gi=i(1894),fi=i.n(gi),_i=i(1896),bi=i.n(_i),yi={name:"feedback-modal",components:{venomModal:vt.a,venomCheckbox:at.a,venomForm:bi.a,venomFormItem:fi.a,venomCheckboxGroup:nt.a,venomTextarea:ht.a},props:{isShowModal:{type:Boolean,default:!1}},setup(t,e){const i=Object(s.r)([{label:"内容有误",value:"内容有误"},{label:"内容未更新",value:"内容未更新"},{label:"内容建议",value:"内容建议"},{label:"其他",value:"其他"}]),a=Object(s.q)({selectValue:[],textareaValue:""}),n=Object(s.r)({}),o=Object(s.q)({selectValue:[{required:!0,message:"请选择反馈类型"}],textareaValue:[{required:!0,message:"请输入描述信息"}]});return{form:a,myForm:n,rules:o,feedbackTypes:i,onSubmit:()=>{n.value.validate(t=>{t&&e.emit("onSubmit",{content_type:a.selectValue,desc:a.textareaValue})})},onClose:()=>{e.emit("onClose"),a.value={}}}}},wi=Object(wt.a)(yi,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.isShowModal?i("venom-modal",{staticClass:"feedback-modal",attrs:{disabledBodyScroll:"",width:640},on:{close:t.onClose,submit:t.onSubmit}},[i("template",{slot:"title"},[t._v("反馈")]),t._v(" "),i("template",{slot:"body"},[i("div",{staticClass:"feedback-container"},[i("venom-form",{ref:"myForm",attrs:{model:t.form,rules:t.rules}},[i("venom-form-item",{attrs:{label:"反馈类型",prop:"selectValue",labelCol:{span:2}}},[i("venom-checkbox-group",{attrs:{isRequired:""},model:{value:t.form.selectValue,callback:function(e){t.$set(t.form,"selectValue",e)},expression:"form.selectValue"}},t._l(t.feedbackTypes,(function(e){return i("venom-checkbox",{key:e.value,attrs:{label:e.value}},[t._v("\n                "+t._s(e.label)+"\n              ")])})),1)],1),t._v(" "),i("venom-form-item",{attrs:{label:"具体描述",prop:"textareaValue",labelCol:{span:2},isRequired:""}},[i("venom-textarea",{staticClass:"subscribe",attrs:{rows:3,autoszie:!0},model:{value:t.form.textareaValue,callback:function(e){t.$set(t.form,"textareaValue",e)},expression:"form.textareaValue"}})],1)],1)],1)]),t._v(" "),i("template",{slot:"footer"})],2):t._e()],1)}),[],!1,null,"eefe57ec",null).exports,Ci={name:"FavorModal",components:{elDialog:gt.Dialog,elButton:gt.Button,elSelect:gt.Select,elOption:gt.Option},props:{isShowModal:{type:Boolean,default:!1},postId:{type:String,default:""}},setup(t,e){const i=Object(s.r)([]),a=Object(s.r)([]),n=Object(s.a)(()=>e.root.$store.getters["global/userToken"]),o=Object(s.a)(()=>{const t=e.root.$store.getters["global/userInfo"];return null==t?void 0:t.user_info}),r=Object(s.r)([]),l=Object(s.r)([]);Object(s.u)(t,()=>{t.isShowModal&&Object(W.F)(t.postId).then(({data:t})=>{var e,i;r.value=null==t||null===(e=t.data)||void 0===e?void 0:e.common_tags,l.value=null==t||null===(i=t.data)||void 0===i?void 0:i.user_tags})});const c=()=>{a.value=[],i.value=[]};return{options:i,values:a,userInfo:o,reconmendTags:r,userTags:l,remoteMethod:t=>{t&&Object(W.I)(t).then(({data:t})=>{const e=((null==t?void 0:t.data.tags)||[]).map(t=>{var e,i;return{label:null==t||null===(e=t.tags)||void 0===e?void 0:e.name,value:null==t||null===(i=t.tags)||void 0===i?void 0:i.name}});i.value=e})},addTag:t=>{const e=a.value.length>=5,i=a.value.includes(t);e||i||a.value.push(t)},handleSubmit:()=>{const i=a.value.join(" ");Object(W.W)({postId:t.postId,tags:i,userToken:n.value},i).then(({data:t})=>{Object(Ye.a)(e.root)(t),e.emit("onSubmit"),c()})},handleClose:()=>{c(),e.emit("onClose")}}}},ki=Object(wt.a)(Ci,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"favor-modal",attrs:{visible:t.isShowModal,"before-close":t.handleClose,top:"0",width:"580px","modal-append-to-body":!1,"lock-scroll":!1}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"success-icon"}),t._v(" "),i("span",{staticClass:"success-text"},[t._v("收藏成功！")]),t._v(" "),i("a",{staticClass:"jump-link",attrs:{target:"_blank",href:"/user/"+t.userInfo.nick+"/bookmarks/post"}},[t._v("\n      前往查看\n    ")])]),t._v(" "),i("div",{staticClass:"dialog-body"},[i("div",{staticClass:"split-line"}),t._v(" "),i("div",{staticClass:"label-title"},[t._v("\n      设置收藏标签\n    ")]),t._v(" "),i("div",[i("el-select",{staticClass:"label-select",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",remote:"","multiple-limit":5,"remote-method":t.remoteMethod,placeholder:"点击新增标签，最多不超过5个"},model:{value:t.values,callback:function(e){t.values=e},expression:"values"}},t._l(t.options,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),i("div",{staticClass:"user-tag-list"},t._l(t.userTags,(function(e){return i("span",{key:e.id,staticClass:"user-tag-item",on:{click:function(i){return t.addTag(e.name)}}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),0),t._v(" "),i("div",{staticClass:"recommend-title"},[t._v("\n      推荐标签\n    ")]),t._v(" "),i("div",{staticClass:"recommend-tag-list"},t._l(t.reconmendTags,(function(e){return i("span",{key:e.id,staticClass:"recommend-tag-item",on:{click:function(i){return t.addTag(e.name)}}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),0)]),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.handleClose}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)])}),[],!1,null,"7c1b6f30",null).exports,Oi=i(2063),xi=i(2066),ji=i(2007),Ii=i(2074),Ti=Object(s.c)({name:"edit-confirm-modal",components:{elDialog:gt.Dialog,elButton:gt.Button},props:{isShowEditConfirmModal:{type:Boolean,default:!1},article:{type:Object,default:()=>{}}},setup:(t,{emit:e})=>({getEditArticleLink:ai.c,onCloseModal:()=>{e("closeEditConfirmModal",{})}})}),Si=Object(wt.a)(Ti,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"edit-confirm-modal",attrs:{title:"编辑",top:"0",width:"580px",visible:t.isShowEditConfirmModal,"modal-append-to-body":!1,"append-to-body":!0,"lock-scroll":!1},on:{close:t.onCloseModal}},[i("span",[t._v("当前文章发表于【腾讯知点】，点击确定将会跳转至该站点进行编辑。如有疑问请联系：v_xpeili(李星沛)")]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.onCloseModal}},[t._v("取 消")]),t._v(" "),i("a",{staticStyle:{"margin-left":"10px"},attrs:{href:t.getEditArticleLink({sourceId:t.article.source_id,articleId:t.article.id}),target:"_blank"}},[i("el-button",{attrs:{type:"primary"}},[t._v("确 定")])],1)],1)])}),[],!1,null,"0be0bca6",null).exports,Di=i(2005),qi=i(2062),Ei=i(8),Ai=i(2378);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */const Mi=()=>{const{data:t,loading:e,run:i,cancel:a}=(()=>{const t=Object(s.r)(!1),e=Object(s.q)({id:null,callback:null}),i=Object(s.r)(),a=()=>{e.id&&clearTimeout(e.id),e.id=null,e.callback=null},n=async(s,o=!1,r)=>{t.value=!0;try{const{data:l}=await Object(W.O)({codeBlock:s,forceUpdate:o});0===l.code?(i.value=l.data,t.value=!1,a(),"function"==typeof r&&r(i.value)):1===l.code?(e.id&&clearTimeout(e.id),e.callback=()=>n(s,!1,r),e.id=setTimeout(e.callback,1e4)):(i.value="生成失败，请重试",t.value=!1)}catch(e){i.value="生成失败，请重试",t.value=!1}},o=()=>{document.hidden?e.id&&clearTimeout(e.id):t.value&&e.callback&&(e.id=setTimeout(e.callback,1e3))};return Object(s.m)(()=>{document.addEventListener("visibilitychange",o)}),Object(s.n)(()=>{document.removeEventListener("visibilitychange",o)}),{loading:t,data:i,run:n,cancel:a}})();return{list:Object(s.a)(()=>{var i,a;return[{title:"代码说明",data:null===(i=t.value)||void 0===i?void 0:i.desc},{title:"代码注释",data:null===(a=t.value)||void 0===a?void 0:a.comment}].map(t=>({...t,loading:e.value}))}),run:i,cancel:a,codeId:Object(s.a)(()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.code_id})}};var $i=i(1899),Li=i.n($i),Pi=i(168);const Fi=({visible:t,onVisibleChange:e,postId:i,hasArticleEditPermission:a})=>{const n=Object(s.r)({}),o=Object(s.r)(!0),r=Object(s.a)(()=>n.value.isProcessing?"生成中":n.value.isEnabled?o.value?"":"文章文字内容较少":"作者已关闭摘要查看"),l=Object(s.r)(!1),c=t=>{n.value={isProcessing:!1,isEnabled:!1},Object(W.d)({postId:t}).then(({data:t})=>{var e;0===(null==t?void 0:t.code)&&(n.value.isEnabled=null==t||null===(e=t.data)||void 0===e?void 0:e.is_enabled)});const e=Li()(".km-article-content").text();if(o.value=e.length>300,!o.value)return;const i=Object(Pi.i)(window.location.href).summarize_engine;Object(W.m)({postId:t,engine:i||"1"}).then(({data:e})=>{if(0!==(null==e?void 0:e.code))return void Object(W.n)({postId:t}).then(({data:t})=>{0===(null==t?void 0:t.code)&&(n.value.isProcessing=!0)});const i=(null==e?void 0:e.data)||{};n.value={...n.value,...i}})};Object(s.u)(i,t=>{t&&setTimeout(()=>c(t),1e3)},{immediate:!0});const d=async t=>{const{data:a}=await Object(W.e)({postId:i.value,isEnabled:t});0===(null==a?void 0:a.code)?(n.value.isEnabled=t,Ai.a.success((t?"开启":"关闭")+"成功"),e(t)):Ai.a.error((t?"开启":"关闭")+"摘要失败，请重试")};return{list:Object(s.a)(()=>[{loading:n.value.isProcessing,title:"文章总结",data:n.value.content}]),model:Object(s.a)(()=>{var t;return null===(t=n.value)||void 0===t?void 0:t.model}),abstractDisabledText:r,onRebuildAbstract:t=>{console.log("onRebuildAbstract ",t,i.value,n.value.abstract_id),Object(hi.b)("postAbstractFeedback",{post_id:i.value,abstract_id:n.value.abstract_id,content:t,content_type:"regenerateReason"}),Object(W.f)({postId:i.value}).then(({data:t})=>{0===(null==t?void 0:t.code)?(Ai.a.success("正在重新生成，请稍后查看"),n.value.isProcessing=!0,e(!1)):Ai.a.error("重新生成失败，请重试")})},onEvaluateAbstract:t=>{console.log("onEvaluateAbstract ",t,i.value,n.value.abstract_id),Object(hi.b)("postAbstractScore",{post_id:i.value,abstract_id:n.value.abstract_id,score:t}),Ai.a.success("评价成功")},onFeedbackAbstract:t=>{console.log("onFeedbackAbstract ",t,i.value,n.value.abstract_id),Object(hi.b)("postAbstractFeedback",{post_id:i.value,abstract_id:n.value.abstract_id,content:t,content_type:"general"}),Ai.a.success("提交成功")},handleAbstractClick:()=>{if(n.value.isEnabled){if(!r.value)return n.value.content?void(t.value?e(!1):(e(!0),Object(hi.b)("postAbstractView",{post_id:i.value,abstract_id:n.value.abstract_id}))):(Object(W.f)({postId:i.value}),void(n.value.isProcessing=!0))}else a.value&&(l.value=!0)},handleAbstractStatusClick:async t=>{t?(await d(!0),l.value=!1):qi.c.show({title:"填写关闭原因",onConfirm:t=>{d(!1),Object(hi.b)("postAbstractFeedback",{post_id:i.value,abstract_id:n.value.abstract_id,content:t,content_type:"closeReason"})}})},abstaractEnabledConfirm:l}},Ri=({containerDomRef:t,postId:e,hasArticleEditPermission:i})=>{const a=Object(s.r)(!1),n=Object(s.r)(),o=Object(s.r)();Object(s.m)(()=>{setTimeout(()=>{var e;o.value=window.innerWidth-(null===(e=t.value)||void 0===e?void 0:e.offsetLeft)-780},1500)});const r=(t,e)=>{const i=!1===t?e!==n.value:t;a.value=i,n.value=e},{list:l,model:c,abstractDisabledText:d,abstaractEnabledConfirm:u,onRebuildAbstract:p,onEvaluateAbstract:h,onFeedbackAbstract:m,handleAbstractClick:v,handleAbstractStatusClick:g}=Fi({visible:a,onVisibleChange:t=>r(t,"abstract"),postId:e,hasArticleEditPermission:i}),{list:f,onRebuildAICode:_,onEvaluateAICode:b,onFeedbackAICode:y}=(({visible:t,onVisibleChange:e,postId:i,containerDomRef:a})=>{const n=Object(s.r)(),o=Object(s.r)(),{codeId:r,list:l,run:c,cancel:d}=Mi(),u=Object(s.a)(()=>({visible:t.value,codeBlock:n.value}));Object(s.u)(u,({visible:t,codeBlock:e})=>{t&&e&&(d(),c(e,!1,()=>{Object(hi.b)("codeBlockAiView",{post_id:i.value,codeblock_id:r.value})}))}),Object(s.u)(t,t=>{t||d()}),Object(s.u)(t,t=>{t||(o.value=void 0)});const p=()=>{if(!a.value)return;[...a.value.querySelectorAll("pre code")].forEach((t,i)=>{var a;const s=(new(Ei.default.extend({components:{ElButton:gt.Button},render:a=>a("el-button",{props:{plain:!0},class:{"ai-code-btn":!0},style:{position:"absolute",right:"12px",top:"12px",padding:"6px 8px",border:"none"},on:{click:()=>{const a=o.value!==i;e(a),n.value=t.textContent,o.value=a?i:void 0}}},[a("svg-icon",{props:{name:"common/ai",width:16,height:16},style:{marginRight:"4px"}}),a("span",{style:{display:"inline-block",verticalAlign:"middle"}},"AI助手")])}))).$mount();t.parentElement&&(t.parentElement.style.position="relative"),null===(a=t.parentElement)||void 0===a||a.appendChild(s.$el)})};return Object(s.u)(i,()=>{setTimeout(p,1500)},{immediate:!0}),{list:l,onRebuildAICode:()=>{console.log("onRebuildAICode "),c(n.value,!0,()=>{Ai.a.success("提交成功")})},onEvaluateAICode:t=>{console.log("onEvaluateAICode ",t,i.value,r.value),Object(hi.b)("codeBlockAiScore",{post_id:i.value,codeblock_id:r.value,score:t}),Ai.a.success("评价成功")},onFeedbackAICode:t=>{console.log("onFeedbackAICode ",t,i.value,r.value),Object(hi.b)("codeBlockAiFeedback",{post_id:i.value,codeblock_id:r.value,feedback:t}),Ai.a.success("提交成功")}}})({visible:a,onVisibleChange:t=>r(t,"code"),postId:e,containerDomRef:t}),w=Object(s.a)(()=>"code"===n.value?_:p),C=Object(s.a)(()=>"code"===n.value?b:h),k=Object(s.a)(()=>"code"===n.value?y:m),O=Object(s.a)(()=>"code"===n.value?f.value:l.value),x=Object(s.a)(()=>"code"===n.value?void 0:c.value);return{activeType:n,visible:a,model:x,list:O,aiDrawerDefaultWidth:o,onRebuild:w,onEvaluate:C,onFeedback:k,abstractDisabledText:d,abstaractEnabledConfirm:u,handleAbstractClick:v,handleAbstractStatusClick:g}};var Ni=Object(s.c)({components:{RichReader:Y.a,ErrorShow:X.a,SmallOperationBar:Z.a,BigOperationBar:tt.a,badgeTwitter:ji.a,ArticleToc:et.a,ActionPanel:Ct,ReshipModal:ni,CollectModal:vi,FeedbackModal:wi,Comment:Oi.a,ShareModal:xi.a,favorModal:ki,relationEntryMod:Ii.a,AiDrawer:qi.a,AiDrawerItem:qi.b,ChatDrawerItem:qi.d,EditConfirmModal:Si,TButton:r.a,TPopconfirm:K,TPopup:v.a},props:{articleId:{type:String,default:"",required:!0},groupId:{type:String,default:""},knwlGroupId:{type:String,default:""},disableNavigation:{type:Boolean,default:!0},disableToc:{type:Boolean,default:!1},showOtherInfo:{type:Boolean,default:!1},isSimple:{type:Boolean,default:!0},isKnwl:{type:Boolean,default:!1}},setup(t,e){const i=Object(s.r)(),a=Object(s.r)({}),{articleId:n,groupId:r}=t,l=Object(s.r)(!0),c=Object(s.a)(()=>e.root.$store.getters["global/userToken"]),d=Object(s.a)(()=>{const t=e.root.$store.getters["global/userInfo"];return null==t?void 0:t.user_info}),u=Object(s.a)(()=>`${window.location.origin}/articles/show/${a.value.id}`),p=Object(s.a)(()=>u.value.replace("woa","tencent").replace("articles/show","pkm/articles")),{userMedal:h,createrInfo:m,userMedalLink:v,getAuthorInfo:g,getAuthorMedal:f,jumpToPersonPage:_}=Object(ii.j)({context:e,article:a}),{currentGroupId:b,realPostId:y,groupPostId:w,transArticleId:C}=Object(ii.C)(r,n),{articleStatus:k,getArticleSettingStatus:O}=Object(ii.d)(),{isAdmin:x,isKbarAdmin:j,isTop:I,isRecommend:T,isEssential:S,isHidden:D,diggUserList:q,actionData:E,fetchAcions:A}=Object(ii.a)(),{hasArticleEditPermission:M,getArticleEditPermisson:$}=Object(ii.b)(),L=Object(s.a)(()=>{var t,e;return(null==d||null===(t=d.value)||void 0===t?void 0:t.nick)===(null==se||null===(e=se.value)||void 0===e?void 0:e.created_by)}),P=Object(s.a)(()=>M.value||j.value||L.value),{isShowEditModal:F,isShowEditConfirmModal:R,isShowBottomEditModal:N,actionDeal:B}=Object(ii.g)({isTop:I,isRecommend:T,isEssential:S,isHidden:D,article:a,userToken:c,currentGroupId:b,createrInfo:m,groupPostId:w,context:e}),{commentItem:U,barOptions:H,isDigged:V,isFavored:z,isShowShareModal:G,isShowFavorModal:K,isDigging:Y,digGifUrl:X,isFavoring:Z,favorGifUrl:tt,diggCount:et,commentCount:it,favorCount:at,isShowBackTop:st,onDigg:nt,onFavor:ot,onModalFavor:rt,onShare:lt,onTotop:ct,onToComment:dt,getReadCount:ut,getFeedBackInfo:pt}=Object(ii.o)({article:a,userInfo:d,diggUserList:q,currentGroupId:b,props:t}),{isShowCollectModal:ht,openCollectModal:mt,onCollectSubmit:vt}=Object(ii.m)(),{isShowFeedbackModal:gt,openFeedbackModal:ft,onFeedbackModaSubmit:_t}=Object(ii.p)({postId:y.value,context:e}),{isHeadline:bt,getHeadlineInfo:yt}=Object(ii.q)(),{rewardQrcodeUrl:wt,articleRewards:Ct,getArticleReward:kt,buildQrCode:Ot}=Object(ii.z)(),{attachments:xt,getAttachments:jt}=Object(ii.h)(),{hotRank:It,getHotRank:Tt}=Object(ii.r)(),{authorArticles:St,getArticleList:Dt}=Object(ii.i)(a),{collectedKnowledgeList:qt,handleKnowledeCoverError:Et,getCollectedKnowledges:At}=Object(ii.l)(),{youLikeArticles:Mt,getYouLike:$t}=Object(ii.v)(),{relativeArticles:Lt,getRelativeArticles:Pt}=Object(ii.x)(),{articleCategory:Ft,getCategory:Rt}=Object(ii.k)(),{articleTags:Nt,getTags:Bt}=Object(ii.e)(),{instanceWater:Ut,instanceHWater:Ht,initWater:Vt,initHWater:zt}=Object(ii.D)(),Gt=Object(s.a)(()=>["knowledge_count","active_user_count"]),Kt=Object(s.a)(()=>"article"),{haveApplyKnowledge:Wt,isShowApplyKnowledge:Qt,isShowKnowledgeCard:Jt,knowledgeCardDesc:Yt,getKnowledgeAward:Xt,clickKnowledgeAward:Zt}=Object(ii.s)(),te=Object(s.r)(!1),ee=Object(s.r)(!1),ie=Object(s.a)(()=>{var t;return(null==a||null===(t=a.value)||void 0===t?void 0:t.group_id)===b.value}),ae=Object(s.a)(()=>{var t;const i=e.root.$store.getters["kbar/getKbarBasicData"]||{};return 1===(null==i||null===(t=i.group)||void 0===t?void 0:t.access_level)}),{reshipInfo:se,getReshipData:ne}=Object(ii.y)(),{isHaveEntry:oe,fetchRelateEntry:re}=Object(ii.w)({context:e,tags:Nt.value}),le=Object(s.r)("Post"),ce=i=>{const s=r?{group_article_id:i}:{article_id:i};H.value=[...H.value];const n=C(s).then(()=>{var t;b.value!==r&&(t=b.value,e.root.$store.commit("kbar/setGroupId",{groupId:t})),A(b.value,r?y.value:i),O(y.value,b.value||"0")}),c=Object(W.w)(s).then(({data:s})=>{if(0===(null==s?void 0:s.code)){var n,r,l,c,d;const u=(null==s||null===(n=s.data)||void 0===n?void 0:n.article)||{};u.content=Object(Q.h)(u.content),a.value=u,te.value=!0;const p=o.a.get("km_uid")||o.a.get("storm_km_id"),{created_by:h,id:m,group_id:v}=a.value;g(h),f(h),pt(m),ut(m),Bt(m).then(t=>re(t)),Tt(m),kt(m),Ot(m),jt(m),$(m),Rt(m),yt(m),At(m),Xt(m),Pt(m),v&&ne(i),t.showOtherInfo&&Dt(h),t.showOtherInfo&&$t(p),e.root.$store.commit("article/SET_CURRENT_ARTICLE_TITLE",null===(r=a.value)||void 0===r?void 0:r.title),e.root.$store.commit("article/SET_CURRENT_ARTICLE_ID",m),e.root.$store.commit("article/SET_IS_GLOBAL_ARTICLE","0"===v);const _=null!==(l=a.value)&&void 0!==l&&l.is_img_watermarked?{imgZindex:"4"}:{};(null===(c=a.value)||void 0===c?void 0:c.is_watermarked)&&Vt(_),(null===(d=a.value)||void 0===d?void 0:d.is_watermarked)&&zt(_),Object(J.a)("articleShow",{postId:i,module:b.value?"Group":"Knowledge",place:b.value?"kbar:"+b.value:"null"})}else te.value=!1}).finally(()=>{l.value=!1,Re()});Promise.all([n,c]).then(()=>{const{created_by:e,id:i,group_id:s}=a.value;i&&Object(ii.c)({postId:i,showGroups:t.isKnwl?t.knwlGroupId:b.value,groupId:s,author:e,windowWidth:window.innerWidth,viewMode:Le.value?"wide":"narrow"})})};n?ce(n):l.value=!1;Object(s.u)(()=>t.articleId,t=>{ce(t)});const de=Object(s.r)({}),ue=()=>{de.value={"margin-left":"auto"}},{isInit:pe,isShow:he,tocList:me,tocOptions:ve,onTocDataChange:ge}=Object(ii.B)(e),{userCardItem:fe,renderUserCard:_e}=Object(Di.a)(e,{idKey:"nick",refKey:"article_author"}),be=Object(s.r)(),ye=Object(s.a)({get:()=>{var t,e,i,a;return null!==(t=be.value)&&void 0!==t?t:null===(e=E.value)||void 0===e||null===(i=e.reship)||void 0===i||null===(a=i.reship_records)||void 0===a?void 0:a.length},set:t=>be.value=t}),we=Object(s.r)(),Ce=Object(s.a)(()=>{var t;return null===(t=a.value)||void 0===t?void 0:t.id}),{visible:ke,activeType:Oe,list:xe,model:je,aiDrawerDefaultWidth:Ie,onRebuild:Te,onEvaluate:Se,onFeedback:De,abstractDisabledText:qe,abstaractEnabledConfirm:Ee,handleAbstractClick:Ae,handleAbstractStatusClick:Me}=Ri({containerDomRef:i,hasArticleEditPermission:M,postId:Ce}),$e=Object(s.a)(()=>e.root.$store.getters["article/isShowChatDrawer"]),{readMode:Le,showReadModeSwitch:Pe,handleChangeReadMode:Fe}=Object(ii.u)(),Re=()=>{const t=document.getElementsByClassName("km-article-content")[0];(null==t?void 0:t.getElementsByTagName("img")).forEach(t=>{770===t.getAttribute("width")&&(t.style.width="100%")})};Object(ii.A)(e);const Ne=Object(s.r)(""),Be=Object(s.r)(""),Ue=Object(s.r)(),He=Object(s.q)({width:0,height:0,display:"block"}),Ve=Object(s.f)("$bus");Ve.on("clearReferredText",()=>Ne.value="");const ze=Object(s.q)({position:"absolute",backgroundColor:"transparent",border:"none",top:0,left:0,width:0,height:0,pointerEvents:"none"});let Ge;const Ke=()=>{const t=window.getSelection();Be.value=We(t)},We=t=>{if(0===t.rangeCount)return"";const e=t.getRangeAt(0),i=document.createElement("div");return i.appendChild(e.cloneContents()),i.querySelectorAll("img").forEach(t=>{const e=document.createTextNode("[图片]");t.parentNode.replaceChild(e,t)}),i.querySelectorAll("video").forEach(t=>{const e=document.createTextNode("[视频]");t.parentNode.replaceChild(e,t)}),i.textContent};return{isOriginGroup:ie,isSecretGroup:ae,isAdmin:x,isKbarAdmin:j,isReshipPeople:L,isLoading:l,isShowActionPanel:P,hasArticleViewPermssion:te,showEntryCard:ee,hasArticleEditPermission:M,currentGroupId:b,article:a,articleStatus:k,articleTags:Nt,hotRank:It,isHeadline:bt,userMedal:h,createrInfo:m,userMedalLink:v,authorArticles:St,youLikeArticles:Mt,relativeArticles:Lt,collectedKnowledgeList:qt,articleCategory:Ft,reshipInfo:se,isHaveEntry:oe,handleKnowledeCoverError:Et,jumpToPersonPage:_,isDigged:V,diggCount:et,isFavored:z,favorCount:at,barOptions:H,commentItem:U,commentCount:it,isShowBackTop:st,isDigging:Y,digGifUrl:X,isFavoring:Z,favorGifUrl:tt,onDigg:nt,onFavor:ot,onModalFavor:rt,onShare:lt,onTotop:ct,onToComment:dt,getFeedBackInfo:pt,isInit:pe,isShow:he,tocList:me,tocOptions:ve,containerStyle:de,onContentChange:()=>{var t,i,s;e.emit("present-content-load"),ge(),(null===(t=a.value)||void 0===t?void 0:t.is_watermarked)&&(null==Ut||Ut.draw()),(null===(i=a.value)||void 0===i?void 0:i.is_watermarked)&&(null==Ht||Ht.draw()),0===(null===(s=me.value)||void 0===s?void 0:s.length)&&ue(),Object(ii.f)({article:a}),Object(ii.t)()},onCollapseToc:()=>{ue()},onExpandToc:()=>{de.value={}},isShowEditModal:F,isShowEditConfirmModal:R,isShowBottomEditModal:N,isTop:I,isRecommend:T,isEssential:S,isHidden:D,diggUserList:q,actionData:E,actionDeal:B,reshipRecordsLength:ye,onEditConfirmClose:()=>{R.value=!1},isShowShareModal:G,isShowCollectModal:ht,openCollectModal:mt,onCollectSubmit:vt,isShowFeedbackModal:gt,isShowFavorModal:K,openFeedbackModal:ft,onFeedbackModaSubmit:_t,attachments:xt,getAttachments:jt,articleRewards:Ct,rewardQrcodeUrl:wt,haveApplyKnowledge:Wt,isShowApplyKnowledge:Qt,isShowKnowledgeCard:Jt,knowledgeCardDesc:Yt,getKnowledgeAward:Xt,clickKnowledgeAward:Zt,jumpToArticle:()=>{var t,e,i,s;ai.a.includes(null==a||null===(t=a.value)||void 0===t?void 0:t.source_id)?R.value=!0:b.value?window.open(`/group/${null==a||null===(e=a.value)||void 0===e?void 0:e.group_id}/articles/edit/${w.value}`):window.open(`/user/${null==a||null===(i=a.value)||void 0===i?void 0:i.created_by}/articles/edit/${null==a||null===(s=a.value)||void 0===s?void 0:s.id}`)},targetType:le,userCardItem:fe,renderUserCard:_e,woaLinkUrl:u,tencentLinkUrl:p,removeBtn:Gt,entryReportType:Kt,containerDomRef:i,articleContent:we,aiDrawerVisible:ke,aiDrawerActiveType:Oe,aiDrawerList:xe,aiModel:je,aiDrawerDefaultWidth:Ie,onRebuild:Te,onEvaluate:Se,onFeedback:De,abstractDisabledText:qe,abstaractEnabledConfirm:Ee,handleAbstractClick:Ae,handleAbstractStatusClick:Me,readMode:Le,showReadModeSwitch:Pe,handleChangeReadMode:Fe,referredText:Ne,quoteButtonDOM:Ue,quoteTooltipStyle:He,quoteTooltipContainerStyle:ze,$bus:Ve,handleMouseUp:()=>{ze.display="none",clearTimeout(Ge);const t=window.getSelection();Ge=setTimeout(()=>{var e;if(0===t.toString().length)return;const a=t.getRangeAt(0);if(null===(e=we.value)||void 0===e||!e.$el.contains(a.commonAncestorContainer))return;const s=a.getClientRects(),n=i.value.getBoundingClientRect();if(s.length>0){const{top:t}=s[0],{left:e}=s[0];let{right:i}=s[0];const{bottom:a}=s[0];for(const e of s)e.right>i&&e.top<=t&&(i=e.right);ze.top=t-n.top-2+"px",ze.left=e-n.left+"px",ze.width=i-e+"px",ze.height=a-t+"px",ze.display="block",He.width=i-e+"px",He.height=a-t+"px",Ke(),console.log("selectedText.value.length",Be.value.length),4<=Be.value.length&&Be.value.length<=300&&Ue.value.click()}else ze.display="none"},300)},handleQuoteClick:()=>{Ne.value=Be.value;document.querySelector(".comment-header").scrollIntoView(),Ue.value.click(),Ve.emit("focusArticleEditor")},chatdDrawerVisible:$e,handleChatClose:()=>{e.root.$store.commit("article/SET_SHOW_CHAT_DRAWER",!1)}}}}),Bi=Object(wt.a)(Ni,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"containerDomRef",class:["article-present-container",{"large-article-present-container":t.readMode}],style:t.containerStyle},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.hasArticleViewPermssion,expression:"hasArticleViewPermssion"}],staticClass:"article-present-wrapper"},[t.disableNavigation?t._e():a("div",{staticClass:"left-navigation"},[a("article-toc",{staticClass:"toc-container",attrs:{"can-expand":"",options:t.tocOptions,"is-init":t.isInit,"is-show":t.isShow,"toc-list":t.tocList},on:{collapseToc:t.onCollapseToc,expandToc:t.onExpandToc}})],1),t._v(" "),a("div",{ref:"content",staticClass:"article-main"},[a("div",{staticClass:"article-head"},[a("div",{staticClass:"article-title"},[a("span",{staticClass:"title-text"},[t._v(t._s(t.article.title))]),t._v(" "),a("span",{staticClass:"tag-list"},[t.articleStatus.is_access_limited?a("svg-icon",{attrs:{name:"article/lock",width:32,height:32,viewBox:"0 0 32 32"}}):t._e(),t._v(" "),a("t-popup",{attrs:{placement:"bottom"},scopedSlots:t._u([{key:"content",fn:function(){return[t.hotRank>0?a("div",{staticClass:"tag-popup-item"},[a("svg-icon",{attrs:{name:"article/hot",width:24,height:24,viewBox:"0 0 24 24"}}),t._v("\n                  热榜最高第"+t._s(t.hotRank)+"名\n                ")],1):t._e(),t._v(" "),t.articleStatus.is_recommended?a("div",{staticClass:"tag-popup-item"},[a("svg-icon",{attrs:{name:"article/recommended",width:24,height:24,viewBox:"0 0 24 24"}}),t._v("\n                  KM推荐文章\n                ")],1):t._e(),t._v(" "),t.articleStatus.is_essential?a("div",{staticClass:"tag-popup-item"},[a("svg-icon",{attrs:{name:"article/essential",width:24,height:24,viewBox:"0 0 24 24"}}),t._v("\n                  K吧精选\n                ")],1):t._e()]},proxy:!0}])},[t._v(" "),a("span",{staticStyle:{display:"flex"}},[t.hotRank>0?a("span",{staticStyle:{position:"relative",display:"flex"}},[a("svg-icon",{attrs:{name:"article/hot",width:32,height:32,viewBox:"0 0 32 32"}}),t._v(" "),t.hotRank<=9?a("span",{staticClass:"hot-rank-text"},[t._v(t._s(t.hotRank))]):t._e()],1):t._e(),t._v(" "),t.articleStatus.is_recommended?a("svg-icon",{attrs:{name:"article/recommended",width:32,height:32,viewBox:"0 0 32 32"}}):t._e(),t._v(" "),t.articleStatus.is_essential?a("svg-icon",{attrs:{name:"article/essential",width:32,height:32,viewBox:"0 0 32 32"}}):t._e()],1)])],1)]),t._v(" "),a("div",{staticClass:"top-operations-bar"},[a("div",{staticClass:"left-info"},[a("a",{staticClass:"author-name",attrs:{target:"_blank",href:"/user/"+t.article.created_by}},[t._v(t._s(t.article.created_by))]),t._v(" "),a("div",{staticClass:"create-time"},[t._v("\n              "+t._s(t.article.created)+"\n            ")])]),t._v(" "),a("small-operation-bar",{attrs:{"option-list":t.barOptions,size:"middle"}},[t.isSimple&&t.hasArticleEditPermission?a("div",{staticClass:"operation-item item-hover",on:{click:t.jumpToArticle}},[a("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/edit",width:16,height:16,viewBox:"0 0 16 16"}})],1):t._e(),t._v(" "),t.isShowActionPanel&&!t.isSimple?a("action-panel",{attrs:{"is-in-group":!!t.currentGroupId,"is-origin-group":t.isOriginGroup,"is-admin":t.isAdmin,"is-kbar-admin":t.isKbarAdmin,"is-reship-people":t.isReshipPeople,"has-edit-permission":t.hasArticleEditPermission,"is-top":t.isTop,"is-recommend":t.isRecommend,"is-essential":t.isEssential,"is-hidden":t.isHidden,"abstract-value":t.article.abstract,"show-edit-text":!0},on:{actionDeal:t.actionDeal,onClose:function(e){t.isShowEditModal=!1}}}):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showReadModeSwitch,expression:"showReadModeSwitch"}],staticClass:"operation-item operation-item-primary",on:{click:function(){return t.handleChangeReadMode(t.article.id)}}},[a("svg-icon",{staticClass:"item-icon",attrs:{name:t.readMode?"common/screen-s":"common/screen-l",width:16,height:16,viewBox:"0 0 16 16"}}),t._v("\n              "+t._s(t.readMode?"窄屏":"宽屏")+"\n            ")],1),t._v(" "),a("t-popconfirm",{attrs:{visible:t.abstaractEnabledConfirm,content:"摘要已关闭，是否重新开启"},on:{confirm:function(e){return t.handleAbstractStatusClick(!0)},cancel:function(){return t.abstaractEnabledConfirm=!1}}},[a("div",{class:["operation-item","operation-item-primary",{"operation-item-disabled":!!t.abstractDisabledText}],attrs:{title:t.abstractDisabledText},on:{click:t.handleAbstractClick}},[a("svg-icon",{attrs:{name:"common/ai",width:16,height:16}}),t._v(" "),a("span",{staticClass:"item-value"},[t._v("AI摘要")])],1)])],1)],1),t._v(" "),!t.article.is_original||!t.isOriginGroup&&t.groupId?a("div",{staticClass:"reship-info"},[t.article.is_original?a("div",{staticClass:"reship-line"},[a("span",[t._v("\n              "+t._s(t.reshipInfo.created_by?"[本文由"+t.reshipInfo.created_by+"转至本K吧，":"[本文为转载文章，")+"\n            ")]),t._v(" "),a("a",{staticClass:"origin-link",attrs:{target:"_blank",href:"/articles/show/"+t.article.id}},[t._v("查看原文")]),t._v(" "),a("span",[t._v("]")])]):a("div",{staticClass:"reship-line"},[a("span",[t._v("[本文系外部转帖"+t._s(t.article.source?"，":""))]),t._v(" "),t.article.source?a("a",{staticClass:"origin-link",attrs:{target:"_blank",href:t.article.source||"/articles/show/"+t.article.id}},[t._v("\n              查看原文\n            ")]):t._e(),t._v(" "),a("span",[t._v("]")])])]):t._e()]),t._v(" "),t.article.leading_words?a("div",{staticClass:"lead-words"},[a("span",{staticClass:"lead-title"},[t._v("| 导语")]),t._v(" "),a("span",{staticClass:"lead-content"},[t._v(t._s(t.article.leading_words))])]):t._e(),t._v(" "),a("div",{on:{mouseup:t.handleMouseUp}},[a("rich-reader",{ref:"articleContent",staticClass:"article-content",attrs:{content:t.article.content,"is-only-richtext":!t.article.is_md},on:{contentLoad:t.onContentChange}})],1),t._v(" "),t.attachments.length>0?a("div",{staticClass:"attachment-container"},[a("div",{staticClass:"attachment-title"},[t._v("\n          "+t._s("附件("+t.attachments.length+")")+"\n        ")]),t._v(" "),a("div",{staticClass:"attachment-body"},t._l(t.attachments,(function(e,i){return a("div",{key:e.id,staticClass:"attachment-item"},[0==i&&e.can_preview&&e.preview_url?a("div",{staticClass:"attachment-preview"},[a("div",{staticClass:"preview-title"},[a("div",{class:"attachment-type attachment-type-other attachment-type-"+e.type}),t._v(" "),a("a",{staticClass:"attachment-name",attrs:{target:"_blank",href:"/base/attachments/attachment_view/"+e.id}},[t._v("\n                  "+t._s(e.title)+"\n                ")])]),t._v(" "),a("div",{staticClass:"preview-body"},[a("iframe",{staticClass:"web-office-iframe",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.preview_url,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true"}})])]):a("div",{staticClass:"attachment-line"},[a("div",{class:"attachment-type attachment-type-other attachment-type-"+e.type}),t._v(" "),a("a",{staticClass:"attachment-name",attrs:{target:"_blank",href:"/base/attachments/attachment_view/"+e.id}},[t._v("\n                "+t._s(e.title)+"\n              ")])])])})),0)]):t._e(),t._v(" "),a("div",{staticClass:"update-time"},[t._v("\n        更新于："+t._s(t.article.last_published_at)+"\n      ")]),t._v(" "),t.articleTags.length>0?a("div",{staticClass:"article-label"},[a("span",[t._v("标签：")]),t._v(" "),t._l(t.articleTags,(function(e){return a("a",{key:e.id,staticClass:"label-item",attrs:{href:t.currentGroupId?"/group/"+t.currentGroupId+"/articles?tag_id="+e.id:"/tags/view/"+e.id,target:"_blank"}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],2):t._e(),t._v(" "),t.relativeArticles.length>0?a("div",{staticClass:"relative-articles-container"},[a("div",{staticClass:"relative-title"},[t._v("\n          "+t._s("相关阅读("+t.relativeArticles.length+")")+"\n        ")]),t._v(" "),a("div",{staticClass:"relative-body"},t._l(t.relativeArticles,(function(e){return a("div",{key:e.id,staticClass:"relative-item"},[a("a",{staticClass:"relative-link",attrs:{target:"_blank",href:"/articles/show/"+e.id}},[t._v("\n              "+t._s(e.title)+"\n            ")])])})),0)]):t._e(),t._v(" "),t.isShowApplyKnowledge?a("div",{staticClass:"knowledge-apply-mod"},[t._m(0),t._v(" "),a("div",{staticClass:"right-content"},[t.haveApplyKnowledge?a("button",{staticClass:"has-apply-btn"},[a("img",{staticClass:"has-apply-img",attrs:{src:i(2111)}}),t._v("\n            已申报\n          ")]):a("button",{staticClass:"apply-btn",on:{click:function(){return t.clickKnowledgeAward(t.article.id)}}},[t._v("\n            本文申报\n          ")])])]):t._e(),t._v(" "),a("div",{staticClass:"reward-area"},[a("button",{staticClass:"article-reward-btn"},[t._v("\n          赞赏\n        ")]),t._v(" "),a("div",{staticClass:"qr-trigger"},[a("div",{staticClass:"reword-qr-container"},[a("img",{staticClass:"reward-qr-code",attrs:{src:t.rewardQrcodeUrl}}),t._v(" "),a("span",{staticClass:"reward-text"},[t._v("微信扫一扫赞赏")])])]),t._v(" "),t.articleRewards.length>0?a("div",{staticClass:"article-reward-info"},[a("div",{staticClass:"reward-people-list"},t._l(t.articleRewards,(function(t){return a("a",{key:t.from_user,attrs:{target:"_blank",href:"/user/"+t.from_user}},[a("img",{staticClass:"people-avatar",attrs:{src:"/asset/avatar/"+t.from_user}})])})),0),t._v(" "),a("div",{staticClass:"reward-count"},[a("span",{staticClass:"number-text"},[t._v(t._s(t.articleRewards.length))]),t._v("\n            人已赞赏\n          ")])]):t._e()]),t._v(" "),a("div",{staticClass:"feedback-block"},[a("big-operation-bar",{attrs:{"is-digged":t.isDigged,"is-favored":t.isFavored,"digg-count":t.diggCount,"favor-count":t.favorCount,"digg-user-list":t.diggUserList},on:{onDigg:function(e){return t.onDigg("bottom")},onFavor:function(e){return t.onModalFavor("bottom")},onShare:function(e){return t.onShare("bottom")}}})],1),t._v(" "),a("div",{staticClass:"operation-line"},[t.isShowActionPanel?a("div",{staticClass:"operation-button",on:{click:function(){t.isShowBottomEditModal=!0}}},[a("action-panel",{attrs:{"is-in-group":!!t.currentGroupId,"is-origin-group":t.isOriginGroup,"is-admin":t.isAdmin,"is-kbar-admin":t.isKbarAdmin,"is-reship-people":t.isReshipPeople,"has-edit-permission":t.hasArticleEditPermission,"is-top":t.isTop,"is-recommend":t.isRecommend,"is-essential":t.isEssential,"is-hidden":t.isHidden,"abstract-value":t.article.abstract},on:{actionDeal:t.actionDeal,onClose:function(e){t.isShowBottomEditModal=!1}}})],1):t._e(),t._v(" "),t.isSecretGroup?t._e():a("div",{staticClass:"operation-button item-hover"},[a("reship-modal",{attrs:{"group-id":t.currentGroupId,"post-id":t.article.id},on:{reshipRecordsChange:function(e){return t.reshipRecordsLength=e.length}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/reship",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),a("span",{staticClass:"item-value"},[t._v("转载")])],1)])],1),t._v(" "),a("div",{staticClass:"operation-button item-hover",on:{click:t.openCollectModal}},[a("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/collect",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),a("span",{staticClass:"item-value"},[t._v("收录")])],1),t._v(" "),a("div",{staticClass:"operation-button item-hover",on:{click:t.openFeedbackModal}},[a("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/feedback",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),a("span",{staticClass:"item-value"},[t._v("反馈")])],1),t._v(" "),a("collect-modal",{attrs:{"is-show-modal":t.isShowCollectModal,"post-id":t.article.id},on:{onClose:function(e){t.isShowCollectModal=!1},onSubmit:t.onCollectSubmit}})],1),t._v(" "),a("div",{staticClass:"article-comment-container"},[a("comment",{attrs:{"has-auth":t.hasArticleEditPermission,"target-id":t.article.id,"group-id":Number(t.article.group_id)||void 0,"reprint-group-id":t.currentGroupId,"target-type":t.targetType,"entity-info":t.article,"comment-count":t.commentCount,"referred-text":t.referredText},on:{afterAddComment:function(){return t.getFeedBackInfo(t.article.id)},afterDeleteComment:function(){return t.getFeedBackInfo(t.article.id)}}})],1)]),t._v(" "),a("div",{staticClass:"float-container"},[a("div",{staticClass:"float-operation inline-operation"},[a("div",{staticClass:"digg operation-item",class:t.isDigged?"digged-item":""},[a("div",{staticClass:"item-cicle",on:{click:function(e){return t.onDigg("right")}}},[a("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isDigging,expression:"!isDigging"}],staticClass:"item-icon",attrs:{width:24,height:24,name:t.isDigged?"operation/big-digg-active":"operation/big-digg"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.isDigging,expression:"isDigging"}],staticClass:"dig-gif",attrs:{src:t.digGifUrl,alt:""}}),t._v(" "),t.diggCount>0?a("div",{staticClass:"float-cycle-count"},[t._v("\n              "+t._s(t.diggCount>999?"999+":t.diggCount)+"\n            ")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"favor operation-item",class:t.isFavored?"favored-item":""},[a("div",{staticClass:"item-cicle",on:{click:function(e){return t.onModalFavor("right")}}},[a("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isFavoring,expression:"!isFavoring"}],staticClass:"item-icon",attrs:{width:24,height:24,name:t.isFavored?"operation/big-favorite-active":"operation/big-favorite"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.isFavoring,expression:"isFavoring"}],staticClass:"favor-gif",attrs:{src:t.favorGifUrl,alt:""}}),t._v(" "),t.favorCount>0?a("div",{staticClass:"float-cycle-count"},[t._v("\n              "+t._s(t.favorCount>999?"999+":t.favorCount)+"\n            ")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"comment operation-item",on:{click:function(e){return t.onToComment("right")}}},[a("div",{staticClass:"item-cicle"},[a("svg-icon",{staticClass:"item-icon",attrs:{width:24,height:24,name:"operation/comment"}}),t._v(" "),t.commentCount>0?a("div",{staticClass:"float-cycle-count"},[t._v("\n              "+t._s(t.commentCount>999?"999+":t.commentCount)+"\n            ")]):t._e()],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowBackTop,expression:"isShowBackTop"}],staticClass:"totop operation-item",on:{click:t.onTotop}},[a("div",{staticClass:"item-cicle"},[a("svg-icon",{staticClass:"item-icon",attrs:{width:24,height:24,name:"operation/to-top"}})],1)])])]),t._v(" "),a("div",{ref:"rightSideRef",staticClass:"right-side",class:{"right-side-show":t.showOtherInfo||t.tocList.length>0}},[t.showOtherInfo&&(t.isShowKnowledgeCard||t.isHeadline)?a("div",{staticClass:"award-card"},[t.isShowKnowledgeCard?a("div",{staticClass:"award-card-item"},[t._m(1),t._v(" "),a("div",{staticClass:"award-card-content"},[a("div",{staticClass:"award-card-text"},[t._v("\n              荣获"+t._s(t.knowledgeCardDesc)+"\n            ")]),t._v(" "),t._m(2)])]):t._e(),t._v(" "),t.isHeadline?a("div",{staticClass:"award-card-item"},[t._m(3),t._v(" "),t._m(4)]):t._e()]):t._e(),t._v(" "),a("div",{ref:"stickyRef",staticClass:"sticky-wrapper"},[a("div",{ref:"innerRef",staticClass:"inner-wrapper"},[t.showOtherInfo?a("div",{ref:"authorInfoRef",staticClass:"author-info-card"},[a("div",{staticClass:"author-info"},[a("div",{ref:"article_author"+t.article.created_by,on:{mouseenter:function(e){return t.renderUserCard(t.createrInfo,t.article.created_by)},mouseleave:function(e){return t.renderUserCard(t.createrInfo)}}},[a("badge-twitter",{attrs:{"user-data":t.userCardItem}}),t._v(" "),a("a",{attrs:{target:"_blank",href:"/user/"+t.article.created_by}},[a("img",{staticClass:"avatar",attrs:{src:t.article.created_by?"/asset/avatar/"+t.article.created_by:""}})])],1),t._v(" "),a("div",{staticClass:"user-desc"},[a("div",{staticClass:"username-wrapper"},[a("a",{staticClass:"username",attrs:{target:"_blank",href:"/user/"+t.article.created_by}},[t._v("\n                    "+t._s(t.article.created_by)+"\n                  ")]),t._v(" "),Number(t.userMedal.id)?a("a",{attrs:{target:"_blank",href:t.userMedalLink,title:t.userMedal.name}},[a("img",{staticClass:"user-medal",attrs:{src:t.userMedal.logo}})]):t._e()]),t._v(" "),t.createrInfo.position?a("a",{staticClass:"usergroup",attrs:{target:"_blank",href:"/user/"+t.article.created_by}},[t._v("\n                  "+t._s(t.createrInfo.position)+"\n                ")]):t._e()])]),t._v(" "),t.showOtherInfo?a("div",{staticClass:"author-articles-info"},[a("div",{staticClass:"article-list"},[a("div",{staticClass:"card-title",staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[t._v("\n                  作者文章\n                  "),a("t-button",{staticStyle:{height:"22px"},attrs:{shape:"square",variant:"text",size:"small",href:"/user/"+t.article.created_by+"/articles?kmref=author_recommend"}},[a("svg-icon",{attrs:{slot:"icon",name:"common/new-arrow",width:16,height:16,viewBox:"0 0 16 16"},slot:"icon"})],1)],1),t._v(" "),t._l(t.authorArticles,(function(e){return a("div",{key:e.id,staticClass:"article-list-item"},[a("a",{staticClass:"item-text",attrs:{target:"_blank",href:"/articles/show/"+e.id+"?kmref=author_recommend",title:e.title}},[t._v("\n                    "+t._s(e.title)+"\n                  ")])])}))],2),t._v(" "),t.showOtherInfo&&t.collectedKnowledgeList.length>0?a("div",{staticClass:"collected-articles-card"},[a("div",{staticClass:"card-title"},[t._v("\n                  收录文集\n                ")]),t._v(" "),a("div",{staticClass:"knowledge-list"},t._l(t.collectedKnowledgeList,(function(e,i){return a("div",{key:i,staticClass:"knowledge-list-item"},[a("a",{staticClass:"knowledge-logo",attrs:{target:"_blank",href:"/knowledge/"+e.id+"?kmref=article_knowledges"}},[a("img",{attrs:{src:e.logo},on:{error:t.handleKnowledeCoverError}})]),t._v(" "),a("div",{staticClass:"knowledge-info"},[a("a",{staticClass:"knowledge-title",attrs:{target:"_blank",href:"/knowledge/"+e.id+"?kmref=article_knowledges"}},[t._v("\n                        "+t._s(e.title)+"\n                      ")]),t._v(" "),a("div",{staticClass:"knowledge-desc"},[a("span",[t._v("浏览 "+t._s(e.read_count))])])])])})),0)]):t._e()]):t._e()]):t._e(),t._v(" "),a("div",{ref:"scrollList",staticClass:"list-scroll"},[t.showOtherInfo&&t.youLikeArticles.length>0&&!t.isHaveEntry?a("div",{staticClass:"youlike-articles-card"},[a("div",{staticClass:"card-title"},[t._v("\n                推荐阅读\n              ")]),t._v(" "),a("div",{staticClass:"article-list"},t._l(t.youLikeArticles,(function(e){return a("div",{key:e.id,staticClass:"article-list-item"},[a("a",{staticClass:"item-text",attrs:{target:"_blank",href:"/articles/show/"+e.id+"?kmref=article_recommend",title:e.title}},[t._v("\n                    "+t._s(e.title)+"\n                  ")])])})),0)]):t._e(),t._v(" "),!t.isKnwl&&t.articleTags.length>0?a("div",{ref:"entryCard",staticClass:"entry-card"},[a("relation-entry-mod",{attrs:{tags:t.articleTags,"q-id-prop":t.articleId,"target-type":"article"}})],1):t._e()]),t._v(" "),t.disableToc?t._e():a("div",{staticClass:"toc-card"},[a("article-toc",{attrs:{options:t.tocOptions,"is-init":t.isInit,"is-show":t.isShow,"toc-list":t.tocList}})],1)])])])]),t._v(" "),t.hasArticleViewPermssion||t.isLoading?t._e():a("error-show",{attrs:{"is-full":!1,height:740,width:1100,"error-text":"无权限或已删除"}}),t._v(" "),a("feedback-modal",{attrs:{"is-show-modal":t.isShowFeedbackModal},on:{onClose:function(e){t.isShowFeedbackModal=!1},onSubmit:t.onFeedbackModaSubmit}}),t._v(" "),a("share-modal",{attrs:{"is-new-share":!0,"is-show-reason":!0,"is-show-modal":t.isShowShareModal,"copy-prefix-text":t.article.title,"target-id":t.article.id,"share-data":t.actionData.share_to,"woa-link-url":t.woaLinkUrl,"tencent-link-url":t.tencentLinkUrl},on:{onClose:function(e){t.isShowShareModal=!1},onSubmit:function(e){t.isShowShareModal=!1}}}),t._v(" "),a("ai-drawer",{attrs:{"default-width":t.aiDrawerDefaultWidth,model:t.aiModel},model:{value:t.aiDrawerVisible,callback:function(e){t.aiDrawerVisible=e},expression:"aiDrawerVisible"}},t._l(t.aiDrawerList,(function(e){return a("ai-drawer-item",{key:e.title,attrs:{loading:e.loading,title:e.title,content:e.data,editable:"code"===t.aiDrawerActiveType?t.isAdmin:t.hasArticleEditPermission,"on-rebuild":t.onRebuild,"on-evaluate":t.onEvaluate,"on-feedback":t.onFeedback},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between",width:"100%"}},[t._v("\n          "+t._s(e.title)+"\n          "),"abstract"===t.aiDrawerActiveType&&t.hasArticleEditPermission?a("t-button",{staticStyle:{height:"28px",padding:"0 4px"},attrs:{theme:"primary",variant:"text",title:"仅文章作者和管理员可见"},on:{click:function(e){return t.handleAbstractStatusClick(!1)}}},[t._v("\n            关闭摘要\n          ")]):t._e()],1)]},proxy:!0}],null,!0)})})),1),t._v(" "),a("ai-drawer",{staticClass:"chat-drawer",attrs:{visible:t.chatdDrawerVisible,"default-width":t.aiDrawerDefaultWidth,"show-title-icon":!1,"draw-title":"AI吧内问答(灰度中)"},on:{input:t.handleChatClose}},[a("chat-drawer-item",{attrs:{"on-feedback":t.onFeedback}})],1),t._v(" "),a("favor-modal",{attrs:{"post-id":t.article.id,"is-show-modal":t.isShowFavorModal},on:{onSubmit:function(e){t.isShowFavorModal=!1},onClose:function(e){t.isShowFavorModal=!1}}}),t._v(" "),a("edit-confirm-modal",{attrs:{article:t.article,"is-show-edit-confirm-modal":t.isShowEditConfirmModal},on:{closeEditConfirmModal:t.onEditConfirmClose}}),t._v(" "),a("div",{style:t.quoteTooltipContainerStyle},[a("t-tooltip",{attrs:{trigger:"click","overlay-inner-class-name":"quote-tooltip"}},[a("div",{ref:"quoteButtonDOM",style:t.quoteTooltipStyle}),t._v(" "),a("div",{staticClass:"quote-button",attrs:{slot:"content"},on:{click:t.handleQuoteClick},slot:"content"},[a("svg-icon",{staticClass:"quote-icon",attrs:{name:"operation/quote",width:18,height:18,viewBox:"0 0 18 18"}}),t._v("\n        引用\n      ")],1)])],1)],1)}),a,!1,null,"175c5d4b",null);e.a=Bi.exports},2093:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(6),n=i.n(s),o=i(41),r=i.n(o),l=function(t){return t<768?"xs":t>=768&&t<992?"sm":t>=992&&t<1200?"md":t>=1200&&t<1400?"lg":t>=1400&&t<1880?"xl":"xxl"},c={flex:{type:[String,Number]},lg:{type:[Number,Object]},md:{type:[Number,Object]},offset:{type:Number,default:0},order:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},sm:{type:[Number,Object]},span:{type:Number},tag:{type:String,default:"div"},xl:{type:[Number,Object]},xs:{type:[Number,Object]},xxl:{type:[Number,Object]}},d=i(10),u=i(18),p=i(22);i(16),i(23),i(25),i(24),i(27),i(26);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var v=Object(u.b)("col"),g=Object(p.a)(v).extend({name:"TCol",props:m({},c),inject:["rowContext"],data:function(){return{size:"md"}},computed:{classes:function(){var t=this,e=this.span,i=this.order,a=this.offset,s=this.push,o=this.pull,l=["xs","sm","md","lg","xl","xxl"].reduce((function(e,i){var a=t[i],s={};return"number"==typeof a?s.span=a:r()(a)&&(s=a||{}),m(m({},e),{},n()(n()(n()(n()(n()({},"".concat(t.componentName,"-").concat(i,"-").concat(s.span),void 0!==s.span),"".concat(t.componentName,"-").concat(i,"-order-").concat(s.order),parseInt(s.order,10)>=0),"".concat(t.componentName,"-").concat(i,"-offset-").concat(s.offset),parseInt(s.offset,10)>=0),"".concat(t.componentName,"-").concat(i,"-push-").concat(s.push),parseInt(s.push,10)>=0),"".concat(t.componentName,"-").concat(i,"-pull-").concat(s.pull),parseInt(s.pull,10)>=0))}),{});return m(n()(n()(n()(n()(n()(n()({},"".concat(this.componentName),!0),"".concat(this.componentName,"-").concat(e),void 0!==e),"".concat(this.componentName,"-order-").concat(i),i),"".concat(this.componentName,"-offset-").concat(a),a),"".concat(this.componentName,"-push-").concat(s),s),"".concat(this.componentName,"-pull-").concat(o),o),l)}},mounted:function(){this.updateSize(),window.addEventListener("resize",this.updateSize)},beforeDestroy:function(){window.removeEventListener("resize",this.updateSize)},methods:{updateSize:function(){this.size=l(window.innerWidth)},parseFlex:function(t){return"number"==typeof t?"".concat(t," ").concat(t," 0"):/^\d+(\.\d+)?(px|r?em|%)$/.test(t)?"0 0 ".concat(t):t},calcColPadding:function(t,e){var i={};return"number"==typeof t?Object.assign(i,{paddingLeft:"".concat(t/2,"px"),paddingRight:"".concat(t/2,"px")}):Array.isArray(t)&&t.length?("number"==typeof t[0]&&Object.assign(i,{paddingLeft:"".concat(t[0]/2,"px"),paddingRight:"".concat(t[0]/2,"px")}),r()(t[0])&&t[0][e]&&Object.assign(i,{paddingLeft:"".concat(t[0][e]/2,"px"),paddingRight:"".concat(t[0][e]/2,"px")})):r()(t)&&t[e]&&Object.assign(i,{paddingLeft:"".concat(t[e]/2,"px"),paddingRight:"".concat(t[e]/2,"px")}),i}},render:function(){var t=arguments[0],e=this.flex,i=this.tag,a=this.classes,s={};e&&(s.flex=this.parseFlex(e));var n=this.rowContext;if(n){var o=n.gutter;Object.assign(s,this.calcColPadding(o,this.size))}return t(i,{class:a,style:s},[Object(d.b)(this,"default")])}}),f=i(43),_=i(17),b=i.n(_),y={align:{type:String,default:"top",validator:function(t){return!t||["start","end","center","stretch","baseline","top","middle","bottom"].includes(t)}},gutter:{type:[Number,Object,Array],default:0},justify:{type:String,default:"start",validator:function(t){return!t||["start","end","center","space-around","space-between"].includes(t)}},tag:{type:String,default:"div"}},w=i(60);i(48),i(38),i(32),i(67),i(51),i(46),i(42);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}var k=Object(u.b)("row"),O=Object(p.a)(k).extend({name:"TRow",props:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},y),data:function(){return{size:"md"}},provide:function(){return{rowContext:{gutter:this.gutter}}},computed:{classes:function(){var t=this.justify,e=this.align;return[this.componentName,n()(n()({},"".concat(this.componentName,"--").concat(t),t),"".concat(this.componentName,"--align-").concat(e),e)]}},mounted:function(){this.updateSize(),this.handleIE(),window.addEventListener("resize",this.updateSize)},watch:{gutter:function(){this.handleIE()},size:function(){this.handleIE()}},beforeDestroy:function(){window.removeEventListener("resize",this.updateSize)},methods:{updateSize:function(){this.size=l(window.innerWidth)},handleIE:function(){if(Object(w.b)()<=11){var t=this.rowGap(this.gutter,this.size);t&&this.$el.setAttribute("row-gap","".concat(t))}},calcRowStyle:function(t,e){var i={};return"number"==typeof t?Object.assign(i,{marginLeft:"".concat(t/-2,"px"),marginRight:"".concat(t/-2,"px")}):Array.isArray(t)&&t.length?("number"==typeof t[0]&&Object.assign(i,{marginLeft:"".concat(t[0]/-2,"px"),marginRight:"".concat(t[0]/-2,"px")}),"number"==typeof t[1]&&Object.assign(i,{rowGap:"".concat(t[1],"px")}),r()(t[0])&&void 0!==t[0][e]&&Object.assign(i,{marginLeft:"".concat(t[0][e]/-2,"px"),marginRight:"".concat(t[0][e]/-2,"px")}),r()(t[1])&&void 0!==t[1][e]&&Object.assign(i,{rowGap:"".concat(t[1][e],"px")})):r()(t)&&t[e]&&(Array.isArray(t[e])&&t[e].length?(Object.assign(i,{marginLeft:"".concat(t[e][0]/-2,"px"),marginRight:"".concat(t[e][0]/-2,"px")}),Object.assign(i,{rowGap:"".concat(t[e][1],"px")})):Object.assign(i,{marginLeft:"".concat(t[e]/-2,"px"),marginRight:"".concat(t[e]/-2,"px")})),i},rowGap:function(t,e){var i;if(Array.isArray(t)&&t.length){if("number"==typeof t[1])i=b()(t,2)[1];r()(t[1])&&void 0!==t[1][e]&&(i=t[1][e])}else if(r()(t)&&t[e]){if(Array.isArray(t[e])&&t[e].length)i=b()(t[e],2)[1]}return i}},render:function(){var t=arguments[0],e=this.tag,i=this.classes,a=this.calcRowStyle(this.gutter,this.size),s={class:i,style:a,attrs:{}};return t(e,Object(f.a)([{},s]),[this.$slots.default])}}),x=i(35),j=(i(56),Object(x.a)(g)),I=Object(x.a)(O),T=i(121),S=i(1897),D=i.n(S),q=i(53),E=i.n(q),A=i(1977),M=i(1978),$=i(93),L=i(50),P={alt:{type:String,default:""},error:{type:[String,Function]},fallback:{type:String,default:""},fit:{type:String,default:"fill",validator:function(t){return!t||["contain","cover","fill","none","scale-down"].includes(t)}},gallery:Boolean,lazy:Boolean,loading:{type:[String,Function]},overlayContent:{type:[String,Function]},overlayTrigger:{type:String,default:"always",validator:function(t){return!t||["always","hover"].includes(t)}},placeholder:{type:[String,Function]},position:{type:String,default:"center"},referrerpolicy:{type:String,validator:function(t){return!t||["no-referrer","no-referrer-when-downgrade","origin","origin-when-cross-origin","same-origin","strict-origin","strict-origin-when-cross-origin","unsafe-url"].includes(t)}},shape:{type:String,default:"square",validator:function(t){return!t||["circle","round","square"].includes(t)}},src:{type:[String,Object]},srcset:{type:Object},onError:Function,onLoad:Function},F=i(2105),R=i(118),N=Object(a.c)({name:"TImage",components:{Space:F.a},props:P,setup:function(t,e){var i=e.emit,s=t.onLoad,n=t.onError,o=Object(a.t)(t),r=o.src,l=o.lazy,c=o.fallback,d=o.overlayTrigger,u=D()(t,["className","src","style","alt","fit","position","shape","placeholder","loading","error","overlayTrigger","overlayContent","lazy","gallery","onLoad","onError"]),p=Object(L.a)("image"),h=p.classPrefix,m=p.globalConfig,v=Object(a.r)(null),g=Object(a.r)(r.value);Object(a.u)([r,m],(function(e){var i=b()(e,2),a=i[0],s=(i[1]||{}).replaceImageSrc,n=E()(s)?s(t):a;n===g.value&&g.value||(g.value=n)}),{immediate:!0});var f=Object(R.a)(g).previewUrl;Object(a.u)([f],(function(){w.value=!1,y.value=!1}));var _=Object(a.r)(!l.value),y=Object(a.r)(!1),w=Object(a.r)(!1),C="hover"===d.value,k=Object(a.r)(!C);return{imageRef:v,imageClasses:Object(a.a)((function(){return["".concat(h.value,"-image"),"".concat(h.value,"-image--fit-").concat(t.fit),"".concat(h.value,"-image--position-").concat(t.position)]})),handleLoadImage:function(){_.value=!0},classPrefix:h,globalConfig:m,hasMouseEvent:C,handleToggleOverlay:function(){C&&(k.value=!k.value)},shouldShowOverlay:k,imageStrSrc:g,previewUrl:f,hasError:w,shouldLoad:_,handleError:function(t){w.value=!0,c.value&&(g.value=c.value,w.value=!1),i("error",{e:t}),null==n||n({e:t})},handleLoad:function(t){y.value=!0,i("load",{e:t}),null==s||s({e:t})},isLoaded:y,rest:u}},mounted:function(){if(this.lazy&&this.imageRef){var t=Object($.a)(this.imageRef,null,this.handleLoadImage,0);this.io=t}},destroyed:function(){this.imageRef&&this.io&&this.io.unobserve(this.imageRef)},methods:{renderPlaceholder:function(){var t=this.$createElement,e=Object(d.b)(this,"placeholder");if(e)return t("div",{class:"".concat(this.classPrefix,"-image__placeholder")},[e])},renderGalleryShadow:function(){var t=this.$createElement;return this.gallery?t("div",{class:"".concat(this.classPrefix,"-image__gallery-shadow")}):null},renderOverlay:function(){var t=this.$createElement,e=Object(d.b)(this,"overlayContent");return e?t("div",{class:["".concat(this.classPrefix,"-image__overlay-content"),!this.shouldShowOverlay&&"".concat(this.classPrefix,"-image__overlay-content--hidden")]},[e]):null},renderImageSrcset:function(){var t=this.$createElement;return t("picture",[Object.entries(this.srcset).map((function(e){var i=b()(e,2),a=i[0],s=i[1];return t("source",{attrs:{type:a,srcset:s}})})),this.renderImage()])},renderImage:function(){return(0,this.$createElement)("img",{attrs:{src:"string"==typeof this.imageStrSrc?this.imageStrSrc:this.previewUrl,alt:this.alt,referrerpolicy:this.referrerpolicy},on:{error:this.handleError,load:this.handleLoad},class:this.imageClasses})}},render:function(){var t=arguments[0];return t("div",Object(f.a)([{ref:"imageRef",class:["".concat(this.classPrefix,"-image__wrapper"),"".concat(this.classPrefix,"-image__wrapper--shape-").concat(this.shape),this.gallery&&"".concat(this.classPrefix,"-image__wrapper--gallery"),this.hasMouseEvent&&"".concat(this.classPrefix,"-image__wrapper--need-hover"),this.className],on:{mouseenter:this.handleToggleOverlay,mouseleave:this.handleToggleOverlay}},this.rest,{},{on:this.$listeners}]),[this.renderPlaceholder(),this.renderGalleryShadow(),(this.hasError||!this.shouldLoad)&&t("div",{class:"".concat(this.classPrefix,"-image")}),!(this.hasError||!this.shouldLoad)&&(this.srcset&&Object.keys(this.srcset).length?this.renderImageSrcset():this.renderImage()),!(this.hasError||!this.shouldLoad)&&!this.isLoaded&&t("div",{class:"".concat(this.classPrefix,"-image__loading")},[Object(d.b)(this,"loading")||t(F.a,{attrs:{direction:"vertical",size:8,align:"center"}},[t(A.a,{attrs:{size:"24px"}}),"string"==typeof this.loading?this.loading:this.globalConfig.loadingText])]),this.hasError&&t("div",{class:"".concat(this.classPrefix,"-image__error")},[Object(d.b)(this,"error")||t(F.a,{attrs:{direction:"vertical",size:8,align:"center"}},[t(M.a,{attrs:{size:"24px"}}),"string"==typeof this.error?this.error:this.globalConfig.errorText])]),this.renderOverlay()])}}),B=i(82),U=Object(x.a)(Object(B.a)(["value"])(N)),H=i(87),V=i(2414),z=i(148),G=i(1327),K=i(1328),W=i(2089),Q=i.n(W),J=i(2310),Y=i.n(J),X=i(2058),Z=Object(a.c)({components:{TCol:j,TRow:I,TButton:T.a,TImage:U,TLoading:H.a,TLink:V.a,TTag:z.b,ChevronLeftIcon:G.a,ChevronRightIcon:K.a},props:{loading:{type:Boolean,required:!1,default:!1},data:{type:Array,required:!0,default:()=>[]},current:{type:Number,required:!1,default:()=>1},isEnd:{type:Boolean,required:!1,default:!1},onChange:{type:Function,required:!1,default:()=>{}}},setup(){const{getTimeText:t,getLocationText:e,getSignStatusText:i}=Object(X.a)();return{defaultEventCover:Q.a,defaultKbarCover:Y.a,getTimeText:t,getLocationText:e,getSignStatusText:i,getEventHref:({id:t,group_id:e})=>e&&0!=+e?`/group/${e}/event/${t}`:"/event/"+t,getImgLimitUrl:(t,{width:e})=>{const i=`imageMogr2/thumbnail/${e}x>/ignore-error/1`;return-1!==t.indexOf("?")?`${t}&${i}`:`${t}?${i}`}}}}),tt=i(68),et=Object(tt.a)(Z,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-loading",{attrs:{size:"small",loading:t.loading,"show-overlay":""},scopedSlots:t._u([{key:"indicator",fn:function(){return[i("svg-icon",{attrs:{name:"common/loading2",width:16,height:16}})]},proxy:!0}])},[t._v(" "),t.data.length?i("t-row",{attrs:{gutter:20}},t._l(t.data,(function(e){return i("t-col",{key:e.id,staticStyle:{"margin-bottom":"28px"},attrs:{span:3}},[i("t-link",{staticClass:"cover-container",attrs:{target:"_blank",href:t.getEventHref(e)}},[i("t-image",{staticClass:"cover",style:{width:"100%",height:"131px"},attrs:{lazy:"",loading:"",src:e.pic?t.getImgLimitUrl(e.pic,{width:486}):t.defaultEventCover,fallback:t.defaultEventCover}}),t._v(" "),1==+e.status||2==+e.status?i("t-tag",{staticClass:"tag",style:{background:1==+e.status?"#00000066":"#CFCFCF"},attrs:{variant:"light"}},[t._v("\n            "+t._s(1==+e.status?"活动进行中":"活动已结束")+"\n          ")]):t._e()],1),t._v(" "),i("div",{staticClass:"header",attrs:{title:e.title}},[i("t-link",{staticClass:"title",attrs:{theme:"default",hover:"color",target:"_blank",href:t.getEventHref(e)}},[t._v("\n            "+t._s(e.title)+"\n          ")])],1),t._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"content-item",staticStyle:{"font-weight":"500",color:"#1a1a1a"}},[i("svg-icon",{staticClass:"icon",attrs:{name:"events/time",width:16,height:16}}),t._v("\n            "+t._s(t.getTimeText({time:e.start_time}))+"\n          ")],1),t._v(" "),i("div",{staticClass:"content-item",attrs:{title:t.getLocationText(e)}},[i("svg-icon",{staticClass:"icon",attrs:{name:"events/location",width:16,height:16}}),t._v(" "),i("span",{staticClass:"content-item-text"},[t._v(t._s(t.getLocationText(e)))])],1),t._v(" "),i("div",{staticClass:"content-item",style:"2"===e.sign_status?"color: #A6A6A6":""},[i("svg-icon",{staticClass:"icon",attrs:{name:"events/sign-status",width:16,height:16}}),t._v("\n            "+t._s(t.getSignStatusText(e))+"\n          ")],1),t._v(" "),e.group_name?i("div",{staticClass:"content-item",attrs:{title:e.group_name}},[i("t-image",{staticClass:"icon",style:{width:"16px",height:"16px"},attrs:{lazy:"",loading:"",src:t.getImgLimitUrl(e.group_logo,{width:32}),fallback:t.defaultKbarCover}}),t._v(" "),i("span",{staticClass:"content-item-text"},[i("t-link",{staticClass:"content-item-link",attrs:{theme:"default",hover:"color",target:"_blank",href:"/group/"+e.group_id}},[t._v("\n                "+t._s(e.group_name)+"\n              ")])],1)],1):t._e()])],1)})),1):i("div",{key:"empty-text",staticClass:"empty"},[t._v("\n      暂无活动\n    ")])],1),t._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("t-button",{attrs:{disabled:t.current<=1||t.loading,shape:"square",theme:"default",variant:"outline"},on:{click:function(e){return t.onChange({current:t.current-1})}}},[i("ChevronLeftIcon",{attrs:{slot:"icon"},slot:"icon"})],1),t._v(" "),i("t-button",{staticStyle:{cursor:"default"},attrs:{shape:"square"}},[t._v("\n      "+t._s(t.current)+"\n    ")]),t._v(" "),i("t-button",{attrs:{disabled:t.isEnd||t.loading,shape:"square",theme:"default",variant:"outline"},on:{click:function(e){return t.onChange({current:t.current+1})}}},[i("ChevronRightIcon",{attrs:{slot:"icon"},slot:"icon"})],1)],1)],1)}),[],!1,null,"33b9aee2",null);e.a=et.exports},2094:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a,s=i(2010),n=i(2032),o=i(16),r=i.n(o),l=i(6),c=i.n(l),d=i(8),u=i(53),p=i.n(u),h=i(27),m=i.n(h),v=i(60),g=i(47),f="\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow-y:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n",_=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function b(t){var e=window.getComputedStyle(t),i=e.getPropertyValue("box-sizing")||e.getPropertyValue("-moz-box-sizing")||e.getPropertyValue("-webkit-box-sizing"),a=parseFloat(e.getPropertyValue("padding-bottom"))+parseFloat(e.getPropertyValue("padding-top")),s=parseFloat(e.getPropertyValue("border-bottom-width"))+parseFloat(e.getPropertyValue("border-top-width"));return{sizingStyle:_.map((function(t){return"".concat(t,":").concat(e.getPropertyValue(t))})).join(";"),paddingSize:a,borderSize:s,boxSizing:i}}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a||(a=document.createElement("textarea"),document.body.appendChild(a));var s=b(t),n=s.paddingSize,o=s.borderSize,r=s.boxSizing,l=s.sizingStyle;a.setAttribute("style","".concat(l,";").concat(f)),a.value=t.value||t.placeholder||"";var c=a.scrollHeight,d={};"border-box"===r?c+=o:"content-box"===r&&(c-=n),a.value="";var u=a.scrollHeight-n;if(null!==e){var p=u*e;"border-box"===r&&(p=p+n+o),c=Math.max(p,c),d.minHeight="".concat(p,"px")}if(null!==i){var h=u*i;"border-box"===r&&(h=h+n+o),c=Math.min(h,c)}return d.height="".concat(c,"px"),a.parentNode&&a.parentNode.removeChild(a),a=null,d}var w=i(10),C=i(18),k=i(22),O=i(52),x={autofocus:Boolean,autosize:{type:[Boolean,Object],default:!1},disabled:Boolean,maxcharacter:{type:Number},maxlength:{type:[Number,String]},name:{type:String,default:""},placeholder:{type:String,default:void 0},readonly:Boolean,status:{type:String,validator:function(t){return["default","success","warning","error"].includes(t)}},tips:{type:[String,Function]},value:{type:[String,Number]},defaultValue:{type:[String,Number]},onBlur:Function,onChange:Function,onFocus:Function,onKeydown:Function,onKeypress:Function,onKeyup:Function};i(48),i(38),i(17),i(32),i(67),i(51),i(46),i(42),i(23),i(25),i(24),i(26);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function j(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function I(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?j(Object(i),!0).forEach((function(e){c()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var T=Object(C.b)("textarea");function S(t){var e={};return Object.keys(t).forEach((function(i){void 0!==t[i]&&(e[i]=t[i])})),e}var D=Object(k.a)(d.default,T).extend({name:"TTextarea",props:I({},x),inject:{tFormItem:{default:void 0}},data:function(){return{formDisabled:void 0,focused:!1,mouseHover:!1,textareaStyle:{},isComposing:!1}},computed:{tDisabled:function(){return this.formDisabled||this.disabled},textareaClasses:function(){return[this.componentName,c()(c()({},"".concat(this.classPrefix,"-is-disabled"),this.tDisabled),"".concat(this.classPrefix,"-is-readonly"),this.readonly)]},limitClasses:function(){return["".concat(this.componentName,"__limit"),c()({},"".concat(this.classPrefix,"-is-disabled"),this.tDisabled)]},inputAttrs:function(){return S({autofocus:this.autofocus,disabled:this.tDisabled,readonly:this.readonly,placeholder:this.placeholder,name:this.name||void 0,unselectable:this.readonly?"on":"off"})},characterNumber:function(){var t=Object(g.b)(String(this.value||""));return"object"===r()(t)?t.length:t}},mounted:function(){var t=this.$refs.refTextareaElem;t?t.addEventListener("transitionend",this.adjustTextareaHeightAfterReady):this.adjustTextareaHeightAfterReady()},beforeDestroy:function(){var t=this.$refs.refTextareaElem;t&&t.removeEventListener("transitionend",this.adjustTextareaHeightAfterReady)},watch:{autofocus:{handler:function(t){var e=this;!0===t&&this.$nextTick((function(){var t=e.$refs.refTextareaElem;null==t||t.focus()}))},immediate:!0},value:{handler:function(){var t=this;this.$nextTick((function(){return t.adjustTextareaHeight()}))},immediate:!0},textareaStyle:{handler:function(t){var e=this.$attrs.style;Object(O.a)(this.$refs.refTextareaElem,m()(e,t))},immediate:!0}},methods:{adjustTextareaHeight:function(){var t=this;this.$nextTick((function(){if(t.$refs.refTextareaElem)if(!0===t.autosize)t.textareaStyle=y(t.$refs.refTextareaElem);else if(t.autosize&&"object"===r()(t.autosize)){var e,i;t.textareaStyle=y(t.$refs.refTextareaElem,null===(e=t.autosize)||void 0===e?void 0:e.minRows,null===(i=t.autosize)||void 0===i?void 0:i.maxRows)}else t.$attrs.rows&&(t.textareaStyle={height:"auto",minHeight:"auto"})}))},adjustTextareaHeightAfterReady:function(){var t=this;this.$nextTick((function(){return t.adjustTextareaHeight()}))},emitEvent:function(t,e,i){this.$emit(t,e,i);var a=Object(g.d)(t);p()(this[a])&&this[a](e,i)},focus:function(){var t=this.$refs.refTextareaElem;null==t||t.focus()},blur:function(){var t=this.$refs.refTextareaElem;null==t||t.blur()},handleInput:function(t){this.inputValueChangeHandle(t)},onCompositionstart:function(){this.isComposing=!0},onCompositionend:function(t){this.isComposing=!1,this.inputValueChangeHandle(t)},inputValueChangeHandle:function(t){var e=this,i=t.target.value;if(!this.isComposing&&(this.maxlength&&(i=Object(v.d)(i,Number(this.maxlength))),this.maxcharacter&&this.maxcharacter>=0)){var a=Object(g.b)(i,this.maxcharacter);i="object"===r()(a)&&a.characters}this.$emit("input",i),this.isComposing||this.emitEvent("change",i,{e:t}),this.$nextTick((function(){return e.setInputValue(i)})),this.adjustTextareaHeight()},setInputValue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.$refs.refTextareaElem,i=String(t);e&&e.value!==i&&(e.value=i)},emitKeyDown:function(t){this.tDisabled||this.emitEvent("keydown",this.value,{e:t})},emitKeyUp:function(t){this.tDisabled||this.emitEvent("keyup",this.value,{e:t})},emitKeypress:function(t){this.tDisabled||this.emitEvent("keypress",this.value,{e:t})},emitFocus:function(t){this.tDisabled||(this.focused=!0,this.emitEvent("focus",this.value,{e:t}))},emitBlur:function(t){var e;this.focused=!1,null===(e=this.tFormItem)||void 0===e||e.validate("blur"),this.emitEvent("blur",this.value,{e:t})}},render:function(){var t=arguments[0],e=S({focus:this.emitFocus,blur:this.emitBlur,keydown:this.emitKeyDown,keyup:this.emitKeyUp,keypress:this.emitKeypress}),i=["".concat(this.componentName,"__inner"),c()(c()(c()(c()({},"".concat(this.classPrefix,"-is-").concat(this.status),this.status),this.commonStatusClassName.disabled,this.tDisabled),this.commonStatusClassName.focused,this.focused),"".concat(this.classPrefix,"-resize-none"),"object"===r()(this.autosize))],a=Object(w.b)(this,"tips"),s=a&&t("div",{class:["".concat(this.componentName,"__tips"),"".concat(this.componentName,"__tips--").concat(this.status||"normal")]},[a]),n=this.maxcharacter&&t("span",{class:this.limitClasses},["".concat(this.characterNumber,"/").concat(this.maxcharacter)])||!this.maxcharacter&&this.maxlength&&t("span",{class:this.limitClasses},["".concat(this.value?Object(v.c)(String(this.value)):0,"/").concat(this.maxlength)]);return t("div",{class:this.textareaClasses},[t("textarea",{on:I({input:this.handleInput,compositionstart:this.onCompositionstart,compositionend:this.onCompositionend},e),attrs:I({},I(I({},this.$attrs),this.inputAttrs)),domProps:{value:this.value},class:i,ref:"refTextareaElem"}),s||n?t("div",{class:["".concat(this.componentName,"__info_wrapper"),c()({},"".concat(this.componentName,"__info_wrapper_align"),!s)]},[s,n]):null])}}),q=i(82),E=i(35),A=(i(56),Object(E.a)(Object(q.a)(["value"])(D))),M=i(1971),$=i(1906),L=i(304),P=i(237),F={name:"CreateQMod",components:{kmBreadcrumb:s.a,trilobiteEditorMod:n.a,TTextarea:A,TDialog:M.a,TRadioGroup:$.c,TSelectInput:L.a,TCheckboxGroup:P.b},mixins:[],props:{qDetailData:{type:Object,default:()=>({})},pageType:{type:String,default:"add"},qId:{type:String,default:""}},data:()=>({pageAuthTag:-1,maxTitleLen:70,limitTagLen:5,tagContentLen:20,lockSubmit:!1,submitTips:"",visibleSubmit:!1,realTitle:"",needCheckTitle:!1,isEmptyTitle:!1,overSizeTitle:!1,noTitleMark:!1,qtitle:"",isFocusTitle:!1,recList:[],qTags:[],jsonContent:"",recTags:[],exampleTags:[{name:"微信",id:"38038"},{name:"QQ",id:"1915"},{name:"安全",id:"929"},{name:"游戏",id:"374"},{name:"智能硬件",id:"75315"},{name:"用户体验",id:"1117"}],isExampleTag:!0,tagTips:"",selectPact:!0,pactTipes:"请勾选 我已阅读并遵守《乐问公约》相关约定",selectAnonymity:!1,visibleNoAnony:!1,visibleInfo:!1,visibleDom:!0,relatedInformations:[],isFirstStrongTip:!0,qLeadWordList:[],currentTopic:null,showTopicDialog:!1,usableTopicList:[],topicPage:0,isTopicPageEnd:!1,topicLimit:10,lockTopic:!1,showQTypeDialog:!1,currentQType:-1,currentQTypeTips:"实名提问将有机会被乐问小编推荐，获得定制礼品。",usableQTypeList:[{value:1,id:"bug",label:"产品反馈类",checked:!1,tips:"此类问题建议实名，以便快速定位和解决。"},{value:2,id:"out",label:"业务讨论类",checked:!1,tips:"此类问题建议实名，实名提问将有机会被乐问小编推荐，获得定制礼品。"},{value:3,id:"inner",label:"职能服务类",checked:!1,tips:"此类问题建议实名，以便快速定位和解决。"},{value:4,id:"tech",label:"业界动态类",checked:!1,tips:"此类问题建议实名，实名提问将有机会被乐问小编推荐，获得定制礼品。"},{value:6,id:"company",label:"企业文化类",checked:!1,tips:"实名需要勇气，好问题将有机会获得乐问定制礼品。"},{value:7,id:"consult",label:"求助咨询类",checked:!1,tips:"此类问题建议实名，以便更直接地获得帮助。"},{value:5,id:"other",label:"其他类型",checked:!1,tips:"实名提问将有机会被乐问小编推荐，获得定制礼品。"}],defaultTemplateJson:'{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"【出现环境】：帐号，版本，操作系统"},{"type":"hardBreak"},{"type":"text","text":"【操作路径】："},{"type":"hardBreak"},{"type":"text","text":"【问题截图】："}]}],"version":1}',suddenQuestions:[],selectInputValue:"",canChooseOption:[],randomResId:"",visibleModel:!1,modelTips:"是否使用反馈模版替换已输入的内容?"}),computed:{tagStatus(){return this.tagTips?"warning":"default"},checkboxValue(){const t=[],e=this.qTags;for(let i=0,a=e.length;i<a;i++)t.push(e[i]);return t}},watch:{qDetailData(t){null!==t&&t.id&&"edit"===this.pageType&&this.initEditQuestion()}},created(){this.$store.dispatch("q/fetchNewEditorRainbow").then(t=>{if(t&&!t.trilobiteEditOpen&&-1===window.location.pathname.indexOf("vkm/"))if("/q/add"===window.location.pathname)window.location.replace("/q/add_old"+window.location.search);else{const t=window.location.pathname.replace("/edit/","/edit_old/");window.location.replace(`${t}${window.location.search}`)}})},mounted(){if(this.initSuddenQuestions(),this.initTagList([]),"add"===this.pageType){const t=this.$route.query.talk_id||null,e=this.$route.query.tag_id||null;e&&this.$store.dispatch("q/getTopicOrTagName",{type:"tag",idList:[e]}).then(t=>{t&&t.idMap&&t.idMap[String(e)]&&(this.qTags=[t.idMap[String(e)]])}).catch(()=>{}),t&&this.$store.dispatch("q/getTopicOrTagName",{type:"talk",idList:[t]}).then(e=>{e&&e.idMap&&e.idMap[String(t)]&&(this.currentTopic={id:t,title:e.idMap[String(t)]})}).catch(()=>{})}},destroy(){},methods:{keydownTitleFn(t,e){e&&"Enter"===e.e.key&&e.e.preventDefault()},confirmSelectModel(){this.updateEditorContent(this.defaultTemplateJson),this.visibleModel=!1},clickModel(){this.visibleModel=!0},handleBlur(){this.canChooseOption=[]},onCheckedChange(t,{current:e,type:i}){if(e)if("check"===i)if(this.qTags.length<5){const t=this.canChooseOption.find(t=>t.value===e);this.qTags.push(t&&t.value),this.tagTips=""}else this.tagTips="标签个数已满足5个";else this.qTags=this.qTags.filter(t=>t!==e);else this.qTags=("check"===i?this.canChooseOption.slice(1):[]).map(t=>t.value)},onTagChange(t,e){const{trigger:i,item:a}=e;if("enter"===i){const t={label:a,value:a};if(this.canChooseOption.length>0){if(!this.canChooseOption.some(e=>e.value===t.value)){const e=this.canChooseOption.concat(t);this.canChooseOption=e}}this.selectInputValue=""}},selectPactFn(t){t.target.classList&&t.target.classList.includes("pact-link")||(this.selectPact=!this.selectPact)},initEditQuestion(){this.qtitle=this.qDetailData.title||"",this.realTitle=this.qtitle.trim(),this.$nextTick(()=>{this.updateEditorContent(this.qDetailData.jsonContent)}),this.qTags=this.qDetailData.tags.map(t=>t);const{talkId:t,talkName:e}=this.qDetailData;t&&e&&(this.currentTopic={id:t,title:e}),this.selectAnonymity=!!this.qDetailData.isAnonymous,this.currentQType=Number(this.qDetailData.anonymousType),this.selectAnonymity&&(this.currentQType=0===this.currentQType?5:this.currentQType)},initSuddenQuestions(){this.$store.dispatch("q/fetchSuddenQuestionsInfo").then(({suddenQuestions:t})=>{this.suddenQuestions=t}).catch(()=>{this.suddenQuestions=[]})},updateEditorContent(t){this.$refs.trilobiteRef.updateContent(t)},getEditorContent(){const t=this.$refs.trilobiteRef.provideContent();this.jsonContent=t},preSubmitQuestion(){const t=`${this.realTitle}_${this.$refs.trilobiteRef.provideTextContent()}`;this.$store.dispatch("q/handleContentVerify",{content:t}).then(()=>{this.submitQuestion()}).catch(t=>{this.submitTips=t.msg||"敏感词校验失败",this.visibleSubmit=!0})},submitQuestion(){if(this.lockSubmit)return;this.visibleSubmit=!1,this.submitTips="",this.getEditorContent(),this.selectPact||(this.submitTips=this.pactTipes),this.realTitle.trim().length<1&&(this.submitTips="标题不能为空"),this.qTags.length<1&&(this.submitTips="需要至少选择1个标签"),this.qTags.length>5&&(this.submitTips="最多只能选择5个标签");this.qTags.some((t,e)=>this.qTags.indexOf(t)!==e)&&(this.submitTips="存在相同的标签名"),this.selectAnonymity&&this.currentQType<1&&(this.submitTips="匿名下需要选择一个问题所属的类型"),this.submitTips?this.visibleSubmit=!0:(this.lockSubmit=!0,this.$store.dispatch("q/createNewQuestion",{pageType:this.pageType,id:this.qId,title:this.realTitle,tags:this.qTags,content:this.jsonContent,talkId:this.currentTopic?Number(this.currentTopic.id):0,isAnonymous:this.selectAnonymity,anonymousType:this.selectAnonymity?Number(this.currentQType):0}).then(t=>{window.location.href="/q/view/"+t.id,this.lockSubmit=!1}).catch(t=>{this.submitTips=t&&t.message||"创建乐问失败，请稍后再试",this.visibleSubmit=!0,this.lockSubmit=!1}))},cancelCreate(){1===window.history.length?window.close():window.history.go(-1)},continueAnony(){this.visibleInfo=!1,this.visibleNoAnony=!0},selectRealName(){this.visibleInfo=!1,this.selectAnonymity=!1},confirmAnony(){this.visibleNoAnony=!1,this.selectAnonymity=!0},confirmQType(){if(this.currentQType<0)return;const t=this.usableQTypeList.find(t=>t.value===this.currentQType);this.currentQTypeTips=t?t.tips:this.currentQTypeTips,this.showQTypeDialog=!1,this.visibleInfo=!0},closeQType(){this.selectAnonymity=!1,this.currentQType=-1,this.showQTypeDialog=!1},operateAnonymityFn(){this.selectAnonymity?this.selectAnonymity=!1:this.$store.dispatch("q/checkPermission").then(t=>{"1"===t.code||"2"===t.code?(this.showQTypeDialog=!1,this.submitTips=t.message||"",this.visibleSubmit=!0):this.showQTypeDialog=!0}).catch(()=>{this.showQTypeDialog=!0})},addTopicFn(){this.showTopicDialog=!0,this.topicPage=0,this.isTopicPageEnd=!1,this.loadPage()},operateTopicFn(t,e){if("delete"===t)return this.currentTopic=null,!1;"add"===t&&(this.currentTopic=e,this.showTopicDialog=!1)},loadPrePage(){this.isTopicPageEnd=!1,this.topicPage>1&&(this.topicPage=this.topicPage-2,this.loadPage())},loadPage(){this.lockTopic||this.isTopicPageEnd||(this.lockTopic=!0,this.topicPage+=1,this.$store.dispatch("q/fetchTalkList",{page:this.topicPage,limit:this.topicLimit}).then(t=>{this.usableTopicList=t,this.usableTopicList.length<this.topicLimit?this.isTopicPageEnd=!0:this.isTopicPageEnd=!1,this.lockTopic=!1}).catch(()=>{console.log("error"),this.usableTopicList=[],this.lockTopic=!1}))},closeRecFn(){this.recList=[]},selectTagFn(t){!this.qTags.includes(t)&&this.qTags.length<this.limitTagLen&&(this.qTags.push(t),this.changeLabelFn(this.qTags))},initTagList(t){t.length>0?(this.recTags=t.slice(0,15),this.isExampleTag=!1):(this.recTags=this.exampleTags.map(t=>t.name),this.isExampleTag=!0)},enterLabelFn(t,{inputValue:e}){t.length>=5&&e?this.tagTips="标签个数已满足5个":this.tagTips=""},listenInputFn(t,e){("input"===e.trigger||t)&&this.$store.dispatch("q/fetchInputRecTags",{tag:t}).then(t=>{this.canChooseOption=t.map(t=>({label:t,value:t}))}).catch(()=>{console.log("error")})},changeLabelFn(t,e){if(t.length>=5)this.tagTips="标签个数已满足5个";else{const i=t.some((e,i)=>t.indexOf(e)!==i);i&&(this.tagTips="存在相同的标签名");t.find(t=>t.length>this.tagContentLen?(this.tagTips=`标签内容字符数不能超过${this.tagContentLen}个`,!0):""===t.trim()&&(this.tagTips="标签内容字符不能是空字符",!0))||i||(this.tagTips="",this.onTagChange(t,e))}},initTitleConfig(){this.randomResId=Math.random().toString(36).substring(2),this.$store.dispatch("q/fetchUserTitleRecommendList",{title:this.realTitle,resId:this.randomResId}).then(t=>{t.resId===this.randomResId&&(this.recList=t.possibleQuestions,this.renderForceTips(t.relatedInformations),this.initTagList(t.recommendedTags||[]))}).catch(()=>{this.recList=[],this.renderForceTips([]),this.initTagList([])})},renderForceTips(t){const e=t.map(t=>{const e=t.tag_content.replace(/\[\[(.+?)\]\]/gi,(function(t,e){return`<a target="_blank" href="${"wxwork://message/?username="+encodeURIComponent(e)}">${e}</a>`}));return{...t,tag_content:e}});this.qLeadWordList=e.slice(0,3),this.relatedInformations=e.filter(t=>"1"===t.is_force_alert||1===t.is_force_alert).slice(0,3)},focusTitleFn(){this.isFocusTitle=!0,this.needCheckTitle=!0},blurTitleFn(t){this.isFocusTitle=!1,this.needCheckTitle=!0,this.checkQTitle(t,!1)},changeTitleFn(t){this.checkQTitle(t,!0),this.isEmptyTitle&&(this.recList=[],this.initTagList([])),this.isEmptyTitle||this.overSizeTitle||this.noTitleMark||this.initTitleConfig()},checkQTitle(t,e){const i=t.trim();this.realTitle=i;const a=t.length;this.isEmptyTitle=0===i.length,this.overSizeTitle=this.maxTitleLen<a,e?this.noTitleMark=!1:-1===i.indexOf("?")&&-1===i.indexOf("？")?this.noTitleMark=!0:this.noTitleMark=!1}}},R=i(68),N=Object(R.a)(F,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"create-q-section"},[i("km-breadcrumb",{staticClass:"q-title-block",attrs:{options:[{content:"乐问",href:"/q"},{content:"add"===t.pageType?"提问":"编辑"}]}}),t._v(" "),"add"===t.pageType||"edit"===t.pageType&&t.qDetailData.id?i("div",{staticClass:"core-content"},[i("div",{staticClass:"q-content-area form-item"},["add"===t.pageType&&t.suddenQuestions.length>0?i("div",{staticClass:"emergency-wrapper"},[i("p",[t._v("\n          突发热点事件，请勿重复提问 :\n          "),i("a",{attrs:{target:"_blank",href:"/q/view/"+t.suddenQuestions[0].question_id}},[t._v("\n            "+t._s(t.suddenQuestions[0].title)+"\n          ")])])]):t._e(),t._v(" "),i("div",{staticClass:"input-wrapper label-content",class:[t.isEmptyTitle||t.overSizeTitle||t.noTitleMark?"err-input":""]},[i("span",{class:["default-limit",t.qtitle.length-t.maxTitleLen>0?"err-limit":""]},[t._v("\n          "+t._s(t.maxTitleLen-t.qtitle.length)+"\n        ")]),t._v(" "),i("t-textarea",{attrs:{placeholder:t.isFocusTitle?"":"请输入问题标题",autosize:{minRows:1,maxRows:3}},on:{focus:t.focusTitleFn,blur:t.blurTitleFn,change:t.changeTitleFn,keydown:t.keydownTitleFn},model:{value:t.qtitle,callback:function(e){t.qtitle=e},expression:"qtitle"}})],1),t._v(" "),i("p",{staticClass:"input-tips"},[t._v("\n        提问应遵循客观、友善、简洁、明确的原则，结尾记得加“？”\n      ")]),t._v(" "),t.needCheckTitle?i("p",{staticClass:"error-tips"},[t._v("\n        "+t._s(t.isEmptyTitle?"问题不能为空！":t.overSizeTitle?"问题不能超过70个字！":t.noTitleMark?"乐问为问答社区，请使用疑问句，并在标题中添加问号“？”":"")+"\n      ")]):t._e(),t._v(" "),t.qLeadWordList.length>0?i("div",{class:["q-lead-area",t.qLeadWordList.length>1?"need-line":""]},t._l(t.qLeadWordList,(function(e,a){return i("div",{key:a,staticClass:"q-lead-item"},[i("div",{domProps:{innerHTML:t._s(e.tag_content)}})])})),0):t._e(),t._v(" "),t.recList.length>0?i("div",{staticClass:"recommend-q-container"},[i("div",{staticClass:"tips-title"},[i("span",{staticClass:"left-text"},[t._v("你是不是想问以下问题？")]),t._v(" "),i("p",{staticClass:"right-text"},[i("span",[t._v("建议先查看相似问题，避免重复提问")]),t._v(" "),i("span",{staticClass:"close-icon",on:{click:t.closeRecFn}},[i("svg-icon",{attrs:{name:"q/close_rec",width:20,height:20}})],1)])]),t._v(" "),i("ul",t._l(t.recList,(function(e,a){return i("li",{key:a},[i("a",{staticClass:"rec-q-title",attrs:{href:"/q/view/"+e.id+"?kmref=ask_recommend",title:e.textTitle,target:"_blank"},domProps:{innerHTML:t._s(e.title)}}),t._v(" "),i("span",{staticClass:"answer-count"},[t._v("（"+t._s(e.reply_count)+"个回答"+t._s(e.has_right_answer?", 已有置顶回答":"")+"）")])])})),0)]):t._e(),t._v(" "),i("div",{staticClass:"des-container"},[i("div",{staticClass:"create-q-trilobite-wrapper"},[i("trilobiteEditorMod",{ref:"trilobiteRef",attrs:{"editor-type":"add","img-block-id":10,"business-type":"input-business-type-question"}},[i("p",[t._v("no editor")])])],1),t._v(" "),i("p",{staticClass:"template-select"},[t._v("\n          产品反馈类请\n          "),i("span",{staticClass:"default-template",on:{click:t.clickModel}},[t._v("使用模版")])])])]),t._v(" "),i("div",{staticClass:"q-att-area form-item"},[i("div",{staticClass:"label-container"},[t._m(0),t._v(" "),i("div",{staticClass:"t-wrapper"},[i("t-select-input",{attrs:{placeholder:"输入标签后按enter回车键确认，不超过5个","tag-input-props":{max:t.limitTagLen},"input-value":t.selectInputValue,"allow-input":!0,multiple:!0,status:t.tagStatus,tips:t.tagTips,"popup-props":{overlayClassName:t.tagTips?"has-error-tips-show":"",overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}}},on:{"update:inputValue":function(e){t.selectInputValue=e},"update:input-value":function(e){t.selectInputValue=e},"tag-change":t.changeLabelFn,"input-change":t.listenInputFn,blur:t.handleBlur},scopedSlots:t._u([{key:"panel",fn:function(){return[t.canChooseOption.length?i("t-checkbox-group",{staticClass:"tdesign-demo__panel-options-multiple",attrs:{value:t.checkboxValue,options:t.canChooseOption},on:{change:t.onCheckedChange}}):t._e()]},proxy:!0}],null,!1,3957523937),model:{value:t.qTags,callback:function(e){t.qTags=e},expression:"qTags"}}),t._v(" "),i("div",{staticClass:"rec-tag-area",class:[t.tagTips?"has-tag-tips":""]},[i("div",{staticClass:"rec-tag-wrapper"},[i("p",{staticClass:"rec-tag-title"},[t._v("\n                "+t._s(t.isExampleTag?"示例标签":"推荐标签")+"\n              ")]),t._v(" "),i("ul",t._l(t.recTags,(function(e,a){return i("li",{key:a,class:["default-item",t.qTags.includes(e)?"selected-item":""],on:{click:function(i){return t.selectTagFn(e)}}},[i("span",[t._v(t._s(e))])])})),0)])])],1)]),t._v(" "),i("div",{staticClass:"q-topic-area"},[i("div",{staticClass:"label-container"},[t._m(1),t._v(" "),i("div",{staticClass:"t-wrapper"},[t.currentTopic?i("div",[i("div",{staticClass:"topic-container"},[i("a",{staticClass:"selected-topic",attrs:{href:"/q/talk/"+t.currentTopic.id,target:"_blank"}},[i("span",[t._v("#"+t._s(t.currentTopic.title)+"#")])]),t._v(" "),i("span",{staticClass:"delete-topic",on:{click:function(e){return t.operateTopicFn("delete")}}},[i("svg-icon",{attrs:{name:"q/delete_topic",width:16,height:16}})],1)])]):i("div",{staticClass:"add-topic-btn",on:{click:t.addTopicFn}},[i("svg-icon",{staticClass:"add-icon",attrs:{name:"q/add_topic",width:16,height:16}}),t._v(" "),i("span",{staticClass:"btn-title"},[t._v("添加话题")])],1),t._v(" "),i("div",{staticClass:"rule-list"},[i("div",{staticClass:"rule-item"},[i("span",{on:{click:function(e){t.selectPact=!t.selectPact}}},[t.selectPact?i("svg-icon",{staticClass:"select-icon",attrs:{name:"q/select_rule",width:24,height:24}}):i("svg-icon",{staticClass:"select-icon",attrs:{name:"q/no_select_rule",width:24,height:24}})],1),t._v(" "),t._m(2)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.selectPact,expression:"!selectPact"}],staticClass:"rule-item"},[i("p",{staticClass:"tips"},[t._v("\n                  "+t._s(t.pactTipes)+"\n                ")])]),t._v(" "),i("div",{staticClass:"rule-item bottom-item"},[i("span",{on:{click:t.operateAnonymityFn}},[t.selectAnonymity?i("svg-icon",{staticClass:"select-icon",attrs:{name:"q/select_rule",width:24,height:24}}):i("svg-icon",{staticClass:"select-icon",attrs:{name:"q/no_select_rule",width:24,height:24}})],1),t._v(" "),t._m(3)])]),t._v(" "),i("div",{staticClass:"submit-area"},[i("div",{staticClass:"submit-active btn-item",on:{click:t.preSubmitQuestion}},[i("span",[t._v("提交")])]),t._v(" "),i("div",{staticClass:"cancel-btn btn-item",on:{click:t.cancelCreate}},[i("span",[t._v("取消")])])])])])])])]):t._e(),t._v(" "),i("t-dialog",{attrs:{theme:"info",header:"温馨提醒",body:t.submitTips,visible:t.visibleSubmit,"cancel-btn":null},on:{"update:visible":function(e){t.visibleSubmit=e},close:function(e){t.visibleSubmit=!1},confirm:function(e){t.visibleSubmit=!1}}}),t._v(" "),i("t-dialog",{attrs:{theme:"info",header:"温馨提醒",body:t.modelTips,visible:t.visibleModel},on:{"update:visible":function(e){t.visibleModel=e},cancel:function(e){t.visibleModel=!1},confirm:t.confirmSelectModel}}),t._v(" "),i("t-dialog",{attrs:{theme:"info",header:"温馨提示",visible:t.visibleInfo,"confirm-btn":"我要实名","cancel-btn":"继续匿名"},on:{"update:visible":function(e){t.visibleInfo=e},cancel:t.continueAnony,confirm:t.selectRealName}},[i("div",{attrs:{slot:"body"},slot:"body"},[i("p",[t._v(t._s(t.currentQTypeTips))])])]),t._v(" "),i("t-dialog",{attrs:{theme:"info",header:"温馨提示",visible:t.visibleNoAnony},on:{"update:visible":function(e){t.visibleNoAnony=e},cancel:function(e){t.visibleNoAnony=!1},confirm:function(e){return t.confirmAnony()}}},[i("div",{attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"q-type-anony-content"},[i("p",[t._v("\n          每周仅一次匿名提问机会，请合理使用。\n          匿名也请遵守"),i("a",{attrs:{href:"/themes/10000",target:"_blank"}},[t._v("《乐问公约》")]),t._v("，真诚友善提问！\n        ")])])])]),t._v(" "),"add"===t.pageType&&t.relatedInformations.length>0&&t.isFirstStrongTip?i("t-dialog",{attrs:{theme:"info",header:"温馨提醒",visible:t.visibleDom,"cancel-btn":null},on:{"update:visible":function(e){t.visibleDom=e},confirm:function(e){t.visibleDom=!1}}},[i("div",{attrs:{slot:"body"},slot:"body"},t._l(t.relatedInformations,(function(e,a){return i("div",{key:a,staticClass:"tips-item"},[i("div",{domProps:{innerHTML:t._s(e.tag_content)}})])})),0)]):t._e(),t._v(" "),i("t-dialog",{attrs:{header:"添加话题",width:"600px",visible:t.showTopicDialog,footer:!1},on:{"update:visible":function(e){t.showTopicDialog=e}}},[i("div",{attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"topic-list"},[i("ul",t._l(t.usableTopicList,(function(e,a){return i("li",{key:a,on:{click:function(i){return t.operateTopicFn("add",e)}}},[i("span",{staticClass:"topic-name"},[t._v("#"+t._s(e.title)+"#")]),t._v(" "),i("span",{staticClass:"read-count"},[t._v(t._s(e.read_count)+"次浏览")])])})),0),t._v(" "),i("div",{staticClass:"pagination-bottom"},[i("div",{class:["btn-item",t.topicPage>1?"active-item":""],on:{click:function(e){return t.loadPrePage()}}},[i("span",[t._v("上一页")])]),t._v(" "),i("div",{class:["btn-item",t.isTopicPageEnd?"":"active-item"],on:{click:function(e){return t.loadPage()}}},[i("span",[t._v("下一页")])])])])])]),t._v(" "),i("t-dialog",{attrs:{visible:t.showQTypeDialog,"confirm-btn":"下一步","cancel-btn":"取消",footer:!1},on:{"update:visible":function(e){t.showQTypeDialog=e}}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"self-dialog-header"},[i("span",{staticClass:"dialog-star-icon"},[t._v("*")]),t._v(" "),i("span",[t._v("我的问题属于")])])]),t._v(" "),i("div",{attrs:{slot:"body"},slot:"body"},[i("div",{staticClass:"q-type-list"},[i("t-radio-group",{attrs:{options:t.usableQTypeList},model:{value:t.currentQType,callback:function(e){t.currentQType=e},expression:"currentQType"}}),t._v(" "),i("div",{staticClass:"btn-list"},[i("div",{staticClass:"btn-item cancel-btn",on:{click:t.closeQType}},[i("span",[t._v("取消")])]),t._v(" "),i("div",{class:["btn-item",t.currentQType>-1?"confirm-btn":"no-btn"],on:{click:t.confirmQType}},[i("span",[t._v("下一步")])])])],1)])])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"label-name tag-label-name"},[e("span",{staticClass:"highlight-star"},[this._v("*")]),e("span",[this._v("标签")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"label-name topic-label-name"},[e("span",[this._v("话题")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pact-des"},[e("p",{staticClass:"pact-name"},[this._v("\n                    我已阅读"),e("a",{staticClass:"pact-link",attrs:{target:"_blank",href:"/themes/10000"}},[this._v("《乐问公约》")]),this._v("\n                    ，自愿遵守相关约定\n                    "),e("span",[this._v("（违反约定乐问平台会相应处理）")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pact-des"},[e("p",{staticClass:"pact-name"},[this._v("\n                    本问题无法实名，我需要匿名提问\n                  ")])])}],!1,null,null,null);e.a=N.exports},2095:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=i(2081),o=i.n(n),r=i(2016),l=i(2015),c=i(2009),d=i(57),u=i(2010),p=i(2073),h=i(2066),m=i(2102),v=i(2020),g=i(2063),f=i(2074);const _=({emit:t,props:e,containerRef:i,mainRef:a,videoWraperRef:s})=>{const n=e.minScreen,o=e.maxScreen,r=o-n,l=e.minVideo,c=e.maxVideo,d=c-l,u=()=>{var u;e.isCanResize?(()=>{const t=document.body.offsetWidth;t<=n&&(i.value.style.width=l+"px"),t>n&&t<o&&(i.value.style.width=l+(t-n)/r*d+"px"),t>=o&&(i.value.style.width=c+"px")})():i.value.style.width=l+"px";const p=(null==a||null===(u=a.value)||void 0===u?void 0:u.offsetWidth)*(9/16);s.value.style.height=p+"px",t("sizeWidthChange",i.value.style.width)};return{setVideoSize:u,resizeHandle:()=>{window.addEventListener("resize",u)},cancelResize:()=>{window.removeEventListener("resize",u)}}},b=(t,e,i=1e3)=>{const a=new function(t){let e,a,s=0,n=!1;this.start=function(){n=!1,e=Date.now(),a=setInterval(t,i)},this.stop=function(){clearInterval(a),n||(n=!0,s+=Date.now()-e||0,console.log("duration",s))},this.clean=function(){s=0},this.getDuration=function(){return s}}((function(){})),s=()=>{console.log("视频播放"),a.start()},n=()=>{console.log("视频已暂停"),a.stop()};t&&(t.addEventListener("play",s),t.addEventListener("pause",n));return window.onbeforeunload=function(){e(),t.removeEventListener(s),t.removeEventListener(n)},a};var y=i(2054),w=i.n(y),C=i(2055),k=i.n(C),O={name:"VideoPresent",components:{Comment:g.a,ShareModal:h.a,RecommendModal:m.a,SmallOperationBar:p.a,ElDropdown:s.Dropdown,ElDropdownItem:s.DropdownItem,ElDropdownMenu:s.DropdownMenu,ErrorShow:v.a,relationEntryMod:f.a,kmBreadcrumb:u.a},beforeRouteUpdate(t,e,i){const{traceVideoLeave:a}=this;a(),i()},props:{groupId:{type:String,default:""},videoId:{type:String,default:""},isShowBreadcrumb:{type:Boolean,default:!0},isCanResize:{type:Boolean,default:!0},minScreen:{type:Number,default:1440},maxScreen:{type:Number,default:2560},minVideo:{type:Number,default:1100},maxVideo:{type:Number,default:1630},showComment:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!0}},setup(t,{root:e,emit:i}){const s=Object(a.r)(),n=Object(a.r)(),u=Object(a.r)(),p=Object(a.r)(),h=Object(a.r)(!0),m=Object(a.r)(!0),v=Object(a.r)(!0),g=Object(a.r)(!1),f=Object(a.r)(""),y=Object(a.r)("success"),C=Object(a.r)(""),O=Object(a.r)(!1),x=Object(a.r)({}),j=Object(a.r)([]),I=Object(a.r)(""),T=Object(a.r)([]),S=Object(a.r)([]),D=Object(a.r)([]),q=Object(a.r)(!1),E=Object(a.r)({});let A="",M=null,$=null;const L=Object(a.a)(()=>t.groupId),P=Object(a.a)(()=>e.$store.getters["global/userToken"]),F=Object(a.r)(w.a),R=Object(a.r)(k.a),{setVideoSize:N,resizeHandle:B,cancelResize:U}=_({emit:i,props:t,containerRef:s,mainRef:n,videoWraperRef:u}),{isShowShareModal:H,woaLinkUrl:V,tencentLinkUrl:z}=(t=>{const e=Object(a.r)(!1),i=Object(a.a)(()=>`${window.location.origin}/videos/show/${t.value.id}`),s=Object(a.a)(()=>i.value.replace("woa","tencent").replace("videos/show","pkm/videos"));return{isShowShareModal:e,woaLinkUrl:i,tencentLinkUrl:s}})(x),{barOptions:G,viewItem:K,commentItem:W,favoriteItem:Q,isDigged:J,isFavored:Y,diggCount:X,favorCount:Z,commentCount:tt,onDigg:et,onFavor:it}=(({video:t,isShowShareModal:e,userToken:i})=>{const s={key:"view",value:0,iconName:"videos/play",noHover:!0},n={key:"comment",value:0,iconName:"operation/comment-gray",onClick:()=>{b()}},o={key:"favorite",value:0,iconName:"operation/favorite",onClick:()=>{_()}},r={key:"share",value:"分享",iconName:"operation/share",onClick:()=>{f()}},l=Object(a.r)([s,n,o,r]),d=Object(a.r)(!1),u=Object(a.r)(!1),p=Object(a.r)(0),h=Object(a.r)(0),m=Object(a.r)(0);let v=0,g=!1;const f=()=>{e.value=!0},_=()=>{const e={target_id:t.value.id};(u.value?c.d:c.c)(e,i.value).then(({data:t})=>{0===(null==t?void 0:t.code)&&(o.value=null==t?void 0:t.data.bookmark_count,h.value=null==t?void 0:t.data.bookmark_count,o.iconName=u.value?"operation/favorite":"operation/favorite-active",u.value=!u.value,l.value=[...l.value])})},b=()=>{if(g)window.scrollTo({top:v});else{v=window.scrollY;const t=document.querySelector(".comment-header");null==t||t.scrollIntoView()}g=!g};return{isShowShareModal:e,barOptions:l,isDigged:d,isFavored:u,viewItem:s,commentItem:n,favoriteItem:o,diggCount:p,favorCount:h,commentCount:m,onDigg:()=>{(d.value?c.b:c.g)({target_id:t.value.id},i.value).then(({data:t})=>{var e;0===(null==t?void 0:t.code)&&(p.value=null==t||null===(e=t.data)||void 0===e?void 0:e.digg_count,d.value=!d.value)})},onFavor:_,onToComment:b}})({video:x,isShowShareModal:H,userToken:P}),{actionData:at,fetchAcions:st}=(()=>{const t=Object(a.r)(!1),e=Object(a.r)(!1),i=Object(a.r)({});return{isAdmin:t,isKbarAdmin:e,actionData:i,fetchAcions:(a,s)=>Object(c.t)({currentGroupId:a,videoId:s}).then(({data:a})=>{var s;const n=(null==a||null===(s=a.data)||void 0===s?void 0:s.actions)||{};i.value=n,t.value=null==n?void 0:n.is_admin,e.value=!(null==n||!n.top)||!(null==n||!n.essential)})}})(),{videoTags:nt,fetchRelateEntry:ot}=(({root:t})=>({videoTags:Object(a.r)([]),fetchRelateEntry:e=>{t.$store.dispatch("q/fetchRecommendTags",{kstrs:e.join(" ")})}}))({root:e}),rt=()=>{st(L.value,t.videoId).then(()=>{var t,e,i,a,s,n,o,r,l,c,d,u,p,h,m;J.value=(null==at||null===(t=at.value)||void 0===t||null===(e=t.digg)||void 0===e?void 0:e.is_digged)||!1,X.value=(null==at||null===(i=at.value)||void 0===i||null===(a=i.digg)||void 0===a?void 0:a.digg_count)||0,W.value=null===(s=at.value)||void 0===s?void 0:s.comment.reply_count,tt.value=null===(n=at.value)||void 0===n||null===(o=n.comment)||void 0===o?void 0:o.reply_count,Y.value=(null==at||null===(r=at.value)||void 0===r||null===(l=r.favor)||void 0===l?void 0:l.is_bookmarked)||!1,Z.value=(null==at||null===(c=at.value)||void 0===c||null===(d=c.favor)||void 0===d?void 0:d.bookmark_count)||0,Q.value=(null==at||null===(u=at.value)||void 0===u||null===(p=u.favor)||void 0===p?void 0:p.bookmark_count)||0,Q.iconName=Y.value?"operation/favorite-active":"operation/favorite",q.value=!(null==at||null===(h=at.value)||void 0===h||null===(m=h.edit)||void 0===m||!m.edit_url),G.value=[...G.value]})},lt=()=>{Object(c.w)(t.videoId).then(({data:i})=>{if(0===(null==i?void 0:i.code)){var a,s,n,o,r,l,u,p,h,_,b,y,w,C,k,O,q,M;const g=null==i||null===(a=i.data)||void 0===a?void 0:a.video;x.value=g,K.value=null===(s=x.value)||void 0===s?void 0:s.read_count,W.value=null===(n=x.value)||void 0===n?void 0:n.reply_count,tt.value=null===(o=x.value)||void 0===o?void 0:o.reply_count,A=null===(r=x.value)||void 0===r?void 0:r.id;(t=>{t&&"0"!==t?Object(c.u)(t).then(({data:t})=>{var e,i,a,s;const n=(null==t||null===(e=t.data)||void 0===e||null===(i=e.playlist)||void 0===i?void 0:i.playlist_videos)||[];I.value=null==t||null===(a=t.data)||void 0===a||null===(s=a.playlist)||void 0===s?void 0:s.group_id,j.value=n.filter(t=>!!t.video)}):j.value=[]})((null==g||null===(l=g.playlist_videos)||void 0===l||null===(u=l[0])||void 0===u?void 0:u.playlist_id)||"");const f=null===(p=x.value)||void 0===p?void 0:p.group_id;((t,e)=>{const i=""+e!="0"?e:null;Object(c.r)(t,i).then(({data:t})=>{if(0===t.code){var e;const i=(null==t||null===(e=t.data)||void 0===e?void 0:e.videos)||[];S.value=i}m.value=!1})})(A,f);const P=g.taggings.map(t=>{var e;return null==t||null===(e=t.tag)||void 0===e?void 0:e.name});T.value=g.taggings.map(t=>null==t?void 0:t.tag),nt.value=P,ot(P),E.value=(null==x?void 0:x.value.post)||{};const F="Post"===(null===(h=x.value)||void 0===h?void 0:h.attachable_type),R=(null===(_=E.value)||void 0===_?void 0:_.video_count)>1;F&&R&&($=null===(b=x.value)||void 0===b?void 0:b.attachable_id,Object(c.i)($,L).then(({data:t})=>{if(0===t.code){var e;const i=(null==t||null===(e=t.data)||void 0===e?void 0:e.videos)||[];D.value=i}v.value=!1})),e.$store.commit("video/SET_CURRENT_VIDEO_TITLE",null===(y=x.value)||void 0===y?void 0:y.title),e.$store.commit("video/SET_CURRENT_VIDEO_ID",null===(w=x.value)||void 0===w?void 0:w.id),e.$store.commit("kbar/setGroupId",{groupId:null===(C=x.value)||void 0===C?void 0:C.group_id}),Object(d.b)("videoPageView",{video_id:t.videoId,video_name:null===(k=x.value)||void 0===k?void 0:k.title,post_id:(null===(O=x.value)||void 0===O||null===(q=O.post)||void 0===q?void 0:q.id)||"",group_id:null===(M=x.value)||void 0===M?void 0:M.group_id})}else E.value={},g.value=!0,f.value=null==i?void 0:i.message;var $,L}).catch(()=>{g.value=!0}).finally(()=>{h.value=!1}),rt()};lt();const ct=t=>{if(y.value=t.status,C.value=t.errMsg,"error"!==t.status)if(M){const e={appID:t.ops.appID,fileID:t.ops.fileID,psign:t.ops.psign};M.ready(()=>{var t;null===(t=M)||void 0===t||t.loadVideoByID(e),ut()})}else M=o()(t.playHandleId,t.ops),window.presentPlayer=M},dt=e=>{var i;$.stop();const a=$.getDuration()/1e3;Object(d.b)("videoPageLeave",{video_id:e||t.videoId,video_name:x.value.title,post_id:(null===(i=x.value.post)||void 0===i?void 0:i.id)||"",group_id:x.value.group_id,content_play_duration:a}),$.clean()},ut=()=>{var e;null===(e=M)||void 0===e||e.one("play",()=>{var e,i,a;Object(d.b)("videoDetailPlay",{video_id:t.videoId,video_name:x.value.title,post_id:(null===(e=x.value.post)||void 0===e?void 0:e.id)||"",post_name:(null===(i=x.value)||void 0===i||null===(a=i.post)||void 0===a?void 0:a.title)||"",group_id:x.value.group_id})})};Object(a.m)(()=>{var e,i,a,s;Object(r.b)(t.videoId).then(t=>{var e;null===(e=window.presentPlayer)||void 0===e||e.dispose(),ct(t)}),N(),t.isCanResize&&B(),$=b(p.value,dt),Object(d.b)("groupPageView",{group_id:""+t.groupId,group_page_type:"videos"}),Object(d.c)("videoDetailPlayTime",{video_id:e||t.videoId,video_name:x.value.title,post_id:(null===(i=x.value.post)||void 0===i?void 0:i.id)||"",post_name:(null===(a=x.value)||void 0===a||null===(s=a.post)||void 0===s?void 0:s.title)||"",group_id:x.value.group_id},()=>{var t;return{content_play_duration:null===(t=M)||void 0===t?void 0:t.currentTime()}})}),Object(a.u)(()=>t.videoId,e=>{var i,a;e&&((null===(i=M)||void 0===i?void 0:i.pause)&&M.pause(),(null===(a=M)||void 0===a?void 0:a.poster)&&M.poster("none"),dt(A),(e=>{var i,a,s,n;const o=null===(i=M)||void 0===i?void 0:i.currentTime();Object(d.b)("videoDetailPlayTime",{video_id:e||t.videoId,video_name:x.value.title,post_id:(null===(a=x.value.post)||void 0===a?void 0:a.id)||"",post_name:(null===(s=x.value)||void 0===s||null===(n=s.post)||void 0===n?void 0:n.title)||"",group_id:x.value.group_id,content_play_duration:o})})(A),lt(),Object(r.b)(e).then(t=>ct(t)),Object(d.b)("groupPageView",{group_id:""+t.groupId,group_page_type:"videos"}))}),Object(a.u)(()=>t.isCanResize,(t,e)=>{!t&&e&&(N(),U()),t&&!e&&(N(),B())});return{containerRef:s,mainRef:n,videoWraperRef:u,videoRef:p,defaultCover:F,defaultPlayListCover:R,video:x,playList:j,videoTags:nt,videoLabels:T,recommendList:S,relatedList:D,videoPost:E,playListGroupId:I,isVideoDataLoading:h,isRecommendLoading:m,isRelatedLoading:v,isDataError:g,dataErrorText:f,videoStatus:y,videoErrorText:C,barOptions:G,actionData:at,isDigged:J,isFavored:Y,diggCount:X,favorCount:Z,commentCount:tt,onDigg:et,onFavor:it,isShowShareModal:H,woaLinkUrl:V,tencentLinkUrl:z,haveEditPermission:q,jumpVideo:(t,i,a)=>{const s=`${i&&"0"!==i?"/group/"+i:""}/videos/show/${t}?kmref=${a}`;A!==""+t&&e.$router.push(s,()=>{window.history.replaceState({},"",s)})},jumpEditPage:()=>{const e=t.groupId?`${location.origin}/group/${t.groupId}/videos/edit/${t.videoId}`:`${location.origin}/videos/edit/${t.videoId}`;window.open(e)},jumpArticle:t=>{window.open("/articles/show/"+t)},handleDelete:()=>{const i=t.groupId?`group/${t.groupId}/`:"";e.$newConfirm("warning","你确定要删除该视频吗？",{confirm:()=>{Object(c.f)(t.videoId).then(({data:t})=>{0===t.code&&(location.href=`/${i}videos`)})},confirmText:"删除"})},isShowRecommendModal:O,openRecommendModal:()=>{var t;"1"!==(null===(t=x.value)||void 0===t?void 0:t.is_recommended)&&(O.value=!0)},onRecommendModalSubmit:i=>{Object(c.z)({videoId:t.videoId,userToken:P.value,pushClans:i}).then(({data:t})=>{Object(l.a)(e)(t)}),O.value=!1},onRecommendModalClose:()=>{O.value=!1},getOperationData:rt,traceVideoLeave:dt}}},x=i(68),j=Object(x.a)(O,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"containerRef",staticClass:"video-present-container"},[t.isShowBreadcrumb?i("km-breadcrumb",{staticClass:"global-video-header",attrs:{options:[{content:"视频",href:"/videos"},{content:"视频详情"}]}}):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDataError,expression:"!isDataError"}],staticClass:"video-present-wrapper"},[i("div",{ref:"mainRef",staticClass:"video-main"},[i("div",{staticClass:"video-block-container"},[i("div",{staticClass:"video-info-container"},[i("div",{staticClass:"video-title"},[i("span",{staticClass:"title-text"},[t._v(t._s(t.video.title))]),t._v(" "),i("span",{staticClass:"tag-list"},["1"===t.video.is_recommended?i("svg-icon",{staticClass:"recommend-tag",attrs:{name:"knowledges/recommend-tag",width:28,height:28}}):t._e()],1)]),t._v(" "),i("div",{staticClass:"video-info-list"},[i("div",{staticClass:"info-left"},[i("a",{staticClass:"avatar-img-container",attrs:{href:"/user/"+t.video.created_by,target:"_blank"}},[i("img",{staticClass:"avatar-img",attrs:{src:"/asset/avatar/"+t.video.created_by}}),t._v(" "),i("span",{staticClass:"video-author"},[t._v(t._s(t.video.created_by))])]),t._v(" "),i("span",{staticClass:"create-time"},[t._v(t._s(t._f("timeFormatDetail")(t.video.created)))])]),t._v(" "),i("div",{staticClass:"info-right"},[i("small-operation-bar",{attrs:{"option-list":t.barOptions}},[t.haveEditPermission?i("el-dropdown",{staticClass:"operation-item item-hover"},[i("div",[i("svg-icon",{staticClass:"item-icon",attrs:{name:"operation/edit",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-value"},[t._v("设置")])],1),t._v(" "),i("el-dropdown-menu",{staticClass:"video-action-panel",attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",[i("span",{staticClass:"action-btn setting-item",on:{click:t.jumpEditPage}},[t._v("\n                        编辑\n                      ")])]),t._v(" "),i("el-dropdown-item",{attrs:{disabled:"1"===t.video.is_recommended}},[i("span",{staticClass:"action-btn setting-item",class:{"disable-item":"1"===t.video.is_recommended},on:{click:t.openRecommendModal}},[t._v("\n                        "+t._s("1"===t.video.is_recommended?"已推荐":"推荐")+"\n                      ")])]),t._v(" "),"Post"!==t.video.attachable_type?i("el-dropdown-item",[i("span",{staticClass:"action-btn setting-item",on:{click:t.handleDelete}},[t._v("\n                        删除\n                      ")])]):t._e()],1)],1):t._e()],1)],1)])]),t._v(" "),i("div",{ref:"videoWraperRef",staticClass:"video-player-wrapper",class:{"wide-video-player-wrapper":!1}},[i("div",{directives:[{name:"show",rawName:"v-show",value:"success"===t.videoStatus,expression:"videoStatus === 'success'"}],staticClass:"video-success-container"},[i("video",{ref:"videoRef",staticClass:"swan-video-container",attrs:{id:"swan-video-"+t.videoId}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"success"!==t.videoStatus,expression:"videoStatus !== 'success'"}],staticClass:"video-error-container"},[i("div",{staticClass:"video-err-text"},[t._v("\n              "+t._s(t.videoErrorText)+"\n            ")])])]),t._v(" "),i("div",{staticClass:"video-toolbar-container"},[i("div",{staticClass:"agree-button operate-button",class:{"digged-item":t.isDigged},on:{click:t.onDigg}},[i("svg-icon",{staticClass:"item-icon",attrs:{width:20,height:20,name:t.isDigged?"operation/big-digg-active":"operation/big-digg"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(t.diggCount>0?t.diggCount>999?"999+":t.diggCount:"点赞"))])],1),t._v(" "),i("div",{staticClass:"favor-button operate-button",class:{"favored-item":t.isFavored},on:{click:t.onFavor}},[i("svg-icon",{staticClass:"item-icon",attrs:{width:20,height:20,name:t.isFavored?"operation/big-favorite-active":"operation/big-favorite"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(t.favorCount>0?t.favorCount>999?"999+":t.favorCount:"收藏"))])],1)]),t._v(" "),i("div",{staticClass:"video-introduction"},[t._v("\n          "+t._s(t.video.description||"暂无描述～")+"\n        ")]),t._v(" "),t.videoLabels.length>0?i("div",{staticClass:"video-label-list"},[i("span",{staticClass:"label-text"},[t._v("标签：")]),t._v(" "),t._l(t.videoLabels,(function(e){return i("a",{key:e.id,staticClass:"label-item",attrs:{href:"/tags/view/"+e.id,target:"_blank"}},[t._v("\n            "+t._s(e.name)+"\n          ")])}))],2):t._e()]),t._v(" "),t.showComment&&"Post"!==t.video.attachable_type?i("div",{staticClass:"article-comment-container"},[i("comment",{attrs:{"has-auth":t.haveEditPermission,"target-id":String(t.videoId),"group-id":Number(t.groupId)||void 0,"reprint-group-id":void 0,"entity-info":{created_by:t.video.created_by},"target-type":"Video","comment-count":t.commentCount},on:{afterAddComment:t.getOperationData,afterDeleteComment:t.getOperationData}})],1):t._e(),t._v(" "),"Post"===t.video.attachable_type?i("div",{staticClass:"jump-to-comment"},[i("a",{staticClass:"jump-link",attrs:{target:"_blank",href:"/articles/show/"+t.video.attachable_id}},[t._v("去原文评论")])]):t._e()]),t._v(" "),i("div",{staticClass:"video-right",class:{"wide-video-right":!1}},["Post"===t.video.attachable_type?i("div",{staticClass:"from-article-block"},[i("div",{staticClass:"block-left"},[i("div",{staticClass:"left-title"},[t._v("\n            该视频来自KM文章\n          ")]),t._v(" "),i("div",{staticClass:"left-desc"},[t._v("\n            "+t._s(t.videoPost.title||t.video.title)+"\n          ")])]),t._v(" "),i("div",{staticClass:"block-right"},[i("div",{staticClass:"jump-article-btn",on:{click:function(e){return t.jumpArticle(t.video.attachable_id)}}},[t._v("\n            查看原文\n          ")])])]):t._e(),t._v(" "),t.playList.length>0?i("div",{staticClass:"playlist-block"},[i("div",{staticClass:"playlist-tltle"},[t._v("\n          合辑("+t._s(t.playList.length)+")\n        ")]),t._v(" "),i("div",{staticClass:"playlist-body"},t._l(t.playList,(function(e){return i("div",{key:e.id,staticClass:"playlist-item",class:{"active-playlist-item":e.video_id==t.videoId},on:{click:function(i){return t.jumpVideo(e.video.id,t.playListGroupId,"playlist")}}},[i("div",{staticClass:"playlist-item-left"},[i("img",{staticClass:"playlist-item-cover",attrs:{src:t._f("thumbnail")(e.video.pic||t.defaultPlayListCover,228)}})]),t._v(" "),i("div",{staticClass:"playlist-item-right"},[i("div",{staticClass:"info-title"},[t._v("\n                "+t._s(e.video.title)+"\n              ")]),t._v(" "),i("div",{staticClass:"info-content"},[i("span",{staticClass:"info-read-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/play",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.video.read_count))])],1),t._v(" "),i("span",{staticClass:"info-reply-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/agree",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.video.agree_count))])],1)])])])})),0)]):t._e(),t._v(" "),"Post"===t.video.attachable_type&&!t.isRelatedLoading&&t.relatedList.length>1?i("div",{staticClass:"related-block"},[i("div",{staticClass:"playlist-tltle"},[t._v("\n          相关视频\n        ")]),t._v(" "),i("div",{staticClass:"playlist-body"},t._l(t.relatedList,(function(e){return i("div",{key:e.id,staticClass:"playlist-item",class:{"active-playlist-item":e.id==t.videoId},on:{click:function(i){return t.jumpVideo(e.id,e.group_id,"related-list")}}},[i("div",{staticClass:"playlist-item-left"},[i("img",{staticClass:"playlist-item-cover",attrs:{src:t._f("thumbnail")(e.pic||t.defaultCover,228)}})]),t._v(" "),i("div",{staticClass:"playlist-item-right"},[i("div",{staticClass:"info-title"},[t._v("\n                "+t._s(e.title)+"\n              ")]),t._v(" "),i("div",{staticClass:"info-content"},[i("span",{staticClass:"info-read-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/play",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.read_count))])],1),t._v(" "),i("span",{staticClass:"info-reply-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/agree",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.agree_count))])],1)])])])})),0)]):t._e(),t._v(" "),i("div",{staticClass:"recommend-block"},[i("div",{staticClass:"playlist-tltle"},[t._v("\n          推荐视频\n        ")]),t._v(" "),i("div",{staticClass:"playlist-body"},[t._l(t.recommendList,(function(e){return i("div",{key:e.id,staticClass:"playlist-item",class:{"active-playlist-item":e.id==t.videoId},on:{click:function(i){return t.jumpVideo(e.id,e.group_id,"recommend-list")}}},[i("div",{staticClass:"playlist-item-left"},[i("img",{staticClass:"playlist-item-cover",attrs:{src:t._f("thumbnail")(e.pic||t.defaultCover,228)}})]),t._v(" "),i("div",{staticClass:"playlist-item-right"},[i("div",{staticClass:"info-title"},[t._v("\n                "+t._s(e.title)+"\n              ")]),t._v(" "),i("div",{staticClass:"info-content"},[i("span",{staticClass:"info-read-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/play",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.read_count))])],1),t._v(" "),i("span",{staticClass:"info-reply-count"},[i("svg-icon",{staticClass:"item-icon",attrs:{name:"videos/agree",width:16,height:16,viewBox:"0 0 16 16"}}),t._v(" "),i("span",{staticClass:"item-count"},[t._v(t._s(e.agree_count))])],1)])])])})),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isRecommendLoading&&0===t.recommendList.length,expression:"!isRecommendLoading && recommendList.length === 0"}],staticClass:"empty-list-text"},[t._v("\n            暂无推荐视频\n          ")])],2)]),t._v(" "),i("div",{staticClass:"entry-block"},[i("relation-entry-mod",{attrs:{tags:t.videoTags,"q-id-prop":t.videoId,"target-type":"video"}})],1)])]),t._v(" "),t.isDataError?i("error-show",{attrs:{"is-full":!1,height:740,"error-text":t.dataErrorText||"无权限或已删除"}}):t._e(),t._v(" "),i("share-modal",{attrs:{"is-new-share":!0,"is-show-modal":t.isShowShareModal,"copy-prefix-text":t.video.title,"target-id":t.video.id,"target-type":"Video","share-data":t.actionData.share_to,"woa-link-url":t.woaLinkUrl,"tencent-link-url":t.tencentLinkUrl},on:{onClose:function(e){t.isShowShareModal=!1},onSubmit:function(e){t.isShowShareModal=!1}}}),t._v(" "),i("recommend-modal",{attrs:{"is-show-modal":t.isShowRecommendModal},on:{onSubmit:t.onRecommendModalSubmit,onClose:t.onRecommendModalClose}})],1)}),[],!1,null,"32382f36",null);e.a=j.exports},2096:function(t,e,i){"use strict";var a=i(1938),s=i.n(a),n=(i(11),i(12),i(13),i(14),i(15),i(3)),o=i(7),r=Object(n.c)({name:"tree-selector-departments",components:{venomTree:s.a},props:{value:{type:String,default:"",required:!0},height:{type:Number,default:40},maxHeight:{type:Number,default:300},width:{type:Number,default:300},hasNoneOption:{type:Boolean,default:!0},noneOptionName:{type:String,default:"无"}},model:{prop:"value",event:"select"},setup(t,{emit:e}){const{hasNoneOption:i,noneOptionName:a}=Object(n.t)(t),s=Object(n.r)(),r=Object(n.r)([]),l=Object(n.r)(!1),c=Object(n.r)(""),d=(t,i)=>new Promise((a,s)=>{o.a.post("/base/dept_tree?root="+t).then(({data:t})=>{const s=(t||[]).map(t=>({id:t.id,name:t.text,hasChildren:t.hasChildren,children:[],parentName:i}));e("getTree",{treeData:s}),a(s)}).catch(t=>{console.error(t),e("getTreeError",{error:t}),s(t)})}),u=t=>{l.value&&!s.value.contains(t.target)&&(l.value=!1)};return(async()=>{try{const t=await d("source",""),e={id:"",name:a.value,hasChildren:!1,children:[],parentName:""};r.value=[...t],i.value&&r.value.unshift(e)}catch(t){console.error(t)}})(),Object(n.m)(()=>{document.body.addEventListener("click",u)}),Object(n.j)(()=>{document.body.removeEventListener("click",u)}),{selector:s,deptTree:r,isShowTree:l,selectedNode:c,loadData:t=>new Promise(async(e,i)=>{try{const i=await d(t.id,t.name+"/");t.children=i,e({isFinished:!0})}catch(t){console.error(t),i(t)}}),onClickSelector:()=>{l.value=!l.value},onClickNode:t=>{c.value=t,l.value=!1,e("select",t.id),e("selectNode",{node:t})},focusout:()=>{l.value=!1},changeSelectedName:t=>{c.value={name:t,parentName:""}}}}}),l=i(68),c=Object(l.a)(r,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"selector",staticClass:"dept-selector",style:{height:t.height+"px",width:t.width+"px"},attrs:{tabindex:"-1"},on:{click:t.onClickSelector,focusout:t.focusout}},[i("p",{staticClass:"selected-name"},[t._v("\n    "+t._s(t.selectedNode.name?""+t.selectedNode.parentName+t.selectedNode.name:"")+"\n  ")]),t._v(" "),i("span",{staticClass:"caret"}),t._v(" "),t.isShowTree?i("div",{staticClass:"dept-tree",style:{"max-height":t.maxHeight+"px"},on:{click:function(t){t.stopPropagation()}}},[i("venom-tree",{attrs:{"tree-data":t.deptTree,"load-data":t.loadData,checkable:!1},on:{click:t.onClickNode}})],1):t._e()])}),[],!1,null,"4a1ef95c",null);e.a=c.exports},2097:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2065),n=i(2049),o=Object(a.c)({name:"label-select",props:{labels:{type:Array,default:()=>[]},placeholder:{type:String,default:"请输入标签"},limit:{type:Number,default:5}},components:{ElSelect:s.b,ElOption:s.a},setup(t,e){const i=Object(a.r)([]),s=Object(a.r)([]);Object(a.u)(t,t=>{console.log("newValue",t.labels),i.value=t.labels});return{currentLabels:i,labelOptions:s,remoteMethod:t=>{t&&Object(n.d)(t).then(({data:t})=>{const e=((null==t?void 0:t.data.tags)||[]).map(t=>{var e,i;return{label:null==t||null===(e=t.tags)||void 0===e?void 0:e.name,value:null==t||null===(i=t.tags)||void 0===i?void 0:i.name}});s.value=e})},onLabelChange:t=>{const i=(t=>{const e={},i=[];return t.forEach(t=>{const a=null==t?void 0:t.toUpperCase();e[a]||(e[a]=!0,i.push(t))}),i})(t);s.value=[],e.emit("onChange",{labels:i})}}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{staticClass:"lable-select",attrs:{"popper-class":"label-popper-body",multiple:"",filterable:"","allow-create":"","default-first-option":"",remote:"","multiple-limit":t.limit,"remote-method":t.remoteMethod,placeholder:t.placeholder},on:{change:t.onLabelChange},model:{value:t.currentLabels,callback:function(e){t.currentLabels=e},expression:"currentLabels"}},t._l(t.labelOptions,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)}),[],!1,null,"8a83364e",null);e.a=l.exports},2098:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=Object(a.c)({props:{background:{type:String,default:"",required:!1},shadow:{type:String,default:"",required:!1}}}),n=i(68),o=Object(n.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-container",style:{background:this.background,boxShadow:this.shadow}},[e("div",{staticClass:"main"},[this._t("default")],2)])}),[],!1,null,"24bbef78",null);e.a=o.exports},2099:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(1999),n=i(2027),o=Object(a.c)({name:"EntryItem",components:{operateBlock:n.a},props:{info:{require:!1,type:Object,default:()=>{}},showDescription:{require:!1,type:Boolean,default:!1},showOperate:{require:!1,type:Boolean,default:!1},autoTags:{require:!1,type:Boolean,default:!1},height:{require:!1,type:Number,default:void 0},pageType:{require:!1,type:String,default:""}},setup(t,{root:e,emit:i}){const n=Object(a.r)(),o=Object(a.r)(),r=Object(a.r)(t.info.has_favorited),l=Object(a.a)(()=>e.$store.getters["entry/entryInfo"]),c=Object(a.a)(()=>l.value.id);Object(a.m)(()=>{}),Object(a.u)(()=>t.info,t=>{r.value=t.has_favorited});return{hiddenTagItemDOM:n,entryTagsDOM:o,entryId:c,isSubscribed:r,getTagsArray:e=>{if(!o.value)return;const i=o.value.offsetWidth;let a=0,s=0,r=0,l=1;const c=[];let d=!1;const u=t.autoTags&&t.showDescription&&!t.info.description,p=t=>{if(u&&l<2)return a=0,void(l+=1);n.value.innerText="+"+t,r=n.value.offsetWidth,i>a+r+10?(c.push({name:"+"+t,target_id:t}),d=!0):(a-=c.pop().width,p(t+1))};for(let t=0;t<e.length;t++){if(!n.value||d)return c;n.value.innerText=e[t].name,s=n.value.offsetWidth,i>=a+s+10?(a=a+s+(t?10:0),c.push({...e[t],width:s})):p(e.length-t)}return c},handleSubscribeEntry:async i=>{i.stopPropagation(),i.preventDefault();const{data:a}=await Object(s.o)({entry_id:t.info.target_id,block_type:"entry",target_type:"entry",reason:"favorite",action:r.value?"cancel_favorite":"favorite"});0!==a.code?e.$toast("订阅词条失败，请重试",{status:"error",positon:"center",singline:!1}):r.value=!r.value},afterClick:()=>{i("afterClick")},afterTop:()=>{i("afterTop")},afterRemove:()=>{i("afterRemove")}}}}),r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"entry-item-card-container",style:{height:t.height+"px"},attrs:{href:"/entry/"+t.info.target_id+"/home?kmref=km_entry",target:"_blank"},on:{click:t.afterClick}},[t.info.is_top?i("div",{staticClass:"tip-icon"},[t._v("置顶")]):t._e(),t._v(" "),i("div",{staticClass:"entry-title"},[t._v(t._s(t.info.name))]),t._v(" "),i("div",{ref:"entryTagsDOM",staticClass:"entry-tags"},t._l(t.getTagsArray(t.info.tags),(function(e,a){return i("div",{key:e.name+"-"+a,staticClass:"entry-tag-item"},[t._v("\n      "+t._s(e.name)+"\n    ")])})),0),t._v(" "),t.info.description&&t.showDescription?i("div",{staticClass:"entry-introduction"},[t._v(t._s(t.info.description))]):t._e(),t._v(" "),i("div",{staticClass:"entry-detail"},[t._v("\n    "+t._s(t.info.read_count)+" 浏览 · "+t._s(t.info.article_count)+" 文章 · "+t._s(t.info.question_count)+" 乐问\n  ")]),t._v(" "),t.showOperate?i("operate-block",{staticClass:"item-top-right",attrs:{"is-top":t.info.is_top,"target-type":"related_entries","target-id":t.info.target_id},on:{afterRemove:t.afterRemove,afterTop:t.afterTop}}):t._e(),t._v(" "),i("t-popup",{attrs:{content:t.isSubscribed?"已订阅":"订阅词条"}},["hub"===t.pageType?i("div",{staticClass:"subscribe-icon",on:{click:t.handleSubscribeEntry}},[i("svg-icon",{staticClass:"item-icon",attrs:{name:t.isSubscribed?"entry/subscribed":"entry/unsubscribed",width:20,height:20,viewBox:"0 0 20 20"}})],1):t._e()]),t._v(" "),i("div",{ref:"hiddenTagItemDOM",staticClass:"entry-tag-item-hidden"})],1)}),[],!1,null,"98e7c8dc",null);e.a=l.exports},2100:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a={name:"PactMod",components:{},mixins:[],props:{},data:()=>({rules:[{content:"真实：自己思考之后的真实疑惑，不为了提问而提问",type:0},{content:"客观：理性客观地陈述问题和事实，不偏激，不揣测",type:0},{content:"简洁：用简洁的文字提炼问题，不赘述；如需详细描述，请写在【添加问题描述】中",type:0},{content:" 明确：表意清晰、有针对性，避免使用网络用语， 如神马、尼玛、卧槽",type:0},{content:"乐问禁止此类的问题：违反国家法律内容、违反公司高压线、绩效考核申诉及薪资福利问题、寻人、广告灌水、主观臆断、引战等问题",type:1}]}),computed:{},watch:{},created(){},mounted(){},destroy(){},methods:{}},s=i(68),n=Object(s.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pact-container"},[t._m(0),t._v(" "),i("div",{staticClass:"pact-content"},[i("ul",t._l(t.rules,(function(e,a){return i("li",{key:a},[i("div",{staticClass:"circle-num"},[i("span",[t._v(t._s(a+1))])]),t._v(" "),i("p",{class:["content-item",1===e.type?"highlight-item":""]},[t._v("\n          "+t._s(e.content)+"\n        ")])])})),0)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pact-header"},[e("p",[this._v("乐问公约")])])}],!1,null,null,null);e.a=n.exports},2101:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=Object(a.c)({name:"big-operation-bar",components:{elPopover:s.Popover},props:{isDigged:{type:Boolean,default:!1},diggUserList:{type:Array,default:()=>[]},isFavored:{type:Boolean,default:!1},diggCount:{type:Number||String,default:0},favorCount:{type:Number||String,default:0},shareCount:{type:Number||String,default:0}},setup(t,e){const i=Object(a.r)(!1),s=Object(a.r)(!1),n=Object(a.r)(!1),o=Object(a.r)(""),r=Object(a.r)(!1),l=Object(a.r)("");return{isDiggedHover:i,isFavoredHover:s,isDigging:n,digGifUrl:o,isFavoring:r,favorGifUrl:l,onHoverDigg:()=>{i.value=!0},onOutDigg:()=>{i.value=!1},onHoverFavor:()=>{s.value=!0},onOutFavor:()=>{s.value=!1},onClickDigg:()=>{n.value||(t.isDigged||(n.value=!0,o.value="https://assets.km.tencent.com/ImageHosting/20230815/0c7ddd98b314bd787ded6411aa8d76f7.gif",setTimeout(()=>{n.value=!1,o.value=""},700)),e.emit("onDigg"))},onClickFavor:()=>{r.value||(t.isFavored||(r.value=!0,l.value="https://assets.km.tencent.com/ImageHosting/20230815/201f200de6029ff08332a0bed8f41ded.gif",setTimeout(()=>{r.value=!1,l.value=""},700)),e.emit("onFavor"))},onClickShare:()=>{e.emit("onShare")}}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-operation-list"},[i("div",{staticClass:"digg operation-item",class:t.isDigged?"digged-item":""},[t.diggUserList.length>0?i("el-popover",{attrs:{placement:"top",trigger:"hover"}},[i("div",{staticClass:"digg-list-popover"},[t._l(t.diggUserList,(function(e,a){return i("a",{key:e.created_by,staticClass:"digg-user-item",attrs:{target:"_blank",href:t._f("personalPage")(e.created_by,"")}},[i("span",{staticClass:"username"},[t._v(t._s(e.created_by))]),t._v(" "),0!==e.is_expert?i("span",{staticClass:"golden-img"}):t._e(),t._v(" "),a!==t.diggUserList.length-1?i("span",[t._v("、")]):t._e()])})),t._v("\n        最近顶过此文\n      ")],2),t._v(" "),i("div",{staticClass:"item-cicle",attrs:{slot:"reference"},on:{click:t.onClickDigg,mouseover:t.onHoverDigg,mouseout:t.onOutDigg},slot:"reference"},[i("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isDigging,expression:"!isDigging"}],staticClass:"item-icon",attrs:{width:28,height:28,name:t.isDigged?"operation/big-digg-active":"operation/big-digg"}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isDigging,expression:"isDigging"}],staticClass:"dig-gif",attrs:{src:t.digGifUrl,alt:""}})],1)]):i("div",{staticClass:"item-cicle",attrs:{slot:"reference"},on:{click:t.onClickDigg,mouseover:t.onHoverDigg,mouseout:t.onOutDigg},slot:"reference"},[i("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isDigging,expression:"!isDigging"}],staticClass:"item-icon",attrs:{width:28,height:28,name:t.isDigged?"operation/big-digg-active":"operation/big-digg"}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isDigging,expression:"isDigging"}],staticClass:"dig-gif",attrs:{src:t.digGifUrl,alt:""}})],1),t._v(" "),i("div",{staticClass:"item-count"},[t._v(t._s(t.isDigged?"已顶":"我顶")+" "+t._s(t.diggCount?t.diggCount:""))])],1),t._v(" "),i("div",{staticClass:"favor operation-item",class:t.isFavored?"favored-item":""},[i("div",{staticClass:"item-cicle",attrs:{slot:"reference"},on:{click:t.onClickFavor,mouseover:t.onHoverFavor,mouseout:t.onOutFavor},slot:"reference"},[i("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!t.isFavoring,expression:"!isFavoring"}],staticClass:"item-icon",attrs:{width:28,height:28,name:t.isFavored?"operation/big-favorite-active":"operation/big-favorite"}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.isFavoring,expression:"isFavoring"}],staticClass:"favor-gif",attrs:{src:t.favorGifUrl,alt:""}})],1),t._v(" "),i("div",{staticClass:"item-count"},[t._v(t._s(t.isFavored?"已收藏":"收藏")+" "+t._s(t.favorCount>0?t.favorCount:""))])]),t._v(" "),i("div",{staticClass:"share operation-item"},[i("div",{staticClass:"item-cicle",on:{click:t.onClickShare}},[i("svg-icon",{staticClass:"item-icon",attrs:{width:28,height:28,name:"operation/big-share"}})],1),t._v(" "),i("div",{staticClass:"item-count"},[t._v("分享 "+t._s(t.shareCount>0?t.shareCount:""))])])])}),[],!1,null,"7f5b5126",null);e.a=r.exports},2102:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(144),n=Object(a.c)({name:"recommend-modal",components:{Dialog:s.Dialog,CheckboxGroup:s.CheckboxGroup,Checkbox:s.Checkbox,ElButton:s.Button},props:{recommendRanges:{type:Array,default:()=>[{label:"技术族(T)",value:"T"},{label:"项目族(P) ",value:"P"},{label:"市场族(M)",value:"M"},{label:"专业族(SC)",value:"SC"},{label:"设计族(DG)",value:"DG"}]},isShowModal:{type:Boolean,default:!1},width:{type:String,default:"720px"}},setup(t,e){const i=Object(a.r)(!1),s=Object(a.r)([]);return{isCheckAll:i,selectReconmendValue:s,onSelectAllRange:t=>{s.value=t?["T","P","M","SC","DG"]:[]},onGroupChange:t=>{console.log("value",t),6!==t.length&&(i.value=!1)},onSubmitReconmend:()=>{i.value&&(s.value=["ALL",...s.value]),e.emit("onSubmit",s.value),i.value=!1,s.value=[]},onCloseRecommend:()=>{i.value=!1,s.value=[],e.emit("onClose")}}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{staticClass:"recommend-modal",attrs:{visible:t.isShowModal,"before-close":t.onCloseRecommend,top:"0",width:t.width,"modal-append-to-body":"","append-to-body":"","lock-scroll":!1}},[i("template",{slot:"title"},[t._v("KM推荐")]),t._v(" "),[i("div",{staticClass:"recommend-container"},[i("div",{staticClass:"tips-one"},[t._v("推荐后会显示在KM首页和加入KM邮件池，确定推荐吗？")]),t._v(" "),i("div",{staticClass:"tips-two"},[t._v("选择推送范围 (不勾选则不会推荐到首页信息流中)")]),t._v(" "),i("div",{staticClass:"select-range"},[i("checkbox",{staticClass:"select-all label-text",on:{change:t.onSelectAllRange},model:{value:t.isCheckAll,callback:function(e){t.isCheckAll=e},expression:"isCheckAll"}},[t._v("全部职位")]),t._v(" "),i("checkbox-group",{on:{change:t.onGroupChange},model:{value:t.selectReconmendValue,callback:function(e){t.selectReconmendValue=e},expression:"selectReconmendValue"}},t._l(t.recommendRanges,(function(e){return i("checkbox",{key:e.value,attrs:{label:e.value}},[i("span",{staticClass:"label-text"},[t._v(t._s(e.label))])])})),1)],1)])],t._v(" "),i("template",{slot:"footer"},[i("el-button",{on:{click:t.onCloseRecommend}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitReconmend}},[t._v("确 定")])],1)],2)}),[],!1,null,"9108aff0",null);e.a=r.exports},2103:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(148),n=Object(a.c)({components:{TCheckTagGroup:s.a},inheritAttrs:!1,props:{allowUncheck:{type:Boolean,required:!1,default:!0},theme:{type:String,required:!1,default:"default"}}}),o=i(68),r=Object(o.a)(n,(function(){var t=this.$createElement;return(this._self._c||t)("t-check-tag-group",this._g(this._b({class:["check-tag-group","check-tag-group-"+this.theme,this.allowUncheck?"":"disabled-uncheck"],attrs:{"checked-props":{theme:"primary",variant:"light"},"unchecked-props":{theme:"default",variant:"light"}}},"t-check-tag-group",this.$attrs,!1),this.$listeners))}),[],!1,null,"55f9b2d6",null);e.a=r.exports},2104:function(t,e,i){"use strict";i(11),i(12),i(13),i(14),i(15);var a=i(3),s=i(2105),n=i(2030),o=i(2093),r=i(2103),l=i(2056),c=Object(a.c)({components:{TSpace:s.a,CardList:o.a,CheckTagGroup:r.a},props:{groupId:{type:[String,Number],required:!1,default:""},nick:{type:String,required:!1,default:""}},setup(t){var e;const i=Object(a.r)([{label:"我发布的",value:0},{label:"我参加的",value:1},{label:"被邀请的",value:2}]),s=Object(a.q)({own_type:[null===(e=i.value[0])||void 0===e?void 0:e.value]}),o=Object(a.q)({isEnd:!1,current:1,limit:16,forward:void 0}),r=Object(a.r)([]),{loading:c,run:d}=Object(l.a)(async()=>{const e=o.forward,i=r.value[0]||{},a=r.value[r.value.length-1]||{};return await Object(n.e)({...s,group_id:t.groupId||void 0,limit:o.limit,forward:o.forward,query_type:1,own_type:s.own_type.join(",")||void 0,first_id:!0===e?i.id:void 0,first_start_time:!0===e?i.start_time:void 0,last_id:!1===e?a.id:void 0,last_start_time:!1===e?a.start_time:void 0,nick:t.nick})},{onSuccess:t=>{o.isEnd=null==t?void 0:t.end,r.value=(null==t?void 0:t.pub_event_list)||[]}});return Object(a.u)(s,()=>{o.forward=void 0,o.current=1,d()}),{params:s,ownTypeList:i,pagination:o,list:r,onPageChange:({current:t})=>{o.forward=!(o.current<t),o.current=t,d()},loading:c}}}),d=i(68),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-space",{staticStyle:{"margin-bottom":"20px"},attrs:{direction:"vertical",size:10}},[i("t-space",{attrs:{align:"center",size:8}},[i("CheckTagGroup",{attrs:{options:t.ownTypeList,"allow-uncheck":!1},model:{value:t.params.own_type,callback:function(e){t.$set(t.params,"own_type",e)},expression:"params.own_type"}})],1)],1),t._v(" "),i("CardList",{attrs:{loading:t.loading,data:t.list,"is-end":t.pagination.isEnd,current:t.pagination.current,"on-change":t.onPageChange}})],1)}),[],!1,null,null,null);e.a=u.exports},2105:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var a=i(2057),s=i(35),n=(i(17),i(6),i(27),i(24),i(16),i(26),i(23),i(25),i(48),i(38),i(32),i(67),i(51),i(46),i(42),i(56),Object(s.a)(a.a))},2111:function(t,e){t.exports="/vkm/img/has-apply-img.85b579f8679fe190620dc90106eb7765.png"},2112:function(t,e){t.exports="/vkm/img/knowledge-badge.4eb05e68a2e5220b28c2310606edc4fb.png"},2113:function(t,e){t.exports="/vkm/img/headline-badge.3571b2c521b2a649727f3d299b5df46f.png"},2114:function(t,e){t.exports="/vkm/img/default-cover.f514bb5f61b65c12a1e103004ee15394.svg"},2310:function(t,e){t.exports="/vkm/img/kbar_default.0beea750f3f680e59112e53e49c97797.png"},2327:function(t,e,i){"use strict";i.r(e);var a=i(1895),s=i.n(a),n=(i(11),i(12),i(13),i(14),i(15),i(528)),o={components:{groupItem:i(2068).a,venomPagination:s.a},props:{isFromUserCenter:{required:!1,type:Boolean,default:!1},username:{required:!1,type:String,default:""}},data(){return{tabIndex:this.$route.query.kbar_index||0,page:1,limit:18,allTotal:0,teamTotal:"",themeTotal:"",allList:[],teamList:[],themeList:[],loading:!1}},computed:{paginationTotal(){switch(this.tabIndex){case 0:return this.allTotal;case 1:return this.teamTotal;case 2:return this.themeTotal;default:return this.allTotal}},nick(){return this.$store.getters["global/userInfo"]?this.$store.getters["global/userInfo"].user_info.nick:""}},mounted(){0===this.tabIndex&&this.getAllGroups(),this.getTeamGroups(),this.getThemeGroups()},methods:{onPageChange(t){this.page=t,window.screenTop=0,this.getList()},changeTab(t){t!==this.tabIndex&&(this.tabIndex=t,this.page=1,this.getList())},getList(){switch(this.tabIndex){case 0:this.getAllGroups();break;case 1:this.getTeamGroups();break;case 2:this.getThemeGroups();break;default:this.tabIndex=0,this.getAllGroups()}},async getAllGroups(){try{this.loading=!0;const{data:t}=await Object(n.o)({page:this.page,limit:this.limit,nick:this.username||this.nick});0===t.code&&(this.allTotal=t.data.total,this.allList=t.data.kbar_list,window.scrollTo(0,0)),this.loading=!1}catch(t){this.loading=!1,console.error(t)}},async getTeamGroups(){try{this.loading=!0;const{data:t}=await Object(n.q)({page:this.page,limit:this.limit,nick:this.username||this.nick});0===t.code&&(this.teamTotal=t.data.total,this.teamList=t.data.kbar_list,window.scrollTo(0,0)),this.loading=!1}catch(t){this.loading=!1,console.error(t)}},async getThemeGroups(){try{this.loading=!0;const{data:t}=await Object(n.r)({page:this.page,limit:this.limit,nick:this.username||this.nick});0===t.code&&(this.themeTotal=t.data.total,this.themeList=t.data.kbar_list,window.scrollTo(0,0)),this.loading=!1}catch(t){this.loading=!1,console.error(t)}},operateCallback(){this.getList()}}},r=i(68),l=Object(r.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mine-page-container"},[i("div",{staticClass:"header"},[i("div",{staticClass:"tab"},[i("span",{class:["tab",0===t.tabIndex?"actived-tab":""],on:{click:function(e){return t.changeTab(0)}}},[t._v("全部K吧")]),t._v(" "),i("span",{class:["tab",1===t.tabIndex?"actived-tab":""],on:{click:function(e){return t.changeTab(1)}}},[t._v("\n        按部门分类("+t._s(t.teamTotal)+")\n      ")]),t._v(" "),i("span",{class:["tab",2===t.tabIndex?"actived-tab":""],on:{click:function(e){return t.changeTab(2)}}},[t._v("\n        按主题分类("+t._s(t.themeTotal)+")\n      ")])]),t._v(" "),t.isFromUserCenter?i("a",{staticClass:"jump-to",attrs:{href:"/vkm/group/list-page",target:"_blank"}},[t._v("\n      浏览更多K吧\n      "),i("svg-icon",{attrs:{name:"common/new-arrow",width:16,height:16,viewBox:"0 0 16 16"}})],1):t._e()]),t._v(" "),i("div",{staticClass:"group-list-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.tabIndex,expression:"tabIndex === 0"}],staticClass:"group-list"},t._l(t.allList,(function(t,e){return i("div",{key:e,staticClass:"group-item"},[i("group-item",{key:e,attrs:{"show-description":!1,data:t,"show-join-tip":!1,"url-suffix":"?kmref=kbar_mine"}})],1)})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.tabIndex,expression:"tabIndex === 1"}],staticClass:"group-list"},t._l(t.teamList,(function(t,e){return i("div",{key:e,staticClass:"group-item"},[i("group-item",{key:e,attrs:{"show-description":!1,data:t,"show-join-tip":!1,"url-suffix":"?kmref=kbar_mine"}})],1)})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.tabIndex,expression:"tabIndex === 2"}],staticClass:"group-list"},t._l(t.themeList,(function(t,e){return i("div",{key:e,staticClass:"group-item"},[i("group-item",{key:e,attrs:{"show-description":!1,data:t,"show-join-tip":!1,"url-suffix":"?kmref=kbar_mine"}})],1)})),0),t._v(" "),t.paginationTotal?i("venom-pagination",{attrs:{"current-page":t.page,total:+t.paginationTotal,"page-size":18},on:{"page-change":t.onPageChange}}):t._e()],1)])}),[],!1,null,"06b3e9f0",null);e.default=l.exports},2378:function(t,e,i){"use strict";i.d(e,"a",(function(){return H}));var a=i(16),s=i.n(a),n=i(6),o=i.n(n),r=i(8),l=["info","success","warning","error","question","loading"],c={top:{top:"32px",left:"50%",transform:"translateX(-50%)"},center:{left:"50%",top:"50%",transform:"translateX(-50%) translateY(-50%)"},left:{left:"32px",top:"50%",transform:"translateY(-50%)"},bottom:{bottom:"32px",left:"50%",transform:"translateX(-50%)"},right:{right:"32px",top:"50%",transform:"translateY(-50%)",display:"flex",flexDirection:"column",alignItems:"flex-end"},"top-left":{left:"32px",top:"32px"},"top-right":{right:"32px",top:"32px",display:"flex",flexDirection:"column",alignItems:"flex-end"},"bottom-right":{right:"32px",bottom:"32px",display:"flex",flexDirection:"column",alignItems:"flex-end"},"bottom-left":{left:"32px",bottom:"32px"}},d=Object.keys(c),u=i(1323),p=i(1873),h=i(1874),m=i(1875),v=i(1976),g=i(87),f=i(10),_={closeBtn:{type:[String,Boolean,Function],default:void 0},content:{type:[String,Function]},duration:{type:Number,default:3e3},icon:{type:[Boolean,Function],default:!0},theme:{type:String,default:"info",validator:function(t){return!t||["info","success","warning","error","question","loading"].includes(t)}},onClose:Function,onCloseBtnClick:Function,onDurationEnd:Function},b={duration:200,easing:"linear"};function y(t,e){if(t){var i=function(t,e,i){if(!d.includes(t))return null;if(["top-left","left","bottom-left"].includes(t))return[{opacity:0,marginLeft:"-".concat(e,"px")},{opacity:1,marginLeft:"0"}];if(["top-right","right","bottom-right"].includes(t))return[{opacity:0,marginRight:"-".concat(e,"px")},{opacity:1,marginRight:"0"}];if(["top","center"].includes(t))return[{opacity:0,marginTop:"-".concat(i,"px")},{opacity:1,marginTop:"0"}];if(["bottom"].includes(t))return[{opacity:0,transform:"translate3d(0, ".concat(i,"px, 0)")},{opacity:1,transform:"translate3d(0, 0, 0)"}]}(e,(null==t?void 0:t.offsetWidth)||0,(null==t?void 0:t.offsetHeight)||0);if(i)C(t,i[i.length-1]),t.animate&&t.animate(i,b)}}function w(t,e,i){if(t){var a=function(t,e){if(!d.includes(t))return null;if(["bottom-left","bottom","bottom-right"].includes(t)){return[{opacity:1,marginTop:"0px"},{opacity:0,marginTop:"".concat(e,"px")}]}return[{opacity:1,marginTop:"0px"},{opacity:0,marginTop:"-".concat(e,"px")}]}(e,(null==t?void 0:t.offsetHeight)||0);if(!a)return i();var s=a[a.length-1];C(t,s);var n=t.animate&&t.animate(a,b);n?n.onfinish=function(){t.style.display="none",i()}:(t.style.display="none",i())}}function C(t,e){for(var i=Object.keys(e),a=0;a<i.length;a+=1){var s=i[a];t.style[s]=e[s]}}var k=i(18),O=i(22);i(41),i(98),i(97),i(48),i(38),i(17),i(32),i(67),i(51),i(46),i(42),i(58),i(23),i(25),i(24),i(27),i(26),i(56);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var I=Object(k.b)("message"),T=Object(O.a)(I,Object(k.c)()).extend({name:"TMessage",props:j(j({},_),{},{placement:String}),data:function(){return{timer:null}},computed:{classes:function(){var t=this,e={};return l.forEach((function(i){e["".concat(t.classPrefix,"-is-").concat(i)]=t.theme===i})),[this.componentName,e,o()({},"".concat(this.classPrefix,"-is-closable"),this.closeBtn||this.$scopedSlots.closeBtn)]}},created:function(){this.duration&&this.setTimer()},mounted:function(){y(this.$refs.msg,this.$props.placement)},methods:{setTimer:function(){var t=this;this.duration&&(this.timer=Number(setTimeout((function(){var e,i;t.clearTimer(),w(t.$refs.msg,t.$props.placement,(function(){t.$emit("duration-end"),t.$emit("close")})),null===(e=t.onDurationEnd)||void 0===e||e.call(t),null===(i=t.onClose)||void 0===i||i.call(t,{trigger:"duration-end"})}),this.duration)))},clearTimer:function(){this.duration&&clearTimeout(this.timer)},close:function(t){var e,i;this.$emit("close-btn-click",{e:t}),this.$emit("close"),null===(e=this.onCloseBtnClick)||void 0===e||e.call(this,{e:t}),null===(i=this.onClose)||void 0===i||i.call(this,{trigger:"close-click",e:t})},renderClose:function(){var t=this.$createElement,e=t(this.useGlobalIcon({CloseIcon:u.a}).CloseIcon);return t("span",{class:"".concat(this.componentName,"__close"),on:{click:this.close}},[Object(f.b)(this,"closeBtn",e)])},renderIcon:function(){var t=this.$createElement;if(!1!==this.icon){if("function"==typeof this.icon)return this.icon(this.$createElement);if(this.$scopedSlots.icon)return this.$scopedSlots.icon(null);var e=this.useGlobalIcon({InfoCircleFilledIcon:p.a,CheckCircleFilledIcon:h.a,ErrorCircleFilledIcon:m.a,HelpCircleFilledIcon:v.a}),i=e.InfoCircleFilledIcon,a=e.CheckCircleFilledIcon,s=e.ErrorCircleFilledIcon;return t({info:i,success:a,warning:s,error:s,question:e.HelpCircleFilledIcon,loading:g.a}[this.theme])}}},render:function(){var t=arguments[0];return t("div",{ref:"msg",class:this.classes,on:{mouseenter:this.clearTimer,mouseleave:this.setTimer}},[this.renderIcon(),Object(f.a)(this,"default","content"),this.renderClose()])}});
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function S(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function D(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?S(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var q,E=Object(k.b)("message__list"),A=(q=0,function(){return q+=1}),M=Object(O.a)(E).extend({name:"TMessageList",components:{TMessage:T},props:{zIndex:Number,placement:String},data:function(){return{list:[]}},computed:{styles:function(){return D(D({},c[this.placement]),{},{zIndex:5e3!==this.zIndex?this.zIndex:5e3})}},methods:{add:function(t){var e=D(D({},t),{},{key:A(),placement:this.placement});return this.list.push(e),this.list.length-1},remove:function(t){this.list.splice(t,1)},removeAll:function(){this.list=[]},getOffset:function(t){if(t)return isNaN(Number(t))?t:"".concat(t,"px")},msgStyles:function(t){return t.offset?D({position:"relative",left:this.getOffset(t.offset[0]),top:this.getOffset(t.offset[1])},t.style):t.style},getListeners:function(t){var e=this;return{"close-btn-click":function(){return e.remove(t)},"duration-end":function(){return e.remove(t)}}}},render:function(){var t=this,e=arguments[0];if(this.list.length)return e("div",{class:this.componentName,style:this.styles},[this.list.map((function(i,a){return e("t-message",{key:i.key,style:t.msgStyles(i),class:i.className,props:D({},i),on:D({},t.getListeners(a))})}))])}}),$=i(49);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function L(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var F=new Map,R={duration:3e3,attach:"body",zIndex:5e3,placement:"top"};var N=function(t){var e=function(t){var e=P(P({},R),t);return e.content=t.content,e}(t),i=e.attach,a=e.placement,s=Object($.b)(i);F.get(s)||F.set(s,{});var n=F.get(s)[a];if(n&&s.contains(n.$el))n.add(e);else{var o=new M({propsData:{zIndex:e.zIndex,placement:e.placement}}).$mount();o.add(e),F.get(s)[a]=o,s.appendChild(o.$el)}return new Promise((function(t){var e=F.get(s)[a];e.$nextTick((function(){var i=e.$children;t(i[i.length-1])}))}))},B=function(t,e,i){var a={theme:t};return"string"==typeof e?a.content=e:"object"!==s()(e)||e instanceof Array||(a=P(P({},a),e)),(i||0===i)&&(a.duration=i),N(a)},U={info:function(t,e){return B("info",t,e)},success:function(t,e){return B("success",t,e)},warning:function(t,e){return B("warning",t,e)},error:function(t,e){return B("error",t,e)},question:function(t,e){return B("question",t,e)},loading:function(t,e){return B("loading",t,e)},close:function(t){t.then((function(t){return t.close()}))},closeAll:function(){F instanceof Map&&F.forEach((function(t){Object.keys(t).forEach((function(e){t[e].list=[]}))}))},config:function(t){var e=t.placement,i=t.attach,a=t.offset,s=t.zIndex;i&&(R.attach=i),a&&(R.offset=a),e&&(R.placement=e),s&&(R.zIndex=s)}},H=B;Object.keys(U).forEach((function(t){H[t]=U[t]})),H.install=function(){r.default.prototype.$message=H}},2412:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var a=i(6),s=i.n(a),n={align:{type:String,default:"center",validator:function(t){return!t||["left","right","center"].includes(t)}},content:{type:[String,Function]},dashed:Boolean,default:{type:[String,Function]},layout:{type:String,default:"horizontal",validator:function(t){return!t||["horizontal","vertical"].includes(t)}},theme:{type:String,validator:function(t){return!t||["horizontal","vertical"].includes(t)}}},o=i(10),r=i(18),l=i(22);i(16),i(23),i(25),i(24),i(27),i(26);
/**
 * tdesign v1.9.8
 * (c) 2024 tdesign
 * @license MIT
 */
function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}var d=Object(r.b)("divider"),u=Object(l.a)(d).extend({name:"TDivider",props:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){s()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},n),render:function(){var t=arguments[0],e=Object(o.a)(this,"default","content");this.theme&&console.warn("TDesign Divider Warn: `theme` is going to be deprecated, please use `layout` instead.");var i=["".concat(this.componentName),["".concat(this.componentName,"--").concat(this.layout||this.theme||"horizontal")],s()(s()(s()({},"".concat(this.componentName,"--dashed"),!!this.dashed),"".concat(this.componentName,"--with-text"),!!e),"".concat(this.componentName,"--with-text-").concat(this.align),!!e)];return t("div",{class:i},[e&&t("span",{class:"".concat(this.componentName,"__inner-text")},[e])])}}),p=i(35),h=(i(56),Object(p.a)(u))},2414:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var a=i(6),s=i.n(a),n=i(10),o={content:{type:[String,Function]},default:{type:[String,Function]},disabled:Boolean,download:{type:[String,Boolean]},hover:{type:String,default:"underline",validator:function(t){return!t||["color","underline"].includes(t)}},href:{type:String,default:""},prefixIcon:{type:Function},size:{type:String,default:"medium",validator:function(t){return!t||["small","medium","large"].includes(t)}},suffixIcon:{type:Function},target:{type:String,default:""},theme:{type:String,default:"default",validator:function(t){return!t||["default","primary","danger","warning","success"].includes(t)}},underline:Boolean,onClick:Function},r=i(18),l=i(22),c=(i(16),i(23),i(25),i(24),i(27),i(26),Object(r.b)("link")),d=Object(l.a)(c).extend({name:"TLink",props:o,methods:{handleClick:function(t){var e;this.disabled||(this.$emit("click",t),null===(e=this.onClick)||void 0===e||e.call(this,t))}},render:function(){var t=arguments[0],e=Object(n.a)(this,"default","content"),i=Object(n.b)(this,"prefixIcon"),a=Object(n.b)(this,"suffixIcon"),o=[this.componentName,"".concat(this.componentName,"--theme-").concat(this.theme),s()(s()(s()(s()({},this.commonSizeClassName[this.size],"medium"!==this.size),this.commonStatusClassName.disabled,this.disabled),"".concat(this.classPrefix,"-is-underline"),this.underline),"".concat(this.componentName,"--hover-").concat(this.hover),!this.disabled)];return t("a",{class:o,attrs:{href:this.disabled||!this.href?void 0:this.href,target:this.target,download:this.download},on:{click:this.handleClick}},[i&&t("span",{class:"".concat(this.componentName,"__prefix-icon")},[i]),e,a&&t("span",{class:"".concat(this.componentName,"__suffix-icon")},[a])])}}),u=i(35),p=(i(56),Object(u.a)(d))}}]);