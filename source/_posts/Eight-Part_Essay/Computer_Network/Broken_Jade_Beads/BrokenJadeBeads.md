---
title: 碎玉零珠————计算机网络
top_img: '93596357_p0.jpg'
cover: '114478088_p0.jpg'
categories: 
    - 八股文
      - 计算机网络
tags: 
    - 计算机网络
---

## OSI 七层模型

* 理论上的网络通信模型
* **应用层**：最靠近用户的层，负责处理特定的应用程序细节。这一层提供了网络服务与用户应用软件之间的接口。例如，Web 浏览器、FTP 客户端和服务器、电子邮件客户端等。
* **表示层**：确保从一个系统发送的信息可以被另一个系统的应用层读取。它负责数据的转换、压缩和加密。例如，确保数据从一种编码格式转换为另一种，如 ASCII 到 EBCDIC。
* **会话层**：管理用户的会话，控制网络上两节点间的对话和数据交换的管理。它负责建立、维护和终止会话。例如，建立一个会话令牌，以便在网络上的两个节点之间传递。
* **传输层**：提供端到端的通信服务，保证数据的完整性和正确顺序。这一层包括 TCP 和 UDP 等。
* **网络层**：负责在多个网络之间进行数据传输，确保数据能够在复杂的网络结构中找到从源到目的地的最佳路径。这层使用的是 IP（Internet Protocol）协议。
* **数据链路层**：在物理连接中提供可靠的传输，负责建立和维护两个相邻节点间的链路。包括帧同步、MAC（媒体访问控制）。
* **物理层**：负责在物理媒介上实现原始的数据传输，比如电缆、光纤和无线信号传输。涉及的内容包括电压、接口、针脚、电缆的规格和传输速率等。

## TCP / IP 四层模型

* 实际应用层面上的网络通信模型
* 是互联网通信的核心，定义了一系列协议和标准，确保设备间可以可靠地进行数据传输。
* **应用层（Application Layer）**：直接面向用户和应用程序，提供各种网络服务。它包含了用于特定应用的协议和服务，如 HTTP（HyperText Transfer Protocol）、FTP（File Transfer Protocol）、SMTP（Simple Mail Transfer Protocol）等。
* **传输层（Transport Layer）**：提供端到端的通信服务，确保数据可靠传输。它负责分段数据、流量控制、错误检测和纠正。常见的传输层协议有 TCP 和 UDP。
* **网际层：或者叫网络层（Internet Layer）**：负责在不同网络之间路由数据包，提供逻辑地址（IP 地址）和网络寻址功能。用于处理数据包的分组、转发和路由选择，确保数据可以从源端传输到目标端。**常见协议**：IPv4、IPv6、ICMP（Internet Control Message Protocol）。**示例**：当访问一个网站时，网络层协议（如 IPv4）将你的请求从你的计算机通过多个路由器传输到目标服务器。
* **网络接口层（Network Access Layer）**：或者叫**链路层（Link Layer）**，负责将数字信号在物理通道（网线）中准确传输，定义了如何在单一网络链路上传输数据，如何处理数据帧的发送和接收，包括物理地址（MAC 地址）的解析。**常见协议**：以太网（Ethernet）、Wi-Fi。**示例**：在一个局域网（LAN）中，计算机通过以太网连接交换机，链路层协议负责数据帧在网络设备间的传输。

## TCP / IP 五层体系结构

* 五层结构是为了方便理解和记忆。
* 是对 OSI 和 TCP/IP 的折衷，它保留了 TCP/IP 的实用性，同时提供了比四层模型更细致的分层，便于教学和理解网络的各个方面。
* **应用层**：作为网络服务和最终用户之间的接口。它提供了一系列供应用程序使用的协议，如 HTTP（网页）、FTP（文件传输）、SMTP（邮件传输）等。使用户的应用程序可以访问网络服务。
* **传输层**：提供进程到进程的通信管理，这一层确保数据按顺序、无错误地传输。主要协议包括 TCP 和 UDP。
* **网络层**：负责数据包从源到目的地的传输和路由选择，包括跨越多个网络（即互联网）。它使用逻辑地址（如 IP 地址）来唯一标识设备。路由器是网络层设备。
* **数据链路层**：确保从一个节点到另一个节点的可靠、有效的数据传输。交换机、网桥是数据链路层设备。
* **物理层**：电缆、光纤、无线电频谱、网络适配器等。

<img src="三种网络体系结构.jpg" alt="三种网络体系结构" style="zoom:50%;">

## TCP三次握手四次挥手工作在哪一层？

* 三次握手和四次挥手都是工作在传输层。传输层（Transport Layer）是 OSI 模型的第四层，负责提供端到端的通信服务，包括数据传输的建立、维护和终止。
* TCP 作为一种面向连接的协议，通过三次握手建立连接，通过四次挥手终止连接，确保数据传输的可靠性和完整性。

## TCP 的粘包和拆包

* TCP 是面向流，没有界限的一串数据。TCP 底层并不了解上层业务数据的具体含义，它会根据 TCP 缓冲区的实际情况进行包的划分，所以在业务上认为，**一个完整的包可能会被 TCP 拆分成多个包进行发送，也有可能把多个小的包封装成一个大的数据包发送**。这就是所谓的 TCP 粘包和拆包问题。
<img src="粘包和拆包.jpg" alt="粘包和拆包" style="zoom:50%;">

> * **为什么会产生粘包和拆包 ?**
>
> > * 要发送的数据小于 TCP 发送缓冲区的大小，TCP 将多次写入缓冲区的数据一次发送出去，将会发生粘包；
> > * 接收数据端的应用层没有及时读取接收缓冲区中的数据，将发生粘包；
> > * 要发送的数据大于 TCP 发送缓冲区剩余空间大小，将会发生拆包；
> > * 待发送数据大于 MSS（最大报文长度），TCP 在传输前将进行拆包。即 TCP 报文长度 - TCP 头部长度 > MSS。
>
> * **如何解决 ?**
>
> > * 发送端将每个数据包封装为固定长度；
> > * 在数据尾部增加特殊字符进行分割；
> > * 将数据分为两部分，一部分是头部，一部分是内容体；其中头部结构大小固定，且有一个字段声明内容体的大小。

## 如何设计使UDP的上层（应用层）可以可靠传输数据（速记版）

* 既然UDP的传输层不可靠，那么只能从UDP的应用层入手了。在不考虑阻塞的情况下，可以参考TCP:
  1. 添加seq/ack机制，确保对端可以正确接收数据。
  2. 添加发送和接收缓存区，主要是为了应对超时数据重传问题。
  3. 添加超时数据重传机制，确保数据不会丢失。
